var fI=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var d2=fI((y2,Du)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const jg=!1;var gI=Array.isArray,mI=Array.prototype.indexOf,pI=Array.from,wI=Object.defineProperty,ka=Object.getOwnPropertyDescriptor,vI=Object.prototype,yI=Array.prototype,bI=Object.getPrototypeOf,sv=Object.isExtensible;function SI(t){for(var e=0;e<t.length;e++)t[e]()}function AE(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const Tt=2,zg=4,oc=8,DE=1<<24,di=16,ji=32,xo=64,Dm=128,$r=512,zt=1024,dr=2048,fi=4096,Ai=8192,Di=16384,Nm=32768,Nu=65536,av=1<<17,NE=1<<18,Ls=1<<19,CI=1<<20,Eo=32768,Ug=1<<21,km=1<<22,Ni=1<<23,La=Symbol("$state"),vs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function RI(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function EI(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function TI(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function _I(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function OI(t){throw new Error("https://svelte.dev/e/effect_orphan")}function MI(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function II(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function PI(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function HI(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function xI(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const AI=2,Rt=Symbol();function DI(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function kE(t){return t===this.v}let NI=!1,Er=null;function Ps(t){Er=t}function LE(t,e=!1,r){Er={p:Er,i:!1,c:null,e:null,s:t,x:null,l:null}}function FE(t){var e=Er,r=e.e;if(r!==null){e.e=null;for(var n of r)tT(n)}return e.i=!0,Er=e.p,{}}function VE(){return!0}let mo=[];function WE(){var t=mo;mo=[],SI(t)}function ai(t){if(mo.length===0&&!Fa){var e=mo;queueMicrotask(()=>{e===mo&&WE()})}mo.push(t)}function kI(){for(;mo.length>0;)WE()}function $E(t){var e=De;if(e===null)return pe.f|=Ni,t;if((e.f&Nm)===0){if((e.f&Dm)===0)throw t;e.b.error(t)}else Hs(t,e)}function Hs(t,e){for(;e!==null;){if((e.f&Dm)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t}const LI=-7169;function _t(t,e){t.f=t.f&LI|e}function Lm(t){(t.f&$r)!==0||t.deps===null?_t(t,zt):_t(t,fi)}function BE(t){if(t!==null)for(const e of t)(e.f&Tt)===0||(e.f&Eo)===0||(e.f^=Eo,BE(e.deps))}function jE(t,e,r){(t.f&dr)!==0?e.add(t):(t.f&fi)!==0&&r.add(t),BE(t.deps),_t(t,zt)}const El=new Set;let Ve=null,Yg=null,un=null,Sr=[],sc=null,qg=!1,Fa=!1;class ki{committed=!1;current=new Map;previous=new Map;#t=new Set;#d=new Set;#n=0;#a=0;#o=null;#r=new Set;#e=new Set;skipped_effects=new Set;is_fork=!1;#i=!1;is_deferred(){return this.is_fork||this.#a>0}process(e){Sr=[],this.apply();var r=[],n=[];for(const i of e)this.#s(i,r,n);if(this.is_deferred())this.#l(n),this.#l(r);else{for(const i of this.#t)i();this.#t.clear(),this.#n===0&&this.#u(),Yg=this,Ve=null,lv(n),lv(r),Yg=null,this.#o?.resolve()}un=null}#s(e,r,n){e.f^=zt;for(var i=e.first,o=null;i!==null;){var s=i.f,a=(s&(ji|xo))!==0,l=a&&(s&zt)!==0,u=l||(s&Ai)!==0||this.skipped_effects.has(i);if(!u&&i.fn!==null){a?i.f^=zt:o!==null&&(s&(zg|oc|DE))!==0?o.b.defer_effect(i):(s&zg)!==0?r.push(i):rl(i)&&((s&di)!==0&&this.#r.add(i),Ga(i));var c=i.first;if(c!==null){i=c;continue}}var h=i.parent;for(i=i.next;i===null&&h!==null;)h===o&&(o=null),i=h.next,h=h.parent}}#l(e){for(var r=0;r<e.length;r+=1)jE(e[r],this.#r,this.#e)}capture(e,r){r!==Rt&&!this.previous.has(e)&&this.previous.set(e,r),(e.f&Ni)===0&&(this.current.set(e,e.v),un?.set(e,e.v))}activate(){Ve=this,this.apply()}deactivate(){Ve===this&&(Ve=null,un=null)}flush(){if(this.activate(),Sr.length>0){if(zE(),Ve!==null&&Ve!==this)return}else this.#n===0&&this.process([]);this.deactivate()}discard(){for(const e of this.#d)e(this);this.#d.clear()}#u(){if(El.size>1){this.previous.clear();var e=un,r=!0;for(const i of El){if(i===this){r=!1;continue}const o=[];for(const[a,l]of this.current){if(i.current.has(a))if(r&&l!==i.current.get(a))i.current.set(a,l);else continue;o.push(a)}if(o.length===0)continue;const s=[...i.current.keys()].filter(a=>!this.current.has(a));if(s.length>0){var n=Sr;Sr=[];const a=new Set,l=new Map;for(const u of o)UE(u,s,a,l);if(Sr.length>0){Ve=i,i.apply();for(const u of Sr)i.#s(u,[],[]);i.deactivate()}Sr=n}}Ve=null,un=e}this.committed=!0,El.delete(this)}increment(e){this.#n+=1,e&&(this.#a+=1)}decrement(e){this.#n-=1,e&&(this.#a-=1),!this.#i&&(this.#i=!0,ai(()=>{this.#i=!1,this.is_deferred()?Sr.length>0&&this.flush():this.revive()}))}revive(){for(const e of this.#r)this.#e.delete(e),_t(e,dr),Wi(e);for(const e of this.#e)_t(e,fi),Wi(e);this.flush()}oncommit(e){this.#t.add(e)}ondiscard(e){this.#d.add(e)}settled(){return(this.#o??=AE()).promise}static ensure(){if(Ve===null){const e=Ve=new ki;El.add(Ve),Fa||ai(()=>{Ve===e&&e.flush()})}return Ve}apply(){}}function FI(t){var e=Fa;Fa=!0;try{for(var r;;){if(kI(),Sr.length===0&&(Ve?.flush(),Sr.length===0))return sc=null,r;zE()}}finally{Fa=e}}function zE(){qg=!0;var t=null;try{for(var e=0;Sr.length>0;){var r=ki.ensure();if(e++>1e3){var n,i;VI()}r.process(Sr),Li.clear()}}finally{qg=!1,sc=null}}function VI(){try{MI()}catch(t){Hs(t,sc)}}let ti=null;function lv(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(Di|Ai))===0&&rl(n)&&(ti=new Set,Ga(n),n.deps===null&&n.first===null&&n.nodes===null&&(n.teardown===null&&n.ac===null?sT(n):n.fn=null),ti?.size>0)){Li.clear();for(const i of ti){if((i.f&(Di|Ai))!==0)continue;const o=[i];let s=i.parent;for(;s!==null;)ti.has(s)&&(ti.delete(s),o.push(s)),s=s.parent;for(let a=o.length-1;a>=0;a--){const l=o[a];(l.f&(Di|Ai))===0&&Ga(l)}}ti.clear()}}ti=null}}function UE(t,e,r,n){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Tt)!==0?UE(i,e,r,n):(o&(km|di))!==0&&(o&dr)===0&&YE(i,e,n)&&(_t(i,dr),Wi(i))}}function YE(t,e,r){const n=r.get(t);if(n!==void 0)return n;if(t.deps!==null)for(const i of t.deps){if(e.includes(i))return!0;if((i.f&Tt)!==0&&YE(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function Wi(t){for(var e=sc=t;e.parent!==null;){e=e.parent;var r=e.f;if(qg&&e===De&&(r&di)!==0&&(r&NE)===0)return;if((r&(xo|ji))!==0){if((r&zt)===0)return;e.f^=zt}}Sr.push(e)}function WI(t){let e=0,r=ac(0),n;return()=>{Wm()&&(oe(r),cc(()=>(e===0&&(n=hc(()=>t(()=>Va(r)))),e+=1,()=>{ai(()=>{e-=1,e===0&&(n?.(),n=void 0,Va(r))})})))}}var $I=Nu|Ls|Dm;function BI(t,e,r){new jI(t,e,r)}class jI{parent;is_pending=!1;#t;#d=null;#n;#a;#o;#r=null;#e=null;#i=null;#s=null;#l=null;#u=0;#h=0;#g=!1;#f=!1;#m=new Set;#p=new Set;#c=null;#S=WI(()=>(this.#c=ac(this.#u),()=>{this.#c=null}));constructor(e,r,n){this.#t=e,this.#n=r,this.#a=n,this.parent=De.b,this.is_pending=!!this.#n.pending,this.#o=oP(()=>{De.b=this;{var i=this.#y();try{this.#r=Ki(()=>n(i))}catch(o){this.error(o)}this.#h>0?this.#v():this.is_pending=!1}return()=>{this.#l?.remove()}},$I)}#C(){try{this.#r=Ki(()=>this.#a(this.#t))}catch(e){this.error(e)}}#R(){const e=this.#n.pending;e&&(this.#e=Ki(()=>e(this.#t)),ai(()=>{var r=this.#y();this.#r=this.#w(()=>(ki.ensure(),Ki(()=>this.#a(r)))),this.#h>0?this.#v():(yu(this.#e,()=>{this.#e=null}),this.is_pending=!1)}))}#y(){var e=this.#t;return this.is_pending&&(this.#l=eT(),this.#t.before(this.#l),e=this.#l),e}defer_effect(e){jE(e,this.#m,this.#p)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#n.pending}#w(e){var r=De,n=pe,i=Er;xn(this.#o),lr(this.#o),Ps(this.#o.ctx);try{return e()}catch(o){return $E(o),null}finally{xn(r),lr(n),Ps(i)}}#v(){const e=this.#n.pending;this.#r!==null&&(this.#s=document.createDocumentFragment(),this.#s.append(this.#l),aP(this.#r,this.#s)),this.#e===null&&(this.#e=Ki(()=>e(this.#t)))}#b(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#b(e);return}if(this.#h+=e,this.#h===0){this.is_pending=!1;for(const r of this.#m)_t(r,dr),Wi(r);for(const r of this.#p)_t(r,fi),Wi(r);this.#m.clear(),this.#p.clear(),this.#e&&yu(this.#e,()=>{this.#e=null}),this.#s&&(this.#t.before(this.#s),this.#s=null)}}update_pending_count(e){this.#b(e),this.#u+=e,!(!this.#c||this.#g)&&(this.#g=!0,ai(()=>{this.#g=!1,this.#c&&ku(this.#c,this.#u)}))}get_effect_pending(){return this.#S(),oe(this.#c)}error(e){var r=this.#n.onerror;let n=this.#n.failed;if(this.#f||!r&&!n)throw e;this.#r&&(Hn(this.#r),this.#r=null),this.#e&&(Hn(this.#e),this.#e=null),this.#i&&(Hn(this.#i),this.#i=null);var i=!1,o=!1;const s=()=>{if(i){DI();return}i=!0,o&&xI(),ki.ensure(),this.#u=0,this.#i!==null&&yu(this.#i,()=>{this.#i=null}),this.is_pending=this.has_pending_snippet(),this.#r=this.#w(()=>(this.#f=!1,Ki(()=>this.#a(this.#t)))),this.#h>0?this.#v():this.is_pending=!1};var a=pe;try{lr(null),o=!0,r?.(e,s),o=!1}catch(l){Hs(l,this.#o&&this.#o.parent)}finally{lr(a)}n&&ai(()=>{this.#i=this.#w(()=>{ki.ensure(),this.#f=!0;try{return Ki(()=>{n(this.#t,()=>e,()=>s)})}catch(l){return Hs(l,this.#o.parent),null}finally{this.#f=!1}})})}}function zI(t,e,r,n){const i=YI;var o=t.filter(d=>!d.settled);if(r.length===0&&o.length===0){n(e.map(i));return}var s=Ve,a=De,l=UI(),u=o.length===1?o[0].promise:o.length>1?Promise.all(o.map(d=>d.promise)):null;function c(d){l();try{n(d)}catch(g){(a.f&Di)===0&&Hs(g,a)}s?.deactivate(),Gg()}if(r.length===0){u.then(()=>c(e.map(i)));return}function h(){l(),Promise.all(r.map(d=>qI(d))).then(d=>c([...e.map(i),...d])).catch(d=>Hs(d,a))}u?u.then(h):h()}function UI(){var t=De,e=pe,r=Er,n=Ve;return function(o=!0){xn(t),lr(e),Ps(r),o&&n?.activate()}}function Gg(){xn(null),lr(null),Ps(null)}function YI(t){var e=Tt|dr,r=pe!==null&&(pe.f&Tt)!==0?pe:null;return De!==null&&(De.f|=Ls),{ctx:Er,deps:null,effects:null,equals:kE,f:e,fn:t,reactions:null,rv:0,v:Rt,wv:0,parent:r??De,ac:null}}function qI(t,e,r){let n=De;n===null&&EI();var i=n.b,o=void 0,s=ac(Rt),a=!pe,l=new Map;return iP(()=>{var u=AE();o=u.promise;try{Promise.resolve(t()).then(u.resolve,u.reject).then(()=>{c===Ve&&c.committed&&c.deactivate(),Gg()})}catch(g){u.reject(g),Gg()}var c=Ve;if(a){var h=i.is_rendered();i.update_pending_count(1),c.increment(h),l.get(c)?.reject(vs),l.delete(c),l.set(c,u)}const d=(g,p=void 0)=>{if(c.activate(),p)p!==vs&&(s.f|=Ni,ku(s,p));else{(s.f&Ni)!==0&&(s.f^=Ni),ku(s,g);for(const[v,b]of l){if(l.delete(v),v===c)break;b.reject(vs)}}a&&(i.update_pending_count(-1),c.decrement(h))};u.promise.then(d,g=>d(null,g||"unknown"))}),$m(()=>{for(const u of l.values())u.reject(vs)}),new Promise(u=>{function c(h){function d(){h===o?u(s):c(o)}h.then(d,d)}c(o)})}function qE(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Hn(e[r])}}function GI(t){for(var e=t.parent;e!==null;){if((e.f&Tt)===0)return(e.f&Di)===0?e:null;e=e.parent}return null}function Fm(t){var e,r=De;xn(GI(t));try{t.f&=~Eo,qE(t),e=hT(t)}finally{xn(r)}return e}function GE(t){var e=Fm(t);if(!t.equals(e)&&(t.wv=uT(),(!Ve?.is_fork||t.deps===null)&&(t.v=e,t.deps===null))){_t(t,zt);return}To||(un!==null?(Wm()||Ve?.is_fork)&&un.set(t,e):Lm(t))}let Kg=new Set;const Li=new Map;let KE=!1;function ac(t,e){var r={f:0,v:t,reactions:null,equals:kE,rv:0,wv:0};return r}function or(t,e){const r=ac(t);return lP(r),r}function Ye(t,e,r=!1){pe!==null&&(!cn||(pe.f&av)!==0)&&VE()&&(pe.f&(Tt|di|km|av))!==0&&!li?.includes(t)&&HI();let n=r?Ia(e):e;return ku(t,n)}function ku(t,e){if(!t.equals(e)){var r=t.v;To?Li.set(t,e):Li.set(t,r),t.v=e;var n=ki.ensure();if(n.capture(t,r),(t.f&Tt)!==0){const i=t;(t.f&dr)!==0&&Fm(i),Lm(i)}t.wv=uT(),XE(t,dr),De!==null&&(De.f&zt)!==0&&(De.f&(ji|xo))===0&&(Lr===null?uP([t]):Lr.push(t)),!n.is_fork&&Kg.size>0&&!KE&&KI()}return e}function KI(){KE=!1;for(const t of Kg)(t.f&zt)!==0&&_t(t,fi),rl(t)&&Ga(t);Kg.clear()}function Va(t){Ye(t,t.v+1)}function XE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&dr)===0;if(a&&_t(o,e),(s&Tt)!==0){var l=o;un?.delete(l),(s&Eo)===0&&(s&$r&&(o.f|=Eo),XE(l,fi))}else a&&((s&di)!==0&&ti!==null&&ti.add(o),Wi(o))}}function Ia(t){if(typeof t!="object"||t===null||La in t)return t;const e=bI(t);if(e!==vI&&e!==yI)return t;var r=new Map,n=gI(t),i=or(0),o=So,s=a=>{if(So===o)return a();var l=pe,u=So;lr(null),dv(o);var c=a();return lr(l),dv(u),c};return n&&r.set("length",or(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&II();var c=r.get(l);return c===void 0?c=s(()=>{var h=or(u.value);return r.set(l,h),h}):Ye(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>or(Rt));r.set(l,c),Va(i)}}else Ye(u,Rt),Va(i);return!0},get(a,l,u){if(l===La)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||ka(a,l)?.writable)&&(c=s(()=>{var g=Ia(h?a[l]:Rt),p=or(g);return p}),r.set(l,c)),c!==void 0){var d=oe(c);return d===Rt?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=oe(c))}else if(u===void 0){var h=r.get(l),d=h?.v;if(h!==void 0&&d!==Rt)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){if(l===La)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Rt||Reflect.has(a,l);if(u!==void 0||De!==null&&(!c||ka(a,l)?.writable)){u===void 0&&(u=s(()=>{var d=c?Ia(a[l]):Rt,g=or(d);return g}),r.set(l,u));var h=oe(u);if(h===Rt)return!1}return c},set(a,l,u,c){var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var p=r.get(g+"");p!==void 0?Ye(p,Rt):g in a&&(p=s(()=>or(Rt)),r.set(g+"",p))}if(h===void 0)(!d||ka(a,l)?.writable)&&(h=s(()=>or(void 0)),Ye(h,Ia(u)),r.set(l,h));else{d=h.v!==Rt;var v=s(()=>Ia(u));Ye(h,v)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b?.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var E=r.get("length"),S=Number(l);Number.isInteger(S)&&S>=E.v&&Ye(E,S+1)}Va(i)}return!0},ownKeys(a){oe(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==Rt});for(var[u,c]of r)c.v!==Rt&&!(u in a)&&l.push(u);return l},setPrototypeOf(){PI()}})}function uv(t){try{if(t!==null&&typeof t=="object"&&La in t)return t[La]}catch{}return t}function XI(t,e){return Object.is(uv(t),uv(e))}var Xg,ZE,JE,QE;function ZI(){if(Xg===void 0){Xg=window,ZE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;JE=ka(e,"firstChild").get,QE=ka(e,"nextSibling").get,sv(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),sv(r)&&(r.__t=void 0)}}function eT(t=""){return document.createTextNode(t)}function po(t){return JE.call(t)}function lc(t){return QE.call(t)}function Lt(t,e){return po(t)}function JI(t,e=!1){{var r=po(t);return r instanceof Comment&&r.data===""?lc(r):r}}function St(t,e=1,r=!1){let n=t;for(;e--;)n=lc(n);return n}let cv=!1;function QI(){cv||(cv=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function uc(t){var e=pe,r=De;lr(null),xn(null);try{return t()}finally{lr(e),xn(r)}}function Vm(t,e,r,n=r){t.addEventListener(e,()=>uc(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),QI()}function eP(t){De===null&&(pe===null&&OI(),_I()),To&&TI()}function tP(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function zi(t,e,r){var n=De;n!==null&&(n.f&Ai)!==0&&(t|=Ai);var i={ctx:Er,deps:null,nodes:null,f:t|dr|$r,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Ga(i),i.f|=Nm}catch(a){throw Hn(i),a}else e!==null&&Wi(i);var o=i;if(r&&o.deps===null&&o.teardown===null&&o.nodes===null&&o.first===o.last&&(o.f&Ls)===0&&(o=o.first,(t&di)!==0&&(t&Nu)!==0&&o!==null&&(o.f|=Nu)),o!==null&&(o.parent=n,n!==null&&tP(o,n),pe!==null&&(pe.f&Tt)!==0&&(t&xo)===0)){var s=pe;(s.effects??=[]).push(o)}return i}function Wm(){return pe!==null&&!cn}function $m(t){const e=zi(oc,null,!1);return _t(e,zt),e.teardown=t,e}function rP(t){eP();var e=De.f,r=!pe&&(e&ji)!==0&&(e&Nm)===0;if(r){var n=Er;(n.e??=[]).push(t)}else return tT(t)}function tT(t){return zi(zg|CI,t,!1)}function nP(t){ki.ensure();const e=zi(xo|Ls,t,!0);return(r={})=>new Promise(n=>{r.outro?yu(e,()=>{Hn(e),n(void 0)}):(Hn(e),n(void 0))})}function iP(t){return zi(km|Ls,t,!0)}function cc(t,e=0){return zi(oc|e,t,!0)}function rT(t,e=[],r=[],n=[]){zI(n,e,r,i=>{zi(oc,()=>t(...i.map(oe)),!0)})}function oP(t,e=0){var r=zi(di|e,t,!0);return r}function Ki(t){return zi(ji|Ls,t,!0)}function nT(t){var e=t.teardown;if(e!==null){const r=To,n=pe;hv(!0),lr(null);try{e.call(null)}finally{hv(r),lr(n)}}}function iT(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&uc(()=>{i.abort(vs)});var n=r.next;(r.f&xo)!==0?r.parent=null:Hn(r,e),r=n}}function sP(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&ji)===0&&Hn(e),e=r}}function Hn(t,e=!0){var r=!1;(e||(t.f&NE)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(oT(t.nodes.start,t.nodes.end),r=!0),iT(t,e&&!r),Lu(t,0),_t(t,Di);var n=t.nodes&&t.nodes.t;if(n!==null)for(const o of n)o.stop();nT(t);var i=t.parent;i!==null&&i.first!==null&&sT(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function oT(t,e){for(;t!==null;){var r=t===e?null:lc(t);t.remove(),t=r}}function sT(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function yu(t,e,r=!0){var n=[];aT(t,n,!0);var i=()=>{r&&Hn(t),e&&e()},o=n.length;if(o>0){var s=()=>--o||i();for(var a of n)a.out(s)}else i()}function aT(t,e,r){if((t.f&Ai)===0){t.f^=Ai;var n=t.nodes&&t.nodes.t;if(n!==null)for(const a of n)(a.is_global||r)&&e.push(a);for(var i=t.first;i!==null;){var o=i.next,s=(i.f&Nu)!==0||(i.f&ji)!==0&&(t.f&di)!==0;aT(i,e,s?r:!1),i=o}}}function aP(t,e){if(t.nodes)for(var r=t.nodes.start,n=t.nodes.end;r!==null;){var i=r===n?null:lc(r);e.append(r),r=i}}let bu=!1,To=!1;function hv(t){To=t}let pe=null,cn=!1;function lr(t){pe=t}let De=null;function xn(t){De=t}let li=null;function lP(t){pe!==null&&(li===null?li=[t]:li.push(t))}let sr=null,yr=0,Lr=null;function uP(t){Lr=t}let lT=1,wo=0,So=wo;function dv(t){So=t}function uT(){return++lT}function rl(t){var e=t.f;if((e&dr)!==0)return!0;if(e&Tt&&(t.f&=~Eo),(e&fi)!==0){for(var r=t.deps,n=r.length,i=0;i<n;i++){var o=r[i];if(rl(o)&&GE(o),o.wv>t.wv)return!0}(e&$r)!==0&&un===null&&_t(t,zt)}return!1}function cT(t,e,r=!0){var n=t.reactions;if(n!==null&&!li?.includes(t))for(var i=0;i<n.length;i++){var o=n[i];(o.f&Tt)!==0?cT(o,e,!1):e===o&&(r?_t(o,dr):(o.f&zt)!==0&&_t(o,fi),Wi(o))}}function hT(t){var e=sr,r=yr,n=Lr,i=pe,o=li,s=Er,a=cn,l=So,u=t.f;sr=null,yr=0,Lr=null,pe=(u&(ji|xo))===0?t:null,li=null,Ps(t.ctx),cn=!1,So=++wo,t.ac!==null&&(uc(()=>{t.ac.abort(vs)}),t.ac=null);try{t.f|=Ug;var c=t.fn,h=c(),d=t.deps;if(sr!==null){var g;if(Lu(t,yr),d!==null&&yr>0)for(d.length=yr+sr.length,g=0;g<sr.length;g++)d[yr+g]=sr[g];else t.deps=d=sr;if(Wm()&&(t.f&$r)!==0)for(g=yr;g<d.length;g++)(d[g].reactions??=[]).push(t)}else d!==null&&yr<d.length&&(Lu(t,yr),d.length=yr);if(VE()&&Lr!==null&&!cn&&d!==null&&(t.f&(Tt|fi|dr))===0)for(g=0;g<Lr.length;g++)cT(Lr[g],t);if(i!==null&&i!==t){if(wo++,i.deps!==null)for(let p=0;p<r;p+=1)i.deps[p].rv=wo;if(e!==null)for(const p of e)p.rv=wo;Lr!==null&&(n===null?n=Lr:n.push(...Lr))}return(t.f&Ni)!==0&&(t.f^=Ni),h}catch(p){return $E(p)}finally{t.f^=Ug,sr=e,yr=r,Lr=n,pe=i,li=o,Ps(s),cn=a,So=l}}function cP(t,e){let r=e.reactions;if(r!==null){var n=mI.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}if(r===null&&(e.f&Tt)!==0&&(sr===null||!sr.includes(e))){var o=e;(o.f&$r)!==0&&(o.f^=$r,o.f&=~Eo),Lm(o),qE(o),Lu(o,0)}}function Lu(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)cP(t,r[n])}function Ga(t){var e=t.f;if((e&Di)===0){_t(t,zt);var r=De,n=bu;De=t,bu=!0;try{(e&(di|DE))!==0?sP(t):iT(t),nT(t);var i=hT(t);t.teardown=typeof i=="function"?i:null,t.wv=lT;var o;jg&&NI&&(t.f&dr)!==0&&t.deps}finally{bu=n,De=r}}}async function hP(){await Promise.resolve(),FI()}function oe(t){var e=t.f,r=(e&Tt)!==0;if(pe!==null&&!cn){var n=De!==null&&(De.f&Di)!==0;if(!n&&!li?.includes(t)){var i=pe.deps;if((pe.f&Ug)!==0)t.rv<wo&&(t.rv=wo,sr===null&&i!==null&&i[yr]===t?yr++:sr===null?sr=[t]:sr.push(t));else{(pe.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[pe]:o.includes(pe)||o.push(pe)}}}if(To&&Li.has(t))return Li.get(t);if(r){var s=t;if(To){var a=s.v;return((s.f&zt)===0&&s.reactions!==null||fT(s))&&(a=Fm(s)),Li.set(s,a),a}var l=(s.f&$r)===0&&!cn&&pe!==null&&(bu||(pe.f&$r)!==0),u=s.deps===null;rl(s)&&(l&&(s.f|=$r),GE(s)),l&&!u&&dT(s)}if(un?.has(t))return un.get(t);if((t.f&Ni)!==0)throw t.v;return t.v}function dT(t){if(t.deps!==null){t.f|=$r;for(const e of t.deps)(e.reactions??=[]).push(t),(e.f&Tt)!==0&&(e.f&$r)===0&&dT(e)}}function fT(t){if(t.v===Rt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Li.has(e)||(e.f&Tt)!==0&&fT(e))return!0;return!1}function hc(t){var e=cn;try{return cn=!0,t()}finally{cn=e}}const dP=["touchstart","touchmove"];function fP(t){return dP.includes(t)}const gT=new Set,Zg=new Set;function gP(t,e,r,n={}){function i(o){if(n.capture||Pa.call(e,o),!o.cancelBubble)return uc(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?ai(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function mP(t,e,r,n,i){var o={capture:n,passive:i},s=gP(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&$m(()=>{e.removeEventListener(t,s,o)})}function pP(t){for(var e=0;e<t.length;e++)gT.add(t[e]);for(var r of Zg)r(t)}let fv=null;function Pa(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;fv=t;var s=0,a=fv===t&&t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){wI(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=pe,h=De;lr(null),xn(null);try{for(var d,g=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+n];v!=null&&(!o.disabled||t.target===o)&&v.call(o,t)}catch(b){d?g.push(b):d=b}if(t.cancelBubble||p===e||p===null)break;o=p}if(d){for(let b of g)queueMicrotask(()=>{throw b});throw d}}finally{t.__root=e,delete t.currentTarget,lr(c),xn(h)}}}function mT(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function pT(t,e){var r=De;r.nodes===null&&(r.nodes={start:t,end:e,a:null,t:null})}function wP(t,e){var r=(e&AI)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=mT(i?t:"<!>"+t));var o=r||ZE?document.importNode(n,!0):n.cloneNode(!0);{var s=po(o),a=o.lastChild;pT(s,a)}return o}}function vP(t,e){t!==null&&t.before(e)}function yP(t,e){return bP(t,e)}const qo=new Map;function bP(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){ZI();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var p=fP(g);e.addEventListener(g,Pa,{passive:p});var v=qo.get(g);v===void 0?(document.addEventListener(g,Pa,{passive:p}),qo.set(g,1)):qo.set(g,v+1)}}};l(pI(gT)),Zg.add(l);var u=void 0,c=nP(()=>{var h=r??e.appendChild(eT());return BI(h,{pending:()=>{}},d=>{if(o){LE({});var g=Er;g.c=o}i&&(n.$$events=i),u=t(d,n)||{},o&&FE()}),()=>{for(var d of a){e.removeEventListener(d,Pa);var g=qo.get(d);--g===0?(document.removeEventListener(d,Pa),qo.delete(d)):qo.set(d,g)}Zg.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return SP.set(u,c),u}let SP=new WeakMap;function CP(t,e,r=!1,n=!1,i=!1){var o=t,s="";rT(()=>{var a=De;if(s!==(s=e()??"")&&(a.nodes!==null&&(oT(a.nodes.start,a.nodes.end),a.nodes=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=mT(l);if((r||n)&&(u=po(u)),pT(po(u),u.lastChild),r||n)for(;po(u);)o.before(po(u));else o.before(u)}})}function RP(t,e,r=e){var n=new WeakSet;Vm(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=rh(t)?nh(o):o,r(o),Ve!==null&&n.add(Ve),await hP(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd,l=t.value.length;if(t.value=o??"",a!==null){var u=t.value.length;s===a&&a===l&&u>l?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=s,t.selectionEnd=Math.min(a,u))}}}),hc(e)==null&&t.value&&(r(rh(t)?nh(t.value):t.value),Ve!==null&&n.add(Ve)),cc(()=>{var i=e();if(t===document.activeElement){var o=Yg??Ve;if(n.has(o))return}rh(t)&&i===nh(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}const th=new Set;function Tl(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??=[];s.push(r),Vm(r,"change",()=>{var l=r.__value;o&&(l=EP(s,l,r.checked)),i(l)},()=>i(o?[]:null)),cc(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=XI(r.__value,l)}),$m(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),th.has(s)||(th.add(s),ai(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),th.delete(s)})),ai(()=>{})}function gv(t,e,r=e){Vm(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),hc(e)==null&&r(t.checked),cc(()=>{var n=e();t.checked=!!n})}function EP(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function rh(t){var e=t.type;return e==="number"||e==="range"}function nh(t){return t===""?null:+t}function TP(t){Er===null&&RI(),rP(()=>{const e=hc(t);if(typeof e=="function")return e})}const _P="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(_P);var mv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pv={},Zs,wv;function at(){if(wv)return Zs;wv=1;var t=function(e){return e&&e.Math===Math&&e};return Zs=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof mv=="object"&&mv)||t(typeof Zs=="object"&&Zs)||(function(){return this})()||Function("return this")(),Zs}var ih={},oh,vv;function dt(){return vv||(vv=1,oh=function(t){try{return!!t()}catch{return!0}}),oh}var sh,yv;function zr(){if(yv)return sh;yv=1;var t=dt();return sh=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),sh}var ah,bv;function dc(){if(bv)return ah;bv=1;var t=dt();return ah=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ah}var lh,Sv;function vt(){if(Sv)return lh;Sv=1;var t=dc(),e=Function.prototype.call;return lh=t?e.bind(e):function(){return e.apply(e,arguments)},lh}var uh={},Cv;function OP(){if(Cv)return uh;Cv=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return uh.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,uh}var ch,Rv;function fc(){return Rv||(Rv=1,ch=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),ch}var hh,Ev;function lt(){if(Ev)return hh;Ev=1;var t=dc(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return hh=t?n:function(i){return function(){return r.apply(i,arguments)}},hh}var dh,Tv;function Ao(){if(Tv)return dh;Tv=1;var t=lt(),e=t({}.toString),r=t("".slice);return dh=function(n){return r(e(n),8,-1)},dh}var fh,_v;function MP(){if(_v)return fh;_v=1;var t=lt(),e=dt(),r=Ao(),n=Object,i=t("".split);return fh=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,fh}var gh,Ov;function Bm(){return Ov||(Ov=1,gh=function(t){return t==null}),gh}var mh,Mv;function nl(){if(Mv)return mh;Mv=1;var t=Bm(),e=TypeError;return mh=function(r){if(t(r))throw new e("Can't call method on "+r);return r},mh}var ph,Iv;function il(){if(Iv)return ph;Iv=1;var t=MP(),e=nl();return ph=function(r){return t(e(r))},ph}var wh,Pv;function ft(){if(Pv)return wh;Pv=1;var t=typeof document=="object"&&document.all;return wh=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},wh}var vh,Hv;function Ur(){if(Hv)return vh;Hv=1;var t=ft();return vh=function(e){return typeof e=="object"?e!==null:t(e)},vh}var yh,xv;function Fs(){if(xv)return yh;xv=1;var t=at(),e=ft(),r=function(n){return e(n)?n:void 0};return yh=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},yh}var bh,Av;function ol(){if(Av)return bh;Av=1;var t=lt();return bh=t({}.isPrototypeOf),bh}var Sh,Dv;function gc(){if(Dv)return Sh;Dv=1;var t=at(),e=t.navigator,r=e&&e.userAgent;return Sh=r?String(r):"",Sh}var Ch,Nv;function IP(){if(Nv)return Ch;Nv=1;var t=at(),e=gc(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Ch=a,Ch}var Rh,kv;function jm(){if(kv)return Rh;kv=1;var t=IP(),e=dt(),r=at(),n=r.String;return Rh=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Rh}var Eh,Lv;function wT(){if(Lv)return Eh;Lv=1;var t=jm();return Eh=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Eh}var Th,Fv;function zm(){if(Fv)return Th;Fv=1;var t=Fs(),e=ft(),r=ol(),n=wT(),i=Object;return Th=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Th}var _h,Vv;function mc(){if(Vv)return _h;Vv=1;var t=String;return _h=function(e){try{return t(e)}catch{return"Object"}},_h}var Oh,Wv;function _r(){if(Wv)return Oh;Wv=1;var t=ft(),e=mc(),r=TypeError;return Oh=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},Oh}var Mh,$v;function sl(){if($v)return Mh;$v=1;var t=_r(),e=Bm();return Mh=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Mh}var Ih,Bv;function PP(){if(Bv)return Ih;Bv=1;var t=vt(),e=ft(),r=Ur(),n=TypeError;return Ih=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},Ih}var Ph={exports:{}},Hh,jv;function Do(){return jv||(jv=1,Hh=!1),Hh}var xh,zv;function Um(){if(zv)return xh;zv=1;var t=at(),e=Object.defineProperty;return xh=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},xh}var Uv;function Ym(){if(Uv)return Ph.exports;Uv=1;var t=Do(),e=at(),r=Um(),n="__core-js_shared__",i=Ph.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Ph.exports}var Ah,Yv;function vT(){if(Yv)return Ah;Yv=1;var t=Ym();return Ah=function(e,r){return t[e]||(t[e]=r||{})},Ah}var Dh,qv;function Vs(){if(qv)return Dh;qv=1;var t=nl(),e=Object;return Dh=function(r){return e(t(r))},Dh}var Nh,Gv;function Yr(){if(Gv)return Nh;Gv=1;var t=lt(),e=Vs(),r=t({}.hasOwnProperty);return Nh=Object.hasOwn||function(i,o){return r(e(i),o)},Nh}var kh,Kv;function yT(){if(Kv)return kh;Kv=1;var t=lt(),e=0,r=Math.random(),n=t(1.1.toString);return kh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},kh}var Lh,Xv;function gn(){if(Xv)return Lh;Xv=1;var t=at(),e=vT(),r=Yr(),n=yT(),i=jm(),o=wT(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Lh=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Lh}var Fh,Zv;function HP(){if(Zv)return Fh;Zv=1;var t=vt(),e=Ur(),r=zm(),n=sl(),i=PP(),o=gn(),s=TypeError,a=o("toPrimitive");return Fh=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Fh}var Vh,Jv;function bT(){if(Jv)return Vh;Jv=1;var t=HP(),e=zm();return Vh=function(r){var n=t(r,"string");return e(n)?n:n+""},Vh}var Wh,Qv;function qm(){if(Qv)return Wh;Qv=1;var t=at(),e=Ur(),r=t.document,n=e(r)&&e(r.createElement);return Wh=function(i){return n?r.createElement(i):{}},Wh}var $h,ey;function ST(){if(ey)return $h;ey=1;var t=zr(),e=dt(),r=qm();return $h=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),$h}var ty;function CT(){if(ty)return ih;ty=1;var t=zr(),e=vt(),r=OP(),n=fc(),i=il(),o=bT(),s=Yr(),a=ST(),l=Object.getOwnPropertyDescriptor;return ih.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},ih}var Bh={},jh,ry;function RT(){if(ry)return jh;ry=1;var t=zr(),e=dt();return jh=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),jh}var zh,ny;function yt(){if(ny)return zh;ny=1;var t=Ur(),e=String,r=TypeError;return zh=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},zh}var iy;function Ui(){if(iy)return Bh;iy=1;var t=zr(),e=ST(),r=RT(),n=yt(),i=bT(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Bh.f=t?r?function(d,g,p){if(n(d),g=i(g),n(p),typeof d=="function"&&g==="prototype"&&"value"in p&&c in p&&!p[c]){var v=a(d,g);v&&v[c]&&(d[g]=p.value,p={configurable:u in p?p[u]:v[u],enumerable:l in p?p[l]:v[l],writable:!1})}return s(d,g,p)}:s:function(d,g,p){if(n(d),g=i(g),n(p),e)try{return s(d,g,p)}catch{}if("get"in p||"set"in p)throw new o("Accessors not supported");return"value"in p&&(d[g]=p.value),d},Bh}var Uh,oy;function Ws(){if(oy)return Uh;oy=1;var t=zr(),e=Ui(),r=fc();return Uh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},Uh}var Yh={exports:{}},qh,sy;function xP(){if(sy)return qh;sy=1;var t=zr(),e=Yr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return qh={EXISTS:i,PROPER:o,CONFIGURABLE:s},qh}var Gh,ay;function AP(){if(ay)return Gh;ay=1;var t=lt(),e=ft(),r=Ym(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Gh=r.inspectSource,Gh}var Kh,ly;function DP(){if(ly)return Kh;ly=1;var t=at(),e=ft(),r=t.WeakMap;return Kh=e(r)&&/native code/.test(String(r)),Kh}var Xh,uy;function Gm(){if(uy)return Xh;uy=1;var t=vT(),e=yT(),r=t("keys");return Xh=function(n){return r[n]||(r[n]=e(n))},Xh}var Zh,cy;function Km(){return cy||(cy=1,Zh={}),Zh}var Jh,hy;function ET(){if(hy)return Jh;hy=1;var t=DP(),e=at(),r=Ur(),n=Ws(),i=Yr(),o=Ym(),s=Gm(),a=Km(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,p=function(S){return g(S)?d(S):h(S,{})},v=function(S){return function(T){var y;if(!r(T)||(y=d(T)).type!==S)throw new u("Incompatible receiver, "+S+" required");return y}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(S,T){if(b.has(S))throw new u(l);return T.facade=S,b.set(S,T),T},d=function(S){return b.get(S)||{}},g=function(S){return b.has(S)}}else{var E=s("state");a[E]=!0,h=function(S,T){if(i(S,E))throw new u(l);return T.facade=S,n(S,E,T),T},d=function(S){return i(S,E)?S[E]:{}},g=function(S){return i(S,E)}}return Jh={set:h,get:d,has:g,enforce:p,getterFor:v},Jh}var dy;function TT(){if(dy)return Yh.exports;dy=1;var t=lt(),e=dt(),r=ft(),n=Yr(),i=zr(),o=xP().CONFIGURABLE,s=AP(),a=ET(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),p=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),E=Yh.exports=function(S,T,y){d(c(T),0,7)==="Symbol("&&(T="["+g(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),y&&y.getter&&(T="get "+T),y&&y.setter&&(T="set "+T),(!n(S,"name")||o&&S.name!==T)&&(i?h(S,"name",{value:T,configurable:!0}):S.name=T),v&&y&&n(y,"arity")&&S.length!==y.arity&&h(S,"length",{value:y.arity});try{y&&n(y,"constructor")&&y.constructor?i&&h(S,"prototype",{writable:!1}):S.prototype&&(S.prototype=void 0)}catch{}var M=l(S);return n(M,"source")||(M.source=p(b,typeof T=="string"?T:"")),S};return Function.prototype.toString=E(function(){return r(this)&&u(this).source||s(this)},"toString"),Yh.exports}var Qh,fy;function Xm(){if(fy)return Qh;fy=1;var t=ft(),e=Ui(),r=TT(),n=Um();return Qh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Qh}var ed={},td,gy;function NP(){if(gy)return td;gy=1;var t=Math.ceil,e=Math.floor;return td=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},td}var rd,my;function al(){if(my)return rd;my=1;var t=NP();return rd=function(e){var r=+e;return r!==r||r===0?0:t(r)},rd}var nd,py;function kP(){if(py)return nd;py=1;var t=al(),e=Math.max,r=Math.min;return nd=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},nd}var id,wy;function LP(){if(wy)return id;wy=1;var t=al(),e=Math.min;return id=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},id}var od,vy;function $s(){if(vy)return od;vy=1;var t=LP();return od=function(e){return t(e.length)},od}var sd,yy;function FP(){if(yy)return sd;yy=1;var t=il(),e=kP(),r=$s(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return sd={includes:n(!0),indexOf:n(!1)},sd}var ad,by;function _T(){if(by)return ad;by=1;var t=lt(),e=Yr(),r=il(),n=FP().indexOf,i=Km(),o=t([].push);return ad=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},ad}var ld,Sy;function Zm(){return Sy||(Sy=1,ld=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),ld}var Cy;function VP(){if(Cy)return ed;Cy=1;var t=_T(),e=Zm(),r=e.concat("length","prototype");return ed.f=Object.getOwnPropertyNames||function(i){return t(i,r)},ed}var ud={},Ry;function WP(){return Ry||(Ry=1,ud.f=Object.getOwnPropertySymbols),ud}var cd,Ey;function $P(){if(Ey)return cd;Ey=1;var t=Fs(),e=lt(),r=VP(),n=WP(),i=yt(),o=e([].concat);return cd=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},cd}var hd,Ty;function OT(){if(Ty)return hd;Ty=1;var t=Yr(),e=$P(),r=CT(),n=Ui();return hd=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},hd}var dd,_y;function BP(){if(_y)return dd;_y=1;var t=dt(),e=ft(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return dd=n,dd}var fd,Oy;function Fe(){if(Oy)return fd;Oy=1;var t=at(),e=CT().f,r=Ws(),n=Xm(),i=Um(),o=OT(),s=BP();return fd=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,p,v,b,E;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(p in l){if(b=l[p],a.dontCallGetSet?(E=e(g,p),v=E&&E.value):v=g[p],d=s(c?p:u+(h?".":"#")+p,a.forced),!d&&v!==void 0){if(typeof b==typeof v)continue;o(b,v)}(a.sham||v&&v.sham)&&r(b,"sham",!0),n(g,p,b,a)}},fd}var gd,My;function ll(){if(My)return gd;My=1;var t=dc(),e=Function.prototype,r=e.apply,n=e.call;return gd=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),gd}var md,Iy;function MT(){if(Iy)return md;Iy=1;var t=lt(),e=_r();return md=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},md}var pd,Py;function jP(){if(Py)return pd;Py=1;var t=Ur();return pd=function(e){return t(e)||e===null},pd}var wd,Hy;function zP(){if(Hy)return wd;Hy=1;var t=jP(),e=String,r=TypeError;return wd=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},wd}var vd,xy;function IT(){if(xy)return vd;xy=1;var t=MT(),e=Ur(),r=nl(),n=zP();return vd=Object.setPrototypeOf||("__proto__"in{}?(function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}})():void 0),vd}var yd,Ay;function UP(){if(Ay)return yd;Ay=1;var t=Ui().f;return yd=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},yd}var bd,Dy;function YP(){if(Dy)return bd;Dy=1;var t=ft(),e=Ur(),r=IT();return bd=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},bd}var Sd,Ny;function qP(){if(Ny)return Sd;Ny=1;var t=gn(),e=t("toStringTag"),r={};return r[e]="z",Sd=String(r)==="[object z]",Sd}var Cd,ky;function PT(){if(ky)return Cd;ky=1;var t=qP(),e=ft(),r=Ao(),n=gn(),i=n("toStringTag"),o=Object,s=r((function(){return arguments})())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Cd=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},Cd}var Rd,Ly;function pc(){if(Ly)return Rd;Ly=1;var t=PT(),e=String;return Rd=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Rd}var Ed,Fy;function GP(){if(Fy)return Ed;Fy=1;var t=pc();return Ed=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Ed}var Td,Vy;function KP(){if(Vy)return Td;Vy=1;var t=Ur(),e=Ws();return Td=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Td}var _d,Wy;function XP(){if(Wy)return _d;Wy=1;var t=lt(),e=Error,r=t("".replace),n=(function(s){return String(new e(s).stack)})("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return _d=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},_d}var Od,$y;function ZP(){if($y)return Od;$y=1;var t=dt(),e=fc();return Od=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),Od}var Md,By;function JP(){if(By)return Md;By=1;var t=Ws(),e=XP(),r=ZP(),n=Error.captureStackTrace;return Md=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Md}var Id,jy;function QP(){if(jy)return Id;jy=1;var t=Fs(),e=Yr(),r=Ws(),n=ol(),i=IT(),o=OT(),s=UP(),a=YP(),l=GP(),u=KP(),c=JP(),h=zr(),d=Do();return Id=function(g,p,v,b){var E="stackTraceLimit",S=b?2:1,T=g.split("."),y=T[T.length-1],M=t.apply(null,T);if(M){var H=M.prototype;if(!d&&e(H,"cause")&&delete H.cause,!v)return M;var P=t("Error"),A=p(function(F,W){var K=l(b?W:F,void 0),L=b?new M(F):new M;return K!==void 0&&r(L,"message",K),c(L,A,L.stack,2),this&&n(H,this)&&a(L,this,A),arguments.length>S&&u(L,arguments[S]),L});if(A.prototype=H,y!=="Error"?i?i(A,P):o(A,P,{name:!0}):h&&E in M&&(s(A,M,E),s(A,M,"prepareStackTrace")),o(A,M),!d)try{H.name!==y&&r(H,"name",y),H.constructor=A}catch{}return A}},Id}var zy;function eH(){if(zy)return pv;zy=1;var t=Fe(),e=at(),r=ll(),n=QP(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),pv}eH();var Uy={},Pd,Yy;function HT(){if(Yy)return Pd;Yy=1;var t=Ao();return Pd=Array.isArray||function(r){return t(r)==="Array"},Pd}var Hd,qy;function xT(){if(qy)return Hd;qy=1;var t=zr(),e=HT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}})();return Hd=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Hd}var xd,Gy;function AT(){if(Gy)return xd;Gy=1;var t=TypeError,e=9007199254740991;return xd=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},xd}var Ky;function tH(){if(Ky)return Uy;Ky=1;var t=Fe(),e=Vs(),r=$s(),n=xT(),i=AT(),o=dt(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var p=0;p<g;p++)h[d]=arguments[p],d++;return n(h,d),d}}),Uy}tH();var Xy={},Ad,Zy;function rH(){if(Zy)return Ad;Zy=1;var t=Ao(),e=lt();return Ad=function(r){if(t(r)==="Function")return e(r)},Ad}var Dd,Jy;function DT(){if(Jy)return Dd;Jy=1;var t=rH(),e=_r(),r=dc(),n=t(t.bind);return Dd=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},Dd}var Nd,Qy;function NT(){return Qy||(Qy=1,Nd={}),Nd}var kd,eb;function nH(){if(eb)return kd;eb=1;var t=gn(),e=NT(),r=t("iterator"),n=Array.prototype;return kd=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},kd}var Ld,tb;function kT(){if(tb)return Ld;tb=1;var t=PT(),e=sl(),r=Bm(),n=NT(),i=gn(),o=i("iterator");return Ld=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Ld}var Fd,rb;function iH(){if(rb)return Fd;rb=1;var t=vt(),e=_r(),r=yt(),n=mc(),i=kT(),o=TypeError;return Fd=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Fd}var Vd,nb;function Or(){if(nb)return Vd;nb=1;var t=vt(),e=yt(),r=sl();return Vd=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Vd}var Wd,ib;function Bs(){if(ib)return Wd;ib=1;var t=DT(),e=vt(),r=yt(),n=mc(),i=nH(),o=$s(),s=ol(),a=iH(),l=kT(),u=Or(),c=TypeError,h=function(g,p){this.stopped=g,this.result=p},d=h.prototype;return Wd=function(g,p,v){var b=v&&v.that,E=!!(v&&v.AS_ENTRIES),S=!!(v&&v.IS_RECORD),T=!!(v&&v.IS_ITERATOR),y=!!(v&&v.INTERRUPTED),M=t(p,b),H,P,A,F,W,K,L,ie=function(te){return H&&u(H,"normal"),new h(!0,te)},G=function(te){return E?(r(te),y?M(te[0],te[1],ie):M(te[0],te[1])):y?M(te,ie):M(te)};if(S)H=g.iterator;else if(T)H=g;else{if(P=l(g),!P)throw new c(n(g)+" is not iterable");if(i(P)){for(A=0,F=o(g);F>A;A++)if(W=G(g[A]),W&&s(d,W))return W;return new h(!1)}H=a(g,P)}for(K=S?g.next:H.next;!(L=e(K,H)).done;){try{W=G(L.value)}catch(te){u(H,"throw",te)}if(typeof W=="object"&&W&&s(d,W))return W}return new h(!1)},Wd}var $d,ob;function LT(){if(ob)return $d;ob=1;var t=zr(),e=Ui(),r=fc();return $d=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},$d}var sb;function oH(){if(sb)return Xy;sb=1;var t=Fe(),e=Bs(),r=LT();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),Xy}oH();var ab={},Bd,lb;function Nn(){if(lb)return Bd;lb=1;var t=lt(),e=Set.prototype;return Bd={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Bd}var jd,ub;function No(){if(ub)return jd;ub=1;var t=Nn().has;return jd=function(e){return t(e),e},jd}var zd,cb;function ko(){if(cb)return zd;cb=1;var t=vt();return zd=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},zd}var Ud,hb;function ul(){if(hb)return Ud;hb=1;var t=lt(),e=ko(),r=Nn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return Ud=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Ud}var Yd,db;function Jm(){if(db)return Yd;db=1;var t=Nn(),e=ul(),r=t.Set,n=t.add;return Yd=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},Yd}var qd,fb;function cl(){if(fb)return qd;fb=1;var t=MT(),e=Nn();return qd=t(e.proto,"size","get")||function(r){return r.size},qd}var Gd,gb;function Yi(){return gb||(gb=1,Gd=function(t){return{iterator:t,next:t.next,done:!1}}),Gd}var Kd,mb;function Lo(){if(mb)return Kd;mb=1;var t=_r(),e=yt(),r=vt(),n=al(),i=Yi(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},Kd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},Kd}var Xd,pb;function sH(){if(pb)return Xd;pb=1;var t=No(),e=Nn(),r=Jm(),n=cl(),i=Lo(),o=ul(),s=ko(),a=e.has,l=e.remove;return Xd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(p){d.includes(p)&&l(g,p)}):s(d.getIterator(),function(p){a(g,p)&&l(g,p)}),g},Xd}var Zd,wb;function Fo(){if(wb)return Zd;wb=1;var t=Fs(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Zd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Zd}var vb;function aH(){if(vb)return ab;vb=1;var t=Fe(),e=sH(),r=dt(),n=Fo(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),ab}aH();var yb={},Jd,bb;function lH(){if(bb)return Jd;bb=1;var t=No(),e=Nn(),r=cl(),n=Lo(),i=ul(),o=ko(),s=e.Set,a=e.add,l=e.has;return Jd=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(p){l(h,p)&&a(g,p)}):i(h,function(p){d.includes(p)&&a(g,p)}),g},Jd}var Sb;function uH(){if(Sb)return yb;Sb=1;var t=Fe(),e=dt(),r=lH(),n=Fo(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),yb}uH();var Cb={},Qd,Rb;function cH(){if(Rb)return Qd;Rb=1;var t=No(),e=Nn().has,r=cl(),n=Lo(),i=ul(),o=ko(),s=Or();return Qd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},Qd}var Eb;function hH(){if(Eb)return Cb;Eb=1;var t=Fe(),e=cH(),r=Fo(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),Cb}hH();var Tb={},ef,_b;function dH(){if(_b)return ef;_b=1;var t=No(),e=cl(),r=ul(),n=Lo();return ef=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},ef}var Ob;function fH(){if(Ob)return Tb;Ob=1;var t=Fe(),e=dH(),r=Fo(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),Tb}fH();var Mb={},tf,Ib;function gH(){if(Ib)return tf;Ib=1;var t=No(),e=Nn().has,r=cl(),n=Lo(),i=ko(),o=Or();return tf=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},tf}var Pb;function mH(){if(Pb)return Mb;Pb=1;var t=Fe(),e=gH(),r=Fo(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Mb}mH();var Hb={},rf,xb;function pH(){if(xb)return rf;xb=1;var t=No(),e=Nn(),r=Jm(),n=Lo(),i=ko(),o=e.add,s=e.has,a=e.remove;return rf=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},rf}var nf,Ab;function FT(){return Ab||(Ab=1,nf=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),nf}var Db;function wH(){if(Db)return Hb;Db=1;var t=Fe(),e=pH(),r=FT(),n=Fo(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Hb}wH();var Nb={},of,kb;function vH(){if(kb)return of;kb=1;var t=No(),e=Nn().add,r=Jm(),n=Lo(),i=ko();return of=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},of}var Lb;function yH(){if(Lb)return Nb;Lb=1;var t=Fe(),e=vH(),r=FT(),n=Fo(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),Nb}yH();var Fb={},Vb={},sf,Wb;function bH(){if(Wb)return sf;Wb=1;var t=ol(),e=TypeError;return sf=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},sf}var af,$b;function SH(){if($b)return af;$b=1;var t=dt();return af=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),af}var lf,Bb;function VT(){if(Bb)return lf;Bb=1;var t=Yr(),e=ft(),r=Vs(),n=Gm(),i=SH(),o=n("IE_PROTO"),s=Object,a=s.prototype;return lf=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},lf}var uf,jb;function CH(){if(jb)return uf;jb=1;var t=TT(),e=Ui();return uf=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},uf}var cf={},hf,zb;function RH(){if(zb)return hf;zb=1;var t=_T(),e=Zm();return hf=Object.keys||function(n){return t(n,e)},hf}var Ub;function EH(){if(Ub)return cf;Ub=1;var t=zr(),e=RT(),r=Ui(),n=yt(),i=il(),o=RH();return cf.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},cf}var df,Yb;function WT(){if(Yb)return df;Yb=1;var t=Fs();return df=t("document","documentElement"),df}var ff,qb;function Qm(){if(qb)return ff;qb=1;var t=yt(),e=EH(),r=Zm(),n=Km(),i=WT(),o=qm(),s=Gm(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(S){return l+c+a+S+l+"/"+c+a},p=function(S){S.write(g("")),S.close();var T=S.parentWindow.Object;return S=null,T},v=function(){var S=o("iframe"),T="java"+c+":",y;return S.style.display="none",i.appendChild(S),S.src=String(T),y=S.contentWindow.document,y.open(),y.write(g("document.F=Object")),y.close(),y.F},b,E=function(){try{b=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&b?p(b):v():p(b);for(var S=r.length;S--;)delete E[u][r[S]];return E()};return n[h]=!0,ff=Object.create||function(T,y){var M;return T!==null?(d[u]=t(T),M=new d,d[u]=null,M[h]=T):M=E(),y===void 0?M:e.f(M,y)},ff}var gf,Gb;function $T(){if(Gb)return gf;Gb=1;var t=dt(),e=ft(),r=Ur(),n=Qm(),i=VT(),o=Xm(),s=gn(),a=Do(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var p={};return c[l].call(p)!==p});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),gf={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},gf}var Kb;function TH(){if(Kb)return Vb;Kb=1;var t=Fe(),e=at(),r=bH(),n=yt(),i=ft(),o=VT(),s=CH(),a=LT(),l=dt(),u=Yr(),c=gn(),h=$T().IteratorPrototype,d=zr(),g=Do(),p="constructor",v="Iterator",b=c("toStringTag"),E=TypeError,S=e[v],T=g||!i(S)||S.prototype!==h||!l(function(){S({})}),y=function(){if(r(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},M=function(H,P){d?s(h,H,{configurable:!0,get:function(){return P},set:function(A){if(n(this),this===h)throw new E("You can't redefine this property");u(this,H)?this[H]=A:a(this,H,A)}}):h[H]=P};return u(h,b)||M(b,v),(T||!u(h,p)||h[p]===Object)&&M(p,y),y.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:y}),Vb}var Xb;function _H(){return Xb||(Xb=1,TH()),Fb}_H();var Zb={},Jb={},mf,Qb;function OH(){if(Qb)return mf;Qb=1;var t=Xm();return mf=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},mf}var pf,eS;function MH(){return eS||(eS=1,pf=function(t,e){return{value:t,done:e}}),pf}var wf,tS;function IH(){if(tS)return wf;tS=1;var t=Or();return wf=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},wf}var vf,rS;function BT(){if(rS)return vf;rS=1;var t=vt(),e=Qm(),r=Ws(),n=OH(),i=gn(),o=ET(),s=sl(),a=$T().IteratorPrototype,l=MH(),u=Or(),c=IH(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",p="normal",v="throw",b=o.set,E=function(y){var M=o.getterFor(y?g:d);return n(e(a),{next:function(){var P=M(this);if(y)return P.nextHandler();if(P.done)return l(void 0,!0);try{var A=P.nextHandler();return P.returnHandlerResult?A:l(A,P.done)}catch(F){throw P.done=!0,F}},return:function(){var H=M(this),P=H.iterator;if(H.done=!0,y){var A=s(P,"return");return A?t(A,P):l(void 0,!0)}if(H.inner)try{u(H.inner.iterator,p)}catch(F){return u(P,v,F)}if(H.openIters)try{c(H.openIters,p)}catch(F){return u(P,v,F)}return P&&u(P,p),l(void 0,!0)}})},S=E(!0),T=E(!1);return r(T,h,"Iterator Helper"),vf=function(y,M,H){var P=function(F,W){W?(W.iterator=F.iterator,W.next=F.next):W=F,W.type=M?g:d,W.returnHandlerResult=!!H,W.nextHandler=y,W.counter=0,W.done=!1,b(this,W)};return P.prototype=M?S:T,P},vf}var yf,nS;function jT(){if(nS)return yf;nS=1;var t=yt(),e=Or();return yf=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},yf}var bf,iS;function zT(){return iS||(iS=1,bf=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),bf}var Sf,oS;function Vo(){if(oS)return Sf;oS=1;var t=at();return Sf=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},Sf}var sS;function PH(){if(sS)return Jb;sS=1;var t=Fe(),e=vt(),r=_r(),n=yt(),i=Yi(),o=BT(),s=jT(),a=Do(),l=Or(),u=zT(),c=Vo(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,p=o(function(){for(var v=this.iterator,b=this.predicate,E=this.next,S,T,y;;){if(S=n(e(E,v)),T=this.done=!!S.done,T)return;if(y=S.value,s(v,b,[y,this.counter++],!0))return y}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(E){l(this,"throw",E)}return d?e(d,this,b):new p(i(this),{predicate:b})}}),Jb}var aS;function HH(){return aS||(aS=1,PH()),Zb}HH();var lS={},uS={},cS;function xH(){if(cS)return uS;cS=1;var t=Fe(),e=vt(),r=Bs(),n=_r(),i=yt(),o=Yi(),s=Or(),a=Vo(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),uS}var hS;function AH(){return hS||(hS=1,xH()),lS}AH();var dS={},fS={},gS;function DH(){if(gS)return fS;gS=1;var t=Fe(),e=vt(),r=_r(),n=yt(),i=Yi(),o=BT(),s=jT(),a=Or(),l=zT(),u=Vo(),c=Do(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,p=o(function(){var v=this.iterator,b=n(e(this.next,v)),E=this.done=!!b.done;if(!E)return s(v,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new p(i(this),{mapper:b})}}),fS}var mS;function NH(){return mS||(mS=1,DH()),dS}NH();var pS={},wS={},Cf,vS;function ep(){if(vS)return Cf;vS=1;var t=lt();return Cf=t([].slice),Cf}var Rf,yS;function UT(){if(yS)return Rf;yS=1;var t=TypeError;return Rf=function(e,r){if(e<r)throw new t("Not enough arguments");return e},Rf}var Ef,bS;function kH(){if(bS)return Ef;bS=1;var t=gc();return Ef=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Ef}var Tf,SS;function YT(){if(SS)return Tf;SS=1;var t=at(),e=gc(),r=Ao(),n=function(i){return e.slice(0,i.length)===i};return Tf=(function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"})(),Tf}var _f,CS;function LH(){if(CS)return _f;CS=1;var t=YT();return _f=t==="NODE",_f}var Of,RS;function qT(){if(RS)return Of;RS=1;var t=at(),e=ll(),r=DT(),n=ft(),i=Yr(),o=dt(),s=WT(),a=ep(),l=qm(),u=UT(),c=kH(),h=LH(),d=t.setImmediate,g=t.clearImmediate,p=t.process,v=t.Dispatch,b=t.Function,E=t.MessageChannel,S=t.String,T=0,y={},M="onreadystatechange",H,P,A,F;o(function(){H=t.location});var W=function(G){if(i(y,G)){var te=y[G];delete y[G],te()}},K=function(G){return function(){W(G)}},L=function(G){W(G.data)},ie=function(G){t.postMessage(S(G),H.protocol+"//"+H.host)};return(!d||!g)&&(d=function(te){u(arguments.length,1);var tt=n(te)?te:b(te),Ie=a(arguments,1);return y[++T]=function(){e(tt,void 0,Ie)},P(T),T},g=function(te){delete y[te]},h?P=function(G){p.nextTick(K(G))}:v&&v.now?P=function(G){v.now(K(G))}:E&&!c?(A=new E,F=A.port2,A.port1.onmessage=L,P=r(F.postMessage,F)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&H&&H.protocol!=="file:"&&!o(ie)?(P=ie,t.addEventListener("message",L,!1)):M in l("script")?P=function(G){s.appendChild(l("script"))[M]=function(){s.removeChild(this),W(G)}}:P=function(G){setTimeout(K(G),0)}),Of={set:d,clear:g},Of}var ES;function FH(){if(ES)return wS;ES=1;var t=Fe(),e=at(),r=qT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),wS}var TS={},Mf,_S;function VH(){if(_S)return Mf;_S=1;var t=at(),e=ll(),r=ft(),n=YT(),i=gc(),o=ep(),s=UT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&(function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")})();return Mf=function(u,c){var h=c?2:1;return l?function(d,g){var p=s(arguments.length,1)>h,v=r(d)?d:a(d),b=p?o(arguments,h):[],E=p?function(){e(v,this,b)}:v;return c?u(E,g):u(E)}:u},Mf}var OS;function WH(){if(OS)return TS;OS=1;var t=Fe(),e=at(),r=qT().set,n=VH(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),TS}var MS;function $H(){return MS||(MS=1,FH(),WH()),pS}$H();const{entries:GT,setPrototypeOf:IS,isFrozen:BH,getPrototypeOf:jH,getOwnPropertyDescriptor:zH}=Object;let{freeze:Yt,seal:Br,create:KT}=Object,{apply:Jg,construct:Qg}=typeof Reflect<"u"&&Reflect;Yt||(Yt=function(e){return e});Br||(Br=function(e){return e});Jg||(Jg=function(e,r,n){return e.apply(r,n)});Qg||(Qg=function(e,r){return new e(...r)});const _l=qt(Array.prototype.forEach),UH=qt(Array.prototype.lastIndexOf),PS=qt(Array.prototype.pop),Js=qt(Array.prototype.push),YH=qt(Array.prototype.splice),Su=qt(String.prototype.toLowerCase),If=qt(String.prototype.toString),HS=qt(String.prototype.match),Qs=qt(String.prototype.replace),qH=qt(String.prototype.indexOf),GH=qt(String.prototype.trim),on=qt(Object.prototype.hasOwnProperty),Ft=qt(RegExp.prototype.test),ea=KH(TypeError);function qt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Jg(t,e,n)}}function KH(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Qg(t,r)}}function de(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Su;IS&&IS(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(BH(e)||(e[n]=o),i=o)}t[i]=!0}return t}function XH(t){for(let e=0;e<t.length;e++)on(t,e)||(t[e]=null);return t}function ei(t){const e=KT(null);for(const[r,n]of GT(t))on(t,r)&&(Array.isArray(n)?e[r]=XH(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=ei(n):e[r]=n);return e}function ta(t,e){for(;t!==null;){const n=zH(t,e);if(n){if(n.get)return qt(n.get);if(typeof n.value=="function")return qt(n.value)}t=jH(t)}function r(){return null}return r}const xS=Yt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Pf=Yt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Hf=Yt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ZH=Yt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xf=Yt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),JH=Yt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),AS=Yt(["#text"]),DS=Yt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Af=Yt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),NS=Yt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ol=Yt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),QH=Br(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ex=Br(/<%[\w\W]*|[\w\W]*%>/gm),tx=Br(/\$\{[\w\W]*/gm),rx=Br(/^data-[\-\w.\u00B7-\uFFFF]+$/),nx=Br(/^aria-[\-\w]+$/),XT=Br(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ix=Br(/^(?:\w+script|data):/i),ox=Br(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ZT=Br(/^html$/i),sx=Br(/^[a-z][.\w]*(-[.\w]+)+$/i);var kS=Object.freeze({__proto__:null,ARIA_ATTR:nx,ATTR_WHITESPACE:ox,CUSTOM_ELEMENT:sx,DATA_ATTR:rx,DOCTYPE_NAME:ZT,ERB_EXPR:ex,IS_ALLOWED_URI:XT,IS_SCRIPT_OR_DATA:ix,MUSTACHE_EXPR:QH,TMPLIT_EXPR:tx});const ra={element:1,text:3,progressingInstruction:7,comment:8,document:9},ax=function(){return typeof window>"u"?null:window},lx=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},LS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function JT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ax();const e=J=>JT(J);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==ra.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,p=l.prototype,v=ta(p,"cloneNode"),b=ta(p,"remove"),E=ta(p,"nextSibling"),S=ta(p,"childNodes"),T=ta(p,"parentNode");if(typeof s=="function"){const J=r.createElement("template");J.content&&J.content.ownerDocument&&(r=J.content.ownerDocument)}let y,M="";const{implementation:H,createNodeIterator:P,createDocumentFragment:A,getElementsByTagName:F}=r,{importNode:W}=n;let K=LS();e.isSupported=typeof GT=="function"&&typeof T=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:ie,TMPLIT_EXPR:G,DATA_ATTR:te,ARIA_ATTR:tt,IS_SCRIPT_OR_DATA:Ie,ATTR_WHITESPACE:Ce,CUSTOM_ELEMENT:Be}=kS;let{IS_ALLOWED_URI:je}=kS,Pe=null;const Ir=de({},[...xS,...Pf,...Hf,...xf,...AS]);let He=null;const Dt=de({},[...DS,...Af,...NS,...Ol]);let f=Object.seal(KT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),m=null,w=null,C=!0,_=!0,O=!1,x=!0,D=!1,q=!0,$=!1,I=!1,B=!1,X=!1,ae=!1,ye=!1,ce=!0,fe=!1;const Le="user-content-";let he=!0,xe=!1,bt={},Nt=null;const Wn=de({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $n=null;const kt=de({},["audio","video","img","source","image","track"]);let pt=null;const Pr=de({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),wn="http://www.w3.org/1998/Math/MathML",Xr="http://www.w3.org/2000/svg",Hr="http://www.w3.org/1999/xhtml";let Bn=Hr,Gi=!1,gr=null;const zo=de({},[wn,Xr,Hr],If);let Zr=de({},["mi","mo","mn","ms","mtext"]),vn=de({},["annotation-xml"]);const Ks=de({},["title","style","font","a","script"]);let Ot=null;const mr=["application/xhtml+xml","text/html"],Rl="text/html";let rt=null,Uo=null;const cI=r.createElement("form"),Gw=function(R){return R instanceof RegExp||R instanceof Function},Jc=function(){let R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Uo&&Uo===R)){if((!R||typeof R!="object")&&(R={}),R=ei(R),Ot=mr.indexOf(R.PARSER_MEDIA_TYPE)===-1?Rl:R.PARSER_MEDIA_TYPE,rt=Ot==="application/xhtml+xml"?If:Su,Pe=on(R,"ALLOWED_TAGS")?de({},R.ALLOWED_TAGS,rt):Ir,He=on(R,"ALLOWED_ATTR")?de({},R.ALLOWED_ATTR,rt):Dt,gr=on(R,"ALLOWED_NAMESPACES")?de({},R.ALLOWED_NAMESPACES,If):zo,pt=on(R,"ADD_URI_SAFE_ATTR")?de(ei(Pr),R.ADD_URI_SAFE_ATTR,rt):Pr,$n=on(R,"ADD_DATA_URI_TAGS")?de(ei(kt),R.ADD_DATA_URI_TAGS,rt):kt,Nt=on(R,"FORBID_CONTENTS")?de({},R.FORBID_CONTENTS,rt):Wn,m=on(R,"FORBID_TAGS")?de({},R.FORBID_TAGS,rt):ei({}),w=on(R,"FORBID_ATTR")?de({},R.FORBID_ATTR,rt):ei({}),bt=on(R,"USE_PROFILES")?R.USE_PROFILES:!1,C=R.ALLOW_ARIA_ATTR!==!1,_=R.ALLOW_DATA_ATTR!==!1,O=R.ALLOW_UNKNOWN_PROTOCOLS||!1,x=R.ALLOW_SELF_CLOSE_IN_ATTR!==!1,D=R.SAFE_FOR_TEMPLATES||!1,q=R.SAFE_FOR_XML!==!1,$=R.WHOLE_DOCUMENT||!1,X=R.RETURN_DOM||!1,ae=R.RETURN_DOM_FRAGMENT||!1,ye=R.RETURN_TRUSTED_TYPE||!1,B=R.FORCE_BODY||!1,ce=R.SANITIZE_DOM!==!1,fe=R.SANITIZE_NAMED_PROPS||!1,he=R.KEEP_CONTENT!==!1,xe=R.IN_PLACE||!1,je=R.ALLOWED_URI_REGEXP||XT,Bn=R.NAMESPACE||Hr,Zr=R.MATHML_TEXT_INTEGRATION_POINTS||Zr,vn=R.HTML_INTEGRATION_POINTS||vn,f=R.CUSTOM_ELEMENT_HANDLING||{},R.CUSTOM_ELEMENT_HANDLING&&Gw(R.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(f.tagNameCheck=R.CUSTOM_ELEMENT_HANDLING.tagNameCheck),R.CUSTOM_ELEMENT_HANDLING&&Gw(R.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(f.attributeNameCheck=R.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),R.CUSTOM_ELEMENT_HANDLING&&typeof R.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(f.allowCustomizedBuiltInElements=R.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),D&&(_=!1),ae&&(X=!0),bt&&(Pe=de({},AS),He=[],bt.html===!0&&(de(Pe,xS),de(He,DS)),bt.svg===!0&&(de(Pe,Pf),de(He,Af),de(He,Ol)),bt.svgFilters===!0&&(de(Pe,Hf),de(He,Af),de(He,Ol)),bt.mathMl===!0&&(de(Pe,xf),de(He,NS),de(He,Ol))),R.ADD_TAGS&&(Pe===Ir&&(Pe=ei(Pe)),de(Pe,R.ADD_TAGS,rt)),R.ADD_ATTR&&(He===Dt&&(He=ei(He)),de(He,R.ADD_ATTR,rt)),R.ADD_URI_SAFE_ATTR&&de(pt,R.ADD_URI_SAFE_ATTR,rt),R.FORBID_CONTENTS&&(Nt===Wn&&(Nt=ei(Nt)),de(Nt,R.FORBID_CONTENTS,rt)),he&&(Pe["#text"]=!0),$&&de(Pe,["html","head","body"]),Pe.table&&(de(Pe,["tbody"]),delete m.tbody),R.TRUSTED_TYPES_POLICY){if(typeof R.TRUSTED_TYPES_POLICY.createHTML!="function")throw ea('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof R.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ea('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=R.TRUSTED_TYPES_POLICY,M=y.createHTML("")}else y===void 0&&(y=lx(g,i)),y!==null&&typeof M=="string"&&(M=y.createHTML(""));Yt&&Yt(R),Uo=R}},Kw=de({},[...Pf,...Hf,...ZH]),Xw=de({},[...xf,...JH]),hI=function(R){let k=T(R);(!k||!k.tagName)&&(k={namespaceURI:Bn,tagName:"template"});const Y=Su(R.tagName),ze=Su(k.tagName);return gr[R.namespaceURI]?R.namespaceURI===Xr?k.namespaceURI===Hr?Y==="svg":k.namespaceURI===wn?Y==="svg"&&(ze==="annotation-xml"||Zr[ze]):!!Kw[Y]:R.namespaceURI===wn?k.namespaceURI===Hr?Y==="math":k.namespaceURI===Xr?Y==="math"&&vn[ze]:!!Xw[Y]:R.namespaceURI===Hr?k.namespaceURI===Xr&&!vn[ze]||k.namespaceURI===wn&&!Zr[ze]?!1:!Xw[Y]&&(Ks[Y]||!Kw[Y]):!!(Ot==="application/xhtml+xml"&&gr[R.namespaceURI]):!1},yn=function(R){Js(e.removed,{element:R});try{T(R).removeChild(R)}catch{b(R)}},Yo=function(R,k){try{Js(e.removed,{attribute:k.getAttributeNode(R),from:k})}catch{Js(e.removed,{attribute:null,from:k})}if(k.removeAttribute(R),R==="is")if(X||ae)try{yn(k)}catch{}else try{k.setAttribute(R,"")}catch{}},Zw=function(R){let k=null,Y=null;if(B)R="<remove></remove>"+R;else{const gt=HS(R,/^[\r\n\t ]+/);Y=gt&&gt[0]}Ot==="application/xhtml+xml"&&Bn===Hr&&(R='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+R+"</body></html>");const ze=y?y.createHTML(R):R;if(Bn===Hr)try{k=new d().parseFromString(ze,Ot)}catch{}if(!k||!k.documentElement){k=H.createDocument(Bn,"template",null);try{k.documentElement.innerHTML=Gi?M:ze}catch{}}const Mt=k.body||k.documentElement;return R&&Y&&Mt.insertBefore(r.createTextNode(Y),Mt.childNodes[0]||null),Bn===Hr?F.call(k,$?"html":"body")[0]:$?k.documentElement:Mt},Jw=function(R){return P.call(R.ownerDocument||R,R,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Qc=function(R){return R instanceof h&&(typeof R.nodeName!="string"||typeof R.textContent!="string"||typeof R.removeChild!="function"||!(R.attributes instanceof c)||typeof R.removeAttribute!="function"||typeof R.setAttribute!="function"||typeof R.namespaceURI!="string"||typeof R.insertBefore!="function"||typeof R.hasChildNodes!="function")},Qw=function(R){return typeof a=="function"&&R instanceof a};function jn(J,R,k){_l(J,Y=>{Y.call(e,R,k,Uo)})}const ev=function(R){let k=null;if(jn(K.beforeSanitizeElements,R,null),Qc(R))return yn(R),!0;const Y=rt(R.nodeName);if(jn(K.uponSanitizeElement,R,{tagName:Y,allowedTags:Pe}),q&&R.hasChildNodes()&&!Qw(R.firstElementChild)&&Ft(/<[/\w!]/g,R.innerHTML)&&Ft(/<[/\w!]/g,R.textContent)||R.nodeType===ra.progressingInstruction||q&&R.nodeType===ra.comment&&Ft(/<[/\w]/g,R.data))return yn(R),!0;if(!Pe[Y]||m[Y]){if(!m[Y]&&rv(Y)&&(f.tagNameCheck instanceof RegExp&&Ft(f.tagNameCheck,Y)||f.tagNameCheck instanceof Function&&f.tagNameCheck(Y)))return!1;if(he&&!Nt[Y]){const ze=T(R)||R.parentNode,Mt=S(R)||R.childNodes;if(Mt&&ze){const gt=Mt.length;for(let Gt=gt-1;Gt>=0;--Gt){const zn=v(Mt[Gt],!0);zn.__removalCount=(R.__removalCount||0)+1,ze.insertBefore(zn,E(R))}}}return yn(R),!0}return R instanceof l&&!hI(R)||(Y==="noscript"||Y==="noembed"||Y==="noframes")&&Ft(/<\/no(script|embed|frames)/i,R.innerHTML)?(yn(R),!0):(D&&R.nodeType===ra.text&&(k=R.textContent,_l([L,ie,G],ze=>{k=Qs(k,ze," ")}),R.textContent!==k&&(Js(e.removed,{element:R.cloneNode()}),R.textContent=k)),jn(K.afterSanitizeElements,R,null),!1)},tv=function(R,k,Y){if(ce&&(k==="id"||k==="name")&&(Y in r||Y in cI))return!1;if(!(_&&!w[k]&&Ft(te,k))){if(!(C&&Ft(tt,k))){if(!He[k]||w[k]){if(!(rv(R)&&(f.tagNameCheck instanceof RegExp&&Ft(f.tagNameCheck,R)||f.tagNameCheck instanceof Function&&f.tagNameCheck(R))&&(f.attributeNameCheck instanceof RegExp&&Ft(f.attributeNameCheck,k)||f.attributeNameCheck instanceof Function&&f.attributeNameCheck(k))||k==="is"&&f.allowCustomizedBuiltInElements&&(f.tagNameCheck instanceof RegExp&&Ft(f.tagNameCheck,Y)||f.tagNameCheck instanceof Function&&f.tagNameCheck(Y))))return!1}else if(!pt[k]){if(!Ft(je,Qs(Y,Ce,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&R!=="script"&&qH(Y,"data:")===0&&$n[R])){if(!(O&&!Ft(Ie,Qs(Y,Ce,"")))){if(Y)return!1}}}}}}return!0},rv=function(R){return R!=="annotation-xml"&&HS(R,Be)},nv=function(R){jn(K.beforeSanitizeAttributes,R,null);const{attributes:k}=R;if(!k||Qc(R))return;const Y={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:He,forceKeepAttr:void 0};let ze=k.length;for(;ze--;){const Mt=k[ze],{name:gt,namespaceURI:Gt,value:zn}=Mt,Xs=rt(gt),eh=zn;let It=gt==="value"?eh:GH(eh);if(Y.attrName=Xs,Y.attrValue=It,Y.keepAttr=!0,Y.forceKeepAttr=void 0,jn(K.uponSanitizeAttribute,R,Y),It=Y.attrValue,fe&&(Xs==="id"||Xs==="name")&&(Yo(gt,R),It=Le+It),q&&Ft(/((--!?|])>)|<\/(style|title)/i,It)){Yo(gt,R);continue}if(Y.forceKeepAttr)continue;if(!Y.keepAttr){Yo(gt,R);continue}if(!x&&Ft(/\/>/i,It)){Yo(gt,R);continue}D&&_l([L,ie,G],ov=>{It=Qs(It,ov," ")});const iv=rt(R.nodeName);if(!tv(iv,Xs,It)){Yo(gt,R);continue}if(y&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Gt)switch(g.getAttributeType(iv,Xs)){case"TrustedHTML":{It=y.createHTML(It);break}case"TrustedScriptURL":{It=y.createScriptURL(It);break}}if(It!==eh)try{Gt?R.setAttributeNS(Gt,gt,It):R.setAttribute(gt,It),Qc(R)?yn(R):PS(e.removed)}catch{Yo(gt,R)}}jn(K.afterSanitizeAttributes,R,null)},dI=function J(R){let k=null;const Y=Jw(R);for(jn(K.beforeSanitizeShadowDOM,R,null);k=Y.nextNode();)jn(K.uponSanitizeShadowNode,k,null),ev(k),nv(k),k.content instanceof o&&J(k.content);jn(K.afterSanitizeShadowDOM,R,null)};return e.sanitize=function(J){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,Y=null,ze=null,Mt=null;if(Gi=!J,Gi&&(J="<!-->"),typeof J!="string"&&!Qw(J))if(typeof J.toString=="function"){if(J=J.toString(),typeof J!="string")throw ea("dirty is not a string, aborting")}else throw ea("toString is not a function");if(!e.isSupported)return J;if(I||Jc(R),e.removed=[],typeof J=="string"&&(xe=!1),xe){if(J.nodeName){const zn=rt(J.nodeName);if(!Pe[zn]||m[zn])throw ea("root node is forbidden and cannot be sanitized in-place")}}else if(J instanceof a)k=Zw("<!---->"),Y=k.ownerDocument.importNode(J,!0),Y.nodeType===ra.element&&Y.nodeName==="BODY"||Y.nodeName==="HTML"?k=Y:k.appendChild(Y);else{if(!X&&!D&&!$&&J.indexOf("<")===-1)return y&&ye?y.createHTML(J):J;if(k=Zw(J),!k)return X?null:ye?M:""}k&&B&&yn(k.firstChild);const gt=Jw(xe?J:k);for(;ze=gt.nextNode();)ev(ze),nv(ze),ze.content instanceof o&&dI(ze.content);if(xe)return J;if(X){if(ae)for(Mt=A.call(k.ownerDocument);k.firstChild;)Mt.appendChild(k.firstChild);else Mt=k;return(He.shadowroot||He.shadowrootmode)&&(Mt=W.call(n,Mt,!0)),Mt}let Gt=$?k.outerHTML:k.innerHTML;return $&&Pe["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&Ft(ZT,k.ownerDocument.doctype.name)&&(Gt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+Gt),D&&_l([L,ie,G],zn=>{Gt=Qs(Gt,zn," ")}),y&&ye?y.createHTML(Gt):Gt},e.setConfig=function(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Jc(J),I=!0},e.clearConfig=function(){Uo=null,I=!1},e.isValidAttribute=function(J,R,k){Uo||Jc({});const Y=rt(J),ze=rt(R);return tv(Y,ze,k)},e.addHook=function(J,R){typeof R=="function"&&Js(K[J],R)},e.removeHook=function(J,R){if(R!==void 0){const k=UH(K[J],R);return k===-1?void 0:YH(K[J],k,1)[0]}return PS(K[J])},e.removeHooks=function(J){K[J]=[]},e.removeAllHooks=function(){K=LS()},e}var ux=JT();var QT;function V(){return QT.apply(null,arguments)}function cx(t){QT=t}function dn(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Co(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tp(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(be(t,e))return!1;return!0}function er(t){return t===void 0}function hi(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function hl(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function e_(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Mi(t,e){for(var r in e)be(e,r)&&(t[r]=e[r]);return be(e,"toString")&&(t.toString=e.toString),be(e,"valueOf")&&(t.valueOf=e.valueOf),t}function kn(t,e,r,n){return R_(t,e,r,n,!0).utc()}function hx(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function se(t){return t._pf==null&&(t._pf=hx()),t._pf}var em;Array.prototype.some?em=Array.prototype.some:em=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function rp(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=se(t),r=em.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function wc(t){var e=kn(NaN);return t!=null?Mi(se(e),t):se(e).userInvalidated=!0,e}var FS=V.momentProperties=[],Df=!1;function np(t,e){var r,n,i,o=FS.length;if(er(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),er(e._i)||(t._i=e._i),er(e._f)||(t._f=e._f),er(e._l)||(t._l=e._l),er(e._strict)||(t._strict=e._strict),er(e._tzm)||(t._tzm=e._tzm),er(e._isUTC)||(t._isUTC=e._isUTC),er(e._offset)||(t._offset=e._offset),er(e._pf)||(t._pf=se(e)),er(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=FS[r],i=e[n],er(i)||(t[n]=i);return t}function dl(t){np(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Df===!1&&(Df=!0,V.updateOffset(this),Df=!1)}function fn(t){return t instanceof dl||t!=null&&t._isAMomentObject!=null}function t_(t){V.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function qr(t,e){var r=!0;return Mi(function(){if(V.deprecationHandler!=null&&V.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])be(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}t_(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var VS={};function r_(t,e){V.deprecationHandler!=null&&V.deprecationHandler(t,e),VS[t]||(t_(e),VS[t]=!0)}V.suppressDeprecationWarnings=!1;V.deprecationHandler=null;function Ln(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function dx(t){var e,r;for(r in t)be(t,r)&&(e=t[r],Ln(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function tm(t,e){var r=Mi({},t),n;for(n in e)be(e,n)&&(Co(t[n])&&Co(e[n])?(r[n]={},Mi(r[n],t[n]),Mi(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)be(t,n)&&!be(e,n)&&Co(t[n])&&(r[n]=Mi({},r[n]));return r}function ip(t){t!=null&&this.set(t)}var rm;Object.keys?rm=Object.keys:rm=function(t){var e,r=[];for(e in t)be(t,e)&&r.push(e);return r};var fx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function gx(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Ln(n)?n.call(e,r):n}function An(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var op=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ml=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Nf={},Rs={};function Q(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Rs[t]=i),e&&(Rs[e[0]]=function(){return An(i.apply(this,arguments),e[1],e[2])}),r&&(Rs[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function mx(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function px(t){var e=t.match(op),r,n;for(r=0,n=e.length;r<n;r++)Rs[e[r]]?e[r]=Rs[e[r]]:e[r]=mx(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Ln(e[s])?e[s].call(i,t):e[s];return o}}function Cu(t,e){return t.isValid()?(e=n_(e,t.localeData()),Nf[e]=Nf[e]||px(e),Nf[e](t)):t.localeData().invalidDate()}function n_(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Ml.lastIndex=0;r>=0&&Ml.test(t);)t=t.replace(Ml,n),Ml.lastIndex=0,r-=1;return t}var wx={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function vx(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(op).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var yx="Invalid date";function bx(){return this._invalidDate}var Sx="%d",Cx=/\d{1,2}/;function Rx(t){return this._ordinal.replace("%d",t)}var Ex={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Tx(t,e,r,n){var i=this._relativeTime[r];return Ln(i)?i(t,e,r,n):i.replace(/%d/i,t)}function _x(t,e){var r=this._relativeTime[t>0?"future":"past"];return Ln(r)?r(e):r.replace(/%s/i,e)}var WS={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Gr(t){return typeof t=="string"?WS[t]||WS[t.toLowerCase()]:void 0}function sp(t){var e={},r,n;for(n in t)be(t,n)&&(r=Gr(n),r&&(e[r]=t[n]));return e}var Ox={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Mx(t){var e=[],r;for(r in t)be(t,r)&&e.push({unit:r,priority:Ox[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var i_=/\d/,Mr=/\d\d/,o_=/\d{3}/,ap=/\d{4}/,vc=/[+-]?\d{6}/,$e=/\d\d?/,s_=/\d\d\d\d?/,a_=/\d\d\d\d\d\d?/,yc=/\d{1,3}/,lp=/\d{1,4}/,bc=/[+-]?\d{1,6}/,js=/\d+/,Sc=/[+-]?\d+/,Ix=/Z|[+-]\d\d:?\d\d/gi,Cc=/Z|[+-]\d\d(?::?\d\d)?/gi,Px=/[+-]?\d+(\.\d{1,3})?/,fl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,zs=/^[1-9]\d?/,up=/^([1-9]\d|\d)/,Fu;Fu={};function z(t,e,r){Fu[t]=Ln(e)?e:function(n,i){return n&&r?r:e}}function Hx(t,e){return be(Fu,t)?Fu[t](e._strict,e._locale):new RegExp(xx(t))}function xx(t){return ui(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function ui(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Vr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function me(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Vr(e)),r}var nm={};function ke(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),hi(e)&&(n=function(o,s){s[e]=me(o)}),i=t.length,r=0;r<i;r++)nm[t[r]]=n}function gl(t,e){ke(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function Ax(t,e,r){e!=null&&be(nm,t)&&nm[t](e,r._a,r,t)}function Rc(t){return t%4===0&&t%100!==0||t%400===0}var At=0,oi=1,In=2,mt=3,hn=4,si=5,vo=6,Dx=7,Nx=8;Q("Y",0,0,function(){var t=this.year();return t<=9999?An(t,4):"+"+t});Q(0,["YY",2],0,function(){return this.year()%100});Q(0,["YYYY",4],0,"year");Q(0,["YYYYY",5],0,"year");Q(0,["YYYYYY",6,!0],0,"year");z("Y",Sc);z("YY",$e,Mr);z("YYYY",lp,ap);z("YYYYY",bc,vc);z("YYYYYY",bc,vc);ke(["YYYYY","YYYYYY"],At);ke("YYYY",function(t,e){e[At]=t.length===2?V.parseTwoDigitYear(t):me(t)});ke("YY",function(t,e){e[At]=V.parseTwoDigitYear(t)});ke("Y",function(t,e){e[At]=parseInt(t,10)});function Wa(t){return Rc(t)?366:365}V.parseTwoDigitYear=function(t){return me(t)+(me(t)>68?1900:2e3)};var l_=Us("FullYear",!0);function kx(){return Rc(this.year())}function Us(t,e){return function(r){return r!=null?(u_(this,t,r),V.updateOffset(this,e),this):Ka(this,t)}}function Ka(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function u_(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!Rc(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function Lx(t){return t=Gr(t),Ln(this[t])?this[t]():this}function Fx(t,e){if(typeof t=="object"){t=sp(t);var r=Mx(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Gr(t),Ln(this[t]))return this[t](e);return this}function Vx(t,e){return(t%e+e)%e}var ot;Array.prototype.indexOf?ot=Array.prototype.indexOf:ot=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function cp(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Vx(e,12);return t+=(e-r)/12,r===1?Rc(t)?29:28:31-r%7%2}Q("M",["MM",2],"Mo",function(){return this.month()+1});Q("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Q("MMMM",0,0,function(t){return this.localeData().months(this,t)});z("M",$e,zs);z("MM",$e,Mr);z("MMM",function(t,e){return e.monthsShortRegex(t)});z("MMMM",function(t,e){return e.monthsRegex(t)});ke(["M","MM"],function(t,e){e[oi]=me(t)-1});ke(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[oi]=i:se(r).invalidMonth=t});var Wx="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),c_="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),h_=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,$x=fl,Bx=fl;function jx(t,e){return t?dn(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||h_).test(e)?"format":"standalone"][t.month()]:dn(this._months)?this._months:this._months.standalone}function zx(t,e){return t?dn(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[h_.test(e)?"format":"standalone"][t.month()]:dn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ux(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=kn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=ot.call(this._shortMonthsParse,s),i!==-1?i:null):(i=ot.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=ot.call(this._shortMonthsParse,s),i!==-1?i:(i=ot.call(this._longMonthsParse,s),i!==-1?i:null)):(i=ot.call(this._longMonthsParse,s),i!==-1?i:(i=ot.call(this._shortMonthsParse,s),i!==-1?i:null))}function Yx(t,e,r){var n,i,o;if(this._monthsParseExact)return Ux.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=kn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function d_(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=me(e);else if(e=t.localeData().monthsParse(e),!hi(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,cp(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function f_(t){return t!=null?(d_(this,t),V.updateOffset(this,!0),this):Ka(this,"Month")}function qx(){return cp(this.year(),this.month())}function Gx(t){return this._monthsParseExact?(be(this,"_monthsRegex")||g_.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(be(this,"_monthsShortRegex")||(this._monthsShortRegex=$x),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Kx(t){return this._monthsParseExact?(be(this,"_monthsRegex")||g_.call(this),t?this._monthsStrictRegex:this._monthsRegex):(be(this,"_monthsRegex")||(this._monthsRegex=Bx),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function g_(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=kn([2e3,i]),s=ui(this.monthsShort(o,"")),a=ui(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Xx(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function Xa(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Vu(t,e,r){var n=7+e-r,i=(7+Xa(t,0,n).getUTCDay()-e)%7;return-i+n-1}function m_(t,e,r,n,i){var o=(7+r-n)%7,s=Vu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Wa(l)+a):a>Wa(t)?(l=t+1,u=a-Wa(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Za(t,e,r){var n=Vu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ci(s,e,r)):i>ci(t.year(),e,r)?(o=i-ci(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ci(t,e,r){var n=Vu(t,e,r),i=Vu(t+1,e,r);return(Wa(t)-n+i)/7}Q("w",["ww",2],"wo","week");Q("W",["WW",2],"Wo","isoWeek");z("w",$e,zs);z("ww",$e,Mr);z("W",$e,zs);z("WW",$e,Mr);gl(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=me(t)});function Zx(t){return Za(t,this._week.dow,this._week.doy).week}var Jx={dow:0,doy:6};function Qx(){return this._week.dow}function eA(){return this._week.doy}function tA(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function rA(t){var e=Za(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Q("d",0,"do","day");Q("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Q("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Q("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Q("e",0,0,"weekday");Q("E",0,0,"isoWeekday");z("d",$e);z("e",$e);z("E",$e);z("dd",function(t,e){return e.weekdaysMinRegex(t)});z("ddd",function(t,e){return e.weekdaysShortRegex(t)});z("dddd",function(t,e){return e.weekdaysRegex(t)});gl(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:se(r).invalidWeekday=t});gl(["d","e","E"],function(t,e,r,n){e[n]=me(t)});function nA(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function iA(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function hp(t,e){return t.slice(e,7).concat(t.slice(0,e))}var oA="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),p_="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),sA="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),aA=fl,lA=fl,uA=fl;function cA(t,e){var r=dn(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?hp(r,this._week.dow):t?r[t.day()]:r}function hA(t){return t===!0?hp(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function dA(t){return t===!0?hp(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function fA(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=kn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=ot.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=ot.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=ot.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=ot.call(this._weekdaysParse,s),i!==-1||(i=ot.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=ot.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=ot.call(this._shortWeekdaysParse,s),i!==-1||(i=ot.call(this._weekdaysParse,s),i!==-1)?i:(i=ot.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=ot.call(this._minWeekdaysParse,s),i!==-1||(i=ot.call(this._weekdaysParse,s),i!==-1)?i:(i=ot.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function gA(t,e,r){var n,i,o;if(this._weekdaysParseExact)return fA.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=kn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function mA(t){if(!this.isValid())return t!=null?this:NaN;var e=Ka(this,"Day");return t!=null?(t=nA(t,this.localeData()),this.add(t-e,"d")):e}function pA(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function wA(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=iA(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function vA(t){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||dp.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(be(this,"_weekdaysRegex")||(this._weekdaysRegex=aA),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function yA(t){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||dp.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(be(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=lA),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function bA(t){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||dp.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(be(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=uA),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function dp(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=kn([2e3,1]).day(o),a=ui(this.weekdaysMin(s,"")),l=ui(this.weekdaysShort(s,"")),u=ui(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function fp(){return this.hours()%12||12}function SA(){return this.hours()||24}Q("H",["HH",2],0,"hour");Q("h",["hh",2],0,fp);Q("k",["kk",2],0,SA);Q("hmm",0,0,function(){return""+fp.apply(this)+An(this.minutes(),2)});Q("hmmss",0,0,function(){return""+fp.apply(this)+An(this.minutes(),2)+An(this.seconds(),2)});Q("Hmm",0,0,function(){return""+this.hours()+An(this.minutes(),2)});Q("Hmmss",0,0,function(){return""+this.hours()+An(this.minutes(),2)+An(this.seconds(),2)});function w_(t,e){Q(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}w_("a",!0);w_("A",!1);function v_(t,e){return e._meridiemParse}z("a",v_);z("A",v_);z("H",$e,up);z("h",$e,zs);z("k",$e,zs);z("HH",$e,Mr);z("hh",$e,Mr);z("kk",$e,Mr);z("hmm",s_);z("hmmss",a_);z("Hmm",s_);z("Hmmss",a_);ke(["H","HH"],mt);ke(["k","kk"],function(t,e,r){var n=me(t);e[mt]=n===24?0:n});ke(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});ke(["h","hh"],function(t,e,r){e[mt]=me(t),se(r).bigHour=!0});ke("hmm",function(t,e,r){var n=t.length-2;e[mt]=me(t.substr(0,n)),e[hn]=me(t.substr(n)),se(r).bigHour=!0});ke("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[mt]=me(t.substr(0,n)),e[hn]=me(t.substr(n,2)),e[si]=me(t.substr(i)),se(r).bigHour=!0});ke("Hmm",function(t,e,r){var n=t.length-2;e[mt]=me(t.substr(0,n)),e[hn]=me(t.substr(n))});ke("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[mt]=me(t.substr(0,n)),e[hn]=me(t.substr(n,2)),e[si]=me(t.substr(i))});function CA(t){return(t+"").toLowerCase().charAt(0)==="p"}var RA=/[ap]\.?m?\.?/i,EA=Us("Hours",!0);function TA(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var y_={calendar:fx,longDateFormat:wx,invalidDate:yx,ordinal:Sx,dayOfMonthOrdinalParse:Cx,relativeTime:Ex,months:Wx,monthsShort:c_,week:Jx,weekdays:oA,weekdaysMin:sA,weekdaysShort:p_,meridiemParse:RA},qe={},na={},Ja;function _A(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function $S(t){return t&&t.toLowerCase().replace("_","-")}function OA(t){for(var e=0,r,n,i,o;e<t.length;){for(o=$S(t[e]).split("-"),r=o.length,n=$S(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Ec(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&_A(o,n)>=r-1)break;r--}e++}return Ja}function MA(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Ec(t){var e=null,r;if(qe[t]===void 0&&typeof Du<"u"&&Du&&Du.exports&&MA(t))try{e=Ja._abbr,r=require,r("./locale/"+t),Fi(e)}catch{qe[t]=null}return qe[t]}function Fi(t,e){var r;return t&&(er(e)?r=gi(t):r=gp(t,e),r?Ja=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ja._abbr}function gp(t,e){if(e!==null){var r,n=y_;if(e.abbr=t,qe[t]!=null)r_("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=qe[t]._config;else if(e.parentLocale!=null)if(qe[e.parentLocale]!=null)n=qe[e.parentLocale]._config;else if(r=Ec(e.parentLocale),r!=null)n=r._config;else return na[e.parentLocale]||(na[e.parentLocale]=[]),na[e.parentLocale].push({name:t,config:e}),null;return qe[t]=new ip(tm(n,e)),na[t]&&na[t].forEach(function(i){gp(i.name,i.config)}),Fi(t),qe[t]}else return delete qe[t],null}function IA(t,e){if(e!=null){var r,n,i=y_;qe[t]!=null&&qe[t].parentLocale!=null?qe[t].set(tm(qe[t]._config,e)):(n=Ec(t),n!=null&&(i=n._config),e=tm(i,e),n==null&&(e.abbr=t),r=new ip(e),r.parentLocale=qe[t],qe[t]=r),Fi(t)}else qe[t]!=null&&(qe[t].parentLocale!=null?(qe[t]=qe[t].parentLocale,t===Fi()&&Fi(t)):qe[t]!=null&&delete qe[t]);return qe[t]}function gi(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ja;if(!dn(t)){if(e=Ec(t),e)return e;t=[t]}return OA(t)}function PA(){return rm(qe)}function mp(t){var e,r=t._a;return r&&se(t).overflow===-2&&(e=r[oi]<0||r[oi]>11?oi:r[In]<1||r[In]>cp(r[At],r[oi])?In:r[mt]<0||r[mt]>24||r[mt]===24&&(r[hn]!==0||r[si]!==0||r[vo]!==0)?mt:r[hn]<0||r[hn]>59?hn:r[si]<0||r[si]>59?si:r[vo]<0||r[vo]>999?vo:-1,se(t)._overflowDayOfYear&&(e<At||e>In)&&(e=In),se(t)._overflowWeeks&&e===-1&&(e=Dx),se(t)._overflowWeekday&&e===-1&&(e=Nx),se(t).overflow=e),t}var HA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,AA=/Z|[+-]\d\d(?::?\d\d)?/,Il=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],kf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],DA=/^\/?Date\((-?\d+)/i,NA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,kA={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function b_(t){var e,r,n=t._i,i=HA.exec(n)||xA.exec(n),o,s,a,l,u=Il.length,c=kf.length;if(i){for(se(t).iso=!0,e=0,r=u;e<r;e++)if(Il[e][1].exec(i[1])){s=Il[e][0],o=Il[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(kf[e][1].exec(i[3])){a=(i[2]||" ")+kf[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(AA.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),wp(t)}else t._isValid=!1}function LA(t,e,r,n,i,o){var s=[FA(t),c_.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function FA(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function VA(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function WA(t,e,r){if(t){var n=p_.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return se(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function $A(t,e,r){if(t)return kA[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function S_(t){var e=NA.exec(VA(t._i)),r;if(e){if(r=LA(e[4],e[3],e[2],e[5],e[6],e[7]),!WA(e[1],r,t))return;t._a=r,t._tzm=$A(e[8],e[9],e[10]),t._d=Xa.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),se(t).rfc2822=!0}else t._isValid=!1}function BA(t){var e=DA.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(b_(t),t._isValid===!1)delete t._isValid;else return;if(S_(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:V.createFromInputFallback(t)}V.createFromInputFallback=qr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ms(t,e,r){return t??e??r}function jA(t){var e=new Date(V.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function pp(t){var e,r,n=[],i,o,s;if(!t._d){for(i=jA(t),t._w&&t._a[In]==null&&t._a[oi]==null&&zA(t),t._dayOfYear!=null&&(s=ms(t._a[At],i[At]),(t._dayOfYear>Wa(s)||t._dayOfYear===0)&&(se(t)._overflowDayOfYear=!0),r=Xa(s,0,t._dayOfYear),t._a[oi]=r.getUTCMonth(),t._a[In]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[mt]===24&&t._a[hn]===0&&t._a[si]===0&&t._a[vo]===0&&(t._nextDay=!0,t._a[mt]=0),t._d=(t._useUTC?Xa:Xx).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[mt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(se(t).weekdayMismatch=!0)}}function zA(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=ms(e.GG,t._a[At],Za(We(),1,4).year),n=ms(e.W,1),i=ms(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Za(We(),o,s),r=ms(e.gg,t._a[At],u.year),n=ms(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>ci(r,o,s)?se(t)._overflowWeeks=!0:l!=null?se(t)._overflowWeekday=!0:(a=m_(r,n,i,o,s),t._a[At]=a.year,t._dayOfYear=a.dayOfYear)}V.ISO_8601=function(){};V.RFC_2822=function(){};function wp(t){if(t._f===V.ISO_8601){b_(t);return}if(t._f===V.RFC_2822){S_(t);return}t._a=[],se(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=n_(t._f,t._locale).match(op)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(Hx(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&se(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Rs[o]?(n?se(t).empty=!1:se(t).unusedTokens.push(o),Ax(o,n,t)):t._strict&&!n&&se(t).unusedTokens.push(o);se(t).charsLeftOver=a-l,e.length>0&&se(t).unusedInput.push(e),t._a[mt]<=12&&se(t).bigHour===!0&&t._a[mt]>0&&(se(t).bigHour=void 0),se(t).parsedDateParts=t._a.slice(0),se(t).meridiem=t._meridiem,t._a[mt]=UA(t._locale,t._a[mt],t._meridiem),u=se(t).era,u!==null&&(t._a[At]=t._locale.erasConvertYear(u,t._a[At])),pp(t),mp(t)}function UA(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function YA(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){se(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=np({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],wp(e),rp(e)&&(s=!0),o+=se(e).charsLeftOver,o+=se(e).unusedTokens.length*10,se(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));Mi(t,r||e)}function qA(t){if(!t._d){var e=sp(t._i),r=e.day===void 0?e.date:e.day;t._a=e_([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),pp(t)}}function GA(t){var e=new dl(mp(C_(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function C_(t){var e=t._i,r=t._f;return t._locale=t._locale||gi(t._l),e===null||r===void 0&&e===""?wc({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),fn(e)?new dl(mp(e)):(hl(e)?t._d=e:dn(r)?YA(t):r?wp(t):KA(t),rp(t)||(t._d=null),t))}function KA(t){var e=t._i;er(e)?t._d=new Date(V.now()):hl(e)?t._d=new Date(e.valueOf()):typeof e=="string"?BA(t):dn(e)?(t._a=e_(e.slice(0),function(r){return parseInt(r,10)}),pp(t)):Co(e)?qA(t):hi(e)?t._d=new Date(e):V.createFromInputFallback(t)}function R_(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Co(t)&&tp(t)||dn(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,GA(o)}function We(t,e,r,n){return R_(t,e,r,n,!1)}var XA=qr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=We.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:wc()}),ZA=qr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=We.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:wc()});function E_(t,e){var r,n;if(e.length===1&&dn(e[0])&&(e=e[0]),!e.length)return We();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function JA(){var t=[].slice.call(arguments,0);return E_("isBefore",t)}function QA(){var t=[].slice.call(arguments,0);return E_("isAfter",t)}var e1=function(){return Date.now?Date.now():+new Date},ia=["year","quarter","month","week","day","hour","minute","second","millisecond"];function t1(t){var e,r=!1,n,i=ia.length;for(e in t)if(be(t,e)&&!(ot.call(ia,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[ia[n]]){if(r)return!1;parseFloat(t[ia[n]])!==me(t[ia[n]])&&(r=!0)}return!0}function r1(){return this._isValid}function n1(){return mn(NaN)}function Tc(t){var e=sp(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=t1(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=gi(),this._bubble()}function Ru(t){return t instanceof Tc}function im(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function i1(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)me(t[s])!==me(e[s])&&o++;return o+i}function T_(t,e){Q(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+An(~~(r/60),2)+e+An(~~r%60,2)})}T_("Z",":");T_("ZZ","");z("Z",Cc);z("ZZ",Cc);ke(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=vp(Cc,t)});var o1=/([\+\-]|\d\d)/gi;function vp(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(o1)||["-",0,0],o=+(i[1]*60)+me(i[2]),o===0?0:i[0]==="+"?o:-o)}function yp(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(fn(t)||hl(t)?t.valueOf():We(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),V.updateOffset(r,!1),r):We(t).local()}function om(t){return-Math.round(t._d.getTimezoneOffset())}V.updateOffset=function(){};function s1(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=vp(Cc,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=om(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?M_(this,mn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,V.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:om(this)}function a1(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function l1(t){return this.utcOffset(0,t)}function u1(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(om(this),"m")),this}function c1(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=vp(Ix,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function h1(t){return this.isValid()?(t=t?We(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function d1(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function f1(){if(!er(this._isDSTShifted))return this._isDSTShifted;var t={},e;return np(t,this),t=C_(t),t._a?(e=t._isUTC?kn(t._a):We(t._a),this._isDSTShifted=this.isValid()&&i1(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function g1(){return this.isValid()?!this._isUTC:!1}function m1(){return this.isValid()?this._isUTC:!1}function __(){return this.isValid()?this._isUTC&&this._offset===0:!1}var p1=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,w1=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function mn(t,e){var r=t,n=null,i,o,s;return Ru(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:hi(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=p1.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:me(n[In])*i,h:me(n[mt])*i,m:me(n[hn])*i,s:me(n[si])*i,ms:me(im(n[vo]*1e3))*i}):(n=w1.exec(t))?(i=n[1]==="-"?-1:1,r={y:Xi(n[2],i),M:Xi(n[3],i),w:Xi(n[4],i),d:Xi(n[5],i),h:Xi(n[6],i),m:Xi(n[7],i),s:Xi(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=v1(We(r.from),We(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Tc(r),Ru(t)&&be(t,"_locale")&&(o._locale=t._locale),Ru(t)&&be(t,"_isValid")&&(o._isValid=t._isValid),o}mn.fn=Tc.prototype;mn.invalid=n1;function Xi(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function BS(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function v1(t,e){var r;return t.isValid()&&e.isValid()?(e=yp(e,t),t.isBefore(e)?r=BS(t,e):(r=BS(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function O_(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(r_(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=mn(r,n),M_(this,i,t),this}}function M_(t,e,r,n){var i=e._milliseconds,o=im(e._days),s=im(e._months);t.isValid()&&(n=n??!0,s&&d_(t,Ka(t,"Month")+s*r),o&&u_(t,"Date",Ka(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&V.updateOffset(t,o||s))}var y1=O_(1,"add"),b1=O_(-1,"subtract");function I_(t){return typeof t=="string"||t instanceof String}function S1(t){return fn(t)||hl(t)||I_(t)||hi(t)||R1(t)||C1(t)||t===null||t===void 0}function C1(t){var e=Co(t)&&!tp(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||be(t,o);return e&&r}function R1(t){var e=dn(t),r=!1;return e&&(r=t.filter(function(n){return!hi(n)&&I_(t)}).length===0),e&&r}function E1(t){var e=Co(t)&&!tp(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||be(t,o);return e&&r}function T1(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function _1(t,e){arguments.length===1&&(arguments[0]?S1(arguments[0])?(t=arguments[0],e=void 0):E1(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||We(),n=yp(r,this).startOf("day"),i=V.calendarFormat(this,n)||"sameElse",o=e&&(Ln(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,We(r)))}function O1(){return new dl(this)}function M1(t,e){var r=fn(t)?t:We(t);return this.isValid()&&r.isValid()?(e=Gr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function I1(t,e){var r=fn(t)?t:We(t);return this.isValid()&&r.isValid()?(e=Gr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function P1(t,e,r,n){var i=fn(t)?t:We(t),o=fn(e)?e:We(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function H1(t,e){var r=fn(t)?t:We(t),n;return this.isValid()&&r.isValid()?(e=Gr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function x1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function A1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function D1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=yp(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Gr(e),e){case"year":o=Eu(this,n)/12;break;case"month":o=Eu(this,n);break;case"quarter":o=Eu(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Vr(o)}function Eu(t,e){if(t.date()<e.date())return-Eu(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}V.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";V.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function N1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function k1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Cu(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ln(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Cu(r,"Z")):Cu(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function L1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function F1(t){t||(t=this.isUtc()?V.defaultFormatUtc:V.defaultFormat);var e=Cu(this,t);return this.localeData().postformat(e)}function V1(t,e){return this.isValid()&&(fn(t)&&t.isValid()||We(t).isValid())?mn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function W1(t){return this.from(We(),t)}function $1(t,e){return this.isValid()&&(fn(t)&&t.isValid()||We(t).isValid())?mn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function B1(t){return this.to(We(),t)}function P_(t){var e;return t===void 0?this._locale._abbr:(e=gi(t),e!=null&&(this._locale=e),this)}var H_=qr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function x_(){return this._locale}var Wu=1e3,Es=60*Wu,$u=60*Es,A_=(365*400+97)*24*$u;function Ts(t,e){return(t%e+e)%e}function D_(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-A_:new Date(t,e,r).valueOf()}function N_(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-A_:Date.UTC(t,e,r)}function j1(t){var e,r;if(t=Gr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?N_:D_,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ts(e+(this._isUTC?0:this.utcOffset()*Es),$u);break;case"minute":e=this._d.valueOf(),e-=Ts(e,Es);break;case"second":e=this._d.valueOf(),e-=Ts(e,Wu);break}return this._d.setTime(e),V.updateOffset(this,!0),this}function z1(t){var e,r;if(t=Gr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?N_:D_,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=$u-Ts(e+(this._isUTC?0:this.utcOffset()*Es),$u)-1;break;case"minute":e=this._d.valueOf(),e+=Es-Ts(e,Es)-1;break;case"second":e=this._d.valueOf(),e+=Wu-Ts(e,Wu)-1;break}return this._d.setTime(e),V.updateOffset(this,!0),this}function U1(){return this._d.valueOf()-(this._offset||0)*6e4}function Y1(){return Math.floor(this.valueOf()/1e3)}function q1(){return new Date(this.valueOf())}function G1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function K1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function X1(){return this.isValid()?this.toISOString():null}function Z1(){return rp(this)}function J1(){return Mi({},se(this))}function Q1(){return se(this).overflow}function eD(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Q("N",0,0,"eraAbbr");Q("NN",0,0,"eraAbbr");Q("NNN",0,0,"eraAbbr");Q("NNNN",0,0,"eraName");Q("NNNNN",0,0,"eraNarrow");Q("y",["y",1],"yo","eraYear");Q("y",["yy",2],0,"eraYear");Q("y",["yyy",3],0,"eraYear");Q("y",["yyyy",4],0,"eraYear");z("N",bp);z("NN",bp);z("NNN",bp);z("NNNN",hD);z("NNNNN",dD);ke(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?se(r).era=i:se(r).invalidEra=t});z("y",js);z("yy",js);z("yyy",js);z("yyyy",js);z("yo",fD);ke(["y","yy","yyy","yyyy"],At);ke(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[At]=r._locale.eraYearOrdinalParse(t,i):e[At]=parseInt(t,10)});function tD(t,e){var r,n,i,o=this._eras||gi("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=V(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=V(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function rD(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function nD(t,e){var r=t.since<=t.until?1:-1;return e===void 0?V(t.since).year():V(t.since).year()+(e-t.offset)*r}function iD(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function oD(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function sD(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function aD(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-V(i[t].since).year())*r+i[t].offset;return this.year()}function lD(t){return be(this,"_erasNameRegex")||Sp.call(this),t?this._erasNameRegex:this._erasRegex}function uD(t){return be(this,"_erasAbbrRegex")||Sp.call(this),t?this._erasAbbrRegex:this._erasRegex}function cD(t){return be(this,"_erasNarrowRegex")||Sp.call(this),t?this._erasNarrowRegex:this._erasRegex}function bp(t,e){return e.erasAbbrRegex(t)}function hD(t,e){return e.erasNameRegex(t)}function dD(t,e){return e.erasNarrowRegex(t)}function fD(t,e){return e._eraYearOrdinalRegex||js}function Sp(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=ui(u[i].name),a=ui(u[i].abbr),l=ui(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Q(0,["gg",2],0,function(){return this.weekYear()%100});Q(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _c(t,e){Q(0,[t,t.length],0,e)}_c("gggg","weekYear");_c("ggggg","weekYear");_c("GGGG","isoWeekYear");_c("GGGGG","isoWeekYear");z("G",Sc);z("g",Sc);z("GG",$e,Mr);z("gg",$e,Mr);z("GGGG",lp,ap);z("gggg",lp,ap);z("GGGGG",bc,vc);z("ggggg",bc,vc);gl(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=me(t)});gl(["gg","GG"],function(t,e,r,n){e[n]=V.parseTwoDigitYear(t)});function gD(t){return k_.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function mD(t){return k_.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function pD(){return ci(this.year(),1,4)}function wD(){return ci(this.isoWeekYear(),1,4)}function vD(){var t=this.localeData()._week;return ci(this.year(),t.dow,t.doy)}function yD(){var t=this.localeData()._week;return ci(this.weekYear(),t.dow,t.doy)}function k_(t,e,r,n,i){var o;return t==null?Za(this,n,i).year:(o=ci(t,n,i),e>o&&(e=o),bD.call(this,t,e,r,n,i))}function bD(t,e,r,n,i){var o=m_(t,e,r,n,i),s=Xa(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Q("Q",0,"Qo","quarter");z("Q",i_);ke("Q",function(t,e){e[oi]=(me(t)-1)*3});function SD(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Q("D",["DD",2],"Do","date");z("D",$e,zs);z("DD",$e,Mr);z("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ke(["D","DD"],In);ke("Do",function(t,e){e[In]=me(t.match($e)[0])});var L_=Us("Date",!0);Q("DDD",["DDDD",3],"DDDo","dayOfYear");z("DDD",yc);z("DDDD",o_);ke(["DDD","DDDD"],function(t,e,r){r._dayOfYear=me(t)});function CD(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Q("m",["mm",2],0,"minute");z("m",$e,up);z("mm",$e,Mr);ke(["m","mm"],hn);var RD=Us("Minutes",!1);Q("s",["ss",2],0,"second");z("s",$e,up);z("ss",$e,Mr);ke(["s","ss"],si);var ED=Us("Seconds",!1);Q("S",0,0,function(){return~~(this.millisecond()/100)});Q(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Q(0,["SSS",3],0,"millisecond");Q(0,["SSSS",4],0,function(){return this.millisecond()*10});Q(0,["SSSSS",5],0,function(){return this.millisecond()*100});Q(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Q(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Q(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Q(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});z("S",yc,i_);z("SS",yc,Mr);z("SSS",yc,o_);var Ii,F_;for(Ii="SSSS";Ii.length<=9;Ii+="S")z(Ii,js);function TD(t,e){e[vo]=me(("0."+t)*1e3)}for(Ii="S";Ii.length<=9;Ii+="S")ke(Ii,TD);F_=Us("Milliseconds",!1);Q("z",0,0,"zoneAbbr");Q("zz",0,0,"zoneName");function _D(){return this._isUTC?"UTC":""}function OD(){return this._isUTC?"Coordinated Universal Time":""}var N=dl.prototype;N.add=y1;N.calendar=_1;N.clone=O1;N.diff=D1;N.endOf=z1;N.format=F1;N.from=V1;N.fromNow=W1;N.to=$1;N.toNow=B1;N.get=Lx;N.invalidAt=Q1;N.isAfter=M1;N.isBefore=I1;N.isBetween=P1;N.isSame=H1;N.isSameOrAfter=x1;N.isSameOrBefore=A1;N.isValid=Z1;N.lang=H_;N.locale=P_;N.localeData=x_;N.max=ZA;N.min=XA;N.parsingFlags=J1;N.set=Fx;N.startOf=j1;N.subtract=b1;N.toArray=G1;N.toObject=K1;N.toDate=q1;N.toISOString=k1;N.inspect=L1;typeof Symbol<"u"&&Symbol.for!=null&&(N[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});N.toJSON=X1;N.toString=N1;N.unix=Y1;N.valueOf=U1;N.creationData=eD;N.eraName=iD;N.eraNarrow=oD;N.eraAbbr=sD;N.eraYear=aD;N.year=l_;N.isLeapYear=kx;N.weekYear=gD;N.isoWeekYear=mD;N.quarter=N.quarters=SD;N.month=f_;N.daysInMonth=qx;N.week=N.weeks=tA;N.isoWeek=N.isoWeeks=rA;N.weeksInYear=vD;N.weeksInWeekYear=yD;N.isoWeeksInYear=pD;N.isoWeeksInISOWeekYear=wD;N.date=L_;N.day=N.days=mA;N.weekday=pA;N.isoWeekday=wA;N.dayOfYear=CD;N.hour=N.hours=EA;N.minute=N.minutes=RD;N.second=N.seconds=ED;N.millisecond=N.milliseconds=F_;N.utcOffset=s1;N.utc=l1;N.local=u1;N.parseZone=c1;N.hasAlignedHourOffset=h1;N.isDST=d1;N.isLocal=g1;N.isUtcOffset=m1;N.isUtc=__;N.isUTC=__;N.zoneAbbr=_D;N.zoneName=OD;N.dates=qr("dates accessor is deprecated. Use date instead.",L_);N.months=qr("months accessor is deprecated. Use month instead",f_);N.years=qr("years accessor is deprecated. Use year instead",l_);N.zone=qr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",a1);N.isDSTShifted=qr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",f1);function MD(t){return We(t*1e3)}function ID(){return We.apply(null,arguments).parseZone()}function V_(t){return t}var Se=ip.prototype;Se.calendar=gx;Se.longDateFormat=vx;Se.invalidDate=bx;Se.ordinal=Rx;Se.preparse=V_;Se.postformat=V_;Se.relativeTime=Tx;Se.pastFuture=_x;Se.set=dx;Se.eras=tD;Se.erasParse=rD;Se.erasConvertYear=nD;Se.erasAbbrRegex=uD;Se.erasNameRegex=lD;Se.erasNarrowRegex=cD;Se.months=jx;Se.monthsShort=zx;Se.monthsParse=Yx;Se.monthsRegex=Kx;Se.monthsShortRegex=Gx;Se.week=Zx;Se.firstDayOfYear=eA;Se.firstDayOfWeek=Qx;Se.weekdays=cA;Se.weekdaysMin=dA;Se.weekdaysShort=hA;Se.weekdaysParse=gA;Se.weekdaysRegex=vA;Se.weekdaysShortRegex=yA;Se.weekdaysMinRegex=bA;Se.isPM=CA;Se.meridiem=TA;function Bu(t,e,r,n){var i=gi(),o=kn().set(n,e);return i[r](o,t)}function W_(t,e,r){if(hi(t)&&(e=t,t=void 0),t=t||"",e!=null)return Bu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Bu(t,n,r,"month");return i}function Cp(t,e,r,n){typeof t=="boolean"?(hi(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,hi(e)&&(r=e,e=void 0),e=e||"");var i=gi(),o=t?i._week.dow:0,s,a=[];if(r!=null)return Bu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=Bu(e,(s+o)%7,n,"day");return a}function PD(t,e){return W_(t,e,"months")}function HD(t,e){return W_(t,e,"monthsShort")}function xD(t,e,r){return Cp(t,e,r,"weekdays")}function AD(t,e,r){return Cp(t,e,r,"weekdaysShort")}function DD(t,e,r){return Cp(t,e,r,"weekdaysMin")}Fi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=me(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});V.lang=qr("moment.lang is deprecated. Use moment.locale instead.",Fi);V.langData=qr("moment.langData is deprecated. Use moment.localeData instead.",gi);var Un=Math.abs;function ND(){var t=this._data;return this._milliseconds=Un(this._milliseconds),this._days=Un(this._days),this._months=Un(this._months),t.milliseconds=Un(t.milliseconds),t.seconds=Un(t.seconds),t.minutes=Un(t.minutes),t.hours=Un(t.hours),t.months=Un(t.months),t.years=Un(t.years),this}function $_(t,e,r,n){var i=mn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function kD(t,e){return $_(this,t,e,1)}function LD(t,e){return $_(this,t,e,-1)}function jS(t){return t<0?Math.floor(t):Math.ceil(t)}function FD(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=jS(sm(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Vr(t/1e3),n.seconds=i%60,o=Vr(i/60),n.minutes=o%60,s=Vr(o/60),n.hours=s%24,e+=Vr(s/24),l=Vr(B_(e)),r+=l,e-=jS(sm(l)),a=Vr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function B_(t){return t*4800/146097}function sm(t){return t*146097/4800}function VD(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Gr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+B_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(sm(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function mi(t){return function(){return this.as(t)}}var j_=mi("ms"),WD=mi("s"),$D=mi("m"),BD=mi("h"),jD=mi("d"),zD=mi("w"),UD=mi("M"),YD=mi("Q"),qD=mi("y"),GD=j_;function KD(){return mn(this)}function XD(t){return t=Gr(t),this.isValid()?this[t+"s"]():NaN}function Wo(t){return function(){return this.isValid()?this._data[t]:NaN}}var ZD=Wo("milliseconds"),JD=Wo("seconds"),QD=Wo("minutes"),eN=Wo("hours"),tN=Wo("days"),rN=Wo("months"),nN=Wo("years");function iN(){return Vr(this.days()/7)}var ri=Math.round,ys={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function oN(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function sN(t,e,r,n){var i=mn(t).abs(),o=ri(i.as("s")),s=ri(i.as("m")),a=ri(i.as("h")),l=ri(i.as("d")),u=ri(i.as("M")),c=ri(i.as("w")),h=ri(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,oN.apply(null,d)}function aN(t){return t===void 0?ri:typeof t=="function"?(ri=t,!0):!1}function lN(t,e){return ys[t]===void 0?!1:e===void 0?ys[t]:(ys[t]=e,t==="s"&&(ys.ss=e-1),!0)}function uN(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=ys,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},ys,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=sN(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Lf=Math.abs;function Go(t){return(t>0)-(t<0)||+t}function Oc(){if(!this.isValid())return this.localeData().invalidDate();var t=Lf(this._milliseconds)/1e3,e=Lf(this._days),r=Lf(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Vr(t/60),i=Vr(n/60),t%=60,n%=60,o=Vr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Go(this._months)!==Go(a)?"-":"",c=Go(this._days)!==Go(a)?"-":"",h=Go(this._milliseconds)!==Go(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var we=Tc.prototype;we.isValid=r1;we.abs=ND;we.add=kD;we.subtract=LD;we.as=VD;we.asMilliseconds=j_;we.asSeconds=WD;we.asMinutes=$D;we.asHours=BD;we.asDays=jD;we.asWeeks=zD;we.asMonths=UD;we.asQuarters=YD;we.asYears=qD;we.valueOf=GD;we._bubble=FD;we.clone=KD;we.get=XD;we.milliseconds=ZD;we.seconds=JD;we.minutes=QD;we.hours=eN;we.days=tN;we.weeks=iN;we.months=rN;we.years=nN;we.humanize=uN;we.toISOString=Oc;we.toString=Oc;we.toJSON=Oc;we.locale=P_;we.localeData=x_;we.toIsoString=qr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Oc);we.lang=H_;Q("X",0,0,"unix");Q("x",0,0,"valueOf");z("x",Sc);z("X",Px);ke("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});ke("x",function(t,e,r){r._d=new Date(me(t))});V.version="2.30.1";cx(We);V.fn=N;V.min=JA;V.max=QA;V.now=e1;V.utc=kn;V.unix=MD;V.months=PD;V.isDate=hl;V.locale=Fi;V.invalid=wc;V.duration=mn;V.isMoment=fn;V.weekdays=xD;V.parseZone=ID;V.localeData=gi;V.isDuration=Ru;V.monthsShort=HD;V.weekdaysMin=DD;V.defineLocale=gp;V.updateLocale=IA;V.locales=PA;V.weekdaysShort=AD;V.normalizeUnits=Gr;V.relativeTimeRounding=aN;V.relativeTimeThreshold=lN;V.calendarFormat=T1;V.prototype=N;V.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var zS={},US={},YS;function cN(){if(YS)return US;YS=1;var t=Fe(),e=Bs(),r=_r(),n=yt(),i=Yi(),o=Or(),s=Vo(),a=ll(),l=dt(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(S){o(this,"throw",S)}var p=arguments.length<2,v=p?void 0:arguments[1];if(h)return a(h,this,p?[g]:[g,v]);var b=i(this),E=0;if(e(b,function(S){p?(p=!1,v=S):v=g(v,S,E),E++},{IS_RECORD:!0}),p)throw new u("Reduce of empty iterator with no initial value");return v}}),US}var qS;function hN(){return qS||(qS=1,cN()),zS}hN();function dN(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function GS(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Ff(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function $o(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Rp(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function Dn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function j(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function KS(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return j(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function XS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function ur(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return $o(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function Ep(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function jt(t){return typeof t>"u"}function _o(t){return t===null||t===""||jt(t)}function fN(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ha="length",$a=t=>parseInt(t,16),ZS=t=>parseInt(t,10),ju=(t,e,r)=>t.substr(e,r),Ba=t=>t.codePointAt(0)-65,am=t=>`${t}`.replace(/\-/g,""),gN=t=>$a(ju(am(t),$a("12"),Ba("F")))/($a(ju(am(t),Ba("B"),~~![][Ha]))||9),mN=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let JS=!1;const QS={invalid:()=>ur`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ur`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ur`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},eC={invalid:()=>ur`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ur`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ur`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function pN(t,e){const r=!_o(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.2.0";let o,s="invalid",a="invalid";t=am(t||"");const l=wN(t);if(r||n||l)if(l){const u=V("25/11/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=gN(t);o=V((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(mN()&&(s="valid",a="valid"),!JS&&s!=="valid"&&(QS[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](QS[s]({keyValidityDate:o,hotVersion:i})),JS=!0),a!=="valid"&&e&&eC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=eC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function wN(t){let e=[][Ha],r=e;if(t[Ha]!==Ba("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=Ba(i.shift());o;o=Ba(i.shift()||"A"))--o<""[Ha]?r=r|(ZS(`${ZS($a(n)+($a(ju(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=ju(t,o,o?i[Ha]===1?9:8:6);return r===e}function Mc(t){return t[0].toUpperCase()+t.substr(1)}function z_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function vN(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function yN(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function U_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function Y_(t,e){return ux.sanitize(t,e)}const Bo=t=>["tabindex",t],bN=()=>["role","treegrid"],Pi=()=>["role","presentation"],SN=()=>["role","gridcell"],CN=()=>["role","gridcell button"],RN=()=>["role","rowheader"],q_=()=>["role","rowgroup"],EN=()=>["role","columnheader"],G_=()=>["role","row"],TN=()=>["role","menu"],_N=()=>["role","menuitem"],ON=()=>["role","menuitemcheckbox"],MN=()=>["scope","col"],IN=()=>["scope","row"],zu=t=>["aria-label",t],PN=()=>["aria-hidden","true"],HN=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},xN=()=>["aria-multiselectable","true"],K_=t=>["aria-rowcount",t],Ic=t=>["aria-colcount",t],X_=t=>["aria-rowindex",t],Tp=t=>["aria-colindex",t],Tu=t=>["aria-expanded",t],tC=()=>["aria-readonly","true"],rC=()=>["aria-invalid","true"],AN=t=>["aria-checked",t],Z_=()=>["aria-selected","true"];var nC={},Vf,iC;function DN(){if(iC)return Vf;iC=1;var t=lt(),e=HT(),r=ft(),n=Ao(),i=pc(),o=t([].push);return Vf=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,p){if(d)return d=!1,p;if(e(this))return p;for(var v=0;v<h;v++)if(l[v]===g)return p}}},Vf}var oC;function NN(){if(oC)return nC;oC=1;var t=Fe(),e=Fs(),r=ll(),n=vt(),i=lt(),o=dt(),s=ft(),a=zm(),l=ep(),u=DN(),c=jm(),h=String,d=e("JSON","stringify"),g=i(/./.exec),p=i("".charAt),v=i("".charCodeAt),b=i("".replace),E=i(1.1.toString),S=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var F=e("Symbol")("stringify detection");return d([F])!=="[null]"||d({a:F})!=="{}"||d(Object(F))!=="{}"}),H=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),P=function(F,W){var K=l(arguments),L=u(W);if(!(!s(L)&&(F===void 0||a(F))))return K[1]=function(ie,G){if(s(L)&&(G=n(L,this,h(ie),G)),!a(G))return G},r(d,null,K)},A=function(F,W,K){var L=p(K,W-1),ie=p(K,W+1);return g(T,F)&&!g(y,ie)||g(y,F)&&!g(T,L)?"\\u"+E(v(F,0),16):F};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||H},{stringify:function(W,K,L){var ie=l(arguments),G=r(M?P:d,null,ie);return H&&typeof G=="string"?b(G,S,A):G}}),nC}NN();function Qa(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Me(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Qa(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Qa(r[0])]:e[n]=[]:e[n]=null)})),e}function kN(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function $i(t,e,r){const n=Array.isArray(r);return Me(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function J_(t,e){Me(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),J_(t[n],e[n])):t[n]=e[n]})}function Tr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Qe(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Me(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=p=>{let v=p;return(Array.isArray(v)||st(v))&&(v=Tr(v)),v};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Q_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function st(t){return Object.prototype.toString.call(t)==="[object Object]"}function pi(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Me(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function lm(t,e){const r=e.split(".");let n=t;return Me(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Wf(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(jr(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function _p(t){if(!st(t))return 0;const e=function(r){let n=0;return st(r)?Me(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function Cr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function jr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _u(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=_u(t[n],e[n]):r[n]=jr(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{jr(r,n)||(r[n]=t[n])}),r}function um(t){return window.requestAnimationFrame(t)}function sC(t){window.cancelAnimationFrame(t)}function LN(){return"ontouchstart"in window}function FN(){return typeof window<"u"}const Fr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},qi={chrome:Fr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Fr(t=>/CriOS/.test(t)),edge:Fr(t=>/Edge/.test(t)),edgeWebKit:Fr(t=>/EdgiOS/.test(t)),firefox:Fr(t=>/Firefox/.test(t)),firefoxWebKit:Fr(t=>/FxiOS/.test(t)),mobile:Fr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Fr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ml={mac:Fr(t=>/^Mac/.test(t)),win:Fr(t=>/^Win/.test(t)),linux:Fr(t=>/^Linux/.test(t)),ios:Fr(t=>/iPhone|iPad|iPod/i.test(t))};function VN(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(qi,r=>{let{test:n}=r;n(t,e)})}function WN(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(ml,e=>{let{test:r}=e;r(t)})}FN()&&(VN(),WN());function $N(){return qi.chrome.value}function BN(){return qi.chromeWebKit.value}function $f(){return qi.firefox.value}function jN(){return qi.firefoxWebKit.value}function Op(){return qi.safari.value}function zN(){return qi.edge.value}function Hi(){return qi.mobile.value}function e0(){return ml.ios.value}function Mp(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ml.mac.value}function aC(){return ml.win.value}function lC(){return ml.mac.value}function UN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Ou(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function YN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Oo(t){return YN(t)&&t.parent}function t0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Pl(t,e,r){const n=[];let i=t;for(;i&&(i=t0(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function qN(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function _s(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function GN(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Zi(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function r0(t){return!t||!t.length?[]:t.filter(e=>!!e)}function n0(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Z(t,e){typeof e=="string"&&(e=e.split(" ")),e=r0(e),e.length>0&&t.classList.add(...e)}function Oe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=n0(e,!0);r=r0(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Te(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function pl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=n0(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function i0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)i0(e[r])}}function xs(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const KN=/(<(.*)>|&(.*);)/;function o0(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;KN.test(e)?t.innerHTML=r?Y_(e):e:wl(t,e)}function wl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(xs(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function As(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return As(n.host.impl);if(n.host)return As(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function XN(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Wr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function s0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Ip(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Pp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?s0(e):t.scrollTop}function a0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Ip(e):t.scrollLeft}function Uu(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function ZN(t){return t.scrollHeight-t.clientHeight}function JN(t){return t.scrollWidth-t.clientWidth}function Yu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function uC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function ar(t){return t.offsetWidth}function cr(t){return t.getBoundingClientRect().height}function ja(t){return t.clientHeight||t.innerHeight}function l0(t){return t.clientWidth||t.innerWidth}function QN(t){return t.selectionStart?t.selectionStart:0}function cC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function u0(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let Bf;function ek(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");Op()&&!Hi()&&!Mp()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function Ut(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Bf===void 0&&(Bf=ek(t)),Bf}function tk(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function rk(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Hp(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Pc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Mu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function c0(t){return Mu(t)&&t.hasAttribute("data-hot-input")===!1}function nk(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function h0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Te(t,"contenteditable",!0),r&&Te(t,...PN()),e&&Z(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function d0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Oe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function ik(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;h0(t,r),e(),d0(t,r)}function Ro(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Ee(t){return typeof t=="function"}function f0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function ok(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function cm(t,e,r,n,i,o,s,a){return ue(a)?t.call(e,r,n,i,o,s,a):ue(s)?t.call(e,r,n,i,o,s):ue(o)?t.call(e,r,n,i,o):ue(i)?t.call(e,r,n,i):ue(n)?t.call(e,r,n):ue(r)?t.call(e,r):t.call(e)}const ee={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:$f()?182:174,AUDIO_MUTE:$f()?181:173,AUDIO_UP:$f()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},sk=[ee.ALT,ee.ARROW_DOWN,ee.ARROW_LEFT,ee.ARROW_RIGHT,ee.ARROW_UP,ee.AUDIO_DOWN,ee.AUDIO_MUTE,ee.AUDIO_UP,ee.BACKSPACE,ee.CAPS_LOCK,ee.DELETE,ee.END,ee.ENTER,ee.ESCAPE,ee.F1,ee.F2,ee.F3,ee.F4,ee.F5,ee.F6,ee.F7,ee.F8,ee.F9,ee.F10,ee.F11,ee.F12,ee.F13,ee.F14,ee.F15,ee.F16,ee.F17,ee.F18,ee.F19,ee.HOME,ee.INSERT,ee.MEDIA_NEXT,ee.MEDIA_PLAY_PAUSE,ee.MEDIA_PREV,ee.MEDIA_STOP,ee.NULL,ee.NUM_LOCK,ee.PAGE_DOWN,ee.PAGE_UP,ee.PAUSE,ee.SCROLL_LOCK,ee.SHIFT,ee.TAB];function ak(t){return sk.includes(t)}function lk(t){return[ee.CONTROL,ee.COMMAND_LEFT,ee.COMMAND_RIGHT,ee.COMMAND_FIREFOX].includes(t)}function uk(t,e){const r=e.split("|");let n=!1;return j(r,i=>{if(t===ee[i])return n=!0,!1}),n}function Hc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function co(t){return t.isImmediatePropagationEnabled===!1}function qu(t){return t.button===2}function g0(t){return t.button===0}function hr(){ue(console)&&console.warn(...arguments)}function ck(t){ue(console)&&console.warn(`Deprecated: ${t}`)}function hk(){ue(console)&&console.error(...arguments)}const ho=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),zf=new Map([[]]);var hC={},Uf,dC;function dk(){if(dC)return Uf;dC=1;var t=$s();return Uf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},Uf}var Yf,fC;function fk(){if(fC)return Yf;fC=1;var t=at();return Yf=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},Yf}var qf,gC;function xp(){if(gC)return qf;gC=1;var t=gn(),e=Qm(),r=Ui().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),qf=function(o){i[n][o]=!0},qf}var mC;function gk(){if(mC)return hC;mC=1;var t=Fe(),e=lt(),r=_r(),n=il(),i=dk(),o=fk(),s=xp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),hC}gk();var pC={},wC={},vC;function mk(){if(vC)return wC;vC=1;var t=Fe(),e=vt(),r=Bs(),n=_r(),i=yt(),o=Yi(),s=Or(),a=Vo(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,p){if(c(g,d++))return p(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),wC}var yC;function pk(){return yC||(yC=1,mk()),pC}pk();function wk(t,e){m0(t,e),e.add(t)}function Gf(t,e,r){m0(t,e),e.set(t,r)}function m0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bC(t,e,r){return t.set(Gu(t,e),r),r}function Ct(t,e){return t.get(Gu(t,e))}function Gu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const vk=100;var vr=new WeakMap,ps=new WeakMap,Kf=new WeakMap,Xf=new WeakSet;class SC{constructor(){wk(this,Xf),Gf(this,vr,new Map),Gf(this,ps,new Map),Gf(this,Kf,new Set),ho.forEach(e=>Gu(Xf,this,CC).call(this,e))}getHooks(e){var r;return(r=Ct(vr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ct(vr,this).has(e)||(Gu(Xf,this,CC).call(this,e),ho.push(e));const i=Ct(vr,this).get(e),o=i.find(c=>c.callback===r);if(o){o.skip===!0&&(o.skip=!1);return}const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,l=!!n.initialHook;let u=!1;if(l){const c=i.find(h=>h.initialHook);c&&(c.callback=r,u=!0)}if(!u){i.push({callback:r,orderIndex:s,runOnce:a,initialHook:l,skip:!1});let c=Ct(Kf,this).has(e);!c&&s!==0&&(c=!0,Ct(Kf,this).add(e)),c&&i.length>1&&Ct(vr,this).set(e,i.toSorted((h,d)=>h.orderIndex-d.orderIndex))}}has(e){return Ct(vr,this).has(e)&&Ct(vr,this).get(e).length>0}remove(e,r){if(!Ct(vr,this).has(e))return!1;const n=Ct(vr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=Ct(ps,this).get(e);return i.skip=!0,o+=1,o>vk&&(Ct(vr,this).set(e,n.filter(s=>!s.skip)),o=0),Ct(ps,this).set(e,o),!0}return!1}destroy(){Ct(vr,this).clear(),Ct(ps,this).clear(),bC(vr,this,null),bC(ps,this,null)}}function CC(t){Ct(vr,this).set(t,[]),Ct(ps,this).set(t,0)}function yk(t,e,r){return(e=bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bk(t){var e=Sk(t,"string");return typeof e=="symbol"?e:e+""}function Sk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ck=ur`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ge{constructor(){yk(this,"globalBucket",new SC)}static getSingleton(){return Ek()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new SC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.add(e,o,n)):(jf.has(e)&&hr(U_(Ck,{hookName:e,removedInVersion:jf.get(e)})),zf.has(e)&&hr(zf.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?j(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=cm(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=cm(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ho.push(e)}deregister(e){this.isRegistered(e)&&ho.splice(ho.indexOf(e),1)}isDeprecated(e){return zf.has(e)||jf.has(e)}isRegistered(e){return ho.indexOf(e)>=0}getRegistered(){return ho}}const Rk=new ge;function Ek(){return Rk}const yo=new Map;function jo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";yo.has(t)||yo.set(t,new Map);const e=yo.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){yo.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function Tk(t,e){var r;return yo==null||(r=yo.get(t.guid))===null||r===void 0?void 0:r.get(e)}const hm=new WeakMap,{register:_k,getItem:p0,hasItem:w0}=jo("editors");function Ok(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},ge.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Mk(t,e){let r;if(typeof t=="function")hm.get(t)||v0(null,t),r=hm.get(t);else if(typeof t=="string")r=p0(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function RC(t){if(typeof t=="function")return t;if(!w0(t))throw Error(`No registered editor found under "${t}" name`);return p0(t).getConstructor()}function v0(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new Ok(e);typeof t=="string"&&_k(t,r),hm.set(e,r)}function Ik(t,e,r){return(e=Pk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pk(t){var e=Hk(t,"string");return typeof e=="symbol"?e:e+""}function Hk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ik(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,xk(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function xk(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Hc(this)},t}function Ak(t,e){Dk(t,e),e.add(t)}function Dk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ji(t,e,r){return(e=Nk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nk(t){var e=kk(t,"string");return typeof e=="symbol"?e:e+""}function kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hl=new WeakSet;class dm{constructor(e,r,n){Ak(this,Hl),Ji(this,"hot",void 0),Ji(this,"tableMeta",void 0),Ji(this,"selection",void 0),Ji(this,"eventManager",void 0),Ji(this,"destroyed",!1),Ji(this,"activeEditor",void 0),Ji(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Bi(e),this.hot.addHook("afterDocumentKeyDown",i=>Zf(Hl,this,EC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Zf(Hl,this,EC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Zf(Hl,this,Lk).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Mk(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function EC(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||co(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!ak(r)&&!lk(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function Lk(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const TC=new WeakMap;dm.getInstance=function(t,e,r){let n=TC.get(t);return n||(n=new dm(t,e,r),TC.set(t,n)),n};var _C={},Jf,OC;function Fk(){if(OC)return Jf;OC=1;var t=Ur(),e=Ao(),r=gn(),n=r("match");return Jf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Jf}var Qf,MC;function Vk(){if(MC)return Qf;MC=1;var t=at(),e=dt(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return Qf={correct:n},Qf}var eg,IC;function Wk(){if(IC)return eg;IC=1;var t=yt();return eg=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},eg}var tg,PC;function $k(){if(PC)return tg;PC=1;var t=vt(),e=Yr(),r=ol(),n=Vk(),i=Wk(),o=RegExp.prototype;return tg=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},tg}var rg,HC;function Bk(){if(HC)return rg;HC=1;var t=lt(),e=Vs(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return rg=function(l,u,c,h,d,g){var p=c+l.length,v=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(E,S){var T;switch(n(S,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,p);case"<":T=d[o(S,1,-1)];break;default:var y=+S;if(y===0)return E;if(y>v){var M=r(y/10);return M===0?E:M<=v?h[M-1]===void 0?n(S,1):h[M-1]+n(S,1):E}T=h[y-1]}return T===void 0?"":T})},rg}var xC;function jk(){if(xC)return _C;xC=1;var t=Fe(),e=vt(),r=lt(),n=nl(),i=ft(),o=Ur(),s=Fk(),a=pc(),l=sl(),u=$k(),c=Bk(),h=gn(),d=Do(),g=h("replace"),p=TypeError,v=r("".indexOf),b=r("".replace),E=r("".slice),S=Math.max;return t({target:"String",proto:!0},{replaceAll:function(y,M){var H=n(this),P,A,F,W,K,L,ie,G,te,tt,Ie=0,Ce="";if(o(y)){if(P=s(y),P&&(A=a(n(u(y))),!~v(A,"g")))throw new p("`.replaceAll` does not allow non-global regexes");if(F=l(y,g),F)return e(F,y,H,M);if(d&&P)return b(a(H),y,M)}for(W=a(H),K=a(y),L=i(M),L||(M=a(M)),ie=K.length,G=S(1,ie),te=v(W,K);te!==-1;)tt=L?a(M(K,te,W)):c(K,W,te,[],void 0,M),Ce+=E(W,Ie,te)+tt,Ie=te+ie,te=te+G>W.length?-1:v(W,K,te+G);return Ie<W.length&&(Ce+=E(W,Ie)),Ce}}),_C}jk();const y0={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},zk=new RegExp(Object.keys(y0).map(t=>`(${t})`).join("|"),"gi");function Uk(t){return(t&&t.nodeName||"")==="TABLE"}function AC(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,p=[];for(let b=0;b<s;b+=1){const E=!g&&r&&b===0;let S="";if(g)S=`<th>${t.getColHeader(b-c)}</th>`;else if(E)S=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][b],{hidden:y,rowspan:M,colspan:H}=t.getCellMeta(d-h,b-c);if(!y){const P=[];if(M&&P.push(`rowspan="${M}"`),H&&P.push(`colspan="${H}"`),_o(T))S=`<td ${P.join(" ")}></td>`;else{const A=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S=`<td ${P.join(" ")}>${A}</td>`}}}p.push(S)}const v=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function DC(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=_o(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function NC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,y=>{const M=y.match(/<td\b[^>]*?>/g)[0],H=/<p.*?>/g,P=y.substring(M.length,y.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(H,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!Uk(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,y)=>T+y.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,p=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(y=>{const M=y.querySelector("td")!==null;return M&&h.push(y),!M});g=T.length,d=g>0,g>1?r.nestedHeaders=Array.from(T).reduce((y,M)=>{const H=Array.from(M.cells).reduce((P,A,F)=>{if(a&&F===0)return P;const{colSpan:W,innerHTML:K}=A,L=W>1?{label:K,colspan:W}:K;return P.push(L),P},[]);return y.push(H),y},[]):d&&(r.colHeaders=Array.from(T[0].children).reduce((y,M,H)=>(a&&H===0||y.push(M.innerHTML),y),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((T,y)=>(T.push(...Array.from(y.rows)),T),[]),...c];p=v.length;const b=new Array(p);for(let T=0;T<p;T++)b[T]=new Array(u);const E=[],S=[];for(let T=0;T<p;T++){const y=v[T],M=Array.from(y.cells),H=M.length;for(let P=0;P<H;P++){const A=M[P],{nodeName:F,innerHTML:W,rowSpan:K,colSpan:L}=A,ie=b[T].findIndex(G=>G===void 0);if(F==="TD"){if(K>1||L>1){for(let Ie=T;Ie<T+K;Ie++)if(Ie<p)for(let Ce=ie;Ce<ie+L;Ce++)b[Ie][Ce]=null;const te=A.getAttribute("style");te&&te.includes("mso-ignore:colspan")||E.push({col:ie,row:T,rowspan:K,colspan:L})}let G="";s&&/excel/gi.test(s.content)?G=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):G=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[T][ie]=G.replace(zk,te=>y0[te])}else S.push(W)}}return E.length&&(r.mergeCells=E),S.length&&(r.rowHeaders=S),b.length&&(r.data=b),r}function Yk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Xe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function kC(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function qk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ne(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function Os(t){return Number.isInteger(t)&&t>=0}const fm="asc",Gk="desc",LC=new Map([[fm,[-1,1]],[Gk,[1,-1]]]),Kk=t=>`The priority '${t}' is already declared in a map.`,Xk=t=>`The priority '${t}' is not a number.`;function Zk(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Ee(t)?t:Kk,e=Ee(e)?e:Xk;function n(o,s){if(!Yk(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fm;const[s,a]=LC.get(o)||LC.get(fm);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const Jk=t=>`The id '${t}' is already declared in a map.`;function vl(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ee(t)?t:Jk;function r(c,h){if(u(c))throw new Error(t(c));e.set(c,h)}function n(c){return e.delete(c)}function i(){e.clear()}function o(c){const[h]=a().find(d=>{let[g,p]=d;return c===p?g:!1})||[null];return h}function s(c){return e.get(c)}function a(){return[...e]}function l(){return[...e.values()]}function u(c){return e.has(c)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,getValues:l,hasItem:u,removeItem:n}}const Qk=t=>`'${t}' value is already declared in a unique set.`;function eL(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ee(t)?t:Qk;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const Ap=t=>`There is already registered "${t}" plugin.`,tL=t=>`There is already registered plugin on priority "${t}".`,rL=t=>`The priority "${t}" is not a number.`,b0=Zk({errorPriorityExists:tL,errorPriorityNaN:rL}),S0=eL({errorItemExists:Ap}),gm=vl({errorIdExists:Ap});function C0(){return[...b0.getItems(),...S0.getItems()]}function Dp(t){const e=Mc(t);return gm.getItem(e)}function nL(t){return!!Dp(t)}function xl(t,e,r){[t,e,r]=oL(t,e,r),Dp(t)===void 0&&iL(t,e,r)}function iL(t,e,r){const n=Mc(t);if(gm.hasItem(n))throw new Error(Ap(n));r===void 0?S0.addItem(n):b0.addItem(r,n),gm.addItem(n,e)}function oL(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:sL,getItem:aL,hasItem:R0}=jo("renderers");function FC(t){if(typeof t=="function")return t;if(!R0(t))throw Error(`No registered renderer found under "${t}" name`);return aL(t)}function lL(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),sL(t,e)}const{register:uL,getItem:cL,hasItem:E0}=jo("validators");function hL(t){if(typeof t=="function")return t;if(!E0(t))throw Error(`No registered validator found under "${t}" name`);return cL(t)}function dL(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),uL(t,e)}var VC={},WC;function fL(){if(WC)return VC;WC=1;var t=Fe(),e=Vs(),r=$s(),n=al(),i=xp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),VC}fL();var $C={},BC;function gL(){if(BC)return $C;BC=1;var t=Fe(),e=lt(),r=nl(),n=al(),i=pc(),o=dt(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),$C}gL();function oa(t,e,r){return(e=mL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mL(t){var e=pL(t,"string");return typeof e=="symbol"?e:e+""}function pL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wL{constructor(){oa(this,"count",0),oa(this,"startColumn",null),oa(this,"endColumn",null),oa(this,"startPosition",null),oa(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=i&&(this.startColumn-=1),p>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function sa(t,e,r){return(e=vL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vL(t){var e=yL(t,"string");return typeof e=="symbol"?e:e+""}function yL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bL{constructor(){sa(this,"count",0),sa(this,"startRow",null),sa(this,"endRow",null),sa(this,"startPosition",null),sa(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function aa(t,e,r){return(e=SL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SL(t){var e=CL(t,"string");return typeof e=="symbol"?e:e+""}function CL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T0{constructor(){aa(this,"count",0),aa(this,"startColumn",null),aa(this,"endColumn",null),aa(this,"startPosition",null),aa(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function la(t,e,r){return(e=RL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RL(t){var e=EL(t,"string");return typeof e=="symbol"?e:e+""}function EL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _0{constructor(){la(this,"count",0),la(this,"startRow",null),la(this,"endRow",null),la(this,"startPosition",null),la(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ua(t,e,r){return(e=TL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TL(t){var e=_L(t,"string");return typeof e=="symbol"?e:e+""}function _L(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OL{constructor(){ua(this,"count",0),ua(this,"startColumn",0),ua(this,"endColumn",0),ua(this,"startPosition",0),ua(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function ca(t,e,r){return(e=ML(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ML(t){var e=IL(t,"string");return typeof e=="symbol"?e:e+""}function IL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PL{constructor(){ca(this,"count",0),ca(this,"startRow",0),ca(this,"endRow",0),ca(this,"startPosition",0),ca(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function jC(t,e,r){return(e=HL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HL(t){var e=xL(t,"string");return typeof e=="symbol"?e:e+""}function xL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AL extends T0{constructor(){super(...arguments),jC(this,"columnStartOffset",0),jC(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function zC(t,e,r){return(e=DL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DL(t){var e=NL(t,"string");return typeof e=="symbol"?e:e+""}function NL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kL extends _0{constructor(){super(...arguments),zC(this,"rowStartOffset",0),zC(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function UC(t,e,r){return(e=LL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LL(t){var e=FL(t,"string");return typeof e=="symbol"?e:e+""}function FL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O0{constructor(e){UC(this,"calculationTypes",[]),UC(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Jr(t,e,r){return(e=VL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VL(t){var e=WL(t,"string");return typeof e=="symbol"?e:e+""}function WL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Np=50;class $L extends O0{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Jr(this,"viewportWidth",0),Jr(this,"scrollOffset",0),Jr(this,"zeroBasedScrollOffset",0),Jr(this,"totalColumns",0),Jr(this,"columnWidthFn",null),Jr(this,"columnWidth",0),Jr(this,"overrideFn",null),Jr(this,"inlineStartOffset",0),Jr(this,"totalCalculatedWidth",0),Jr(this,"startPositions",[]),Jr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Np:r}}function xr(t,e,r){return(e=BL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BL(t){var e=jL(t,"string");return typeof e=="symbol"?e:e+""}function jL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zL extends O0{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),xr(this,"viewportHeight",0),xr(this,"scrollOffset",0),xr(this,"zeroBasedScrollOffset",0),xr(this,"totalRows",0),xr(this,"rowHeightFn",null),xr(this,"rowHeight",0),xr(this,"overrideFn",null),xr(this,"horizontalScrollbarHeight",0),xr(this,"innerViewportHeight",0),xr(this,"totalCalculatedHeight",0),xr(this,"startPositions",[]),xr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function UL(t,e,r){YL(t,e),e.set(t,r)}function YL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YC(t,e,r){return(e=qL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qL(t){var e=GL(t,"string");return typeof e=="symbol"?e:e+""}function GL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ko(t,e){return t.get(M0(t,e))}function qC(t,e,r){return t.set(M0(t,e),r),r}function M0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yn=new WeakMap;class Mo{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;YC(this,"row",null),YC(this,"col",null),UL(this,Yn,!1),qC(Yn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ko(Yn,this)}isSouthEastOf(e){return this.row>=e.row&&(Ko(Yn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ko(Yn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ko(Yn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ko(Yn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Mo&&qC(Yn,this,e.isRtl()),this}clone(){return new Mo(this.row,this.col,Ko(Yn,this))}toObject(){return{row:this.row,col:this.col}}}function KL(t,e,r){XL(t,e),e.set(t,r)}function XL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ng(t,e,r){return(e=ZL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZL(t){var e=JL(t,"string");return typeof e=="symbol"?e:e+""}function JL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ar(t,e){return t.get(I0(t,e))}function QL(t,e,r){return t.set(I0(t,e),r),r}function I0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Kt=new WeakMap;class yl{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ng(this,"highlight",null),ng(this,"from",null),ng(this,"to",null),KL(this,Kt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),QL(Kt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ar(Kt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ar(Kt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ar(Kt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ar(Kt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ar(Kt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ar(Kt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ar(Kt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ar(Kt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Mo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Ar(Kt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Ar(Kt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new yl(this.highlight,this.from,this.to,Ar(Kt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Mo(e,r,Ar(Kt,this))}}function bn(t,e,r){eF(t,e),e.set(t,r)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U(t,e){return t.get(P0(t,e))}function vi(t,e,r){return t.set(P0(t,e),r),r}function P0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Dr=new WeakMap,ig=new WeakMap,wt=new WeakMap,Xo=new WeakMap,Al=new WeakMap,Qr=new WeakMap,og=new WeakMap,ha=new WeakMap,Qi=new WeakMap,Sn=new WeakMap;let H0=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;bn(this,Dr,void 0),bn(this,ig,void 0),bn(this,wt,void 0),bn(this,Xo,void 0),bn(this,Al,void 0),bn(this,Qr,void 0),bn(this,og,void 0),bn(this,ha,void 0),bn(this,Qi,[null,null]),bn(this,Sn,[null,null]),vi(Dr,this,n),vi(ig,this,r),vi(wt,this,o),vi(Xo,this,s),vi(Al,this,a),vi(Qr,this,i),vi(og,this,e),this.registerEvents()}registerEvents(){U(Qr,this).addEventListener(U(wt,this).holder,"contextmenu",n=>this.onContextMenu(n)),U(Qr,this).addEventListener(U(wt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),U(Qr,this).addEventListener(U(wt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{U(Qr,this).addEventListener(U(wt,this).holder,"touchstart",n=>this.onTouchStart(n)),U(Qr,this).addEventListener(U(wt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),U(Qr,this).addEventListener(U(wt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||U(Dr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,U(Dr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{U(Qr,this).addEventListener(U(wt,this).holder,"mouseup",n=>this.onMouseUp(n)),U(Qr,this).addEventListener(U(wt,this).holder,"mousedown",n=>this.onMouseDown(n))};Hi()?e():(LN()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(U(ha,this)&&n){const[i,o]=[n.row,U(ha,this).from.row],[s,a]=[n.col,U(ha,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=U(wt,this).TABLE,i=Pl(e,["TD","TH"],n);return i?(r.coords=U(wt,this).getCoords(i),r.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(r.coords=U(Xo,this).getFocusSelection().cellRange.highlight,r.TD=U(wt,this).getCell(r.coords)):ve(e,"wtBorder")&&ve(e,"area")&&U(Xo,this).getAreaSelection().cellRange&&(r.coords=U(Xo,this).getAreaSelection().cellRange.to,r.TD=U(wt,this).getCell(r.coords)),r}onMouseDown(e){const r=U(ig,this).rootDocument.activeElement,n=ok(UN,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);ve(i,"corner")?U(Dr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&U(Dr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(U(Sn,this)[0]=o.TD,clearTimeout(U(Qi,this)[0]),U(Qi,this)[0]=setTimeout(()=>{U(Sn,this)[0]=null},1e3))}onContextMenu(e){if(U(Dr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!U(Dr,this).has("onCellMouseOver"))return;const r=U(wt,this).TABLE,n=Pl(e.target,["TD","TH"],r),i=U(Al,this)||this;n&&n!==i.lastMouseOver&&_s(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,U(wt,this).getCoords(n),n))}onMouseOut(e){if(!U(Dr,this).has("onCellMouseOut"))return;const r=U(wt,this).TABLE,n=Pl(e.target,["TD","TH"],r),i=Pl(e.relatedTarget,["TD","TH"],r),o=U(Al,this)||this;n&&n!==i&&_s(n,r)&&(this.callListener("onCellMouseOut",e,U(wt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&U(Dr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===U(Sn,this)[0]&&r.TD===U(Sn,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),U(Sn,this)[0]=null,U(Sn,this)[1]=null):r.TD===U(Sn,this)[0]&&(U(Sn,this)[1]=r.TD,clearTimeout(U(Qi,this)[1]),U(Qi,this)[1]=setTimeout(()=>{U(Sn,this)[1]=null},500)))}onTouchStart(e){vi(ha,this,U(Xo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&U(Dr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];e0()&&(BN()||jN())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=U(Dr,this).getSettingPure(e);o&&o(r,n,i,U(og,this).call(this))}destroy(){clearTimeout(U(Qi,this)[0]),clearTimeout(U(Qi,this)[1]),U(Qr,this).destroy()}};function sg(t,e,r){return(e=tF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tF(t){var e=rF(t,"string");return typeof e=="symbol"?e:e+""}function rF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nF{constructor(e,r,n){sg(this,"offset",void 0),sg(this,"total",void 0),sg(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function ag(t,e,r){return(e=iF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iF(t){var e=oF(t,"string");return typeof e=="symbol"?e:e+""}function oF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sF{constructor(e,r,n){ag(this,"offset",void 0),ag(this,"total",void 0),ag(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Dl(t,e,r){return(e=aF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aF(t){var e=lF(t,"string");return typeof e=="symbol"?e:e+""}function lF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uF{constructor(){Dl(this,"currentSize",0),Dl(this,"nextSize",0),Dl(this,"currentOffset",0),Dl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const cF=0,GC=1,mm=2;function lg(t,e,r){return(e=hF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hF(t){var e=dF(t,"string");return typeof e=="symbol"?e:e+""}function dF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fF{constructor(){lg(this,"size",new uF),lg(this,"workingSpace",cF),lg(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=GC,e.workingSpace=mm,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=mm,e.workingSpace=GC,this.sharedSize=e.getViewSize()}}var KC={},ug,XC;function gF(){if(XC)return ug;XC=1;var t=mc(),e=TypeError;return ug=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},ug}var ZC;function mF(){if(ZC)return KC;ZC=1;var t=Fe(),e=Vs(),r=$s(),n=xT(),i=gF(),o=AT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var p=d;p--;){var v=p+g;p in h?h[v]=h[p]:i(h,v)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),KC}mF();function pF(t,e,r){return(e=wF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wF(t){var e=vF(t,"string");return typeof e=="symbol"?e:e+""}function vF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JC{constructor(e,r){pF(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function yF(t,e,r){return(e=bF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bF(t){var e=SF(t,"string");return typeof e=="symbol"?e:e+""}function SF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CF{constructor(e){yF(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new JC(o,r),l=new JC(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(mm)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function Zo(t,e,r){return(e=RF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RF(t){var e=EF(t,"string");return typeof e=="symbol"?e:e+""}function EF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x0{constructor(e,r){Zo(this,"rootNode",void 0),Zo(this,"nodesPool",void 0),Zo(this,"sizeSet",new fF),Zo(this,"collectedNodes",[]),Zo(this,"viewDiffer",new CF(this.sizeSet)),Zo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class A0 extends x0{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function QC(t,e,r){return(e=TF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TF(t){var e=_F(t,"string");return typeof e=="symbol"?e:e+""}function _F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OF{constructor(e){QC(this,"nodeType",void 0),QC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function da(t,e,r){return(e=MF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MF(t){var e=IF(t,"string");return typeof e=="symbol"?e:e+""}function IF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bl{constructor(e,r){da(this,"nodesPool",null),da(this,"nodeType",void 0),da(this,"rootNode",void 0),da(this,"table",null),da(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new OF(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function eR(t,e,r){return(e=PF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PF(t){var e=HF(t,"string");return typeof e=="symbol"?e:e+""}function HF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xF extends bl{constructor(){super("TH"),eR(this,"orderViews",new WeakMap),eR(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new A0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),pl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(d,[RN(),IN(),Tp(h+1),Bo(-1)]),r[h](a,d,h)}u.end()}}}class AF extends bl{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&xs(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Te(this.rootNode,[q_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Te(s,[G_(),X_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),pl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(u,[Tp(a+1+this.table.rowHeadersCount),Bo(-1),EN(),...a>=0?[MN()]:[CN(),zu("Select whole grid")]]),n[r](l,u,r)}}}}let tR=!1;class DF extends bl{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!tR&&e>1e3&&(tR=!0,hr(ur`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&Z(n,"rowHeader")}}function NF(t,e,r){return(e=kF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kF(t){var e=LF(t,"string");return typeof e=="symbol"?e:e+""}function LF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jo={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let rR=!1;class FF extends bl{constructor(e){super("TR",e),NF(this,"orderView",void 0),this.orderView=new x0(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!rR&&e>1e3&&(rR=!0,hr(ur`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Te(this.rootNode,[q_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Te(o,[G_(),X_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?ve(o,Jo.rowEven)||(Oe(o,Jo.rowOdd),Z(o,Jo.rowEven)):ve(o,Jo.rowOdd)||(Oe(o,Jo.rowEven),Z(o,Jo.rowOdd))}this.orderView.end()}}function nR(t,e,r){return(e=VF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VF(t){var e=WF(t,"string");return typeof e=="symbol"?e:e+""}function WF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $F extends bl{constructor(){super("TD"),nR(this,"orderViews",new WeakMap),nR(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new A0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),p=c.getCurrentNode();if(ve(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),pl(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,p),this.table.isAriaEnabled()){var o,s;Te(p,[...p.hasAttribute("role")?[]:[SN()],Bo(-1),Tp(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function ut(t,e,r){return(e=BF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BF(t){var e=jF(t,"string");return typeof e=="symbol"?e:e+""}function jF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zF{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ut(this,"rootNode",void 0),ut(this,"rootDocument",void 0),ut(this,"rowHeaders",null),ut(this,"columnHeaders",null),ut(this,"colGroup",null),ut(this,"rows",null),ut(this,"cells",null),ut(this,"rowFilter",null),ut(this,"columnFilter",null),ut(this,"rowUtils",null),ut(this,"columnUtils",null),ut(this,"rowsToRender",0),ut(this,"columnsToRender",0),ut(this,"rowHeaderFunctions",[]),ut(this,"rowHeadersCount",0),ut(this,"columnHeaderFunctions",[]),ut(this,"columnHeadersCount",0),ut(this,"cellRenderer",void 0),ut(this,"activeOverlayName",void 0),ut(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class UF{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new zF(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new xF,columnHeaders:new AF(r),colGroup:new DF(n),rows:new FF(i),cells:new $F}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cg(t,e,r){return(e=YF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YF(t){var e=qF(t,"string");return typeof e=="symbol"?e:e+""}function qF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GF{constructor(e,r){cg(this,"dataAccessObject",void 0),cg(this,"wtSettings",void 0),cg(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function iR(t,e,r){return(e=KF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KF(t){var e=XF(t,"string");return typeof e=="symbol"?e:e+""}function XF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZF{constructor(e,r){iR(this,"dataAccessObject",void 0),iR(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Cn(t,e,r){return(e=JF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JF(t){var e=QF(t,"string");return typeof e=="symbol"?e:e+""}function QF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ys{constructor(e,r,n,i,o){Cn(this,"wtSettings",null),Cn(this,"domBindings",void 0),Cn(this,"TBODY",null),Cn(this,"THEAD",null),Cn(this,"COLGROUP",null),Cn(this,"hasTableHeight",!0),Cn(this,"hasTableWidth",!0),Cn(this,"isTableVisible",!1),Cn(this,"tableOffset",0),Cn(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,i0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new ZF(this.dataAccessObject,this.wtSettings),this.columnUtils=new GF(this.dataAccessObject,this.wtSettings),this.tableRenderer=new UF({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Te(n,[Pi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(n,[Pi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Te(n,[Bo(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Te(n.parentNode,[Pi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(n,[Pi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Wr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Wr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),p=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new sF(g,o,c),this.columnFilter=new nF(p,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),v=b.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Pn)||this.is(Vi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Pn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Pn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=ja(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Pn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=t0(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=GN(n),s=r.cellIndex;Zi(Ho,r,this.wtRootElement)||Zi(Io,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Zi(Vi,r,this.wtRootElement)||Zi(Pn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Zi(Ho,r,this.wtRootElement)||Zi(Po,r,this.wtRootElement)||Zi(Vi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=ja(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?cr:ja,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const p=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-p||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ar(this.TABLE)}getHeight(){return cr(this.TABLE)}getTotalWidth(){const e=ar(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=cr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return As(this.TABLE)}_modifyRowHeaderWidth(e){let r=Ee(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const eV="stickyRowsBottom",kp={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};pi(kp,"MIXIN_NAME",eV,{writable:!1,enumerable:!1});const tV="stickyColumnsStart",xc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pi(xc,"MIXIN_NAME",tV,{writable:!1,enumerable:!1});class Lp extends Ys{constructor(e,r,n,i){super(e,r,n,i,Vi)}}Qe(Lp,kp);Qe(Lp,xc);const Io="top",Pn="bottom",Po="inline_start",Ho="top_inline_start_corner",Vi="bottom_inline_start_corner",D0=[Io,Pn,Po,Ho,Vi],rV=new Map([[Io,`ht_clone_${Io}`],[Pn,`ht_clone_${Pn}`],[Po,`ht_clone_${Po} ht_clone_left`],[Ho,`ht_clone_${Ho} ht_clone_top_left_corner`],[Vi,`ht_clone_${Vi} ht_clone_bottom_left_corner`]]);function nV(t,e){iV(t,e),e.add(t)}function iV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oV(t,e,r){return(e=sV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sV(t){var e=aV(t,"string");return typeof e=="symbol"?e:e+""}function aV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fa=new WeakSet;class lV{constructor(e){nV(this,fa),oV(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=Cr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=Cr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Nl(fa,this,sR).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Nl(fa,this,sR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Nl(fa,this,oR).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Nl(fa,this,oR).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function oR(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Wr(n.wtRootElement).left;const u=Math.abs(a0(s,s));if(l>u){const c=l0(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function sR(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Wr(r.wtRootElement),a=Pp(o,o);if(s.top>a){const l=ja(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Nr(t,e,r){return(e=uV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uV(t){var e=cV(t,"string");return typeof e=="symbol"?e:e+""}function cV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fp{get eventManager(){return new Bi(this)}constructor(e,r){Nr(this,"wtTable",void 0),Nr(this,"wtScroll",void 0),Nr(this,"wtViewport",void 0),Nr(this,"wtOverlays",void 0),Nr(this,"selectionManager",void 0),Nr(this,"wtEvent",void 0),Nr(this,"guid",`wt_${z_()}`),Nr(this,"drawInterrupted",!1),Nr(this,"drawn",!1),Nr(this,"activeOverlayName","master"),Nr(this,"domBindings",void 0),Nr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new lV(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){wl(n,e[r])}])}}createCellCoords(e,r){return new Mo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new yl(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||XN(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function aR(t,e,r){return(e=hV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hV(t){var e=dV(t,"string");return typeof e=="symbol"?e:e+""}function dV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fV extends Fp{constructor(e,r,n){super(e,r),aR(this,"cloneSource",void 0),aR(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new H0(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function gV(t,e,r){return(e=mV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mV(t){var e=pV(t,"string");return typeof e=="symbol"?e:e+""}function pV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sl{constructor(e,r,n,i,o){gV(this,"wtSettings",null),pi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Yu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Yu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Uu(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){hr(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Ut())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(D0.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${rV.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Te(o,[Pi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Io||u==="vertical"&&this.type===Po?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Uu(e.TABLE),new fV(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class wV extends Sl{constructor(e,r,n,i,o,s){super(e,r,Vi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Lp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Pc(r),this.repositionOverlay();let n=cr(this.clone.wtTable.TABLE);const i=ar(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=Ut(n)),i.style.bottom=`${o}px`}}const vV="calculatedColumns",Ac={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pi(Ac,"MIXIN_NAME",vV,{writable:!1,enumerable:!1});class Vp extends Ys{constructor(e,r,n,i){super(e,r,n,i,Pn)}}Qe(Vp,kp);Qe(Vp,Ac);function yV(t,e,r){return(e=bV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bV(t){var e=SV(t,"string");return typeof e=="symbol"?e:e+""}function SV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CV extends Sl{constructor(e,r,n,i){super(e,r,Pn,n,i),yV(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Vp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=Ut(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Ip(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=cr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=Ut(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Pp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Z(s,"innerBorderBottom"),o=!a):(Oe(s,"innerBorderBottom"),o=a)}return o}}const RV="calculatedRows",Wp={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pi(Wp,"MIXIN_NAME",RV,{writable:!1,enumerable:!1});class $p extends Ys{constructor(e,r,n,i){super(e,r,n,i,Po)}}Qe($p,Wp);Qe($p,xc);const EV="localHooks",Fn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)cm(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};pi(Fn,"MIXIN_NAME",EV,{writable:!1,enumerable:!1});let N0=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Qe(N0,Fn);const TV="active-header",k0="header",Bp="area",Ku="focus",_V="fill",OV="row",MV="column",IV="custom-selection",jp=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var lR={},uR;function PV(){if(uR)return lR;uR=1;var t=xp();return t("flat"),lR}PV();function HV(t,e){L0(t,e),e.add(t)}function cR(t,e,r){L0(t,e),e.set(t,r)}function L0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ge(t,e){return t.get(za(t,e))}function hR(t,e,r){return t.set(za(t,e),r),r}function za(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var rn=new WeakMap,Pt=new WeakMap,kl=new WeakSet;class xV{constructor(){HV(this,kl),cR(this,rn,void 0),cR(this,Pt,void 0)}setActiveOverlay(e){return hR(Pt,this,e),this}setActiveSelection(e){return hR(rn,this,e),this}scan(){const e=Ge(rn,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ge(rn,this).getCorners(),{wtTable:s}=Ge(Pt,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let p=s.getColumnHeader(h,g);const v=Ge(Pt,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ge(rn,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==h&&(p=s.getColumnHeader(v,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ge(rn,this).getCorners(),{wtTable:s}=Ge(Pt,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let p=s.getRowHeader(h,g);const v=Ge(Pt,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ge(rn,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==h&&(p=s.getRowHeader(v,g)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ge(Pt,this);za(kl,this,AV).call(this,(n,i)=>{const o=r.getCell(Ge(Pt,this).createCellCoords(n,i)),s=Ge(Pt,this).getSetting("onAfterDrawSelection",n,i,Ge(rn,this).settings.layerLevel);typeof s=="string"&&Z(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ge(rn,this).getCorners(),{wtTable:i}=Ge(Pt,this);za(kl,this,dR).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ge(Pt,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ge(rn,this).getCorners(),{wtTable:i}=Ge(Pt,this);za(kl,this,dR).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ge(Pt,this).createCellCoords(o,s));e(a)}})}}function AV(t){let[e,r,n,i]=Ge(rn,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ge(Pt,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ge(Pt,this).createCellCoords(e,r));if(!Ro(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function dR(t){const{wtTable:e}=Ge(Pt,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}const fR="ht-border-style-",DV="-vertical",NV="-horizontal";class gR{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=jp(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Hc(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div"),c=d=>this.settings[l]&&this.settings[l][d]?this.settings[l][d]:e.border[d];u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style;const h=c("style");h?(["start","end"].includes(l)?u.className+=` ${fR}${h}${DV}`:u.className+=` ${fR}${h}${NV}`,i.setProperty("--ht-custom-border-size",`${c("width")}px`),i.setProperty("--ht-custom-border-color",c("color"))):i.backgroundColor=c("color"),i.height=`${c("width")}px`,i.width=`${c("width")}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Hi()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Me(h,(g,p)=>{this.selectionHandles.styles.bottomHitArea[p]=g,this.selectionHandles.styles.topHitArea[p]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Me(d,(g,p)=>{this.selectionHandles.styles.bottom[p]=g,this.selectionHandles.styles.top[p]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),v=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(n-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const S=Math.min(parseInt(i+o,10),b-p-g*2),T=Math.min(parseInt(i+o-v/4,10),b-v-g*2);h[l]=`${S}px`,d[l]=`${T}px`;const y=Math.min(parseInt(n+s,10),E-p-g*2),M=Math.min(parseInt(n+s-v/4,10),E-v-g*2);h.top=`${y}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),p=s.getLastRenderedColumn();if(g<0&&p<0||h<0&&d<0){this.disappear();return}let v;if(u){if(n=Math.max(n,g),o=Math.min(o,p),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}v=s.getCell(this.wot.createCellCoords(r,n))}else if(v=s.getCell(this.wot.createCellCoords(r,n)),!Ro(v)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(i,o)):v,E=Wr(v),S=u?Wr(b):E,T=Wr(s.TABLE),y=E.top,M=E.left,H=this.wot.wtSettings.getSetting("rtlMode");let P=0,A=0;if(H){const Ce=ar(s.TABLE),Be=ar(v),je=l.innerWidth-T.left-Ce;A=M+Be-S.left,P=l.innerWidth-M-Be-je-1}else A=S.left+ar(b)-M,P=M-T.left-1;if(this.isEntireColumnSelected(r,i)){const Ce=r,Be=this.getDimensionsFromHeader("columns",n,o,Ce,T);let je=null;Be&&([je,P,A]=Be),je&&(v=je)}let F=y-T.top-1,W=S.top+cr(b)-y;if(this.isEntireRowSelected(n,o)){const Ce=n,Be=this.getDimensionsFromHeader("rows",r,i,Ce,T);let je=null;Be&&([je,F,W]=Be),je&&(v=je)}const K=l.getComputedStyle(v);parseInt(K.borderTopWidth,10)>0&&(F+=1,W=W>0?W-1:0),parseInt(K[H?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,A=A>0?A-1:0);const L=H?"right":"left",ie=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${F}px`,this.topStyle[L]=`${P}px`,this.topStyle.width=`${A+ie}px`,this.topStyle.display="block",this.startStyle.top=`${F}px`,this.startStyle[L]=`${P}px`,this.startStyle.height=`${W+ie}px`,this.startStyle.display="block",this.bottomStyle.top=`${F+W-parseInt(this.bottomStyle.height,10)+ie}px`,this.bottomStyle[L]=`${P}px`,this.bottomStyle.width=`${A+ie}px`,this.bottomStyle.display="block",this.endStyle.top=`${F}px`,this.endStyle[L]=`${P+A-parseInt(this.endStyle.width,10)+ie}px`,this.endStyle.height=`${W+ie}px`,this.endStyle.display="block";let G=this.settings.border.cornerVisible;G=typeof G=="function"?G(this.settings.layerLevel):G;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[tt,Ie]=[i,o];if(te&&Array.isArray(te)&&([,,tt,Ie]=te),Hi()||!G||this.isPartRange(tt,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top=`${F+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${P+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ce=Yu(s.TABLE);const Be=Ce===l;Be&&(Ce=a.documentElement);const je=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Pe=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Ir=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const He=Be?b.getBoundingClientRect().left:b.offsetLeft;let Dt=!1,f=0;if(H?(f=He-parseInt(this.cornerDefaultStyle.width,10)/2,Dt=f<0):(f=He+ar(b)+parseInt(this.cornerDefaultStyle.width,10)/2,Dt=f>=l0(Ce)),Dt){const m=Math.floor(P+A+this.cornerCenterPointOffset-Pe-je);c?(this.cornerStyle[L]=`${m}px`,this.cornerStyle[H?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${m-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Be?b.getBoundingClientRect().top:b.offsetTop)+cr(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=ja(Ce)){const m=Math.floor(F+W+this.cornerCenterPointOffset-Ir-je);c?(this.cornerStyle.top=`${m}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${m-1}px`}this.cornerStyle.display="block"}Hi()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,F,P,A,W)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,p=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return cr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ar(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(p=l(r,b-i),v=l(n,b-i),!p||!v)return!1;const E=Wr(p),S=Wr(v);return p&&v&&(h=E[g]-o[g]-1,d=S[g]+u(v)-E[g]),[p,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Z(this[e],"hidden"):(ve(this[e],"hidden")&&Oe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Z(this[e],"hidden"):Oe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Hi()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function kV(t,e){F0(t,e),e.add(t)}function Qo(t,e,r){F0(t,e),e.set(t,r)}function F0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(zp(t,e))}function mR(t,e,r){return t.set(zp(t,e),r),r}function zp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ht=new WeakMap,tr=new WeakMap,hg=new WeakMap,xa=new WeakMap,dg=new WeakMap,eo=new WeakMap,pR=new WeakSet;class LV{constructor(e){kV(this,pR),Qo(this,Ht,void 0),Qo(this,tr,void 0),Qo(this,hg,new xV),Qo(this,xa,new WeakMap),Qo(this,dg,new WeakSet),Qo(this,eo,new Map),mR(tr,this,e)}setActiveOverlay(e){return mR(Ht,this,e),le(hg,this).setActiveOverlay(le(Ht,this)),le(xa,this).has(le(Ht,this))||le(xa,this).set(le(Ht,this),new Set),this}getFocusSelection(){return le(tr,this)!==null?le(tr,this).getFocus():null}getAreaSelection(){return le(tr,this)!==null?le(tr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(eo,this).has(e)){const n=le(eo,this).get(e);if(n.has(le(Ht,this)))return n.get(le(Ht,this));const i=new gR(le(Ht,this),e.settings);return n.set(le(Ht,this),i),i}const r=new gR(le(Ht,this),e.settings);return le(eo,this).set(e,new Map([[le(Ht,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(eo,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(eo,this).get(e).forEach(r=>r.destroy()),le(eo,this).delete(e)}render(e){if(le(tr,this)===null)return;e&&zp(pR,this,FV).call(this);const r=Array.from(le(tr,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(dg,this).has(s)||(le(dg,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&le(hg,this).setActiveSelection(s).scan().forEach(p=>{if(n.has(p)){const v=n.get(p);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();le(Ht,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(xa,this).get(le(Ht,this)).add(u)),Z(s,l),s.nodeName==="TD"&&Array.isArray((a=le(tr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Te(s,le(tr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Te(o,[...i.get(o)])})}}function FV(){const t=le(xa,this).get(le(Ht,this)),e=le(Ht,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(Ht,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(tr,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(tr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(tr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(tr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Oe(o[a],r),pl(o[a],s)}),t.clear()}class VV extends Sl{constructor(e,r,n,i){super(e,r,Po,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new $p(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Hp(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Pc(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,s0(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ar(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=jp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=Ut(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,JN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(a0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?Oe(n,"emptyRows"):Z(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Z(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(n,"innerBorderInlineStart");e?(Z(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Oe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const WV="stickyRowsTop",Up={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pi(Up,"MIXIN_NAME",WV,{writable:!1,enumerable:!1});class Yp extends Ys{constructor(e,r,n,i){super(e,r,n,i,Ho)}}Qe(Yp,Up);Qe(Yp,xc);function wR(t,e,r){return(e=$V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $V(t){var e=BV(t,"string");return typeof e=="symbol"?e:e+""}function BV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jV extends Sl{constructor(e,r,n,i,o,s){super(e,r,Ho,n,i),wR(this,"topOverlay",void 0),wR(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Yp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Hp(e,`${i}px`,`${o}px`)}else Pc(e);let r=cr(this.clone.wtTable.TABLE);const n=ar(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class qp extends Ys{constructor(e,r,n,i){super(e,r,n,i,Io)}}Qe(qp,Up);Qe(qp,Ac);function zV(t,e,r){return(e=UV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UV(t){var e=YV(t,"string");return typeof e=="symbol"?e:e+""}function YV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qV extends Sl{constructor(e,r,n,i){super(e,r,Io,n,i),zV(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new qp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Hp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Pc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Ip(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=cr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=jp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=Ut(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,ZN(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Pp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?Oe(i,"emptyColumns"):Z(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Z(i,"innerBorderTop"),a=!h):(Oe(i,"innerBorderTop"),a=h)}}return a}}function Ll(t,e,r){GV(t,e),e.set(t,r)}function GV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(t,e,r){return(e=KV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KV(t){var e=XV(t,"string");return typeof e=="symbol"?e:e+""}function XV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function to(t,e,r){return t.set(V0(t,e),r),r}function Gn(t,e){return t.get(V0(t,e))}function V0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var es=new WeakMap,Fl=new WeakMap,ts=new WeakMap,Vl=new WeakMap;class ZV{constructor(e,r,n,i,o,s){qn(this,"wot",null),Ll(this,es,[]),qn(this,"topOverlay",null),qn(this,"bottomOverlay",null),qn(this,"inlineStartOverlay",null),qn(this,"topInlineStartCornerOverlay",null),qn(this,"bottomInlineStartCornerOverlay",null),qn(this,"browserLineHeight",void 0),qn(this,"wtSettings",null),Ll(this,Fl,!1),Ll(this,ts,0),Ll(this,Vl,null),qn(this,"resizeObserver",new ResizeObserver(c=>{um(()=>{!Array.isArray(c)||!c.length||(to(ts,this,Gn(ts,this)+1),Gn(ts,this)===300&&(hr("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Gn(Vl,this)!==null&&clearTimeout(Gn(Vl,this)),to(Vl,this,setTimeout(()=>{to(ts,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Ut(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Uu(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Gn(es,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new qV(...e),this.bottomOverlay=new CV(...e),this.inlineStartOverlay=new VV(...e),this.topInlineStartCornerOverlay=new jV(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new wV(...e,this.bottomOverlay,this.inlineStartOverlay),to(es,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){to(Fl,this,Gn(es,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Gn(es,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Gn(es,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!$N())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{um(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{to(ts,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=uk(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Gn(Fl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),to(Fl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Uu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),g=r.hider.style,p=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),b=p()?1:0,E=v()?1:0;g.width=`${h+E}px`,g.height=`${c+b}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return j(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];j(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function vR(t,e,r){return(e=JV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JV(t){var e=QV(t,"string");return typeof e=="symbol"?e:e+""}function QV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eW{constructor(e){vR(this,"settings",{}),vR(this,"defaults",Object.freeze(this.getDefaults())),Me(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);wl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Me(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Gp extends Ys{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Yu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=uC(e,"height",r),o=uC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=As(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Qe(Gp,Wp);Qe(Gp,Ac);class tW{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new PL:new kL],["fullyVisible",()=>new bL],["partiallyVisible",()=>new _0]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new OL:new AL],["fullyVisible",()=>new wL],["partiallyVisible",()=>new T0]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=cr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?Ut():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Wr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=cr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=ar(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=Ut(this.domBindings.rootDocument),new zL({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=Ut(this.domBindings.rootDocument)),new $L({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible"),s=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:o,endRow:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;n=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:o,endColumn:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;n=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){Me(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class rW extends Fp{constructor(e,r){super(e,new eW(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Gp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new tW(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new LV(this.wtSettings.getSetting("selections")),this.wtEvent=new H0(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new ZV(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Me(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),Oe(this.wtTable.wtRootElement.parentNode,r),Z(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!D0.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Kp{constructor(e){e instanceof Fp?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Kp(r);return()=>n},this._wot=new rW(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function yR(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function nW(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function bR(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const iW=new Map([["touchstart",yR],["touchend",bR],["mousedown",yR],["mouseover",nW],["mouseup",bR]]);function fg(t,e){iW.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:g0(t)||t.type==="touchstart",isRightClick:qu(t),...e})}const W0=new WeakMap,Xp=Symbol("rootInstance");function oW(t){W0.set(t,!0)}function sW(t){return t===Xp}function _n(t){return W0.has(t)}function aW(t,e){$0(t,e),e.add(t)}function yi(t,e,r){$0(t,e),e.set(t,r)}function $0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bi(t,e,r){return(e=lW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lW(t){var e=uW(t,"string");return typeof e=="symbol"?e:e+""}function uW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nt(t,e){return t.get(Ms(t,e))}function Xt(t,e,r){return t.set(Ms(t,e),r),r}function Ms(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gg=new WeakMap,Wl=new WeakMap,$l=new WeakMap,Kn=new WeakMap,en=new WeakMap,mg=new WeakMap,pg=new WeakMap,rs=new WeakMap,Aa=new WeakSet;class cW{constructor(e){aW(this,Aa),bi(this,"hot",void 0),bi(this,"eventManager",void 0),bi(this,"settings",void 0),bi(this,"THEAD",void 0),bi(this,"TBODY",void 0),bi(this,"_wt",void 0),bi(this,"activeWt",void 0),yi(this,gg,0),yi(this,Wl,0),bi(this,"postponedAdjustElementsSize",!1),yi(this,$l,!1),yi(this,Kn,void 0),yi(this,en,void 0),yi(this,mg,0),yi(this,pg,0),yi(this,rs,null),this.hot=e,this.eventManager=new Bi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Ms(Aa,this,dW).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Z(e,"handsontable"),Xt(en,this,r.createElement("TABLE")),Z(nt(en,this),"htCore"),this.hot.getSettings().tableClassName&&Z(nt(en,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Te(nt(en,this),[Pi()]),Te(e,[bN(),K_(-1),Ic(this.hot.countCols()),xN()])),this.THEAD=r.createElement("THEAD"),nt(en,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),nt(en,this).appendChild(this.TBODY),this.hot.table=nt(en,this),this.hot.container.insertBefore(nt(en,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:o}=this.hot,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Xt($l,this,!0),this.isTextSelectionAllowed(l.target)||(cC(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Xt($l,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{nt($l,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&cC(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{i.isInProgress()&&g0(l)&&i.finish(),Xt(Kn,this,!1);const u=c0(n.activeElement);Mu(n.activeElement)&&!u||(u||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!qu(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&qu(l)&&(i.finish(),Xt(Kn,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Xt(Kn,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(nt(Kn,this)||!r||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(d===g){const v=Ut(n);if(n.elementFromPoint(c+v,h)!==g||n.elementFromPoint(c,h+v)!==g)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===r)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Oo(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Oo(a);this.eventManager.addEventListener(nt(en,this),"selectstart",l=>{this.settings.fragmentSelection||Mu(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Z(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Oe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:nt(en,this),isDataViewInstance:()=>_n(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Xt(Wl,this,o.length),this.hot.getSettings().ariaTags&&Ms(Aa,this,B0).call(this)===this.hot.countCols()&&Ms(Aa,this,hW).call(this,nt(Wl,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Xt(gg,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,v,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,v,g),this.hot.runHooks("afterRenderer",a,l,u,p,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&As(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Xt(Kn,this,!0),Xt(rs,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!co(o)&&(fg(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Xt(Kn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!co(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!co(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!co(o)&&(nt(Kn,this)&&(!nt(rs,this)||nt(rs,this).x!==o.clientX||nt(rs,this).y!==o.clientY)&&fg(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Xt(rs,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(co(o)||this.hot.isDestroyed)&&(fg(o,{coords:u,selection:this.hot.selection,cellRangeMapper:Tk(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[p,v,b,E]=g;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Kp(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(Mu(e))return!0;const i=_s(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return nt(Kn,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!ve(n,"relative")){xs(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",Z(s,["relative",...o()])):(xs(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Te(a,...Pi()),Te(l,...Pi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?o0(e,n(r,i)):(wl(e,"Â "),Z(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Xt(mg,this,e),Xt(pg,this,r)}getLastSize(){return{width:nt(mg,this),height:nt(pg,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return nt(gg,this)}getRowHeadersCount(){return nt(Wl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function B0(){return parseInt(this.hot.rootElement.getAttribute(Ic()[0]),10)}function hW(t){const e=Ms(Aa,this,B0).call(this)+t;Te(this.hot.rootElement,...Ic(e))}function dW(){const t=this.hot.rootElement;this.hasVerticalScroll()?Z(t,"htHasScrollY"):Oe(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?Z(t,"htVerticallyScrollableByWindow"):Oe(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?Z(t,"htHasScrollX"):Oe(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?Z(t,"htHorizontallyScrollableByWindow"):Oe(t,"htHorizontallyScrollableByWindow")}var SR={},CR={},RR;function fW(){if(RR)return CR;RR=1;var t=Fe(),e=vt(),r=Bs(),n=_r(),i=yt(),o=Yi(),s=Or(),a=Vo(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,p){if(!c(g,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),CR}var ER;function gW(){return ER||(ER=1,fW()),SR}gW();const mW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",TR=mW.length;function pW(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%TR,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/TR,10);return r}function j0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&st(t[0])&&(e=_p(t[0]))),e}function ga(t,e,r){return(e=wW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wW(t){var e=vW(t,"string");return typeof e=="symbol"?e:e+""}function vW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yW{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];ga(this,"hot",void 0),ga(this,"data",void 0),ga(this,"dataType","array"),ga(this,"colToProp",()=>{}),ga(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return j(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Xe(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(st(a)||Ee(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Xe(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?Wf(l,d,g):l[d]=g}})}else Me(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Wf(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Cr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Wf(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?lm(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=Cr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Xe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return j0(this.data)}destroy(){this.data=null,this.hot=null}}var _R={},OR={},MR;function bW(){if(MR)return OR;MR=1;var t=Fe(),e=vt(),r=Bs(),n=_r(),i=yt(),o=Yi(),s=Or(),a=Vo(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,p){if(c(g,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),OR}var IR;function SW(){return IR||(IR=1,bW()),_R}SW();function PR(t,e,r){return(e=CW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CW(t){var e=RW(t,"string");return typeof e=="symbol"?e:e+""}function RW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;PR(this,"indexedValues",[]),PR(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ee(this.initValueOrFn)?Xe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Xe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Qe(Cl,Fn);function z0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Ee(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function U0(t,e){return Rp(t,(r,n)=>e.includes(n)===!1)}class Dc extends Cl{insert(e,r){this.indexedValues=z0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=U0(this.indexedValues,e),super.remove(e)}}class Y0 extends Dc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return $o(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function q0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Xu(t,e){return Rp(t,r=>e.includes(r)===!1)}function G0(t,e){return Dn(t,r=>r-e.filter(n=>n<r).length)}function K0(t,e){const r=e[0],n=e.length;return Dn(t,i=>i>=r?i+n:i)}function EW(t,e,r){return(e=TW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TW(t){var e=_W(t,"string");return typeof e=="symbol"?e:e+""}function _W(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OW extends Cl{constructor(){super(...arguments),EW(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Xu(this.orderOfIndexes,[e]),Ee(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=z0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=K0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=U0(this.indexedValues,e),this.orderOfIndexes=Xu(this.orderOfIndexes,e),this.orderOfIndexes=G0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class X0 extends Dc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return $o(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class MW extends Cl{constructor(){super(e=>e)}insert(e,r){const n=K0(this.indexedValues,r);this.indexedValues=q0(n,e,r),super.insert(e,r)}remove(e){const r=Xu(this.indexedValues,e);this.indexedValues=G0(r,e),super.remove(e)}}const HR=new Map([["hiding",Y0],["index",Cl],["linkedPhysicalIndexToValue",OW],["physicalIndexToValue",Dc],["trimming",X0]]);function IW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!HR.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(HR.get(t))(e)}function PW(t,e,r){return(e=HW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HW(t){var e=xW(t,"string");return typeof e=="symbol"?e:e+""}function xW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zp{constructor(){PW(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);ue(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return jt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Qe(Zp,Fn);function wg(t,e,r){return(e=AW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AW(t){var e=DW(t,"string");return typeof e=="symbol"?e:e+""}function DW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xR extends Zp{constructor(e,r){super(),wg(this,"mergedValuesCache",[]),wg(this,"aggregationFunction",void 0),wg(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=Dn(this.get(),o=>o.getValues()),n=[],i=ue(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return Dn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return ue(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function NW(t,e,r){kW(t,e),e.set(t,r)}function kW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LW(t,e,r){return t.set(Z0(t,e),r),r}function FW(t,e){return t.get(Z0(t,e))}function Z0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var vg=new WeakMap;class J0{constructor(){NW(this,vg,[])}subscribe(e){return this.addLocalHook("change",e),this._write(FW(vg,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){LW(vg,this,e)}}Qe(J0,Fn);function AR(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ma(t,e,r){VW(t,e),e.set(t,r)}function VW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(t,e){return t.get(Q0(t,e))}function Bl(t,e,r){return t.set(Q0(t,e),r),r}function Q0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jl=new WeakMap,pa=new WeakMap,zl=new WeakMap,Ul=new WeakMap,Yl=new WeakMap;class WW{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ma(this,jl,new Set),ma(this,pa,[]),ma(this,zl,[]),ma(this,Ul,!1),ma(this,Yl,!1),Bl(Yl,this,e??!1)}createObserver(){const e=new J0;return kr(jl,this).add(e),e.addLocalHook("unsubscribe",()=>{kr(jl,this).delete(e)}),e._writeInitialChanges(AR(kr(pa,this),kr(zl,this))),e}emit(e){let r=kr(zl,this);(!kr(Ul,this)||kr(pa,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(kr(Yl,this)):Bl(pa,this,new Array(e.length).fill(kr(Yl,this))),kr(Ul,this)||(Bl(Ul,this,!0),r=kr(pa,this)));const n=AR(r,e);kr(jl,this).forEach(i=>i._write(n)),Bl(zl,this,e)}}function Vt(t,e,r){return(e=$W(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $W(t){var e=BW(t,"string");return typeof e=="symbol"?e:e+""}function BW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pm{constructor(){Vt(this,"indexesSequence",new MW),Vt(this,"trimmingMapsCollection",new xR(e=>e.some(r=>r===!0),!1)),Vt(this,"hidingMapsCollection",new xR(e=>e.some(r=>r===!0),!1)),Vt(this,"variousMapsCollection",new Zp),Vt(this,"hidingChangesObservable",new WW({initialIndexValue:!1})),Vt(this,"notTrimmedIndexesCache",[]),Vt(this,"notHiddenIndexesCache",[]),Vt(this,"isBatched",!1),Vt(this,"indexesSequenceChanged",!1),Vt(this,"indexesChangeSource",void 0),Vt(this,"trimmedIndexesChanged",!1),Vt(this,"hiddenIndexesChanged",!1),Vt(this,"renderablePhysicalIndexesCache",[]),Vt(this,"fromPhysicalToVisualIndexesCache",new Map),Vt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,IW(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof X0?this.trimmingMapsCollection.register(e,r):r instanceof Y0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return ue(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return ue(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return ue(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return ue(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=Dn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Xu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(q0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=ue(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Dn(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Qe(pm,Fn);function jW(t,e){return Me(e,(r,n)=>{jt(t[n])&&(t[n]=r)}),t}function eO(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function tO(t){ue(t)&&hk(ur`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function zW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function rO(t,e){return Array.isArray(t)?t.map(r=>rO(r,e)):U_(t,e)}const{register:UW,getValues:YW}=jo("phraseFormatters");function nO(t,e){UW(t,e)}function qW(){return YW()}nO("pluralize",zW);nO("substitute",rO);const Jp="Common:",iO=`${Jp}ok`,oO=`${Jp}cancel`,sO="ContextMenu:items",re=sO,Qp=`${re}.noItems`,ew=`${re}.insertRowAbove`,tw=`${re}.insertRowBelow`,rw=`${re}.insertColumnOnTheLeft`,nw=`${re}.insertColumnOnTheRight`,iw=`${re}.removeRow`,ow=`${re}.removeColumn`,sw=`${re}.undo`,aw=`${re}.redo`,Zu=`${re}.readOnly`,lw=`${re}.clearColumn`,uw=`${re}.copy`,cw=`${re}.copyWithHeaders`,hw=`${re}.copyWithGroupHeaders`,dw=`${re}.copyHeadersOnly`,fw=`${re}.cut`,aO=`${re}.freezeColumn`,lO=`${re}.unfreezeColumn`,uO=`${re}.mergeCells`,cO=`${re}.unmergeCells`,hO=`${re}.addComment`,dO=`${re}.editComment`,fO=`${re}.removeComment`,gO=`${re}.readOnlyComment`,gw=`${re}.align`,mw=`${re}.align.left`,pw=`${re}.align.center`,ww=`${re}.align.right`,vw=`${re}.align.justify`,yw=`${re}.align.top`,bw=`${re}.align.middle`,Sw=`${re}.align.bottom`,mO=`${re}.borders`,pO=`${re}.borders.top`,wO=`${re}.borders.right`,vO=`${re}.borders.bottom`,yO=`${re}.borders.left`,bO=`${re}.borders.remove`,SO=`${re}.nestedHeaders.insertChildRow`,CO=`${re}.nestedHeaders.detachFromParent`,RO=`${re}.hideColumn`,EO=`${re}.showColumn`,TO=`${re}.hideRow`,_O=`${re}.showRow`,fr="Filters:",et=`${fr}conditions`,OO=`${et}.none`,MO=`${et}.isEmpty`,IO=`${et}.isNotEmpty`,PO=`${et}.isEqualTo`,HO=`${et}.isNotEqualTo`,xO=`${et}.beginsWith`,AO=`${et}.endsWith`,DO=`${et}.contains`,NO=`${et}.doesNotContain`,GW=`${et}.byValue`,kO=`${et}.greaterThan`,LO=`${et}.greaterThanOrEqualTo`,FO=`${et}.lessThan`,VO=`${et}.lessThanOrEqualTo`,WO=`${et}.isBetween`,$O=`${et}.isNotBetween`,BO=`${et}.after`,jO=`${et}.before`,zO=`${et}.today`,UO=`${et}.tomorrow`,YO=`${et}.yesterday`,qO=`${fr}labels.filterByCondition`,GO=`${fr}labels.filterByValue`,KO=`${fr}labels.conjunction`,XO=`${fr}labels.disjunction`,ZO=`${fr}values.blankCells`,JO=`${fr}buttons.selectAll`,QO=`${fr}buttons.clear`,eM=`${fr}buttons.ok`,tM=`${fr}buttons.cancel`,rM=`${fr}buttons.placeholder.search`,nM=`${fr}buttons.placeholder.value`,iM=`${fr}buttons.placeholder.secondValue`,Vn="Pagination:",oM=`${Vn}section.pagination`,sM=`${Vn}.pageSize.auto`,aM=`${Vn}section.pageSize`,lM=`${Vn}section.counter`,uM=`${Vn}section.navigation`,cM=`${Vn}firstPage`,hM=`${Vn}prevPage`,dM=`${Vn}nextPage`,fM=`${Vn}lastPage`,Cw="CheckboxRenderer:",gM=`${Cw}checked`,mM=`${Cw}unchecked`,pM="Loading:",wM=`${pM}title`,qs="EmptyDataState:",vM=`${qs}title`,yM=`${qs}description`,bM=`${qs}title.filters`,SM=`${qs}description.filters`,CM=`${qs}buttons.filters.reset`,KW=Object.freeze(Object.defineProperty({__proto__:null,CANCEL:oO,CHECKBOX_CHECKED:gM,CHECKBOX_RENDERER_NAMESPACE:Cw,CHECKBOX_UNCHECKED:mM,COMMON_NAMESPACE:Jp,CONTEXTMENU_ITEMS_ADD_COMMENT:hO,CONTEXTMENU_ITEMS_ALIGNMENT:gw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Sw,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:pw,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:vw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:mw,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:bw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ww,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:yw,CONTEXTMENU_ITEMS_BORDERS:mO,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:vO,CONTEXTMENU_ITEMS_BORDERS_LEFT:yO,CONTEXTMENU_ITEMS_BORDERS_RIGHT:wO,CONTEXTMENU_ITEMS_BORDERS_TOP:pO,CONTEXTMENU_ITEMS_CLEAR_COLUMN:lw,CONTEXTMENU_ITEMS_COPY:uw,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:dw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:hw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:cw,CONTEXTMENU_ITEMS_CUT:fw,CONTEXTMENU_ITEMS_EDIT_COMMENT:dO,CONTEXTMENU_ITEMS_FREEZE_COLUMN:aO,CONTEXTMENU_ITEMS_HIDE_COLUMN:RO,CONTEXTMENU_ITEMS_HIDE_ROW:TO,CONTEXTMENU_ITEMS_INSERT_LEFT:rw,CONTEXTMENU_ITEMS_INSERT_RIGHT:nw,CONTEXTMENU_ITEMS_MERGE_CELLS:uO,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:CO,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:SO,CONTEXTMENU_ITEMS_NO_ITEMS:Qp,CONTEXTMENU_ITEMS_READ_ONLY:Zu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:gO,CONTEXTMENU_ITEMS_REDO:aw,CONTEXTMENU_ITEMS_REMOVE_BORDERS:bO,CONTEXTMENU_ITEMS_REMOVE_COLUMN:ow,CONTEXTMENU_ITEMS_REMOVE_COMMENT:fO,CONTEXTMENU_ITEMS_REMOVE_ROW:iw,CONTEXTMENU_ITEMS_ROW_ABOVE:ew,CONTEXTMENU_ITEMS_ROW_BELOW:tw,CONTEXTMENU_ITEMS_SHOW_COLUMN:EO,CONTEXTMENU_ITEMS_SHOW_ROW:_O,CONTEXTMENU_ITEMS_UNDO:sw,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:lO,CONTEXTMENU_ITEMS_UNMERGE_CELLS:cO,CONTEXT_MENU_ITEMS_NAMESPACE:sO,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:CM,EMPTY_DATA_STATE_DESCRIPTION:yM,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:SM,EMPTY_DATA_STATE_NAMESPACE:qs,EMPTY_DATA_STATE_TITLE:vM,EMPTY_DATA_STATE_TITLE_FILTERS:bM,FILTERS_BUTTONS_CANCEL:tM,FILTERS_BUTTONS_CLEAR:QO,FILTERS_BUTTONS_OK:eM,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:rM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:iM,FILTERS_BUTTONS_PLACEHOLDER_VALUE:nM,FILTERS_BUTTONS_SELECT_ALL:JO,FILTERS_CONDITIONS_AFTER:BO,FILTERS_CONDITIONS_BEFORE:jO,FILTERS_CONDITIONS_BEGINS_WITH:xO,FILTERS_CONDITIONS_BETWEEN:WO,FILTERS_CONDITIONS_BY_VALUE:GW,FILTERS_CONDITIONS_CONTAINS:DO,FILTERS_CONDITIONS_EMPTY:MO,FILTERS_CONDITIONS_ENDS_WITH:AO,FILTERS_CONDITIONS_EQUAL:PO,FILTERS_CONDITIONS_GREATER_THAN:kO,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:LO,FILTERS_CONDITIONS_LESS_THAN:FO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:VO,FILTERS_CONDITIONS_NAMESPACE:et,FILTERS_CONDITIONS_NONE:OO,FILTERS_CONDITIONS_NOT_BETWEEN:$O,FILTERS_CONDITIONS_NOT_CONTAIN:NO,FILTERS_CONDITIONS_NOT_EMPTY:IO,FILTERS_CONDITIONS_NOT_EQUAL:HO,FILTERS_CONDITIONS_TODAY:zO,FILTERS_CONDITIONS_TOMORROW:UO,FILTERS_CONDITIONS_YESTERDAY:YO,FILTERS_DIVS_FILTER_BY_CONDITION:qO,FILTERS_DIVS_FILTER_BY_VALUE:GO,FILTERS_LABELS_CONJUNCTION:KO,FILTERS_LABELS_DISJUNCTION:XO,FILTERS_NAMESPACE:fr,FILTERS_VALUES_BLANK_CELLS:ZO,LOADING_NAMESPACE:pM,LOADING_TITLE:wM,OK:iO,PAGINATION_COUNTER_SECTION:lM,PAGINATION_FIRST_PAGE:cM,PAGINATION_LAST_PAGE:fM,PAGINATION_NAMESPACE:Vn,PAGINATION_NAV_SECTION:uM,PAGINATION_NEXT_PAGE:dM,PAGINATION_PAGE_SIZE_AUTO:sM,PAGINATION_PAGE_SIZE_SECTION:aM,PAGINATION_PREV_PAGE:hM,PAGINATION_SECTION:oM},Symbol.toStringTag,{value:"Module"}));const RM={languageCode:"en-US",[iO]:"OK",[oO]:"Cancel",[Qp]:"No available options",[ew]:"Insert row above",[tw]:"Insert row below",[rw]:"Insert column left",[nw]:"Insert column right",[iw]:["Remove row","Remove rows"],[ow]:["Remove column","Remove columns"],[sw]:"Undo",[aw]:"Redo",[Zu]:"Read only",[lw]:"Clear column",[gw]:"Alignment",[mw]:"Left",[pw]:"Center",[ww]:"Right",[vw]:"Justify",[yw]:"Top",[bw]:"Middle",[Sw]:"Bottom",[aO]:"Freeze column",[lO]:"Unfreeze column",[mO]:"Borders",[pO]:"Top",[wO]:"Right",[vO]:"Bottom",[yO]:"Left",[bO]:"Remove border(s)",[hO]:"Add comment",[dO]:"Edit comment",[fO]:"Delete comment",[gO]:"Read-only comment",[uO]:"Merge cells",[cO]:"Unmerge cells",[uw]:"Copy",[cw]:["Copy with header","Copy with headers"],[hw]:["Copy with group header","Copy with group headers"],[dw]:["Copy header only","Copy headers only"],[fw]:"Cut",[SO]:"Insert child row",[CO]:"Detach from parent",[RO]:["Hide column","Hide columns"],[EO]:["Show column","Show columns"],[TO]:["Hide row","Hide rows"],[_O]:["Show row","Show rows"],[OO]:"None",[MO]:"Is empty",[IO]:"Is not empty",[PO]:"Is equal to",[HO]:"Is not equal to",[xO]:"Begins with",[AO]:"Ends with",[DO]:"Contains",[NO]:"Does not contain",[kO]:"Greater than",[LO]:"Greater than or equal to",[FO]:"Less than",[VO]:"Less than or equal to",[WO]:"Is between",[$O]:"Is not between",[BO]:"After",[jO]:"Before",[zO]:"Today",[UO]:"Tomorrow",[YO]:"Yesterday",[ZO]:"Blank cells",[qO]:"Filter by condition",[GO]:"Filter by value",[KO]:"And",[XO]:"Or",[JO]:"Select all",[QO]:"Clear",[eM]:"OK",[tM]:"Cancel",[rM]:"Search",[nM]:"Value",[iM]:"Second value",[oM]:"Pagination",[aM]:"Page size",[sM]:"Auto",[lM]:"[start] - [end] of [total]",[uM]:"Page [currentPage] of [totalPages]",[cM]:"Go to first page",[hM]:"Go to previous page",[dM]:"Go to next page",[fM]:"Go to last page",[gM]:"Checked",[mM]:"Unchecked",[wM]:"Loading...",[vM]:"No data available",[yM]:"Thereâs nothing to display yet.",[bM]:"No results found",[SM]:"It looks like your current filters are hiding all results.",[CM]:"Reset filters"},XW=KW,wm=RM.languageCode,{register:ZW,getItem:EM,hasItem:JW,getValues:QW}=jo("languagesDictionaries");TM(RM);function TM(t,e){let r=t,n=e;return st(t)&&(n=t,r=n.languageCode),e$(r,n),ZW(r,Tr(n)),Tr(n)}function e$(t,e){t!==wm&&jW(e,EM(wm))}function _M(t){return Rw(t)?Tr(EM(t)):null}function Rw(t){return JW(t)}function t$(){return QW()}function OM(t,e,r){const n=_M(t);if(n===null)return null;const i=n[e];if(jt(i))return null;const o=r$(i,r);return Array.isArray(o)?o[0]:o}function r$(t,e){return qW().reduce((r,n)=>n(r,e),t)}function n$(t){let e=eO(t);return Rw(e)||(e=wm,tO(t)),e}function i$(t,e,r){return(e=o$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o$(t){var e=s$(t,"string");return typeof e=="symbol"?e:e+""}function s$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wi extends N0{constructor(e,r){super(e,null),i$(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function yg(t){let{activeHeaderClassName:e,...r}=t;return new wi({className:e,...r,selectionType:TV})}function a$(t){let{areaCornerVisible:e,...r}=t;return new wi({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:Bp})}function l$(t){let{...e}=t;return new wi({className:"highlight",...e,selectionType:Bp})}function u$(t){let{columnClassName:e,...r}=t;return new wi({className:e,...r,selectionType:MV})}function c$(t){let{cellCornerVisible:e,...r}=t;return new wi({className:"current",headerAttributes:[Z_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Ku})}function h$(t){let{border:e,visualCellRange:r,...n}=t;return new wi({...e,...n,selectionType:IV},r)}function d$(t){let{...e}=t;return new wi({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:_V})}function DR(t){let{headerClassName:e,...r}=t;return new wi({className:e,...r,selectionType:k0})}function f$(t){let{rowClassName:e,...r}=t;return new wi({className:e,...r,selectionType:OV})}function g$(t,e){m$(t,e),e.add(t)}function m$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e,r){return(e=p$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p$(t){var e=w$(t,"string");return typeof e=="symbol"?e:e+""}function w$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Rn=new WeakSet;class v${constructor(e){g$(this,Rn),Zt(this,"options",void 0),Zt(this,"layerLevel",0),Zt(this,"focus",void 0),Zt(this,"fill",void 0),Zt(this,"layeredAreas",new Map),Zt(this,"areas",new Map),Zt(this,"rowHeaders",new Map),Zt(this,"columnHeaders",new Map),Zt(this,"activeRowHeaders",new Map),Zt(this,"activeColumnHeaders",new Map),Zt(this,"activeCornerHeaders",new Map),Zt(this,"rowHighlights",new Map),Zt(this,"columnHighlights",new Map),Zt(this,"customSelections",[]),this.options=e,this.focus=c$(e),this.fill=d$(e)}isEnabledFor(e,r){let n=e;e===Ku&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Xn(Rn,this,Zn).call(this,this.layeredAreas,a$)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Xn(Rn,this,Zn).call(this,this.areas,l$)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Xn(Rn,this,Zn).call(this,this.rowHeaders,DR)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Xn(Rn,this,Zn).call(this,this.columnHeaders,DR)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Xn(Rn,this,Zn).call(this,this.activeRowHeaders,yg)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Xn(Rn,this,Zn).call(this,this.activeColumnHeaders,yg)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Xn(Rn,this,Zn).call(this,this.activeCornerHeaders,yg)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Xn(Rn,this,Zn).call(this,this.rowHighlights,f$)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Xn(Rn,this,Zn).call(this,this.columnHighlights,u$)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(h$({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),j(this.areas.values(),e=>{e.clear()}),j(this.layeredAreas.values(),e=>{e.clear()}),j(this.rowHeaders.values(),e=>{e.clear()}),j(this.columnHeaders.values(),e=>{e.clear()}),j(this.activeRowHeaders.values(),e=>{e.clear()}),j(this.activeColumnHeaders.values(),e=>{e.clear()}),j(this.activeCornerHeaders.values(),e=>{e.clear()}),j(this.rowHighlights.values(),e=>{e.clear()}),j(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Zn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function NR(t,e,r){return(e=y$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y$(t){var e=b$(t,"string");return typeof e=="symbol"?e:e+""}function b$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ew{constructor(e){NR(this,"ranges",[]),NR(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new Ew(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function S$(t,e){MM(t,e),e.add(t)}function C$(t,e,r){return(e=R$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R$(t){var e=E$(t,"string");return typeof e=="symbol"?e:e+""}function E$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bg(t,e,r){MM(t,e),e.set(t,r)}function MM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(Re(t,e))}function bs(t,e,r){return t.set(Re(t,e),r),r}function Re(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ni=new WeakMap,fo=new WeakMap,Rr=new WeakMap,_e=new WeakSet;class Tw{constructor(e,r){S$(this,_e),bg(this,ni,void 0),bg(this,fo,0),bg(this,Rr,{x:0,y:0}),C$(this,"tableApi",void 0),bs(ni,this,e),this.tableApi=r}setActiveLayerIndex(e){bs(fo,this,e)}getCurrentSelection(){return ht(ni,this).peekByIndex(ht(fo,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;bs(Rr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=Re(_e,this,vm).call(this);const{row:h,col:d}=Re(_e,this,VR).call(this,o),g=this.tableApi.fixedRowsBottom(),p=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),b=this.tableApi.autoWrapRow(),E=this.tableApi.autoWrapCol(),S=this.tableApi.createCellCoords(h+i.row,d+i.col);if(S.row>=c){const M=Cr(n&&p>0&&g===0),H=S.col+1,P=H>=u,A=this.tableApi.createCellCoords(S.row-c,P?H-u:H);if(this.runLocalHooks("beforeColumnWrap",M,Re(_e,this,ns).call(this,A),P),M.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(E){if(this.shouldSwitchSelectionLayer()&&P&&ht(ni,this).size()>1){Re(_e,this,kR).call(this);const F=Re(_e,this,ql).call(this,"forward");F!==null&&A.assign(F)}S.assign(A)}}else if(S.row<0){const M=Cr(E),H=S.col-1,P=H<0,A=this.tableApi.createCellCoords(c+S.row,P?u+H:H);if(this.runLocalHooks("beforeColumnWrap",M,Re(_e,this,ns).call(this,A),P),E){if(this.shouldSwitchSelectionLayer()&&P&&ht(ni,this).size()>1){Re(_e,this,LR).call(this);const F=Re(_e,this,ql).call(this,"backward");F!==null&&A.assign(F)}S.assign(A)}}if({width:u,height:c}=Re(_e,this,vm).call(this),S.col>=u){const M=Cr(n&&v>0),H=S.row+1,P=H>=c,A=this.tableApi.createCellCoords(P?H-c:H,S.col-u);if(this.runLocalHooks("beforeRowWrap",M,Re(_e,this,ns).call(this,A),P),M.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(b){if(this.shouldSwitchSelectionLayer()&&P&&ht(ni,this).size()>1){Re(_e,this,kR).call(this);const F=Re(_e,this,ql).call(this,"forward");F!==null&&A.assign(F)}S.assign(A)}}else if(S.col<0){const M=Cr(b),H=S.row-1,P=H<0,A=this.tableApi.createCellCoords(P?c+H:H,u+S.col);if(this.runLocalHooks("beforeRowWrap",M,Re(_e,this,ns).call(this,A),P),b){if(this.shouldSwitchSelectionLayer()&&P&&ht(ni,this).size()>1){Re(_e,this,LR).call(this);const F=Re(_e,this,ql).call(this,"backward");F!==null&&A.assign(F)}S.assign(A)}}const{rowDir:T,colDir:y}=Re(_e,this,FR).call(this,S);a=T,l=y,o=Re(_e,this,ns).call(this,S)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:ht(fo,this),visualCoords:o}}transformEnd(e,r){bs(Rr,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=Re(_e,this,Iu).call(this,i.to.row,i.from.row),a=Re(_e,this,Pu).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Re(_e,this,VR).call(this,i.highlight),g=this.tableApi.createCellCoords(s+n.row,a+n.col),p=i.getTopStartCorner(),v=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const y=g.col-d;g.col=Re(_e,this,Pu).call(this,p.col,v.col)+y}else if(n.col>0&&a<=d&&g.col>d){const y=Re(_e,this,Pu).call(this,v.col,p.col),M=Math.max(g.col-y,1);g.col=y+M}if(n.row<0&&s>=h&&g.row<h){const y=g.row-h;g.row=Re(_e,this,Iu).call(this,p.row,b.row)+y}else if(n.row>0&&s<=h&&g.row>h){const y=Re(_e,this,Iu).call(this,b.row,p.row),M=Math.max(g.row-y,1);g.row=y+M}const{rowDir:E,colDir:S}=Re(_e,this,FR).call(this,g);u=E,c=S;const T=Re(_e,this,ns).call(this,g);n.row===0&&n.col!==0?l.col=T.col:n.row!==0&&n.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:ht(fo,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function kR(){const t=ht(fo,this)+1;this.setActiveLayerIndex(t>=ht(ni,this).size()?0:t),bs(Rr,this,this.calculateOffset())}function LR(){const t=ht(fo,this)-1;this.setActiveLayerIndex(t<0?ht(ni,this).size()-1:t),bs(Rr,this,this.calculateOffset())}function FR(t){const{width:e,height:r}=Re(_e,this,vm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function vm(){return{width:ht(Rr,this).x+this.countRenderableColumns(),height:ht(Rr,this).y+this.countRenderableRows()}}function ql(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,o,s]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=Re(_e,this,Iu).call(this,n,i),l=Re(_e,this,Pu).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Iu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:ht(Rr,this).y+r}function Pu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ht(Rr,this).x+r}function VR(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(ht(Rr,this).y+e,ht(Rr,this).x+r)}function ns(t){const e=t.clone();return e.col=t.col-ht(Rr,this).x,e.row=t.row-ht(Rr,this).y,this.tableApi.renderableToVisualCoords(e)}Qe(Tw,Fn);class T$ extends Tw{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class _$ extends Tw{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),o=this.tableApi.countRenderableRowsInRange(0,r-1),s=e.highlight.isHeader(),a=s?Math.abs(n):0,l=s?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const Nc=0,kc=1,IM=2,_w=3,O$=[_w,IM],M$=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Sg=Symbol("root"),WR=Symbol("child");function Lc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Sg;if(e!==Sg&&e!==WR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Sg;let i=Nc;if(r){const o=t[0];t.length===0?i=kc:n&&o instanceof yl?i=_w:n&&Array.isArray(o)?i=Lc(o,WR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!M$[l].includes(typeof a))&&(i=IM)}return i}function Ow(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!O$.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===_w;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),jt(u)&&(u=a),jt(c)&&(c=l),!n){const p=a,v=l,b=u,E=c;a=Math.min(p,b),l=Math.min(v,E),u=Math.max(p,b),c=Math.max(v,E)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),g=e(u,c);return r(h,d,g)}}function I$(t){const e=Lc(t.getSelected());if(e===Nc||e===kc)return[];const r=Ow(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return $o(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function P$(t){const e=Lc(t.getSelected());if(e===Nc||e===kc)return[];const r=Ow(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return $o(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function ro(t,e,r){H$(t,e),e.set(t,r)}function H$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function no(t,e,r){return(e=x$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x$(t){var e=A$(t,"string");return typeof e=="symbol"?e:e+""}function A$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ue(t,e){return t.get(PM(t,e))}function pr(t,e,r){return t.set(PM(t,e),r),r}function PM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var wr=new WeakMap,is=new WeakMap,Gl=new WeakMap,Si=new WeakMap,Kl=new WeakMap,wa=new WeakMap,Xl=new WeakMap;class HM{constructor(e,r){var n=this;no(this,"settings",void 0),no(this,"tableProps",void 0),no(this,"inProgress",!1),no(this,"selectedRange",new Ew((i,o,s)=>this.tableProps.createCellRange(i,o,s))),no(this,"highlight",void 0),ro(this,wr,void 0),ro(this,is,void 0),no(this,"selectedByRowHeader",new Set),no(this,"selectedByColumnHeader",new Set),ro(this,Gl,!1),ro(this,Si,!1),ro(this,Kl,"unknown"),ro(this,wa,-1),ro(this,Xl,0),this.settings=e,this.tableProps=r,this.highlight=new v$({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Z_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),pr(wr,this,new T$(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),pr(is,this,new _$(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Ue(wr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Ue(wr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Ue(wr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Ue(wr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Ue(wr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Ue(wr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Ue(wr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Ue(wr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Ue(is,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Ue(is,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Ue(Xl,this))}getActiveSelectionLayerIndex(){return Ue(Xl,this)}setActiveSelectionLayerIndex(e){pr(Xl,this,e)}markSource(e){pr(Kl,this,e)}markEndSource(){pr(Kl,this,"unknown")}getSelectionSource(){return Ue(Kl,this)}setExpectedLayers(e){pr(wa,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,pr(wa,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=jt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();pr(Si,this,!1),pr(Gl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&jt(r))&&(this.selectedRange.clear(),j(this.highlight.getAreas(),l=>{l.clear()}),j(this.highlight.getLayeredAreas(),l=>{l.clear()}),j(this.highlight.getRowHeaders(),l=>{l.clear()}),j(this.highlight.getColumnHeaders(),l=>{l.clear()}),j(this.highlight.getActiveRowHeaders(),l=>{l.clear()}),j(this.highlight.getActiveColumnHeaders(),l=>{l.clear()}),j(this.highlight.getActiveCornerHeaders(),l=>{l.clear()}),j(this.highlight.getRowHighlights(),l=>{l.clear()}),j(this.highlight.getColumnHighlights(),l=>{l.clear()})),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&n.col<0&&!s||o===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(n),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const l=Ue(wa,this)===-1||this.selectedRange.size()===Ue(wa,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(Bp,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const p=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(k0,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),S=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(S).commit(),d.add(b).commit(),g.add(S).commit()):(a.add(b).add(E).commit(),l.add(S).add(T).commit(),d.add(b).add(E).commit(),g.add(S).add(T).commit())}const p=!Ue(Si,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!Ue(Si,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),Ue(wr,this).setActiveLayerIndex(r),Ue(is,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Ku,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(pr(Gl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=Ue(wr,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=Ue(wr,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=Ue(is,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ne(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(Ne(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ne(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ne(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,Ne(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ne(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=Cr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&Ue(Gl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(Ne(d.row,u,o-1),Ne(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",p,v,h),this.setRangeStartOnly(p,void 0,h),pr(Si,this,g),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",p,v,h),this.finish()}selectCells(e){var r=this;const n=Lc(e);if(n===kc)return!1;if(n===Nc)throw new Error(ur`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Ow(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),j(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,p=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=Ne(n.row,u,s-1),p=Ne(n.col,Math.min(i,o),Math.max(i,o))):(g=Ne(n,u,s-1),p=i);const v=this.tableProps.createCellCoords(g,p),b=l===0?0:Ne(v.row,u,-1),E=s-1,S=this.tableProps.createCellCoords(b,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",S,T,v),this.setRangeStartOnly(S,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",S,T,v),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=Ne(n.row,Math.min(e,r),Math.max(e,r)),d=Ne(n.col,a,o-1)):(h=e,d=Ne(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),p=s===0?0:Ne(g.col,a,-1),v=o-1,b=this.tableProps.createCellCoords(e,p),E=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",b,E,g),this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",b,E,g),this.finish()}return c}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,pr(Si,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),pr(Si,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Ue(Si,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:Ne(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Ne(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ne(a.row,-1/0,c),col:Ne(a.col,-1/0,h)}),l.assign({row:Ne(l.row,-1/0,c),col:Ne(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(Ku,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Qe(HM,Fn);const $R=/^(\r\n|\n\r|\r|\n)/,D$=/^[^\t\r\n]+/,BR=/^\t/;function N$(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(BR))t=t.replace(BR,""),r+=1,e[n][r]="";else if(t.match($R))t=t.replace($R,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(D$);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Ju(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Cg(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:o}=e;return Ee(o)?o.call(r,t,n,i,e):t}function k$(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:o}=e;return Ee(o)?o.call(r,t,n,i,e):t}function io(t,e,r){return(e=L$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L$(t){var e=F$(t,"string");return typeof e=="symbol"?e:e+""}function F$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ss{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){io(this,"hot",void 0),io(this,"metaManager",void 0),io(this,"tableMeta",void 0),io(this,"dataSource",void 0),io(this,"duckSchema",void 0),io(this,"colToPropCache",void 0),io(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=_p(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(st(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return j0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Me(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&ue(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(ue(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Qa(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Tr(this.getSchema()):(p=[],Xe(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},J_(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let p=d;g<r&&l+g<s;p++){if(typeof c!="number"||c>=l+g)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(p,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];GS(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return dN(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];GS(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&jr(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let c=i;if(!c)return null;const h=r.split(".");for(let d=0,g=h.length;d<g;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(Os(n)&&Os(u)&&(a=k$(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=Cr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Cr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&jr(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Ss.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Ss.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return Ju(this.getRange(e,r,Ss.DESTINATION_RENDERER))}getCopyableText(e,r){return Ju(this.getRange(e,r,Ss.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:V$,getItem:W$,hasItem:xM}=jo("cellTypes");function $$(t){if(!xM(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return W$(t)}function B$(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&v0(t,r),n&&lL(t,n),i&&dL(t,i),V$(t,e)}function j$(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!jr(e,t)}function Fc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?$$(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Me(e,(o,s)=>{t._automaticallyAssignedMetaProps.delete(s)}),!st(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Me(n,(o,s)=>{if(j$(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),$i(t,i)}function z$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}kN(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Hu(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Zl(t){return t==null}const AM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),_o(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),_o(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),Q_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function jR(t,e,r){return(e=U$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U$(t){var e=Y$(t,"string");return typeof e=="symbol"?e:e+""}function Y$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q$(){return class{}}class G${constructor(e){jR(this,"metaCtor",q$()),jR(this,"meta",void 0),this.meta=this.metaCtor.prototype,$i(this.meta,AM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;$i(this.meta,e),Fc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function K$(t,e,r){return(e=X$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X$(t){var e=Z$(t,"string");return typeof e=="symbol"?e:e+""}function Z$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J${constructor(e){K$(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){$i(this.meta,e),Fc(this.meta,e,e)}}function Jl(t,e,r){return(e=Q$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q$(t){var e=eB(t,"string");return typeof e=="symbol"?e:e+""}function eB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qu{constructor(e){Jl(this,"valueFactory",void 0),Jl(this,"data",[]),Jl(this,"index",[]),Jl(this,"holes",new Set),this.valueFactory=e}obtain(e){Hu(()=>Os(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Hu(()=>Os(e)||Zl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Zl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Hu(()=>Os(e)||Zl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Zl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function zR(t,e,r){return(e=tB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tB(t){var e=rB(t,"string");return typeof e=="symbol"?e:e+""}function rB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nB=["data","width"];class iB{constructor(e){zR(this,"globalMeta",void 0),zR(this,"metas",new Qu(()=>this._createMeta())),this.globalMeta=e,this.metas=new Qu(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);$i(n,r),Fc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return z$(this.globalMeta.getMetaConstructor(),nB).prototype}}function UR(t,e,r){return(e=oB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oB(t){var e=sB(t,"string");return typeof e=="symbol"?e:e+""}function sB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aB{constructor(e){UR(this,"columnMeta",void 0),UR(this,"metas",new Qu(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);$i(i,n),Fc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)ue(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Hu(()=>Os(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Qu(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class DM{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new G$(e),this.tableMeta=new J$(this.globalMeta),this.columnMeta=new iB(this.globalMeta),this.cellMeta=new aB(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Qe(DM,Fn);function YR(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Mc(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Ee(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Ss(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let v,b=0,E=0;for(b=0,E=d.startRows;b<E;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Tr(p),t.push(v);else if(i.dataType==="array")v=Tr(p[0]),t.push(v);else{v=[];for(let S=0,T=d.startCols;S<T;S++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Te(i.rootElement,[K_(-1),Ic(i.countCols()+(i.view?i.countRowHeaders():0))])}function qR(t,e,r){return(e=lB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lB(t){var e=uB(t,"string");return typeof e=="symbol"?e:e+""}function uB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cB{constructor(e){var r=this;qR(this,"metaManager",void 0),qR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),ge.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=jr(e,"type")?e.type:null;let c=Ee(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function hB(t,e,r){dB(t,e),e.set(t,r)}function dB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rg(t,e,r){return(e=fB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fB(t){var e=gB(t,"string");return typeof e=="symbol"?e:e+""}function gB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mB(t,e){return t.get(pB(t,e))}function pB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var GR=new WeakMap;class wB{constructor(e){Rg(this,"metaManager",void 0),Rg(this,"usageTracker",new Set),Rg(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),hB(this,GR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,mB(GR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}function vB(t,e){NM(t,e),e.add(t)}function KR(t,e,r){NM(t,e),e.set(t,r)}function NM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XR(t,e){return t.get(Ds(t,e))}function ZR(t,e,r){return t.set(Ds(t,e),r),r}function Ds(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ym=new WeakMap,bm=new WeakMap,Ua=new WeakSet;class yB{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;vB(this,Ua),KR(this,ym,void 0),KR(this,bm,void 0),ZR(ym,this,r),ZR(bm,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Ds(Ua,this,JR).call(this,e.from,r,n);if(i===null)return null;const o=Ds(Ua,this,JR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function JR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Ds(Ua,this,QR).call(this,XR(ym,this),t.row,e);if(n===null)return null;const i=Ds(Ua,this,QR).call(this,XR(bm,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function QR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}function Gs(t){Ro(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Vc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,p=n.getBottomEndCorner().row,v=g<=h,b=p>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?n.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:v&&b?n.highlight.row:v?g:b?p:E.row}}}function bB(t){return e=>{const r=Vc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Gs(t.getCell(n?-1:0,r,!0))})}}function SB(){return()=>{}}function CB(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;Gs(t.getCell(n,i,!0))})}}function RB(t){return e=>{const r=Vc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Gs(t.getCell(i,o,!0))})}}function EB(t){return e=>{const r=Vc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Gs(t.getCell(i,o,!0))})}}function TB(t){return e=>{const r=Vc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Gs(t.getCell(r,n?-1:0,!0))})}}function _B(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{Gs(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function OB(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=CB(t):e.isSelectedByCorner()?s=SB():e.isSelectedByRowHeader()?s=TB(t):e.isSelectedByColumnHeader()?s=bB(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=RB(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=_B(t):e.getSelectedRange().size()>1&&(s=EB(t)),(o=s)===null||o===void 0||o(i)}}}const MB=Object.freeze({INLINE:"inline",MODAL:"modal"}),bo=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),IB="grid";function PB(t,e){const r=eE(t,bo.TAB_FROM_ABOVE),n=eE(t,bo.TAB_FROM_BELOW);return e.prepend(r),e.append(n),{activate(){r.tabIndex=0,n.tabIndex=0},deactivate(){r.tabIndex=-1,n.tabIndex=-1},destroy(){r.remove(),n.remove()}}}function eE(t,e){const n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),n.dataset.htFocusSource=e,t.getSettings().ariaTags&&Te(n,[zu("Focus catcher")]),n}function HB(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n={shortcutsContextName:IB,type:MB.INLINE,contains:g=>g===e||e.contains(g),runOnlyIf:()=>!0,...r},i=PB(t,e);return{getType:()=>n.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>n.shortcutsContextName,runOnlyIf:()=>n.runOnlyIf(),contains:g=>n.contains(g),activate:function(){var g;let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bo.UNKNOWN;(g=n.onActivate)===null||g===void 0||g.call(n,p)},deactivate:()=>{var g;(g=n.onDeactivate)===null||g===void 0||g.call(n)},activateFocusCatchers:()=>{i?.activate()},deactivateFocusCatchers:()=>{i?.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{i?.destroy()}}}function xB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=!1;function n(c){if(!r){var h;(h=e.onFocus)===null||h===void 0||h.call(e,c)}}function i(c){var h;(h=e.onClick)===null||h===void 0||h.call(e,c)}function o(c){if(c.key==="Tab"){var h;(h=e.onTabKeyDown)===null||h===void 0||h.call(e,c)}}function s(){r=!0}function a(){r=!1}return{mount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.addEventListener("focusin",n),h.addEventListener("click",i),h.addEventListener("keydown",o),h.addEventListener("mousedown",s),h.addEventListener("mouseup",a),c=Oo(c)}},unmount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.removeEventListener("focusin",n),h.removeEventListener("click",i),h.removeEventListener("keydown",o),h.removeEventListener("mousedown",s),h.removeEventListener("mouseup",a),c=Oo(c)}}}}function AB(t){const e=vl({errorIdExists:p=>`The "${p}" focus scope is already registered.`}),r=t.getShortcutManager();let n=null;function i(){return n?e.getId(n):null}function o(p,v){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(p))throw new Error(`Scope with id "${p}" already registered`);const E=HB(t,v,b);e.addItem(p,E),r.getOrCreateContext(E.getShortcutsContextName())}function s(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);e.getItem(p).destroy(),e.removeItem(p)}function a(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);u(e.getItem(p))}function l(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);c(e.getItem(p))}function u(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bo.UNKNOWN;n!==p&&(n!==null&&c(n),n=p,n.activate(v),r.setActiveContextName(p.getShortcutsContextName()))}function c(p){h(),n===p&&(n=null,p.deactivate())}function h(){const p=e.getValues(),v=p.filter(b=>b.runOnlyIf()&&b.getType()==="modal");p.forEach(b=>{v.length>0&&v.includes(b)||v.length===0||b.hasContainerDetached()?b.enable():b.disable(),b===n?b.contains(t.rootDocument.activeElement)?b.deactivateFocusCatchers():b.activateFocusCatchers():b.runOnlyIf()?b.activateFocusCatchers():b.deactivateFocusCatchers()})}function d(p,v){if(!p.isConnected||!As(p))return;const b=e.getValues().filter(S=>S.runOnlyIf());let E=!1;b.forEach(S=>{!E&&S.contains(p)&&(E=!0,v!==bo.UNKNOWN&&t.listen(),u(S,v))}),!E&&n&&(c(n),t.unlisten())}const g=xB(t.rootWindow,{onFocus:p=>{var v;d(p.target,(v=p.target.dataset.htFocusSource)!==null&&v!==void 0?v:bo.UNKNOWN)},onClick:p=>{d(p.target,bo.CLICK)},onTabKeyDown:()=>{h()}});return g.mount(),{getActiveScopeId:i,registerScope:o,unregisterScope:s,activateScope:p=>a(p),deactivateScope:p=>l(p),destroy:()=>g.unmount()}}function DB(t,e){kM(t,e),e.add(t)}function os(t,e,r){kM(t,e),e.set(t,r)}function kM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ae(t,e){return t.get(ln(t,e))}function go(t,e,r){return t.set(ln(t,e),r),r}function ln(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Is=Object.freeze({CELL:"cell",MIXED:"mixed"});var Je=new WeakMap,Ql=new WeakMap,eu=new WeakMap,tu=new WeakMap,ru=new WeakMap,ec=new WeakMap,Mn=new WeakSet;class NB{constructor(e){DB(this,Mn),os(this,Je,void 0),os(this,Ql,void 0),os(this,eu,1),os(this,tu,null),os(this,ru,new Map),os(this,ec,!1),go(Je,this,e)}init(){var e=this;const r=Ae(Je,this).getSettings();go(Ql,this,r.imeFastEdit?Is.MIXED:Is.CELL),Ae(Je,this).addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Mn,e,VB).call(e,...i)}),Ae(Je,this).addHook("afterSelection",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Mn,e,tE).call(e,...i)}),Ae(Je,this).addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Mn,e,tE).call(e,...i)}),Ae(Je,this).addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Mn,e,LB).call(e,...i)}),Ae(Je,this).addHook("afterRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ln(Mn,e,FB).call(e,...i)})}getFocusMode(){return Ae(Ql,this)}setFocusMode(e){Object.values(Is).includes(e)?go(Ql,this,e):hr(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ae(eu,this)}setRefocusDelay(e){go(eu,this,e)}setRefocusElementGetter(e){go(tu,this,e)}getRefocusElement(){var e;return typeof Ae(tu,this)=="function"?Ae(tu,this).call(this):(e=Ae(Je,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Ae(Je,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ae(Je,this).runHooks("modifyFocusedElement",s.row,s.col,n);Ro(a)||(a=n),a&&!((o=Ae(Je,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):ln(Mn,this,Mw).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ae(eu,this);if(Ae(Je,this).getSettings().imeFastEdit&&!((e=Ae(Je,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Ae(Je,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Ae(ru,this).has(r)||Ae(ru,this).set(r,f0(()=>{if(!Ae(Je,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Ae(ru,this).get(r)()}}}function Mw(t){var e;const r=(e=Ae(Je,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!Ae(Je,this).selection.isCellVisible(r)){t(null);return}const n=Ae(Je,this).getCell(r.row,r.col,!0);n===null?Ae(Je,this).addHookOnce("afterScroll",()=>{t(Ae(Je,this).getCell(r.row,r.col,!0))}):t(n)}function kB(){ln(Mn,this,Mw).call(this,t=>{const{activeElement:e}=Ae(Je,this).rootDocument;e&&c0(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function LB(){ln(Mn,this,Mw).call(this,t=>{this.getFocusMode()===Is.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function tE(){go(ec,this,!0)}function FB(){Ae(ec,this)&&(go(ec,this,!1),ln(Mn,this,kB).call(this))}function VB(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Is.MIXED:Is.CELL)}function WB(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=Sm(t),o=Cm(t);return i===null||o===null?null:(e.row=Ne(e.row,i.row,o.row),e.col=Ne(e.col,i.col,o.col),e)}}function Sm(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Cm(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}const Ya="gridDefault",Iw="grid",tc="grid.tabNavigation",LM="editorManager.handlingEditor",$B="editor",BB={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},jB="hooksRefRegisterer",FM={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){j(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Me(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};pi(FM,"MIXIN_NAME",jB,{writable:!1,enumerable:!1});function tn(t,e,r){return(e=zB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zB(t){var e=UB(t,"string");return typeof e=="symbol"?e:e+""}function UB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const YB="base",ct=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Pw{static get EDITOR_TYPE(){return YB}constructor(e){tn(this,"hot",void 0),tn(this,"state",ct.VIRGIN),tn(this,"_opened",!1),tn(this,"_fullEditMode",!1),tn(this,"_closeCallback",null),tn(this,"TD",null),tn(this,"row",null),tn(this,"col",null),tn(this,"prop",null),tn(this,"originalValue",null),tn(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:ct.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();n=u.row,i=u.col,o=c.row,s=c.col}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==ct.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=ct.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Ep(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===ct.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===ct.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=ct.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=ct.FINISHED,this.discardEditor(s)}):(this.state=ct.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=ct.FINISHED,this.discardEditor()}discardEditor(e){this.state===ct.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=ct.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ct.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===ct.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Wr(r),a=ar(r),l=Wr(this.hot.rootElement),u=ar(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=v.name,E=["master","inline_start"].includes(b)?d:0,S=["master","top","bottom"].includes(b)?g:0,T=s.top===l.top?0:1;let y=s.top-l.top-T-E,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-p-1+S:M=s.left-l.left-1-S,["top","top_inline_start_corner"].includes(b)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),A=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&P<=0||P===W)&&(y+=1),A<=0&&(M+=1);const K=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,ie=Math.abs(n.inlineStartOverlay.getScrollPosition()),G=n.topOverlay.getScrollPosition(),te=Ut(this.hot.rootDocument);let tt=r.offsetTop;if(["inline_start","master"].includes(b)&&(tt+=K-G),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:C,wtTable:_}=n.bottomOverlay.clone;tt+=C.getWorkspaceHeight()-_.getHeight()-te}let Ie=r.offsetLeft;this.hot.isRtl()?(Ie>=0?Ie=v.getWidth()-r.offsetLeft:Ie=Math.abs(Ie),Ie+=L-ie-a):["top","master","bottom"].includes(b)&&(Ie+=L-ie);const Ce=o.getComputedStyle(this.TD),Be=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",je=parseInt(Ce[Be],10)>0?0:1,Pe=parseInt(Ce.borderTopWidth,10)>0?0:1,Ir=ar(r)+je,He=cr(r)+Pe,Dt=tk(c)?te:0,f=rk(h)?te:0,m=this.hot.view.maximumVisibleElementWidth(Ie)-Dt+je,w=Math.max(this.hot.view.maximumVisibleElementHeight(tt)-f+Pe,this.hot.stylesHandler.getDefaultRowHeight());return{top:y,start:M,height:He,maxHeight:w,width:Ir,maxWidth:m}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Qe(Pw,FM);const qB={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===ct.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},GB={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},KB={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},XB={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},ZB={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>n.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Hc(e))}};function JB(){return[BB,qB,GB,KB,XB,ZB]}const QB={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},ej={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},tj={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},rj={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},nj={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},ij={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},oj={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},sj={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},aj={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},lj={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},uj={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},cj={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},hj={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},dj={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function fj(){return[QB,ej,tj,rj,nj,ij,oj,sj,aj,lj,uj,cj,hj,dj]}const gj={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},mj={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},pj={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},wj={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},vj={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},yj={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},bj={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},Sj={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Cj={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Rj={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Ej={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},Tj={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},_j={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},Oj={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Mj={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Ij={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function Pj(){return[gj,mj,pj,wj,vj,yj,bj,Sj,Cj,Rj,Ej,Tj,_j,Oj,Mj,Ij]}const Hj={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},xj={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Aj={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Dj={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Nj={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},kj={name:"tabNavigation",callback(t){const e={wrapped:!1,flipped:!1};let r=!1,n=!1;return t.addHook("afterSelection",(i,o,s,a,l)=>{r&&(e.wrapped&&e.flipped||n)&&(n=!1,l.value=!0)}),t.addHook("beforeRowWrap",(i,o,s)=>{e.wrapped=!0,e.flipped=s}),{before(){const{tabNavigation:i}=t.getSettings();r=!0,i||(n=!0)},after(i){const{tabNavigation:o,autoWrapRow:s}=t.getSettings();if(r=!1,!o||!t.selection.isSelected()||s&&e.wrapped&&e.flipped||!s&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;i.preventDefault()}}}},Lj=[...JB(),...fj(),...Pj(),Hj,xj,Aj,Dj,Nj,kj];function VM(t){const e={};return Lj.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function Fj(t){const e=t.getShortcutManager().addContext($B),r=VM(t),n={group:LM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(Iw),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function Vj(t){const e=t.getShortcutManager().addContext(Iw),r=VM(t),n={runOnlyIf:()=>{const{navigableHeaders:o}=t.getSettings();return ue(t.getSelected())&&(o||!o&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Ya};e.addShortcuts([{keys:[["F2"]],callback:o=>r.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,s)=>r.editorOpen(o,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:LM,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var o;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var o,s;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())&&((s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>r.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>r.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n);const i=r.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ya,group:tc,position:"before",callback:o=>i.before(o)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ya,group:tc,callback:o=>i.after(o),position:"after"}])}function Wj(t){[Vj,Fj].forEach(e=>e(t))}function $j(t){var e;const r=WB(t),n={wrapped:!1,flipped:!1};let i,o=!0,s=!1;t.addHook("afterSelection",()=>{if(o){var u;i=(u=t.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight}}),t.addHook("beforeRowWrap",(u,c,h)=>{n.wrapped=!0,n.flipped=h}),t.addHook("beforeEmptyDataStateShow",()=>{s=!0}),t.addHook("beforeEmptyDataStateHide",()=>{s=!1}),t.getShortcutManager().getContext(Iw).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ya,group:tc,position:"before",callback(){const{tabNavigation:u}=t.getSettings();t.getSelectedRangeActive()&&!u&&(o=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Ya,group:tc,callback(u){const{tabNavigation:c,autoWrapRow:h}=t.getSettings();o=!0,(!c||!t.selection.isSelected()||h&&n.wrapped&&n.flipped||!h&&n.wrapped)&&(h&&n.wrapped&&n.flipped&&(i=u.shiftKey?Sm(t):Cm(t)),n.wrapped=!1,n.flipped=!1)},position:"after"}]);const l=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",l,{contains:u=>l===u||l.contains(u)?!0:u.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(u),runOnlyIf:()=>{const{navigableHeaders:u}=t.getSettings();return(s||!u)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!u&&t.countRenderedRows()>0&&t.countRenderedCols()>0||u&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:u=>{if(u==="tab_from_above"){var c;const d=(c=r(i))!==null&&c!==void 0?c:Sm(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_above",d)!==!1&&t.selectCell(d.row,d.col)}else if(u==="tab_from_below"){var h;const d=(h=r(i))!==null&&h!==void 0?h:Cm(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_below",d)!==!1&&t.selectCell(d.row,d.col)}}})}function Bj(t){[$j].forEach(e=>e(t))}const rE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),nu=t=>t.map(e=>{const r=e.toLowerCase();return rE.has(r)?rE.get(r):r}).sort().join("+"),jj=t=>t.split("+"),nE=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Eg=t=>{let{which:e,key:r}=t;if(nE.has(e))return nE.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},WM=Symbol("shortcut-context");function Rm(t){return st(t)&&t.__kindOf===WM}const zj=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=vl({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:p=!0,stopPropagation:v=!1,relativeToGroup:b,position:E,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(jt(h))throw new Error("You need to define the shortcut's group.");if(Ee(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(ur`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const T={callback:c,group:h,runOnlyIf:d,captureCtrl:g,preventDefault:p,stopPropagation:v};ue(b)&&(T.relativeToGroup=b,T.position=E),Rm(S)&&(T.forwardToContext=S),u.forEach(y=>{const M=nu(y);if(r.hasItem(M)){const P=r.getItem(M);let A=P.findIndex(F=>F.group===b);A!==-1?E==="before"?A-=1:A+=1:A=P.length,P.splice(A,0,T)}else r.addItem(M,[T])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{Me(c,(d,g)=>{Object.prototype.hasOwnProperty.call(h,g)===!1&&(h[g]=c[g])}),n(h)})},o=u=>{const c=nu(u);r.removeItem(c)};return{__kindOf:WM,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const c=nu(u),h=r.getItem(c);return ue(h)?h.slice():[]},hasShortcut:u=>{const c=nu(u);return r.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{r.getItems().forEach(h=>{let[d,g]=h;const p=g.filter(v=>v.group!==u);p.length===0?o(jj(d)):(g.length=0,g.push(...p))})}}};function Uj(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Yj=["meta","alt","shift","control"],va=Uj(),ya=[];let iu=0;function qj(t,e,r,n,i){const o=g=>Yj.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),p&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||co(g))return;const v=Eg(g);let b=[];o(v)||(b=s(g));const E=[v].concat(b);!i(g,E)&&(lC()&&b.includes("meta")||!lC()&&b.includes("control"))&&i(g,[v].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const p=Eg(g);o(p)&&va.press(p)}},u=g=>{if(typeof g.key=="string"){const p=Eg(g);o(p)&&va.release(p)}},c=()=>{va.releaseAll()};return{mount:()=>{let g=t;for(iu+=1;g;)iu===1&&(g.document.documentElement.addEventListener("keydown",l),ya.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),ya.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Oo(g)},unmount:()=>{let g=t;for(iu-=1;g;){if(iu===0){for(let p=0;p<ya.length;p++){const{event:v,listener:b}=ya[p];g.document.documentElement.removeEventListener(v,b)}ya.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Oo(g)}},isPressed:g=>va.isPressed(g),releasePressedKeys:()=>va.releaseAll()}}const Gj=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=vl({errorIdExists:b=>`The "${b}" context name is already registered.`});let s="grid";const a=function(b){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const S=zj(b,E);return o.addItem(b,S),S},l=()=>s,u=b=>o.getItem(b),c=function(b){var E;let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(E=u(b))!==null&&E!==void 0?E:a(b,S)},h=b=>{if(!o.hasItem(b))throw new Error(ur`You've tried to activate the "${b}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=b};let d=!1;const g=function(b,E){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const T=Rm(S)?S:u(S);let y=!1;if(!T.hasShortcut(E))return y;const M=T.getShortcuts(E);for(let H=0;H<M.length;H++){const{callback:P,runOnlyIf:A,preventDefault:F,stopPropagation:W,captureCtrl:K,forwardToContext:L}=M[H];if(A(b)===!0){if(d=K,y=P(b,E)===!1,d=!1,F&&b.preventDefault(),W&&(Hc(b),b.stopPropagation()),y)break;L&&g(b,E,L)}}return y},v=qj(e,b=>{const E=l(),S=Rm(E)?E:u(E);return r(b,S.scope)},n,i,g);return v.mount(),{addContext:a,getActiveContextName:l,getContext:u,getOrCreateContext:c,setActiveContextName:h,isCtrlPressed:()=>!d&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}};function iE(t){const{classNames:e}=qN(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function Kj(t,e){$M(t,e),e.add(t)}function Jn(t,e,r){$M(t,e),e.set(t,r)}function $M(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){return t.get(an(t,e))}function rr(t,e,r){return t.set(an(t,e),r),r}function an(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oE=23;var Tg=new WeakMap,En=new WeakMap,rc=new WeakMap,Hw=new WeakMap,Em=new WeakMap,_i=new WeakMap,Da=new WeakMap,el=new WeakMap,ba=new WeakMap,On=new WeakSet;class Xj{constructor(e){let{hot:r,rootElement:n,rootDocument:i,onThemeChange:o=()=>{}}=e;Kj(this,On),Jn(this,Tg,void 0),Jn(this,En,void 0),Jn(this,rc,void 0),Jn(this,Hw,void 0),Jn(this,Em,void 0),Jn(this,_i,!0),Jn(this,Da,{}),Jn(this,el,{}),Jn(this,ba,void 0),rr(Tg,this,r),rr(rc,this,n),rr(Em,this,i),rr(ba,this,o)}isClassicTheme(){return Ke(_i,this)}getCSSVariableValue(e){var r;if(Ke(_i,this))return null;if(Ke(Da,this)[`--ht-${e}`])return Ke(Da,this)[`--ht-${e}`];const n=(r=an(On,this,Qj).call(this,`--ht-${e}`))!==null&&r!==void 0?r:an(On,this,BM).call(this,`--ht-${e}`);if(n!==null)return Ke(Da,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Ke(el,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(e){if(Ke(_i,this))return oE;const r=an(On,this,Zj).call(this);return r?e!==void 0&&e===Ke(Tg,this).view.getFirstRenderedVisibleRow()?r+1:r:oE}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){rr(En,this,void 0),rr(_i,this,!0),Ke(ba,this).call(this,Ke(En,this)),an(On,this,_g).call(this);return}if(e&&e!==Ke(En,this)){if(!/ht-theme-.*/.test(e)){hr(`Invalid theme name: ${e}. Please provide a valid theme name.`),rr(En,this,void 0),rr(_i,this,!1),Ke(ba,this).call(this,Ke(En,this)),an(On,this,_g).call(this);return}Ke(En,this)&&an(On,this,ez).call(this),rr(En,this,e),rr(_i,this,!1),Ke(ba,this).call(this,Ke(En,this)),an(On,this,_g).call(this)}}getThemeName(){return Ke(En,this)}}function Zj(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function _g(){this.isClassicTheme()||rr(Hw,this,getComputedStyle(Ke(rc,this)));const t=an(On,this,Jj).call(this,["box-sizing","border-bottom-width"]);Ke(el,this).td={...Ke(el,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Jj(t){const e=Ke(Em,this),r=Ke(rc,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function Qj(t){const e=Math.ceil(parseFloat(an(On,this,BM).call(this,t)));return Number.isNaN(e)?null:e}function BM(t){const e=Ke(Hw,this).getPropertyValue(t);return e===""?null:e}function ez(){rr(el,this,{}),rr(Da,this,{}),rr(_i,this,!0)}let ii=null,xu=0;function tz(t){const e=t.ownerDocument;if(!ii){ii=e.createElement("div"),ii.setAttribute("role","status"),ii.setAttribute("aria-live","assertive"),ii.setAttribute("aria-atomic","true");const r=ii.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(ii)}xu+=1}function rz(){xu!==0&&(xu===1&&(ii.remove(),ii=null),xu-=1)}let Og=null;const ou=new WeakSet,Mg=new Map;function jM(t,e){var r,n,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Bi(s);let l,u,c,h,d,g,p=!0;const v={...e.initialState,...e};sW(o)&&oW(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=_n(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,_n(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Z(this.rootElement,["ht-wrapper","handsontable"]),Z(this.rootWrapperElement,"ht-root-wrapper"),Z(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),Z(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(r=v?.layoutDirection)!==null&&r!==void 0?r:"inherit",E=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",E),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",E),this.isRtl=function(){return E==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new Xj({hot:s,rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:f=>{_n(this)&&(Oe(this.rootWrapperElement,/ht-theme-.*/g),Oe(this.rootPortalElement,/ht-theme-.*/g),f&&(Z(this.rootWrapperElement,f),Z(this.rootPortalElement,f),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||hr(`The "${f}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=n$(v.language);const S=Object.fromEntries(Object.entries(v).filter(f=>{let[m]=f;return!(ge.getSingleton().isRegistered(m)||ge.getSingleton().isDeprecated(m))})),T=new DM(s,S,[cB,wB]),y=T.getTableMeta(),M=T.getGlobalMeta(),H=vl();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${z_()}`,Mg.set(this.guid,this),this.columnIndexMapper=new pm,this.rowIndexMapper=new pm,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{s.runHooks("beforeCompositionStart",f)}),u=new yW(s);const P=jo(this.guid);P.register("cellRangeMapper",new yB({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},F=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)},W=(f,m)=>{const w=m>f?1:-1,C=Math.min(f,m),_=Math.max(f,m),O=s.rowIndexMapper.getNearestNotHiddenIndex(f,w);return O===null||w===1&&O>_||w===-1&&O<C?null:O>=0?s.rowIndexMapper.getRenderableFromVisualIndex(O):O},K=(f,m)=>{const w=m>f?1:-1,C=Math.min(f,m),_=Math.max(f,m),O=s.columnIndexMapper.getNearestNotHiddenIndex(f,w);return O===null||w===1&&O>_||w===-1&&O<C?null:O>=0?s.columnIndexMapper.getRenderableFromVisualIndex(O):O};let L=new HM(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,w)=>s._createCellRange(f,m,w),visualToRenderableCoords:A,renderableToVisualCoords:F,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:K,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=L;const ie=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",f=>{ie(f),this.runHooks("afterColumnSequenceCacheUpdate",f)}),this.rowIndexMapper.addLocalHook("cacheUpdated",f=>{ie(f),this.runHooks("afterRowSequenceCacheUpdate",f)}),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const w=Cr(!1),C=this.selection.getSelectedRange(),{from:_,to:O}=C.current(),x=C.size()-1;this.runHooks("afterSelection",_.row,_.col,O.row,O.col,w,x),this.runHooks("afterSelectionByProp",_.row,s.colToProp(_.col),O.row,s.colToProp(O.col),w,x),m&&(!w.isTouched()||w.isTouched()&&!w.value)&&g.scrollTo(f);const D=L.isSelectedByRowHeader(),q=L.isSelectedByColumnHeader();D&&q?Z(this.rootElement,["ht__selection--rows","ht__selection--columns"]):D?(Oe(this.rootElement,"ht__selection--columns"),Z(this.rootElement,"ht__selection--rows")):q?(Oe(this.rootElement,"ht__selection--rows"),Z(this.rootElement,"ht__selection--columns")):Oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(L.getSelectionSource())||h.closeEditor(null),L.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=Cr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(f),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:w,to:C}=f[m];this.runHooks("afterSelectionEnd",w.row,w.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),C.row,s.colToProp(C.col),m),L.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),Oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeSelectAll",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeSelectAll",...m)}).addLocalHook("afterSelectAll",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterSelectAll",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0;const O=x=>{if(x.length===0)return[];const D=[...x];return D.sort(($,I)=>{let[B]=$,[X]=I;return B===X?0:B>X?1:-1}),$o(D,($,I)=>{let[B,X]=I;const ae=$[$.length-1],[ye,ce]=ae,fe=ye+ce;if(B<=fe){const Le=Math.max(X-(fe-B),0);ae[1]+=Le}else $.push([B,X]);return $},[D[0]])};switch(f){case"insert_row_below":case"insert_row_above":const x=s.countSourceRows();if(y.maxRows===x)return;const D=f==="insert_row_below"?"below":"above";m=m??(D==="below"?x:0);const{delta:q,startPhysicalIndex:$}=l.createRow(m,w,{source:C,mode:D});L.shiftRows(s.toVisualRow($),q);break;case"insert_col_start":case"insert_col_end":const I=f==="insert_col_end"?"end":"start";m=m??(I==="end"?s.countSourceCols():0);const{delta:B,startPhysicalIndex:X}=l.createCol(m,w,{source:C,mode:I});if(B){if(Array.isArray(y.colHeaders)){const ce=[s.toVisualColumn(X),0];ce.length+=B,Array.prototype.splice.apply(y.colHeaders,ce)}L.shiftColumns(s.toVisualColumn(X),B)}break;case"remove_row":const ae=ce=>{let fe=0;j(ce,Le=>{let[he,xe]=Le;const bt=_o(he)?s.countRows()-1:Math.max(he-fe,0);if(Number.isInteger(he)&&(he=Math.max(he-fe,0)),!l.removeRow(he,xe,C))return;if(L.isSelected()){const{row:pt}=s.getSelectedRangeActive().highlight;pt>=he&&pt<=he+xe-1&&h.closeEditor(!0)}const Wn=s.countRows(),$n=y.fixedRowsTop;$n>=bt+1&&(y.fixedRowsTop-=Math.min(xe,$n-bt));const kt=y.fixedRowsBottom;if(kt&&bt>=Wn-kt&&(y.fixedRowsBottom-=Math.min(xe,kt)),Wn===0)L.deselect();else if(C==="ContextMenu.removeRow"){const pt=L.getSelectedRange(),Pr=pt.pop();pt.clear().set(Pr.from).current().setTo(Pr.to),L.refresh()}else L.shiftRows(he,-xe);fe+=xe})};Array.isArray(m)?ae(O(m)):ae([[m,w]]);break;case"remove_col":const ye=ce=>{let fe=0;j(ce,Le=>{let[he,xe]=Le;const bt=_o(he)?s.countCols()-1:Math.max(he-fe,0);let Nt=s.toPhysicalColumn(bt);if(Number.isInteger(he)&&(he=Math.max(he-fe,0)),!l.removeCol(he,xe,C))return;if(L.isSelected()){const{col:pt}=s.getSelectedRangeActive().highlight;pt>=he&&pt<=he+xe-1&&h.closeEditor(!0)}if(s.countCols()===0)L.deselect();else if(C==="ContextMenu.removeColumn"){const pt=L.getSelectedRange(),Pr=pt.pop();pt.clear().set(Pr.from).current().setTo(Pr.to),L.refresh()}else L.shiftColumns(he,-xe);const kt=y.fixedColumnsStart;kt>=bt+1&&(y.fixedColumnsStart-=Math.min(xe,kt-bt)),Array.isArray(y.colHeaders)&&(typeof Nt>"u"&&(Nt=-1),y.colHeaders.splice(Nt,xe)),fe+=xe})};Array.isArray(m)?ye(O(m)):ye([[m,w]]);break;default:throw new Error(`There is no such action "${f}"`)}_||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,w=y.minCols,C=y.minSpareCols;if(f){const _=s.countRows();_<f&&l.createRow(_,f-_,{source:"auto"})}if(m){const _=s.countEmptyRows(!0);if(_<m){const O=m-_,x=Math.min(O,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),x,{source:"auto"})}}{let _;(w||C)&&(_=s.countEmptyCols(!0));let O=s.countCols();if(w&&!y.columns&&O<w){const x=w-O;_+=x,l.createCol(O,x,{source:"auto"})}if(C&&!y.columns&&s.dataType==="array"&&_<C){O=s.countCols();const x=C-_,D=Math.min(x,y.maxCols-O);l.createCol(O,D,{source:"auto"})}}},populateFromArray(f,m,w,C,_){let O,x,D,q;const $=[],I={},B=[],X=f.row,ae=f.col;if(x=m.length,x===0)return!1;let ye=0,ce=0;switch(st(w)&&(ye=w.col-ae+1,ce=w.row-X+1),_){case"shift_down":const Le=Ff(m),he=Le.length,xe=Math.max(he,ye),bt=s.getData().slice(X),Nt=Ff(bt).slice(ae,ae+xe);for(D=0;D<xe;D+=1)if(D<he){for(O=0,x=Le[D].length;O<ce-x;O+=1)Le[D].push(Le[D][O%x]);D<Nt.length?B.push(Le[D].concat(Nt[D])):B.push(Le[D].concat(new Array(bt.length).fill(null)))}else B.push(Le[D%he].concat(Nt[D]));s.populateFromArray(X,ae,Ff(B));break;case"shift_right":const Wn=m.length,$n=Math.max(Wn,ce),kt=s.getData().slice(X).map(gr=>gr.slice(ae));for(O=0;O<$n;O+=1)if(O<Wn){for(D=0,q=m[O].length;D<ye-q;D+=1)m[O].push(m[O][D%q]);if(O<kt.length)for(let gr=0;gr<kt[O].length;gr+=1)m[O].push(kt[O][gr]);else m[O].push(...new Array(kt[0].length).fill(null))}else m.push(m[O%x].slice(0,$n).concat(kt[O]));s.populateFromArray(X,ae,m);break;case"overwrite":default:I.row=f.row,I.col=f.col;let pt=0,Pr=0,wn=!0,Xr;const Hr=function(zo){let Zr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const vn=m[zo%m.length];return Zr!==null?vn[Zr%vn.length]:vn},Bn=m.length,Gi=w?w.row-f.row+1:0;for(w?x=Gi:x=Math.max(Bn,Gi),O=0;O<x&&!(w&&I.row>w.row&&Gi>Bn||!y.allowInsertRow&&I.row>s.countRows()-1||I.row>=y.maxRows);O++){const gr=O-pt,zo=Hr(gr).length,Zr=w?w.col-f.col+1:0;if(w?q=Zr:q=Math.max(zo,Zr),I.col=f.col,Xr=s.getCellMeta(I.row,I.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Xr.skipRowOnPaste){pt+=1,I.row+=1,x+=1;continue}for(Pr=0,D=0;D<q;D++){var fe;if(w&&I.col>w.col&&Zr>zo||!y.allowInsertColumn&&I.col>s.countCols()-1||I.col>=y.maxCols)break;if(Xr=s.getCellMeta(I.row,I.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Xr.skipColumnOnPaste){Pr+=1,I.col+=1,q+=1;continue}if(Xr.readOnly&&C!=="UndoRedo.undo"){I.col+=1;continue}const vn=D-Pr,Ks=!!Xr.valueSetter;let Ot=Hr(gr,vn),mr=(fe=s.getSourceDataAtCell(I.row,I.col))!==null&&fe!==void 0?fe:null;if(Ot!==null&&typeof Ot=="object"){if(Array.isArray(Ot)&&mr===null&&(mr=[]),!Ks&&(typeof mr!="object"||mr===null))wn=!1;else if(mr!==null){const Rl=Qa(Array.isArray(mr)?mr:mr[0]||mr),rt=Qa(Array.isArray(Ot)?Ot:Ot[0]||Ot);Ks||Q_(Rl,rt)||Array.isArray(Rl)&&Array.isArray(rt)?Ot=Tr(Ot):wn=!1}}else!Ks&&mr!==null&&typeof mr=="object"&&(wn=!1);wn&&$.push([I.row,I.col,Ot]),wn=!0,I.col+=1}I.row+=1}s.setDataAtCell($,null,null,C||"populateFromArray");break}}};function G(f){const m=eO(f);Rw(m)?(s.runHooks("beforeLanguageChange",m),M.language=m,s.runHooks("afterLanguageChange",m)):tO(f)}function te(f,m){const w=f==="className"?s.rootElement:s.table;if(p)Z(w,m);else{let C=[],_=[];M[f]&&(C=Array.isArray(M[f])?M[f]:XS(M[f])),m&&(_=Array.isArray(m)?m:XS(m));const O=KS(C,_),x=KS(_,C);O.length&&Oe(w,O),x.length&&Z(w,x)}M[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(Hi()||Mp())&&Z(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new cW(this),h=dm.getInstance(s,y,L),g=OB(s),d.init(),_n(this)&&(tz(s.rootPortalElement),pN(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),p&&s.rootElement.offsetParent===null&&nk(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function tt(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Ie(f,m,w){if(!f.length){w();return}const C=s.getActiveEditor(),_=new tt;let O=!0;_.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),w()};for(let x=f.length-1;x>=0;x--){const[D,q,,$]=f[x],I=l.propToCol(q);let B;Number.isInteger(I)?B=s.getCellMeta(D,I):B={...Object.getPrototypeOf(y),...y},s.getCellValidator(B)&&(_.addValidatorToQueue(),s.validateCell($,B,(function(X,ae){return function(ye){if(typeof ye!="boolean")throw new Error("Validation error: result is not boolean");ye===!1&&ae.allowInvalid===!1&&(O=!1,f.splice(X,1),ae.valid=!0),_.removeValidatorFormQueue()}})(x,B),m))}_.checkIfQueueIsEmpty()}function Ce(f,m){for(let C=f.length-1;C>=0;C--){let _=!1;if(f[C]===null){f.splice(C,1);continue}if(!((f[C][2]===null||f[C][2]===void 0)&&(f[C][3]===null||f[C][3]===void 0))){if(y.allowInsertRow)for(;f[C][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[C][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}_||l.set(f[C][0],f[C][1],f[C][3])}}if(f.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",f,m||"edit");const C=s.getActiveEditor();C&&ue(C.refreshValue)&&C.refreshValue()}else s.render()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,w){return s.view._wt.createCellRange(f,m,w)},this.validateCell=function(f,m,w,C){let _=s.getCellValidator(m);function O(x){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(x);return}const q=m.visualCol,$=m.visualRow,I=s.getCell($,q,!0);if(I&&I.nodeName!=="TH"){const B=s.rowIndexMapper.getRenderableFromVisualIndex($),X=s.columnIndexMapper.getRenderableFromVisualIndex(q);s.view._wt.getSetting("cellRenderer",B,X,I)}w(x)}fN(_)&&(_=(function(x){return function(D,q){q(x.test(D))}})(_)),Ee(_)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,C),s._registerImmediate(()=>{_.call(m,f,x=>{s&&(x=s.runHooks("afterValidate",x,f,m.visualRow,m.prop,C),m.valid=x,O(x),s.runHooks("postAfterValidate",x,f,m.visualRow,m.prop,C))})})):s._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function Be(f,m,w){return Array.isArray(f)?f:[[f,m,w]]}function je(f,m){const w=s.runHooks("beforeChange",f,m||"edit"),C=f.filter(O=>O!==null);if(w===!1||C.length===0){var _;return(_=s.getActiveEditor())===null||_===void 0||_.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[x,D,,q]=C[O],$=l.propToCol(D);let I;Number.isInteger($)?I=s.getCellMeta(x,$):I={...Object.getPrototypeOf(y),...y},C[O][3]=Cg(q,I)}return C}this.setDataAtCell=function(f,m,w,C){const _=Be(f,m,w),O=[];let x=C,D,q,$;for(D=0,q=_.length;D<q;D++){const[B,X,ae]=_[D];if(typeof _[D]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof X!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");X>=this.countCols()?$=X:$=l.colToProp(X),O.push([B,$,u.getAtCell(this.toPhysicalRow(B),X),ae])}!x&&typeof f=="object"&&(x=m);const I=je(O,x);s.runHooks("afterSetDataAtCell",I,x),Ie(I,x,()=>{Ce(I,x)})},this.setDataAtRowProp=function(f,m,w,C){const _=Be(f,m,w),O=[];let x=C,D,q;for(D=0,q=_.length;D<q;D++){const[I,B,X]=_[D];O.push([I,B,u.getAtCell(this.toPhysicalRow(I),B),X])}!x&&typeof f=="object"&&(x=m);const $=je(O,C);s.runHooks("afterSetDataAtRowProp",$,x),Ie($,x,()=>{Ce($,x)})},this.listen=function(){s&&!s.isListening()&&(Mg.forEach(f=>{s!==f&&f.unlisten()}),Og=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Og=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Og===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(f),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this.populateFromArray=function(f,m,w,C,_,O,x){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const D=typeof C=="number"?s._createCellCoords(C,_):null;return c.populateFromArray(s._createCellCoords(f,m),w,D,O,x)},this.spliceCol=function(f,m,w){for(var C=arguments.length,_=new Array(C>3?C-3:0),O=3;O<C;O++)_[O-3]=arguments[O];return l.spliceCol(f,m,w,..._)},this.spliceRow=function(f,m,w){for(var C=arguments.length,_=new Array(C>3?C-3:0),O=3;O<C;O++)_[O-3]=arguments[O];return l.spliceRow(f,m,w,..._)},this.getSelected=function(){if(L.isSelected())return Dn(L.getSelectedRange(),f=>{let{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedActive=function(){const f=this.getSelectedRangeActive();if(!f)return;const{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRangeActive=function(){return L.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return L.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(f){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];j(L.getSelectedRange(),w=>{if(w.isSingleHeader())return;const C=w.getTopStartCorner(),_=w.getBottomEndCorner();Xe(C.row,_.row,O=>{Xe(C.col,_.col,x=>{this.getCellMeta(O,x).readOnly||m.push([O,x,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=f();return this.resumeExecution(m),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const f=s.view,{width:m,height:w}=f.getLastSize(),{width:C,height:_}=s.rootElement.getBoundingClientRect(),O=C!==m||_!==w;s.runHooks("beforeRefreshDimensions",{width:m,height:w},{width:C,height:_},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===s.rootWindow)&&(f.setLastSize(C,_),f.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:m,height:w},{width:C,height:_},O))},this.updateData=function(f,m){YR(f,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),L.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:T,firstRun:p})},this.loadData=function(f,m){YR(f,w=>{l=w},()=>{T.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),L.refresh(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:T,firstRun:p})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Ee(f))if(s.dataType==="array"){const w=this.countSourceCols();for(let C=0;C<w;C+=1)f(C)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ue(y.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:_p(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,w,C){return jt(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(w,C),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,w,C){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(w,C))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getCopyableSourceData=function(f,m){return u.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(p?s.loadData:s.updateData).bind(this);let C=!1,_,O;if(ue(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');ue(f.rowHeights)&&ue(f.minRowHeights)&&hr("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(_ in f)if(!(_==="data"||_==="language"))if(_==="className")te("className",f.className);else if(_==="tableClassName"&&s.table)te("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ge.getSingleton().isRegistered(_)||ge.getSingleton().isDeprecated(_)){const I=f[_];Ee(I)?(ge.getSingleton().addAsFixed(_,I,s),y[_]=I):Array.isArray(I)&&(ge.getSingleton().add(_,I,s),y[_]=I)}else!m&&jr(f,_)&&(M[_]=f[_]);if(m)s.useTheme(y.themeName||iE(s.rootContainer));else{const I=s.getCurrentThemeName();jr(f,"themeName")&&I!==f.themeName&&s.useTheme(f.themeName)}ou.has(s)&&s.stylesHandler.getThemeName()!==void 0&&ou.delete(s),_n(s)&&!ou.has(s)&&s.stylesHandler.isClassicTheme()&&(ck("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),ou.add(s)),f.data===void 0&&y.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!p&&f.language&&G(f.language);const x=s.countCols(),D=y.columns;if(D&&Ee(D)&&(C=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&T.clearCache(),x>0)for(_=0,O=0;_<x;_++){if(D){const I=C?D(_):D[O];I&&T.updateColumnMeta(O,I)}O+=1}ue(f.cell)&&Me(f.cell,I=>{s.setCellMetaObject(I.row,I.col,I)}),s.runHooks("afterCellMetaReset");let q=s.rootElement.style.height;q!==""&&(q=parseInt(s.rootElement.style.height,10)),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let $=f.height;if(typeof f.height<"u")if(Ee($)&&($=$()),$=s.runHooks("beforeHeightChange",$),$===null){const I=s.rootElement.getAttribute("data-initialstyle");I&&(I.indexOf("height")>-1||I.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",I):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else $!==void 0&&(s.rootElement.style.height=isNaN($)?`${$}`:`${$}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let I=f.width;Ee(I)&&(I=I()),I=s.runHooks("beforeWidthChange",I),s.rootElement.style.width=isNaN(I)?`${I}`:`${I}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!p&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(q===""||$===""||$===void 0)&&q!==$&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedRangeActive();if(y.getValue){if(Ee(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f.highlight.row][y.getValue]}else if(f)return s.getDataAtCell(f.highlight.row,f.highlight.col);return null},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,w,C,_){c.alter(f,m,w,C,_)},this.getCell=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,_=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return _===null||C===null||_===void 0||C===void 0?null:s.view.getCellAtCoords(s._createCellCoords(_,C),w)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:w,col:C}=m;let _=w,O=C;return w>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(w)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),s._createCellCoords(_,O)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],w=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let _=0;_<w[C].length;_+=1)m.push(w[C][_]);return m},this.getDataAtProp=function(f){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let _=0;_<w[C].length;_+=1)m.push(w[C][_]);return m},this.getSourceData=function(f,m,w,C){let _;return f===void 0?_=u.getData():_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,C)),_},this.getSourceDataArray=function(f,m,w,C){let _;return f===void 0?_=u.getData(!0):_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,C),!0),_},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,w,C){const _=Be(f,m,w),O=this.hasHook("afterSetSourceDataAtCell"),x=[],D=($,I)=>{const B=this.toVisualRow($),X=this.toVisualColumn(I);return Number.isInteger(X)?this.getCellMeta(B,X):{...Object.getPrototypeOf(y),...y}};O&&j(_,$=>{let[I,B,X]=$;const ae=Cg(X,D(I,B));x.push([I,B,u.getAtCell(I,B),ae])}),j(_,$=>{let[I,B,X]=$;const ae=Cg(X,D(I,B));u.setAtCell(I,B,ae)}),O&&this.runHooks("afterSetSourceDataAtCell",x,C),this.render();const q=s.getActiveEditor();q&&ue(q.refreshValue)&&q.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,w,C){const _=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,w,C],[O,x]=_;let[,,D,q]=_,$=null,I=null;D===void 0&&(D=O),q===void 0&&(q=x);let B="mixed";return Xe(Math.max(Math.min(O,D),0),Math.max(O,D),X=>{let ae=!0;return Xe(Math.max(Math.min(x,q),0),Math.max(x,q),ye=>(I=this.getCellMeta(X,ye).type,$?ae=$===I:$=I,ae)),B=ae?I:"mixed",ae}),B},this.removeCellMeta=function(f,m,w){const[C,_]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=T.getCellMetaKeyValue(C,_,w);s.runHooks("beforeRemoveCellMeta",f,m,w,O)!==!1&&(T.removeCellMeta(C,_,w),s.runHooks("afterRemoveCellMeta",f,m,w,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,C=new Array(w>2?w-2:0),_=2;_<w;_++)C[_-2]=arguments[_];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&T.removeRow(this.toPhysicalRow(f),m),C.length>0&&j(C.reverse(),O=>{T.createRow(this.toPhysicalRow(f)),j(O,(x,D)=>this.setCellMetaObject(f,D,x))}),s.render()},this.setCellMetaObject=function(f,m,w){typeof w=="object"&&Me(w,(C,_)=>{this.setCellMeta(f,m,_,C)})},this.setCellMeta=function(f,m,w,C){if(s.runHooks("beforeSetCellMeta",f,m,w,C)===!1)return;let O=f,x=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(x=this.toPhysicalColumn(m)),T.setCellMeta(O,x,w,C),s.runHooks("afterSetCellMeta",f,m,w,C)},this.getCellsMeta=function(){return T.getCellsMeta()},this.getCellMeta=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(f),_=this.toPhysicalColumn(m);return C===null&&(C=f),_===null&&(_=m),T.getCellMeta(C,_,{visualRow:f,visualColumn:m,...w})},this.getColumnMeta=function(f){return T.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return T.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof w=="string"?FC(w):jt(w)?FC("text"):w},this.getCellEditor=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof w=="string"?RC(w):jt(w)?RC("text"):w},this.getCellValidator=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof w=="string"?hL(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,w){const C=new tt;f&&(C.onQueueEmpty=f);let _=s.countRows()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(w!==void 0&&w.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),s.validateCell(s.getDataAtCell(_,O),s.getCellMeta(_,O),x=>{if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}_-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,w=f;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],Xe(s.countRows()-1,C=>{m.push(s.getRowHeader(C))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Ee(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",f);if(w===void 0){const D=[],q=s.countCols();for(let $=0;$<q;$++)D.push(s.getColHeader($));return D}let C=y.colHeaders;const _=function(D){const q=[],$=s.countCols();let I=0;for(;I<$;I++)Ee(y.columns)&&y.columns(I)&&q.push(I);return q[D]},O=s.toPhysicalColumn(w),x=_(O);return y.colHeaders===!1?C=null:y.columns&&Ee(y.columns)&&y.columns(x)&&y.columns(x).title?C=y.columns(x).title:y.columns&&y.columns[O]&&y.columns[O].title?C=y.columns[O].title:Array.isArray(y.colHeaders)&&y.colHeaders[O]!==void 0?C=y.colHeaders[O]:Ee(y.colHeaders)?C=y.colHeaders(O):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(C=pW(w)),C=s.runHooks("modifyColumnHeaderValue",C,f,m),C},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=Number.parseInt(m,10))}return m},this.getColWidth=function(f,m){let w=s._getColWidthFromSettings(f);return w=s.runHooks("modifyColWidth",w,f,m),w===void 0&&(w=Np),w},this._getRowHeightFromSettings=function(f){var m;const w=s.stylesHandler.getDefaultRowHeight(f);let C=(m=y.rowHeights)!==null&&m!==void 0?m:y.minRowHeights;if(C!=null){switch(typeof C){case"object":C=C[f];break;case"function":C=C(f);break}typeof C=="string"&&(C=Number.parseInt(C,10))}return C!=null&&C<w?w:C},this.getRowHeight=function(f,m){let w=s._getRowHeightFromSettings(f);return w=s.runHooks("modifyRowHeight",w,f,m),w},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return kC(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return kC(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,w,C){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return jt(f)||jt(m)?!1:this.selectCells([[f,m,w,C]],_,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const C=L.selectCells(f);return C&&w&&s.listen(),g.resume(),C},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return L.selectColumns(f,m,w)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return L.selectRows(f,m,w)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),L.selectAll(f,m,w)};const Pe=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:C,col:_,considerHiddenIndexes:O}=f??{};let x=C,D=_;if(Ee(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const B=Number.isInteger(C)&&C>=0,X=Number.isInteger(_)&&_>=0,ae=B?Pe(this.rowIndexMapper,C):void 0,ye=X?Pe(this.columnIndexMapper,_):void 0;if(ae===null||ye===null)return!1;x=B?s.rowIndexMapper.getRenderableFromVisualIndex(ae):C,D=X?s.columnIndexMapper.getRenderableFromVisualIndex(ye):_}const q=Number.isInteger(x),$=Number.isInteger(D);let I=!1;return q&&x>=0&&$&&D>=0?I=s.view.scrollViewport(s._createCellCoords(x,D),f.horizontalSnap,f.verticalSnap):q&&x>=0&&($&&D<0||!$)?I=s.view.scrollViewportVertically(x,f.verticalSnap):$&&D>=0&&(q&&x<0||!q)&&(I=s.view.scrollViewportHorizontally(D,f.horizontalSnap)),Ee(m)&&(I?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),I},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Ee(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeActive(),w=this.scrollViewportTo(m.toObject());return w?this.view.render():Ee(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),w},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,_n(this)&&(rz(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),P.clear(),T.clearCache(),Mg.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&xs(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),H.getItems().forEach(f=>{let[,m]=f;m.destroy()}),H.clear(),s.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(s),Me(s,(f,m,w)=>{Ee(f)?w[m]=Ir(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function Ir(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return H.getItem(Mc(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:H.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m,w){ge.getSingleton().add(f,m,s,w)},this.hasHook=function(f){return ge.getSingleton().has(f,s)||ge.getSingleton().has(f)},this.addHookOnce=function(f,m,w){ge.getSingleton().once(f,m,s,w)},this.removeHook=function(f,m){ge.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,w,C,_,O,x){return ge.getSingleton().run(s,f,m,w,C,_,O,x)},this.getTranslatedPhrase=function(f,m){return OM(y.language,f,m)},this.toHTML=()=>AC(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",AC(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!p;this.stylesHandler.useTheme(f);const w=this.stylesHandler.getThemeName();m||(s.render(),s.scrollViewportTo(0,0),iE(this.rootContainer)&&(Oe(this.rootContainer,/ht-theme-.*/g),w&&Z(this.rootContainer,w))),this.runHooks("afterSetTheme",w,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){j(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){j(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return h};const He=Gj({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&He.releasePressedKeys()}),this.getShortcutManager=function(){return He},d=new NB(s);const Dt=_n(this)?AB(s):null;this.getFocusManager=function(){return d},this.getFocusScopeManager=function(){if(!_n(s))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return Dt},C0().forEach(f=>{const m=Dp(f);H.addItem(f,new m(this))}),Wj(s),_n(this)&&Bj(s),He.setActiveContextName("grid"),ge.getSingleton().run(s,"construct")}function sE(t,e,r){t.addEventListener(e,r,!1)}function aE(t,e,r){t.removeEventListener(e,r,!1)}function su(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function nz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=su(s).fontSize,o.style.fontFamily=su(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=su(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((d=su(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+g+p+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>v?b.width=`${r.minWidth}px`:v>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${v}px`;const E=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>E?b.height=`${r.minHeight}px`:r.maxHeight<E?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(sE(s,"input",a),sE(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){aE(s,"input",a),aE(s,"keydown",l)}}}function lE(t,e){const r=QN(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}u0(e,i)}function oo(t,e,r){return(e=iz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iz(t){var e=oz(t,"string");return typeof e=="symbol"?e:e+""}function oz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sz="ht_editor_visible",au="ht_editor_hidden",uE="textEditor",az="text";class lz extends Pw{static get EDITOR_TYPE(){return az}constructor(e){super(e),oo(this,"eventManager",new Bi(this)),oo(this,"autoResize",nz(this.hot.rootDocument)),oo(this,"TEXTAREA",void 0),oo(this,"textareaStyle",void 0),oo(this,"TEXTAREA_PARENT",void 0),oo(this,"textareaParentStyle",void 0),oo(this,"layerClass",void 0),this.eventManager=new Bi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Ou(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==ct.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===ct.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),u0(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Te(this.TEXTAREA,[["data-hot-input",""],Bo(-1)]),Z(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Z(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&Oe(this.TEXTAREA_PARENT,this.layerClass),Z(this.TEXTAREA_PARENT,au),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){zN()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Oe(this.TEXTAREA_PARENT,this.layerClass),Z(this.TEXTAREA_PARENT,au)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Xe(e.length-1,n=>{const i=e[n];if(ve(i,"handsontableEditor"))return r=!0,!1}),ve(this.TEXTAREA_PARENT,au)&&Oe(this.TEXTAREA_PARENT,au),r?(this.layerClass=sz,Z(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Z(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==ct.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){e0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===ct.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===ct.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>ue(this.hot.getSelected()),group:uE},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;lE(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;lE(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(uE)}}const uz="base",cz="htTextEllipsis";function zM(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Z(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(tC())):a&&c.push(tC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(rC())):(u.push(s.invalidCellClassName),a&&c.push(rC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(cz),Oe(e,u),Z(e,l),pl(e,c),Te(e,h)}zM.RENDERER_TYPE=uz;const hz="text";function UM(t,e,r,n,i,o,s){zM.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ep(a),s.trimWhitespace&&(a=a.trim()),wl(e,a)}UM.RENDERER_TYPE=hz;const dz="text",fz={CELL_TYPE:dz,editor:lz,renderer:UM};B$(fz);pn.editors={BaseEditor:Pw};function pn(t,e){const r=new jM(t,e||{},Xp);return r.init(),r}pn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new jM(t,e,Xp)};pn.DefaultSettings=AM();pn.hooks=ge.getSingleton();pn.CellCoords=Mo;pn.CellRange=yl;pn.packageName="handsontable";pn.buildDate="20/11/2025 13:26:54";pn.version="16.2.0";pn.languages={dictionaryKeys:XW,getLanguageDictionary:_M,getLanguagesDictionaries:t$,registerLanguageDictionary:TM,getTranslatedPhrase:OM};function gz(t,e){YM(t,e),e.add(t)}function ss(t,e,r){return(e=mz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mz(t){var e=pz(t,"string");return typeof e=="symbol"?e:e+""}function pz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cE(t,e,r){YM(t,e),e.set(t,r)}function YM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lu(t,e,r){return t.set(xw(t,e),r),r}function Ze(t,e){return t.get(xw(t,e))}function xw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const hE=new Map([["plugin",nL],["cell-type",xM],["editor",w0],["renderer",R0],["validator",E0]]),wz=Symbol("mainSetting"),vz="base",uu=[];let so=null;var it=new WeakMap,ao=new WeakMap,dE=new WeakSet;class Wc{static get PLUGIN_KEY(){return vz}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){gz(this,dE),cE(this,it,null),ss(this,"eventManager",new Bi(this)),ss(this,"pluginName",null),ss(this,"pluginsInitializedCallbacks",[]),ss(this,"isPluginsReady",!1),ss(this,"enabled",!1),ss(this,"initialized",!1),cE(this,ao,{}),pi(this,"hot",e,{writable:!1}),so=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!hE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);hE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");uu.push(o)}}if(so||(so=C0()),so.indexOf(this.pluginName)>=0&&so.splice(so.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),so.length===0){if(uu.length>0){const i=[`${uu.join(`
`)}
`,"You have to import and register them manually."].join("");throw uu.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var r=this;const n=this.constructor.DEFAULT_SETTINGS,i=this.constructor.SETTINGS_VALIDATORS;if(e===void 0)return st(Ze(it,this))?_u(Ze(it,this),n):Ze(it,this);let o;if((Array.isArray(Ze(it,this))||st(Ze(it,this)))&&n[wz]===e)if(Array.isArray(Ze(it,this)))o=Ze(it,this);else{var s;o=(s=Ze(it,this)[e])!==null&&s!==void 0?s:n[e]}else if(e.includes(".")){const a=lm(Ze(it,this),e),l=lm(n,e);st(a)?o=_u(a,l):o=a!==void 0?a:l}else st(Ze(it,this))?o=_u(Ze(it,this),n)[e]:o=n[e];if(typeof o=="function"&&i&&typeof i=="object"){const a=i[e];if(a&&typeof a=="function")return function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];const h=o(...u);if(a(h)===!1){const g=u.map(v=>typeof v=="string"?`"${v}"`:"").join(", "),p=u.length>0?g:"";hr(`${r.pluginName} Plugin: "${e}" function (${p}) result                is not valid and will be ignored.`);return}return h}}return o}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){hr(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return lu(it,this,e),Ze(it,this)}return r&&typeof r=="object"&&typeof e=="object"?((Ze(it,this)===null||typeof Ze(it,this)!="object")&&lu(it,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){hr(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}Ze(it,this)[n]=e[n]}),Ze(it,this)):(lu(it,this,e),e)}addHook(e,r,n){Ze(ao,this)[e]=Ze(ao,this)[e]||[];const i=Ze(ao,this)[e];this.hot.addHook(e,r,n),i.push(r),Ze(ao,this)[e]=i}removeHooks(e){j(Ze(ao,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Ze(ao,this);Me(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){j(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=xw(dE,this,yz).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;lu(it,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Me(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function yz(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function lo(t,e,r){return(e=bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bz(t){var e=Sz(t,"string");return typeof e=="symbol"?e:e+""}function Sz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cz{constructor(e){lo(this,"hot",null),lo(this,"container",null),lo(this,"injected",!1),lo(this,"rows",[]),lo(this,"columns",[]),lo(this,"samples",null),lo(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),j(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),j(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{j(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{j(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{j(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),j(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{j(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Z(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Z(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function Sa(t,e,r){return(e=Rz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rz(t){var e=Ez(t,"string");return typeof e=="symbol"?e:e+""}function Ez(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aw{static get SAMPLE_COUNT(){return 3}constructor(e){Sa(this,"samples",null),Sa(this,"dataFactory",null),Sa(this,"customSampleCount",null),Sa(this,"allowDuplicates",!1),Sa(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Aw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Xe(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Xe(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:st(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Ep(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function Tz(t,e){qM(t,e),e.add(t)}function Ig(t,e,r){qM(t,e),e.set(t,r)}function qM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ca(t,e,r){return(e=_z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _z(t){var e=Oz(t,"string");return typeof e=="symbol"?e:e+""}function Oz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xi(t,e){return t.get(ir(t,e))}function nc(t,e,r){return t.set(ir(t,e),r),r}function ir(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("modifyAutoColumnSizeSeed");const Pg="autoColumnSize",Mz=10,Iz="autoColumnSize";var Dw=new WeakMap,ws=new WeakMap,Ns=new WeakMap,br=new WeakSet;class qa extends Wc{static get PLUGIN_KEY(){return Pg}static get PLUGIN_PRIORITY(){return Mz}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Tz(this,br),Ca(this,"ghostTable",new Cz(this.hot)),Ca(this,"samplesGenerator",new Aw((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Ca(this,"inProgress",!1),Ca(this,"measuredColumns",0),Ca(this,"columnWidthsMap",new Dc),Ig(this,Dw,!1),Ig(this,ws,[]),Ig(this,Ns,[]),this.hot.columnIndexMapper.registerMap(Iz,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>ir(br,this,fE).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[Pg]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ir(br,e,xz).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ir(br,e,Az).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return ir(br,e,Nz).call(e,...i)}),this.addHook("beforeRender",()=>ir(br,this,Hz).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>ir(br,this,Dz).call(this)),super.enablePlugin()}updatePlugin(){nc(Ns,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>ir(br,this,fE).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Xe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&ir(br,this,GM).call(this,s,o)}),this.ghostTable.columns.length&&(ir(br,this,KM).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){sC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+qa.CALCULATION_STEP,i)},e,r),n=n+qa.CALCULATION_STEP+1,n<i?o=um(s):(sC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Pg];let r=qa.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return st(e)&&(r=e.syncLimit,yN(r)?r=qk(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Np))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=xi(ws,this).length;return(s-1<o||xi(ws,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?xi(ws,this).push(i):xi(ws,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Pz(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||ir(br,this,GM).call(this,r,e))}),this.ghostTable.columns.length&&(ir(br,this,KM).call(this),this.ghostTable.clean())}function GM(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function KM(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function Hz(){this.calculateVisibleColumnsWidth(),this.inProgress||(ir(br,this,Pz).call(this,xi(Ns,this)),nc(Ns,this,[]))}function xz(t,e){e||this.recalculateAllColumnsWidth()}function Az(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);xi(Ns,this).push(...e)}function fE(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function Dz(){nc(ws,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),nc(Dw,this,!0)}function Nz(t){if(!xi(Dw,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);xi(Ns,this).push(...e)}function kz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Lz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function uo(t,e){const r={};return j(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function Oi(t,e,r,n,i){j(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Fz(s,a,e,r,n,i)})})}function Fz(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=kz(s.className,n):a=Lz(s.className,n)),o(t,e,"className",a)}function Vz(t){return`<span class="selected">â</span>${t}`}function Hg(t,e){let r=!1;return Array.isArray(t)&&j(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function XM(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const Et="---------";function Wz(){return{name:Et}}const sn="alignment";function $z(){return{key:sn,name(){return this.getTranslatedPhrase(gw)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${sn}:left`,name(){return this.getTranslatedPhrase(mw)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:center`,name(){return this.getTranslatedPhrase(pw)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:right`,name(){return this.getTranslatedPhrase(ww)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:justify`,name(){return this.getTranslatedPhrase(vw)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Et},{key:`${sn}:top`,name(){return this.getTranslatedPhrase(yw)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:middle`,name(){return this.getTranslatedPhrase(bw)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${sn}:bottom`,name(){return this.getTranslatedPhrase(Sw)},callback(){const t=this.getSelectedRange(),e=uo(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Oi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Nw="clear_column";function Bz(){return{key:Nw,name(){return this.getTranslatedPhrase(lw)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const $c="col_left";function jz(){return{key:$c,name(){return this.getTranslatedPhrase(rw)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Bc="col_right";function zz(){return{key:Bc,name(){return this.getTranslatedPhrase(nw)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const jc="make_read_only";function Uz(){return{key:jc,checkable:!0,ariaChecked(){return Hg(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Zu)},name(){let t=this.getTranslatedPhrase(Zu);return Hg(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Vz(t)),t},callback(){const t=this.getSelectedRange(),e=Hg(t,(r,n)=>this.getCellMeta(r,n).readOnly);j(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const zc="redo";function Yz(){return{key:zc,name(){return this.getTranslatedPhrase(aw)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Uc="remove_col";function qz(){return{key:Uc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(ow,e)},callback(){this.alter("remove_col",I$(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Yc="remove_row";function Gz(){return{key:Yc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(iw,e)},callback(){this.alter("remove_row",P$(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const qc="row_above";function Kz(){return{key:qc,name(){return this.getTranslatedPhrase(ew)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Gc="row_below";function Xz(){return{key:Gc,name(){return this.getTranslatedPhrase(tw)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const tl="no_items";function Zz(){return{key:tl,name(){return this.getTranslatedPhrase(Qp)},disabled:!0,isCommand:!1}}const Kc="undo";function Jz(){return{key:Kc,name(){return this.getTranslatedPhrase(sw)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Qz=[qc,Gc,$c,Bc,Nw,Yc,Uc,Kc,zc,jc,sn,Et,tl],eU={[Et]:Wz,[tl]:Zz,[qc]:Kz,[Gc]:Xz,[$c]:jz,[Bc]:zz,[Nw]:Bz,[Yc]:Gz,[Uc]:qz,[Kc]:Jz,[zc]:Yz,[jc]:Uz,[sn]:$z};function ZM(){const t={};return Me(eU,(e,r)=>{t[r]=e()}),t}function xg(t,e,r){return(e=tU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tU(t){var e=rU(t,"string");return typeof e=="symbol"?e:e+""}function rU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nU{constructor(e){xg(this,"hot",void 0),xg(this,"commands",{}),xg(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=iU(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||jr(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),j(u,c=>c.apply(this.hot,n))}}function iU(t,e){let r;return j(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function Ag(t,e,r){return(e=oU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oU(t){var e=sU(t,"string");return typeof e=="symbol"?e:e+""}function sU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aU{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ag(this,"hot",void 0),Ag(this,"predefinedItems",ZM()),Ag(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Me(e,(n,i)=>{let o="";n.name===Et?(r[Et]=n,o=Et):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return lU(e,this.defaultOrderPattern,this.predefinedItems)}}function lU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),st(i)?Me(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),st(o)?$i(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):j(i,(o,s)=>{let a=r[o];!a&&Qz.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),st(o)&&$i(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function Ci(t,e,r){return(e=uU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uU(t){var e=cU(t,"string");return typeof e=="symbol"?e:e+""}function cU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hU{constructor(e,r){Ci(this,"top",void 0),Ci(this,"topRelative",void 0),Ci(this,"left",void 0),Ci(this,"leftRelative",void 0),Ci(this,"scrollTop",void 0),Ci(this,"scrollLeft",void 0),Ci(this,"cellHeight",void 0),Ci(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Ra(t,e,r){dU(t,e),e.set(t,r)}function dU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ne(t,e){return t.get(JM(t,e))}function cu(t,e,r){return t.set(JM(t,e),r),r}function JM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Wt=new WeakMap,Jt=new WeakMap,Qt=new WeakMap,Dg=new WeakMap,as=new WeakMap;class fU{constructor(e){Ra(this,Wt,void 0),Ra(this,Jt,void 0),Ra(this,Qt,void 0),Ra(this,Dg,!1),Ra(this,as,{above:0,below:0,left:0,right:0}),cu(Dg,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ne(as,this)[e]=r,this}setElement(e){return cu(Wt,this,e),this}setParentElement(e){return cu(Jt,this,e),this}updatePosition(e){cu(Qt,this,new hU(e,ne(Wt,this).ownerDocument.defaultView)),ne(Dg,this)?(ne(Qt,this).fitsBelow(ne(Wt,this))?this.setPositionBelowCursor():ne(Qt,this).fitsAbove(ne(Wt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ne(Wt,this).dir==="rtl"?ne(Qt,this).fitsOnLeft(ne(Wt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ne(Qt,this).fitsOnRight(ne(Wt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ne(as,this).above+ne(Qt,this).top-ne(Wt,this).offsetHeight;if(ne(Jt,this)){const n=ne(Jt,this).ownerDocument.defaultView.getComputedStyle(ne(Jt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(Qt,this).top+ne(Qt,this).cellHeight-ne(Wt,this).scrollHeight+i+o}ne(Wt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ne(as,this).below+ne(Qt,this).top+1;if(ne(Jt,this)){const n=ne(Jt,this).ownerDocument.defaultView.getComputedStyle(ne(Jt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(Qt,this).top-i-o}ne(Wt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ne(Qt,this).left;if(ne(Jt,this)){const r=ne(Jt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Jt,this).querySelector(".htCore")).borderRightWidth,10);e+=ne(Qt,this).cellWidth+n}else e+=ne(as,this).right;ne(Wt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ne(as,this).left+ne(Qt,this).left-ne(Wt,this).offsetWidth;if(ne(Jt,this)){const r=ne(Jt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Jt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ne(Wt,this).style.left=`${e}px`}}function gU(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ne(e,-1,v()-1);function a(E,S){const T=v()-1;return E<0&&(E=T),E>T&&(E=0),o.has(E)?-1:(o.add(E),n(E,!1)===!1&&(E=a(S===1?++E:--E,S)),E)}function l(E){E>-1&&E<v()&&n(E,!0)!==!1&&(s=E)}function u(E){E>-1&&E<v()&&(s=E)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function g(){v()>0&&(o.clear(),s=a(++s,1))}function p(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(r(),0)}function b(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:p,getSize:v,clear:b}}function mU(t){return Dn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Tm(t){return jr(t,"submenu")}function _m(t){return new RegExp(Et,"i").test(t.name)}function Au(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function gE(t){return jr(t,"disableSelection")}function pU(t){return ve(t,"htSeparator")}function wU(t){return ve(t,"htSubmenu")}function vU(t){return ve(t,"htDisabled")}function yU(t){return ve(t,"htSelectionDisabled")}function bU(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function QM(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function SU(t,e){let r=t.slice(0);return r.reverse(),r=QM(r,e),r.reverse(),r}function CU(t){const e=[];return j(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function RU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Et,r=t.slice(0);return r=QM(r,e),r=SU(r,e),r=CU(r),r}function EU(t){return t.checkable===!0}function TU(t){return gU({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||pU(n)||vU(n)||yU(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function _U(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const eI="menu",mE=eI;function OU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(_U(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:eI})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(p=>h.removeShortcutsByKeys(p))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${mE}:${u}`:mE}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function MU(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(xs(r),Z(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Au(a,t)&&!gE(a)&&!_m(a);Te(r,[...EU(a)?[ON(),zu(c),AN(h)]:[_N(),zu(u)],...d?[Bo(-1)]:[],...Au(a,t)?[HN()]:[],...Tm(a)?[Tu(!1)]:[]])}r.className="",r.appendChild(l),_m(a)?Z(r,"htSeparator"):typeof a.renderer=="function"?(Z(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):o0(l,u),Au(a,t)?Z(r,"htDisabled"):gE(a)?Z(r,"htSelectionDisabled"):Tm(a)&&Z(r,"htSubmenu")}}function Ng(t,e,r){IU(t,e),e.set(t,r)}function IU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(t,e,r){return(e=PU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PU(t){var e=HU(t,"string");return typeof e=="symbol"?e:e+""}function HU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kg(t,e,r){return t.set(tI(t,e),r),r}function Ri(t,e){return t.get(tI(t,e))}function tI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pE=215;var ls=new WeakMap,hu=new WeakMap,du=new WeakMap;class Xc{get tableBorderWidth(){return Ri(du,this)===void 0&&this.hotMenu&&kg(du,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Ri(du,this)}constructor(e,r){var n=this;Tn(this,"hot",void 0),Tn(this,"options",void 0),Tn(this,"eventManager",new Bi(this)),Tn(this,"container",void 0),Tn(this,"positioner",void 0),Tn(this,"hotMenu",null),Tn(this,"hotSubMenus",{}),Tn(this,"parentMenu",void 0),Tn(this,"menuItems",null),Tn(this,"origOutsideClickDeselects",null),Ng(this,ls,void 0),Ng(this,hu,void 0),Ng(this,du,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:pE,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new fU(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(Oe(this.options.container,/ht-theme-.*/g),Z(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Oo(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ri(ls,this)}getKeyboardShortcutsCtrl(){return Ri(hu,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=f0(a=>this.openSubMenu(a),300),r=this.options.minWidth||pE;let n=!1,i=Rp(this.menuItems,a=>(a.key===tl&&(n=!0),bU(a,this.hot)));if(i.length<1&&!n)i.push(ZM()[tl]);else if(i.length===0)return;i=RU(i,Et);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:MU(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Ri(ls,this).setCurrentPage(l.row):Ri(ls,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),aC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!aC()||!qu(a))&&o&&this.hasSelectedItem()&&(Hi()||Mp()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),kg(ls,this,TU(this.hotMenu)),kg(hu,this,OU(this)),Ri(hu,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ri(ls,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Te(n,[Tu(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!wU(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Xc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Te(r,[Tu(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Te(i,[Tu(!1)])}}closeAllSubMenus(){j(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?mU(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||_m(e)||Au(e,this.hot)||Tm(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=$o(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?cr(this.hotMenu.getCell(u,0)):0;return a+(l.name===Et?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Ee(n)&&(n=n.call(this.hot),n===null||jt(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),Z(i,`htMenu handsontable ${this.options.className}`),n&&Z(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Te(this.hotMenu.rootElement,[TN(),Bo(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!_s(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!_s(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&_s(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Qe(Xc,Fn);function xU(t,e){AU(t,e),e.add(t)}function AU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lg(t,e,r){return(e=DU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DU(t){var e=NU(t,"string");return typeof e=="symbol"?e:e+""}function NU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Na="contextMenu",kU=70,wE=Na;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var Ea=new WeakSet;class Zc extends Wc{constructor(){super(...arguments),xU(this,Ea),Lg(this,"commandExecutor",new nU(this.hot)),Lg(this,"itemsFactory",null),Lg(this,"menu",null)}static get PLUGIN_KEY(){return Na}static get PLUGIN_PRIORITY(){return kU}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[qc,Gc,Et,$c,Bc,Et,Yc,Uc,Et,Kc,zc,Et,jc,Et,sn]}isEnabled(){return!!this.hot.getSettings()[Na]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Na];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Xc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>fu(Ea,this,FU).call(this)),this.menu.addLocalHook("afterOpen",()=>fu(Ea,this,VU).call(this)),this.menu.addLocalHook("afterClose",()=>fu(Ea,this,WU).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>fu(Ea,this,LU).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=XM(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:wE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wE)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),Me(n,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new aU(this.hot,Zc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Na],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),j(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function LU(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=XM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function FU(){this.hot.runHooks("beforeContextMenuShow",this)}function VU(){this.hot.runHooks("afterContextMenuShow",this)}function WU(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Zc.SEPARATOR={name:Et};function $U(t){return{key:"copy",name(){return this.getTranslatedPhrase(uw)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function BU(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?Ne(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(dw,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function jU(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?Ne(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(hw,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function zU(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?Ne(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(cw,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function UU(t){return{key:"cut",name(){return this.getTranslatedPhrase(fw)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class YU{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class qU{constructor(){this.clipboardData=new YU}preventDefault(){}composedPath(){return[]}}function GU(t,e){rI(t,e),e.add(t)}function us(t,e,r){rI(t,e),e.set(t,r)}function rI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(Cs(t,e))}function cs(t,e,r){return t.set(Cs(t,e),r),r}function Cs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ei=new WeakMap,Fg=new WeakMap,Ta=new WeakMap,Om=new WeakMap,Mm=new WeakMap,_a=new WeakMap,Oa=new WeakSet;class KU{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;GU(this,Oa),us(this,Ei,void 0),us(this,Fg,void 0),us(this,Ta,void 0),us(this,Om,void 0),us(this,Mm,void 0),us(this,_a,void 0),cs(Fg,this,r),cs(Ta,this,n),cs(Om,this,i),cs(Mm,this,o),cs(_a,this,s)}setSelectedRange(e){cs(Ei,this,e)}getCellsRange(){if($t(Fg,this).call(this)===0||$t(Ta,this).call(this)===0)return null;const{row:e,col:r}=$t(Ei,this).getTopStartCorner(),{row:n,col:i}=$t(Ei,this).getBottomEndCorner(),o=Cs(Oa,this,XU).call(this,e,n),s=Cs(Oa,this,Vg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if($t(Ta,this).call(this)===0||$t(_a,this).call(this)===0)return null;const{col:e}=$t(Ei,this).getTopStartCorner(),{col:r}=$t(Ei,this).getBottomEndCorner(),n=Cs(Oa,this,Vg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if($t(Ta,this).call(this)===0||$t(_a,this).call(this)===0)return null;const{col:e}=$t(Ei,this).getTopStartCorner(),{col:r}=$t(Ei,this).getBottomEndCorner(),n=Cs(Oa,this,Vg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-$t(_a,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Vg(t,e){return Math.min(e,Math.max(t+$t(Mm,this).call(this)-1,t))}function XU(t,e){return Math.min(e,Math.max(t+$t(Om,this).call(this)-1,t))}function nI(t){const e=[],r=[];return j(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Xe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Xe(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function ZU(t,e){iI(t,e),e.add(t)}function Ti(t,e,r){iI(t,e),e.set(t,r)}function iI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(t,e,r){return(e=JU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JU(t){var e=QU(t,"string");return typeof e=="symbol"?e:e+""}function QU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nr(t,e){return t.get(xt(t,e))}function nn(t,e,r){return t.set(xt(t,e),r),r}function xt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");const Wg="copyPaste",eY=80,tY=["fragmentSelection"],oI="application/ht-source-data-json-html",vE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Im=new WeakMap,Pm=new WeakMap,Hm=new WeakMap,hs=new WeakMap,gu=new WeakMap,mu=new WeakMap,ds=new WeakMap,ic=new WeakMap,Bt=new WeakSet;class rY extends Wc{constructor(){super(...arguments),ZU(this,Bt),Ma(this,"columnsLimit",1/0),Ma(this,"rowsLimit",1/0),Ma(this,"pasteMode","overwrite"),Ma(this,"uiContainer",this.hot.rootDocument.body),Ti(this,Im,!1),Ti(this,Pm,!1),Ti(this,Hm,!1),Ti(this,hs,"cells-only"),Ti(this,gu,!1),Ti(this,mu,!1),Ti(this,ds,new KU({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ti(this,ic,!1),Ma(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Wg}static get SETTING_KEYS(){return[Wg,...tY]}static get PLUGIN_PRIORITY(){return eY}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Wg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),nn(Im,this,this.getSetting("copyColumnHeaders")),nn(Pm,this,this.getSetting("copyColumnGroupHeaders")),nn(Hm,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>xt(Bt,this,oY).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return xt(Bt,n,sY).call(n,...o)}),this.addHook("afterSelectionEnd",()=>xt(Bt,this,aY).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Op()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return xt(Bt,n,lY).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return xt(Bt,n,uY).call(n,...o)}),this.addHook("afterSelection",()=>xt(Bt,this,cY).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";nn(hs,this,e),nn(gu,this,!0),xt(Bt,this,yE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){nn(mu,this,!0),xt(Bt,this,yE).call(this,"cut")}getRangedCopyableData(e){return Ju(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:o}=nI(e);return j(i,s=>{const a=[];j(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=r?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);r&&st(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new qU;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}nr(ds,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);nr(hs,this)==="column-headers-only"?r.set("headers",nr(ds,this).getMostBottomColumnHeadersRange()):(nr(hs,this)==="with-column-headers"?r.set("headers",nr(ds,this).getMostBottomColumnHeadersRange()):nr(hs,this)==="with-column-group-headers"&&r.set("headers",nr(ds,this).getAllColumnHeadersRange()),r.set("cells",nr(ds,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner();let h=a,d=l,g=a,p=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:b,visualRow:E}=this.hot.getCellMeta(h,l);if(h=E+1,b===!0)continue;g=E,d=l;const S=[],T=s.length%i;for(;S.length<o||d<=c;){var v;const{skipColumnOnPaste:y,visualCol:M}=this.hot.getCellMeta(E,d),H=this.hot.getSourceDataAtCell(E,d),P=S.length%o;if(d=M+1,y===!0)continue;p=M;const A=r==null||(v=r[T])===null||v===void 0?void 0:v[P];let F=e[T][P];if(r&&vN(A)){const W=JSON.parse(A);(st(H)||H===null)&&(F=W)}S.push(F)}s.push(S)}return nn(ic,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,p]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!nr(gu,this)||this.isEditorOpened()||Ro(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ou(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),nn(gu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=xt(Bt,this,nY).call(this,this.copyableRanges);this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(xt(Bt,this,bE).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),nn(hs,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!nr(mu,this)||this.isEditorOpened()||Ro(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ou(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),nn(mu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(xt(Bt,this,bE).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Ro(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ou(r,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(oI);h&&(s=NC(h,this.hot.rootDocument).data);const d=Y_(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=NC(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=N$(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function yE(t){if(Op()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&ik(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function nY(t){const{rows:e}=nI(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function iY(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&h0(n)}}}function sI(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&d0(n)}}}function bE(t,e,r){const n=Ju(e);if(t&&t.clipboardData){const i=DC(e),o=DC(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[vE,i].join("")),t.clipboardData.setData(oI,[vE,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function oY(t){t.items.push({name:"---------"},$U(this)),nr(Im,this)&&t.items.push(zU(this)),nr(Pm,this)&&t.items.push(jU(this)),nr(Hm,this)&&t.items.push(BU(this)),t.items.push(UU(this))}function sY(t,e,r,n,i){nr(ic,this)&&(i.value=!0),nn(ic,this,!1)}function aY(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function lY(){xt(Bt,this,sI).call(this)}function uY(){xt(Bt,this,iY).call(this)}function cY(){xt(Bt,this,sI).call(this)}function hY(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function dY(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function fY(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function aI(t,e,r){const n=dY(t,hY(t,e,r));return fY(n)}function gY(t,e,r){return(e=mY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mY(t){var e=pY(t,"string");return typeof e=="symbol"?e:e+""}function pY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kr{constructor(e){gY(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function pu(t,e,r){return(e=wY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wY(t){var e=vY(t,"string");return typeof e=="symbol"?e:e+""}function vY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kw extends Kr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),pu(this,"stateBefore",void 0),pu(this,"range",void 0),pu(this,"type",void 0),pu(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new kw({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){j(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){Oi(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function SE(t,e,r){return(e=yY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yY(t){var e=bY(t,"string");return typeof e=="symbol"?e:e+""}function bY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lw extends Kr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),SE(this,"columns",void 0),SE(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new Lw({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),aI(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function CE(t,e,r){return(e=SY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SY(t){var e=CY(t,"string");return typeof e=="symbol"?e:e+""}function CY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fw extends Kr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),CE(this,"previousSortState",void 0),CE(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new Fw({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function RE(t,e,r){return(e=RY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RY(t){var e=EY(t,"string");return typeof e=="symbol"?e:e+""}function EY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vw extends Kr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),RE(this,"index",void 0),RE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new Vw({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function EE(t,e,r){return(e=TY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TY(t){var e=_Y(t,"string");return typeof e=="symbol"?e:e+""}function _Y(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ww extends Kr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),EE(this,"index",void 0),EE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Ww({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function wu(t,e,r){return(e=OY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OY(t){var e=MY(t,"string");return typeof e=="symbol"?e:e+""}function MY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $w extends Kr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),wu(this,"changes",void 0),wu(this,"selected",void 0),wu(this,"countCols",void 0),wu(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new $w({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=Tr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,r){const n=Tr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.redo")}}function TE(t,e,r){return(e=IY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IY(t){var e=PY(t,"string");return typeof e=="symbol"?e:e+""}function PY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bw extends Kr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),TE(this,"conditionsStack",void 0),TE(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new Bw({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function HY(t,e,r){return(e=xY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xY(t){var e=AY(t,"string");return typeof e=="symbol"?e:e+""}function AY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jw extends Kr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),HY(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new jw({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function lI(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Xe(n,i,l=>{Xe(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Qn(t,e,r){return(e=DY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DY(t){var e=NY(t,"string");return typeof e=="symbol"?e:e+""}function NY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zw extends Kr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Qn(this,"index",void 0),Qn(this,"indexes",void 0),Qn(this,"data",void 0),Qn(this,"amount",void 0),Qn(this,"headers",void 0),Qn(this,"columnPositions",void 0),Qn(this,"rowPositions",void 0),Qn(this,"fixedColumnsStart",void 0),Qn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return Xe(l.length-1,p=>{const v=[],b=l[p];Xe(u,c,E=>{v.push(b[e.toPhysicalColumn(E)])}),h.push(v)}),Xe(i-1,p=>{g.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&Xe(i-1,p=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)}),new zw({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:lI(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Dn(this.data[c],o));const l=Dn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),j(e.getSourceDataArray(),(c,h)=>{j(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&j(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function fs(t,e,r){return(e=kY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kY(t){var e=LY(t,"string");return typeof e=="symbol"?e:e+""}function LY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uw extends Kr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),fs(this,"index",void 0),fs(this,"data",void 0),fs(this,"fixedRowsBottom",void 0),fs(this,"fixedRowsTop",void 0),fs(this,"rowIndexesSequence",void 0),fs(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=Tr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new Uw({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:lI(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function _E(t,e,r){return(e=FY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FY(t){var e=VY(t,"string");return typeof e=="symbol"?e:e+""}function VY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yw extends Kr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),_E(this,"rows",void 0),_E(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new Yw({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),aI(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function WY(t,e,r){return(e=$Y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Y(t){var e=BY(t,"string");return typeof e=="symbol"?e:e+""}function BY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qw extends Kr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),WY(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new qw({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function jY(t,e){[kw,Lw,Fw,Vw,Ww,$w,Bw,jw,zw,Uw,Yw,qw].forEach(r=>r.startRegisteringEvents(t,e))}function zY(t,e){UY(t,e),e.add(t)}function UY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $g(t,e,r){return(e=YY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YY(t){var e=qY(t,"string");return typeof e=="symbol"?e:e+""}function qY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const OE="undoRedo",GY="undoRedo",KY=1e3;ge.getSingleton().register("beforeUndo");ge.getSingleton().register("afterUndo");ge.getSingleton().register("beforeRedo");ge.getSingleton().register("afterRedo");const ME=new Set;var vu=new WeakSet;class XY extends Wc{static get PLUGIN_KEY(){return GY}static get PLUGIN_PRIORITY(){return KY}static get SETTING_KEYS(){return!0}constructor(e){super(e),zY(this,vu),$g(this,"doneActions",[]),$g(this,"undoneActions",[]),$g(this,"ignoreNewActions",!1),jY(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bg(vu,e,ZY).call(e,...n)}),this.registerShortcuts(),Bg(vu,this,JY).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Bg(vu,this,QY).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:OE};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(OE)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=Tr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=Tr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function ZY(t,e){e==="loadData"&&this.clear()}function JY(){const t=e=>{ME.has(e)||(hr(ur`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),ME.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function QY(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class e2{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=S=>{if(S=this.postProcess(S,n),i){setTimeout(function(){i(S)},0);return}else return S},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let p=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&p+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let v=-1/0,b=1/0;const E=()=>{for(let S=Math.max(v,-u);S<=Math.min(b,u);S+=2){let T;const y=g[S-1],M=g[S+1];y&&(g[S-1]=void 0);let H=!1;if(M){const A=M.oldPos-S;H=M&&0<=A&&A<a}const P=y&&y.oldPos+1<l;if(!H&&!P){g[S]=void 0;continue}if(!P||H&&y.oldPos<M.oldPos?T=this.addToPath(M,!0,!1,0,n):T=this.addToPath(y,!1,!0,1,n),p=this.extractCommon(T,r,e,S,n),T.oldPos+1>=l&&p+1>=a)return s(this.buildValues(T.lastComponent,r,e))||!0;g[S]=T,T.oldPos+1>=l&&(b=Math.min(b,S-1)),p+1>=a&&(v=Math.max(v,S+1))}u++};if(i)(function S(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);E()||S()},0)})();else for(;u<=c&&Date.now()<=d;){const S=E();if(S)return S}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const p=n[u+g];return p.length>d.length?p:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class t2 extends e2{constructor(){super(...arguments),this.tokenize=n2}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const r2=new t2;function IE(t,e,r){return r2.diff(t,e,r)}function n2(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}const i2={includeIndex:!0,includeUnderline:!0,includeFileHeaders:!0};function o2(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;IE(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(IE(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(S){return S.map(function(T){return" "+T})}const d=[];let g=0,p=0,v=[],b=1,E=1;for(let S=0;S<c.length;S++){const T=c[S],y=T.lines||a2(T.value);if(T.lines=y,T.added||T.removed){if(!g){const M=c[S-1];g=b,p=E,M&&(v=l>0?h(M.lines.slice(-l)):[],g-=v.length,p-=v.length)}for(const M of y)v.push((T.added?"+":"-")+M);T.added?E+=y.length:b+=y.length}else{if(g)if(y.length<=l*2&&S<c.length-2)for(const M of h(y))v.push(M);else{const M=Math.min(y.length,l);for(const P of h(y.slice(0,M)))v.push(P);const H={oldStart:g,oldLines:b-g+M,newStart:p,newLines:E-p+M,lines:v};d.push(H),g=0,p=0,v=[]}b+=y.length,E+=y.length}}for(const S of d)for(let T=0;T<S.lines.length;T++)S.lines[T].endsWith(`
`)?S.lines[T]=S.lines[T].slice(0,-1):(S.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function uI(t,e){if(e||(e=i2),Array.isArray(t)){if(t.length>1&&!e.includeFileHeaders)throw new Error("Cannot omit file headers on a multi-file patch. (The result would be unparseable; how would a tool trying to apply the patch know which changes are to which file?)");return t.map(n=>uI(n,e)).join(`
`)}const r=[];e.includeIndex&&t.oldFileName==t.newFileName&&r.push("Index: "+t.oldFileName),e.includeUnderline&&r.push("==================================================================="),e.includeFileHeaders&&(r.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),r.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader)));for(let n=0;n<t.hunks.length;n++){const i=t.hunks[n];i.oldLines===0&&(i.oldStart-=1),i.newLines===0&&(i.newStart-=1),r.push("@@ -"+i.oldStart+","+i.oldLines+" +"+i.newStart+","+i.newLines+" @@");for(const o of i.lines)r.push(o)}return r.join(`
`)+`
`}function s2(t,e,r,n,i,o,s){{const a=o2(t,e,r,n,i,o);return a?uI(a,void 0):void 0}}function a2(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var xm;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(xm||(xm={}));const gs=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,ks=xm;class PE{data;constructor(e){this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class HE{data;constructor(e){this.data=e}run(){return[...new Set(this.data)]}}class Am{data1;data2;ignoreDuplicates;constructor(e,r,n=!0){n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)ks.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return ks.sort(e)}}class l2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)ks.contains(this.data2,r[n])&&e.push(r[n]);return ks.sort(e)}}class xE{data;constructor(e){this.data=ks.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new Am(ks.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class u2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){return s2("Data1","Data2",this.data1,this.data2)}}var c2=wP('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row svelte-1n46o8q"><div id="Table1" class="col-3 svelte-1n46o8q"></div> <div id="Table2" class="col-3 pl-0 svelte-1n46o8q"></div> <div class="col-2 p-0 pt-5 svelte-1n46o8q"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-1n46o8q"><label for="result">Result</label> <textarea class="form-control svelte-1n46o8q" id="result" readonly=""></textarea></div></div></div>',1);function h2(t,e){LE(e,!0);const r=[],n=[];xl(qa),xl(Zc),xl(rY),xl(XY);const i=64;let o,s,a=or(""),l=or("Data1"),u=or("comm"),c=or(!0),h=or(!0),d=or(!1);const g=(I,B,X)=>{let ae;try{ae=JSON.parse(localStorage.getItem(X)||"")}catch{ae=void 0}const ye=new pn(document.getElementById(I),{data:ae,colHeaders:[B],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return ye.addHook("beforePaste",()=>ye.updateSettings({readOnly:!0})),ye.addHook("afterPaste",ce=>{ye.updateSettings({readOnly:!1}),ye.deselectCell();for(let fe=ce.length-1;fe>=0;fe--)if(ce[fe][0]!==""){ye.loadData(ce.slice(0,fe+1));return}ye.loadData([[""]])}),ye};TP(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const p=I=>I.getDataAtCol(0).filter(B=>B!==null),v=I=>{const B=p(o).filter(Le=>Le!=""),X=p(s).filter(Le=>Le!="");switch(I){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(oe(l)=="Data1"&&!B.length){Ye(a,`Data1 is empty.
Please enter something...`);return}else if(oe(l)=="Data2"&&!X.length){Ye(a,`Data2 is empty.
Please enter something...`);return}break;default:if(B.length){if(!X.length){Ye(a,`Data2 is empty.
Please enter something...`);return}}else{Ye(a,`Data1 is empty.
Please enter something...`);return}}Ye(d,!0);const ae=T(),ye=new Date().getTime();let ce="",fe;switch(I){case"chkDuplicates":let Le;oe(l)=="Data1"?Le=new PE(B).run():Le=new PE(X).run(),Object.keys(Le).length?oe(c)?ce=`Duplicate values found in ${oe(l)}.
`+gs(Object.keys(Le).length,Object.keys(Le).map(he=>`${he} appears ${Le[he]} times.`)):ce=Object.keys(Le).join(`
`):ce=`${oe(l)} has no duplicate value.`;break;case"rmDuplicates":oe(l)=="Data1"?fe=new HE(B).run():fe=new HE(X).run(),ce=fe.join(`
`);break;case"chkConsecutive":oe(l)=="Data1"?fe=new xE(B).run():fe=new xE(X).run(),fe.length?fe.length==1&&fe[0]=="!Error!"?ce=`Error!
${oe(l)} contains non-numeric value. Please check!`:ce=`${oe(l)} is not consecutive.

The following numbers are missing:
${fe.join(`
`)}`:ce=`${oe(l)} contains consecutive numbers.`;break;case"compare":if(oe(u)=="comm")fe=new l2(B,X).run(),fe.length?ce=`Common values found between two data.
${gs(fe.length,fe)}`:ce="Two data contain no common value.";else{const he=new Am(B,X,oe(h)).run(),xe=new Am(X,B,oe(h)).run();he.length+xe.length==0?ce="Data1 is same as Data2.":he.length?xe.length?ce=`Two files have inconsistent content.

Data1 is more than Data2
${gs(he.length,he)}

Data2 is more than Data1
${gs(xe.length,xe)}`:ce=`Data1 completely contains Data2.

Data1 is more than Data2
${gs(he.length,he)}`:ce=`Data2 completely contains Data1.

Data2 is more than Data1
${gs(xe.length,xe)}`}break;case"diff":ce=new u2(B.join(`
`)+`
`,X.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(ae),I=="rmDuplicates"||I=="chkDuplicates"&&!oe(c)?Ye(a,ce,!0):Ye(a,ce+`

Duration for process: ${Date.now()-ye}ms`),Ye(d,!1)},b=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),Ye(a,""))},E=()=>{const I=o.getData();o.loadData(s.getData()),s.loadData(I)},S=async()=>{oe(a).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(oe(a).trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))},T=()=>setInterval(()=>{const I=oe(a).split("Processing");let B=I.length>=2?I[1].length:0;B<3?B++:B-=3,Ye(a,"Processing"+".".repeat(B))},200);var y=c2();mP("beforeunload",Xg,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var M=St(JI(y),2),H=Lt(M),P=St(Lt(H),4),A=Lt(P);A.__click=()=>v("chkDuplicates");var F=St(A,2),W=Lt(F),K=Lt(W),L=St(F,2);L.__click=()=>v("rmDuplicates");var ie=St(L,2);ie.__click=()=>v("chkConsecutive");var G=St(ie,2),te=Lt(G),tt=Lt(te);tt.value=tt.__value="Data1";var Ie=St(te,2),Ce=Lt(Ie);Ce.value=Ce.__value="Data2";var Be=St(G,4);Be.__click=()=>v("compare");var je=St(Be,2),Pe=Lt(je),Ir=Lt(Pe);Ir.value=Ir.__value="comm";var He=St(Pe,2),Dt=Lt(He);Dt.value=Dt.__value="diff";var f=St(je,2),m=Lt(f),w=Lt(m),C=St(f,4);C.__click=()=>v("diff");var _=St(C,6);_.__click=S;var O=St(_,6);O.__click=E;var x=Lt(O);CP(x,()=>"Data1 <=> Data2");var D=St(O,6);D.__click=b;var q=St(P,2),$=St(Lt(q),2);rT(()=>{A.disabled=oe(d),L.disabled=oe(d),ie.disabled=oe(d),Be.disabled=oe(d),w.disabled=oe(u)=="comm",C.disabled=oe(d),_.disabled=oe(d),O.disabled=oe(d),D.disabled=oe(d)}),gv(K,()=>oe(c),I=>Ye(c,I)),Tl(r,[],tt,()=>oe(l),I=>Ye(l,I)),Tl(r,[],Ce,()=>oe(l),I=>Ye(l,I)),Tl(n,[],Ir,()=>oe(u),I=>Ye(u,I)),Tl(n,[],Dt,()=>oe(u),I=>Ye(u,I)),gv(w,()=>oe(h),I=>Ye(h,I)),RP($,()=>oe(a),I=>Ye(a,I)),vP(t,y),FE()}pP(["click"]);yP(h2,{target:document.body})});export default d2();
