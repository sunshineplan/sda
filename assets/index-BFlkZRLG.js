var HO=Object.defineProperty;var AO=(t,e,r)=>e in t?HO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var DO=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var or=(t,e,r)=>AO(t,typeof e!="symbol"?e+"":e,r);var fU=DO((bU,ql)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const tw=!1;var vR=Array.isArray,NO=Array.prototype.indexOf,kO=Array.from,LO=Object.defineProperty,na=Object.getOwnPropertyDescriptor,FO=Object.prototype,VO=Array.prototype,WO=Object.getPrototypeOf,rw=Object.isExtensible;function BO(t){for(var e=0;e<t.length;e++)t[e]()}const xr=2,yR=4,pu=8,kg=16,yi=32,Jo=64,Lg=128,dr=256,Gl=512,Hr=1024,zn=2048,to=4096,Kl=8192,Fg=16384,bR=32768,$O=65536,nw=1<<17,jO=1<<18,CR=1<<19,Zf=1<<20,SR=1<<21,ia=Symbol("$state"),RR=new class extends Error{constructor(){super(...arguments);or(this,"name","StaleReactionError");or(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function TR(t){return t===this.v}function zO(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function UO(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function YO(t){throw new Error("https://svelte.dev/e/effect_orphan")}function qO(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function GO(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function KO(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function XO(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let ZO=!1;const QO=2,sr=Symbol();function JO(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let fr=null;function iw(t){fr=t}function ER(t,e=!1,r){var n=fr={p:fr,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};Wg(()=>{n.d=!0})}function _R(t){const e=fr;if(e!==null){const s=e.e;if(s!==null){var r=ke,n=Se;e.e=null;try{for(var i=0;i<s.length;i++){var o=s[i];pi(o.effect),pn(o.reaction),NR(o.fn)}}finally{pi(r),pn(n)}}fr=e.p,e.m=!0}return{}}function OR(){return!0}function Xs(t){if(typeof t!="object"||t===null||ia in t)return t;const e=WO(t);if(e!==FO&&e!==VO)return t;var r=new Map,n=vR(t),i=Qt(0),o=Se,s=a=>{var l=Se;pn(o);var u=a();return pn(l),u};return n&&r.set("length",Qt(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&GO();var c=r.get(l);return c===void 0?c=s(()=>{var h=Qt(u.value);return r.set(l,h),h}):Ve(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const d=s(()=>Qt(sr));r.set(l,d),uc(i)}}else{if(n&&typeof l=="string"){var c=r.get("length"),h=Number(l);Number.isInteger(h)&&h<c.v&&Ve(c,h)}Ve(u,sr),uc(i)}return!0},get(a,l,u){var g;if(l===ia)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||(g=na(a,l))!=null&&g.writable)&&(c=s(()=>{var p=Xs(h?a[l]:sr),y=Qt(p);return y}),r.set(l,c)),c!==void 0){var d=ce(c);return d===sr?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=ce(c))}else if(u===void 0){var h=r.get(l),d=h==null?void 0:h.v;if(h!==void 0&&d!==sr)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){var d;if(l===ia)return!0;var u=r.get(l),c=u!==void 0&&u.v!==sr||Reflect.has(a,l);if(u!==void 0||ke!==null&&(!c||(d=na(a,l))!=null&&d.writable)){u===void 0&&(u=s(()=>{var g=c?Xs(a[l]):sr,p=Qt(g);return p}),r.set(l,u));var h=ce(u);if(h===sr)return!1}return c},set(a,l,u,c){var T;var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var p=r.get(g+"");p!==void 0?Ve(p,sr):g in a&&(p=s(()=>Qt(sr)),r.set(g+"",p))}if(h===void 0)(!d||(T=na(a,l))!=null&&T.writable)&&(h=s(()=>Qt(void 0)),Ve(h,Xs(u)),r.set(l,h));else{d=h.v!==sr;var y=s(()=>Xs(u));Ve(h,y)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b!=null&&b.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var E=r.get("length"),v=Number(l);Number.isInteger(v)&&v>=E.v&&Ve(E,v+1)}uc(i)}return!0},ownKeys(a){ce(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==sr});for(var[u,c]of r)c.v!==sr&&!(u in a)&&l.push(u);return l},setPrototypeOf(){KO()}})}function uc(t,e=1){Ve(t,t.v+e)}function ow(t){try{if(t!==null&&typeof t=="object"&&ia in t)return t[ia]}catch{}return t}function eM(t,e){return Object.is(ow(t),ow(e))}function tM(t){var e=xr|zn,r=Se!==null&&(Se.f&xr)!==0?Se:null;return ke===null||r!==null&&(r.f&dr)!==0?e|=dr:ke.f|=CR,{ctx:fr,deps:null,effects:null,equals:TR,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:r??ke,ac:null}}function MR(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Ki(e[r])}}function rM(t){for(var e=t.parent;e!==null;){if((e.f&xr)===0)return e;e=e.parent}return null}function IR(t){var e,r=ke;pi(rM(t));try{MR(t),e=UR(t)}finally{pi(r)}return e}function PR(t){var e=IR(t);if(t.equals(e)||(t.v=e,t.wv=jR()),!ts){var r=(ui||(t.f&dr)!==0)&&t.deps!==null?to:Hr;wn(t,r)}}const fa=new Map;function nM(t,e){var r={f:0,v:t,reactions:null,equals:TR,rv:0,wv:0};return r}function Qt(t,e){const r=nM(t);return yM(r),r}function Ve(t,e,r=!1){Se!==null&&(!fn||(Se.f&nw)!==0)&&OR()&&(Se.f&(xr|kg|nw))!==0&&!((ot==null?void 0:ot.reaction)===Se&&ot.sources.includes(t))&&XO();let n=r?Xs(e):e;return iM(t,n)}function iM(t,e){if(!t.equals(e)){var r=t.v;ts?fa.set(t,e):fa.set(t,r),t.v=e,(t.f&xr)!==0&&((t.f&zn)!==0&&IR(t),wn(t,(t.f&dr)===0?Hr:to)),t.wv=jR(),xR(t,zn),ke!==null&&(ke.f&Hr)!==0&&(ke.f&(yi|Jo))===0&&(Or===null?bM([t]):Or.push(t))}return e}function xR(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f;(s&zn)===0&&(wn(o,e),(s&(Hr|dr))!==0&&((s&xr)!==0?xR(o,to):vu(o)))}}var Qf,HR,AR,DR;function oM(){if(Qf===void 0){Qf=window,HR=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;AR=na(e,"firstChild").get,DR=na(e,"nextSibling").get,rw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),rw(r)&&(r.__t=void 0)}}function sM(t=""){return document.createTextNode(t)}function ji(t){return AR.call(t)}function Vg(t){return DR.call(t)}function It(t,e){return ji(t)}function aM(t,e){{var r=ji(t);return r instanceof Comment&&r.data===""?Vg(r):r}}function wt(t,e=1,r=!1){let n=t;for(;e--;)n=Vg(n);return n}function lM(t){ke===null&&Se===null&&YO(),Se!==null&&(Se.f&dr)!==0&&ke===null&&UO(),ts&&zO()}function uM(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function es(t,e,r,n=!0){var i=ke,o={ctx:fr,deps:null,nodes_start:null,nodes_end:null,f:t|zn,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{$g(o),o.f|=bR}catch(l){throw Ki(o),l}else e!==null&&vu(o);var s=r&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(CR|Lg))===0;if(!s&&n&&(i!==null&&uM(o,i),Se!==null&&(Se.f&xr)!==0)){var a=Se;(a.effects??(a.effects=[])).push(o)}return o}function Wg(t){const e=es(pu,null,!1);return wn(e,Hr),e.teardown=t,e}function cM(t){lM();var e=ke!==null&&(ke.f&yi)!==0&&fr!==null&&!fr.m;if(e){var r=fr;(r.e??(r.e=[])).push({fn:t,effect:ke,reaction:Se})}else return NR(t)}function NR(t){return es(yR|SR,t,!1)}function hM(t){const e=es(Jo,t,!0);return(r={})=>new Promise(n=>{r.outro?mM(e,()=>{Ki(e),n(void 0)}):(Ki(e),n(void 0))})}function Bg(t){return es(pu,t,!0)}function kR(t,e=[],r=tM){const n=e.map(r);return dM(()=>t(...n.map(ce)))}function dM(t,e=0){var r=es(pu|kg|e,t,!0);return r}function fM(t,e=!0){return es(pu|yi,t,!0,e)}function LR(t){var e=t.teardown;if(e!==null){const r=ts,n=Se;sw(!0),pn(null);try{e.call(null)}finally{sw(r),pn(n)}}}function FR(t,e=!1){var i;var r=t.first;for(t.first=t.last=null;r!==null;){(i=r.ac)==null||i.abort(RR);var n=r.next;(r.f&Jo)!==0?r.parent=null:Ki(r,e),r=n}}function gM(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&yi)===0&&Ki(e),e=r}}function Ki(t,e=!0){var r=!1;(e||(t.f&jO)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(VR(t.nodes_start,t.nodes_end),r=!0),FR(t,e&&!r),eu(t,0),wn(t,Fg);var n=t.transitions;if(n!==null)for(const o of n)o.stop();LR(t);var i=t.parent;i!==null&&i.first!==null&&WR(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function VR(t,e){for(;t!==null;){var r=t===e?null:Vg(t);t.remove(),t=r}}function WR(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function mM(t,e){var r=[];BR(t,r,!0),pM(r,()=>{Ki(t),e&&e()})}function pM(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function BR(t,e,r){if((t.f&Kl)===0){if(t.f^=Kl,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&$O)!==0||(n.f&yi)!==0;BR(n,e,o?r:!1),n=i}}}let Xl=[];function wM(){var t=Xl;Xl=[],BO(t)}function Jf(t){Xl.length===0&&queueMicrotask(wM),Xl.push(t)}function vM(t){var e=ke;if((e.f&bR)===0){if((e.f&Lg)===0)throw t;e.fn(t)}else $R(t,e)}function $R(t,e){for(;e!==null;){if((e.f&Lg)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t}let eg=!1,Zl=null,Yi=!1,ts=!1;function sw(t){ts=t}let Nl=[],Se=null,fn=!1;function pn(t){Se=t}let ke=null;function pi(t){ke=t}let ot=null;function yM(t){Se!==null&&Se.f&Zf&&(ot===null?ot={reaction:Se,sources:[t]}:ot.sources.push(t))}let Dt=null,lr=0,Or=null;function bM(t){Or=t}let Ql=1,Jl=0,ui=!1;function jR(){return++Ql}function wu(t){var h;var e=t.f;if((e&zn)!==0)return!0;if((e&to)!==0){var r=t.deps,n=(e&dr)!==0;if(r!==null){var i,o,s=(e&Gl)!==0,a=n&&ke!==null&&!ui,l=r.length;if(s||a){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!((h=o==null?void 0:o.reactions)!=null&&h.includes(u)))&&(o.reactions??(o.reactions=[])).push(u);s&&(u.f^=Gl),a&&c!==null&&(c.f&dr)===0&&(u.f^=dr)}for(i=0;i<l;i++)if(o=r[i],wu(o)&&PR(o),o.wv>t.wv)return!0}(!n||ke!==null&&!ui)&&wn(t,Hr)}return!1}function zR(t,e,r=!0){var n=t.reactions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];(ot==null?void 0:ot.reaction)===Se&&ot.sources.includes(t)||((o.f&xr)!==0?zR(o,e,!1):e===o&&(r?wn(o,zn):(o.f&Hr)!==0&&wn(o,to),vu(o)))}}function UR(t){var g;var e=Dt,r=lr,n=Or,i=Se,o=ui,s=ot,a=fr,l=fn,u=t.f;Dt=null,lr=0,Or=null,ui=(u&dr)!==0&&(fn||!Yi||Se===null),Se=(u&(yi|Jo))===0?t:null,ot=null,iw(t.ctx),fn=!1,Jl++,t.f|=Zf,t.ac!==null&&(t.ac.abort(RR),t.ac=null);try{var c=(0,t.fn)(),h=t.deps;if(Dt!==null){var d;if(eu(t,lr),h!==null&&lr>0)for(h.length=lr+Dt.length,d=0;d<Dt.length;d++)h[lr+d]=Dt[d];else t.deps=h=Dt;if(!ui||(u&xr)!==0&&t.reactions!==null)for(d=lr;d<h.length;d++)((g=h[d]).reactions??(g.reactions=[])).push(t)}else h!==null&&lr<h.length&&(eu(t,lr),h.length=lr);if(OR()&&Or!==null&&!fn&&h!==null&&(t.f&(xr|to|zn))===0)for(d=0;d<Or.length;d++)zR(Or[d],t);return i!==null&&i!==t&&(Jl++,Or!==null&&(n===null?n=Or:n.push(...Or))),c}catch(p){vM(p)}finally{Dt=e,lr=r,Or=n,Se=i,ui=o,ot=s,iw(a),fn=l,t.f^=Zf}}function CM(t,e){let r=e.reactions;if(r!==null){var n=NO.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&xr)!==0&&(Dt===null||!Dt.includes(e))&&(wn(e,to),(e.f&(dr|Gl))===0&&(e.f^=Gl),MR(e),eu(e,0))}function eu(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)CM(t,r[n])}function $g(t){var e=t.f;if((e&Fg)===0){wn(t,Hr);var r=ke,n=Yi;ke=t,Yi=!0;try{(e&kg)!==0?gM(t):FR(t),LR(t);var i=UR(t);t.teardown=typeof i=="function"?i:null,t.wv=Ql;var o;tw&&ZO&&(t.f&zn)!==0&&t.deps}finally{Yi=n,ke=r}}}function SM(){try{qO()}catch(t){if(Zl!==null)$R(t,Zl);else throw t}}function RM(){var t=Yi;try{var e=0;for(Yi=!0;Nl.length>0;){e++>1e3&&SM();var r=Nl,n=r.length;Nl=[];for(var i=0;i<n;i++){var o=EM(r[i]);TM(o)}fa.clear()}}finally{eg=!1,Yi=t,Zl=null}}function TM(t){var e=t.length;if(e!==0){for(var r=0;r<e;r++){var n=t[r];if((n.f&(Fg|Kl))===0&&wu(n)){var i=Ql;if($g(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?WR(n):n.fn=null),Ql>i&&(n.f&SR)!==0)break}}for(;r<e;r+=1)vu(t[r])}}function vu(t){eg||(eg=!0,queueMicrotask(RM));for(var e=Zl=t;e.parent!==null;){e=e.parent;var r=e.f;if((r&(Jo|yi))!==0){if((r&Hr)===0)return;e.f^=Hr}}Nl.push(e)}function EM(t){for(var e=[],r=t;r!==null;){var n=r.f,i=(n&(yi|Jo))!==0,o=i&&(n&Hr)!==0;if(!o&&(n&Kl)===0){(n&yR)!==0?e.push(r):i?r.f^=Hr:wu(r)&&$g(r);var s=r.first;if(s!==null){r=s;continue}}var a=r.parent;for(r=r.next;r===null&&a!==null;)r=a.next,a=a.parent}return e}function ce(t){var e=t.f,r=(e&xr)!==0;if(Se!==null&&!fn){if((ot==null?void 0:ot.reaction)!==Se||!(ot!=null&&ot.sources.includes(t))){var n=Se.deps;t.rv<Jl&&(t.rv=Jl,Dt===null&&n!==null&&n[lr]===t?lr++:Dt===null?Dt=[t]:(!ui||!Dt.includes(t))&&Dt.push(t))}}else if(r&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&dr)===0&&(i.f^=dr)}return r&&(i=t,wu(i)&&PR(i)),ts&&fa.has(t)?fa.get(t):t.v}function jg(t){var e=fn;try{return fn=!0,t()}finally{fn=e}}const _M=-7169;function wn(t,e){t.f=t.f&_M|e}const OM=["touchstart","touchmove"];function MM(t){return OM.includes(t)}let aw=!1;function IM(){aw||(aw=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function YR(t){var e=Se,r=ke;pn(null),pi(null);try{return t()}finally{pn(e),pi(r)}}function zg(t,e,r,n=r){t.addEventListener(e,()=>YR(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),IM()}const qR=new Set,tg=new Set;function PM(t,e,r,n={}){function i(o){if(n.capture||Zs.call(e,o),!o.cancelBubble)return YR(()=>r==null?void 0:r.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Jf(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function xM(t,e,r,n,i){var o={capture:n,passive:i},s=PM(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Wg(()=>{e.removeEventListener(t,s,o)})}function HM(t){for(var e=0;e<t.length;e++)qR.add(t[e]);for(var r of tg)r(t)}function Zs(t){var v;var e=this,r=e.ownerDocument,n=t.type,i=((v=t.composedPath)==null?void 0:v.call(t))||[],o=i[0]||t.target,s=0,a=t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){LO(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=Se,h=ke;pn(null),pi(null);try{for(var d,g=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var y=o["__"+n];if(y!=null&&(!o.disabled||t.target===o))if(vR(y)){var[b,...E]=y;b.apply(o,[t,...E])}else y.call(o,t)}catch(T){d?g.push(T):d=T}if(t.cancelBubble||p===e||p===null)break;o=p}if(d){for(let T of g)queueMicrotask(()=>{throw T});throw d}}finally{t.__root=e,delete t.currentTarget,pn(c),pi(h)}}}function GR(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function KR(t,e){var r=ke;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function AM(t,e){var r=(e&QO)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=GR(i?t:"<!>"+t));var o=r||HR?document.importNode(n,!0):n.cloneNode(!0);{var s=ji(o),a=o.lastChild;KR(s,a)}return o}}function DM(t,e){t!==null&&t.before(e)}function NM(t,e){return kM(t,e)}const po=new Map;function kM(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){oM();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var p=MM(g);e.addEventListener(g,Zs,{passive:p});var y=po.get(g);y===void 0?(document.addEventListener(g,Zs,{passive:p}),po.set(g,1)):po.set(g,y+1)}}};l(kO(qR)),tg.add(l);var u=void 0,c=hM(()=>{var h=r??e.appendChild(sM());return fM(()=>{if(o){ER({});var d=fr;d.c=o}i&&(n.$$events=i),u=t(h,n)||{},o&&_R()}),()=>{var p;for(var d of a){e.removeEventListener(d,Zs);var g=po.get(d);--g===0?(document.removeEventListener(d,Zs),po.delete(d)):po.set(d,g)}tg.delete(l),h!==r&&((p=h.parentNode)==null||p.removeChild(h))}});return LM.set(u,c),u}let LM=new WeakMap;function FM(t,e,r=!1,n=!1,i=!1){var o=t,s="";kR(()=>{var a=ke;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(VR(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=GR(l);if((r||n)&&(u=ji(u)),KR(ji(u),u.lastChild),r||n)for(;ji(u);)o.before(ji(u));else o.before(u)}})}function VM(t,e,r=e){zg(t,"input",n=>{var i=n?t.defaultValue:t.value;if(i=hc(t)?dc(i):i,r(i),i!==(i=e())){var o=t.selectionStart,s=t.selectionEnd;t.value=i??"",s!==null&&(t.selectionStart=o,t.selectionEnd=Math.min(s,t.value.length))}}),jg(e)==null&&t.value&&r(hc(t)?dc(t.value):t.value),Bg(()=>{var n=e();hc(t)&&n===dc(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}const cc=new Set;function $a(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??(s[a]=[]);s.push(r),zg(r,"change",()=>{var l=r.__value;o&&(l=WM(s,l,r.checked)),i(l)},()=>i(o?[]:null)),Bg(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=eM(r.__value,l)}),Wg(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),cc.has(s)||(cc.add(s),Jf(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),cc.delete(s)})),Jf(()=>{})}function lw(t,e,r=e){zg(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),jg(e)==null&&r(t.checked),Bg(()=>{var n=e();t.checked=!!n})}function WM(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function hc(t){var e=t.type;return e==="number"||e==="range"}function dc(t){return t===""?null:+t}function BM(t){fr===null&&JO(),cM(()=>{const e=jg(t);if(typeof e=="function")return e})}const $M="5";var wR;typeof window<"u"&&((wR=window.__svelte??(window.__svelte={})).v??(wR.v=new Set)).add($M);var uw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},cw={},ps,hw;function Je(){if(hw)return ps;hw=1;var t=function(e){return e&&e.Math===Math&&e};return ps=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof uw=="object"&&uw)||t(typeof ps=="object"&&ps)||function(){return this}()||Function("return this")(),ps}var fc={},gc,dw;function st(){return dw||(dw=1,gc=function(t){try{return!!t()}catch{return!0}}),gc}var mc,fw;function Dr(){if(fw)return mc;fw=1;var t=st();return mc=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),mc}var pc,gw;function yu(){if(gw)return pc;gw=1;var t=st();return pc=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),pc}var wc,mw;function mt(){if(mw)return wc;mw=1;var t=yu(),e=Function.prototype.call;return wc=t?e.bind(e):function(){return e.apply(e,arguments)},wc}var vc={},pw;function jM(){if(pw)return vc;pw=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return vc.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,vc}var yc,ww;function bu(){return ww||(ww=1,yc=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),yc}var bc,vw;function et(){if(vw)return bc;vw=1;var t=yu(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return bc=t?n:function(i){return function(){return r.apply(i,arguments)}},bc}var Cc,yw;function ro(){if(yw)return Cc;yw=1;var t=et(),e=t({}.toString),r=t("".slice);return Cc=function(n){return r(e(n),8,-1)},Cc}var Sc,bw;function zM(){if(bw)return Sc;bw=1;var t=et(),e=st(),r=ro(),n=Object,i=t("".split);return Sc=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,Sc}var Rc,Cw;function Ug(){return Cw||(Cw=1,Rc=function(t){return t==null}),Rc}var Tc,Sw;function Ra(){if(Sw)return Tc;Sw=1;var t=Ug(),e=TypeError;return Tc=function(r){if(t(r))throw new e("Can't call method on "+r);return r},Tc}var Ec,Rw;function Ta(){if(Rw)return Ec;Rw=1;var t=zM(),e=Ra();return Ec=function(r){return t(e(r))},Ec}var _c,Tw;function at(){if(Tw)return _c;Tw=1;var t=typeof document=="object"&&document.all;return _c=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},_c}var Oc,Ew;function Nr(){if(Ew)return Oc;Ew=1;var t=at();return Oc=function(e){return typeof e=="object"?e!==null:t(e)},Oc}var Mc,_w;function rs(){if(_w)return Mc;_w=1;var t=Je(),e=at(),r=function(n){return e(n)?n:void 0};return Mc=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},Mc}var Ic,Ow;function Ea(){if(Ow)return Ic;Ow=1;var t=et();return Ic=t({}.isPrototypeOf),Ic}var Pc,Mw;function Cu(){if(Mw)return Pc;Mw=1;var t=Je(),e=t.navigator,r=e&&e.userAgent;return Pc=r?String(r):"",Pc}var xc,Iw;function UM(){if(Iw)return xc;Iw=1;var t=Je(),e=Cu(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),xc=a,xc}var Hc,Pw;function Yg(){if(Pw)return Hc;Pw=1;var t=UM(),e=st(),r=Je(),n=r.String;return Hc=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Hc}var Ac,xw;function XR(){if(xw)return Ac;xw=1;var t=Yg();return Ac=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ac}var Dc,Hw;function qg(){if(Hw)return Dc;Hw=1;var t=rs(),e=at(),r=Ea(),n=XR(),i=Object;return Dc=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Dc}var Nc,Aw;function Su(){if(Aw)return Nc;Aw=1;var t=String;return Nc=function(e){try{return t(e)}catch{return"Object"}},Nc}var kc,Dw;function mr(){if(Dw)return kc;Dw=1;var t=at(),e=Su(),r=TypeError;return kc=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},kc}var Lc,Nw;function _a(){if(Nw)return Lc;Nw=1;var t=mr(),e=Ug();return Lc=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Lc}var Fc,kw;function YM(){if(kw)return Fc;kw=1;var t=mt(),e=at(),r=Nr(),n=TypeError;return Fc=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},Fc}var Vc={exports:{}},Wc,Lw;function no(){return Lw||(Lw=1,Wc=!1),Wc}var Bc,Fw;function Gg(){if(Fw)return Bc;Fw=1;var t=Je(),e=Object.defineProperty;return Bc=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Bc}var Vw;function Kg(){if(Vw)return Vc.exports;Vw=1;var t=no(),e=Je(),r=Gg(),n="__core-js_shared__",i=Vc.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Vc.exports}var $c,Ww;function ZR(){if(Ww)return $c;Ww=1;var t=Kg();return $c=function(e,r){return t[e]||(t[e]=r||{})},$c}var jc,Bw;function ns(){if(Bw)return jc;Bw=1;var t=Ra(),e=Object;return jc=function(r){return e(t(r))},jc}var zc,$w;function kr(){if($w)return zc;$w=1;var t=et(),e=ns(),r=t({}.hasOwnProperty);return zc=Object.hasOwn||function(i,o){return r(e(i),o)},zc}var Uc,jw;function QR(){if(jw)return Uc;jw=1;var t=et(),e=0,r=Math.random(),n=t(1.1.toString);return Uc=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Uc}var Yc,zw;function en(){if(zw)return Yc;zw=1;var t=Je(),e=ZR(),r=kr(),n=QR(),i=Yg(),o=XR(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Yc=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Yc}var qc,Uw;function qM(){if(Uw)return qc;Uw=1;var t=mt(),e=Nr(),r=qg(),n=_a(),i=YM(),o=en(),s=TypeError,a=o("toPrimitive");return qc=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},qc}var Gc,Yw;function JR(){if(Yw)return Gc;Yw=1;var t=qM(),e=qg();return Gc=function(r){var n=t(r,"string");return e(n)?n:n+""},Gc}var Kc,qw;function Xg(){if(qw)return Kc;qw=1;var t=Je(),e=Nr(),r=t.document,n=e(r)&&e(r.createElement);return Kc=function(i){return n?r.createElement(i):{}},Kc}var Xc,Gw;function eT(){if(Gw)return Xc;Gw=1;var t=Dr(),e=st(),r=Xg();return Xc=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Xc}var Kw;function tT(){if(Kw)return fc;Kw=1;var t=Dr(),e=mt(),r=jM(),n=bu(),i=Ta(),o=JR(),s=kr(),a=eT(),l=Object.getOwnPropertyDescriptor;return fc.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},fc}var Zc={},Qc,Xw;function rT(){if(Xw)return Qc;Xw=1;var t=Dr(),e=st();return Qc=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Qc}var Jc,Zw;function pt(){if(Zw)return Jc;Zw=1;var t=Nr(),e=String,r=TypeError;return Jc=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},Jc}var Qw;function bi(){if(Qw)return Zc;Qw=1;var t=Dr(),e=eT(),r=rT(),n=pt(),i=JR(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Zc.f=t?r?function(d,g,p){if(n(d),g=i(g),n(p),typeof d=="function"&&g==="prototype"&&"value"in p&&c in p&&!p[c]){var y=a(d,g);y&&y[c]&&(d[g]=p.value,p={configurable:u in p?p[u]:y[u],enumerable:l in p?p[l]:y[l],writable:!1})}return s(d,g,p)}:s:function(d,g,p){if(n(d),g=i(g),n(p),e)try{return s(d,g,p)}catch{}if("get"in p||"set"in p)throw new o("Accessors not supported");return"value"in p&&(d[g]=p.value),d},Zc}var eh,Jw;function is(){if(Jw)return eh;Jw=1;var t=Dr(),e=bi(),r=bu();return eh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},eh}var th={exports:{}},rh,ev;function GM(){if(ev)return rh;ev=1;var t=Dr(),e=kr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return rh={EXISTS:i,PROPER:o,CONFIGURABLE:s},rh}var nh,tv;function KM(){if(tv)return nh;tv=1;var t=et(),e=at(),r=Kg(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),nh=r.inspectSource,nh}var ih,rv;function XM(){if(rv)return ih;rv=1;var t=Je(),e=at(),r=t.WeakMap;return ih=e(r)&&/native code/.test(String(r)),ih}var oh,nv;function Zg(){if(nv)return oh;nv=1;var t=ZR(),e=QR(),r=t("keys");return oh=function(n){return r[n]||(r[n]=e(n))},oh}var sh,iv;function Qg(){return iv||(iv=1,sh={}),sh}var ah,ov;function nT(){if(ov)return ah;ov=1;var t=XM(),e=Je(),r=Nr(),n=is(),i=kr(),o=Kg(),s=Zg(),a=Qg(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,p=function(v){return g(v)?d(v):h(v,{})},y=function(v){return function(T){var _;if(!r(T)||(_=d(T)).type!==v)throw new u("Incompatible receiver, "+v+" required");return _}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(v,T){if(b.has(v))throw new u(l);return T.facade=v,b.set(v,T),T},d=function(v){return b.get(v)||{}},g=function(v){return b.has(v)}}else{var E=s("state");a[E]=!0,h=function(v,T){if(i(v,E))throw new u(l);return T.facade=v,n(v,E,T),T},d=function(v){return i(v,E)?v[E]:{}},g=function(v){return i(v,E)}}return ah={set:h,get:d,has:g,enforce:p,getterFor:y},ah}var sv;function iT(){if(sv)return th.exports;sv=1;var t=et(),e=st(),r=at(),n=kr(),i=Dr(),o=GM().CONFIGURABLE,s=KM(),a=nT(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),p=t([].join),y=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),E=th.exports=function(v,T,_){d(c(T),0,7)==="Symbol("&&(T="["+g(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),_&&_.getter&&(T="get "+T),_&&_.setter&&(T="set "+T),(!n(v,"name")||o&&v.name!==T)&&(i?h(v,"name",{value:T,configurable:!0}):v.name=T),y&&_&&n(_,"arity")&&v.length!==_.arity&&h(v,"length",{value:_.arity});try{_&&n(_,"constructor")&&_.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var M=l(v);return n(M,"source")||(M.source=p(b,typeof T=="string"?T:"")),v};return Function.prototype.toString=E(function(){return r(this)&&u(this).source||s(this)},"toString"),th.exports}var lh,av;function Jg(){if(av)return lh;av=1;var t=at(),e=bi(),r=iT(),n=Gg();return lh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},lh}var uh={},ch,lv;function ZM(){if(lv)return ch;lv=1;var t=Math.ceil,e=Math.floor;return ch=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},ch}var hh,uv;function Oa(){if(uv)return hh;uv=1;var t=ZM();return hh=function(e){var r=+e;return r!==r||r===0?0:t(r)},hh}var dh,cv;function QM(){if(cv)return dh;cv=1;var t=Oa(),e=Math.max,r=Math.min;return dh=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},dh}var fh,hv;function JM(){if(hv)return fh;hv=1;var t=Oa(),e=Math.min;return fh=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},fh}var gh,dv;function os(){if(dv)return gh;dv=1;var t=JM();return gh=function(e){return t(e.length)},gh}var mh,fv;function eI(){if(fv)return mh;fv=1;var t=Ta(),e=QM(),r=os(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return mh={includes:n(!0),indexOf:n(!1)},mh}var ph,gv;function oT(){if(gv)return ph;gv=1;var t=et(),e=kr(),r=Ta(),n=eI().indexOf,i=Qg(),o=t([].push);return ph=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},ph}var wh,mv;function em(){return mv||(mv=1,wh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),wh}var pv;function tI(){if(pv)return uh;pv=1;var t=oT(),e=em(),r=e.concat("length","prototype");return uh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},uh}var vh={},wv;function rI(){return wv||(wv=1,vh.f=Object.getOwnPropertySymbols),vh}var yh,vv;function nI(){if(vv)return yh;vv=1;var t=rs(),e=et(),r=tI(),n=rI(),i=pt(),o=e([].concat);return yh=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},yh}var bh,yv;function sT(){if(yv)return bh;yv=1;var t=kr(),e=nI(),r=tT(),n=bi();return bh=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},bh}var Ch,bv;function iI(){if(bv)return Ch;bv=1;var t=st(),e=at(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return Ch=n,Ch}var Sh,Cv;function Le(){if(Cv)return Sh;Cv=1;var t=Je(),e=tT().f,r=is(),n=Jg(),i=Gg(),o=sT(),s=iI();return Sh=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,p,y,b,E;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(p in l){if(b=l[p],a.dontCallGetSet?(E=e(g,p),y=E&&E.value):y=g[p],d=s(c?p:u+(h?".":"#")+p,a.forced),!d&&y!==void 0){if(typeof b==typeof y)continue;o(b,y)}(a.sham||y&&y.sham)&&r(b,"sham",!0),n(g,p,b,a)}},Sh}var Rh,Sv;function Ma(){if(Sv)return Rh;Sv=1;var t=yu(),e=Function.prototype,r=e.apply,n=e.call;return Rh=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),Rh}var Th,Rv;function aT(){if(Rv)return Th;Rv=1;var t=et(),e=mr();return Th=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},Th}var Eh,Tv;function oI(){if(Tv)return Eh;Tv=1;var t=Nr();return Eh=function(e){return t(e)||e===null},Eh}var _h,Ev;function sI(){if(Ev)return _h;Ev=1;var t=oI(),e=String,r=TypeError;return _h=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},_h}var Oh,_v;function lT(){if(_v)return Oh;_v=1;var t=aT(),e=Nr(),r=Ra(),n=sI();return Oh=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),Oh}var Mh,Ov;function aI(){if(Ov)return Mh;Ov=1;var t=bi().f;return Mh=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},Mh}var Ih,Mv;function lI(){if(Mv)return Ih;Mv=1;var t=at(),e=Nr(),r=lT();return Ih=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},Ih}var Ph,Iv;function uI(){if(Iv)return Ph;Iv=1;var t=en(),e=t("toStringTag"),r={};return r[e]="z",Ph=String(r)==="[object z]",Ph}var xh,Pv;function uT(){if(Pv)return xh;Pv=1;var t=uI(),e=at(),r=ro(),n=en(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return xh=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},xh}var Hh,xv;function Ru(){if(xv)return Hh;xv=1;var t=uT(),e=String;return Hh=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Hh}var Ah,Hv;function cI(){if(Hv)return Ah;Hv=1;var t=Ru();return Ah=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Ah}var Dh,Av;function hI(){if(Av)return Dh;Av=1;var t=Nr(),e=is();return Dh=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Dh}var Nh,Dv;function dI(){if(Dv)return Nh;Dv=1;var t=et(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return Nh=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},Nh}var kh,Nv;function fI(){if(Nv)return kh;Nv=1;var t=st(),e=bu();return kh=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),kh}var Lh,kv;function gI(){if(kv)return Lh;kv=1;var t=is(),e=dI(),r=fI(),n=Error.captureStackTrace;return Lh=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Lh}var Fh,Lv;function mI(){if(Lv)return Fh;Lv=1;var t=rs(),e=kr(),r=is(),n=Ea(),i=lT(),o=sT(),s=aI(),a=lI(),l=cI(),u=hI(),c=gI(),h=Dr(),d=no();return Fh=function(g,p,y,b){var E="stackTraceLimit",v=b?2:1,T=g.split("."),_=T[T.length-1],M=t.apply(null,T);if(M){var I=M.prototype;if(!d&&e(I,"cause")&&delete I.cause,!y)return M;var H=t("Error"),V=p(function(N,j){var z=l(b?j:N,void 0),te=b?new M(N):new M;return z!==void 0&&r(te,"message",z),c(te,V,te.stack,2),this&&n(I,this)&&a(te,this,V),arguments.length>v&&u(te,arguments[v]),te});if(V.prototype=I,_!=="Error"?i?i(V,H):o(V,H,{name:!0}):h&&E in M&&(s(V,M,E),s(V,M,"prepareStackTrace")),o(V,M),!d)try{I.name!==_&&r(I,"name",_),I.constructor=V}catch{}return V}},Fh}var Fv;function pI(){if(Fv)return cw;Fv=1;var t=Le(),e=Je(),r=Ma(),n=mI(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),cw}pI();var Vv={},Vh,Wv;function cT(){if(Wv)return Vh;Wv=1;var t=ro();return Vh=Array.isArray||function(r){return t(r)==="Array"},Vh}var Wh,Bv;function hT(){if(Bv)return Wh;Bv=1;var t=Dr(),e=cT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Wh=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Wh}var Bh,$v;function dT(){if($v)return Bh;$v=1;var t=TypeError,e=9007199254740991;return Bh=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Bh}var jv;function wI(){if(jv)return Vv;jv=1;var t=Le(),e=ns(),r=os(),n=hT(),i=dT(),o=st(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var p=0;p<g;p++)h[d]=arguments[p],d++;return n(h,d),d}}),Vv}wI();var zv={},$h,Uv;function vI(){if(Uv)return $h;Uv=1;var t=ro(),e=et();return $h=function(r){if(t(r)==="Function")return e(r)},$h}var jh,Yv;function fT(){if(Yv)return jh;Yv=1;var t=vI(),e=mr(),r=yu(),n=t(t.bind);return jh=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},jh}var zh,qv;function gT(){return qv||(qv=1,zh={}),zh}var Uh,Gv;function yI(){if(Gv)return Uh;Gv=1;var t=en(),e=gT(),r=t("iterator"),n=Array.prototype;return Uh=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Uh}var Yh,Kv;function mT(){if(Kv)return Yh;Kv=1;var t=uT(),e=_a(),r=Ug(),n=gT(),i=en(),o=i("iterator");return Yh=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Yh}var qh,Xv;function bI(){if(Xv)return qh;Xv=1;var t=mt(),e=mr(),r=pt(),n=Su(),i=mT(),o=TypeError;return qh=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},qh}var Gh,Zv;function pr(){if(Zv)return Gh;Zv=1;var t=mt(),e=pt(),r=_a();return Gh=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Gh}var Kh,Qv;function ss(){if(Qv)return Kh;Qv=1;var t=fT(),e=mt(),r=pt(),n=Su(),i=yI(),o=os(),s=Ea(),a=bI(),l=mT(),u=pr(),c=TypeError,h=function(g,p){this.stopped=g,this.result=p},d=h.prototype;return Kh=function(g,p,y){var b=y&&y.that,E=!!(y&&y.AS_ENTRIES),v=!!(y&&y.IS_RECORD),T=!!(y&&y.IS_ITERATOR),_=!!(y&&y.INTERRUPTED),M=t(p,b),I,H,V,N,j,z,te,ue=function(Q){return I&&u(I,"normal"),new h(!0,Q)},G=function(Q){return E?(r(Q),_?M(Q[0],Q[1],ue):M(Q[0],Q[1])):_?M(Q,ue):M(Q)};if(v)I=g.iterator;else if(T)I=g;else{if(H=l(g),!H)throw new c(n(g)+" is not iterable");if(i(H)){for(V=0,N=o(g);N>V;V++)if(j=G(g[V]),j&&s(d,j))return j;return new h(!1)}I=a(g,H)}for(z=v?g.next:I.next;!(te=e(z,I)).done;){try{j=G(te.value)}catch(Q){u(I,"throw",Q)}if(typeof j=="object"&&j&&s(d,j))return j}return new h(!1)},Kh}var Xh,Jv;function pT(){if(Jv)return Xh;Jv=1;var t=Dr(),e=bi(),r=bu();return Xh=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Xh}var ey;function CI(){if(ey)return zv;ey=1;var t=Le(),e=ss(),r=pT();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),zv}CI();var ty={},Zh,ry;function Cn(){if(ry)return Zh;ry=1;var t=et(),e=Set.prototype;return Zh={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Zh}var Qh,ny;function io(){if(ny)return Qh;ny=1;var t=Cn().has;return Qh=function(e){return t(e),e},Qh}var Jh,iy;function oo(){if(iy)return Jh;iy=1;var t=mt();return Jh=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},Jh}var ed,oy;function Ia(){if(oy)return ed;oy=1;var t=et(),e=oo(),r=Cn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return ed=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},ed}var td,sy;function tm(){if(sy)return td;sy=1;var t=Cn(),e=Ia(),r=t.Set,n=t.add;return td=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},td}var rd,ay;function Pa(){if(ay)return rd;ay=1;var t=aT(),e=Cn();return rd=t(e.proto,"size","get")||function(r){return r.size},rd}var nd,ly;function Ci(){return ly||(ly=1,nd=function(t){return{iterator:t,next:t.next,done:!1}}),nd}var id,uy;function so(){if(uy)return id;uy=1;var t=mr(),e=pt(),r=mt(),n=Oa(),i=Ci(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},id=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},id}var od,cy;function SI(){if(cy)return od;cy=1;var t=io(),e=Cn(),r=tm(),n=Pa(),i=so(),o=Ia(),s=oo(),a=e.has,l=e.remove;return od=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(p){d.includes(p)&&l(g,p)}):s(d.getIterator(),function(p){a(g,p)&&l(g,p)}),g},od}var sd,hy;function ao(){if(hy)return sd;hy=1;var t=rs(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return sd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},sd}var dy;function RI(){if(dy)return ty;dy=1;var t=Le(),e=SI(),r=st(),n=ao(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),ty}RI();var fy={},ad,gy;function TI(){if(gy)return ad;gy=1;var t=io(),e=Cn(),r=Pa(),n=so(),i=Ia(),o=oo(),s=e.Set,a=e.add,l=e.has;return ad=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(p){l(h,p)&&a(g,p)}):i(h,function(p){d.includes(p)&&a(g,p)}),g},ad}var my;function EI(){if(my)return fy;my=1;var t=Le(),e=st(),r=TI(),n=ao(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),fy}EI();var py={},ld,wy;function _I(){if(wy)return ld;wy=1;var t=io(),e=Cn().has,r=Pa(),n=so(),i=Ia(),o=oo(),s=pr();return ld=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},ld}var vy;function OI(){if(vy)return py;vy=1;var t=Le(),e=_I(),r=ao(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),py}OI();var yy={},ud,by;function MI(){if(by)return ud;by=1;var t=io(),e=Pa(),r=Ia(),n=so();return ud=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},ud}var Cy;function II(){if(Cy)return yy;Cy=1;var t=Le(),e=MI(),r=ao(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),yy}II();var Sy={},cd,Ry;function PI(){if(Ry)return cd;Ry=1;var t=io(),e=Cn().has,r=Pa(),n=so(),i=oo(),o=pr();return cd=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},cd}var Ty;function xI(){if(Ty)return Sy;Ty=1;var t=Le(),e=PI(),r=ao(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Sy}xI();var Ey={},hd,_y;function HI(){if(_y)return hd;_y=1;var t=io(),e=Cn(),r=tm(),n=so(),i=oo(),o=e.add,s=e.has,a=e.remove;return hd=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},hd}var dd,Oy;function wT(){return Oy||(Oy=1,dd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),dd}var My;function AI(){if(My)return Ey;My=1;var t=Le(),e=HI(),r=wT(),n=ao(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Ey}AI();var Iy={},fd,Py;function DI(){if(Py)return fd;Py=1;var t=io(),e=Cn().add,r=tm(),n=so(),i=oo();return fd=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},fd}var xy;function NI(){if(xy)return Iy;xy=1;var t=Le(),e=DI(),r=wT(),n=ao(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),Iy}NI();var Hy={},Ay={},gd,Dy;function kI(){if(Dy)return gd;Dy=1;var t=Ea(),e=TypeError;return gd=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},gd}var md,Ny;function LI(){if(Ny)return md;Ny=1;var t=st();return md=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),md}var pd,ky;function vT(){if(ky)return pd;ky=1;var t=kr(),e=at(),r=ns(),n=Zg(),i=LI(),o=n("IE_PROTO"),s=Object,a=s.prototype;return pd=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},pd}var wd,Ly;function FI(){if(Ly)return wd;Ly=1;var t=iT(),e=bi();return wd=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},wd}var vd={},yd,Fy;function VI(){if(Fy)return yd;Fy=1;var t=oT(),e=em();return yd=Object.keys||function(n){return t(n,e)},yd}var Vy;function WI(){if(Vy)return vd;Vy=1;var t=Dr(),e=rT(),r=bi(),n=pt(),i=Ta(),o=VI();return vd.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},vd}var bd,Wy;function yT(){if(Wy)return bd;Wy=1;var t=rs();return bd=t("document","documentElement"),bd}var Cd,By;function rm(){if(By)return Cd;By=1;var t=pt(),e=WI(),r=em(),n=Qg(),i=yT(),o=Xg(),s=Zg(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(v){return l+c+a+v+l+"/"+c+a},p=function(v){v.write(g("")),v.close();var T=v.parentWindow.Object;return v=null,T},y=function(){var v=o("iframe"),T="java"+c+":",_;return v.style.display="none",i.appendChild(v),v.src=String(T),_=v.contentWindow.document,_.open(),_.write(g("document.F=Object")),_.close(),_.F},b,E=function(){try{b=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&b?p(b):y():p(b);for(var v=r.length;v--;)delete E[u][r[v]];return E()};return n[h]=!0,Cd=Object.create||function(T,_){var M;return T!==null?(d[u]=t(T),M=new d,d[u]=null,M[h]=T):M=E(),_===void 0?M:e.f(M,_)},Cd}var Sd,$y;function bT(){if($y)return Sd;$y=1;var t=st(),e=at(),r=Nr(),n=rm(),i=vT(),o=Jg(),s=en(),a=no(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var p={};return c[l].call(p)!==p});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),Sd={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Sd}var jy;function BI(){if(jy)return Ay;jy=1;var t=Le(),e=Je(),r=kI(),n=pt(),i=at(),o=vT(),s=FI(),a=pT(),l=st(),u=kr(),c=en(),h=bT().IteratorPrototype,d=Dr(),g=no(),p="constructor",y="Iterator",b=c("toStringTag"),E=TypeError,v=e[y],T=g||!i(v)||v.prototype!==h||!l(function(){v({})}),_=function(){if(r(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},M=function(I,H){d?s(h,I,{configurable:!0,get:function(){return H},set:function(V){if(n(this),this===h)throw new E("You can't redefine this property");u(this,I)?this[I]=V:a(this,I,V)}}):h[I]=H};return u(h,b)||M(b,y),(T||!u(h,p)||h[p]===Object)&&M(p,_),_.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:_}),Ay}var zy;function $I(){return zy||(zy=1,BI()),Hy}$I();var Uy={},Yy={},Rd,qy;function jI(){if(qy)return Rd;qy=1;var t=Jg();return Rd=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},Rd}var Td,Gy;function zI(){return Gy||(Gy=1,Td=function(t,e){return{value:t,done:e}}),Td}var Ed,Ky;function UI(){if(Ky)return Ed;Ky=1;var t=pr();return Ed=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},Ed}var _d,Xy;function CT(){if(Xy)return _d;Xy=1;var t=mt(),e=rm(),r=is(),n=jI(),i=en(),o=nT(),s=_a(),a=bT().IteratorPrototype,l=zI(),u=pr(),c=UI(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",p="normal",y="throw",b=o.set,E=function(_){var M=o.getterFor(_?g:d);return n(e(a),{next:function(){var H=M(this);if(_)return H.nextHandler();if(H.done)return l(void 0,!0);try{var V=H.nextHandler();return H.returnHandlerResult?V:l(V,H.done)}catch(N){throw H.done=!0,N}},return:function(){var I=M(this),H=I.iterator;if(I.done=!0,_){var V=s(H,"return");return V?t(V,H):l(void 0,!0)}if(I.inner)try{u(I.inner.iterator,p)}catch(N){return u(H,y,N)}if(I.openIters)try{c(I.openIters,p)}catch(N){return u(H,y,N)}return H&&u(H,p),l(void 0,!0)}})},v=E(!0),T=E(!1);return r(T,h,"Iterator Helper"),_d=function(_,M,I){var H=function(N,j){j?(j.iterator=N.iterator,j.next=N.next):j=N,j.type=M?g:d,j.returnHandlerResult=!!I,j.nextHandler=_,j.counter=0,j.done=!1,b(this,j)};return H.prototype=M?v:T,H},_d}var Od,Zy;function ST(){if(Zy)return Od;Zy=1;var t=pt(),e=pr();return Od=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},Od}var Md,Qy;function RT(){return Qy||(Qy=1,Md=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),Md}var Id,Jy;function lo(){if(Jy)return Id;Jy=1;var t=Je();return Id=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},Id}var eb;function YI(){if(eb)return Yy;eb=1;var t=Le(),e=mt(),r=mr(),n=pt(),i=Ci(),o=CT(),s=ST(),a=no(),l=pr(),u=RT(),c=lo(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,p=o(function(){for(var y=this.iterator,b=this.predicate,E=this.next,v,T,_;;){if(v=n(e(E,y)),T=this.done=!!v.done,T)return;if(_=v.value,s(y,b,[_,this.counter++],!0))return _}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(E){l(this,"throw",E)}return d?e(d,this,b):new p(i(this),{predicate:b})}}),Yy}var tb;function qI(){return tb||(tb=1,YI()),Uy}qI();var rb={},nb={},ib;function GI(){if(ib)return nb;ib=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),nb}var ob;function KI(){return ob||(ob=1,GI()),rb}KI();var sb={},ab={},lb;function XI(){if(lb)return ab;lb=1;var t=Le(),e=mt(),r=mr(),n=pt(),i=Ci(),o=CT(),s=ST(),a=pr(),l=RT(),u=lo(),c=no(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,p=o(function(){var y=this.iterator,b=n(e(this.next,y)),E=this.done=!!b.done;if(!E)return s(y,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new p(i(this),{mapper:b})}}),ab}var ub;function ZI(){return ub||(ub=1,XI()),sb}ZI();var cb={},hb={},Pd,db;function nm(){if(db)return Pd;db=1;var t=et();return Pd=t([].slice),Pd}var xd,fb;function TT(){if(fb)return xd;fb=1;var t=TypeError;return xd=function(e,r){if(e<r)throw new t("Not enough arguments");return e},xd}var Hd,gb;function QI(){if(gb)return Hd;gb=1;var t=Cu();return Hd=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Hd}var Ad,mb;function ET(){if(mb)return Ad;mb=1;var t=Je(),e=Cu(),r=ro(),n=function(i){return e.slice(0,i.length)===i};return Ad=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),Ad}var Dd,pb;function JI(){if(pb)return Dd;pb=1;var t=ET();return Dd=t==="NODE",Dd}var Nd,wb;function _T(){if(wb)return Nd;wb=1;var t=Je(),e=Ma(),r=fT(),n=at(),i=kr(),o=st(),s=yT(),a=nm(),l=Xg(),u=TT(),c=QI(),h=JI(),d=t.setImmediate,g=t.clearImmediate,p=t.process,y=t.Dispatch,b=t.Function,E=t.MessageChannel,v=t.String,T=0,_={},M="onreadystatechange",I,H,V,N;o(function(){I=t.location});var j=function(G){if(i(_,G)){var Q=_[G];delete _[G],Q()}},z=function(G){return function(){j(G)}},te=function(G){j(G.data)},ue=function(G){t.postMessage(v(G),I.protocol+"//"+I.host)};return(!d||!g)&&(d=function(Q){u(arguments.length,1);var lt=n(Q)?Q:b(Q),ae=a(arguments,1);return _[++T]=function(){e(lt,void 0,ae)},H(T),T},g=function(Q){delete _[Q]},h?H=function(G){p.nextTick(z(G))}:y&&y.now?H=function(G){y.now(z(G))}:E&&!c?(V=new E,N=V.port2,V.port1.onmessage=te,H=r(N.postMessage,N)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&I&&I.protocol!=="file:"&&!o(ue)?(H=ue,t.addEventListener("message",te,!1)):M in l("script")?H=function(G){s.appendChild(l("script"))[M]=function(){s.removeChild(this),j(G)}}:H=function(G){setTimeout(z(G),0)}),Nd={set:d,clear:g},Nd}var vb;function eP(){if(vb)return hb;vb=1;var t=Le(),e=Je(),r=_T().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),hb}var yb={},kd,bb;function tP(){if(bb)return kd;bb=1;var t=Je(),e=Ma(),r=at(),n=ET(),i=Cu(),o=nm(),s=TT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return kd=function(u,c){var h=c?2:1;return l?function(d,g){var p=s(arguments.length,1)>h,y=r(d)?d:a(d),b=p?o(arguments,h):[],E=p?function(){e(y,this,b)}:y;return c?u(E,g):u(E)}:u},kd}var Cb;function rP(){if(Cb)return yb;Cb=1;var t=Le(),e=Je(),r=_T().set,n=tP(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),yb}var Sb;function nP(){return Sb||(Sb=1,eP(),rP()),cb}nP();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:OT,setPrototypeOf:Rb,isFrozen:iP,getPrototypeOf:oP,getOwnPropertyDescriptor:sP}=Object;let{freeze:kt,seal:Ar,create:MT}=Object,{apply:rg,construct:ng}=typeof Reflect<"u"&&Reflect;kt||(kt=function(e){return e});Ar||(Ar=function(e){return e});rg||(rg=function(e,r,n){return e.apply(r,n)});ng||(ng=function(e,r){return new e(...r)});const ja=Lt(Array.prototype.forEach),aP=Lt(Array.prototype.lastIndexOf),Tb=Lt(Array.prototype.pop),ws=Lt(Array.prototype.push),lP=Lt(Array.prototype.splice),kl=Lt(String.prototype.toLowerCase),Ld=Lt(String.prototype.toString),Eb=Lt(String.prototype.match),vs=Lt(String.prototype.replace),uP=Lt(String.prototype.indexOf),cP=Lt(String.prototype.trim),Yr=Lt(Object.prototype.hasOwnProperty),Pt=Lt(RegExp.prototype.test),ys=hP(TypeError);function Lt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return rg(t,e,n)}}function hP(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ng(t,r)}}function he(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kl;Rb&&Rb(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(iP(e)||(e[n]=o),i=o)}t[i]=!0}return t}function dP(t){for(let e=0;e<t.length;e++)Yr(t,e)||(t[e]=null);return t}function kn(t){const e=MT(null);for(const[r,n]of OT(t))Yr(t,r)&&(Array.isArray(n)?e[r]=dP(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=kn(n):e[r]=n);return e}function bs(t,e){for(;t!==null;){const n=sP(t,e);if(n){if(n.get)return Lt(n.get);if(typeof n.value=="function")return Lt(n.value)}t=oP(t)}function r(){return null}return r}const _b=kt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Fd=kt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Vd=kt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fP=kt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Wd=kt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),gP=kt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ob=kt(["#text"]),Mb=kt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Bd=kt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ib=kt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),za=kt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),mP=Ar(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pP=Ar(/<%[\w\W]*|[\w\W]*%>/gm),wP=Ar(/\$\{[\w\W]*/gm),vP=Ar(/^data-[\-\w.\u00B7-\uFFFF]+$/),yP=Ar(/^aria-[\-\w]+$/),IT=Ar(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bP=Ar(/^(?:\w+script|data):/i),CP=Ar(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),PT=Ar(/^html$/i),SP=Ar(/^[a-z][.\w]*(-[.\w]+)+$/i);var Pb=Object.freeze({__proto__:null,ARIA_ATTR:yP,ATTR_WHITESPACE:CP,CUSTOM_ELEMENT:SP,DATA_ATTR:vP,DOCTYPE_NAME:PT,ERB_EXPR:pP,IS_ALLOWED_URI:IT,IS_SCRIPT_OR_DATA:bP,MUSTACHE_EXPR:mP,TMPLIT_EXPR:wP});const Cs={element:1,text:3,progressingInstruction:7,comment:8,document:9},RP=function(){return typeof window>"u"?null:window},TP=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},xb=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function xT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:RP();const e=K=>xT(K);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Cs.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,p=l.prototype,y=bs(p,"cloneNode"),b=bs(p,"remove"),E=bs(p,"nextSibling"),v=bs(p,"childNodes"),T=bs(p,"parentNode");if(typeof s=="function"){const K=r.createElement("template");K.content&&K.content.ownerDocument&&(r=K.content.ownerDocument)}let _,M="";const{implementation:I,createNodeIterator:H,createDocumentFragment:V,getElementsByTagName:N}=r,{importNode:j}=n;let z=xb();e.isSupported=typeof OT=="function"&&typeof T=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:te,ERB_EXPR:ue,TMPLIT_EXPR:G,DATA_ATTR:Q,ARIA_ATTR:lt,IS_SCRIPT_OR_DATA:ae,ATTR_WHITESPACE:be,CUSTOM_ELEMENT:Ge}=Pb;let{IS_ALLOWED_URI:vr}=Pb,Ee=null;const f=he({},[..._b,...Fd,...Vd,...Wd,...Ob]);let m=null;const w=he({},[...Mb,...Bd,...Ib,...za]);let C=Object.seal(MT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),R=null,O=null,P=!0,A=!0,Y=!1,B=!0,x=!1,oe=!0,$=!1,ee=!1,Ce=!1,Ie=!1,de=!1,fe=!1,re=!0,_e=!1;const Ue="user-content-";let dt=!0,yr=!1,Ct={},St=null;const br=he({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Zn=null;const Qn=he({},["audio","video","img","source","image","track"]);let fo=null;const fs=he({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jn="http://www.w3.org/1998/Math/MathML",Ft="http://www.w3.org/2000/svg",Vt="http://www.w3.org/1999/xhtml";let ir=Vt,En=!1,Wt=null;const Cr=he({},[Jn,Ft,Vt],Ld);let Ri=he({},["mi","mo","mn","ms","mtext"]),Ti=he({},["annotation-xml"]);const _O=he({},["title","style","font","a","script"]);let gs=null;const OO=["application/xhtml+xml","text/html"],MO="text/html";let ft=null,go=null;const IO=r.createElement("form"),jp=function(S){return S instanceof RegExp||S instanceof Function},sc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(go&&go===S)){if((!S||typeof S!="object")&&(S={}),S=kn(S),gs=OO.indexOf(S.PARSER_MEDIA_TYPE)===-1?MO:S.PARSER_MEDIA_TYPE,ft=gs==="application/xhtml+xml"?Ld:kl,Ee=Yr(S,"ALLOWED_TAGS")?he({},S.ALLOWED_TAGS,ft):f,m=Yr(S,"ALLOWED_ATTR")?he({},S.ALLOWED_ATTR,ft):w,Wt=Yr(S,"ALLOWED_NAMESPACES")?he({},S.ALLOWED_NAMESPACES,Ld):Cr,fo=Yr(S,"ADD_URI_SAFE_ATTR")?he(kn(fs),S.ADD_URI_SAFE_ATTR,ft):fs,Zn=Yr(S,"ADD_DATA_URI_TAGS")?he(kn(Qn),S.ADD_DATA_URI_TAGS,ft):Qn,St=Yr(S,"FORBID_CONTENTS")?he({},S.FORBID_CONTENTS,ft):br,R=Yr(S,"FORBID_TAGS")?he({},S.FORBID_TAGS,ft):kn({}),O=Yr(S,"FORBID_ATTR")?he({},S.FORBID_ATTR,ft):kn({}),Ct=Yr(S,"USE_PROFILES")?S.USE_PROFILES:!1,P=S.ALLOW_ARIA_ATTR!==!1,A=S.ALLOW_DATA_ATTR!==!1,Y=S.ALLOW_UNKNOWN_PROTOCOLS||!1,B=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,x=S.SAFE_FOR_TEMPLATES||!1,oe=S.SAFE_FOR_XML!==!1,$=S.WHOLE_DOCUMENT||!1,Ie=S.RETURN_DOM||!1,de=S.RETURN_DOM_FRAGMENT||!1,fe=S.RETURN_TRUSTED_TYPE||!1,Ce=S.FORCE_BODY||!1,re=S.SANITIZE_DOM!==!1,_e=S.SANITIZE_NAMED_PROPS||!1,dt=S.KEEP_CONTENT!==!1,yr=S.IN_PLACE||!1,vr=S.ALLOWED_URI_REGEXP||IT,ir=S.NAMESPACE||Vt,Ri=S.MATHML_TEXT_INTEGRATION_POINTS||Ri,Ti=S.HTML_INTEGRATION_POINTS||Ti,C=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&jp(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&jp(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(A=!1),de&&(Ie=!0),Ct&&(Ee=he({},Ob),m=[],Ct.html===!0&&(he(Ee,_b),he(m,Mb)),Ct.svg===!0&&(he(Ee,Fd),he(m,Bd),he(m,za)),Ct.svgFilters===!0&&(he(Ee,Vd),he(m,Bd),he(m,za)),Ct.mathMl===!0&&(he(Ee,Wd),he(m,Ib),he(m,za))),S.ADD_TAGS&&(Ee===f&&(Ee=kn(Ee)),he(Ee,S.ADD_TAGS,ft)),S.ADD_ATTR&&(m===w&&(m=kn(m)),he(m,S.ADD_ATTR,ft)),S.ADD_URI_SAFE_ATTR&&he(fo,S.ADD_URI_SAFE_ATTR,ft),S.FORBID_CONTENTS&&(St===br&&(St=kn(St)),he(St,S.FORBID_CONTENTS,ft)),dt&&(Ee["#text"]=!0),$&&he(Ee,["html","head","body"]),Ee.table&&(he(Ee,["tbody"]),delete R.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw ys('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ys('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=S.TRUSTED_TYPES_POLICY,M=_.createHTML("")}else _===void 0&&(_=TP(g,i)),_!==null&&typeof M=="string"&&(M=_.createHTML(""));kt&&kt(S),go=S}},zp=he({},[...Fd,...Vd,...fP]),Up=he({},[...Wd,...gP]),PO=function(S){let k=T(S);(!k||!k.tagName)&&(k={namespaceURI:ir,tagName:"template"});const q=kl(S.tagName),je=kl(k.tagName);return Wt[S.namespaceURI]?S.namespaceURI===Ft?k.namespaceURI===Vt?q==="svg":k.namespaceURI===Jn?q==="svg"&&(je==="annotation-xml"||Ri[je]):!!zp[q]:S.namespaceURI===Jn?k.namespaceURI===Vt?q==="math":k.namespaceURI===Ft?q==="math"&&Ti[je]:!!Up[q]:S.namespaceURI===Vt?k.namespaceURI===Ft&&!Ti[je]||k.namespaceURI===Jn&&!Ri[je]?!1:!Up[q]&&(_O[q]||!zp[q]):!!(gs==="application/xhtml+xml"&&Wt[S.namespaceURI]):!1},nn=function(S){ws(e.removed,{element:S});try{T(S).removeChild(S)}catch{b(S)}},mo=function(S,k){try{ws(e.removed,{attribute:k.getAttributeNode(S),from:k})}catch{ws(e.removed,{attribute:null,from:k})}if(k.removeAttribute(S),S==="is")if(Ie||de)try{nn(k)}catch{}else try{k.setAttribute(S,"")}catch{}},Yp=function(S){let k=null,q=null;if(Ce)S="<remove></remove>"+S;else{const ut=Eb(S,/^[\r\n\t ]+/);q=ut&&ut[0]}gs==="application/xhtml+xml"&&ir===Vt&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const je=_?_.createHTML(S):S;if(ir===Vt)try{k=new d().parseFromString(je,gs)}catch{}if(!k||!k.documentElement){k=I.createDocument(ir,"template",null);try{k.documentElement.innerHTML=En?M:je}catch{}}const Rt=k.body||k.documentElement;return S&&q&&Rt.insertBefore(r.createTextNode(q),Rt.childNodes[0]||null),ir===Vt?N.call(k,$?"html":"body")[0]:$?k.documentElement:Rt},qp=function(S){return H.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},ac=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},Gp=function(S){return typeof a=="function"&&S instanceof a};function _n(K,S,k){ja(K,q=>{q.call(e,S,k,go)})}const Kp=function(S){let k=null;if(_n(z.beforeSanitizeElements,S,null),ac(S))return nn(S),!0;const q=ft(S.nodeName);if(_n(z.uponSanitizeElement,S,{tagName:q,allowedTags:Ee}),oe&&S.hasChildNodes()&&!Gp(S.firstElementChild)&&Pt(/<[/\w!]/g,S.innerHTML)&&Pt(/<[/\w!]/g,S.textContent)||S.nodeType===Cs.progressingInstruction||oe&&S.nodeType===Cs.comment&&Pt(/<[/\w]/g,S.data))return nn(S),!0;if(!Ee[q]||R[q]){if(!R[q]&&Zp(q)&&(C.tagNameCheck instanceof RegExp&&Pt(C.tagNameCheck,q)||C.tagNameCheck instanceof Function&&C.tagNameCheck(q)))return!1;if(dt&&!St[q]){const je=T(S)||S.parentNode,Rt=v(S)||S.childNodes;if(Rt&&je){const ut=Rt.length;for(let Bt=ut-1;Bt>=0;--Bt){const On=y(Rt[Bt],!0);On.__removalCount=(S.__removalCount||0)+1,je.insertBefore(On,E(S))}}}return nn(S),!0}return S instanceof l&&!PO(S)||(q==="noscript"||q==="noembed"||q==="noframes")&&Pt(/<\/no(script|embed|frames)/i,S.innerHTML)?(nn(S),!0):(x&&S.nodeType===Cs.text&&(k=S.textContent,ja([te,ue,G],je=>{k=vs(k,je," ")}),S.textContent!==k&&(ws(e.removed,{element:S.cloneNode()}),S.textContent=k)),_n(z.afterSanitizeElements,S,null),!1)},Xp=function(S,k,q){if(re&&(k==="id"||k==="name")&&(q in r||q in IO))return!1;if(!(A&&!O[k]&&Pt(Q,k))){if(!(P&&Pt(lt,k))){if(!m[k]||O[k]){if(!(Zp(S)&&(C.tagNameCheck instanceof RegExp&&Pt(C.tagNameCheck,S)||C.tagNameCheck instanceof Function&&C.tagNameCheck(S))&&(C.attributeNameCheck instanceof RegExp&&Pt(C.attributeNameCheck,k)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(k))||k==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&Pt(C.tagNameCheck,q)||C.tagNameCheck instanceof Function&&C.tagNameCheck(q))))return!1}else if(!fo[k]){if(!Pt(vr,vs(q,be,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&S!=="script"&&uP(q,"data:")===0&&Zn[S])){if(!(Y&&!Pt(ae,vs(q,be,"")))){if(q)return!1}}}}}}return!0},Zp=function(S){return S!=="annotation-xml"&&Eb(S,Ge)},Qp=function(S){_n(z.beforeSanitizeAttributes,S,null);const{attributes:k}=S;if(!k||ac(S))return;const q={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let je=k.length;for(;je--;){const Rt=k[je],{name:ut,namespaceURI:Bt,value:On}=Rt,ms=ft(ut),lc=On;let Tt=ut==="value"?lc:cP(lc);if(q.attrName=ms,q.attrValue=Tt,q.keepAttr=!0,q.forceKeepAttr=void 0,_n(z.uponSanitizeAttribute,S,q),Tt=q.attrValue,_e&&(ms==="id"||ms==="name")&&(mo(ut,S),Tt=Ue+Tt),oe&&Pt(/((--!?|])>)|<\/(style|title)/i,Tt)){mo(ut,S);continue}if(q.forceKeepAttr)continue;if(!q.keepAttr){mo(ut,S);continue}if(!B&&Pt(/\/>/i,Tt)){mo(ut,S);continue}x&&ja([te,ue,G],ew=>{Tt=vs(Tt,ew," ")});const Jp=ft(S.nodeName);if(!Xp(Jp,ms,Tt)){mo(ut,S);continue}if(_&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Bt)switch(g.getAttributeType(Jp,ms)){case"TrustedHTML":{Tt=_.createHTML(Tt);break}case"TrustedScriptURL":{Tt=_.createScriptURL(Tt);break}}if(Tt!==lc)try{Bt?S.setAttributeNS(Bt,ut,Tt):S.setAttribute(ut,Tt),ac(S)?nn(S):Tb(e.removed)}catch{mo(ut,S)}}_n(z.afterSanitizeAttributes,S,null)},xO=function K(S){let k=null;const q=qp(S);for(_n(z.beforeSanitizeShadowDOM,S,null);k=q.nextNode();)_n(z.uponSanitizeShadowNode,k,null),Kp(k),Qp(k),k.content instanceof o&&K(k.content);_n(z.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(K){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,q=null,je=null,Rt=null;if(En=!K,En&&(K="<!-->"),typeof K!="string"&&!Gp(K))if(typeof K.toString=="function"){if(K=K.toString(),typeof K!="string")throw ys("dirty is not a string, aborting")}else throw ys("toString is not a function");if(!e.isSupported)return K;if(ee||sc(S),e.removed=[],typeof K=="string"&&(yr=!1),yr){if(K.nodeName){const On=ft(K.nodeName);if(!Ee[On]||R[On])throw ys("root node is forbidden and cannot be sanitized in-place")}}else if(K instanceof a)k=Yp("<!---->"),q=k.ownerDocument.importNode(K,!0),q.nodeType===Cs.element&&q.nodeName==="BODY"||q.nodeName==="HTML"?k=q:k.appendChild(q);else{if(!Ie&&!x&&!$&&K.indexOf("<")===-1)return _&&fe?_.createHTML(K):K;if(k=Yp(K),!k)return Ie?null:fe?M:""}k&&Ce&&nn(k.firstChild);const ut=qp(yr?K:k);for(;je=ut.nextNode();)Kp(je),Qp(je),je.content instanceof o&&xO(je.content);if(yr)return K;if(Ie){if(de)for(Rt=V.call(k.ownerDocument);k.firstChild;)Rt.appendChild(k.firstChild);else Rt=k;return(m.shadowroot||m.shadowrootmode)&&(Rt=j.call(n,Rt,!0)),Rt}let Bt=$?k.outerHTML:k.innerHTML;return $&&Ee["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&Pt(PT,k.ownerDocument.doctype.name)&&(Bt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+Bt),x&&ja([te,ue,G],On=>{Bt=vs(Bt,On," ")}),_&&fe?_.createHTML(Bt):Bt},e.setConfig=function(){let K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};sc(K),ee=!0},e.clearConfig=function(){go=null,ee=!1},e.isValidAttribute=function(K,S,k){go||sc({});const q=ft(K),je=ft(S);return Xp(q,je,k)},e.addHook=function(K,S){typeof S=="function"&&ws(z[K],S)},e.removeHook=function(K,S){if(S!==void 0){const k=aP(z[K],S);return k===-1?void 0:lP(z[K],k,1)[0]}return Tb(z[K])},e.removeHooks=function(K){z[K]=[]},e.removeAllHooks=function(){z=xb()},e}var EP=xT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var HT;function L(){return HT.apply(null,arguments)}function _P(t){HT=t}function Qr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function qi(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Re(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function im(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Re(t,e))return!1;return!0}function qt(t){return t===void 0}function Un(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function xa(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function AT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function ci(t,e){for(var r in e)Re(e,r)&&(t[r]=e[r]);return Re(e,"toString")&&(t.toString=e.toString),Re(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Sn(t,e,r,n){return rE(t,e,r,n,!0).utc()}function OP(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function se(t){return t._pf==null&&(t._pf=OP()),t._pf}var ig;Array.prototype.some?ig=Array.prototype.some:ig=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function om(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=se(t),r=ig.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Tu(t){var e=Sn(NaN);return t!=null?ci(se(e),t):se(e).userInvalidated=!0,e}var Hb=L.momentProperties=[],$d=!1;function sm(t,e){var r,n,i,o=Hb.length;if(qt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),qt(e._i)||(t._i=e._i),qt(e._f)||(t._f=e._f),qt(e._l)||(t._l=e._l),qt(e._strict)||(t._strict=e._strict),qt(e._tzm)||(t._tzm=e._tzm),qt(e._isUTC)||(t._isUTC=e._isUTC),qt(e._offset)||(t._offset=e._offset),qt(e._pf)||(t._pf=se(e)),qt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=Hb[r],i=e[n],qt(i)||(t[n]=i);return t}function Ha(t){sm(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),$d===!1&&($d=!0,L.updateOffset(this),$d=!1)}function Jr(t){return t instanceof Ha||t!=null&&t._isAMomentObject!=null}function DT(t){L.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Lr(t,e){var r=!0;return ci(function(){if(L.deprecationHandler!=null&&L.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Re(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}DT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var Ab={};function NT(t,e){L.deprecationHandler!=null&&L.deprecationHandler(t,e),Ab[t]||(DT(e),Ab[t]=!0)}L.suppressDeprecationWarnings=!1;L.deprecationHandler=null;function Rn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function MP(t){var e,r;for(r in t)Re(t,r)&&(e=t[r],Rn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function og(t,e){var r=ci({},t),n;for(n in e)Re(e,n)&&(qi(t[n])&&qi(e[n])?(r[n]={},ci(r[n],t[n]),ci(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Re(t,n)&&!Re(e,n)&&qi(t[n])&&(r[n]=ci({},r[n]));return r}function am(t){t!=null&&this.set(t)}var sg;Object.keys?sg=Object.keys:sg=function(t){var e,r=[];for(e in t)Re(t,e)&&r.push(e);return r};var IP={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function PP(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Rn(n)?n.call(e,r):n}function vn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var lm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ua=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,jd={},jo={};function X(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(jo[t]=i),e&&(jo[e[0]]=function(){return vn(i.apply(this,arguments),e[1],e[2])}),r&&(jo[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function xP(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function HP(t){var e=t.match(lm),r,n;for(r=0,n=e.length;r<n;r++)jo[e[r]]?e[r]=jo[e[r]]:e[r]=xP(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Rn(e[s])?e[s].call(i,t):e[s];return o}}function Ll(t,e){return t.isValid()?(e=kT(e,t.localeData()),jd[e]=jd[e]||HP(e),jd[e](t)):t.localeData().invalidDate()}function kT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Ua.lastIndex=0;r>=0&&Ua.test(t);)t=t.replace(Ua,n),Ua.lastIndex=0,r-=1;return t}var AP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function DP(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(lm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var NP="Invalid date";function kP(){return this._invalidDate}var LP="%d",FP=/\d{1,2}/;function VP(t){return this._ordinal.replace("%d",t)}var WP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function BP(t,e,r,n){var i=this._relativeTime[r];return Rn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function $P(t,e){var r=this._relativeTime[t>0?"future":"past"];return Rn(r)?r(e):r.replace(/%s/i,e)}var Db={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Fr(t){return typeof t=="string"?Db[t]||Db[t.toLowerCase()]:void 0}function um(t){var e={},r,n;for(n in t)Re(t,n)&&(r=Fr(n),r&&(e[r]=t[n]));return e}var jP={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function zP(t){var e=[],r;for(r in t)Re(t,r)&&e.push({unit:r,priority:jP[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var LT=/\d/,wr=/\d\d/,FT=/\d{3}/,cm=/\d{4}/,Eu=/[+-]?\d{6}/,$e=/\d\d?/,VT=/\d\d\d\d?/,WT=/\d\d\d\d\d\d?/,_u=/\d{1,3}/,hm=/\d{1,4}/,Ou=/[+-]?\d{1,6}/,as=/\d+/,Mu=/[+-]?\d+/,UP=/Z|[+-]\d\d:?\d\d/gi,Iu=/Z|[+-]\d\d(?::?\d\d)?/gi,YP=/[+-]?\d+(\.\d{1,3})?/,Aa=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ls=/^[1-9]\d?/,dm=/^([1-9]\d|\d)/,tu;tu={};function W(t,e,r){tu[t]=Rn(e)?e:function(n,i){return n&&r?r:e}}function qP(t,e){return Re(tu,t)?tu[t](e._strict,e._locale):new RegExp(GP(t))}function GP(t){return $n(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function $n(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ir(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function pe(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Ir(e)),r}var ag={};function xe(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Un(e)&&(n=function(o,s){s[e]=pe(o)}),i=t.length,r=0;r<i;r++)ag[t[r]]=n}function Da(t,e){xe(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function KP(t,e,r){e!=null&&Re(ag,t)&&ag[t](e,r._a,r,t)}function Pu(t){return t%4===0&&t%100!==0||t%400===0}var Mt=0,Wn=1,gn=2,ht=3,Xr=4,Bn=5,zi=6,XP=7,ZP=8;X("Y",0,0,function(){var t=this.year();return t<=9999?vn(t,4):"+"+t});X(0,["YY",2],0,function(){return this.year()%100});X(0,["YYYY",4],0,"year");X(0,["YYYYY",5],0,"year");X(0,["YYYYYY",6,!0],0,"year");W("Y",Mu);W("YY",$e,wr);W("YYYY",hm,cm);W("YYYYY",Ou,Eu);W("YYYYYY",Ou,Eu);xe(["YYYYY","YYYYYY"],Mt);xe("YYYY",function(t,e){e[Mt]=t.length===2?L.parseTwoDigitYear(t):pe(t)});xe("YY",function(t,e){e[Mt]=L.parseTwoDigitYear(t)});xe("Y",function(t,e){e[Mt]=parseInt(t,10)});function oa(t){return Pu(t)?366:365}L.parseTwoDigitYear=function(t){return pe(t)+(pe(t)>68?1900:2e3)};var BT=us("FullYear",!0);function QP(){return Pu(this.year())}function us(t,e){return function(r){return r!=null?($T(this,t,r),L.updateOffset(this,e),this):ga(this,t)}}function ga(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function $T(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!Pu(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function JP(t){return t=Fr(t),Rn(this[t])?this[t]():this}function ex(t,e){if(typeof t=="object"){t=um(t);var r=zP(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Fr(t),Rn(this[t]))return this[t](e);return this}function tx(t,e){return(t%e+e)%e}var Qe;Array.prototype.indexOf?Qe=Array.prototype.indexOf:Qe=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function fm(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=tx(e,12);return t+=(e-r)/12,r===1?Pu(t)?29:28:31-r%7%2}X("M",["MM",2],"Mo",function(){return this.month()+1});X("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});X("MMMM",0,0,function(t){return this.localeData().months(this,t)});W("M",$e,ls);W("MM",$e,wr);W("MMM",function(t,e){return e.monthsShortRegex(t)});W("MMMM",function(t,e){return e.monthsRegex(t)});xe(["M","MM"],function(t,e){e[Wn]=pe(t)-1});xe(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Wn]=i:se(r).invalidMonth=t});var rx="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),zT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,nx=Aa,ix=Aa;function ox(t,e){return t?Qr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||zT).test(e)?"format":"standalone"][t.month()]:Qr(this._months)?this._months:this._months.standalone}function sx(t,e){return t?Qr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[zT.test(e)?"format":"standalone"][t.month()]:Qr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ax(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Sn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Qe.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:(i=Qe.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Qe.call(this._longMonthsParse,s),i!==-1?i:(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:null))}function lx(t,e,r){var n,i,o;if(this._monthsParseExact)return ax.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Sn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function UT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=pe(e);else if(e=t.localeData().monthsParse(e),!Un(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,fm(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function YT(t){return t!=null?(UT(this,t),L.updateOffset(this,!0),this):ga(this,"Month")}function ux(){return fm(this.year(),this.month())}function cx(t){return this._monthsParseExact?(Re(this,"_monthsRegex")||qT.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Re(this,"_monthsShortRegex")||(this._monthsShortRegex=nx),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function hx(t){return this._monthsParseExact?(Re(this,"_monthsRegex")||qT.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Re(this,"_monthsRegex")||(this._monthsRegex=ix),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function qT(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=Sn([2e3,i]),s=$n(this.monthsShort(o,"")),a=$n(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function dx(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function ma(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function ru(t,e,r){var n=7+e-r,i=(7+ma(t,0,n).getUTCDay()-e)%7;return-i+n-1}function GT(t,e,r,n,i){var o=(7+r-n)%7,s=ru(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=oa(l)+a):a>oa(t)?(l=t+1,u=a-oa(t)):(l=t,u=a),{year:l,dayOfYear:u}}function pa(t,e,r){var n=ru(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+jn(s,e,r)):i>jn(t.year(),e,r)?(o=i-jn(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function jn(t,e,r){var n=ru(t,e,r),i=ru(t+1,e,r);return(oa(t)-n+i)/7}X("w",["ww",2],"wo","week");X("W",["WW",2],"Wo","isoWeek");W("w",$e,ls);W("ww",$e,wr);W("W",$e,ls);W("WW",$e,wr);Da(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=pe(t)});function fx(t){return pa(t,this._week.dow,this._week.doy).week}var gx={dow:0,doy:6};function mx(){return this._week.dow}function px(){return this._week.doy}function wx(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function vx(t){var e=pa(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}X("d",0,"do","day");X("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});X("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});X("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});X("e",0,0,"weekday");X("E",0,0,"isoWeekday");W("d",$e);W("e",$e);W("E",$e);W("dd",function(t,e){return e.weekdaysMinRegex(t)});W("ddd",function(t,e){return e.weekdaysShortRegex(t)});W("dddd",function(t,e){return e.weekdaysRegex(t)});Da(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:se(r).invalidWeekday=t});Da(["d","e","E"],function(t,e,r,n){e[n]=pe(t)});function yx(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function bx(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function gm(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Cx="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),KT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Sx="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Rx=Aa,Tx=Aa,Ex=Aa;function _x(t,e){var r=Qr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?gm(r,this._week.dow):t?r[t.day()]:r}function Ox(t){return t===!0?gm(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Mx(t){return t===!0?gm(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Ix(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Sn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Qe.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Qe.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Qe.call(this._weekdaysParse,s),i!==-1||(i=Qe.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Qe.call(this._shortWeekdaysParse,s),i!==-1||(i=Qe.call(this._weekdaysParse,s),i!==-1)?i:(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Qe.call(this._minWeekdaysParse,s),i!==-1||(i=Qe.call(this._weekdaysParse,s),i!==-1)?i:(i=Qe.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function Px(t,e,r){var n,i,o;if(this._weekdaysParseExact)return Ix.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Sn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function xx(t){if(!this.isValid())return t!=null?this:NaN;var e=ga(this,"Day");return t!=null?(t=yx(t,this.localeData()),this.add(t-e,"d")):e}function Hx(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Ax(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=bx(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Dx(t){return this._weekdaysParseExact?(Re(this,"_weekdaysRegex")||mm.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Re(this,"_weekdaysRegex")||(this._weekdaysRegex=Rx),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Nx(t){return this._weekdaysParseExact?(Re(this,"_weekdaysRegex")||mm.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Re(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Tx),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function kx(t){return this._weekdaysParseExact?(Re(this,"_weekdaysRegex")||mm.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Re(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ex),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function mm(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Sn([2e3,1]).day(o),a=$n(this.weekdaysMin(s,"")),l=$n(this.weekdaysShort(s,"")),u=$n(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function pm(){return this.hours()%12||12}function Lx(){return this.hours()||24}X("H",["HH",2],0,"hour");X("h",["hh",2],0,pm);X("k",["kk",2],0,Lx);X("hmm",0,0,function(){return""+pm.apply(this)+vn(this.minutes(),2)});X("hmmss",0,0,function(){return""+pm.apply(this)+vn(this.minutes(),2)+vn(this.seconds(),2)});X("Hmm",0,0,function(){return""+this.hours()+vn(this.minutes(),2)});X("Hmmss",0,0,function(){return""+this.hours()+vn(this.minutes(),2)+vn(this.seconds(),2)});function XT(t,e){X(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}XT("a",!0);XT("A",!1);function ZT(t,e){return e._meridiemParse}W("a",ZT);W("A",ZT);W("H",$e,dm);W("h",$e,ls);W("k",$e,ls);W("HH",$e,wr);W("hh",$e,wr);W("kk",$e,wr);W("hmm",VT);W("hmmss",WT);W("Hmm",VT);W("Hmmss",WT);xe(["H","HH"],ht);xe(["k","kk"],function(t,e,r){var n=pe(t);e[ht]=n===24?0:n});xe(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});xe(["h","hh"],function(t,e,r){e[ht]=pe(t),se(r).bigHour=!0});xe("hmm",function(t,e,r){var n=t.length-2;e[ht]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n)),se(r).bigHour=!0});xe("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ht]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n,2)),e[Bn]=pe(t.substr(i)),se(r).bigHour=!0});xe("Hmm",function(t,e,r){var n=t.length-2;e[ht]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n))});xe("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ht]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n,2)),e[Bn]=pe(t.substr(i))});function Fx(t){return(t+"").toLowerCase().charAt(0)==="p"}var Vx=/[ap]\.?m?\.?/i,Wx=us("Hours",!0);function Bx(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var QT={calendar:IP,longDateFormat:AP,invalidDate:NP,ordinal:LP,dayOfMonthOrdinalParse:FP,relativeTime:WP,months:rx,monthsShort:jT,week:gx,weekdays:Cx,weekdaysMin:Sx,weekdaysShort:KT,meridiemParse:Vx},ze={},Ss={},wa;function $x(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function Nb(t){return t&&t.toLowerCase().replace("_","-")}function jx(t){for(var e=0,r,n,i,o;e<t.length;){for(o=Nb(t[e]).split("-"),r=o.length,n=Nb(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=xu(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&$x(o,n)>=r-1)break;r--}e++}return wa}function zx(t){return!!(t&&t.match("^[^/\\\\]*$"))}function xu(t){var e=null,r;if(ze[t]===void 0&&typeof ql<"u"&&ql&&ql.exports&&zx(t))try{e=wa._abbr,r=require,r("./locale/"+t),gi(e)}catch{ze[t]=null}return ze[t]}function gi(t,e){var r;return t&&(qt(e)?r=qn(t):r=wm(t,e),r?wa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),wa._abbr}function wm(t,e){if(e!==null){var r,n=QT;if(e.abbr=t,ze[t]!=null)NT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ze[t]._config;else if(e.parentLocale!=null)if(ze[e.parentLocale]!=null)n=ze[e.parentLocale]._config;else if(r=xu(e.parentLocale),r!=null)n=r._config;else return Ss[e.parentLocale]||(Ss[e.parentLocale]=[]),Ss[e.parentLocale].push({name:t,config:e}),null;return ze[t]=new am(og(n,e)),Ss[t]&&Ss[t].forEach(function(i){wm(i.name,i.config)}),gi(t),ze[t]}else return delete ze[t],null}function Ux(t,e){if(e!=null){var r,n,i=QT;ze[t]!=null&&ze[t].parentLocale!=null?ze[t].set(og(ze[t]._config,e)):(n=xu(t),n!=null&&(i=n._config),e=og(i,e),n==null&&(e.abbr=t),r=new am(e),r.parentLocale=ze[t],ze[t]=r),gi(t)}else ze[t]!=null&&(ze[t].parentLocale!=null?(ze[t]=ze[t].parentLocale,t===gi()&&gi(t)):ze[t]!=null&&delete ze[t]);return ze[t]}function qn(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return wa;if(!Qr(t)){if(e=xu(t),e)return e;t=[t]}return jx(t)}function Yx(){return sg(ze)}function vm(t){var e,r=t._a;return r&&se(t).overflow===-2&&(e=r[Wn]<0||r[Wn]>11?Wn:r[gn]<1||r[gn]>fm(r[Mt],r[Wn])?gn:r[ht]<0||r[ht]>24||r[ht]===24&&(r[Xr]!==0||r[Bn]!==0||r[zi]!==0)?ht:r[Xr]<0||r[Xr]>59?Xr:r[Bn]<0||r[Bn]>59?Bn:r[zi]<0||r[zi]>999?zi:-1,se(t)._overflowDayOfYear&&(e<Mt||e>gn)&&(e=gn),se(t)._overflowWeeks&&e===-1&&(e=XP),se(t)._overflowWeekday&&e===-1&&(e=ZP),se(t).overflow=e),t}var qx=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Gx=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Kx=/Z|[+-]\d\d(?::?\d\d)?/,Ya=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],zd=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Xx=/^\/?Date\((-?\d+)/i,Zx=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Qx={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function JT(t){var e,r,n=t._i,i=qx.exec(n)||Gx.exec(n),o,s,a,l,u=Ya.length,c=zd.length;if(i){for(se(t).iso=!0,e=0,r=u;e<r;e++)if(Ya[e][1].exec(i[1])){s=Ya[e][0],o=Ya[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(zd[e][1].exec(i[3])){a=(i[2]||" ")+zd[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(Kx.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),bm(t)}else t._isValid=!1}function Jx(t,e,r,n,i,o){var s=[eH(t),jT.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function eH(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function tH(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function rH(t,e,r){if(t){var n=KT.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return se(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function nH(t,e,r){if(t)return Qx[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function eE(t){var e=Zx.exec(tH(t._i)),r;if(e){if(r=Jx(e[4],e[3],e[2],e[5],e[6],e[7]),!rH(e[1],r,t))return;t._a=r,t._tzm=nH(e[8],e[9],e[10]),t._d=ma.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),se(t).rfc2822=!0}else t._isValid=!1}function iH(t){var e=Xx.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(JT(t),t._isValid===!1)delete t._isValid;else return;if(eE(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:L.createFromInputFallback(t)}L.createFromInputFallback=Lr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Lo(t,e,r){return t??e??r}function oH(t){var e=new Date(L.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ym(t){var e,r,n=[],i,o,s;if(!t._d){for(i=oH(t),t._w&&t._a[gn]==null&&t._a[Wn]==null&&sH(t),t._dayOfYear!=null&&(s=Lo(t._a[Mt],i[Mt]),(t._dayOfYear>oa(s)||t._dayOfYear===0)&&(se(t)._overflowDayOfYear=!0),r=ma(s,0,t._dayOfYear),t._a[Wn]=r.getUTCMonth(),t._a[gn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[ht]===24&&t._a[Xr]===0&&t._a[Bn]===0&&t._a[zi]===0&&(t._nextDay=!0,t._a[ht]=0),t._d=(t._useUTC?ma:dx).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[ht]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(se(t).weekdayMismatch=!0)}}function sH(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=Lo(e.GG,t._a[Mt],pa(Be(),1,4).year),n=Lo(e.W,1),i=Lo(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=pa(Be(),o,s),r=Lo(e.gg,t._a[Mt],u.year),n=Lo(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>jn(r,o,s)?se(t)._overflowWeeks=!0:l!=null?se(t)._overflowWeekday=!0:(a=GT(r,n,i,o,s),t._a[Mt]=a.year,t._dayOfYear=a.dayOfYear)}L.ISO_8601=function(){};L.RFC_2822=function(){};function bm(t){if(t._f===L.ISO_8601){JT(t);return}if(t._f===L.RFC_2822){eE(t);return}t._a=[],se(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=kT(t._f,t._locale).match(lm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(qP(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&se(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),jo[o]?(n?se(t).empty=!1:se(t).unusedTokens.push(o),KP(o,n,t)):t._strict&&!n&&se(t).unusedTokens.push(o);se(t).charsLeftOver=a-l,e.length>0&&se(t).unusedInput.push(e),t._a[ht]<=12&&se(t).bigHour===!0&&t._a[ht]>0&&(se(t).bigHour=void 0),se(t).parsedDateParts=t._a.slice(0),se(t).meridiem=t._meridiem,t._a[ht]=aH(t._locale,t._a[ht],t._meridiem),u=se(t).era,u!==null&&(t._a[Mt]=t._locale.erasConvertYear(u,t._a[Mt])),ym(t),vm(t)}function aH(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function lH(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){se(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=sm({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],bm(e),om(e)&&(s=!0),o+=se(e).charsLeftOver,o+=se(e).unusedTokens.length*10,se(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));ci(t,r||e)}function uH(t){if(!t._d){var e=um(t._i),r=e.day===void 0?e.date:e.day;t._a=AT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),ym(t)}}function cH(t){var e=new Ha(vm(tE(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function tE(t){var e=t._i,r=t._f;return t._locale=t._locale||qn(t._l),e===null||r===void 0&&e===""?Tu({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Jr(e)?new Ha(vm(e)):(xa(e)?t._d=e:Qr(r)?lH(t):r?bm(t):hH(t),om(t)||(t._d=null),t))}function hH(t){var e=t._i;qt(e)?t._d=new Date(L.now()):xa(e)?t._d=new Date(e.valueOf()):typeof e=="string"?iH(t):Qr(e)?(t._a=AT(e.slice(0),function(r){return parseInt(r,10)}),ym(t)):qi(e)?uH(t):Un(e)?t._d=new Date(e):L.createFromInputFallback(t)}function rE(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(qi(t)&&im(t)||Qr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,cH(o)}function Be(t,e,r,n){return rE(t,e,r,n,!1)}var dH=Lr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Be.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Tu()}),fH=Lr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Be.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Tu()});function nE(t,e){var r,n;if(e.length===1&&Qr(e[0])&&(e=e[0]),!e.length)return Be();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function gH(){var t=[].slice.call(arguments,0);return nE("isBefore",t)}function mH(){var t=[].slice.call(arguments,0);return nE("isAfter",t)}var pH=function(){return Date.now?Date.now():+new Date},Rs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function wH(t){var e,r=!1,n,i=Rs.length;for(e in t)if(Re(t,e)&&!(Qe.call(Rs,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Rs[n]]){if(r)return!1;parseFloat(t[Rs[n]])!==pe(t[Rs[n]])&&(r=!0)}return!0}function vH(){return this._isValid}function yH(){return tn(NaN)}function Hu(t){var e=um(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=wH(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=qn(),this._bubble()}function Fl(t){return t instanceof Hu}function lg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function bH(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)pe(t[s])!==pe(e[s])&&o++;return o+i}function iE(t,e){X(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+vn(~~(r/60),2)+e+vn(~~r%60,2)})}iE("Z",":");iE("ZZ","");W("Z",Iu);W("ZZ",Iu);xe(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=Cm(Iu,t)});var CH=/([\+\-]|\d\d)/gi;function Cm(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(CH)||["-",0,0],o=+(i[1]*60)+pe(i[2]),o===0?0:i[0]==="+"?o:-o)}function Sm(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Jr(t)||xa(t)?t.valueOf():Be(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),L.updateOffset(r,!1),r):Be(t).local()}function ug(t){return-Math.round(t._d.getTimezoneOffset())}L.updateOffset=function(){};function SH(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Cm(Iu,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=ug(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?aE(this,tn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,L.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:ug(this)}function RH(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function TH(t){return this.utcOffset(0,t)}function EH(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ug(this),"m")),this}function _H(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Cm(UP,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function OH(t){return this.isValid()?(t=t?Be(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function MH(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function IH(){if(!qt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return sm(t,this),t=tE(t),t._a?(e=t._isUTC?Sn(t._a):Be(t._a),this._isDSTShifted=this.isValid()&&bH(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function PH(){return this.isValid()?!this._isUTC:!1}function xH(){return this.isValid()?this._isUTC:!1}function oE(){return this.isValid()?this._isUTC&&this._offset===0:!1}var HH=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,AH=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function tn(t,e){var r=t,n=null,i,o,s;return Fl(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Un(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=HH.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:pe(n[gn])*i,h:pe(n[ht])*i,m:pe(n[Xr])*i,s:pe(n[Bn])*i,ms:pe(lg(n[zi]*1e3))*i}):(n=AH.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ei(n[2],i),M:Ei(n[3],i),w:Ei(n[4],i),d:Ei(n[5],i),h:Ei(n[6],i),m:Ei(n[7],i),s:Ei(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=DH(Be(r.from),Be(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Hu(r),Fl(t)&&Re(t,"_locale")&&(o._locale=t._locale),Fl(t)&&Re(t,"_isValid")&&(o._isValid=t._isValid),o}tn.fn=Hu.prototype;tn.invalid=yH;function Ei(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function kb(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function DH(t,e){var r;return t.isValid()&&e.isValid()?(e=Sm(e,t),t.isBefore(e)?r=kb(t,e):(r=kb(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function sE(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(NT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=tn(r,n),aE(this,i,t),this}}function aE(t,e,r,n){var i=e._milliseconds,o=lg(e._days),s=lg(e._months);t.isValid()&&(n=n??!0,s&&UT(t,ga(t,"Month")+s*r),o&&$T(t,"Date",ga(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&L.updateOffset(t,o||s))}var NH=sE(1,"add"),kH=sE(-1,"subtract");function lE(t){return typeof t=="string"||t instanceof String}function LH(t){return Jr(t)||xa(t)||lE(t)||Un(t)||VH(t)||FH(t)||t===null||t===void 0}function FH(t){var e=qi(t)&&!im(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Re(t,o);return e&&r}function VH(t){var e=Qr(t),r=!1;return e&&(r=t.filter(function(n){return!Un(n)&&lE(t)}).length===0),e&&r}function WH(t){var e=qi(t)&&!im(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Re(t,o);return e&&r}function BH(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function $H(t,e){arguments.length===1&&(arguments[0]?LH(arguments[0])?(t=arguments[0],e=void 0):WH(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Be(),n=Sm(r,this).startOf("day"),i=L.calendarFormat(this,n)||"sameElse",o=e&&(Rn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Be(r)))}function jH(){return new Ha(this)}function zH(t,e){var r=Jr(t)?t:Be(t);return this.isValid()&&r.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function UH(t,e){var r=Jr(t)?t:Be(t);return this.isValid()&&r.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function YH(t,e,r,n){var i=Jr(t)?t:Be(t),o=Jr(e)?e:Be(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function qH(t,e){var r=Jr(t)?t:Be(t),n;return this.isValid()&&r.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function GH(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function KH(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function XH(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=Sm(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Fr(e),e){case"year":o=Vl(this,n)/12;break;case"month":o=Vl(this,n);break;case"quarter":o=Vl(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Ir(o)}function Vl(t,e){if(t.date()<e.date())return-Vl(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}L.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";L.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function ZH(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function QH(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Ll(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Rn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ll(r,"Z")):Ll(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function JH(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function e1(t){t||(t=this.isUtc()?L.defaultFormatUtc:L.defaultFormat);var e=Ll(this,t);return this.localeData().postformat(e)}function t1(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Be(t).isValid())?tn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function r1(t){return this.from(Be(),t)}function n1(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Be(t).isValid())?tn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function i1(t){return this.to(Be(),t)}function uE(t){var e;return t===void 0?this._locale._abbr:(e=qn(t),e!=null&&(this._locale=e),this)}var cE=Lr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function hE(){return this._locale}var nu=1e3,zo=60*nu,iu=60*zo,dE=(365*400+97)*24*iu;function Uo(t,e){return(t%e+e)%e}function fE(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-dE:new Date(t,e,r).valueOf()}function gE(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-dE:Date.UTC(t,e,r)}function o1(t){var e,r;if(t=Fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?gE:fE,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Uo(e+(this._isUTC?0:this.utcOffset()*zo),iu);break;case"minute":e=this._d.valueOf(),e-=Uo(e,zo);break;case"second":e=this._d.valueOf(),e-=Uo(e,nu);break}return this._d.setTime(e),L.updateOffset(this,!0),this}function s1(t){var e,r;if(t=Fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?gE:fE,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=iu-Uo(e+(this._isUTC?0:this.utcOffset()*zo),iu)-1;break;case"minute":e=this._d.valueOf(),e+=zo-Uo(e,zo)-1;break;case"second":e=this._d.valueOf(),e+=nu-Uo(e,nu)-1;break}return this._d.setTime(e),L.updateOffset(this,!0),this}function a1(){return this._d.valueOf()-(this._offset||0)*6e4}function l1(){return Math.floor(this.valueOf()/1e3)}function u1(){return new Date(this.valueOf())}function c1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function h1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function d1(){return this.isValid()?this.toISOString():null}function f1(){return om(this)}function g1(){return ci({},se(this))}function m1(){return se(this).overflow}function p1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}X("N",0,0,"eraAbbr");X("NN",0,0,"eraAbbr");X("NNN",0,0,"eraAbbr");X("NNNN",0,0,"eraName");X("NNNNN",0,0,"eraNarrow");X("y",["y",1],"yo","eraYear");X("y",["yy",2],0,"eraYear");X("y",["yyy",3],0,"eraYear");X("y",["yyyy",4],0,"eraYear");W("N",Rm);W("NN",Rm);W("NNN",Rm);W("NNNN",O1);W("NNNNN",M1);xe(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?se(r).era=i:se(r).invalidEra=t});W("y",as);W("yy",as);W("yyy",as);W("yyyy",as);W("yo",I1);xe(["y","yy","yyy","yyyy"],Mt);xe(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Mt]=r._locale.eraYearOrdinalParse(t,i):e[Mt]=parseInt(t,10)});function w1(t,e){var r,n,i,o=this._eras||qn("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=L(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=L(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function v1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function y1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?L(t.since).year():L(t.since).year()+(e-t.offset)*r}function b1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function C1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function S1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function R1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-L(i[t].since).year())*r+i[t].offset;return this.year()}function T1(t){return Re(this,"_erasNameRegex")||Tm.call(this),t?this._erasNameRegex:this._erasRegex}function E1(t){return Re(this,"_erasAbbrRegex")||Tm.call(this),t?this._erasAbbrRegex:this._erasRegex}function _1(t){return Re(this,"_erasNarrowRegex")||Tm.call(this),t?this._erasNarrowRegex:this._erasRegex}function Rm(t,e){return e.erasAbbrRegex(t)}function O1(t,e){return e.erasNameRegex(t)}function M1(t,e){return e.erasNarrowRegex(t)}function I1(t,e){return e._eraYearOrdinalRegex||as}function Tm(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=$n(u[i].name),a=$n(u[i].abbr),l=$n(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}X(0,["gg",2],0,function(){return this.weekYear()%100});X(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Au(t,e){X(0,[t,t.length],0,e)}Au("gggg","weekYear");Au("ggggg","weekYear");Au("GGGG","isoWeekYear");Au("GGGGG","isoWeekYear");W("G",Mu);W("g",Mu);W("GG",$e,wr);W("gg",$e,wr);W("GGGG",hm,cm);W("gggg",hm,cm);W("GGGGG",Ou,Eu);W("ggggg",Ou,Eu);Da(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=pe(t)});Da(["gg","GG"],function(t,e,r,n){e[n]=L.parseTwoDigitYear(t)});function P1(t){return mE.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function x1(t){return mE.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function H1(){return jn(this.year(),1,4)}function A1(){return jn(this.isoWeekYear(),1,4)}function D1(){var t=this.localeData()._week;return jn(this.year(),t.dow,t.doy)}function N1(){var t=this.localeData()._week;return jn(this.weekYear(),t.dow,t.doy)}function mE(t,e,r,n,i){var o;return t==null?pa(this,n,i).year:(o=jn(t,n,i),e>o&&(e=o),k1.call(this,t,e,r,n,i))}function k1(t,e,r,n,i){var o=GT(t,e,r,n,i),s=ma(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}X("Q",0,"Qo","quarter");W("Q",LT);xe("Q",function(t,e){e[Wn]=(pe(t)-1)*3});function L1(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}X("D",["DD",2],"Do","date");W("D",$e,ls);W("DD",$e,wr);W("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});xe(["D","DD"],gn);xe("Do",function(t,e){e[gn]=pe(t.match($e)[0])});var pE=us("Date",!0);X("DDD",["DDDD",3],"DDDo","dayOfYear");W("DDD",_u);W("DDDD",FT);xe(["DDD","DDDD"],function(t,e,r){r._dayOfYear=pe(t)});function F1(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}X("m",["mm",2],0,"minute");W("m",$e,dm);W("mm",$e,wr);xe(["m","mm"],Xr);var V1=us("Minutes",!1);X("s",["ss",2],0,"second");W("s",$e,dm);W("ss",$e,wr);xe(["s","ss"],Bn);var W1=us("Seconds",!1);X("S",0,0,function(){return~~(this.millisecond()/100)});X(0,["SS",2],0,function(){return~~(this.millisecond()/10)});X(0,["SSS",3],0,"millisecond");X(0,["SSSS",4],0,function(){return this.millisecond()*10});X(0,["SSSSS",5],0,function(){return this.millisecond()*100});X(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});X(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});X(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});X(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});W("S",_u,LT);W("SS",_u,wr);W("SSS",_u,FT);var hi,wE;for(hi="SSSS";hi.length<=9;hi+="S")W(hi,as);function B1(t,e){e[zi]=pe(("0."+t)*1e3)}for(hi="S";hi.length<=9;hi+="S")xe(hi,B1);wE=us("Milliseconds",!1);X("z",0,0,"zoneAbbr");X("zz",0,0,"zoneName");function $1(){return this._isUTC?"UTC":""}function j1(){return this._isUTC?"Coordinated Universal Time":""}var D=Ha.prototype;D.add=NH;D.calendar=$H;D.clone=jH;D.diff=XH;D.endOf=s1;D.format=e1;D.from=t1;D.fromNow=r1;D.to=n1;D.toNow=i1;D.get=JP;D.invalidAt=m1;D.isAfter=zH;D.isBefore=UH;D.isBetween=YH;D.isSame=qH;D.isSameOrAfter=GH;D.isSameOrBefore=KH;D.isValid=f1;D.lang=cE;D.locale=uE;D.localeData=hE;D.max=fH;D.min=dH;D.parsingFlags=g1;D.set=ex;D.startOf=o1;D.subtract=kH;D.toArray=c1;D.toObject=h1;D.toDate=u1;D.toISOString=QH;D.inspect=JH;typeof Symbol<"u"&&Symbol.for!=null&&(D[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});D.toJSON=d1;D.toString=ZH;D.unix=l1;D.valueOf=a1;D.creationData=p1;D.eraName=b1;D.eraNarrow=C1;D.eraAbbr=S1;D.eraYear=R1;D.year=BT;D.isLeapYear=QP;D.weekYear=P1;D.isoWeekYear=x1;D.quarter=D.quarters=L1;D.month=YT;D.daysInMonth=ux;D.week=D.weeks=wx;D.isoWeek=D.isoWeeks=vx;D.weeksInYear=D1;D.weeksInWeekYear=N1;D.isoWeeksInYear=H1;D.isoWeeksInISOWeekYear=A1;D.date=pE;D.day=D.days=xx;D.weekday=Hx;D.isoWeekday=Ax;D.dayOfYear=F1;D.hour=D.hours=Wx;D.minute=D.minutes=V1;D.second=D.seconds=W1;D.millisecond=D.milliseconds=wE;D.utcOffset=SH;D.utc=TH;D.local=EH;D.parseZone=_H;D.hasAlignedHourOffset=OH;D.isDST=MH;D.isLocal=PH;D.isUtcOffset=xH;D.isUtc=oE;D.isUTC=oE;D.zoneAbbr=$1;D.zoneName=j1;D.dates=Lr("dates accessor is deprecated. Use date instead.",pE);D.months=Lr("months accessor is deprecated. Use month instead",YT);D.years=Lr("years accessor is deprecated. Use year instead",BT);D.zone=Lr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",RH);D.isDSTShifted=Lr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",IH);function z1(t){return Be(t*1e3)}function U1(){return Be.apply(null,arguments).parseZone()}function vE(t){return t}var Te=am.prototype;Te.calendar=PP;Te.longDateFormat=DP;Te.invalidDate=kP;Te.ordinal=VP;Te.preparse=vE;Te.postformat=vE;Te.relativeTime=BP;Te.pastFuture=$P;Te.set=MP;Te.eras=w1;Te.erasParse=v1;Te.erasConvertYear=y1;Te.erasAbbrRegex=E1;Te.erasNameRegex=T1;Te.erasNarrowRegex=_1;Te.months=ox;Te.monthsShort=sx;Te.monthsParse=lx;Te.monthsRegex=hx;Te.monthsShortRegex=cx;Te.week=fx;Te.firstDayOfYear=px;Te.firstDayOfWeek=mx;Te.weekdays=_x;Te.weekdaysMin=Mx;Te.weekdaysShort=Ox;Te.weekdaysParse=Px;Te.weekdaysRegex=Dx;Te.weekdaysShortRegex=Nx;Te.weekdaysMinRegex=kx;Te.isPM=Fx;Te.meridiem=Bx;function ou(t,e,r,n){var i=qn(),o=Sn().set(n,e);return i[r](o,t)}function yE(t,e,r){if(Un(t)&&(e=t,t=void 0),t=t||"",e!=null)return ou(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=ou(t,n,r,"month");return i}function Em(t,e,r,n){typeof t=="boolean"?(Un(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Un(e)&&(r=e,e=void 0),e=e||"");var i=qn(),o=t?i._week.dow:0,s,a=[];if(r!=null)return ou(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=ou(e,(s+o)%7,n,"day");return a}function Y1(t,e){return yE(t,e,"months")}function q1(t,e){return yE(t,e,"monthsShort")}function G1(t,e,r){return Em(t,e,r,"weekdays")}function K1(t,e,r){return Em(t,e,r,"weekdaysShort")}function X1(t,e,r){return Em(t,e,r,"weekdaysMin")}gi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=pe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});L.lang=Lr("moment.lang is deprecated. Use moment.locale instead.",gi);L.langData=Lr("moment.langData is deprecated. Use moment.localeData instead.",qn);var Mn=Math.abs;function Z1(){var t=this._data;return this._milliseconds=Mn(this._milliseconds),this._days=Mn(this._days),this._months=Mn(this._months),t.milliseconds=Mn(t.milliseconds),t.seconds=Mn(t.seconds),t.minutes=Mn(t.minutes),t.hours=Mn(t.hours),t.months=Mn(t.months),t.years=Mn(t.years),this}function bE(t,e,r,n){var i=tn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function Q1(t,e){return bE(this,t,e,1)}function J1(t,e){return bE(this,t,e,-1)}function Lb(t){return t<0?Math.floor(t):Math.ceil(t)}function eA(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=Lb(cg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Ir(t/1e3),n.seconds=i%60,o=Ir(i/60),n.minutes=o%60,s=Ir(o/60),n.hours=s%24,e+=Ir(s/24),l=Ir(CE(e)),r+=l,e-=Lb(cg(l)),a=Ir(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function CE(t){return t*4800/146097}function cg(t){return t*146097/4800}function tA(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Fr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+CE(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(cg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Gn(t){return function(){return this.as(t)}}var SE=Gn("ms"),rA=Gn("s"),nA=Gn("m"),iA=Gn("h"),oA=Gn("d"),sA=Gn("w"),aA=Gn("M"),lA=Gn("Q"),uA=Gn("y"),cA=SE;function hA(){return tn(this)}function dA(t){return t=Fr(t),this.isValid()?this[t+"s"]():NaN}function uo(t){return function(){return this.isValid()?this._data[t]:NaN}}var fA=uo("milliseconds"),gA=uo("seconds"),mA=uo("minutes"),pA=uo("hours"),wA=uo("days"),vA=uo("months"),yA=uo("years");function bA(){return Ir(this.days()/7)}var Ln=Math.round,Wo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function CA(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function SA(t,e,r,n){var i=tn(t).abs(),o=Ln(i.as("s")),s=Ln(i.as("m")),a=Ln(i.as("h")),l=Ln(i.as("d")),u=Ln(i.as("M")),c=Ln(i.as("w")),h=Ln(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,CA.apply(null,d)}function RA(t){return t===void 0?Ln:typeof t=="function"?(Ln=t,!0):!1}function TA(t,e){return Wo[t]===void 0?!1:e===void 0?Wo[t]:(Wo[t]=e,t==="s"&&(Wo.ss=e-1),!0)}function EA(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Wo,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Wo,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=SA(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Ud=Math.abs;function wo(t){return(t>0)-(t<0)||+t}function Du(){if(!this.isValid())return this.localeData().invalidDate();var t=Ud(this._milliseconds)/1e3,e=Ud(this._days),r=Ud(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Ir(t/60),i=Ir(n/60),t%=60,n%=60,o=Ir(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=wo(this._months)!==wo(a)?"-":"",c=wo(this._days)!==wo(a)?"-":"",h=wo(this._milliseconds)!==wo(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var ye=Hu.prototype;ye.isValid=vH;ye.abs=Z1;ye.add=Q1;ye.subtract=J1;ye.as=tA;ye.asMilliseconds=SE;ye.asSeconds=rA;ye.asMinutes=nA;ye.asHours=iA;ye.asDays=oA;ye.asWeeks=sA;ye.asMonths=aA;ye.asQuarters=lA;ye.asYears=uA;ye.valueOf=cA;ye._bubble=eA;ye.clone=hA;ye.get=dA;ye.milliseconds=fA;ye.seconds=gA;ye.minutes=mA;ye.hours=pA;ye.days=wA;ye.weeks=bA;ye.months=vA;ye.years=yA;ye.humanize=EA;ye.toISOString=Du;ye.toString=Du;ye.toJSON=Du;ye.locale=uE;ye.localeData=hE;ye.toIsoString=Lr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Du);ye.lang=cE;X("X",0,0,"unix");X("x",0,0,"valueOf");W("x",Mu);W("X",YP);xe("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});xe("x",function(t,e,r){r._d=new Date(pe(t))});//! moment.js
L.version="2.30.1";_P(Be);L.fn=D;L.min=gH;L.max=mH;L.now=pH;L.utc=Sn;L.unix=z1;L.months=Y1;L.isDate=xa;L.locale=gi;L.invalid=Tu;L.duration=tn;L.isMoment=Jr;L.weekdays=G1;L.parseZone=U1;L.localeData=qn;L.isDuration=Fl;L.monthsShort=q1;L.weekdaysMin=X1;L.defineLocale=wm;L.updateLocale=Ux;L.locales=Yx;L.weekdaysShort=K1;L.normalizeUnits=Fr;L.relativeTimeRounding=RA;L.relativeTimeThreshold=TA;L.calendarFormat=BH;L.prototype=D;L.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function _A(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function Fb(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Yd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function co(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function _m(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function yn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function F(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function Vb(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return F(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Wb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function er(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return co(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function Yo(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function me(t){return typeof t<"u"}function Nt(t){return typeof t>"u"}function Xi(t){return t===null||t===""||Nt(t)}function OA(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Qs="length",sa=t=>parseInt(t,16),Bb=t=>parseInt(t,10),su=(t,e,r)=>t.substr(e,r),aa=t=>t.codePointAt(0)-65,hg=t=>`${t}`.replace(/\-/g,""),MA=t=>sa(su(hg(t),sa("12"),aa("F")))/(sa(su(hg(t),aa("B"),~~![][Qs]))||9),IA=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let $b=!1;const jb={invalid:()=>er`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return er`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>er`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},zb={invalid:()=>er`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return er`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>er`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function PA(t,e){const r=!Xi(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=hg(t||"");const l=xA(t);if(r||n||l)if(l){const u=L("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=MA(t);o=L((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(IA()&&(s="valid",a="valid"),!$b&&s!=="valid"&&(jb[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](jb[s]({keyValidityDate:o,hotVersion:i})),$b=!0),a!=="valid"&&e.parentNode&&zb[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=zb[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function xA(t){let e=[][Qs],r=e;if(t[Qs]!==aa("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=aa(i.shift());o;o=aa(i.shift()||"A"))--o<""[Qs]?r=r|(Bb(`${Bb(sa(n)+(sa(su(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=su(t,o,o?i[Qs]===1?9:8:6);return r===e}function Nu(t){return t[0].toUpperCase()+t.substr(1)}function RE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function HA(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function AA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function TE(t,e){return EP.sanitize(t,e)}const ho=t=>["tabindex",t],DA=()=>["role","treegrid"],di=()=>["role","presentation"],NA=()=>["role","gridcell"],kA=()=>["role","rowheader"],EE=()=>["role","rowgroup"],LA=()=>["role","columnheader"],dg=()=>["role","row"],FA=()=>["role","menu"],VA=()=>["role","menuitem"],WA=()=>["role","menuitemcheckbox"],BA=()=>["scope","col"],$A=()=>["scope","row"],fg=t=>["aria-label",t],jA=()=>["aria-hidden","true"],zA=()=>["aria-disabled","true"],UA=()=>["aria-multiselectable","true"],_E=t=>["aria-rowcount",t],ku=t=>["aria-colcount",t],OE=t=>["aria-rowindex",t],Om=t=>["aria-colindex",t],Wl=t=>["aria-expanded",t],Ub=()=>["aria-readonly","true"],Yb=()=>["aria-invalid","true"],YA=t=>["aria-checked",t],ME=()=>["aria-selected","true"];function qA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Bl(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function GA(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function va(t){return GA(t)&&t.parent}function IE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function qa(t,e,r){const n=[];let i=t;for(;i&&(i=IE(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function KA(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function qo(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function XA(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function _i(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function PE(t){return!t||!t.length?[]:t.filter(e=>!!e)}function xE(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function J(t,e){typeof e=="string"&&(e=e.split(" ")),e=PE(e),e.length>0&&t.classList.add(...e)}function Ne(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=xE(e,!0);r=PE(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Oe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Na(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=xE(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function HE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)HE(e[r])}}function Xo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const ZA=/(<(.*)>|&(.*);)/;function AE(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;ZA.test(e)?t.innerHTML=r?TE(e):e:ka(t,e)}function ka(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Xo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ya(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ya(n.host.impl);if(n.host)return ya(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function QA(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Pr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function DE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Mm(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Im(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?DE(e):t.scrollTop}function NE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Mm(e):t.scrollLeft}function au(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function JA(t){return t.scrollHeight-t.clientHeight}function eD(t){return t.scrollWidth-t.clientWidth}function lu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function qb(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Jt(t){return t.offsetWidth}function tr(t){return t.offsetHeight}function la(t){return t.clientHeight||t.innerHeight}function kE(t){return t.clientWidth||t.innerWidth}function tD(t){return t.selectionStart?t.selectionStart:0}function Gb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function LE(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let qd;function rD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function rr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return qd===void 0&&(qd=rD(t)),qd}function nD(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function iD(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Pm(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Lu(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function $l(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function FE(t){return $l(t)&&t.hasAttribute("data-hot-input")===!1}function oD(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function VE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Oe(t,"contenteditable",!0),r&&Oe(t,...jA()),e&&J(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function WE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Ne(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function sD(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;VE(t,r),e(),WE(t,r)}function Gi(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Pe(t){return typeof t=="function"}function BE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function aD(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function gg(t,e,r,n,i,o,s,a){return me(a)?t.call(e,r,n,i,o,s,a):me(s)?t.call(e,r,n,i,o,s):me(o)?t.call(e,r,n,i,o):me(i)?t.call(e,r,n,i):me(n)?t.call(e,r,n):me(r)?t.call(e,r):t.call(e)}var Kb={},Gd,Xb;function lD(){if(Xb)return Gd;Xb=1;var t=et(),e=cT(),r=at(),n=ro(),i=Ru(),o=t([].push);return Gd=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,p){if(d)return d=!1,p;if(e(this))return p;for(var y=0;y<h;y++)if(l[y]===g)return p}}},Gd}var Zb;function uD(){if(Zb)return Kb;Zb=1;var t=Le(),e=rs(),r=Ma(),n=mt(),i=et(),o=st(),s=at(),a=qg(),l=nm(),u=lD(),c=Yg(),h=String,d=e("JSON","stringify"),g=i(/./.exec),p=i("".charAt),y=i("".charCodeAt),b=i("".replace),E=i(1.1.toString),v=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var N=e("Symbol")("stringify detection");return d([N])!=="[null]"||d({a:N})!=="{}"||d(Object(N))!=="{}"}),I=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),H=function(N,j){var z=l(arguments),te=u(j);if(!(!s(te)&&(N===void 0||a(N))))return z[1]=function(ue,G){if(s(te)&&(G=n(te,this,h(ue),G)),!a(G))return G},r(d,null,z)},V=function(N,j,z){var te=p(z,j-1),ue=p(z,j+1);return g(T,N)&&!g(_,ue)||g(_,N)&&!g(T,te)?"\\u"+E(y(N,0),16):N};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||I},{stringify:function(j,z,te){var ue=l(arguments),G=r(M?H:d,null,ue);return I&&typeof G=="string"?b(G,v,V):G}}),Kb}uD();function ba(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Me(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=ba(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[ba(r[0])]:e[n]=[]:e[n]=null)})),e}function cD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function wi(t,e,r){const n=Array.isArray(r);return Me(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function $E(t,e){Me(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),$E(t[n],e[n])):t[n]=e[n]})}function gr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ke(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return F(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Me(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=p=>{let y=p;return(Array.isArray(y)||bt(y))&&(y=gr(y)),y};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function jE(t,e){return JSON.stringify(t)===JSON.stringify(e)}function bt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Kn(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Me(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function hD(t,e){const r=e.split(".");let n=t;return Me(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Kd(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(bn(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function xm(t){if(!bt(t))return 0;const e=function(r){let n=0;return bt(r)?Me(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function bn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mg(t){return window.requestAnimationFrame(t)}function Qb(t){window.cancelAnimationFrame(t)}function dD(){return"ontouchstart"in window}function fD(){return typeof window<"u"}const Mr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Si={chrome:Mr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Mr(t=>/CriOS/.test(t)),edge:Mr(t=>/Edge/.test(t)),edgeWebKit:Mr(t=>/EdgiOS/.test(t)),firefox:Mr(t=>/Firefox/.test(t)),firefoxWebKit:Mr(t=>/FxiOS/.test(t)),mobile:Mr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Mr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},La={mac:Mr(t=>/^Mac/.test(t)),win:Mr(t=>/^Win/.test(t)),linux:Mr(t=>/^Linux/.test(t)),ios:Mr(t=>/iPhone|iPad|iPod/i.test(t))};function gD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(Si,r=>{let{test:n}=r;return void n(t,e)})}function mD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(La,e=>{let{test:r}=e;return void r(t)})}fD()&&(gD(),mD());function pD(){return Si.chrome.value}function wD(){return Si.chromeWebKit.value}function Xd(){return Si.firefox.value}function vD(){return Si.firefoxWebKit.value}function zE(){return Si.safari.value}function yD(){return Si.edge.value}function Ui(){return Si.mobile.value}function UE(){return La.ios.value}function YE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&La.mac.value}function Jb(){return La.win.value}function eC(){return La.mac.value}const Z={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Xd()?182:174,AUDIO_MUTE:Xd()?181:173,AUDIO_UP:Xd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},bD=[Z.ALT,Z.ARROW_DOWN,Z.ARROW_LEFT,Z.ARROW_RIGHT,Z.ARROW_UP,Z.AUDIO_DOWN,Z.AUDIO_MUTE,Z.AUDIO_UP,Z.BACKSPACE,Z.CAPS_LOCK,Z.DELETE,Z.END,Z.ENTER,Z.ESCAPE,Z.F1,Z.F2,Z.F3,Z.F4,Z.F5,Z.F6,Z.F7,Z.F8,Z.F9,Z.F10,Z.F11,Z.F12,Z.F13,Z.F14,Z.F15,Z.F16,Z.F17,Z.F18,Z.F19,Z.HOME,Z.INSERT,Z.MEDIA_NEXT,Z.MEDIA_PLAY_PAUSE,Z.MEDIA_PREV,Z.MEDIA_STOP,Z.NULL,Z.NUM_LOCK,Z.PAGE_DOWN,Z.PAGE_UP,Z.PAUSE,Z.SCROLL_LOCK,Z.SHIFT,Z.TAB];function CD(t){return bD.includes(t)}function SD(t){return[Z.CONTROL,Z.COMMAND_LEFT,Z.COMMAND_RIGHT,Z.COMMAND_FIREFOX].includes(t)}function RD(t,e){const r=e.split("|");let n=!1;return F(r,i=>{if(t===Z[i])return n=!0,!1}),n}function Fu(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Bi(t){return t.isImmediatePropagationEnabled===!1}function uu(t){return t.button===2}function qE(t){return t.button===0}function Yn(){me(console)&&console.warn(...arguments)}function TD(){me(console)&&console.error(...arguments)}const $i=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Zd=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Qd=new Map([[]]);var tC={},Jd,rC;function ED(){if(rC)return Jd;rC=1;var t=os();return Jd=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},Jd}var ef,nC;function _D(){if(nC)return ef;nC=1;var t=Je();return ef=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},ef}var tf,iC;function Hm(){if(iC)return tf;iC=1;var t=en(),e=rm(),r=bi().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),tf=function(o){i[n][o]=!0},tf}var oC;function OD(){if(oC)return tC;oC=1;var t=Le(),e=et(),r=mr(),n=Ta(),i=ED(),o=_D(),s=Hm(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),tC}OD();var sC={},aC={},lC;function MD(){if(lC)return aC;lC=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,p){if(c(g,d++))return p(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),aC}var uC;function ID(){return uC||(uC=1,MD()),sC}ID();function PD(t,e){GE(t,e),e.add(t)}function rf(t,e,r){GE(t,e),e.set(t,r)}function GE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cC(t,e,r){return t.set(cu(t,e),r),r}function vt(t,e){return t.get(cu(t,e))}function cu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const xD=100;var ar=new WeakMap,Fo=new WeakMap,nf=new WeakMap,of=new WeakSet;class hC{constructor(){PD(this,of),rf(this,ar,new Map),rf(this,Fo,new Map),rf(this,nf,new Set),$i.forEach(e=>cu(of,this,dC).call(this,e))}getHooks(e){var r;return(r=vt(ar,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};vt(ar,this).has(e)||(cu(of,this,dC).call(this,e),$i.push(e));const i=vt(ar,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=vt(nf,this).has(e);!u&&o!==0&&(u=!0,vt(nf,this).add(e)),u&&i.length>1&&vt(ar,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return vt(ar,this).has(e)&&vt(ar,this).get(e).length>0}remove(e,r){if(!vt(ar,this).has(e))return!1;const n=vt(ar,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=vt(Fo,this).get(e);return i.skip=!0,o+=1,o>xD&&(vt(ar,this).set(e,n.filter(s=>!s.skip)),o=0),vt(Fo,this).set(e,o),!0}return!1}destroy(){vt(ar,this).clear(),vt(Fo,this).clear(),cC(ar,this,null),cC(Fo,this,null)}}function dC(t){vt(ar,this).set(t,[]),vt(Fo,this).set(t,0)}function HD(t,e,r){return(e=AD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AD(t){var e=DD(t,"string");return typeof e=="symbol"?e:e+""}function DD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ND=er`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ge{constructor(){HD(this,"globalBucket",new hC)}static getSingleton(){return LD()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new hC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?F(r,o=>this.add(e,o,n)):(Zd.has(e)&&Yn(AA(ND,{hookName:e,removedInVersion:Zd.get(e)})),Qd.has(e)&&Yn(Qd.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?F(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?F(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=gg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=gg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||$i.push(e)}deregister(e){this.isRegistered(e)&&$i.splice($i.indexOf(e),1)}isDeprecated(e){return Qd.has(e)||Zd.has(e)}isRegistered(e){return $i.indexOf(e)>=0}getRegistered(){return $i}}const kD=new ge;function LD(){return kD}const sf=new Map;function cs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";sf.has(t)||sf.set(t,new Map);const e=sf.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s}}const pg=new WeakMap,{register:FD,getItem:KE,hasItem:XE}=cs("editors");function VD(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},ge.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function WD(t,e){let r;if(typeof t=="function")pg.get(t)||ZE(null,t),r=pg.get(t);else if(typeof t=="string")r=KE(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function fC(t){if(typeof t=="function")return t;if(!XE(t))throw Error(`No registered editor found under "${t}" name`);return KE(t).getConstructor()}function ZE(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new VD(e);typeof t=="string"&&FD(t,r),pg.set(e,r)}function BD(t,e,r){return(e=$D(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $D(t){var e=jD(t,"string");return typeof e=="symbol"?e:e+""}function jD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;BD(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,zD(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function zD(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Fu(this)},t}function UD(t,e){YD(t,e),e.add(t)}function YD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oi(t,e,r){return(e=qD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qD(t){var e=GD(t,"string");return typeof e=="symbol"?e:e+""}function GD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function af(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ga=new WeakSet;class wg{constructor(e,r,n){UD(this,Ga),Oi(this,"hot",void 0),Oi(this,"tableMeta",void 0),Oi(this,"selection",void 0),Oi(this,"eventManager",void 0),Oi(this,"destroyed",!1),Oi(this,"activeEditor",void 0),Oi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new vi(e),this.hot.addHook("afterDocumentKeyDown",i=>af(Ga,this,gC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>af(Ga,this,gC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>af(Ga,this,KD).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=WD(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function gC(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Bi(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!CD(r)&&!SD(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function KD(t,e){e.isCell()&&this.openEditor(null,t,!0)}const mC=new WeakMap;wg.getInstance=function(t,e,r){let n=mC.get(t);return n||(n=new wg(t,e,r),mC.set(t,n)),n};function XD(t,e){QE(t,e),e.add(t)}function Ts(t,e,r){QE(t,e),e.set(t,r)}function QE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ae(t,e){return t.get(Fn(t,e))}function Es(t,e,r){return t.set(Fn(t,e),r),r}function Fn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Go=Object.freeze({CELL:"cell",MIXED:"mixed"});var nt=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,Za=new WeakMap,Qa=new WeakMap,li=new WeakSet;class ZD{constructor(e){var r=this;XD(this,li),Ts(this,nt,void 0),Ts(this,Ka,void 0),Ts(this,Xa,1),Ts(this,Za,null),Ts(this,Qa,new Map);const n=e.getSettings();Es(nt,this,e),Es(Ka,this,n.imeFastEdit?Go.MIXED:Go.CELL),Ae(nt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,JD).call(r,...o)}),Ae(nt,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,pC).call(r,...o)}),Ae(nt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,pC).call(r,...o)}),Ae(nt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,QD).call(r,...o)})}getFocusMode(){return Ae(Ka,this)}setFocusMode(e){Object.values(Go).includes(e)?Es(Ka,this,e):Yn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ae(Xa,this)}setRefocusDelay(e){Es(Xa,this,e)}setRefocusElementGetter(e){Es(Za,this,e)}getRefocusElement(){var e;return typeof Ae(Za,this)=="function"?Ae(Za,this).call(this):(e=Ae(nt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Ae(nt,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ae(nt,this).runHooks("modifyFocusedElement",s.row,s.col,n);Gi(a)||(a=n),a&&!((o=Ae(nt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Fn(li,this,Am).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ae(Xa,this);if(Ae(nt,this).getSettings().imeFastEdit&&!((e=Ae(nt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Ae(nt,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Ae(Qa,this).has(r)||Ae(Qa,this).set(r,BE(()=>{if(!Ae(nt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Ae(Qa,this).get(r)()}}}function Am(t){var e;const r=(e=Ae(nt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!Ae(nt,this).selection.isCellVisible(r)){t(null);return}const n=Ae(nt,this).getCell(r.row,r.col,!0);n===null?Ae(nt,this).addHookOnce("afterScroll",()=>{t(Ae(nt,this).getCell(r.row,r.col,!0))}):t(n)}function pC(){Fn(li,this,Am).call(this,t=>{const{activeElement:e}=Ae(nt,this).rootDocument;e&&FE(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function QD(){Fn(li,this,Am).call(this,t=>{this.getFocusMode()===Go.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function JD(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Go.MIXED:Go.CELL)}var wC={},lf,vC;function eN(){if(vC)return lf;vC=1;var t=Nr(),e=ro(),r=en(),n=r("match");return lf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},lf}var uf,yC;function tN(){if(yC)return uf;yC=1;var t=Je(),e=st(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return uf={correct:n},uf}var cf,bC;function rN(){if(bC)return cf;bC=1;var t=pt();return cf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},cf}var hf,CC;function nN(){if(CC)return hf;CC=1;var t=mt(),e=kr(),r=Ea(),n=tN(),i=rN(),o=RegExp.prototype;return hf=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},hf}var df,SC;function iN(){if(SC)return df;SC=1;var t=et(),e=ns(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return df=function(l,u,c,h,d,g){var p=c+l.length,y=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(E,v){var T;switch(n(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,p);case"<":T=d[o(v,1,-1)];break;default:var _=+v;if(_===0)return E;if(_>y){var M=r(_/10);return M===0?E:M<=y?h[M-1]===void 0?n(v,1):h[M-1]+n(v,1):E}T=h[_-1]}return T===void 0?"":T})},df}var RC;function oN(){if(RC)return wC;RC=1;var t=Le(),e=mt(),r=et(),n=Ra(),i=at(),o=Nr(),s=eN(),a=Ru(),l=_a(),u=nN(),c=iN(),h=en(),d=no(),g=h("replace"),p=TypeError,y=r("".indexOf),b=r("".replace),E=r("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(_,M){var I=n(this),H,V,N,j,z,te,ue,G,Q,lt,ae=0,be="";if(o(_)){if(H=s(_),H&&(V=a(n(u(_))),!~y(V,"g")))throw new p("`.replaceAll` does not allow non-global regexes");if(N=l(_,g),N)return e(N,_,I,M);if(d&&H)return b(a(I),_,M)}for(j=a(I),z=a(_),te=i(M),te||(M=a(M)),ue=z.length,G=v(1,ue),Q=y(j,z);Q!==-1;)lt=te?a(M(z,Q,j)):c(z,j,Q,[],void 0,M),be+=E(j,ae,Q)+lt,ae=Q+ue,Q=Q+G>j.length?-1:y(j,z,Q+G);return ae<j.length&&(be+=E(j,ae)),be}}),wC}oN();var TC={},EC={},_C;function sN(){if(_C)return EC;_C=1;var t=Le(),e=ss(),r=mr(),n=pt(),i=Ci(),o=pr(),s=lo(),a=Ma(),l=st(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(v){o(this,"throw",v)}var p=arguments.length<2,y=p?void 0:arguments[1];if(h)return a(h,this,p?[g]:[g,y]);var b=i(this),E=0;if(e(b,function(v){p?(p=!1,y=v):y=g(y,v,E),E++},{IS_RECORD:!0}),p)throw new u("Reduce of empty iterator with no initial value");return y}}),EC}var OC;function aN(){return OC||(OC=1,sN()),TC}aN();const JE={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},lN=new RegExp(Object.keys(JE).map(t=>`(${t})`).join("|"),"gi");function uN(t){return(t&&t.nodeName||"")==="TABLE"}function MC(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,p=[];for(let b=0;b<s;b+=1){const E=!g&&r&&b===0;let v="";if(g)v=`<th>${t.getColHeader(b-c)}</th>`;else if(E)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][b],{hidden:_,rowspan:M,colspan:I}=t.getCellMeta(d-h,b-c);if(!_){const H=[];if(M&&H.push(`rowspan="${M}"`),I&&H.push(`colspan="${I}"`),Xi(T))v=`<td ${H.join(" ")}></td>`;else{const V=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${H.join(" ")}>${V}</td>`}}}p.push(v)}const y=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function IC(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Xi(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function cN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const M=_.match(/<td\b[^>]*?>/g)[0],I=/<p.*?>/g,H=_.substring(M.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(I,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${H}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!uN(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,_)=>T+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,p=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(_=>{const M=_.querySelector("td")!==null;return M&&h.push(_),!M});g=T.length,d=g>0,g>1?r.nestedHeaders=Array.from(T).reduce((_,M)=>{const I=Array.from(M.cells).reduce((H,V,N)=>{if(a&&N===0)return H;const{colSpan:j,innerHTML:z}=V,te=j>1?{label:z,colspan:j}:z;return H.push(te),H},[]);return _.push(I),_},[]):d&&(r.colHeaders=Array.from(T[0].children).reduce((_,M,I)=>(a&&I===0||_.push(M.innerHTML),_),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce((T,_)=>(T.push(...Array.from(_.rows)),T),[]),...c];p=y.length;const b=new Array(p);for(let T=0;T<p;T++)b[T]=new Array(u);const E=[],v=[];for(let T=0;T<p;T++){const _=y[T],M=Array.from(_.cells),I=M.length;for(let H=0;H<I;H++){const V=M[H],{nodeName:N,innerHTML:j,rowSpan:z,colSpan:te}=V,ue=b[T].findIndex(G=>G===void 0);if(N==="TD"){if(z>1||te>1){for(let ae=T;ae<T+z;ae++)if(ae<p)for(let be=ue;be<ue+te;be++)b[ae][be]=null;const Q=V.getAttribute("style");Q&&Q.includes("mso-ignore:colspan")||E.push({col:ue,row:T,rowspan:z,colspan:te})}let G="";s&&/excel/gi.test(s.content)?G=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):G=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[T][ue]=G.replace(lN,Q=>JE[Q])}else v.push(j)}}return E.length&&(r.mergeCells=E),v.length&&(r.rowHeaders=v),b.length&&(r.data=b),r}function e_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function hN(t){return e_(t,[","])}function qe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function PC(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function dN(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function He(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const vg="asc",fN="desc",xC=new Map([[vg,[-1,1]],[fN,[1,-1]]]),gN=t=>`The priority '${t}' is already declared in a map.`,mN=t=>`The priority '${t}' is not a number.`;function pN(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Pe(t)?t:gN,e=Pe(e)?e:mN;function n(o,s){if(!e_(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vg;const[s,a]=xC.get(o)||xC.get(vg);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const wN=t=>`The id '${t}' is already declared in a map.`;function Vu(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Pe(t)?t:wN;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const vN=t=>`'${t}' value is already declared in a unique set.`;function yN(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Pe(t)?t:vN;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const Dm=t=>`There is already registered "${t}" plugin.`,bN=t=>`There is already registered plugin on priority "${t}".`,CN=t=>`The priority "${t}" is not a number.`,t_=pN({errorPriorityExists:bN,errorPriorityNaN:CN}),r_=yN({errorItemExists:Dm}),yg=Vu({errorIdExists:Dm});function n_(){return[...t_.getItems(),...r_.getItems()]}function Nm(t){const e=Nu(t);return yg.getItem(e)}function SN(t){return!!Nm(t)}function Ja(t,e,r){[t,e,r]=TN(t,e,r),Nm(t)===void 0&&RN(t,e,r)}function RN(t,e,r){const n=Nu(t);if(yg.hasItem(n))throw new Error(Dm(n));r===void 0?r_.addItem(n):t_.addItem(r,n),yg.addItem(n,e)}function TN(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:EN,getItem:_N,hasItem:i_}=cs("renderers");function HC(t){if(typeof t=="function")return t;if(!i_(t))throw Error(`No registered renderer found under "${t}" name`);return _N(t)}function ON(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),EN(t,e)}const{register:MN,getItem:IN,hasItem:o_}=cs("validators");function PN(t){if(typeof t=="function")return t;if(!o_(t))throw Error(`No registered validator found under "${t}" name`);return IN(t)}function xN(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),MN(t,e)}var AC={},DC;function HN(){if(DC)return AC;DC=1;var t=Le(),e=ns(),r=os(),n=Oa(),i=Hm();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),AC}HN();var NC={},kC;function AN(){if(kC)return NC;kC=1;var t=Le(),e=et(),r=Ra(),n=Oa(),i=Ru(),o=st(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),NC}AN();function _s(t,e,r){return(e=DN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DN(t){var e=NN(t,"string");return typeof e=="symbol"?e:e+""}function NN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kN{constructor(){_s(this,"count",0),_s(this,"startColumn",null),_s(this,"endColumn",null),_s(this,"startPosition",null),_s(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=i&&(this.startColumn-=1),p>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Os(t,e,r){return(e=LN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LN(t){var e=FN(t,"string");return typeof e=="symbol"?e:e+""}function FN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VN{constructor(){Os(this,"count",0),Os(this,"startRow",null),Os(this,"endRow",null),Os(this,"startPosition",null),Os(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ms(t,e,r){return(e=WN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WN(t){var e=BN(t,"string");return typeof e=="symbol"?e:e+""}function BN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s_{constructor(){Ms(this,"count",0),Ms(this,"startColumn",null),Ms(this,"endColumn",null),Ms(this,"startPosition",null),Ms(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Is(t,e,r){return(e=$N(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $N(t){var e=jN(t,"string");return typeof e=="symbol"?e:e+""}function jN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a_{constructor(){Is(this,"count",0),Is(this,"startRow",null),Is(this,"endRow",null),Is(this,"startPosition",null),Is(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ps(t,e,r){return(e=zN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zN(t){var e=UN(t,"string");return typeof e=="symbol"?e:e+""}function UN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YN{constructor(){Ps(this,"count",0),Ps(this,"startColumn",0),Ps(this,"endColumn",0),Ps(this,"startPosition",0),Ps(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function xs(t,e,r){return(e=qN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qN(t){var e=GN(t,"string");return typeof e=="symbol"?e:e+""}function GN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KN{constructor(){xs(this,"count",0),xs(this,"startRow",0),xs(this,"endRow",0),xs(this,"startPosition",0),xs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function LC(t,e,r){return(e=XN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XN(t){var e=ZN(t,"string");return typeof e=="symbol"?e:e+""}function ZN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QN extends s_{constructor(){super(...arguments),LC(this,"columnStartOffset",0),LC(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function FC(t,e,r){return(e=JN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JN(t){var e=ek(t,"string");return typeof e=="symbol"?e:e+""}function ek(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tk extends a_{constructor(){super(...arguments),FC(this,"rowStartOffset",0),FC(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function VC(t,e,r){return(e=rk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rk(t){var e=nk(t,"string");return typeof e=="symbol"?e:e+""}function nk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l_{constructor(e){VC(this,"calculationTypes",[]),VC(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Wr(t,e,r){return(e=ik(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ik(t){var e=ok(t,"string");return typeof e=="symbol"?e:e+""}function ok(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const km=50;class sk extends l_{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Wr(this,"viewportWidth",0),Wr(this,"scrollOffset",0),Wr(this,"zeroBasedScrollOffset",0),Wr(this,"totalColumns",0),Wr(this,"columnWidthFn",null),Wr(this,"columnWidth",0),Wr(this,"overrideFn",null),Wr(this,"inlineStartOffset",0),Wr(this,"totalCalculatedWidth",0),Wr(this,"startPositions",[]),Wr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?km:r}}function Sr(t,e,r){return(e=ak(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ak(t){var e=lk(t,"string");return typeof e=="symbol"?e:e+""}function lk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uk extends l_{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Sr(this,"viewportHeight",0),Sr(this,"scrollOffset",0),Sr(this,"zeroBasedScrollOffset",0),Sr(this,"totalRows",0),Sr(this,"rowHeightFn",null),Sr(this,"rowHeight",0),Sr(this,"overrideFn",null),Sr(this,"horizontalScrollbarHeight",0),Sr(this,"innerViewportHeight",0),Sr(this,"totalCalculatedHeight",0),Sr(this,"startPositions",[]),Sr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function ck(t,e,r){hk(t,e),e.set(t,r)}function hk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WC(t,e,r){return(e=dk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dk(t){var e=fk(t,"string");return typeof e=="symbol"?e:e+""}function fk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vo(t,e){return t.get(u_(t,e))}function BC(t,e,r){return t.set(u_(t,e),r),r}function u_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var In=new WeakMap;class Zi{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;WC(this,"row",null),WC(this,"col",null),ck(this,In,!1),BC(In,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return vo(In,this)}isSouthEastOf(e){return this.row>=e.row&&(vo(In,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(vo(In,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(vo(In,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(vo(In,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Zi&&BC(In,this,e.isRtl()),this}clone(){return new Zi(this.row,this.col,vo(In,this))}toObject(){return{row:this.row,col:this.col}}}function gk(t,e,r){mk(t,e),e.set(t,r)}function mk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ff(t,e,r){return(e=pk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pk(t){var e=wk(t,"string");return typeof e=="symbol"?e:e+""}function wk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rr(t,e){return t.get(c_(t,e))}function vk(t,e,r){return t.set(c_(t,e),r),r}function c_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $t=new WeakMap;class Fa{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ff(this,"highlight",null),ff(this,"from",null),ff(this,"to",null),gk(this,$t,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),vk($t,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Rr($t,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Rr($t,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Rr($t,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Rr($t,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Rr($t,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Rr($t,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Rr($t,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Rr($t,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Zi))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Rr($t,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Rr($t,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new Fa(this.highlight,this.from,this.to,Rr($t,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Zi(e,r,Rr($t,this))}}function on(t,e,r){yk(t,e),e.set(t,r)}function yk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U(t,e){return t.get(h_(t,e))}function ei(t,e,r){return t.set(h_(t,e),r),r}function h_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tr=new WeakMap,gf=new WeakMap,gt=new WeakMap,yo=new WeakMap,el=new WeakMap,Br=new WeakMap,mf=new WeakMap,Hs=new WeakMap,Mi=new WeakMap,sn=new WeakMap;let d_=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;on(this,Tr,void 0),on(this,gf,void 0),on(this,gt,void 0),on(this,yo,void 0),on(this,el,void 0),on(this,Br,void 0),on(this,mf,void 0),on(this,Hs,void 0),on(this,Mi,[null,null]),on(this,sn,[null,null]),ei(Tr,this,n),ei(gf,this,r),ei(gt,this,o),ei(yo,this,s),ei(el,this,a),ei(Br,this,i),ei(mf,this,e),this.registerEvents()}registerEvents(){U(Br,this).addEventListener(U(gt,this).holder,"contextmenu",n=>this.onContextMenu(n)),U(Br,this).addEventListener(U(gt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),U(Br,this).addEventListener(U(gt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{U(Br,this).addEventListener(U(gt,this).holder,"touchstart",n=>this.onTouchStart(n)),U(Br,this).addEventListener(U(gt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),U(Br,this).addEventListener(U(gt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||U(Tr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,U(Tr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{U(Br,this).addEventListener(U(gt,this).holder,"mouseup",n=>this.onMouseUp(n)),U(Br,this).addEventListener(U(gt,this).holder,"mousedown",n=>this.onMouseDown(n))};Ui()?e():(dD()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(U(Hs,this)&&n){const[i,o]=[n.row,U(Hs,this).from.row],[s,a]=[n.col,U(Hs,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=U(gt,this).TABLE,i=qa(e,["TD","TH"],n);return i?(r.coords=U(gt,this).getCoords(i),r.TD=i):we(e,"wtBorder")&&we(e,"current")?(r.coords=U(yo,this).getFocusSelection().cellRange.highlight,r.TD=U(gt,this).getCell(r.coords)):we(e,"wtBorder")&&we(e,"area")&&U(yo,this).getAreaSelection().cellRange&&(r.coords=U(yo,this).getAreaSelection().cellRange.to,r.TD=U(gt,this).getCell(r.coords)),r}onMouseDown(e){const r=U(gf,this).rootDocument.activeElement,n=aD(qA,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);we(i,"corner")?U(Tr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&U(Tr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(U(sn,this)[0]=o.TD,clearTimeout(U(Mi,this)[0]),U(Mi,this)[0]=setTimeout(()=>{U(sn,this)[0]=null},1e3))}onContextMenu(e){if(U(Tr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!U(Tr,this).has("onCellMouseOver"))return;const r=U(gt,this).TABLE,n=qa(e.target,["TD","TH"],r),i=U(el,this)||this;n&&n!==i.lastMouseOver&&qo(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,U(gt,this).getCoords(n),n))}onMouseOut(e){if(!U(Tr,this).has("onCellMouseOut"))return;const r=U(gt,this).TABLE,n=qa(e.target,["TD","TH"],r),i=qa(e.relatedTarget,["TD","TH"],r),o=U(el,this)||this;n&&n!==i&&qo(n,r)&&(this.callListener("onCellMouseOut",e,U(gt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&U(Tr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===U(sn,this)[0]&&r.TD===U(sn,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),U(sn,this)[0]=null,U(sn,this)[1]=null):r.TD===U(sn,this)[0]&&(U(sn,this)[1]=r.TD,clearTimeout(U(Mi,this)[1]),U(Mi,this)[1]=setTimeout(()=>{U(sn,this)[1]=null},500)))}onTouchStart(e){ei(Hs,this,U(yo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=me(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&U(Tr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];UE()&&(wD()||vD())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=U(Tr,this).getSettingPure(e);o&&o(r,n,i,U(mf,this).call(this))}destroy(){clearTimeout(U(Mi,this)[0]),clearTimeout(U(Mi,this)[1]),U(Br,this).destroy()}};function pf(t,e,r){return(e=bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bk(t){var e=Ck(t,"string");return typeof e=="symbol"?e:e+""}function Ck(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sk{constructor(e,r,n){pf(this,"offset",void 0),pf(this,"total",void 0),pf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function wf(t,e,r){return(e=Rk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rk(t){var e=Tk(t,"string");return typeof e=="symbol"?e:e+""}function Tk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ek{constructor(e,r,n){wf(this,"offset",void 0),wf(this,"total",void 0),wf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function tl(t,e,r){return(e=_k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _k(t){var e=Ok(t,"string");return typeof e=="symbol"?e:e+""}function Ok(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mk{constructor(){tl(this,"currentSize",0),tl(this,"nextSize",0),tl(this,"currentOffset",0),tl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Ik=0,$C=1,bg=2;function vf(t,e,r){return(e=Pk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pk(t){var e=xk(t,"string");return typeof e=="symbol"?e:e+""}function xk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hk{constructor(){vf(this,"size",new Mk),vf(this,"workingSpace",Ik),vf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=$C,e.workingSpace=bg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=bg,e.workingSpace=$C,this.sharedSize=e.getViewSize()}}var jC={},yf,zC;function Ak(){if(zC)return yf;zC=1;var t=Su(),e=TypeError;return yf=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},yf}var UC;function Dk(){if(UC)return jC;UC=1;var t=Le(),e=ns(),r=os(),n=hT(),i=Ak(),o=dT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var p=d;p--;){var y=p+g;p in h?h[y]=h[p]:i(h,y)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),jC}Dk();function Nk(t,e,r){return(e=kk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kk(t){var e=Lk(t,"string");return typeof e=="symbol"?e:e+""}function Lk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YC{constructor(e,r){Nk(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Fk(t,e,r){return(e=Vk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vk(t){var e=Wk(t,"string");return typeof e=="symbol"?e:e+""}function Wk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bk{constructor(e){Fk(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new YC(o,r),l=new YC(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(bg)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function bo(t,e,r){return(e=$k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $k(t){var e=jk(t,"string");return typeof e=="symbol"?e:e+""}function jk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f_{constructor(e,r){bo(this,"rootNode",void 0),bo(this,"nodesPool",void 0),bo(this,"sizeSet",new Hk),bo(this,"collectedNodes",[]),bo(this,"viewDiffer",new Bk(this.sizeSet)),bo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class g_ extends f_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function qC(t,e,r){return(e=zk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zk(t){var e=Uk(t,"string");return typeof e=="symbol"?e:e+""}function Uk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yk{constructor(e){qC(this,"nodeType",void 0),qC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function As(t,e,r){return(e=qk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qk(t){var e=Gk(t,"string");return typeof e=="symbol"?e:e+""}function Gk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Va{constructor(e,r){As(this,"nodesPool",null),As(this,"nodeType",void 0),As(this,"rootNode",void 0),As(this,"table",null),As(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Yk(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function GC(t,e,r){return(e=Kk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kk(t){var e=Xk(t,"string");return typeof e=="symbol"?e:e+""}function Xk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zk extends Va{constructor(){super("TH"),GC(this,"orderViews",new WeakMap),GC(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new g_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Na(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Oe(d,[kA(),$A(),Om(h+1),ho(-1)]),r[h](a,d,h)}u.end()}}}class Qk extends Va{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Xo(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Oe(this.rootNode,[EE()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Oe(s,[dg(),OE(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Na(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Oe(u,[Om(a+1+this.table.rowHeadersCount),ho(-1),LA(),...a>=0?[BA()]:[dg()]]),n[r](l,u,r)}}}}let KC=!1;class Jk extends Va{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!KC&&e>1e3&&(KC=!0,Yn(er`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&J(n,"rowHeader")}}function eL(t,e,r){return(e=tL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tL(t){var e=rL(t,"string");return typeof e=="symbol"?e:e+""}function rL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Co={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let XC=!1;class nL extends Va{constructor(e){super("TR",e),eL(this,"orderView",void 0),this.orderView=new f_(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!XC&&e>1e3&&(XC=!0,Yn(er`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Oe(this.rootNode,[EE()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Oe(o,[dg(),OE(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?we(o,Co.rowEven)||(Ne(o,Co.rowOdd),J(o,Co.rowEven)):we(o,Co.rowOdd)||(Ne(o,Co.rowEven),J(o,Co.rowOdd))}this.orderView.end()}}function ZC(t,e,r){return(e=iL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iL(t){var e=oL(t,"string");return typeof e=="symbol"?e:e+""}function oL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sL extends Va{constructor(){super("TD"),ZC(this,"orderViews",new WeakMap),ZC(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new g_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),p=c.getCurrentNode();if(we(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),Na(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,p),this.table.isAriaEnabled()){var o,s;Oe(p,[...p.hasAttribute("role")?[]:[NA()],ho(-1),Om(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function tt(t,e,r){return(e=aL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aL(t){var e=lL(t,"string");return typeof e=="symbol"?e:e+""}function lL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uL{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tt(this,"rootNode",void 0),tt(this,"rootDocument",void 0),tt(this,"rowHeaders",null),tt(this,"columnHeaders",null),tt(this,"colGroup",null),tt(this,"rows",null),tt(this,"cells",null),tt(this,"rowFilter",null),tt(this,"columnFilter",null),tt(this,"rowUtils",null),tt(this,"columnUtils",null),tt(this,"rowsToRender",0),tt(this,"columnsToRender",0),tt(this,"rowHeaderFunctions",[]),tt(this,"rowHeadersCount",0),tt(this,"columnHeaderFunctions",[]),tt(this,"columnHeadersCount",0),tt(this,"cellRenderer",void 0),tt(this,"activeOverlayName",void 0),tt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class cL{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new uL(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Zk,columnHeaders:new Qk(r),colGroup:new Jk(n),rows:new nL(i),cells:new sL}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function bf(t,e,r){return(e=hL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hL(t){var e=dL(t,"string");return typeof e=="symbol"?e:e+""}function dL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fL{constructor(e,r){bf(this,"dataAccessObject",void 0),bf(this,"wtSettings",void 0),bf(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function QC(t,e,r){return(e=gL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gL(t){var e=mL(t,"string");return typeof e=="symbol"?e:e+""}function mL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pL{constructor(e,r){QC(this,"dataAccessObject",void 0),QC(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function an(t,e,r){return(e=wL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wL(t){var e=vL(t,"string");return typeof e=="symbol"?e:e+""}function vL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hs{constructor(e,r,n,i,o){an(this,"wtSettings",null),an(this,"domBindings",void 0),an(this,"TBODY",null),an(this,"THEAD",null),an(this,"COLGROUP",null),an(this,"hasTableHeight",!0),an(this,"hasTableWidth",!0),an(this,"isTableVisible",!1),an(this,"tableOffset",0),an(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,HE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new pL(this.dataAccessObject,this.wtSettings),this.columnUtils=new fL(this.dataAccessObject,this.wtSettings),this.tableRenderer=new cL({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Oe(n,[di()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Oe(n,[di()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",Oe(n,[ho(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Oe(n.parentNode,[di()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Oe(n,[di()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Pr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Pr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),p=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Ek(g,o,c),this.columnFilter=new Sk(p,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(mn)||this.is(mi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(mn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(mn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=la(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(mn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=IE(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=XA(n),s=r.cellIndex;_i(eo,r,this.wtRootElement)||_i(Qi,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):_i(mi,r,this.wtRootElement)||_i(mn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),_i(eo,r,this.wtRootElement)||_i(Ji,r,this.wtRootElement)||_i(mi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=la(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?tr:la,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const g=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-g||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Jt(this.TABLE)}getHeight(){return tr(this.TABLE)}getTotalWidth(){const e=Jt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=tr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ya(this.TABLE)}_modifyRowHeaderWidth(e){let r=Pe(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const yL="stickyRowsBottom",Lm={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Kn(Lm,"MIXIN_NAME",yL,{writable:!1,enumerable:!1});const bL="stickyColumnsStart",Wu={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Kn(Wu,"MIXIN_NAME",bL,{writable:!1,enumerable:!1});class Fm extends hs{constructor(e,r,n,i){super(e,r,n,i,mi)}}Ke(Fm,Lm);Ke(Fm,Wu);const Qi="top",mn="bottom",Ji="inline_start",eo="top_inline_start_corner",mi="bottom_inline_start_corner",m_=[Qi,mn,Ji,eo,mi],CL=new Map([[Qi,`ht_clone_${Qi}`],[mn,`ht_clone_${mn}`],[Ji,`ht_clone_${Ji} ht_clone_left`],[eo,`ht_clone_${eo} ht_clone_top_left_corner`],[mi,`ht_clone_${mi} ht_clone_bottom_left_corner`]]);function SL(t,e){RL(t,e),e.add(t)}function RL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TL(t,e,r){return(e=EL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EL(t){var e=_L(t,"string");return typeof e=="symbol"?e:e+""}function _L(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ds=new WeakSet;class OL{constructor(e){SL(this,Ds),TL(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=hr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=hr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return rl(Ds,this,eS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return rl(Ds,this,eS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return rl(Ds,this,JC).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return rl(Ds,this,JC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function JC(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Pr(n.wtRootElement).left;const u=Math.abs(NE(s,s));if(l>u){const c=kE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function eS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Pr(r.wtRootElement),a=Im(o,o);if(s.top>a){const l=la(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Er(t,e,r){return(e=ML(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ML(t){var e=IL(t,"string");return typeof e=="symbol"?e:e+""}function IL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vm{get eventManager(){return new vi(this)}constructor(e,r){Er(this,"wtTable",void 0),Er(this,"wtScroll",void 0),Er(this,"wtViewport",void 0),Er(this,"wtOverlays",void 0),Er(this,"selectionManager",void 0),Er(this,"wtEvent",void 0),Er(this,"guid",`wt_${RE()}`),Er(this,"drawInterrupted",!1),Er(this,"drawn",!1),Er(this,"activeOverlayName","master"),Er(this,"domBindings",void 0),Er(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new OL(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){ka(n,e[r])}])}}createCellCoords(e,r){return new Zi(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new Fa(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||QA(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function tS(t,e,r){return(e=PL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PL(t){var e=xL(t,"string");return typeof e=="symbol"?e:e+""}function xL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HL extends Vm{constructor(e,r,n){super(e,r),tS(this,"cloneSource",void 0),tS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new d_(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function AL(t,e,r){return(e=DL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DL(t){var e=NL(t,"string");return typeof e=="symbol"?e:e+""}function NL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wa{constructor(e,r,n,i,o){AL(this,"wtSettings",null),Kn(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=lu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=lu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=au(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Yn(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+rr())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(m_.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${CL.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Oe(o,[di()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Qi||u==="vertical"&&this.type===Ji?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=au(e.TABLE),new HL(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class kL extends Wa{constructor(e,r,n,i,o,s){super(e,r,mi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Fm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Lu(r),this.repositionOverlay();let n=tr(this.clone.wtTable.TABLE);const i=Jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=rr(n)),i.style.bottom=`${o}px`}}const LL="calculatedColumns",Bu={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Kn(Bu,"MIXIN_NAME",LL,{writable:!1,enumerable:!1});class Wm extends hs{constructor(e,r,n,i){super(e,r,n,i,mn)}}Ke(Wm,Lm);Ke(Wm,Bu);function FL(t,e,r){return(e=VL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VL(t){var e=WL(t,"string");return typeof e=="symbol"?e:e+""}function WL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BL extends Wa{constructor(e,r,n,i){super(e,r,mn,n,i),FL(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Wm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=rr(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Mm(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=rr(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=rr(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Im(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderBottom"),o=!a):(Ne(s,"innerBorderBottom"),o=a)}return o}}const $L="calculatedRows",Bm={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Kn(Bm,"MIXIN_NAME",$L,{writable:!1,enumerable:!1});class $m extends hs{constructor(e,r,n,i){super(e,r,n,i,Ji)}}Ke($m,Bm);Ke($m,Wu);const jL="localHooks",Tn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)gg(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Kn(Tn,"MIXIN_NAME",jL,{writable:!1,enumerable:!1});let p_=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Ke(p_,Tn);const zL="active-header",w_="header",jm="area",ua="focus",UL="fill",YL="row",qL="column",GL="custom-selection",zm=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var rS={},nS;function KL(){if(nS)return rS;nS=1;var t=Hm();return t("flat"),rS}KL();function XL(t,e){v_(t,e),e.add(t)}function iS(t,e,r){v_(t,e),e.set(t,r)}function v_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(ca(t,e))}function oS(t,e,r){return t.set(ca(t,e),r),r}function ca(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,_t=new WeakMap,nl=new WeakSet;class ZL{constructor(){XL(this,nl),iS(this,zr,void 0),iS(this,_t,void 0)}setActiveOverlay(e){return oS(_t,this,e),this}setActiveSelection(e){return oS(zr,this,e),this}scan(){const e=Ye(zr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ye(zr,this).getCorners(),{wtTable:s}=Ye(_t,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let p=s.getColumnHeader(h,g);const y=Ye(_t,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ye(zr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});y!==null&&(y!==h&&(p=s.getColumnHeader(y,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ye(zr,this).getCorners(),{wtTable:s}=Ye(_t,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let p=s.getRowHeader(h,g);const y=Ye(_t,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ye(zr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});y!==null&&(y!==h&&(p=s.getRowHeader(y,g)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ye(_t,this);ca(nl,this,QL).call(this,(n,i)=>{const o=r.getCell(Ye(_t,this).createCellCoords(n,i)),s=Ye(_t,this).getSetting("onAfterDrawSelection",n,i,Ye(zr,this).settings.layerLevel);typeof s=="string"&&J(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ye(zr,this).getCorners(),{wtTable:i}=Ye(_t,this);ca(nl,this,sS).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ye(_t,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ye(zr,this).getCorners(),{wtTable:i}=Ye(_t,this);ca(nl,this,sS).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ye(_t,this).createCellCoords(o,s));e(a)}})}}function QL(t){let[e,r,n,i]=Ye(zr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ye(_t,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ye(_t,this).createCellCoords(e,r));if(!Gi(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function sS(t){const{wtTable:e}=Ye(_t,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class aS{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=zm(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Fu(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ui()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:r}=this.wot,n=r.getCSSVariableValue("cell-mobile-handle-size"),i=r.getCSSVariableValue("cell-mobile-handle-border-radius"),o=r.getCSSVariableValue("cell-mobile-handle-background-color"),s=r.getCSSVariableValue("cell-mobile-handle-border-width"),a=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Me(c,(d,g)=>{this.selectionHandles.styles.bottomHitArea[g]=d,this.selectionHandles.styles.topHitArea[g]=d});const h=r.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Me(h,(d,g)=>{this.selectionHandles.styles.bottom[g]=d,this.selectionHandles.styles.top[g]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(n-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(n-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),b-p-g*2),T=Math.min(parseInt(i+o-y/4,10),b-y-g*2);h[l]=`${v}px`,d[l]=`${T}px`;const _=Math.min(parseInt(n+s,10),E-p-g*2),M=Math.min(parseInt(n+s-y/4,10),E-y-g*2);h.top=`${_}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),g=s.getLastRenderedColumn();if(d<0&&g<0||c<0&&h<0){this.disappear();return}let p;if(u){if(n=Math.max(n,d),o=Math.min(o,g),r=Math.max(r,c),i=Math.min(i,h),o<n||i<r){this.disappear();return}p=s.getCell(this.wot.createCellCoords(r,n))}else if(p=s.getCell(this.wot.createCellCoords(r,n)),!Gi(p)){this.disappear();return}const y=u?s.getCell(this.wot.createCellCoords(i,o)):p,b=Pr(p),E=u?Pr(y):b,v=Pr(s.TABLE),T=b.top,_=b.left,M=this.wot.wtSettings.getSetting("rtlMode");let I=0,H=0;if(M){const ae=Jt(s.TABLE),be=Jt(p),Ge=l.innerWidth-v.left-ae;H=_+be-E.left,I=l.innerWidth-_-be-Ge-1}else H=E.left+Jt(y)-_,I=_-v.left-1;if(this.isEntireColumnSelected(r,i)){const ae=r,be=this.getDimensionsFromHeader("columns",n,o,ae,v);let Ge=null;be&&([Ge,I,H]=be),Ge&&(p=Ge)}let V=T-v.top-1,N=E.top+tr(y)-T;if(this.isEntireRowSelected(n,o)){const ae=n,be=this.getDimensionsFromHeader("rows",r,i,ae,v);let Ge=null;be&&([Ge,V,N]=be),Ge&&(p=Ge)}const j=l.getComputedStyle(p);parseInt(j.borderTopWidth,10)>0&&(V+=1,N=N>0?N-1:0),parseInt(j[M?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,H=H>0?H-1:0);const z=M?"right":"left";this.topStyle.top=`${V}px`,this.topStyle[z]=`${I}px`,this.topStyle.width=`${H}px`,this.topStyle.display="block",this.startStyle.top=`${V}px`,this.startStyle[z]=`${I}px`,this.startStyle.height=`${N}px`,this.startStyle.display="block";const te=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${V+N-te}px`,this.bottomStyle[z]=`${I}px`,this.bottomStyle.width=`${H}px`,this.bottomStyle.display="block",this.endStyle.top=`${V}px`,this.endStyle[z]=`${I+H-te}px`,this.endStyle.height=`${N+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const G=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Q,lt]=[i,o];if(G&&Array.isArray(G)&&([,,Q,lt]=G),Ui()||!ue||this.isPartRange(Q,lt))this.cornerStyle.display="none";else{this.cornerStyle.top=`${V+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[z]=`${I+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ae=lu(s.TABLE);const be=ae===l;be&&(ae=a.documentElement);const Ge=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,vr=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Ee=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const f=be?y.getBoundingClientRect().left:y.offsetLeft;let m=!1,w=0;M?(w=f-parseInt(this.cornerDefaultStyle.width,10)/2,m=w<0):(w=f+Jt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,m=w>=kE(ae)),m&&(this.cornerStyle[z]=`${Math.floor(I+H+this.cornerCenterPointOffset-vr-Ge)}px`,this.cornerStyle[M?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const w=(be?y.getBoundingClientRect().top:y.offsetTop)+tr(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=la(ae),C=this.wot.stylesHandler.isClassicTheme();if(w){const R=Math.floor(V+N+this.cornerCenterPointOffset-Ee-Ge);C?(this.cornerStyle.top=`${R}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${R-1}px`}}this.cornerStyle.display="block"}Ui()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,V,I,H,N)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,p=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return tr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Jt(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(p=l(r,b-i),y=l(n,b-i),!p||!y)return!1;const E=Pr(p),v=Pr(y);return p&&y&&(h=E[g]-o[g]-1,d=v[g]+u(y)-E[g]),[p,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?J(this[e],"hidden"):(we(this[e],"hidden")&&Ne(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?J(this[e],"hidden"):Ne(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ui()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function JL(t,e){y_(t,e),e.add(t)}function So(t,e,r){y_(t,e),e.set(t,r)}function y_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(Um(t,e))}function lS(t,e,r){return t.set(Um(t,e),r),r}function Um(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ot=new WeakMap,Gt=new WeakMap,Cf=new WeakMap,Js=new WeakMap,Sf=new WeakMap,Ii=new WeakMap,uS=new WeakSet;class eF{constructor(e){JL(this,uS),So(this,Ot,void 0),So(this,Gt,void 0),So(this,Cf,new ZL),So(this,Js,new WeakMap),So(this,Sf,new WeakSet),So(this,Ii,new Map),lS(Gt,this,e)}setActiveOverlay(e){return lS(Ot,this,e),le(Cf,this).setActiveOverlay(le(Ot,this)),le(Js,this).has(le(Ot,this))||le(Js,this).set(le(Ot,this),new Set),this}getFocusSelection(){return le(Gt,this)!==null?le(Gt,this).getFocus():null}getAreaSelection(){return le(Gt,this)!==null?le(Gt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(Ii,this).has(e)){const n=le(Ii,this).get(e);if(n.has(le(Ot,this)))return n.get(le(Ot,this));const i=new aS(le(Ot,this),e.settings);return n.set(le(Ot,this),i),i}const r=new aS(le(Ot,this),e.settings);return le(Ii,this).set(e,new Map([[le(Ot,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(Ii,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(Ii,this).get(e).forEach(r=>r.destroy()),le(Ii,this).delete(e)}render(e){if(le(Gt,this)===null)return;e&&Um(uS,this,tF).call(this);const r=Array.from(le(Gt,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(Sf,this).has(s)||(le(Sf,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&le(Cf,this).setActiveSelection(s).scan().forEach(p=>{if(n.has(p)){const y=n.get(p);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else n.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();le(Ot,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(Js,this).get(le(Ot,this)).add(u)),J(s,l),s.nodeName==="TD"&&Array.isArray((a=le(Gt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Oe(s,le(Gt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Oe(o,[...i.get(o)])})}}function tF(){const t=le(Js,this).get(le(Ot,this)),e=le(Ot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(Ot,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(Gt,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(Gt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(Gt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(Gt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Ne(o[a],r),Na(o[a],s)}),t.clear()}class rF extends Wa{constructor(e,r,n,i){super(e,r,Ji,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new $m(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Pm(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Lu(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,DE(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=rr(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Jt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=zm(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=rr(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,eD(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(NE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?Ne(n,"emptyRows"):J(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)J(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(n,"innerBorderInlineStart");e?(J(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Ne(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const nF="stickyRowsTop",Ym={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Kn(Ym,"MIXIN_NAME",nF,{writable:!1,enumerable:!1});class qm extends hs{constructor(e,r,n,i){super(e,r,n,i,eo)}}Ke(qm,Ym);Ke(qm,Wu);function cS(t,e,r){return(e=iF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iF(t){var e=oF(t,"string");return typeof e=="symbol"?e:e+""}function oF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sF extends Wa{constructor(e,r,n,i,o,s){super(e,r,eo,n,i),cS(this,"topOverlay",void 0),cS(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new qm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Pm(e,`${i}px`,`${o}px`)}else Lu(e);let r=tr(this.clone.wtTable.TABLE);const n=Jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class Gm extends hs{constructor(e,r,n,i){super(e,r,n,i,Qi)}}Ke(Gm,Ym);Ke(Gm,Bu);function aF(t,e,r){return(e=lF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lF(t){var e=uF(t,"string");return typeof e=="symbol"?e:e+""}function uF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cF extends Wa{constructor(e,r,n,i){super(e,r,Qi,n,i),aF(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Gm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Pm(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Lu(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Mm(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=rr(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=zm(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=rr(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,JA(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Im(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?Ne(i,"emptyColumns"):J(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(J(i,"innerBorderTop"),a=!h):(Ne(i,"innerBorderTop"),a=h)}}return a}}function il(t,e,r){hF(t,e),e.set(t,r)}function hF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e,r){return(e=dF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dF(t){var e=fF(t,"string");return typeof e=="symbol"?e:e+""}function fF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pi(t,e,r){return t.set(b_(t,e),r),r}function xn(t,e){return t.get(b_(t,e))}function b_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ro=new WeakMap,ol=new WeakMap,To=new WeakMap,sl=new WeakMap;class gF{constructor(e,r,n,i,o,s){Pn(this,"wot",null),il(this,Ro,[]),Pn(this,"topOverlay",null),Pn(this,"bottomOverlay",null),Pn(this,"inlineStartOverlay",null),Pn(this,"topInlineStartCornerOverlay",null),Pn(this,"bottomInlineStartCornerOverlay",null),Pn(this,"browserLineHeight",void 0),Pn(this,"wtSettings",null),il(this,ol,!1),il(this,To,0),il(this,sl,null),Pn(this,"resizeObserver",new ResizeObserver(c=>{mg(()=>{!Array.isArray(c)||!c.length||(Pi(To,this,xn(To,this)+1),xn(To,this)===100&&(Yn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),xn(sl,this)!==null&&clearTimeout(xn(sl,this)),Pi(sl,this,setTimeout(()=>{Pi(To,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=rr(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:au(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...xn(Ro,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new cF(...e),this.bottomOverlay=new BL(...e),this.inlineStartOverlay=new rF(...e),this.topInlineStartCornerOverlay=new sF(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new kL(...e,this.bottomOverlay,this.inlineStartOverlay),Pi(Ro,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Pi(ol,this,xn(Ro,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),xn(Ro,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),xn(Ro,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!pD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{mg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Pi(To,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=RD(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!xn(ol,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Pi(ol,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=au(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=r.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),p=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),y=g()?1:0,b=p()?1:0;d.width=`${c+b}px`,d.height=`${u+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return F(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];F(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function hS(t,e,r){return(e=mF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mF(t){var e=pF(t,"string");return typeof e=="symbol"?e:e+""}function pF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wF{constructor(e){hS(this,"settings",{}),hS(this,"defaults",Object.freeze(this.getDefaults())),Me(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);ka(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?Me(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Km extends hs{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=lu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=qb(e,"height",r),o=qb(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ya(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Ke(Km,Bm);Ke(Km,Bu);class vF{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new KN:new tk],["fullyVisible",()=>new VN],["partiallyVisible",()=>new a_]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new YN:new QN],["fullyVisible",()=>new kN],["partiallyVisible",()=>new s_]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=tr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Pr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=tr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=Jt(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=rr(this.domBindings.rootDocument),new uk({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=rr(this.domBindings.rootDocument)),new sk({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}resetHasOversizedColumnHeadersMarked(){Me(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}function yF(t,e){C_(t,e),e.add(t)}function xi(t,e,r){C_(t,e),e.set(t,r)}function C_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function We(t,e){return t.get(Kr(t,e))}function Gr(t,e,r){return t.set(Kr(t,e),r),r}function Kr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const dS=23;var hn=new WeakMap,Vn=new WeakMap,Xm=new WeakMap,Cg=new WeakMap,si=new WeakMap,ea=new WeakMap,Ca=new WeakMap,dn=new WeakSet;class bF{constructor(e){yF(this,dn),xi(this,hn,void 0),xi(this,Vn,void 0),xi(this,Xm,void 0),xi(this,Cg,void 0),xi(this,si,!0),xi(this,ea,{}),xi(this,Ca,{}),Gr(Vn,this,e.rootTable.parentElement.parentElement),Gr(Cg,this,e.rootDocument)}isClassicTheme(){return We(si,this)}getCSSVariableValue(e){var r;if(We(si,this))return null;if(We(ea,this)[`--ht-${e}`])return We(ea,this)[`--ht-${e}`];const n=(r=Kr(dn,this,TF).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Kr(dn,this,S_).call(this,`--ht-${e}`);if(n!==null)return We(ea,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=We(Ca,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(We(si,this))return dS;const e=Kr(dn,this,CF).call(this);return!e&&we(We(Vn,this),"ht-wrapper")?(Yn(`The "${We(hn,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Gr(si,this,!0),this.useTheme(),dS):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Kr(dn,this,fS).call(this),Gr(si,this,!0),Gr(hn,this,e||void 0);return}e&&e!==We(hn,this)&&(We(hn,this)&&Kr(dn,this,EF).call(this),Gr(hn,this,e),Gr(si,this,!1),Kr(dn,this,SF).call(this),Kr(dn,this,fS).call(this))}getThemeName(){return We(hn,this)}removeClassNames(){we(We(Vn,this),We(hn,this))&&Ne(We(Vn,this),We(hn,this))}}function CF(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function SF(){Ne(We(Vn,this),/ht-theme-.*/g),J(We(Vn,this),We(hn,this))}function fS(){this.isClassicTheme()||Gr(Xm,this,getComputedStyle(We(Vn,this)));const t=Kr(dn,this,RF).call(this,["box-sizing","border-bottom-width"]);We(Ca,this).td={...We(Ca,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function RF(t){const e=We(Cg,this),r=We(Vn,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function TF(t){const e=Math.ceil(parseFloat(Kr(dn,this,S_).call(this,t)));return Number.isNaN(e)?null:e}function S_(t){const e=We(Xm,this).getPropertyValue(t);return e===""?null:e}function EF(){Gr(Ca,this,{}),Gr(ea,this,{}),Gr(si,this,!0)}class _F extends Vm{constructor(e,r){super(e,new wF(r)),this.stylesHandler=new bF(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Km(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new vF(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new eF(this.wtSettings.getSetting("selections")),this.wtEvent=new d_(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new gF(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Me(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),Ne(this.wtTable.wtRootElement.parentNode,r),J(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!m_.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Zm{constructor(e){e instanceof Vm?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Zm(r);return()=>n},this._wot=new _F(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function gS(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function OF(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const MF=new Map([["mousedown",gS],["mouseover",OF],["touchstart",gS]]);function mS(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:o}=e;MF.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:qE(t)||t.type==="touchstart",isRightClick:uu(t)})}const R_=new WeakMap,Qm=Symbol("rootInstance");function IF(t){R_.set(t,!0)}function PF(t){return t===Qm}function jl(t){return R_.has(t)}function xF(t,e){T_(t,e),e.add(t)}function ti(t,e,r){T_(t,e),e.set(t,r)}function T_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e,r){return(e=HF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HF(t){var e=AF(t,"string");return typeof e=="symbol"?e:e+""}function AF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ze(t,e){return t.get(Ko(t,e))}function jt(t,e,r){return t.set(Ko(t,e),r),r}function Ko(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Rf=new WeakMap,al=new WeakMap,ll=new WeakMap,Hn=new WeakMap,$r=new WeakMap,Tf=new WeakMap,Ef=new WeakMap,Eo=new WeakMap,ta=new WeakSet;class DF{constructor(e){xF(this,ta),ri(this,"hot",void 0),ri(this,"eventManager",void 0),ri(this,"settings",void 0),ri(this,"THEAD",void 0),ri(this,"TBODY",void 0),ri(this,"_wt",void 0),ri(this,"activeWt",void 0),ti(this,Rf,0),ti(this,al,0),ri(this,"postponedAdjustElementsSize",!1),ti(this,ll,!1),ti(this,Hn,void 0),ti(this,$r,void 0),ti(this,Tf,0),ti(this,Ef,0),ti(this,Eo,null),this.hot=e,this.eventManager=new vi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Ko(ta,this,kF).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),J(e,"handsontable"),jt($r,this,r.createElement("TABLE")),J(Ze($r,this),"htCore"),this.hot.getSettings().tableClassName&&J(Ze($r,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Oe(Ze($r,this),[di()]),Oe(e,[DA(),_E(-1),ku(this.hot.countCols()),UA()])),this.THEAD=r.createElement("THEAD"),Ze($r,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Ze($r,this).appendChild(this.TBODY),this.hot.table=Ze($r,this),this.hot.container.insertBefore(Ze($r,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,o=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{jt(ll,this,!0),this.isTextSelectionAllowed(a.target)||(Gb(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{jt(ll,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Ze(ll,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&Gb(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{n.isInProgress()&&qE(a)&&n.finish(),jt(Hn,this,!1);const l=FE(r.activeElement);$l(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!uu(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{n.isInProgress()&&uu(a)&&(n.finish(),jt(Hn,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),jt(Hn,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Ze(Hn,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const p=rr(r);if(r.elementFromPoint(u+p,c)!==d||r.elementFromPoint(u,c+p)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=va(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=va(s);this.eventManager.addEventListener(Ze($r,this),"selectstart",a=>{this.settings.fragmentSelection||$l(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&J(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Ne(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ze($r,this),isDataViewInstance:()=>jl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),jt(al,this,o.length),this.hot.getSettings().ariaTags&&Ko(ta,this,E_).call(this)===this.hot.countCols()&&Ko(ta,this,NF).call(this,Ze(al,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),jt(Rf,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let y=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,y,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,y,g),this.hot.runHooks("afterRenderer",a,l,u,p,y,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ya(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,jt(Hn,this,!0),jt(Eo,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Bi(o)&&(mS(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,jt(Hn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Bi(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Bi(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Bi(o)&&(Ze(Hn,this)&&(!Ze(Eo,this)||Ze(Eo,this).x!==o.clientX||Ze(Eo,this).y!==o.clientY)&&mS(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,jt(Eo,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Bi(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[p,y,b,E]=g;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Zm(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if($l(e))return!0;const r=qo(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ze(Hn,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!we(n,"relative")){Xo(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",J(s,["relative",...o()])):(Xo(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Oe(a,...di()),Oe(l,...di())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?AE(e,n(r,i)):(ka(e,"Â "),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){jt(Tf,this,e),jt(Ef,this,r)}getLastSize(){return{width:Ze(Tf,this),height:Ze(Ef,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ze(Rf,this)}getRowHeadersCount(){return Ze(al,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function E_(){return parseInt(this.hot.rootElement.getAttribute(ku()[0]),10)}function NF(t){const e=Ko(ta,this,E_).call(this)+t;Oe(this.hot.rootElement,...ku(e))}function kF(){const t=this.hot.rootElement;this.hasVerticalScroll()?J(t,"htHasScrollY"):Ne(t,"htHasScrollY"),this.hasHorizontalScroll()?J(t,"htHasScrollX"):Ne(t,"htHasScrollX")}var pS={},wS={},vS;function LF(){if(vS)return wS;vS=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,p){if(!c(g,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),wS}var yS;function FF(){return yS||(yS=1,LF()),pS}FF();const VF="ABCDEFGHIJKLMNOPQRSTUVWXYZ",bS=VF.length;function WF(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%bS,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/bS,10);return r}function __(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&bt(t[0])&&(e=xm(t[0]))),e}function Ns(t,e,r){return(e=BF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BF(t){var e=$F(t,"string");return typeof e=="symbol"?e:e+""}function $F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jF{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Ns(this,"hot",void 0),Ns(this,"data",void 0),Ns(this,"dataType","array"),Ns(this,"colToProp",()=>{}),Ns(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return F(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):qe(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(bt(a)||Pe(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;qe(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?Kd(l,d,g):l[d]=g}})}else Me(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Kd(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=hr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Kd(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?hD(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=hr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return qe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return __(this.data)}destroy(){this.data=null,this.hot=null}}var CS={},SS={},RS;function zF(){if(RS)return SS;RS=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,p){if(c(g,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),SS}var TS;function UF(){return TS||(TS=1,zF()),CS}UF();function ES(t,e,r){return(e=YF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YF(t){var e=qF(t,"string");return typeof e=="symbol"?e:e+""}function qF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ba{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ES(this,"indexedValues",[]),ES(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Pe(this.initValueOrFn)?qe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):qe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ke(Ba,Tn);function O_(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Pe(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function M_(t,e){return _m(t,(r,n)=>e.includes(n)===!1)}class $u extends Ba{insert(e,r){this.indexedValues=O_(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=M_(this.indexedValues,e),super.remove(e)}}class I_ extends $u{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return co(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function P_(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function hu(t,e){return _m(t,r=>e.includes(r)===!1)}function x_(t,e){return yn(t,r=>r-e.filter(n=>n<r).length)}function H_(t,e){const r=e[0],n=e.length;return yn(t,i=>i>=r?i+n:i)}function GF(t,e,r){return(e=KF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KF(t){var e=XF(t,"string");return typeof e=="symbol"?e:e+""}function XF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZF extends Ba{constructor(){super(...arguments),GF(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=hu(this.orderOfIndexes,[e]),Pe(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=O_(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=H_(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=M_(this.indexedValues,e),this.orderOfIndexes=hu(this.orderOfIndexes,e),this.orderOfIndexes=x_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class A_ extends $u{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return co(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class QF extends Ba{constructor(){super(e=>e)}insert(e,r){const n=H_(this.indexedValues,r);this.indexedValues=P_(n,e,r),super.insert(e,r)}remove(e){const r=hu(this.indexedValues,e);this.indexedValues=x_(r,e),super.remove(e)}}const _S=new Map([["hiding",I_],["index",Ba],["linkedPhysicalIndexToValue",ZF],["physicalIndexToValue",$u],["trimming",A_]]);function JF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!_S.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(_S.get(t))(e)}function eV(t,e,r){return(e=tV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tV(t){var e=rV(t,"string");return typeof e=="symbol"?e:e+""}function rV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jm{constructor(){eV(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);me(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Nt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Ke(Jm,Tn);function _f(t,e,r){return(e=nV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nV(t){var e=iV(t,"string");return typeof e=="symbol"?e:e+""}function iV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OS extends Jm{constructor(e,r){super(),_f(this,"mergedValuesCache",[]),_f(this,"aggregationFunction",void 0),_f(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=yn(this.get(),o=>o.getValues()),n=[],i=me(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return yn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return me(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function oV(t,e,r){sV(t,e),e.set(t,r)}function sV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aV(t,e,r){return t.set(D_(t,e),r),r}function lV(t,e){return t.get(D_(t,e))}function D_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Of=new WeakMap;class N_{constructor(){oV(this,Of,[])}subscribe(e){return this.addLocalHook("change",e),this._write(lV(Of,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){aV(Of,this,e)}}Ke(N_,Tn);function MS(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ks(t,e,r){uV(t,e),e.set(t,r)}function uV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e){return t.get(k_(t,e))}function ul(t,e,r){return t.set(k_(t,e),r),r}function k_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cl=new WeakMap,Ls=new WeakMap,hl=new WeakMap,dl=new WeakMap,fl=new WeakMap;class cV{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ks(this,cl,new Set),ks(this,Ls,[]),ks(this,hl,[]),ks(this,dl,!1),ks(this,fl,!1),ul(fl,this,e??!1)}createObserver(){const e=new N_;return _r(cl,this).add(e),e.addLocalHook("unsubscribe",()=>{_r(cl,this).delete(e)}),e._writeInitialChanges(MS(_r(Ls,this),_r(hl,this))),e}emit(e){let r=_r(hl,this);(!_r(dl,this)||_r(Ls,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(_r(fl,this)):ul(Ls,this,new Array(e.length).fill(_r(fl,this))),_r(dl,this)||(ul(dl,this,!0),r=_r(Ls,this)));const n=MS(r,e);_r(cl,this).forEach(i=>i._write(n)),ul(hl,this,e)}}function xt(t,e,r){return(e=hV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hV(t){var e=dV(t,"string");return typeof e=="symbol"?e:e+""}function dV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sg{constructor(){xt(this,"indexesSequence",new QF),xt(this,"trimmingMapsCollection",new OS(e=>e.some(r=>r===!0),!1)),xt(this,"hidingMapsCollection",new OS(e=>e.some(r=>r===!0),!1)),xt(this,"variousMapsCollection",new Jm),xt(this,"hidingChangesObservable",new cV({initialIndexValue:!1})),xt(this,"notTrimmedIndexesCache",[]),xt(this,"notHiddenIndexesCache",[]),xt(this,"isBatched",!1),xt(this,"indexesSequenceChanged",!1),xt(this,"indexesChangeSource",void 0),xt(this,"trimmedIndexesChanged",!1),xt(this,"hiddenIndexesChanged",!1),xt(this,"renderablePhysicalIndexesCache",[]),xt(this,"fromPhysicalToVisualIndexesCache",new Map),xt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,JF(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof A_?this.trimmingMapsCollection.register(e,r):r instanceof I_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return me(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return me(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return me(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return me(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=yn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=hu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(P_(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=me(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=yn(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Ke(Sg,Tn);function fV(t,e){return Me(e,(r,n)=>{Nt(t[n])&&(t[n]=r)}),t}function L_(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function F_(t){me(t)&&TD(er`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function gV(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:mV,getValues:pV}=cs("phraseFormatters");function wV(t,e){mV(t,e)}function vV(){return pV()}wV("pluralize",gV);const V_="ContextMenu:items",ne=V_,ep=`${ne}.noItems`,tp=`${ne}.insertRowAbove`,rp=`${ne}.insertRowBelow`,np=`${ne}.insertColumnOnTheLeft`,ip=`${ne}.insertColumnOnTheRight`,op=`${ne}.removeRow`,sp=`${ne}.removeColumn`,ap=`${ne}.undo`,lp=`${ne}.redo`,du=`${ne}.readOnly`,up=`${ne}.clearColumn`,cp=`${ne}.copy`,hp=`${ne}.copyWithHeaders`,dp=`${ne}.copyWithGroupHeaders`,fp=`${ne}.copyHeadersOnly`,gp=`${ne}.cut`,W_=`${ne}.freezeColumn`,B_=`${ne}.unfreezeColumn`,$_=`${ne}.mergeCells`,j_=`${ne}.unmergeCells`,z_=`${ne}.addComment`,U_=`${ne}.editComment`,Y_=`${ne}.removeComment`,q_=`${ne}.readOnlyComment`,mp=`${ne}.align`,pp=`${ne}.align.left`,wp=`${ne}.align.center`,vp=`${ne}.align.right`,yp=`${ne}.align.justify`,bp=`${ne}.align.top`,Cp=`${ne}.align.middle`,Sp=`${ne}.align.bottom`,G_=`${ne}.borders`,K_=`${ne}.borders.top`,X_=`${ne}.borders.right`,Z_=`${ne}.borders.bottom`,Q_=`${ne}.borders.left`,J_=`${ne}.borders.remove`,e0=`${ne}.nestedHeaders.insertChildRow`,t0=`${ne}.nestedHeaders.detachFromParent`,r0=`${ne}.hideColumn`,n0=`${ne}.showColumn`,i0=`${ne}.hideRow`,o0=`${ne}.showRow`,nr="Filters:",Xe=`${nr}conditions`,s0=`${Xe}.none`,a0=`${Xe}.isEmpty`,l0=`${Xe}.isNotEmpty`,u0=`${Xe}.isEqualTo`,c0=`${Xe}.isNotEqualTo`,h0=`${Xe}.beginsWith`,d0=`${Xe}.endsWith`,f0=`${Xe}.contains`,g0=`${Xe}.doesNotContain`,yV=`${Xe}.byValue`,m0=`${Xe}.greaterThan`,p0=`${Xe}.greaterThanOrEqualTo`,w0=`${Xe}.lessThan`,v0=`${Xe}.lessThanOrEqualTo`,y0=`${Xe}.isBetween`,b0=`${Xe}.isNotBetween`,C0=`${Xe}.after`,S0=`${Xe}.before`,R0=`${Xe}.today`,T0=`${Xe}.tomorrow`,E0=`${Xe}.yesterday`,_0=`${nr}labels.filterByCondition`,O0=`${nr}labels.filterByValue`,M0=`${nr}labels.conjunction`,I0=`${nr}labels.disjunction`,P0=`${nr}values.blankCells`,x0=`${nr}buttons.selectAll`,H0=`${nr}buttons.clear`,A0=`${nr}buttons.ok`,D0=`${nr}buttons.cancel`,N0=`${nr}buttons.placeholder.search`,k0=`${nr}buttons.placeholder.value`,L0=`${nr}buttons.placeholder.secondValue`,Rp="CheckboxRenderer:",F0=`${Rp}checked`,V0=`${Rp}unchecked`,bV=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:F0,CHECKBOX_RENDERER_NAMESPACE:Rp,CHECKBOX_UNCHECKED:V0,CONTEXTMENU_ITEMS_ADD_COMMENT:z_,CONTEXTMENU_ITEMS_ALIGNMENT:mp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Sp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:wp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:yp,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:pp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Cp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:vp,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:bp,CONTEXTMENU_ITEMS_BORDERS:G_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Z_,CONTEXTMENU_ITEMS_BORDERS_LEFT:Q_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:X_,CONTEXTMENU_ITEMS_BORDERS_TOP:K_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:up,CONTEXTMENU_ITEMS_COPY:cp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:fp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:dp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:hp,CONTEXTMENU_ITEMS_CUT:gp,CONTEXTMENU_ITEMS_EDIT_COMMENT:U_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:W_,CONTEXTMENU_ITEMS_HIDE_COLUMN:r0,CONTEXTMENU_ITEMS_HIDE_ROW:i0,CONTEXTMENU_ITEMS_INSERT_LEFT:np,CONTEXTMENU_ITEMS_INSERT_RIGHT:ip,CONTEXTMENU_ITEMS_MERGE_CELLS:$_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:t0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:e0,CONTEXTMENU_ITEMS_NO_ITEMS:ep,CONTEXTMENU_ITEMS_READ_ONLY:du,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:q_,CONTEXTMENU_ITEMS_REDO:lp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:J_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:sp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Y_,CONTEXTMENU_ITEMS_REMOVE_ROW:op,CONTEXTMENU_ITEMS_ROW_ABOVE:tp,CONTEXTMENU_ITEMS_ROW_BELOW:rp,CONTEXTMENU_ITEMS_SHOW_COLUMN:n0,CONTEXTMENU_ITEMS_SHOW_ROW:o0,CONTEXTMENU_ITEMS_UNDO:ap,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:B_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:j_,CONTEXT_MENU_ITEMS_NAMESPACE:V_,FILTERS_BUTTONS_CANCEL:D0,FILTERS_BUTTONS_CLEAR:H0,FILTERS_BUTTONS_OK:A0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:N0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:L0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:k0,FILTERS_BUTTONS_SELECT_ALL:x0,FILTERS_CONDITIONS_AFTER:C0,FILTERS_CONDITIONS_BEFORE:S0,FILTERS_CONDITIONS_BEGINS_WITH:h0,FILTERS_CONDITIONS_BETWEEN:y0,FILTERS_CONDITIONS_BY_VALUE:yV,FILTERS_CONDITIONS_CONTAINS:f0,FILTERS_CONDITIONS_EMPTY:a0,FILTERS_CONDITIONS_ENDS_WITH:d0,FILTERS_CONDITIONS_EQUAL:u0,FILTERS_CONDITIONS_GREATER_THAN:m0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:p0,FILTERS_CONDITIONS_LESS_THAN:w0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:v0,FILTERS_CONDITIONS_NAMESPACE:Xe,FILTERS_CONDITIONS_NONE:s0,FILTERS_CONDITIONS_NOT_BETWEEN:b0,FILTERS_CONDITIONS_NOT_CONTAIN:g0,FILTERS_CONDITIONS_NOT_EMPTY:l0,FILTERS_CONDITIONS_NOT_EQUAL:c0,FILTERS_CONDITIONS_TODAY:R0,FILTERS_CONDITIONS_TOMORROW:T0,FILTERS_CONDITIONS_YESTERDAY:E0,FILTERS_DIVS_FILTER_BY_CONDITION:_0,FILTERS_DIVS_FILTER_BY_VALUE:O0,FILTERS_LABELS_CONJUNCTION:M0,FILTERS_LABELS_DISJUNCTION:I0,FILTERS_NAMESPACE:nr,FILTERS_VALUES_BLANK_CELLS:P0},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const W0={languageCode:"en-US",[ep]:"No available options",[tp]:"Insert row above",[rp]:"Insert row below",[np]:"Insert column left",[ip]:"Insert column right",[op]:["Remove row","Remove rows"],[sp]:["Remove column","Remove columns"],[ap]:"Undo",[lp]:"Redo",[du]:"Read only",[up]:"Clear column",[mp]:"Alignment",[pp]:"Left",[wp]:"Center",[vp]:"Right",[yp]:"Justify",[bp]:"Top",[Cp]:"Middle",[Sp]:"Bottom",[W_]:"Freeze column",[B_]:"Unfreeze column",[G_]:"Borders",[K_]:"Top",[X_]:"Right",[Z_]:"Bottom",[Q_]:"Left",[J_]:"Remove border(s)",[z_]:"Add comment",[U_]:"Edit comment",[Y_]:"Delete comment",[q_]:"Read-only comment",[$_]:"Merge cells",[j_]:"Unmerge cells",[cp]:"Copy",[hp]:["Copy with header","Copy with headers"],[dp]:["Copy with group header","Copy with group headers"],[fp]:["Copy header only","Copy headers only"],[gp]:"Cut",[e0]:"Insert child row",[t0]:"Detach from parent",[r0]:["Hide column","Hide columns"],[n0]:["Show column","Show columns"],[i0]:["Hide row","Hide rows"],[o0]:["Show row","Show rows"],[s0]:"None",[a0]:"Is empty",[l0]:"Is not empty",[u0]:"Is equal to",[c0]:"Is not equal to",[h0]:"Begins with",[d0]:"Ends with",[f0]:"Contains",[g0]:"Does not contain",[m0]:"Greater than",[p0]:"Greater than or equal to",[w0]:"Less than",[v0]:"Less than or equal to",[y0]:"Is between",[b0]:"Is not between",[C0]:"After",[S0]:"Before",[R0]:"Today",[T0]:"Tomorrow",[E0]:"Yesterday",[P0]:"Blank cells",[_0]:"Filter by condition",[O0]:"Filter by value",[M0]:"And",[I0]:"Or",[x0]:"Select all",[H0]:"Clear",[A0]:"OK",[D0]:"Cancel",[N0]:"Search",[k0]:"Value",[L0]:"Second value",[F0]:"Checked",[V0]:"Unchecked"},CV=bV,Rg=W0.languageCode,{register:SV,getItem:B0,hasItem:RV,getValues:TV}=cs("languagesDictionaries");$0(W0);function $0(t,e){let r=t,n=e;return bt(t)&&(n=t,r=n.languageCode),EV(r,n),SV(r,gr(n)),gr(n)}function EV(t,e){t!==Rg&&fV(e,B0(Rg))}function j0(t){return Tp(t)?gr(B0(t)):null}function Tp(t){return RV(t)}function _V(){return TV()}function z0(t,e,r){const n=j0(t);if(n===null)return null;const i=n[e];if(Nt(i))return null;const o=OV(i,r);return Array.isArray(o)?o[0]:o}function OV(t,e){let r=t;return F(vV(),n=>{r=n(t,e)}),r}function MV(t){let e=L_(t);return Tp(e)||(e=Rg,F_(t)),e}function IV(t,e,r){return(e=PV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PV(t){var e=xV(t,"string");return typeof e=="symbol"?e:e+""}function xV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xn extends p_{constructor(e,r){super(e,null),IV(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function Mf(t){let{activeHeaderClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:zL})}function HV(t){let{areaCornerVisible:e,...r}=t;return new Xn({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:jm})}function AV(t){let{...e}=t;return new Xn({className:"highlight",...e,selectionType:jm})}function DV(t){let{columnClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:qL})}function NV(t){let{cellCornerVisible:e,...r}=t;return new Xn({className:"current",headerAttributes:[ME()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:ua})}function kV(t){let{border:e,visualCellRange:r,...n}=t;return new Xn({...e,...n,selectionType:GL},r)}function LV(t){let{...e}=t;return new Xn({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:UL})}function IS(t){let{headerClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:w_})}function FV(t){let{rowClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:YL})}function VV(t,e){WV(t,e),e.add(t)}function WV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e,r){return(e=BV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BV(t){var e=$V(t,"string");return typeof e=="symbol"?e:e+""}function $V(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function An(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ln=new WeakSet;class jV{constructor(e){VV(this,ln),zt(this,"options",void 0),zt(this,"layerLevel",0),zt(this,"focus",void 0),zt(this,"fill",void 0),zt(this,"layeredAreas",new Map),zt(this,"areas",new Map),zt(this,"rowHeaders",new Map),zt(this,"columnHeaders",new Map),zt(this,"activeRowHeaders",new Map),zt(this,"activeColumnHeaders",new Map),zt(this,"activeCornerHeaders",new Map),zt(this,"rowHighlights",new Map),zt(this,"columnHighlights",new Map),zt(this,"customSelections",[]),this.options=e,this.focus=NV(e),this.fill=LV(e)}isEnabledFor(e,r){let n=e;e===ua&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return An(ln,this,Dn).call(this,this.layeredAreas,HV)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return An(ln,this,Dn).call(this,this.areas,AV)}getAreas(){return[...this.areas.values()]}createRowHeader(){return An(ln,this,Dn).call(this,this.rowHeaders,IS)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return An(ln,this,Dn).call(this,this.columnHeaders,IS)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return An(ln,this,Dn).call(this,this.activeRowHeaders,Mf)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return An(ln,this,Dn).call(this,this.activeColumnHeaders,Mf)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return An(ln,this,Dn).call(this,this.activeCornerHeaders,Mf)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return An(ln,this,Dn).call(this,this.rowHighlights,FV)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return An(ln,this,Dn).call(this,this.columnHighlights,DV)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(kV({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),F(this.areas.values(),e=>void e.clear()),F(this.layeredAreas.values(),e=>void e.clear()),F(this.rowHeaders.values(),e=>void e.clear()),F(this.columnHeaders.values(),e=>void e.clear()),F(this.activeRowHeaders.values(),e=>void e.clear()),F(this.activeColumnHeaders.values(),e=>void e.clear()),F(this.activeCornerHeaders.values(),e=>void e.clear()),F(this.rowHighlights.values(),e=>void e.clear()),F(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Dn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function PS(t,e,r){return(e=zV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zV(t){var e=UV(t,"string");return typeof e=="symbol"?e:e+""}function UV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YV{constructor(e){PS(this,"ranges",[]),PS(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function qV(t,e){U0(t,e),e.add(t)}function If(t,e,r){U0(t,e),e.set(t,r)}function U0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ve(t,e){return t.get(rt(t,e))}function gl(t,e,r){return t.set(rt(t,e),r),r}function rt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ml=new WeakMap,De=new WeakMap,Zr=new WeakMap,ct=new WeakSet;class Tg{constructor(e,r){qV(this,ct),If(this,ml,void 0),If(this,De,void 0),If(this,Zr,{x:0,y:0}),gl(ml,this,e),gl(De,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=ve(De,this).createCellCoords(e,r);let o=ve(ml,this).current().highlight;const s=ve(De,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=rt(ct,this,Y0).call(this),{row:h,col:d}=rt(ct,this,HS).call(this,o),g=ve(De,this).fixedRowsBottom(),p=ve(De,this).minSpareRows(),y=ve(De,this).minSpareCols(),b=ve(De,this).autoWrapRow(),E=ve(De,this).autoWrapCol(),v=ve(De,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const M=hr(n&&p>0&&g===0),I=v.col+1,H=ve(De,this).createCellCoords(v.row-c,I>=u?I-u:I);this.runLocalHooks("beforeColumnWrap",M,rt(ct,this,_o).call(this,H),I>=u),M.value?this.runLocalHooks("insertRowRequire",ve(De,this).countRenderableRows()):E&&v.assign(H)}else if(v.row<0){const M=hr(E),I=v.col-1,H=ve(De,this).createCellCoords(c+v.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",M,rt(ct,this,_o).call(this,H),I<0),E&&v.assign(H)}if(v.col>=u){const M=hr(n&&y>0),I=v.row+1,H=ve(De,this).createCellCoords(I>=c?I-c:I,v.col-u);this.runLocalHooks("beforeRowWrap",M,rt(ct,this,_o).call(this,H),I>=c),M.value?this.runLocalHooks("insertColRequire",ve(De,this).countRenderableColumns()):b&&v.assign(H)}else if(v.col<0){const M=hr(b),I=v.row-1,H=ve(De,this).createCellCoords(I<0?c+I:I,u+v.col);this.runLocalHooks("beforeRowWrap",M,rt(ct,this,_o).call(this,H),I<0),b&&v.assign(H)}const{rowDir:T,colDir:_}=rt(ct,this,xS).call(this,v);a=T,l=_,o=rt(ct,this,_o).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,r){const n=ve(De,this).createCellCoords(e,r),i=ve(ml,this).current(),o=ve(De,this).visualToRenderableCoords(i.highlight),s=rt(ct,this,Pf).call(this,i.to.row,i.from.row),a=rt(ct,this,xf).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=rt(ct,this,HS).call(this,i.highlight),g=ve(De,this).createCellCoords(s+n.row,a+n.col),p=i.getTopStartCorner(),y=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const _=g.col-d;g.col=rt(ct,this,xf).call(this,p.col,y.col)+_}else if(n.col>0&&a<=d&&g.col>d){const _=rt(ct,this,xf).call(this,y.col,p.col),M=Math.max(g.col-_,1);g.col=_+M}if(n.row<0&&s>=h&&g.row<h){const _=g.row-h;g.row=rt(ct,this,Pf).call(this,p.row,b.row)+_}else if(n.row>0&&s<=h&&g.row>h){const _=rt(ct,this,Pf).call(this,b.row,p.row),M=Math.max(g.row-_,1);g.row=_+M}const{rowDir:E,colDir:v}=rt(ct,this,xS).call(this,g);u=E,c=v;const T=rt(ct,this,_o).call(this,g);n.row===0&&n.col!==0?l.col=T.col:n.row!==0&&n.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;gl(Zr,this,{x:r,y:n})}resetOffsetSize(){gl(Zr,this,{x:0,y:0})}}function xS(t){const{width:e,height:r}=rt(ct,this,Y0).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function Y0(){return{width:ve(Zr,this).x+ve(De,this).countRenderableColumns(),height:ve(Zr,this).y+ve(De,this).countRenderableRows()}}function Pf(t,e){const r=ve(De,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:ve(Zr,this).y+r}function xf(t,e){const r=ve(De,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ve(Zr,this).x+r}function HS(t){const{row:e,col:r}=ve(De,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return ve(De,this).createCellCoords(ve(Zr,this).y+e,ve(Zr,this).x+r)}function _o(t){const e=t.clone();return e.col=t.col-ve(Zr,this).x,e.row=t.row-ve(Zr,this).y,ve(De,this).renderableToVisualCoords(e)}Ke(Tg,Tn);const ju=0,zu=1,q0=2,Ep=3,GV=[Ep,q0],KV=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Hf=Symbol("root"),AS=Symbol("child");function Uu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Hf;if(e!==Hf&&e!==AS)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Hf;let i=ju;if(r){const o=t[0];t.length===0?i=zu:n&&o instanceof Fa?i=Ep:n&&Array.isArray(o)?i=Uu(o,AS):t.length>=2&&t.length<=4&&!t.some((a,l)=>!KV[l].includes(typeof a))&&(i=q0)}return i}function _p(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!GV.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Ep;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Nt(u)&&(u=a),Nt(c)&&(c=l),!n){const g=a,p=l,y=u,b=c;a=Math.min(g,y),l=Math.min(p,b),u=Math.max(g,y),c=Math.max(p,b)}const h=e(a,l),d=e(u,c);return r(h,h,d)}}function XV(t){const e=Uu(t.getSelected());if(e===ju||e===zu)return[];const r=_p(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;F(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;F(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return co(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function ZV(t){const e=Uu(t.getSelected());if(e===ju||e===zu)return[];const r=_p(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;F(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;F(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return co(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Oo(t,e,r){QV(t,e),e.set(t,r)}function QV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e,r){return(e=JV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JV(t){var e=eW(t,"string");return typeof e=="symbol"?e:e+""}function eW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fe(t,e){return t.get(G0(t,e))}function un(t,e,r){return t.set(G0(t,e),r),r}function G0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Et=new WeakMap,Ai=new WeakMap,pl=new WeakMap,Fs=new WeakMap,wl=new WeakMap,Vs=new WeakMap;class K0{constructor(e,r){var n=this;Hi(this,"settings",void 0),Hi(this,"tableProps",void 0),Hi(this,"inProgress",!1),Hi(this,"selectedRange",new YV((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Hi(this,"highlight",void 0),Oo(this,Et,void 0),Oo(this,Ai,void 0),Hi(this,"selectedByRowHeader",new Set),Hi(this,"selectedByColumnHeader",new Set),Oo(this,pl,!1),Oo(this,Fs,!1),Oo(this,wl,"unknown"),Oo(this,Vs,-1),this.settings=e,this.tableProps=r,this.highlight=new jV({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[ME()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),un(Et,this,new Tg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),un(Ai,this,new Tg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Fe(Et,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Fe(Et,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Fe(Et,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Fe(Et,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Fe(Et,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Fe(Et,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Fe(Et,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Fe(Et,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Fe(Ai,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Fe(Ai,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){un(wl,this,e)}markEndSource(){un(wl,this,"unknown")}getSelectionSource(){return Fe(wl,this)}setExpectedLayers(e){un(Vs,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,un(Vs,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Nt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();un(pl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&Nt(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!o||i===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(r),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Fe(Vs,this)===-1||this.selectedRange.size()===Fe(Vs,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(F(this.highlight.getAreas(),p=>void p.clear()),F(this.highlight.getLayeredAreas(),p=>void p.clear()),F(this.highlight.getRowHeaders(),p=>void p.clear()),F(this.highlight.getColumnHeaders(),p=>void p.clear()),F(this.highlight.getActiveRowHeaders(),p=>void p.clear()),F(this.highlight.getActiveColumnHeaders(),p=>void p.clear()),F(this.highlight.getActiveCornerHeaders(),p=>void p.clear()),F(this.highlight.getRowHighlights(),p=>void p.clear()),F(this.highlight.getColumnHighlights(),p=>void p.clear())),this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(jm,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const p=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(w_,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(v).commit(),d.add(b).commit(),g.add(v).commit()):(a.add(b).add(E).commit(),l.add(v).add(T).commit(),d.add(b).add(E).commit(),g.add(v).add(T).commit())}const p=!Fe(Fs,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!Fe(Fs,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&y&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(ua,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(un(pl,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Fe(Et,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Et,this).resetOffsetSize(),this.setRangeStart(Fe(Et,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?Fe(Et,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Et,this).resetOffsetSize(),this.setRangeEnd(Fe(Et,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?Fe(Ai,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Fe(Ai,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Fe(Ai,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(He(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(He(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(He(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,He(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,He(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,He(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Fe(pl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;un(Fs,this,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(He(d.row,u,o-1),He(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),un(Fs,this,!1)}selectCells(e){var r=this;const n=Uu(e);if(n===zu)return!1;if(n===ju)throw new Error(er`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=_p(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),F(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,p=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(g=He(n.row,u,s-1),p=He(n.col,Math.min(i,o),Math.max(i,o))):(g=He(n,u,s-1),p=i);const y=this.tableProps.createCellCoords(g,p),b=l===0?0:He(y.row,u,-1),E=s-1,v=this.tableProps.createCellCoords(b,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",v,T,y),v.row=b,T.row=E,this.setRangeStartOnly(v,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",v,T,y),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=He(n.row,Math.min(e,r),Math.max(e,r)),d=He(n.col,a,o-1)):(h=e,d=He(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),p=s===0?0:He(g.col,a,-1),y=o-1,b=this.tableProps.createCellCoords(e,p),E=this.tableProps.createCellCoords(r,y);this.runLocalHooks("beforeSelectRows",b,E,g),b.col=p,E.col=y,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",b,E,g),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=n;this.clear(),s.assign({row:He(s.row,-1/0,e-1),col:He(s.col,-1/0,r-1)}),i.assign({row:He(i.row,-1/0,e-1),col:He(i.col,-1/0,r-1)}),o.assign({row:He(o.row,0,e-1),col:He(o.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.isEnabledFor(ua,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(ua,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Ke(K0,Tn);const DS=/^(\r\n|\n\r|\r|\n)/,tW=/^[^\t\r\n]+/,NS=/^\t/;function rW(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(NS))t=t.replace(NS,""),r+=1,e[n][r]="";else if(t.match(DS))t=t.replace(DS,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(tW);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function ha(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Di(t,e,r){return(e=nW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nW(t){var e=iW(t,"string");return typeof e=="symbol"?e:e+""}function iW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bo{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Di(this,"hot",void 0),Di(this,"metaManager",void 0),Di(this,"tableMeta",void 0),Di(this,"dataSource",void 0),Di(this,"duckSchema",void 0),Di(this,"colToPropCache",void 0),Di(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=xm(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(bt(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return __(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Me(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&me(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(me(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ba(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=gr(this.getSchema()):(p=[],qe(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},$E(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,p=c;i==="end"&&(p=Math.min(p+1,a));const y=p;for(;g<r&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(p,0,null);g+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(y,r));const b=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",b,g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:y}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=me(this.tableMeta.columns)||me(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Fb(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return _A(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Fb(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&bn(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=hr(a);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=hr(o);this.hot.runHooks("modifyData",i,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&bn(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Bo.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Bo.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return ha(this.getRange(e,r,Bo.DESTINATION_RENDERER))}getCopyableText(e,r){return ha(this.getRange(e,r,Bo.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:oW,getItem:sW,hasItem:X0}=cs("cellTypes");function aW(t){if(!X0(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return sW(t)}function lW(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&ZE(t,r),n&&ON(t,n),i&&xN(t,i),oW(t,e)}function uW(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!bn(e,t)}function Yu(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?aW(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Me(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!bt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Me(n,(o,s)=>{if(uW(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),wi(t,i)}function cW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}cD(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function zl(t){return Number.isInteger(t)&&t>=0}function Ul(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function vl(t){return t==null}const Z0=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Xi(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Xi(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),jE(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function kS(t,e,r){return(e=hW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hW(t){var e=dW(t,"string");return typeof e=="symbol"?e:e+""}function dW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fW(){return class{}}class gW{constructor(e){kS(this,"metaCtor",fW()),kS(this,"meta",void 0),this.meta=this.metaCtor.prototype,wi(this.meta,Z0()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;wi(this.meta,e),Yu(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function mW(t,e,r){return(e=pW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pW(t){var e=wW(t,"string");return typeof e=="symbol"?e:e+""}function wW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vW{constructor(e){mW(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){wi(this.meta,e),Yu(this.meta,e,e)}}function yl(t,e,r){return(e=yW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yW(t){var e=bW(t,"string");return typeof e=="symbol"?e:e+""}function bW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fu{constructor(e){yl(this,"valueFactory",void 0),yl(this,"data",[]),yl(this,"index",[]),yl(this,"holes",new Set),this.valueFactory=e}obtain(e){Ul(()=>zl(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ul(()=>zl(e)||vl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=vl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ul(()=>zl(e)||vl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(vl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function LS(t,e,r){return(e=CW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CW(t){var e=SW(t,"string");return typeof e=="symbol"?e:e+""}function SW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RW=["data","width"];class TW{constructor(e){LS(this,"globalMeta",void 0),LS(this,"metas",new fu(()=>this._createMeta())),this.globalMeta=e,this.metas=new fu(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);wi(n,r),Yu(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return cW(this.globalMeta.getMetaConstructor(),RW).prototype}}function FS(t,e,r){return(e=EW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EW(t){var e=_W(t,"string");return typeof e=="symbol"?e:e+""}function _W(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OW{constructor(e){FS(this,"columnMeta",void 0),FS(this,"metas",new fu(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);wi(i,n),Yu(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)me(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Ul(()=>zl(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new fu(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class Q0{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new gW(e),this.tableMeta=new vW(this.globalMeta),this.columnMeta=new TW(this.globalMeta),this.cellMeta=new OW(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ke(Q0,Tn);function VS(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Nu(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Pe(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Bo(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let y,b=0,E=0;for(b=0,E=d.startRows;b<E;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)y=gr(p),t.push(y);else if(i.dataType==="array")y=gr(p[0]),t.push(y);else{y=[];for(let v=0,T=d.startCols;v<T;v++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Oe(i.rootElement,[_E(-1),ku(i.countCols()+(i.view?i.countRowHeaders():0))])}function WS(t,e,r){return(e=MW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MW(t){var e=IW(t,"string");return typeof e=="symbol"?e:e+""}function IW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PW{constructor(e){var r=this;WS(this,"metaManager",void 0),WS(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),ge.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=bn(e,"type")?e.type:null;let c=Pe(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function xW(t,e,r){HW(t,e),e.set(t,r)}function HW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Af(t,e,r){return(e=AW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AW(t){var e=DW(t,"string");return typeof e=="symbol"?e:e+""}function DW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NW(t,e){return t.get(kW(t,e))}function kW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var BS=new WeakMap;class LW{constructor(e){Af(this,"metaManager",void 0),Af(this,"usageTracker",new Set),Af(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),xW(this,BS,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,NW(BS,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const J0="gridDefault",eO="editorManager.handlingEditor",FW={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},VW="hooksRefRegisterer",tO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){F(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Me(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Kn(tO,"MIXIN_NAME",VW,{writable:!1,enumerable:!1});function jr(t,e,r){return(e=WW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WW(t){var e=BW(t,"string");return typeof e=="symbol"?e:e+""}function BW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $W="base",it=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Op{static get EDITOR_TYPE(){return $W}constructor(e){jr(this,"hot",void 0),jr(this,"state",it.VIRGIN),jr(this,"_opened",!1),jr(this,"_fullEditMode",!1),jr(this,"_closeCallback",null),jr(this,"TD",null),jr(this,"row",null),jr(this,"col",null),jr(this,"prop",null),jr(this,"originalValue",null),jr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:it.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==it.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=it.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Yo(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===it.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===it.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=it.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=it.FINISHED,this.discardEditor(s)}):(this.state=it.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=it.FINISHED,this.discardEditor()}discardEditor(e){this.state===it.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=it.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=it.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===it.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Pr(r),a=Jt(r),l=Pr(this.hot.rootElement),u=Jt(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:y}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=y.name,E=["master","inline_start"].includes(b)?d:0,v=["master","top","bottom"].includes(b)?g:0,T=s.top===l.top?0:1;let _=s.top-l.top-T-E,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-p-1+v:M=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(b)&&(_+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const I=this.hot.hasColHeaders(),H=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),V=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),j=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&H<=0||H===j)&&(_+=1),V<=0&&(M+=1);const z=i.rowsRenderCalculator.startPosition,te=i.columnsRenderCalculator.startPosition,ue=Math.abs(n.inlineStartOverlay.getScrollPosition()),G=n.topOverlay.getScrollPosition(),Q=rr(this.hot.rootDocument);let lt=r.offsetTop;if(["inline_start","master"].includes(b)&&(lt+=z-G),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:P,wtTable:A}=n.bottomOverlay.clone;lt+=P.getWorkspaceHeight()-A.getHeight()-Q}let ae=r.offsetLeft;this.hot.isRtl()?(ae>=0?ae=y.getWidth()-r.offsetLeft:ae=Math.abs(ae),ae+=te-ue-a):["top","master","bottom"].includes(b)&&(ae+=te-ue);const be=o.getComputedStyle(this.TD),Ge=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",vr=parseInt(be[Ge],10)>0?0:1,Ee=parseInt(be.borderTopWidth,10)>0?0:1,f=Jt(r)+vr,m=tr(r)+Ee,w=nD(c)?Q:0,C=iD(h)?Q:0,R=this.hot.view.maximumVisibleElementWidth(ae)-w+vr,O=Math.max(this.hot.view.maximumVisibleElementHeight(lt)-C+Ee,this.hot.view.getDefaultRowHeight());return{top:_,start:M,height:m,maxHeight:O,width:f,maxWidth:R}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Ke(Op,tO);const jW={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===it.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},zW={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},UW={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},YW={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},qW={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),Fu(e))}};function GW(){return[FW,jW,zW,UW,YW,qW]}const KW={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},XW={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},ZW={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},QW={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},JW={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},eB={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},tB={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},rB={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},nB={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},iB={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},oB={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},sB={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},aB={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},lB={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function uB(){return[KW,XW,ZW,QW,JW,eB,tB,rB,nB,iB,oB,sB,aB,lB]}const cB={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},hB={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},dB={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-o.row,-o.col):r.transformStart(-o.row,-o.col),r.markEndSource()}},fB={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(o.row,o.col):r.transformStart(o.row,o.col),r.markEndSource()}},gB={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},mB={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},pB={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},wB={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},vB={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},yB={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},bB={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},CB={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},SB={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},RB={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},TB={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},EB={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function _B(){return[cB,hB,dB,fB,gB,mB,pB,wB,vB,yB,bB,CB,SB,RB,TB,EB]}const OB={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},MB={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},IB={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},PB={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},xB={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},HB=[...GW(),...uB(),..._B(),OB,MB,IB,PB,xB];function rO(t){const e={};return HB.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function AB(t){const e=t.getShortcutManager().addContext("editor"),r=rO(t),n={group:eO};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function DB(t){const e=t.getShortcutManager().addContext("grid"),r=rO(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return me(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:J0};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:eO,runOnlyIf:()=>me(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function NB(t){[DB,AB].forEach(e=>e(t))}function kB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=$S(t),i=$S(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function $S(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Oe(r,[fg("Focus catcher")]),r}function LB(t){const e=FB(t);let r;const{activate:n,deactivate:i}=kB(t,{onFocusFromTop(){var h;const d=(h=e(r))!==null&&h!==void 0?h:Eg(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(r))!==null&&h!==void 0?h:_g(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,d,g,p,y)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,y.value=!0),s){var b;r=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:J0,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?Eg(t):_g(t)),u(),!1;h.preventDefault()},position:"after"}])}function Eg(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function _g(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function FB(t){return e=>{if(!e)return null;const r=Eg(t),n=_g(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function ds(t){Gi(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function qu(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,p=n.getBottomEndCorner().row,y=g<=h,b=p>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?n.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:y&&b?n.highlight.row:y?g:b?p:E.row}}}function VB(t){return e=>{const r=qu(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;ds(t.getCell(n?-1:0,r,!0))})}}function WB(){return()=>{}}function BB(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;ds(t.getCell(r,n,!0))})}}function $B(t){return e=>{const r=qu(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;ds(t.getCell(i,o,!0))})}}function jB(t){return e=>{const r=qu(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;ds(t.getCell(i,o,!0))})}}function zB(t){return e=>{const r=qu(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;ds(t.getCell(r,n?-1:0,!0))})}}function UB(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{ds(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function YB(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=BB(t):e.isSelectedByCorner()?s=WB():e.isSelectedByRowHeader()?s=zB(t):e.isSelectedByColumnHeader()?s=VB(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=$B(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=UB(t):e.getSelectedRange().size()>1&&(s=jB(t)),(o=s)===null||o===void 0||o(i)}}}const jS=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),bl=t=>t.map(e=>{const r=e.toLowerCase();return jS.has(r)?jS.get(r):r}).sort().join("+"),qB=t=>t.split("+"),zS=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Df=t=>{let{which:e,key:r}=t;if(zS.has(e))return zS.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},nO=Symbol("shortcut-context");function iO(t){return bt(t)&&t.__kindOf===nO}const GB=t=>{const e=Vu({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:y,position:b,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Nt(c))throw new Error("You need to define the shortcut's group.");if(Pe(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(er`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:p};me(y)&&(v.relativeToGroup=y,v.position=b),iO(E)&&(v.forwardToContext=E),l.forEach(T=>{const _=bl(T);if(e.hasItem(_)){const I=e.getItem(_);let H=I.findIndex(V=>V.group===y);H!==-1?b==="before"?H-=1:H+=1:H=I.length,I.splice(H,0,v)}else e.addItem(_,[v])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Me(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),r(c)})},i=l=>{const u=bl(l);e.removeItem(u)};return{__kindOf:nO,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=bl(l),c=e.getItem(u);return me(c)?c.slice():[]},hasShortcut:l=>{const u=bl(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(p=>p.group!==l);g.length===0?i(qB(h)):(d.length=0,d.push(...g))})}}};function KB(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const XB=["meta","alt","shift","control"],Ws=KB(),Bs=[];let Cl=0;function ZB(t,e,r,n,i){const o=g=>XB.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),p&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||Bi(g))return;const y=Df(g);let b=[];o(y)||(b=s(g));const E=[y].concat(b);!i(g,E)&&(eC()&&b.includes("meta")||!eC()&&b.includes("control"))&&i(g,[y].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const p=Df(g);o(p)&&Ws.press(p)}},u=g=>{if(typeof g.key=="string"){const p=Df(g);o(p)&&Ws.release(p)}},c=()=>{Ws.releaseAll()};return{mount:()=>{let g=t;for(Cl+=1;g;)Cl===1&&(g.document.documentElement.addEventListener("keydown",l),Bs.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),Bs.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=va(g)},unmount:()=>{let g=t;for(Cl-=1;g;){if(Cl===0){for(let p=0;p<Bs.length;p++){const{event:y,listener:b}=Bs[p];g.document.documentElement.removeEventListener(y,b)}Bs.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=va(g)}},isPressed:g=>Ws.isPressed(g),releasePressedKeys:()=>Ws.releaseAll()}}const QB=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=Vu({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const y=GB(p);return o.addItem(p,y),y},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(er`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,y){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=iO(b)?b:u(b);let v=!1;if(!E.hasShortcut(y))return v;const T=E.getShortcuts(y);for(let _=0;_<T.length;_++){const{callback:M,runOnlyIf:I,preventDefault:H,stopPropagation:V,captureCtrl:N,forwardToContext:j}=T[_];if(I(p)===!0){if(h=N,v=M(p,y)===!1,h=!1,H&&p.preventDefault(),V&&(Fu(p),p.stopPropagation()),v)break;j&&d(p,y,j)}}return v},g=ZB(e,r,n,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};function US(t){const{classNames:e}=KA(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Nf=null;const kf=new Map;function oO(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new vi(o);let a,l,u,c,h,d,g=!0;PF(i)&&IF(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=MV(e.language);const b=Object.fromEntries(Object.entries(e).filter(f=>{let[m]=f;return!(ge.getSingleton().isRegistered(m)||ge.getSingleton().isDeprecated(m))})),E=new Q0(o,b,[PW,LW]),v=E.getTableMeta(),T=E.getGlobalMeta(),_=Vu();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),jl(this)&&(PA(e.licenseKey,t),J(t,"ht-wrapper")),this.guid=`ht_${RE()}`,kf.set(this.guid,this),this.columnIndexMapper=new Sg,this.rowIndexMapper=new Sg,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterRowSequenceChange",f)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{o.runHooks("beforeCompositionStart",f)}),l=new jF(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const M=f=>{const{row:m,col:w}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},I=f=>{const{row:m,col:w}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},H=(f,m)=>{const w=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.rowIndexMapper.getNearestNotHiddenIndex(f,w);return O===null||w===1&&O>R||w===-1&&O<C?null:O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O},V=(f,m)=>{const w=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.columnIndexMapper.getNearestNotHiddenIndex(f,w);return O===null||w===1&&O>R||w===-1&&O<C?null:O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O};let N=new K0(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:f=>a.propToCol(f),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(f,m)=>o._createCellCoords(f,m),createCellRange:(f,m,w)=>o._createCellRange(f,m,w),visualToRenderableCoords:M,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:V,isDisabledCellSelection:(f,m)=>f<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(f,m).disableVisualSelection});this.selection=N;const j=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",j),this.rowIndexMapper.addLocalHook("cacheUpdated",j),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const w=hr(!1),C=this.selection.getSelectedRange(),{from:R,to:O}=C.current(),P=C.size()-1;this.runHooks("afterSelection",R.row,R.col,O.row,O.col,w,P),this.runHooks("afterSelectionByProp",R.row,o.colToProp(R.col),O.row,o.colToProp(O.col),w,P),m&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(f);const A=N.isSelectedByRowHeader(),Y=N.isSelectedByColumnHeader();A&&Y?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):A?(Ne(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):Y?(Ne(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]),N.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=hr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(f),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:w,to:C}=f[m];this.runHooks("afterSelectionEnd",w.row,w.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),C.row,o.colToProp(C.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),u={alter(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;const O=P=>{if(P.length===0)return[];const A=[...P];return A.sort((B,x)=>{let[oe]=B,[$]=x;return oe===$?0:oe>$?1:-1}),co(A,(B,x)=>{let[oe,$]=x;const ee=B[B.length-1],[Ce,Ie]=ee,de=Ce+Ie;if(oe<=de){const fe=Math.max($-(de-oe),0);ee[1]+=fe}else B.push([oe,$]);return B},[A[0]])};switch(f){case"insert_row_below":case"insert_row_above":const P=o.countSourceRows();if(v.maxRows===P)return;const A=f==="insert_row_below"?"below":"above";m=m??(A==="below"?P:0);const{delta:Y,startPhysicalIndex:B}=a.createRow(m,w,{source:C,mode:A});N.shiftRows(o.toVisualRow(B),Y);break;case"insert_col_start":case"insert_col_end":const x=f==="insert_col_end"?"end":"start";m=m??(x==="end"?o.countSourceCols():0);const{delta:oe,startPhysicalIndex:$}=a.createCol(m,w,{source:C,mode:x});if(oe){if(Array.isArray(v.colHeaders)){const Ie=[o.toVisualColumn($),0];Ie.length+=oe,Array.prototype.splice.apply(v.colHeaders,Ie)}N.shiftColumns(o.toVisualColumn($),oe)}break;case"remove_row":const ee=Ie=>{let de=0;F(Ie,fe=>{let[re,_e]=fe;const Ue=Xi(re)?o.countRows()-1:Math.max(re-de,0);if(Number.isInteger(re)&&(re=Math.max(re-de,0)),!a.removeRow(re,_e,C))return;if(N.isSelected()){const{row:br}=o.getSelectedRangeLast().highlight;br>=re&&br<=re+_e-1&&c.closeEditor(!0)}const yr=o.countRows(),Ct=v.fixedRowsTop;Ct>=Ue+1&&(v.fixedRowsTop-=Math.min(_e,Ct-Ue));const St=v.fixedRowsBottom;St&&Ue>=yr-St&&(v.fixedRowsBottom-=Math.min(_e,St)),yr===0?N.deselect():C==="ContextMenu.removeRow"?N.refresh():N.shiftRows(re,-_e),de+=_e})};Array.isArray(m)?ee(O(m)):ee([[m,w]]);break;case"remove_col":const Ce=Ie=>{let de=0;F(Ie,fe=>{let[re,_e]=fe;const Ue=Xi(re)?o.countCols()-1:Math.max(re-de,0);let dt=o.toPhysicalColumn(Ue);if(Number.isInteger(re)&&(re=Math.max(re-de,0)),!a.removeCol(re,_e,C))return;if(N.isSelected()){const{col:br}=o.getSelectedRangeLast().highlight;br>=re&&br<=re+_e-1&&c.closeEditor(!0)}o.countCols()===0?N.deselect():C==="ContextMenu.removeColumn"?N.refresh():N.shiftColumns(re,-_e);const St=v.fixedColumnsStart;St>=Ue+1&&(v.fixedColumnsStart-=Math.min(_e,St-Ue)),Array.isArray(v.colHeaders)&&(typeof dt>"u"&&(dt=-1),v.colHeaders.splice(dt,_e)),de+=_e})};Array.isArray(m)?Ce(O(m)):Ce([[m,w]]);break;default:throw new Error(`There is no such action "${f}"`)}R||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const f=v.minRows,m=v.minSpareRows,w=v.minCols,C=v.minSpareCols;if(f){const R=o.countRows();R<f&&a.createRow(R,f-R,{source:"auto"})}if(m){const R=o.countEmptyRows(!0);if(R<m){const O=m-R,P=Math.min(O,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),P,{source:"auto"})}}{let R;(w||C)&&(R=o.countEmptyCols(!0));let O=o.countCols();if(w&&!v.columns&&O<w){const P=w-O;R+=P,a.createCol(O,P,{source:"auto"})}if(C&&!v.columns&&o.dataType==="array"&&R<C){O=o.countCols();const P=C-R,A=Math.min(P,v.maxCols-O);a.createCol(O,A,{source:"auto"})}}},populateFromArray(f,m,w,C,R){let O,P,A,Y;const B=[],x={},oe=[],$=f.row,ee=f.col;if(P=m.length,P===0)return!1;let Ce=0,Ie=0;switch(bt(w)&&(Ce=w.col-ee+1,Ie=w.row-$+1),R){case"shift_down":const de=Yd(m),fe=de.length,re=Math.max(fe,Ce),_e=o.getData().slice($),Ue=Yd(_e).slice(ee,ee+re);for(A=0;A<re;A+=1)if(A<fe){for(O=0,P=de[A].length;O<Ie-P;O+=1)de[A].push(de[A][O%P]);A<Ue.length?oe.push(de[A].concat(Ue[A])):oe.push(de[A].concat(new Array(_e.length).fill(null)))}else oe.push(de[A%fe].concat(Ue[A]));o.populateFromArray($,ee,Yd(oe));break;case"shift_right":const dt=m.length,yr=Math.max(dt,Ie),Ct=o.getData().slice($).map(Ft=>Ft.slice(ee));for(O=0;O<yr;O+=1)if(O<dt){for(A=0,Y=m[O].length;A<Ce-Y;A+=1)m[O].push(m[O][A%Y]);if(O<Ct.length)for(let Ft=0;Ft<Ct[O].length;Ft+=1)m[O].push(Ct[O][Ft]);else m[O].push(...new Array(Ct[0].length).fill(null))}else m.push(m[O%P].slice(0,yr).concat(Ct[O]));o.populateFromArray($,ee,m);break;case"overwrite":default:x.row=f.row,x.col=f.col;let St=0,br=0,Zn=!0,Qn;const fo=function(Vt){let ir=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const En=m[Vt%m.length];return ir!==null?En[ir%En.length]:En},fs=m.length,Jn=w?w.row-f.row+1:0;for(w?P=Jn:P=Math.max(fs,Jn),O=0;O<P&&!(w&&x.row>w.row&&Jn>fs||!v.allowInsertRow&&x.row>o.countRows()-1||x.row>=v.maxRows);O++){const Ft=O-St,Vt=fo(Ft).length,ir=w?w.col-f.col+1:0;if(w?Y=ir:Y=Math.max(Vt,ir),x.col=f.col,Qn=o.getCellMeta(x.row,x.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Qn.skipRowOnPaste){St+=1,x.row+=1,P+=1;continue}for(br=0,A=0;A<Y&&!(w&&x.col>w.col&&ir>Vt||!v.allowInsertColumn&&x.col>o.countCols()-1||x.col>=v.maxCols);A++){if(Qn=o.getCellMeta(x.row,x.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Qn.skipColumnOnPaste){br+=1,x.col+=1,Y+=1;continue}if(Qn.readOnly&&C!=="UndoRedo.undo"){x.col+=1;continue}const En=A-br;let Wt=fo(Ft,En),Cr=o.getDataAtCell(x.row,x.col);if(Wt!==null&&typeof Wt=="object")if(Array.isArray(Wt)&&Cr===null&&(Cr=[]),Cr===null||typeof Cr!="object")Zn=!1;else{const Ri=ba(Array.isArray(Cr)?Cr:Cr[0]||Cr),Ti=ba(Array.isArray(Wt)?Wt:Wt[0]||Wt);jE(Ri,Ti)||Array.isArray(Ri)&&Array.isArray(Ti)?Wt=gr(Wt):Zn=!1}else Cr!==null&&typeof Cr=="object"&&(Zn=!1);Zn&&B.push([x.row,x.col,Wt]),Zn=!0,x.col+=1}x.row+=1}o.setDataAtCell(B,null,null,C||"populateFromArray");break}}};function z(f){const m=L_(f);Tp(m)?(o.runHooks("beforeLanguageChange",m),T.language=m,o.runHooks("afterLanguageChange",m)):F_(f)}function te(f,m){const w=f==="className"?o.rootElement:o.table;if(g)J(w,m);else{let C=[],R=[];T[f]&&(C=Array.isArray(T[f])?T[f]:Wb(T[f])),m&&(R=Array.isArray(m)?m:Wb(m));const O=Vb(C,R),P=Vb(R,C);O.length&&Ne(w,O),P.length&&J(w,P)}T[f]=m}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(Ui()||YE())&&J(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new DF(this);const f=v.themeName||US(o.rootElement);o.useTheme(f),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=wg.getInstance(o,v,N),d=YB(o),h=new ZD(o),jl(this)&&LB(o),o.runHooks("init"),this.render(),g&&o.rootElement.offsetParent===null&&oD(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function ue(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function G(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function Q(f,m,w){if(!f.length){w();return}const C=o.getActiveEditor(),R=new ue;let O=!0;R.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),w()};for(let P=f.length-1;P>=0;P--){const[A,Y]=f[P],B=a.propToCol(Y);let x;Number.isInteger(B)?x=o.getCellMeta(A,B):x={...Object.getPrototypeOf(v),...v},o.getCellValidator(x)&&(R.addValidatorToQueue(),o.validateCell(f[P][3],x,function(oe,$){return function(ee){if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&$.allowInvalid===!1&&(O=!1,f.splice(oe,1),$.valid=!0),R.removeValidatorFormQueue()}}(P,x),m))}R.checkIfQueueIsEmpty()}function lt(f,m){for(let C=f.length-1;C>=0;C--){let R=!1;if(f[C]===null){f.splice(C,1);continue}if(!((f[C][2]===null||f[C][2]===void 0)&&(f[C][3]===null||f[C][3]===void 0))){if(v.allowInsertRow)for(;f[C][0]>o.countRows()-1;){const{delta:O}=a.createRow(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(f[C][1])>o.countCols()-1;){const{delta:O}=a.createCol(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}R||a.set(f[C][0],f[C][1],f[C][3])}}if(f.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",f,m),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",f,m||"edit");const C=o.getActiveEditor();C&&me(C.refreshValue)&&C.refreshValue()}else o.render()}this._createCellCoords=function(f,m){return o.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,w){return o.view._wt.createCellRange(f,m,w)},this.validateCell=function(f,m,w,C){let R=o.getCellValidator(m);function O(P){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(P);return}const Y=m.visualCol,B=m.visualRow,x=o.getCell(B,Y,!0);if(x&&x.nodeName!=="TH"){const oe=o.rowIndexMapper.getRenderableFromVisualIndex(B),$=o.columnIndexMapper.getRenderableFromVisualIndex(Y);o.view._wt.getSetting("cellRenderer",oe,$,x)}w(P)}OA(R)&&(R=function(P){return function(A,Y){Y(P.test(A))}}(R)),Pe(R)?(f=o.runHooks("beforeValidate",f,m.visualRow,m.prop,C),o._registerImmediate(()=>{R.call(m,f,P=>{o&&(P=o.runHooks("afterValidate",P,f,m.visualRow,m.prop,C),m.valid=P,O(P),o.runHooks("postAfterValidate",P,f,m.visualRow,m.prop,C))})})):o._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function ae(f,m,w){return Array.isArray(f)?f:[[f,m,w]]}function be(f,m){const w=o.runHooks("beforeChange",f,m||"edit"),C=f.filter(O=>O!==null);if(w===!1||C.length===0){var R;return(R=o.getActiveEditor())===null||R===void 0||R.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[P,A,,Y]=C[O],B=a.propToCol(A);let x;Number.isInteger(B)?x=o.getCellMeta(P,B):x={...Object.getPrototypeOf(v),...v};const{type:oe,checkedTemplate:$,uncheckedTemplate:ee}=x;if(oe==="numeric"&&typeof Y=="string"&&hN(Y)&&(C[O][3]=G(Y)),oe==="checkbox"){const Ce=Yo(Y),Ie=Ce===Yo($),de=Ce===Yo(ee);(Ie||de)&&(C[O][3]=Ie?$:ee)}}return C}this.setDataAtCell=function(f,m,w,C){const R=ae(f,m,w),O=[];let P=C,A,Y,B;for(A=0,Y=R.length;A<Y;A++){if(typeof R[A]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[A][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[A][1]>=this.countCols()?B=R[A][1]:B=a.colToProp(R[A][1]),O.push([R[A][0],B,l.getAtCell(this.toPhysicalRow(R[A][0]),R[A][1]),R[A][2]])}!P&&typeof f=="object"&&(P=m);const x=be(O,P);o.runHooks("afterSetDataAtCell",x,P),Q(x,P,()=>{lt(x,P)})},this.setDataAtRowProp=function(f,m,w,C){const R=ae(f,m,w),O=[];let P=C,A,Y;for(A=0,Y=R.length;A<Y;A++)O.push([R[A][0],R[A][1],l.getAtCell(this.toPhysicalRow(R[A][0]),R[A][1]),R[A][2]]);!P&&typeof f=="object"&&(P=m);const B=be(O,C);o.runHooks("afterSetDataAtRowProp",B,P),Q(B,P,()=>{lt(B,P)})},this.listen=function(){o&&!o.isListening()&&(kf.forEach(f=>{o!==f&&f.unlisten()}),Nf=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Nf=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Nf===o.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(f),o.view.render(),m&&N.isSelected()&&c.prepareEditor()},this.populateFromArray=function(f,m,w,C,R,O,P){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const A=typeof C=="number"?o._createCellCoords(C,R):null;return u.populateFromArray(o._createCellCoords(f,m),w,A,O,P)},this.spliceCol=function(f,m,w){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceCol(f,m,w,...R)},this.spliceRow=function(f,m,w){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceRow(f,m,w,...R)},this.getSelected=function(){if(N.isSelected())return yn(N.getSelectedRange(),f=>{let{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(N.isSelected())return Array.from(N.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!N.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];F(N.getSelectedRange(),w=>{if(w.isSingleHeader())return;const C=w.getTopStartCorner(),R=w.getBottomEndCorner();qe(C.row,R.row,O=>{qe(C.col,R.col,P=>{this.getCellMeta(O,P).readOnly||m.push([O,P,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=f();return this.resumeExecution(m),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const f=o.view,{width:m,height:w}=f.getLastSize(),{width:C,height:R}=o.rootElement.getBoundingClientRect(),O=C!==m||R!==w;o.runHooks("beforeRefreshDimensions",{width:m,height:w},{width:C,height:R},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===o.rootWindow)&&(f.setLastSize(C,R),o.render(),f.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:m,height:w},{width:C,height:R},O))},this.updateData=function(f,m){VS(f,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),N.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:E,firstRun:g})},this.loadData=function(f,m){VS(f,w=>{a=w},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),N.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:E,firstRun:g})},this.getInitialColumnCount=function(){const f=v.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Pe(f))if(o.dataType==="array"){const w=this.countSourceCols();for(let C=0;C<w;C+=1)f(C)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(me(v.dataSchema)){const w=a.getSchema();m=Array.isArray(w)?w.length:xm(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,w,C){return Nt(f)?a.getAll():a.getRange(o._createCellCoords(f,m),o._createCellCoords(w,C),a.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,w,C){return a.getCopyableText(o._createCellCoords(f,m),o._createCellCoords(w,C))},this.getCopyableData=function(f,m){return a.getCopyable(f,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?o.loadData:o.updateData).bind(this);let C=!1,R,O;if(me(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(me(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(me(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');f.language&&z(f.language);for(R in f)if(!(R==="data"||R==="language"))if(R==="className")te("className",f.className);else if(R==="tableClassName"&&o.table)te("tableClassName",f.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ge.getSingleton().isRegistered(R)||ge.getSingleton().isDeprecated(R)){const x=f[R];Pe(x)?(ge.getSingleton().addAsFixed(R,x,o),v[R]=x):Array.isArray(x)&&(ge.getSingleton().add(R,x,o),v[R]=x)}else!m&&bn(f,R)&&(T[R]=f[R]);f.data===void 0&&v.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(a.createMap(),o.initIndexMappers());const P=o.countCols(),A=v.columns;if(A&&Pe(A)&&(C=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&E.clearCache(),P>0)for(R=0,O=0;R<P;R++){if(A){const x=C?A(R):A[O];x&&E.updateColumnMeta(O,x)}O+=1}me(f.cell)&&Me(f.cell,x=>{o.setCellMetaObject(x.row,x.col,x)}),o.runHooks("afterCellMetaReset");let Y=o.rootElement.style.height;Y!==""&&(Y=parseInt(o.rootElement.style.height,10));let B=f.height;if(Pe(B)&&(B=B()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),B===null){const x=o.rootElement.getAttribute("data-initialstyle");x&&(x.indexOf("height")>-1||x.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",x):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else B!==void 0&&(o.rootElement.style.height=isNaN(B)?`${B}`:`${B}px`,o.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let x=f.width;Pe(x)&&(x=x()),o.rootElement.style.width=isNaN(x)?`${x}`:`${x}px`}if(!m){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const x=o.getCurrentThemeName(),oe=bn(f,"themeName");x&&oe&&x!==f.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(x));const $=oe&&f.themeName||US(o.rootElement);o.useTheme($),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",f)}u.adjustRowsAndCols(),o.view&&!g&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(Y===""||B===""||B===void 0)&&Y!==B&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=o.getSelectedLast();if(v.getValue){if(Pe(v.getValue))return v.getValue.call(o);if(f)return o.getData()[f[0][0]][v.getValue]}else if(f)return o.getDataAtCell(f[0],f[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,w,C,R){u.alter(f,m,w,C,R)},this.getCell=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,R=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return R===null||C===null||R===void 0||C===void 0?null:o.view.getCellAtCoords(o._createCellCoords(R,C),w)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:w,col:C}=m;let R=w,O=C;return w>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(w)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),o._createCellCoords(R,O)},this.colToProp=function(f){return a.colToProp(f)},this.propToCol=function(f){return a.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return a.get(f,a.colToProp(m))},this.getDataAtRowProp=function(f,m){return a.get(f,m)},this.getDataAtCol=function(f){const m=[],w=a.getRange(o._createCellCoords(0,f),o._createCellCoords(v.data.length-1,f),a.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let R=0;R<w[C].length;R+=1)m.push(w[C][R]);return m},this.getDataAtProp=function(f){const m=[],w=a.getRange(o._createCellCoords(0,a.propToCol(f)),o._createCellCoords(v.data.length-1,a.propToCol(f)),a.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let R=0;R<w[C].length;R+=1)m.push(w[C][R]);return m},this.getSourceData=function(f,m,w,C){let R;return f===void 0?R=l.getData():R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(w,C)),R},this.getSourceDataArray=function(f,m,w,C){let R;return f===void 0?R=l.getData(!0):R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(w,C),!0),R},this.getSourceDataAtCol=function(f){return l.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,w,C){const R=ae(f,m,w),O=this.hasHook("afterSetSourceDataAtCell"),P=[];O&&F(R,Y=>{let[B,x,oe]=Y;P.push([B,x,l.getAtCell(B,x),oe])}),F(R,Y=>{let[B,x,oe]=Y;l.setAtCell(B,x,oe)}),O&&this.runHooks("afterSetSourceDataAtCell",P,C),this.render();const A=o.getActiveEditor();A&&me(A.refreshValue)&&A.refreshValue()},this.getSourceDataAtRow=function(f){return l.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return l.getAtCell(f,m)},this.getDataAtRow=function(f){return a.getRange(o._createCellCoords(f,0),o._createCellCoords(f,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,w,C){const R=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,w,C],[O,P]=R;let[,,A,Y]=R,B=null,x=null;A===void 0&&(A=O),Y===void 0&&(Y=P);let oe="mixed";return qe(Math.max(Math.min(O,A),0),Math.max(O,A),$=>{let ee=!0;return qe(Math.max(Math.min(P,Y),0),Math.max(P,Y),Ce=>(x=this.getCellMeta($,Ce).type,B?ee=B===x:B=x,ee)),oe=ee?x:"mixed",ee}),oe},this.removeCellMeta=function(f,m,w){const[C,R]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=E.getCellMetaKeyValue(C,R,w);o.runHooks("beforeRemoveCellMeta",f,m,w,O)!==!1&&(E.removeCellMeta(C,R,w),o.runHooks("afterRemoveCellMeta",f,m,w,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,C=new Array(w>2?w-2:0),R=2;R<w;R++)C[R-2]=arguments[R];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(f),m),C.length>0&&F(C.reverse(),O=>{E.createRow(this.toPhysicalRow(f)),F(O,(P,A)=>this.setCellMetaObject(f,A,P))}),o.render()},this.setCellMetaObject=function(f,m,w){typeof w=="object"&&Me(w,(C,R)=>{this.setCellMeta(f,m,R,C)})},this.setCellMeta=function(f,m,w,C){if(o.runHooks("beforeSetCellMeta",f,m,w,C)===!1)return;let O=f,P=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(P=this.toPhysicalColumn(m)),E.setCellMeta(O,P,w,C),o.runHooks("afterSetCellMeta",f,m,w,C)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(f),R=this.toPhysicalColumn(m);return C===null&&(C=f),R===null&&(R=m),E.getCellMeta(C,R,{visualRow:f,visualColumn:m,...w})},this.getColumnMeta=function(f){return E.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return E.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(f,m){const w=typeof f=="number"?o.getCellMeta(f,m).renderer:f.renderer;return typeof w=="string"?HC(w):Nt(w)?HC("text"):w},this.getCellEditor=function(f,m){const w=typeof f=="number"?o.getCellMeta(f,m).editor:f.editor;return typeof w=="string"?fC(w):Nt(w)?fC("text"):w},this.getCellValidator=function(f,m){const w=typeof f=="number"?o.getCellMeta(f,m).validator:f.validator;return typeof w=="string"?PN(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,w){const C=new ue;f&&(C.onQueueEmpty=f);let R=o.countRows()-1;for(;R>=0;){if(m!==void 0&&m.indexOf(R)===-1){R-=1;continue}let O=o.countCols()-1;for(;O>=0;){if(w!==void 0&&w.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),o.validateCell(o.getDataAtCell(R,O),o.getCellMeta(R,O),P=>{if(typeof P!="boolean")throw new Error("Validation error: result is not boolean");P===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}R-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=v.rowHeaders,w=f;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(m=[],qe(o.countRows()-1,C=>{m.push(o.getRowHeader(C))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Pe(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let f=0,m=o.countCols();f<m;f++)if(o.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",f);if(w===void 0){const A=[],Y=o.countCols();for(let B=0;B<Y;B++)A.push(o.getColHeader(B));return A}let C=v.colHeaders;const R=function(A){const Y=[],B=o.countCols();let x=0;for(;x<B;x++)Pe(v.columns)&&v.columns(x)&&Y.push(x);return Y[A]},O=o.toPhysicalColumn(w),P=R(O);return v.colHeaders===!1?C=null:v.columns&&Pe(v.columns)&&v.columns(P)&&v.columns(P).title?C=v.columns(P).title:v.columns&&v.columns[O]&&v.columns[O].title?C=v.columns[O].title:Array.isArray(v.colHeaders)&&v.colHeaders[O]!==void 0?C=v.colHeaders[O]:Pe(v.colHeaders)?C=v.colHeaders(O):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(C=WF(w)),C=o.runHooks("modifyColumnHeaderValue",C,f,m),C},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=o.getCellMeta(0,f).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let w=o._getColWidthFromSettings(f);return w=o.runHooks("modifyColWidth",w,f,m),w===void 0&&(w=km),w},this._getRowHeightFromSettings=function(f){const m=this.view.getDefaultRowHeight();let w=v.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[f];break;case"function":w=w(f);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<m?m:w},this.getRowHeight=function(f,m){let w=o._getRowHeightFromSettings(f);return w=o.runHooks("modifyRowHeight",w,f,m),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const f=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return PC(o.countRows()-1,w=>{if(o.isEmptyRow(w))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return PC(o.countCols()-1,w=>{if(o.isEmptyCol(w))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return v.isEmptyRow.call(o,f)},this.isEmptyCol=function(f){return v.isEmptyCol.call(o,f)},this.selectCell=function(f,m,w,C){let R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Nt(f)||Nt(m)?!1:this.selectCells([[f,m,w,C]],R,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const C=N.selectCells(f);return C&&w&&o.listen(),d.resume(),C},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return N.selectColumns(f,m,w)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return N.selectRows(f,m,w)},this.deselectCell=function(){N.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),N.selectAll(f,m,w)};const Ge=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:C,col:R,considerHiddenIndexes:O}=f??{};let P=C,A=R;if(Pe(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const oe=Number.isInteger(C)&&C>=0,$=Number.isInteger(R)&&R>=0,ee=oe?Ge(this.rowIndexMapper,C):void 0,Ce=$?Ge(this.columnIndexMapper,R):void 0;if(ee===null||Ce===null)return!1;P=oe?o.rowIndexMapper.getRenderableFromVisualIndex(ee):C,A=$?o.columnIndexMapper.getRenderableFromVisualIndex(Ce):R}const Y=Number.isInteger(P),B=Number.isInteger(A);let x=!1;return Y&&P>=0&&B&&A>=0?x=o.view.scrollViewport(o._createCellCoords(P,A),f.horizontalSnap,f.verticalSnap):Y&&P>=0&&(B&&A<0||!B)?x=o.view.scrollViewportVertically(P,f.verticalSnap):B&&A>=0&&(Y&&P<0||!Y)&&(x=o.view.scrollViewportHorizontally(A,f.horizontalSnap)),Pe(m)&&(x?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),x},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Pe(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast(),w=this.scrollViewportTo(m.toObject());return w?this.view.render():Pe(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),w},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),kf.delete(this.guid),jl(o)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}Xo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(f=>{let[,m]=f;m.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(o),Me(o,(f,m,w)=>{Pe(f)?w[m]=vr(m):m!=="guid"&&(w[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,N=null,c=null,o=null};function vr(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return _.getItem(Nu(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(f)},this.getInstance=function(){return o},this.addHook=function(f,m,w){ge.getSingleton().add(f,m,o,w)},this.hasHook=function(f){return ge.getSingleton().has(f,o)||ge.getSingleton().has(f)},this.addHookOnce=function(f,m,w){ge.getSingleton().once(f,m,o,w)},this.removeHook=function(f,m){ge.getSingleton().remove(f,m,o)},this.runHooks=function(f,m,w,C,R,O,P){return ge.getSingleton().run(o,f,m,w,C,R,O,P)},this.getTranslatedPhrase=function(f,m){return z0(v.language,f,m)},this.toHTML=()=>MC(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",MC(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{this.view.getStylesHandler().useTheme(f),this.runHooks("afterSetTheme",f,!!g)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){F(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){F(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return c};const Ee=QB({handleEvent(){return o.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&Ee.releasePressedKeys()}),this.getShortcutManager=function(){return Ee},this.getFocusManager=function(){return h},n_().forEach(f=>{const m=Nm(f);_.addItem(f,new m(this))}),NB(o),Ee.setActiveContextName("grid"),ge.getSingleton().run(o,"construct")}function YS(t,e,r){t.addEventListener(e,r,!1)}function qS(t,e,r){t.removeEventListener(e,r,!1)}function Sl(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function JB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=Sl(s).fontSize,o.style.fontFamily=Sl(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=Sl(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((d=Sl(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),y=o.clientWidth+g+p+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>y?b.width=`${r.minWidth}px`:y>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${y}px`;const E=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>E?b.height=`${r.minHeight}px`:r.maxHeight<E?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(YS(s,"input",a),YS(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){qS(s,"input",a),qS(s,"keydown",l)}}}function GS(t,e){const r=tD(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}LE(e,i)}function Ni(t,e,r){return(e=e$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e$(t){var e=t$(t,"string");return typeof e=="symbol"?e:e+""}function t$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const r$="ht_editor_visible",Rl="ht_editor_hidden",KS="textEditor",n$="text";class i$ extends Op{static get EDITOR_TYPE(){return n$}constructor(e){super(e),Ni(this,"eventManager",new vi(this)),Ni(this,"autoResize",JB(this.hot.rootDocument)),Ni(this,"TEXTAREA",void 0),Ni(this,"textareaStyle",void 0),Ni(this,"TEXTAREA_PARENT",void 0),Ni(this,"textareaParentStyle",void 0),Ni(this,"layerClass",void 0),this.eventManager=new vi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Bl(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==it.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===it.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),LE(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Oe(this.TEXTAREA,[["data-hot-input",""],ho(-1)]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&Ne(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Rl),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){yD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ne(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Rl)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;qe(e.length-1,n=>{const i=e[n];if(we(i,"handsontableEditor"))return r=!0,!1}),we(this.TEXTAREA_PARENT,Rl)&&Ne(this.TEXTAREA_PARENT,Rl),r?(this.layerClass=r$,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==it.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){UE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===it.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===it.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>me(this.hot.getSelected()),group:KS},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;GS(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;GS(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(KS)}}const o$="base";function sO(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&J(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Ub())):a&&c.push(Ub()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(Yb())):(u.push(s.invalidCellClassName),a&&c.push(Yb()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Ne(e,u),J(e,l),Na(e,c),Oe(e,h)}sO.RENDERER_TYPE=o$;const s$="text";function aO(t,e,r,n,i,o,s){sO.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Yo(a),s.trimWhitespace&&(a=a.trim()),ka(e,a)}aO.RENDERER_TYPE=s$;const a$="text",l$={CELL_TYPE:a$,editor:i$,renderer:aO};lW(l$);rn.editors={BaseEditor:Op};function rn(t,e){const r=new oO(t,e||{},Qm);return r.init(),r}rn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new oO(t,e,Qm)};rn.DefaultSettings=Z0();rn.hooks=ge.getSingleton();rn.CellCoords=Zi;rn.CellRange=Fa;rn.packageName="handsontable";rn.buildDate="24/04/2025 10:59:00";rn.version="15.3.0";rn.languages={dictionaryKeys:CV,getLanguageDictionary:j0,getLanguagesDictionaries:_V,registerLanguageDictionary:$0,getTranslatedPhrase:z0};function u$(t,e){lO(t,e),e.add(t)}function c$(t,e,r){lO(t,e),e.set(t,r)}function lO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mo(t,e,r){return(e=h$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h$(t){var e=d$(t,"string");return typeof e=="symbol"?e:e+""}function d$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Io(t,e){return t.get(uO(t,e))}function uO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const XS=new Map([["plugin",SN],["cell-type",X0],["editor",XE],["renderer",i_],["validator",o_]]),f$=Symbol("mainSetting"),g$="base",Tl=[];let ki=null;var Li=new WeakMap,ZS=new WeakSet;class Gu{static get PLUGIN_KEY(){return g$}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){u$(this,ZS),Mo(this,"eventManager",new vi(this)),Mo(this,"pluginName",null),Mo(this,"pluginsInitializedCallbacks",[]),Mo(this,"isPluginsReady",!1),Mo(this,"enabled",!1),Mo(this,"initialized",!1),c$(this,Li,{}),Kn(this,"hot",e,{writable:!1}),ki=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!XS.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);XS.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Tl.push(o)}}if(ki||(ki=n_()),ki.indexOf(this.pluginName)>=0&&ki.splice(ki.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ki.length===0){if(Tl.length>0){const i=[`${Tl.join(`
`)}
`,"You have to import and register them manually."].join("");throw Tl.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||bt(r))&&n[f$]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(bt(r)){var o;return(o=r[e])!==null&&o!==void 0?o:n[e]}return n[e]}addHook(e,r,n){Io(Li,this)[e]=Io(Li,this)[e]||[];const i=Io(Li,this)[e];this.hot.addHook(e,r,n),i.push(r),Io(Li,this)[e]=i}removeHooks(e){F(Io(Li,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Io(Li,this);Me(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){F(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=uO(ZS,this,m$).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Me(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function m$(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Fi(t,e,r){return(e=p$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p$(t){var e=w$(t,"string");return typeof e=="symbol"?e:e+""}function w$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v${constructor(e){Fi(this,"hot",null),Fi(this,"container",null),Fi(this,"injected",!1),Fi(this,"rows",[]),Fi(this,"columns",[]),Fi(this,"samples",null),Fi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&J(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),F(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),F(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{F(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{F(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{F(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),F(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{F(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),J(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return J(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function El(t,e,r){return(e=y$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y$(t){var e=b$(t,"string");return typeof e=="symbol"?e:e+""}function b$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mp{static get SAMPLE_COUNT(){return 3}constructor(e){El(this,"samples",null),El(this,"dataFactory",null),El(this,"customSampleCount",null),El(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Mp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return qe(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return qe(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:bt(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Yo(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function C$(t,e){cO(t,e),e.add(t)}function Lf(t,e,r){cO(t,e),e.set(t,r)}function cO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(t,e,r){return(e=S$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S$(t){var e=R$(t,"string");return typeof e=="symbol"?e:e+""}function R$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fi(t,e){return t.get(Xt(t,e))}function gu(t,e,r){return t.set(Xt(t,e),r),r}function Xt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("modifyAutoColumnSizeSeed");const Ff="autoColumnSize",T$=10,E$="autoColumnSize";var Ip=new WeakMap,Vo=new WeakMap,Zo=new WeakMap,ur=new WeakSet;class da extends Gu{static get PLUGIN_KEY(){return Ff}static get PLUGIN_PRIORITY(){return T$}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),C$(this,ur),$s(this,"ghostTable",new v$(this.hot)),$s(this,"samplesGenerator",new Mp((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),$s(this,"inProgress",!1),$s(this,"measuredColumns",0),$s(this,"columnWidthsMap",new $u),Lf(this,Ip,!1),Lf(this,Vo,[]),Lf(this,Zo,[]),this.hot.columnIndexMapper.registerMap(E$,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>Xt(ur,this,QS).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[Ff]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xt(ur,e,M$).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xt(ur,e,I$).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xt(ur,e,x$).call(e,...i)}),this.addHook("beforeRender",()=>Xt(ur,this,O$).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>Xt(ur,this,P$).call(this)),super.enablePlugin()}updatePlugin(){gu(Zo,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>Xt(ur,this,QS).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;qe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Xt(ur,this,hO).call(this,s,o)}),this.ghostTable.columns.length&&(Xt(ur,this,dO).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Qb(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+da.CALCULATION_STEP,i)},e,r),n=n+da.CALCULATION_STEP+1,n<i?o=mg(s):(Qb(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ff];let r=da.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return bt(e)&&(r=e.syncLimit,HA(r)?r=dN(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,km))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=fi(Vo,this).length;return(s-1<o||fi(Vo,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?fi(Vo,this).push(i):fi(Vo,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _$(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||Xt(ur,this,hO).call(this,r,e))}),this.ghostTable.columns.length&&(Xt(ur,this,dO).call(this),this.ghostTable.clean())}function hO(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function dO(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function O$(){this.calculateVisibleColumnsWidth(),this.inProgress||(Xt(ur,this,_$).call(this,fi(Zo,this)),gu(Zo,this,[]))}function M$(t,e){e||this.recalculateAllColumnsWidth()}function I$(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);fi(Zo,this).push(...e)}function QS(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function P$(){gu(Vo,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),gu(Ip,this,!0)}function x$(t){if(!fi(Ip,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);fi(Zo,this).push(...e)}function H$(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function A$(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Vi(t,e){const r={};return F(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function ai(t,e,r,n,i){F(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&D$(s,a,e,r,n,i)})})}function D$(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=H$(s.className,n):a=A$(s.className,n)),o(t,e,"className",a)}function N$(t){return`<span class="selected">â</span>${t}`}function Vf(t,e){let r=!1;return Array.isArray(t)&&F(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function fO(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const yt="---------";function k$(){return{name:yt}}const qr="alignment";function L$(){return{key:qr,name(){return this.getTranslatedPhrase(mp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${qr}:left`,name(){return this.getTranslatedPhrase(pp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:center`,name(){return this.getTranslatedPhrase(wp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:right`,name(){return this.getTranslatedPhrase(vp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:justify`,name(){return this.getTranslatedPhrase(yp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:yt},{key:`${qr}:top`,name(){return this.getTranslatedPhrase(bp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:middle`,name(){return this.getTranslatedPhrase(Cp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:bottom`,name(){return this.getTranslatedPhrase(Sp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Pp="clear_column";function F$(){return{key:Pp,name(){return this.getTranslatedPhrase(up)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const Ku="col_left";function V$(){return{key:Ku,name(){return this.getTranslatedPhrase(np)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Xu="col_right";function W$(){return{key:Xu,name(){return this.getTranslatedPhrase(ip)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Zu="make_read_only";function B$(){return{key:Zu,checkable:!0,ariaChecked(){return Vf(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(du)},name(){let t=this.getTranslatedPhrase(du);return Vf(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=N$(t)),t},callback(){const t=this.getSelectedRange(),e=Vf(t,(r,n)=>this.getCellMeta(r,n).readOnly);F(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Qu="redo";function $$(){return{key:Qu,name(){return this.getTranslatedPhrase(lp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ju="remove_col";function j$(){return{key:Ju,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(sp,e)},callback(){this.alter("remove_col",XV(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const ec="remove_row";function z$(){return{key:ec,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(op,e)},callback(){this.alter("remove_row",ZV(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const tc="row_above";function U$(){return{key:tc,name(){return this.getTranslatedPhrase(tp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const rc="row_below";function Y$(){return{key:rc,name(){return this.getTranslatedPhrase(rp)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Sa="no_items";function q$(){return{key:Sa,name(){return this.getTranslatedPhrase(ep)},disabled:!0,isCommand:!1}}const nc="undo";function G$(){return{key:nc,name(){return this.getTranslatedPhrase(ap)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const K$=[tc,rc,Ku,Xu,Pp,ec,Ju,nc,Qu,Zu,qr,yt,Sa],X$={[yt]:k$,[Sa]:q$,[tc]:U$,[rc]:Y$,[Ku]:V$,[Xu]:W$,[Pp]:F$,[ec]:z$,[Ju]:j$,[nc]:G$,[Qu]:$$,[Zu]:B$,[qr]:L$};function gO(){const t={};return Me(X$,(e,r)=>{t[r]=e()}),t}function Wf(t,e,r){return(e=Z$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z$(t){var e=Q$(t,"string");return typeof e=="symbol"?e:e+""}function Q$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J${constructor(e){Wf(this,"hot",void 0),Wf(this,"commands",{}),Wf(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=ej(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||bn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),F(u,c=>c.apply(this.hot,n))}}function ej(t,e){let r;return F(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function Bf(t,e,r){return(e=tj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tj(t){var e=rj(t,"string");return typeof e=="symbol"?e:e+""}function rj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nj{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Bf(this,"hot",void 0),Bf(this,"predefinedItems",gO()),Bf(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Me(e,(n,i)=>{let o="";n.name===yt?(r[yt]=n,o=yt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ij(e,this.defaultOrderPattern,this.predefinedItems)}}function ij(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),bt(i)?Me(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),bt(o)?wi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):F(i,(o,s)=>{let a=r[o];!a&&K$.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),bt(o)&&wi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function ni(t,e,r){return(e=oj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oj(t){var e=sj(t,"string");return typeof e=="symbol"?e:e+""}function sj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aj{constructor(e,r){ni(this,"top",void 0),ni(this,"topRelative",void 0),ni(this,"left",void 0),ni(this,"leftRelative",void 0),ni(this,"scrollTop",void 0),ni(this,"scrollLeft",void 0),ni(this,"cellHeight",void 0),ni(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function js(t,e,r){lj(t,e),e.set(t,r)}function lj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e){return t.get(mO(t,e))}function _l(t,e,r){return t.set(mO(t,e),r),r}function mO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ht=new WeakMap,Ut=new WeakMap,Yt=new WeakMap,$f=new WeakMap,Po=new WeakMap;class uj{constructor(e){js(this,Ht,void 0),js(this,Ut,void 0),js(this,Yt,void 0),js(this,$f,!1),js(this,Po,{above:0,below:0,left:0,right:0}),_l($f,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ie(Po,this)[e]=r,this}setElement(e){return _l(Ht,this,e),this}setParentElement(e){return _l(Ut,this,e),this}updatePosition(e){_l(Yt,this,new aj(e,ie(Ht,this).ownerDocument.defaultView)),ie($f,this)?(ie(Yt,this).fitsBelow(ie(Ht,this))?this.setPositionBelowCursor():ie(Yt,this).fitsAbove(ie(Ht,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ie(Ht,this).dir==="rtl"?ie(Yt,this).fitsOnLeft(ie(Ht,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ie(Yt,this).fitsOnRight(ie(Ht,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ie(Po,this).above+ie(Yt,this).top-ie(Ht,this).offsetHeight;if(ie(Ut,this)){const n=ie(Ut,this).ownerDocument.defaultView.getComputedStyle(ie(Ut,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Yt,this).top+ie(Yt,this).cellHeight-ie(Ht,this).scrollHeight+i+o}ie(Ht,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ie(Po,this).below+ie(Yt,this).top+1;if(ie(Ut,this)){const n=ie(Ut,this).ownerDocument.defaultView.getComputedStyle(ie(Ut,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Yt,this).top-i-o-1}ie(Ht,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ie(Yt,this).left;if(ie(Ut,this)){const r=ie(Ut,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Ut,this).querySelector(".htCore")).borderRightWidth,10);e+=ie(Yt,this).cellWidth+n}else e+=ie(Po,this).right;ie(Ht,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ie(Po,this).left+ie(Yt,this).left-ie(Ht,this).offsetWidth;if(ie(Ut,this)){const r=ie(Ut,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Ut,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ie(Ht,this).style.left=`${e}px`}}function cj(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=He(e,-1,p()-1);function a(b,E){const v=p()-1;return b<0&&(b=v),b>v&&(b=0),o.has(b)?-1:(o.add(b),n(b,!1)===!1&&(b=a(E===1?++b:--b,E)),b)}function l(b){b>-1&&b<p()&&n(b,!0)!==!1&&(s=b)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function d(){p()>0&&(o.clear(),s=a(++s,1))}function g(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(r(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:g,getSize:p,clear:y}}function hj(t){return yn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Og(t){return bn(t,"submenu")}function Mg(t){return new RegExp(yt,"i").test(t.name)}function Yl(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function JS(t){return bn(t,"disableSelection")}function dj(t){return we(t,"htSeparator")}function fj(t){return we(t,"htSubmenu")}function gj(t){return we(t,"htDisabled")}function mj(t){return we(t,"htSelectionDisabled")}function pj(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function pO(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function wj(t,e){let r=t.slice(0);return r.reverse(),r=pO(r,e),r.reverse(),r}function vj(t){const e=[];return F(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function yj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yt,r=t.slice(0);return r=pO(r,e),r=wj(r,e),r=vj(r),r}function bj(t){return t.checkable===!0}function Cj(t){return cj({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||dj(n)||gj(n)||mj(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Sj(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const wO="menu",eR=wO;function Rj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Sj(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:wO})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(p=>h.removeShortcutsByKeys(p))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${eR}:${u}`:eR}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Tj(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Xo(r),J(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Yl(a,t)&&!JS(a)&&!Mg(a);Oe(r,[...bj(a)?[WA(),fg(c),YA(h)]:[VA(),fg(u)],...d?[ho(-1)]:[],...Yl(a,t)?[zA()]:[],...Og(a)?[Wl(!1)]:[]])}r.className="",r.appendChild(l),Mg(a)?J(r,"htSeparator"):typeof a.renderer=="function"?(J(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):AE(l,u),Yl(a,t)?J(r,"htDisabled"):JS(a)?J(r,"htSelectionDisabled"):Og(a)&&J(r,"htSubmenu")}}function jf(t,e,r){Ej(t,e),e.set(t,r)}function Ej(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cn(t,e,r){return(e=_j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _j(t){var e=Oj(t,"string");return typeof e=="symbol"?e:e+""}function Oj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zf(t,e,r){return t.set(vO(t,e),r),r}function Wi(t,e){return t.get(vO(t,e))}function vO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tR=215;var zs=new WeakMap,Ol=new WeakMap,Ml=new WeakMap;class ic{get tableBorderWidth(){return Wi(Ml,this)===void 0&&this.hotMenu&&zf(Ml,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Wi(Ml,this)}constructor(e,r){var n=this;cn(this,"hot",void 0),cn(this,"options",void 0),cn(this,"eventManager",new vi(this)),cn(this,"container",void 0),cn(this,"positioner",void 0),cn(this,"hotMenu",null),cn(this,"hotSubMenus",{}),cn(this,"parentMenu",void 0),cn(this,"menuItems",null),cn(this,"origOutsideClickDeselects",null),jf(this,zs,void 0),jf(this,Ol,void 0),jf(this,Ml,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:tR,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new uj(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=va(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Wi(zs,this)}getKeyboardShortcutsCtrl(){return Wi(Ol,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=BE(a=>this.openSubMenu(a),300),r=this.options.minWidth||tR;let n=!1,i=_m(this.menuItems,a=>(a.key===Sa&&(n=!0),pj(a,this.hot)));if(i.length<1&&!n)i.push(gO()[Sa]);else if(i.length===0)return;i=yj(i,yt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return me(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Tj(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Wi(zs,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Jb()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Jb()||!uu(a))&&o&&this.hasSelectedItem()&&(Ui()||YE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),zf(zs,this,Cj(this.hotMenu)),zf(Ol,this,Rj(this)),Wi(Ol,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Wi(zs,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Oe(n,[Wl(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!fj(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new ic(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Oe(r,[Wl(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Oe(i,[Wl(!1)])}}closeAllSubMenus(){F(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?hj(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Mg(e)||Yl(e,this.hot)||Og(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:r}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,s=parseInt(i.width,10),a=co(n,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?tr(this.hotMenu.getCell(c,0)):0;return l+(u.name===yt?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Pe(n)&&(n=n.call(this.hot),n===null||Nt(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),J(i,`htMenu handsontable ${this.options.className}`),n&&J(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Oe(this.hotMenu.rootElement,[FA(),ho(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!qo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!qo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&qo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ke(ic,Tn);function Mj(t,e){Ij(t,e),e.add(t)}function Ij(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uf(t,e,r){return(e=Pj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pj(t){var e=xj(t,"string");return typeof e=="symbol"?e:e+""}function xj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Il(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ra="contextMenu",Hj=70,rR=ra;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var Us=new WeakSet;class oc extends Gu{constructor(){super(...arguments),Mj(this,Us),Uf(this,"commandExecutor",new J$(this.hot)),Uf(this,"itemsFactory",null),Uf(this,"menu",null)}static get PLUGIN_KEY(){return ra}static get PLUGIN_PRIORITY(){return Hj}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[tc,rc,yt,Ku,Xu,yt,ec,Ju,yt,nc,Qu,yt,Zu,yt,qr]}isEnabled(){return!!this.hot.getSettings()[ra]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[ra];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new ic(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Il(Us,this,Dj).call(this)),this.menu.addLocalHook("afterOpen",()=>Il(Us,this,Nj).call(this)),this.menu.addLocalHook("afterClose",()=>Il(Us,this,kj).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Il(Us,this,Aj).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=fO(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:rR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rR)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Me(n,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new nj(this.hot,oc.DEFAULT_ITEMS);const e=this.hot.getSettings()[ra],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),F(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Aj(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=fO(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Dj(){this.hot.runHooks("beforeContextMenuShow",this)}function Nj(){this.hot.runHooks("afterContextMenuShow",this)}function kj(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}oc.SEPARATOR={name:yt};function Lj(t){return{key:"copy",name(){return this.getTranslatedPhrase(cp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Fj(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(fp,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Vj(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(dp,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Wj(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(hp,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Bj(t){return{key:"cut",name(){return this.getTranslatedPhrase(gp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class $j{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class jj{constructor(){this.clipboardData=new $j}preventDefault(){}composedPath(){return[]}}function zj(t,e){yO(t,e),e.add(t)}function xo(t,e,r){yO(t,e),e.set(t,r)}function yO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get($o(t,e))}function Ho(t,e,r){return t.set($o(t,e),r),r}function $o(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ii=new WeakMap,Yf=new WeakMap,Ys=new WeakMap,Ig=new WeakMap,Pg=new WeakMap,qs=new WeakMap,Gs=new WeakSet;class Uj{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;zj(this,Gs),xo(this,ii,void 0),xo(this,Yf,void 0),xo(this,Ys,void 0),xo(this,Ig,void 0),xo(this,Pg,void 0),xo(this,qs,void 0),Ho(Yf,this,r),Ho(Ys,this,n),Ho(Ig,this,i),Ho(Pg,this,o),Ho(qs,this,s)}setSelectedRange(e){Ho(ii,this,e)}getCellsRange(){if(At(Yf,this).call(this)===0||At(Ys,this).call(this)===0)return null;const{row:e,col:r}=At(ii,this).getTopStartCorner(),{row:n,col:i}=At(ii,this).getBottomEndCorner(),o=$o(Gs,this,Yj).call(this,e,n),s=$o(Gs,this,qf).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(At(Ys,this).call(this)===0||At(qs,this).call(this)===0)return null;const{col:e}=At(ii,this).getTopStartCorner(),{col:r}=At(ii,this).getBottomEndCorner(),n=$o(Gs,this,qf).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(At(Ys,this).call(this)===0||At(qs,this).call(this)===0)return null;const{col:e}=At(ii,this).getTopStartCorner(),{col:r}=At(ii,this).getBottomEndCorner(),n=$o(Gs,this,qf).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-At(qs,this).call(this),startCol:e,endRow:-1,endCol:n}}}function qf(t,e){return Math.min(e,Math.max(t+At(Pg,this).call(this)-1,t))}function Yj(t,e){return Math.min(e,Math.max(t+At(Ig,this).call(this)-1,t))}function bO(t){const e=[],r=[];return F(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);qe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);qe(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function qj(t,e){CO(t,e),e.add(t)}function oi(t,e,r){CO(t,e),e.set(t,r)}function CO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e,r){return(e=Gj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gj(t){var e=Kj(t,"string");return typeof e=="symbol"?e:e+""}function Kj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kt(t,e){return t.get(Zt(t,e))}function Ur(t,e,r){return t.set(Zt(t,e),r),r}function Zt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");const Gf="copyPaste",Xj=80,Zj=["fragmentSelection"],nR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var xg=new WeakMap,Hg=new WeakMap,Ag=new WeakMap,Ao=new WeakMap,Pl=new WeakMap,xl=new WeakMap,Do=new WeakMap,mu=new WeakMap,cr=new WeakSet;class Qj extends Gu{constructor(){super(...arguments),qj(this,cr),Ks(this,"columnsLimit",1/0),Ks(this,"rowsLimit",1/0),Ks(this,"pasteMode","overwrite"),Ks(this,"uiContainer",this.hot.rootDocument.body),oi(this,xg,!1),oi(this,Hg,!1),oi(this,Ag,!1),oi(this,Ao,"cells-only"),oi(this,Pl,!1),oi(this,xl,!1),oi(this,Do,new Uj({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oi(this,mu,!1),Ks(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Gf}static get SETTING_KEYS(){return[Gf,...Zj]}static get PLUGIN_PRIORITY(){return Xj}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Gf]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Ur(xg,this,this.getSetting("copyColumnHeaders")),Ur(Hg,this,this.getSetting("copyColumnGroupHeaders")),Ur(Ag,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Zt(cr,this,tz).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zt(cr,n,rz).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Zt(cr,this,nz).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),zE()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zt(cr,n,iz).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zt(cr,n,oz).call(n,...o)}),this.addHook("afterSelection",()=>Zt(cr,this,sz).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ur(Ao,this,e),Ur(Pl,this,!0),Zt(cr,this,iR).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ur(xl,this,!0),Zt(cr,this,iR).call(this,"cut")}getRangedCopyableData(e){return ha(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=bO(e);return F(n,o=>{const s=[];F(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),r.push(s)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new jj;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Kt(Do,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Kt(Ao,this)==="column-headers-only"?r.set("headers",Kt(Do,this).getMostBottomColumnHeadersRange()):(Kt(Ao,this)==="with-column-headers"?r.set("headers",Kt(Do,this).getMostBottomColumnHeadersRange()):Kt(Ao,this)==="with-column-group-headers"&&r.set("headers",Kt(Do,this).getAllColumnHeadersRange()),r.set("cells",Kt(Do,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,o=[],{row:s,col:a}=r.getTopStartCorner(),{row:l,col:u}=r.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<n||c<=l;){const{skipRowOnPaste:p,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,p===!0)continue;d=y,h=a;const b=[],E=o.length%n;for(;b.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,v===!0)continue;g=T;const _=b.length%i;b.push(e[E][_])}o.push(b)}return Ur(mu,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Kt(Pl,this)||this.isEditorOpened()||Gi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Bl(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ur(Pl,this,!1);const o=this.getRangedData(this.copyableRanges),s=Zt(cr,this,Jj).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=ha(o);if(e&&e.clipboardData){const u=IC(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[nR,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Ur(Ao,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Kt(xl,this)||this.isEditorOpened()||Gi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Bl(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ur(xl,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=ha(o);if(e&&e.clipboardData){const l=IC(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[nR,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Gi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Bl(r,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=TE(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=cN(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=rW(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function iR(t){if(zE()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&sD(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Jj(t){const{rows:e}=bO(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function ez(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&VE(n)}}}function SO(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&WE(n)}}}function tz(t){t.items.push({name:"---------"},Lj(this)),Kt(xg,this)&&t.items.push(Wj(this)),Kt(Hg,this)&&t.items.push(Vj(this)),Kt(Ag,this)&&t.items.push(Fj(this)),t.items.push(Bj(this))}function rz(t,e,r,n,i){Kt(mu,this)&&(i.value=!0),Ur(mu,this,!1)}function nz(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function iz(){Zt(cr,this,SO).call(this)}function oz(){Zt(cr,this,ez).call(this)}function sz(){Zt(cr,this,SO).call(this)}function az(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function lz(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function uz(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function RO(t,e,r){const n=lz(t,az(t,e,r));return uz(n)}function cz(t,e,r){return(e=hz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hz(t){var e=dz(t,"string");return typeof e=="symbol"?e:e+""}function dz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vr{constructor(e){cz(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Hl(t,e,r){return(e=fz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fz(t){var e=gz(t,"string");return typeof e=="symbol"?e:e+""}function gz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xp extends Vr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),Hl(this,"stateBefore",void 0),Hl(this,"range",void 0),Hl(this,"type",void 0),Hl(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new xp({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){F(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){ai(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function oR(t,e,r){return(e=mz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mz(t){var e=pz(t,"string");return typeof e=="symbol"?e:e+""}function pz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hp extends Vr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),oR(this,"columns",void 0),oR(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new Hp({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),RO(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function sR(t,e,r){return(e=wz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wz(t){var e=vz(t,"string");return typeof e=="symbol"?e:e+""}function vz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ap extends Vr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),sR(this,"previousSortState",void 0),sR(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new Ap({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function aR(t,e,r){return(e=yz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yz(t){var e=bz(t,"string");return typeof e=="symbol"?e:e+""}function bz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dp extends Vr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),aR(this,"index",void 0),aR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new Dp({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function lR(t,e,r){return(e=Cz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cz(t){var e=Sz(t,"string");return typeof e=="symbol"?e:e+""}function Sz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Np extends Vr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),lR(this,"index",void 0),lR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Np({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Al(t,e,r){return(e=Rz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rz(t){var e=Tz(t,"string");return typeof e=="symbol"?e:e+""}function Tz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kp extends Vr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),Al(this,"changes",void 0),Al(this,"selected",void 0),Al(this,"countCols",void 0),Al(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new kp({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=gr(this.changes);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=gr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function uR(t,e,r){return(e=Ez(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ez(t){var e=_z(t,"string");return typeof e=="symbol"?e:e+""}function _z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lp extends Vr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),uR(this,"conditionsStack",void 0),uR(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new Lp({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function Oz(t,e,r){return(e=Mz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mz(t){var e=Iz(t,"string");return typeof e=="symbol"?e:e+""}function Iz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fp extends Vr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),Oz(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new Fp({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function TO(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return qe(n,i,l=>{qe(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Nn(t,e,r){return(e=Pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pz(t){var e=xz(t,"string");return typeof e=="symbol"?e:e+""}function xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vp extends Vr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Nn(this,"index",void 0),Nn(this,"indexes",void 0),Nn(this,"data",void 0),Nn(this,"amount",void 0),Nn(this,"headers",void 0),Nn(this,"columnPositions",void 0),Nn(this,"rowPositions",void 0),Nn(this,"fixedColumnsStart",void 0),Nn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return qe(l.length-1,p=>{const y=[],b=l[p];qe(u,c,E=>{y.push(b[e.toPhysicalColumn(E)])}),h.push(y)}),qe(i-1,p=>{g.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&qe(i-1,p=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)}),new Vp({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:TO(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(yn(this.data[c],o));const l=yn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),F(e.getSourceDataArray(),(c,h)=>{F(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&F(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function No(t,e,r){return(e=Hz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hz(t){var e=Az(t,"string");return typeof e=="symbol"?e:e+""}function Az(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wp extends Vr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),No(this,"index",void 0),No(this,"data",void 0),No(this,"fixedRowsBottom",void 0),No(this,"fixedRowsTop",void 0),No(this,"rowIndexesSequence",void 0),No(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=gr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new Wp({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:TO(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function cR(t,e,r){return(e=Dz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dz(t){var e=Nz(t,"string");return typeof e=="symbol"?e:e+""}function Nz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bp extends Vr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),cR(this,"rows",void 0),cR(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new Bp({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),RO(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function kz(t,e,r){return(e=Lz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lz(t){var e=Fz(t,"string");return typeof e=="symbol"?e:e+""}function Fz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $p extends Vr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),kz(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new $p({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function Vz(t,e){[xp,Hp,Ap,Dp,Np,kp,Lp,Fp,Vp,Wp,Bp,$p].forEach(r=>r.startRegisteringEvents(t,e))}function Wz(t,e){Bz(t,e),e.add(t)}function Bz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kf(t,e,r){return(e=$z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $z(t){var e=jz(t,"string");return typeof e=="symbol"?e:e+""}function jz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const hR="undoRedo",zz="undoRedo",Uz=1e3;ge.getSingleton().register("beforeUndo");ge.getSingleton().register("afterUndo");ge.getSingleton().register("beforeRedo");ge.getSingleton().register("afterRedo");const dR=new Set;var Dl=new WeakSet;class Yz extends Gu{static get PLUGIN_KEY(){return zz}static get PLUGIN_PRIORITY(){return Uz}static get SETTING_KEYS(){return!0}constructor(e){super(e),Wz(this,Dl),Kf(this,"doneActions",[]),Kf(this,"undoneActions",[]),Kf(this,"ignoreNewActions",!1),Vz(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Xf(Dl,e,qz).call(e,...n)}),this.registerShortcuts(),Xf(Dl,this,Gz).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Xf(Dl,this,Kz).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:hR};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hR)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=gr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=gr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function qz(t,e){e==="loadData"&&this.clear()}function Gz(){const t=e=>{dR.has(e)||(Yn(er`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),dR.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Kz(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class Xz{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=v=>{if(v=this.postProcess(v,n),i){setTimeout(function(){i(v)},0);return}else return v},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let p=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&p+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let y=-1/0,b=1/0;const E=()=>{for(let v=Math.max(y,-u);v<=Math.min(b,u);v+=2){let T;const _=g[v-1],M=g[v+1];_&&(g[v-1]=void 0);let I=!1;if(M){const V=M.oldPos-v;I=M&&0<=V&&V<a}const H=_&&_.oldPos+1<l;if(!I&&!H){g[v]=void 0;continue}if(!H||I&&_.oldPos<M.oldPos?T=this.addToPath(M,!0,!1,0,n):T=this.addToPath(_,!1,!0,1,n),p=this.extractCommon(T,r,e,v,n),T.oldPos+1>=l&&p+1>=a)return s(this.buildValues(T.lastComponent,r,e))||!0;g[v]=T,T.oldPos+1>=l&&(b=Math.min(b,v-1)),p+1>=a&&(y=Math.max(y,v+1))}u++};if(i)(function v(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);E()||v()},0)})();else for(;u<=c&&Date.now()<=d;){const v=E();if(v)return v}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const p=n[u+g];return p.length>d.length?p:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class Zz extends Xz{constructor(){super(...arguments),this.tokenize=Jz}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const Qz=new Zz;function fR(t,e,r){return Qz.diff(t,e,r)}function Jz(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function eU(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;fR(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(fR(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(v){return v.map(function(T){return" "+T})}const d=[];let g=0,p=0,y=[],b=1,E=1;for(let v=0;v<c.length;v++){const T=c[v],_=T.lines||rU(T.value);if(T.lines=_,T.added||T.removed){if(!g){const M=c[v-1];g=b,p=E,M&&(y=l>0?h(M.lines.slice(-l)):[],g-=y.length,p-=y.length)}for(const M of _)y.push((T.added?"+":"-")+M);T.added?E+=_.length:b+=_.length}else{if(g)if(_.length<=l*2&&v<c.length-2)for(const M of h(_))y.push(M);else{const M=Math.min(_.length,l);for(const H of h(_.slice(0,M)))y.push(H);const I={oldStart:g,oldLines:b-g+M,newStart:p,newLines:E-p+M,lines:y};d.push(I),g=0,p=0,y=[]}b+=_.length,E+=_.length}}for(const v of d)for(let T=0;T<v.lines.length;T++)v.lines[T].endsWith(`
`)?v.lines[T]=v.lines[T].slice(0,-1):(v.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function EO(t){if(Array.isArray(t))return t.map(EO).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function tU(t,e,r,n,i,o,s){{const a=eU(t,e,r,n,i,o);return a?EO(a):void 0}}function rU(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var Dg;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(Dg||(Dg={}));const ko=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,Qo=Dg;class gR{constructor(e){or(this,"data");this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class mR{constructor(e){or(this,"data");this.data=e}run(){return[...new Set(this.data)]}}class Ng{constructor(e,r,n=!0){or(this,"data1");or(this,"data2");or(this,"ignoreDuplicates");n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)Qo.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return Qo.sort(e)}}class nU{constructor(e,r){or(this,"data1");or(this,"data2");this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)Qo.contains(this.data2,r[n])&&e.push(r[n]);return Qo.sort(e)}}class pR{constructor(e){or(this,"data");this.data=Qo.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new Ng(Qo.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class iU{constructor(e,r){or(this,"data1");or(this,"data2");this.data1=e,this.data2=r}run(){return tU("Data1","Data2",this.data1,this.data2)}}const oU=async(t,e)=>{ce(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(ce(e).trim()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var sU=(t,e)=>e("chkDuplicates"),aU=(t,e)=>e("rmDuplicates"),lU=(t,e)=>e("chkConsecutive"),uU=(t,e)=>e("compare"),cU=(t,e)=>e("diff"),hU=AM('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-15jzodw"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-15jzodw"><div class="row svelte-15jzodw"><div id="Table1" class="col-3 svelte-15jzodw"></div> <div id="Table2" class="col-3 pl-0 svelte-15jzodw"></div> <div class="col-2 p-0 pt-5 svelte-15jzodw"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-15jzodw">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-15jzodw">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-15jzodw"><label for="result">Result</label> <textarea class="form-control svelte-15jzodw" id="result" readonly=""></textarea></div></div></div>',1);function dU(t,e){ER(e,!0);const r=[],n=[];Ja(da),Ja(oc),Ja(Qj),Ja(Yz);const i=64;let o,s,a=Qt(""),l=Qt("Data1"),u=Qt("comm"),c=Qt(!0),h=Qt(!0),d=Qt(!1);const g=($,ee,Ce)=>{let Ie;try{Ie=JSON.parse(localStorage.getItem(Ce)||"")}catch{Ie=void 0}const de=new rn(document.getElementById($),{data:Ie,colHeaders:[ee],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return de.addHook("beforePaste",()=>de.updateSettings({readOnly:!0})),de.addHook("afterPaste",fe=>{de.updateSettings({readOnly:!1}),de.deselectCell();for(let re=fe.length-1;re>=0;re--)if(fe[re][0]!==""){de.loadData(fe.slice(0,re+1));return}de.loadData([[""]])}),de};BM(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const p=$=>$.getDataAtCol(0).filter(ee=>ee!==null),y=$=>{const ee=p(o).filter(_e=>_e!=""),Ce=p(s).filter(_e=>_e!="");switch($){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(ce(l)=="Data1"&&!ee.length){Ve(a,`Data1 is empty.
Please enter something...`);return}else if(ce(l)=="Data2"&&!Ce.length){Ve(a,`Data2 is empty.
Please enter something...`);return}break;default:if(ee.length){if(!Ce.length){Ve(a,`Data2 is empty.
Please enter something...`);return}}else{Ve(a,`Data1 is empty.
Please enter something...`);return}}Ve(d,!0);const Ie=v(),de=new Date().getTime();let fe="",re;switch($){case"chkDuplicates":let _e;ce(l)=="Data1"?_e=new gR(ee).run():_e=new gR(Ce).run(),Object.keys(_e).length?ce(c)?fe=`Duplicate values found in ${ce(l)}.
`+ko(Object.keys(_e).length,Object.keys(_e).map(Ue=>`${Ue} appears ${_e[Ue]} times.`)):fe=Object.keys(_e).join(`
`):fe=`${ce(l)} has no duplicate value.`;break;case"rmDuplicates":ce(l)=="Data1"?re=new mR(ee).run():re=new mR(Ce).run(),fe=re.join(`
`);break;case"chkConsecutive":ce(l)=="Data1"?re=new pR(ee).run():re=new pR(Ce).run(),re.length?re.length==1&&re[0]=="!Error!"?fe=`Error!
${ce(l)} contains non-numeric value. Please check!`:fe=`${ce(l)} is not consecutive.

The following numbers are missing:
${re.join(`
`)}`:fe=`${ce(l)} contains consecutive numbers.`;break;case"compare":if(ce(u)=="comm")re=new nU(ee,Ce).run(),re.length?fe=`Common values found between two data.
${ko(re.length,re)}`:fe="Two data contain no common value.";else{const Ue=new Ng(ee,Ce,ce(h)).run(),dt=new Ng(Ce,ee,ce(h)).run();Ue.length+dt.length==0?fe="Data1 is same as Data2.":Ue.length?dt.length?fe=`Two files have inconsistent content.

Data1 is more than Data2
${ko(Ue.length,Ue)}

Data2 is more than Data1
${ko(dt.length,dt)}`:fe=`Data1 completely contains Data2.

Data1 is more than Data2
${ko(Ue.length,Ue)}`:fe=`Data2 completely contains Data1.

Data2 is more than Data1
${ko(dt.length,dt)}`}break;case"diff":fe=new iU(ee.join(`
`)+`
`,Ce.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(Ie),$=="rmDuplicates"||$=="chkDuplicates"&&!ce(c)?Ve(a,fe,!0):Ve(a,fe+`

Duration for process: ${Date.now()-de}ms`),Ve(d,!1)},b=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),Ve(a,""))},E=()=>{const $=o.getData();o.loadData(s.getData()),s.loadData($)},v=()=>setInterval(()=>{const $=ce(a).split("Processing");let ee=$.length>=2?$[1].length:0;ee<3?ee++:ee-=3,Ve(a,"Processing"+".".repeat(ee))},200);var T=hU();xM("beforeunload",Qf,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var _=wt(aM(T),2),M=It(_),I=wt(It(M),4),H=It(I);H.__click=[sU,y];var V=wt(H,2),N=It(V),j=It(N),z=wt(V,2);z.__click=[aU,y];var te=wt(z,2);te.__click=[lU,y];var ue=wt(te,2),G=It(ue),Q=It(G);Q.value=Q.__value="Data1";var lt=wt(G,2),ae=It(lt);ae.value=ae.__value="Data2";var be=wt(ue,4);be.__click=[uU,y];var Ge=wt(be,2),vr=It(Ge),Ee=It(vr);Ee.value=Ee.__value="comm";var f=wt(vr,2),m=It(f);m.value=m.__value="diff";var w=wt(Ge,2),C=It(w),R=It(C),O=wt(w,4);O.__click=[cU,y];var P=wt(O,6);P.__click=[oU,a];var A=wt(P,6);A.__click=E;var Y=It(A);FM(Y,()=>"Data1<=>Data2");var B=wt(A,6);B.__click=b;var x=wt(I,2),oe=wt(It(x),2);kR(()=>{H.disabled=ce(d),z.disabled=ce(d),te.disabled=ce(d),be.disabled=ce(d),R.disabled=ce(u)=="comm",O.disabled=ce(d),P.disabled=ce(d),A.disabled=ce(d),B.disabled=ce(d)}),lw(j,()=>ce(c),$=>Ve(c,$)),$a(r,[],Q,()=>ce(l),$=>Ve(l,$)),$a(r,[],ae,()=>ce(l),$=>Ve(l,$)),$a(n,[],Ee,()=>ce(u),$=>Ve(u,$)),$a(n,[],m,()=>ce(u),$=>Ve(u,$)),lw(R,()=>ce(h),$=>Ve(h,$)),VM(oe,()=>ce(a),$=>Ve(a,$)),DM(t,T),_R()}HM(["click"]);NM(dU,{target:document.body})});export default fU();
