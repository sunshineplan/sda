var BM=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var N2=BM((B2,Cu)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const mE=!1;var pE=Array.isArray,jM=Array.prototype.indexOf,zM=Array.from,Mg=Object.defineProperty,Ra=Object.getOwnPropertyDescriptor,UM=Object.prototype,YM=Array.prototype,qM=Object.getPrototypeOf,$w=Object.isExtensible;function wE(t){for(var e=0;e<t.length;e++)t[e]()}function GM(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const yr=2,vE=4,pm=8,za=16,Ai=32,yo=64,yE=128,Nr=256,Su=512,$t=1024,nn=2048,Di=4096,ws=8192,Rs=16384,wm=32768,KM=65536,Bw=1<<17,XM=1<<18,Ua=1<<19,ZM=1<<20,Ig=1<<21,vm=1<<22,ao=1<<23,Ea=Symbol("$state"),ym=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function JM(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function QM(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function eI(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function tI(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function rI(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function nI(t){throw new Error("https://svelte.dev/e/effect_orphan")}function iI(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function oI(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function sI(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function aI(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const lI=2,Ot=Symbol();function bE(t){return t===this.v}let uI=!1,kr=null;function Ru(t){kr=t}function CE(t,e=!1,r){kr={p:kr,c:null,e:null,s:t,x:null,l:null}}function SE(t){var e=kr,r=e.e;if(r!==null){e.e=null;for(var n of r)kE(n)}return kr=e.p,{}}function RE(){return!0}const cI=new WeakMap;function hI(t){var e=be;if(e===null)return we.f|=ao,t;if((e.f&wm)===0){if((e.f&yE)===0)throw!e.parent&&t instanceof Error&&EE(t),t;e.b.error(t)}else bm(t,e)}function bm(t,e){for(;e!==null;){if((e.f&yE)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t instanceof Error&&EE(t),t}function EE(t){const e=cI.get(t);e&&(Mg(t,"message",{value:e.message}),Mg(t,"stack",{value:e.stack}))}let bi=[],Eu=[];function TE(){var t=bi;bi=[],wE(t)}function dI(){var t=Eu;Eu=[],wE(t)}function fI(){return bi.length>0||Eu.length>0}function Tu(t){if(bi.length===0&&!Ta){var e=bi;queueMicrotask(()=>{e===bi&&TE()})}bi.push(t)}function gI(){bi.length>0&&TE(),Eu.length>0&&dI()}function mI(){const t=be.b;return t===null&&JM(),t}function pI(t){var e=yr|nn,r=we!==null&&(we.f&yr)!==0?we:null;return be===null||r!==null&&(r.f&Nr)!==0?e|=Nr:be.f|=Ua,{ctx:kr,deps:null,effects:null,equals:bE,f:e,fn:t,reactions:null,rv:0,v:Ot,wv:0,parent:r??be,ac:null}}function wI(t,e){let r=be;r===null&&eI();var n=r.b,i=void 0,o=PE(Ot),s=null,a=!we;return HI(()=>{try{var l=t();s&&Promise.resolve(l).catch(()=>{})}catch(g){l=Promise.reject(g)}var u=()=>l;i=s?.then(u,u)??Promise.resolve(l),s=i;var c=Ze,h=n.is_pending();a&&(n.update_pending_count(1),h||c.increment());const d=(g,w=void 0)=>{s=null,h||c.activate(),w?w!==ym&&(o.f|=ao,xg(o,w)):((o.f&ao)!==0&&(o.f^=ao),xg(o,g)),a&&(n.update_pending_count(-1),h||c.decrement()),ME()};if(i.then(d,g=>d(null,g||"unknown")),c)return()=>{queueMicrotask(()=>c.neuter())}}),new Promise(l=>{function u(c){function h(){c===i?l(o):u(i)}c.then(h,h)}u(i)})}function _E(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)fo(e[r])}}function vI(t){for(var e=t.parent;e!==null;){if((e.f&yr)===0)return e;e=e.parent}return null}function Cm(t){var e,r=be;Pi(vI(t));try{_E(t),e=YE(t)}finally{Pi(r)}return e}function OE(t){var e=Cm(t);if(t.equals(e)||(t.v=e,t.wv=zE()),!Es){var r=(Ci||(t.f&Nr)!==0)&&t.deps!==null?Di:$t;wr(t,r)}}function yI(t,e,r){const n=pI;if(e.length===0){r(t.map(n));return}var i=Ze,o=be,s=bI(),a=mI();Promise.all(e.map(l=>wI(l))).then(l=>{i?.activate(),s();try{r([...t.map(n),...l])}catch(u){(o.f&Rs)===0&&bm(u,o)}i?.deactivate(),ME()}).catch(l=>{a.error(l)})}function bI(){var t=be,e=we,r=kr,n=Ze;return function(){Pi(t),En(e),Ru(r),n?.activate()}}function ME(){Pi(null),En(null),Ru(null)}const Vc=new Set;let Ze=null,au=null,jw=new Set,ho=[],Yu=null,Pg=!1,Ta=!1;class vs{current=new Map;#l=new Map;#i=new Set;#e=0;#u=null;#c=!1;#r=[];#o=[];#n=[];#t=[];#s=[];#h=[];#d=[];skipped_effects=new Set;process(e){ho=[],au=null;for(const i of e)this.#g(i);if(this.#r.length===0&&this.#e===0){this.#f();var r=this.#n,n=this.#t;this.#n=[],this.#t=[],this.#s=[],au=Ze,Ze=null,zw(r),zw(n),Ze===null?Ze=this:Vc.delete(this),this.#u?.resolve()}else this.#a(this.#n),this.#a(this.#t),this.#a(this.#s);for(const i of this.#r)us(i);for(const i of this.#o)us(i);this.#r=[],this.#o=[]}#g(e){e.f^=$t;for(var r=e.first;r!==null;){var n=r.f,i=(n&(Ai|yo))!==0,o=i&&(n&$t)!==0,s=o||(n&ws)!==0||this.skipped_effects.has(r);if(!s&&r.fn!==null){if(i)r.f^=$t;else if((n&vE)!==0)this.#t.push(r);else if((n&$t)===0)if((n&vm)!==0){var a=r.b?.is_pending()?this.#o:this.#r;a.push(r)}else Gu(r)&&((r.f&za)!==0&&this.#s.push(r),us(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)r=u.next,u=u.parent}}#a(e){for(const r of e)((r.f&nn)!==0?this.#h:this.#d).push(r),wr(r,$t);e.length=0}capture(e,r){this.#l.has(e)||this.#l.set(e,r),this.current.set(e,e.v)}activate(){Ze=this}deactivate(){Ze=null,au=null;for(const e of jw)if(jw.delete(e),e(),Ze!==null)break}neuter(){this.#c=!0}flush(){ho.length>0?IE():this.#f(),Ze===this&&(this.#e===0&&Vc.delete(this),this.deactivate())}#f(){if(!this.#c)for(const e of this.#i)e();this.#i.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)wr(e,nn),Aa(e);for(const e of this.#d)wr(e,Di),Aa(e);this.#n=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#i.add(e)}settled(){return(this.#u??=GM()).promise}static ensure(){if(Ze===null){const e=Ze=new vs;Vc.add(Ze),Ta||vs.enqueue(()=>{Ze===e&&e.flush()})}return Ze}static enqueue(e){Tu(e)}}function CI(t){var e=Ta;Ta=!0;try{for(var r;;){if(gI(),ho.length===0&&!fI()&&(Ze?.flush(),ho.length===0))return Yu=null,r;IE()}}finally{Ta=e}}function IE(){var t=ls;Pg=!0;try{var e=0;for(qw(!0);ho.length>0;){var r=vs.ensure();if(e++>1e3){var n,i;SI()}r.process(ho),Oi.clear()}}finally{Pg=!1,qw(t),Yu=null}}function SI(){try{iI()}catch(t){bm(t,Yu)}}let eo=null;function zw(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(Rs|ws))===0&&Gu(n)&&(eo=[],us(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?$E(n):n.fn=null),eo?.length>0)){Oi.clear();for(const i of eo)us(i);eo=[]}}eo=null}}function Aa(t){for(var e=Yu=t;e.parent!==null;){e=e.parent;var r=e.f;if(Pg&&e===be&&(r&za)!==0)return;if((r&(yo|Ai))!==0){if((r&$t)===0)return;e.f^=$t}}ho.push(e)}const Oi=new Map;function PE(t,e){var r={f:0,v:t,reactions:null,equals:bE,rv:0,wv:0};return r}function rr(t,e){const r=PE(t);return LI(r),r}function ze(t,e,r=!1){we!==null&&(!Cn||(we.f&Bw)!==0)&&RE()&&(we.f&(yr|za|vm|Bw))!==0&&!Xn?.includes(t)&&aI();let n=r?pa(e):e;return xg(t,n)}function xg(t,e){if(!t.equals(e)){var r=t.v;Es?Oi.set(t,e):Oi.set(t,r),t.v=e;var n=vs.ensure();n.capture(t,r),(t.f&yr)!==0&&((t.f&nn)!==0&&Cm(t),wr(t,(t.f&Nr)===0?$t:Di)),t.wv=zE(),xE(t,nn),be!==null&&(be.f&$t)!==0&&(be.f&(Ai|yo))===0&&(xr===null?FI([t]):xr.push(t))}return e}function Wc(t){ze(t,t.v+1)}function xE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&nn)===0;a&&wr(o,e),(s&yr)!==0?xE(o,Di):a&&((s&za)!==0&&eo!==null&&eo.push(o),Aa(o))}}function pa(t){if(typeof t!="object"||t===null||Ea in t)return t;const e=qM(t);if(e!==UM&&e!==YM)return t;var r=new Map,n=pE(t),i=rr(0),o=lo,s=a=>{if(lo===o)return a();var l=we,u=lo;En(null),Kw(o);var c=a();return En(l),Kw(u),c};return n&&r.set("length",rr(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&oI();var c=r.get(l);return c===void 0?c=s(()=>{var h=rr(u.value);return r.set(l,h),h}):ze(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>rr(Ot));r.set(l,c),Wc(i)}}else ze(u,Ot),Wc(i);return!0},get(a,l,u){if(l===Ea)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||Ra(a,l)?.writable)&&(c=s(()=>{var g=pa(h?a[l]:Ot),w=rr(g);return w}),r.set(l,c)),c!==void 0){var d=ue(c);return d===Ot?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=ue(c))}else if(u===void 0){var h=r.get(l),d=h?.v;if(h!==void 0&&d!==Ot)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){if(l===Ea)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Ot||Reflect.has(a,l);if(u!==void 0||be!==null&&(!c||Ra(a,l)?.writable)){u===void 0&&(u=s(()=>{var d=c?pa(a[l]):Ot,g=rr(d);return g}),r.set(l,u));var h=ue(u);if(h===Ot)return!1}return c},set(a,l,u,c){var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?ze(w,Ot):g in a&&(w=s(()=>rr(Ot)),r.set(g+"",w))}if(h===void 0)(!d||Ra(a,l)?.writable)&&(h=s(()=>rr(void 0)),ze(h,pa(u)),r.set(l,h));else{d=h.v!==Ot;var v=s(()=>pa(u));ze(h,v)}var C=Reflect.getOwnPropertyDescriptor(a,l);if(C?.set&&C.set.call(c,u),!d){if(n&&typeof l=="string"){var T=r.get("length"),b=Number(l);Number.isInteger(b)&&b>=T.v&&ze(T,b+1)}Wc(i)}return!0},ownKeys(a){ue(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==Ot});for(var[u,c]of r)c.v!==Ot&&!(u in a)&&l.push(u);return l},setPrototypeOf(){sI()}})}function Uw(t){try{if(t!==null&&typeof t=="object"&&Ea in t)return t[Ea]}catch{}return t}function RI(t,e){return Object.is(Uw(t),Uw(e))}var Hg,HE,AE,DE;function EI(){if(Hg===void 0){Hg=window,HE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;AE=Ra(e,"firstChild").get,DE=Ra(e,"nextSibling").get,$w(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),$w(r)&&(r.__t=void 0)}}function TI(t=""){return document.createTextNode(t)}function io(t){return AE.call(t)}function Sm(t){return DE.call(t)}function Dt(t,e){return io(t)}function _I(t,e){{var r=io(t);return r instanceof Comment&&r.data===""?Sm(r):r}}function Ct(t,e=1,r=!1){let n=t;for(;e--;)n=Sm(n);return n}let Yw=!1;function OI(){Yw||(Yw=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function qu(t){var e=we,r=be;En(null),Pi(null);try{return t()}finally{En(e),Pi(r)}}function Rm(t,e,r,n=r){t.addEventListener(e,()=>qu(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),OI()}function MI(t){be===null&&we===null&&nI(),we!==null&&(we.f&Nr)!==0&&be===null&&rI(),Es&&tI()}function II(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function bo(t,e,r,n=!0){var i=be;i!==null&&(i.f&ws)!==0&&(t|=ws);var o={ctx:kr,deps:null,nodes_start:null,nodes_end:null,f:t|nn,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{us(o),o.f|=wm}catch(l){throw fo(o),l}else e!==null&&Aa(o);if(n){var s=o;if(r&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&Ua)===0&&(s=s.first),s!==null&&(s.parent=i,i!==null&&II(s,i),we!==null&&(we.f&yr)!==0&&(t&yo)===0)){var a=we;(a.effects??=[]).push(s)}}return o}function NE(t){const e=bo(pm,null,!1);return wr(e,$t),e.teardown=t,e}function PI(t){MI();var e=be.f,r=!we&&(e&Ai)!==0&&(e&wm)===0;if(r){var n=kr;(n.e??=[]).push(t)}else return kE(t)}function kE(t){return bo(vE|ZM,t,!1)}function xI(t){vs.ensure();const e=bo(yo|Ua,t,!0);return(r={})=>new Promise(n=>{r.outro?NI(e,()=>{fo(e),n(void 0)}):(fo(e),n(void 0))})}function HI(t){return bo(vm|Ua,t,!0)}function Em(t,e=0){return bo(pm|e,t,!0)}function LE(t,e=[],r=[]){yI(e,r,n=>{bo(pm,()=>t(...n.map(ue)),!0)})}function AI(t,e=!0){return bo(Ai|Ua,t,!0,e)}function FE(t){var e=t.teardown;if(e!==null){const r=Es,n=we;Gw(!0),En(null);try{e.call(null)}finally{Gw(r),En(n)}}}function VE(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&qu(()=>{i.abort(ym)});var n=r.next;(r.f&yo)!==0?r.parent=null:fo(r,e),r=n}}function DI(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Ai)===0&&fo(e),e=r}}function fo(t,e=!0){var r=!1;(e||(t.f&XM)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(WE(t.nodes_start,t.nodes_end),r=!0),VE(t,e&&!r),_u(t,0),wr(t,Rs);var n=t.transitions;if(n!==null)for(const o of n)o.stop();FE(t);var i=t.parent;i!==null&&i.first!==null&&$E(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function WE(t,e){for(;t!==null;){var r=t===e?null:Sm(t);t.remove(),t=r}}function $E(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function NI(t,e){var r=[];BE(t,r,!0),kI(r,()=>{fo(t),e&&e()})}function kI(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function BE(t,e,r){if((t.f&ws)===0){if(t.f^=ws,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&KM)!==0||(n.f&Ai)!==0;BE(n,e,o?r:!1),n=i}}}let ls=!1;function qw(t){ls=t}let Es=!1;function Gw(t){Es=t}let we=null,Cn=!1;function En(t){we=t}let be=null;function Pi(t){be=t}let Xn=null;function LI(t){we!==null&&(Xn===null?Xn=[t]:Xn.push(t))}let Wt=null,fr=0,xr=null;function FI(t){xr=t}let jE=1,Da=0,lo=Da;function Kw(t){lo=t}let Ci=!1;function zE(){return++jE}function Gu(t){var e=t.f;if((e&nn)!==0)return!0;if((e&Di)!==0){var r=t.deps,n=(e&Nr)!==0;if(r!==null){var i,o,s=(e&Su)!==0,a=n&&be!==null&&!Ci,l=r.length;if((s||a)&&(be===null||(be.f&Rs)===0)){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!o?.reactions?.includes(u))&&(o.reactions??=[]).push(u);s&&(u.f^=Su),a&&c!==null&&(c.f&Nr)===0&&(u.f^=Nr)}for(i=0;i<l;i++)if(o=r[i],Gu(o)&&OE(o),o.wv>t.wv)return!0}(!n||be!==null&&!Ci)&&wr(t,$t)}return!1}function UE(t,e,r=!0){var n=t.reactions;if(n!==null&&!Xn?.includes(t))for(var i=0;i<n.length;i++){var o=n[i];(o.f&yr)!==0?UE(o,e,!1):e===o&&(r?wr(o,nn):(o.f&$t)!==0&&wr(o,Di),Aa(o))}}function YE(t){var e=Wt,r=fr,n=xr,i=we,o=Ci,s=Xn,a=kr,l=Cn,u=lo,c=t.f;Wt=null,fr=0,xr=null,Ci=(c&Nr)!==0&&(Cn||!ls||we===null),we=(c&(Ai|yo))===0?t:null,Xn=null,Ru(t.ctx),Cn=!1,lo=++Da,t.ac!==null&&(qu(()=>{t.ac.abort(ym)}),t.ac=null);try{t.f|=Ig;var h=t.fn,d=h(),g=t.deps;if(Wt!==null){var w;if(_u(t,fr),g!==null&&fr>0)for(g.length=fr+Wt.length,w=0;w<Wt.length;w++)g[fr+w]=Wt[w];else t.deps=g=Wt;if(!Ci||(c&yr)!==0&&t.reactions!==null)for(w=fr;w<g.length;w++)(g[w].reactions??=[]).push(t)}else g!==null&&fr<g.length&&(_u(t,fr),g.length=fr);if(RE()&&xr!==null&&!Cn&&g!==null&&(t.f&(yr|Di|nn))===0)for(w=0;w<xr.length;w++)UE(xr[w],t);return i!==null&&i!==t&&(Da++,xr!==null&&(n===null?n=xr:n.push(...xr))),(t.f&ao)!==0&&(t.f^=ao),d}catch(v){return hI(v)}finally{t.f^=Ig,Wt=e,fr=r,xr=n,we=i,Ci=o,Xn=s,Ru(a),Cn=l,lo=u}}function VI(t,e){let r=e.reactions;if(r!==null){var n=jM.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&yr)!==0&&(Wt===null||!Wt.includes(e))&&(wr(e,Di),(e.f&(Nr|Su))===0&&(e.f^=Su),_E(e),_u(e,0))}function _u(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)VI(t,r[n])}function us(t){var e=t.f;if((e&Rs)===0){wr(t,$t);var r=be,n=ls;be=t,ls=!0;try{(e&za)!==0?DI(t):VE(t),FE(t);var i=YE(t);t.teardown=typeof i=="function"?i:null,t.wv=jE;var o;mE&&uI&&(t.f&nn)!==0&&t.deps}finally{ls=n,be=r}}}async function WI(){await Promise.resolve(),CI()}function ue(t){var e=t.f,r=(e&yr)!==0;if(we!==null&&!Cn){var n=be!==null&&(be.f&Rs)!==0;if(!n&&!Xn?.includes(t)){var i=we.deps;if((we.f&Ig)!==0)t.rv<Da&&(t.rv=Da,Wt===null&&i!==null&&i[fr]===t?fr++:Wt===null?Wt=[t]:(!Ci||!Wt.includes(t))&&Wt.push(t));else{(we.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[we]:o.includes(we)||o.push(we)}}}else if(r&&t.deps===null&&t.effects===null){var s=t,a=s.parent;a!==null&&(a.f&Nr)===0&&(s.f^=Nr)}if(Es){if(Oi.has(t))return Oi.get(t);if(r){s=t;var l=s.v;return((s.f&$t)===0&&s.reactions!==null||qE(s))&&(l=Cm(s)),Oi.set(s,l),l}}else r&&(s=t,Gu(s)&&OE(s));if((t.f&ao)!==0)throw t.v;return t.v}function qE(t){if(t.v===Ot)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Oi.has(e)||(e.f&yr)!==0&&qE(e))return!0;return!1}function Tm(t){var e=Cn;try{return Cn=!0,t()}finally{Cn=e}}const $I=-7169;function wr(t,e){t.f=t.f&$I|e}const BI=["touchstart","touchmove"];function jI(t){return BI.includes(t)}const GE=new Set,Ag=new Set;function zI(t,e,r,n={}){function i(o){if(n.capture||wa.call(e,o),!o.cancelBubble)return qu(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Tu(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function UI(t,e,r,n,i){var o={capture:n,passive:i},s=zI(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&NE(()=>{e.removeEventListener(t,s,o)})}function YI(t){for(var e=0;e<t.length;e++)GE.add(t[e]);for(var r of Ag)r(t)}let Xw=null;function wa(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;Xw=t;var s=0,a=Xw===t&&t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){Mg(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=we,h=be;En(null),Pi(null);try{for(var d,g=[];o!==null;){var w=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+n];if(v!=null&&(!o.disabled||t.target===o))if(pE(v)){var[C,...T]=v;C.apply(o,[t,...T])}else v.call(o,t)}catch(b){d?g.push(b):d=b}if(t.cancelBubble||w===e||w===null)break;o=w}if(d){for(let b of g)queueMicrotask(()=>{throw b});throw d}}finally{t.__root=e,delete t.currentTarget,En(c),Pi(h)}}}function KE(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function XE(t,e){var r=be;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function qI(t,e){var r=(e&lI)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=KE(i?t:"<!>"+t));var o=r||HE?document.importNode(n,!0):n.cloneNode(!0);{var s=io(o),a=o.lastChild;XE(s,a)}return o}}function GI(t,e){t!==null&&t.before(e)}function KI(t,e){return XI(t,e)}const Do=new Map;function XI(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){EI();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var w=jI(g);e.addEventListener(g,wa,{passive:w});var v=Do.get(g);v===void 0?(document.addEventListener(g,wa,{passive:w}),Do.set(g,1)):Do.set(g,v+1)}}};l(zM(GE)),Ag.add(l);var u=void 0,c=xI(()=>{var h=r??e.appendChild(TI());return AI(()=>{if(o){CE({});var d=kr;d.c=o}i&&(n.$$events=i),u=t(h,n)||{},o&&SE()}),()=>{for(var d of a){e.removeEventListener(d,wa);var g=Do.get(d);--g===0?(document.removeEventListener(d,wa),Do.delete(d)):Do.set(d,g)}Ag.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return ZI.set(u,c),u}let ZI=new WeakMap;function JI(t,e,r=!1,n=!1,i=!1){var o=t,s="";LE(()=>{var a=be;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(WE(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=KE(l);if((r||n)&&(u=io(u)),XE(io(u),u.lastChild),r||n)for(;io(u);)o.before(io(u));else o.before(u)}})}function QI(t,e,r=e){var n=new WeakSet;Rm(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Bc(t)?jc(o):o,r(o),Ze!==null&&n.add(Ze),await WI(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd;t.value=o??"",a!==null&&(t.selectionStart=s,t.selectionEnd=Math.min(a,t.value.length))}}),Tm(e)==null&&t.value&&(r(Bc(t)?jc(t.value):t.value),Ze!==null&&n.add(Ze)),Em(()=>{var i=e();if(t===document.activeElement){var o=au??Ze;if(n.has(o))return}Bc(t)&&i===jc(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}const $c=new Set;function fl(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??=[];s.push(r),Rm(r,"change",()=>{var l=r.__value;o&&(l=eP(s,l,r.checked)),i(l)},()=>i(o?[]:null)),Em(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=RI(r.__value,l)}),NE(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),$c.has(s)||($c.add(s),Tu(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),$c.delete(s)})),Tu(()=>{})}function Zw(t,e,r=e){Rm(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),Tm(e)==null&&r(t.checked),Em(()=>{var n=e();t.checked=!!n})}function eP(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function Bc(t){var e=t.type;return e==="number"||e==="range"}function jc(t){return t===""?null:+t}function tP(t){kr===null&&QM(),PI(()=>{const e=Tm(t);if(typeof e=="function")return e})}const rP="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(rP);var Jw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qw={},ks,ev;function it(){if(ev)return ks;ev=1;var t=function(e){return e&&e.Math===Math&&e};return ks=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof Jw=="object"&&Jw)||t(typeof ks=="object"&&ks)||function(){return this}()||Function("return this")(),ks}var zc={},Uc,tv;function ct(){return tv||(tv=1,Uc=function(t){try{return!!t()}catch{return!0}}),Uc}var Yc,rv;function Wr(){if(rv)return Yc;rv=1;var t=ct();return Yc=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Yc}var qc,nv;function Ku(){if(nv)return qc;nv=1;var t=ct();return qc=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),qc}var Gc,iv;function wt(){if(iv)return Gc;iv=1;var t=Ku(),e=Function.prototype.call;return Gc=t?e.bind(e):function(){return e.apply(e,arguments)},Gc}var Kc={},ov;function nP(){if(ov)return Kc;ov=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return Kc.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Kc}var Xc,sv;function Xu(){return sv||(sv=1,Xc=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Xc}var Zc,av;function ot(){if(av)return Zc;av=1;var t=Ku(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return Zc=t?n:function(i){return function(){return r.apply(i,arguments)}},Zc}var Jc,lv;function Co(){if(lv)return Jc;lv=1;var t=ot(),e=t({}.toString),r=t("".slice);return Jc=function(n){return r(e(n),8,-1)},Jc}var Qc,uv;function iP(){if(uv)return Qc;uv=1;var t=ot(),e=ct(),r=Co(),n=Object,i=t("".split);return Qc=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,Qc}var eh,cv;function _m(){return cv||(cv=1,eh=function(t){return t==null}),eh}var th,hv;function Ya(){if(hv)return th;hv=1;var t=_m(),e=TypeError;return th=function(r){if(t(r))throw new e("Can't call method on "+r);return r},th}var rh,dv;function qa(){if(dv)return rh;dv=1;var t=iP(),e=Ya();return rh=function(r){return t(e(r))},rh}var nh,fv;function ht(){if(fv)return nh;fv=1;var t=typeof document=="object"&&document.all;return nh=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},nh}var ih,gv;function $r(){if(gv)return ih;gv=1;var t=ht();return ih=function(e){return typeof e=="object"?e!==null:t(e)},ih}var oh,mv;function Ts(){if(mv)return oh;mv=1;var t=it(),e=ht(),r=function(n){return e(n)?n:void 0};return oh=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},oh}var sh,pv;function Ga(){if(pv)return sh;pv=1;var t=ot();return sh=t({}.isPrototypeOf),sh}var ah,wv;function Zu(){if(wv)return ah;wv=1;var t=it(),e=t.navigator,r=e&&e.userAgent;return ah=r?String(r):"",ah}var lh,vv;function oP(){if(vv)return lh;vv=1;var t=it(),e=Zu(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),lh=a,lh}var uh,yv;function Om(){if(yv)return uh;yv=1;var t=oP(),e=ct(),r=it(),n=r.String;return uh=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),uh}var ch,bv;function ZE(){if(bv)return ch;bv=1;var t=Om();return ch=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ch}var hh,Cv;function Mm(){if(Cv)return hh;Cv=1;var t=Ts(),e=ht(),r=Ga(),n=ZE(),i=Object;return hh=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},hh}var dh,Sv;function Ju(){if(Sv)return dh;Sv=1;var t=String;return dh=function(e){try{return t(e)}catch{return"Object"}},dh}var fh,Rv;function Cr(){if(Rv)return fh;Rv=1;var t=ht(),e=Ju(),r=TypeError;return fh=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},fh}var gh,Ev;function Ka(){if(Ev)return gh;Ev=1;var t=Cr(),e=_m();return gh=function(r,n){var i=r[n];return e(i)?void 0:t(i)},gh}var mh,Tv;function sP(){if(Tv)return mh;Tv=1;var t=wt(),e=ht(),r=$r(),n=TypeError;return mh=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},mh}var ph={exports:{}},wh,_v;function So(){return _v||(_v=1,wh=!1),wh}var vh,Ov;function Im(){if(Ov)return vh;Ov=1;var t=it(),e=Object.defineProperty;return vh=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},vh}var Mv;function Pm(){if(Mv)return ph.exports;Mv=1;var t=So(),e=it(),r=Im(),n="__core-js_shared__",i=ph.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),ph.exports}var yh,Iv;function JE(){if(Iv)return yh;Iv=1;var t=Pm();return yh=function(e,r){return t[e]||(t[e]=r||{})},yh}var bh,Pv;function _s(){if(Pv)return bh;Pv=1;var t=Ya(),e=Object;return bh=function(r){return e(t(r))},bh}var Ch,xv;function Br(){if(xv)return Ch;xv=1;var t=ot(),e=_s(),r=t({}.hasOwnProperty);return Ch=Object.hasOwn||function(i,o){return r(e(i),o)},Ch}var Sh,Hv;function QE(){if(Hv)return Sh;Hv=1;var t=ot(),e=0,r=Math.random(),n=t(1.1.toString);return Sh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Sh}var Rh,Av;function an(){if(Av)return Rh;Av=1;var t=it(),e=JE(),r=Br(),n=QE(),i=Om(),o=ZE(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Rh=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Rh}var Eh,Dv;function aP(){if(Dv)return Eh;Dv=1;var t=wt(),e=$r(),r=Mm(),n=Ka(),i=sP(),o=an(),s=TypeError,a=o("toPrimitive");return Eh=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Eh}var Th,Nv;function eT(){if(Nv)return Th;Nv=1;var t=aP(),e=Mm();return Th=function(r){var n=t(r,"string");return e(n)?n:n+""},Th}var _h,kv;function xm(){if(kv)return _h;kv=1;var t=it(),e=$r(),r=t.document,n=e(r)&&e(r.createElement);return _h=function(i){return n?r.createElement(i):{}},_h}var Oh,Lv;function tT(){if(Lv)return Oh;Lv=1;var t=Wr(),e=ct(),r=xm();return Oh=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Oh}var Fv;function rT(){if(Fv)return zc;Fv=1;var t=Wr(),e=wt(),r=nP(),n=Xu(),i=qa(),o=eT(),s=Br(),a=tT(),l=Object.getOwnPropertyDescriptor;return zc.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},zc}var Mh={},Ih,Vv;function nT(){if(Vv)return Ih;Vv=1;var t=Wr(),e=ct();return Ih=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ih}var Ph,Wv;function vt(){if(Wv)return Ph;Wv=1;var t=$r(),e=String,r=TypeError;return Ph=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},Ph}var $v;function Ni(){if($v)return Mh;$v=1;var t=Wr(),e=tT(),r=nT(),n=vt(),i=eT(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Mh.f=t?r?function(d,g,w){if(n(d),g=i(g),n(w),typeof d=="function"&&g==="prototype"&&"value"in w&&c in w&&!w[c]){var v=a(d,g);v&&v[c]&&(d[g]=w.value,w={configurable:u in w?w[u]:v[u],enumerable:l in w?w[l]:v[l],writable:!1})}return s(d,g,w)}:s:function(d,g,w){if(n(d),g=i(g),n(w),e)try{return s(d,g,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(d[g]=w.value),d},Mh}var xh,Bv;function Os(){if(Bv)return xh;Bv=1;var t=Wr(),e=Ni(),r=Xu();return xh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},xh}var Hh={exports:{}},Ah,jv;function lP(){if(jv)return Ah;jv=1;var t=Wr(),e=Br(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return Ah={EXISTS:i,PROPER:o,CONFIGURABLE:s},Ah}var Dh,zv;function uP(){if(zv)return Dh;zv=1;var t=ot(),e=ht(),r=Pm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Dh=r.inspectSource,Dh}var Nh,Uv;function cP(){if(Uv)return Nh;Uv=1;var t=it(),e=ht(),r=t.WeakMap;return Nh=e(r)&&/native code/.test(String(r)),Nh}var kh,Yv;function Hm(){if(Yv)return kh;Yv=1;var t=JE(),e=QE(),r=t("keys");return kh=function(n){return r[n]||(r[n]=e(n))},kh}var Lh,qv;function Am(){return qv||(qv=1,Lh={}),Lh}var Fh,Gv;function iT(){if(Gv)return Fh;Gv=1;var t=cP(),e=it(),r=$r(),n=Os(),i=Br(),o=Pm(),s=Hm(),a=Am(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,w=function(b){return g(b)?d(b):h(b,{})},v=function(b){return function(E){var y;if(!r(E)||(y=d(E)).type!==b)throw new u("Incompatible receiver, "+b+" required");return y}};if(t||o.state){var C=o.state||(o.state=new c);C.get=C.get,C.has=C.has,C.set=C.set,h=function(b,E){if(C.has(b))throw new u(l);return E.facade=b,C.set(b,E),E},d=function(b){return C.get(b)||{}},g=function(b){return C.has(b)}}else{var T=s("state");a[T]=!0,h=function(b,E){if(i(b,T))throw new u(l);return E.facade=b,n(b,T,E),E},d=function(b){return i(b,T)?b[T]:{}},g=function(b){return i(b,T)}}return Fh={set:h,get:d,has:g,enforce:w,getterFor:v},Fh}var Kv;function oT(){if(Kv)return Hh.exports;Kv=1;var t=ot(),e=ct(),r=ht(),n=Br(),i=Wr(),o=lP().CONFIGURABLE,s=uP(),a=iT(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),w=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),T=Hh.exports=function(b,E,y){d(c(E),0,7)==="Symbol("&&(E="["+g(c(E),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),y&&y.getter&&(E="get "+E),y&&y.setter&&(E="set "+E),(!n(b,"name")||o&&b.name!==E)&&(i?h(b,"name",{value:E,configurable:!0}):b.name=E),v&&y&&n(y,"arity")&&b.length!==y.arity&&h(b,"length",{value:y.arity});try{y&&n(y,"constructor")&&y.constructor?i&&h(b,"prototype",{writable:!1}):b.prototype&&(b.prototype=void 0)}catch{}var I=l(b);return n(I,"source")||(I.source=w(C,typeof E=="string"?E:"")),b};return Function.prototype.toString=T(function(){return r(this)&&u(this).source||s(this)},"toString"),Hh.exports}var Vh,Xv;function Dm(){if(Xv)return Vh;Xv=1;var t=ht(),e=Ni(),r=oT(),n=Im();return Vh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Vh}var Wh={},$h,Zv;function hP(){if(Zv)return $h;Zv=1;var t=Math.ceil,e=Math.floor;return $h=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},$h}var Bh,Jv;function Xa(){if(Jv)return Bh;Jv=1;var t=hP();return Bh=function(e){var r=+e;return r!==r||r===0?0:t(r)},Bh}var jh,Qv;function dP(){if(Qv)return jh;Qv=1;var t=Xa(),e=Math.max,r=Math.min;return jh=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},jh}var zh,ey;function fP(){if(ey)return zh;ey=1;var t=Xa(),e=Math.min;return zh=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},zh}var Uh,ty;function Ms(){if(ty)return Uh;ty=1;var t=fP();return Uh=function(e){return t(e.length)},Uh}var Yh,ry;function gP(){if(ry)return Yh;ry=1;var t=qa(),e=dP(),r=Ms(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return Yh={includes:n(!0),indexOf:n(!1)},Yh}var qh,ny;function sT(){if(ny)return qh;ny=1;var t=ot(),e=Br(),r=qa(),n=gP().indexOf,i=Am(),o=t([].push);return qh=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},qh}var Gh,iy;function Nm(){return iy||(iy=1,Gh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Gh}var oy;function mP(){if(oy)return Wh;oy=1;var t=sT(),e=Nm(),r=e.concat("length","prototype");return Wh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},Wh}var Kh={},sy;function pP(){return sy||(sy=1,Kh.f=Object.getOwnPropertySymbols),Kh}var Xh,ay;function wP(){if(ay)return Xh;ay=1;var t=Ts(),e=ot(),r=mP(),n=pP(),i=vt(),o=e([].concat);return Xh=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},Xh}var Zh,ly;function aT(){if(ly)return Zh;ly=1;var t=Br(),e=wP(),r=rT(),n=Ni();return Zh=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},Zh}var Jh,uy;function vP(){if(uy)return Jh;uy=1;var t=ct(),e=ht(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return Jh=n,Jh}var Qh,cy;function Fe(){if(cy)return Qh;cy=1;var t=it(),e=rT().f,r=Os(),n=Dm(),i=Im(),o=aT(),s=vP();return Qh=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,w,v,C,T;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(w in l){if(C=l[w],a.dontCallGetSet?(T=e(g,w),v=T&&T.value):v=g[w],d=s(c?w:u+(h?".":"#")+w,a.forced),!d&&v!==void 0){if(typeof C==typeof v)continue;o(C,v)}(a.sham||v&&v.sham)&&r(C,"sham",!0),n(g,w,C,a)}},Qh}var ed,hy;function Za(){if(hy)return ed;hy=1;var t=Ku(),e=Function.prototype,r=e.apply,n=e.call;return ed=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),ed}var td,dy;function lT(){if(dy)return td;dy=1;var t=ot(),e=Cr();return td=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},td}var rd,fy;function yP(){if(fy)return rd;fy=1;var t=$r();return rd=function(e){return t(e)||e===null},rd}var nd,gy;function bP(){if(gy)return nd;gy=1;var t=yP(),e=String,r=TypeError;return nd=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},nd}var id,my;function uT(){if(my)return id;my=1;var t=lT(),e=$r(),r=Ya(),n=bP();return id=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),id}var od,py;function CP(){if(py)return od;py=1;var t=Ni().f;return od=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},od}var sd,wy;function SP(){if(wy)return sd;wy=1;var t=ht(),e=$r(),r=uT();return sd=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},sd}var ad,vy;function RP(){if(vy)return ad;vy=1;var t=an(),e=t("toStringTag"),r={};return r[e]="z",ad=String(r)==="[object z]",ad}var ld,yy;function cT(){if(yy)return ld;yy=1;var t=RP(),e=ht(),r=Co(),n=an(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return ld=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},ld}var ud,by;function Qu(){if(by)return ud;by=1;var t=cT(),e=String;return ud=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},ud}var cd,Cy;function EP(){if(Cy)return cd;Cy=1;var t=Qu();return cd=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},cd}var hd,Sy;function TP(){if(Sy)return hd;Sy=1;var t=$r(),e=Os();return hd=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},hd}var dd,Ry;function _P(){if(Ry)return dd;Ry=1;var t=ot(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return dd=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},dd}var fd,Ey;function OP(){if(Ey)return fd;Ey=1;var t=ct(),e=Xu();return fd=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),fd}var gd,Ty;function MP(){if(Ty)return gd;Ty=1;var t=Os(),e=_P(),r=OP(),n=Error.captureStackTrace;return gd=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},gd}var md,_y;function IP(){if(_y)return md;_y=1;var t=Ts(),e=Br(),r=Os(),n=Ga(),i=uT(),o=aT(),s=CP(),a=SP(),l=EP(),u=TP(),c=MP(),h=Wr(),d=So();return md=function(g,w,v,C){var T="stackTraceLimit",b=C?2:1,E=g.split("."),y=E[E.length-1],I=t.apply(null,E);if(I){var x=I.prototype;if(!d&&e(x,"cause")&&delete x.cause,!v)return I;var P=t("Error"),A=w(function(F,W){var q=l(C?W:F,void 0),L=C?new I(F):new I;return q!==void 0&&r(L,"message",q),c(L,A,L.stack,2),this&&n(x,this)&&a(L,this,A),arguments.length>b&&u(L,arguments[b]),L});if(A.prototype=x,y!=="Error"?i?i(A,P):o(A,P,{name:!0}):h&&T in I&&(s(A,I,T),s(A,I,"prepareStackTrace")),o(A,I),!d)try{x.name!==y&&r(x,"name",y),x.constructor=A}catch{}return A}},md}var Oy;function PP(){if(Oy)return Qw;Oy=1;var t=Fe(),e=it(),r=Za(),n=IP(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),Qw}PP();var My={},pd,Iy;function hT(){if(Iy)return pd;Iy=1;var t=Co();return pd=Array.isArray||function(r){return t(r)==="Array"},pd}var wd,Py;function dT(){if(Py)return wd;Py=1;var t=Wr(),e=hT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return wd=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},wd}var vd,xy;function fT(){if(xy)return vd;xy=1;var t=TypeError,e=9007199254740991;return vd=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},vd}var Hy;function xP(){if(Hy)return My;Hy=1;var t=Fe(),e=_s(),r=Ms(),n=dT(),i=fT(),o=ct(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var w=0;w<g;w++)h[d]=arguments[w],d++;return n(h,d),d}}),My}xP();var Ay={},yd,Dy;function HP(){if(Dy)return yd;Dy=1;var t=Co(),e=ot();return yd=function(r){if(t(r)==="Function")return e(r)},yd}var bd,Ny;function gT(){if(Ny)return bd;Ny=1;var t=HP(),e=Cr(),r=Ku(),n=t(t.bind);return bd=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},bd}var Cd,ky;function mT(){return ky||(ky=1,Cd={}),Cd}var Sd,Ly;function AP(){if(Ly)return Sd;Ly=1;var t=an(),e=mT(),r=t("iterator"),n=Array.prototype;return Sd=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Sd}var Rd,Fy;function pT(){if(Fy)return Rd;Fy=1;var t=cT(),e=Ka(),r=_m(),n=mT(),i=an(),o=i("iterator");return Rd=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Rd}var Ed,Vy;function DP(){if(Vy)return Ed;Vy=1;var t=wt(),e=Cr(),r=vt(),n=Ju(),i=pT(),o=TypeError;return Ed=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Ed}var Td,Wy;function Sr(){if(Wy)return Td;Wy=1;var t=wt(),e=vt(),r=Ka();return Td=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Td}var _d,$y;function Is(){if($y)return _d;$y=1;var t=gT(),e=wt(),r=vt(),n=Ju(),i=AP(),o=Ms(),s=Ga(),a=DP(),l=pT(),u=Sr(),c=TypeError,h=function(g,w){this.stopped=g,this.result=w},d=h.prototype;return _d=function(g,w,v){var C=v&&v.that,T=!!(v&&v.AS_ENTRIES),b=!!(v&&v.IS_RECORD),E=!!(v&&v.IS_ITERATOR),y=!!(v&&v.INTERRUPTED),I=t(w,C),x,P,A,F,W,q,L,se=function(te){return x&&u(x,"normal"),new h(!0,te)},K=function(te){return T?(r(te),y?I(te[0],te[1],se):I(te[0],te[1])):y?I(te,se):I(te)};if(b)x=g.iterator;else if(E)x=g;else{if(P=l(g),!P)throw new c(n(g)+" is not iterable");if(i(P)){for(A=0,F=o(g);F>A;A++)if(W=K(g[A]),W&&s(d,W))return W;return new h(!1)}x=a(g,P)}for(q=b?g.next:x.next;!(L=e(q,x)).done;){try{W=K(L.value)}catch(te){u(x,"throw",te)}if(typeof W=="object"&&W&&s(d,W))return W}return new h(!1)},_d}var Od,By;function wT(){if(By)return Od;By=1;var t=Wr(),e=Ni(),r=Xu();return Od=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Od}var jy;function NP(){if(jy)return Ay;jy=1;var t=Fe(),e=Is(),r=wT();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),Ay}NP();var zy={},Md,Uy;function On(){if(Uy)return Md;Uy=1;var t=ot(),e=Set.prototype;return Md={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Md}var Id,Yy;function Ro(){if(Yy)return Id;Yy=1;var t=On().has;return Id=function(e){return t(e),e},Id}var Pd,qy;function Eo(){if(qy)return Pd;qy=1;var t=wt();return Pd=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},Pd}var xd,Gy;function Ja(){if(Gy)return xd;Gy=1;var t=ot(),e=Eo(),r=On(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return xd=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},xd}var Hd,Ky;function km(){if(Ky)return Hd;Ky=1;var t=On(),e=Ja(),r=t.Set,n=t.add;return Hd=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},Hd}var Ad,Xy;function Qa(){if(Xy)return Ad;Xy=1;var t=lT(),e=On();return Ad=t(e.proto,"size","get")||function(r){return r.size},Ad}var Dd,Zy;function ki(){return Zy||(Zy=1,Dd=function(t){return{iterator:t,next:t.next,done:!1}}),Dd}var Nd,Jy;function To(){if(Jy)return Nd;Jy=1;var t=Cr(),e=vt(),r=wt(),n=Xa(),i=ki(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},Nd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},Nd}var kd,Qy;function kP(){if(Qy)return kd;Qy=1;var t=Ro(),e=On(),r=km(),n=Qa(),i=To(),o=Ja(),s=Eo(),a=e.has,l=e.remove;return kd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(w){d.includes(w)&&l(g,w)}):s(d.getIterator(),function(w){a(g,w)&&l(g,w)}),g},kd}var Ld,eb;function _o(){if(eb)return Ld;eb=1;var t=Ts(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Ld=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Ld}var tb;function LP(){if(tb)return zy;tb=1;var t=Fe(),e=kP(),r=ct(),n=_o(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),zy}LP();var rb={},Fd,nb;function FP(){if(nb)return Fd;nb=1;var t=Ro(),e=On(),r=Qa(),n=To(),i=Ja(),o=Eo(),s=e.Set,a=e.add,l=e.has;return Fd=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(w){l(h,w)&&a(g,w)}):i(h,function(w){d.includes(w)&&a(g,w)}),g},Fd}var ib;function VP(){if(ib)return rb;ib=1;var t=Fe(),e=ct(),r=FP(),n=_o(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),rb}VP();var ob={},Vd,sb;function WP(){if(sb)return Vd;sb=1;var t=Ro(),e=On().has,r=Qa(),n=To(),i=Ja(),o=Eo(),s=Sr();return Vd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},Vd}var ab;function $P(){if(ab)return ob;ab=1;var t=Fe(),e=WP(),r=_o(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),ob}$P();var lb={},Wd,ub;function BP(){if(ub)return Wd;ub=1;var t=Ro(),e=Qa(),r=Ja(),n=To();return Wd=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Wd}var cb;function jP(){if(cb)return lb;cb=1;var t=Fe(),e=BP(),r=_o(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),lb}jP();var hb={},$d,db;function zP(){if(db)return $d;db=1;var t=Ro(),e=On().has,r=Qa(),n=To(),i=Eo(),o=Sr();return $d=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},$d}var fb;function UP(){if(fb)return hb;fb=1;var t=Fe(),e=zP(),r=_o(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),hb}UP();var gb={},Bd,mb;function YP(){if(mb)return Bd;mb=1;var t=Ro(),e=On(),r=km(),n=To(),i=Eo(),o=e.add,s=e.has,a=e.remove;return Bd=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},Bd}var jd,pb;function vT(){return pb||(pb=1,jd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),jd}var wb;function qP(){if(wb)return gb;wb=1;var t=Fe(),e=YP(),r=vT(),n=_o(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),gb}qP();var vb={},zd,yb;function GP(){if(yb)return zd;yb=1;var t=Ro(),e=On().add,r=km(),n=To(),i=Eo();return zd=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},zd}var bb;function KP(){if(bb)return vb;bb=1;var t=Fe(),e=GP(),r=vT(),n=_o(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),vb}KP();var Cb={},Sb={},Ud,Rb;function XP(){if(Rb)return Ud;Rb=1;var t=Ga(),e=TypeError;return Ud=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},Ud}var Yd,Eb;function ZP(){if(Eb)return Yd;Eb=1;var t=ct();return Yd=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Yd}var qd,Tb;function yT(){if(Tb)return qd;Tb=1;var t=Br(),e=ht(),r=_s(),n=Hm(),i=ZP(),o=n("IE_PROTO"),s=Object,a=s.prototype;return qd=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},qd}var Gd,_b;function JP(){if(_b)return Gd;_b=1;var t=oT(),e=Ni();return Gd=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},Gd}var Kd={},Xd,Ob;function QP(){if(Ob)return Xd;Ob=1;var t=sT(),e=Nm();return Xd=Object.keys||function(n){return t(n,e)},Xd}var Mb;function ex(){if(Mb)return Kd;Mb=1;var t=Wr(),e=nT(),r=Ni(),n=vt(),i=qa(),o=QP();return Kd.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},Kd}var Zd,Ib;function bT(){if(Ib)return Zd;Ib=1;var t=Ts();return Zd=t("document","documentElement"),Zd}var Jd,Pb;function Lm(){if(Pb)return Jd;Pb=1;var t=vt(),e=ex(),r=Nm(),n=Am(),i=bT(),o=xm(),s=Hm(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(b){return l+c+a+b+l+"/"+c+a},w=function(b){b.write(g("")),b.close();var E=b.parentWindow.Object;return b=null,E},v=function(){var b=o("iframe"),E="java"+c+":",y;return b.style.display="none",i.appendChild(b),b.src=String(E),y=b.contentWindow.document,y.open(),y.write(g("document.F=Object")),y.close(),y.F},C,T=function(){try{C=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&C?w(C):v():w(C);for(var b=r.length;b--;)delete T[u][r[b]];return T()};return n[h]=!0,Jd=Object.create||function(E,y){var I;return E!==null?(d[u]=t(E),I=new d,d[u]=null,I[h]=E):I=T(),y===void 0?I:e.f(I,y)},Jd}var Qd,xb;function CT(){if(xb)return Qd;xb=1;var t=ct(),e=ht(),r=$r(),n=Lm(),i=yT(),o=Dm(),s=an(),a=So(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),Qd={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Qd}var Hb;function tx(){if(Hb)return Sb;Hb=1;var t=Fe(),e=it(),r=XP(),n=vt(),i=ht(),o=yT(),s=JP(),a=wT(),l=ct(),u=Br(),c=an(),h=CT().IteratorPrototype,d=Wr(),g=So(),w="constructor",v="Iterator",C=c("toStringTag"),T=TypeError,b=e[v],E=g||!i(b)||b.prototype!==h||!l(function(){b({})}),y=function(){if(r(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},I=function(x,P){d?s(h,x,{configurable:!0,get:function(){return P},set:function(A){if(n(this),this===h)throw new T("You can't redefine this property");u(this,x)?this[x]=A:a(this,x,A)}}):h[x]=P};return u(h,C)||I(C,v),(E||!u(h,w)||h[w]===Object)&&I(w,y),y.prototype=h,t({global:!0,constructor:!0,forced:E},{Iterator:y}),Sb}var Ab;function rx(){return Ab||(Ab=1,tx()),Cb}rx();var Db={},Nb={},ef,kb;function nx(){if(kb)return ef;kb=1;var t=Dm();return ef=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},ef}var tf,Lb;function ix(){return Lb||(Lb=1,tf=function(t,e){return{value:t,done:e}}),tf}var rf,Fb;function ox(){if(Fb)return rf;Fb=1;var t=Sr();return rf=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},rf}var nf,Vb;function ST(){if(Vb)return nf;Vb=1;var t=wt(),e=Lm(),r=Os(),n=nx(),i=an(),o=iT(),s=Ka(),a=CT().IteratorPrototype,l=ix(),u=Sr(),c=ox(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",w="normal",v="throw",C=o.set,T=function(y){var I=o.getterFor(y?g:d);return n(e(a),{next:function(){var P=I(this);if(y)return P.nextHandler();if(P.done)return l(void 0,!0);try{var A=P.nextHandler();return P.returnHandlerResult?A:l(A,P.done)}catch(F){throw P.done=!0,F}},return:function(){var x=I(this),P=x.iterator;if(x.done=!0,y){var A=s(P,"return");return A?t(A,P):l(void 0,!0)}if(x.inner)try{u(x.inner.iterator,w)}catch(F){return u(P,v,F)}if(x.openIters)try{c(x.openIters,w)}catch(F){return u(P,v,F)}return P&&u(P,w),l(void 0,!0)}})},b=T(!0),E=T(!1);return r(E,h,"Iterator Helper"),nf=function(y,I,x){var P=function(F,W){W?(W.iterator=F.iterator,W.next=F.next):W=F,W.type=I?g:d,W.returnHandlerResult=!!x,W.nextHandler=y,W.counter=0,W.done=!1,C(this,W)};return P.prototype=I?b:E,P},nf}var of,Wb;function RT(){if(Wb)return of;Wb=1;var t=vt(),e=Sr();return of=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},of}var sf,$b;function ET(){return $b||($b=1,sf=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),sf}var af,Bb;function Oo(){if(Bb)return af;Bb=1;var t=it();return af=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},af}var jb;function sx(){if(jb)return Nb;jb=1;var t=Fe(),e=wt(),r=Cr(),n=vt(),i=ki(),o=ST(),s=RT(),a=So(),l=Sr(),u=ET(),c=Oo(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,w=o(function(){for(var v=this.iterator,C=this.predicate,T=this.next,b,E,y;;){if(b=n(e(T,v)),E=this.done=!!b.done,E)return;if(y=b.value,s(v,C,[y,this.counter++],!0))return y}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(C){n(this);try{r(C)}catch(T){l(this,"throw",T)}return d?e(d,this,C):new w(i(this),{predicate:C})}}),Nb}var zb;function ax(){return zb||(zb=1,sx()),Db}ax();var Ub={},Yb={},qb;function lx(){if(qb)return Yb;qb=1;var t=Fe(),e=wt(),r=Is(),n=Cr(),i=vt(),o=ki(),s=Sr(),a=Oo(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),Yb}var Gb;function ux(){return Gb||(Gb=1,lx()),Ub}ux();var Kb={},Xb={},Zb;function cx(){if(Zb)return Xb;Zb=1;var t=Fe(),e=wt(),r=Cr(),n=vt(),i=ki(),o=ST(),s=RT(),a=Sr(),l=ET(),u=Oo(),c=So(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,w=o(function(){var v=this.iterator,C=n(e(this.next,v)),T=this.done=!!C.done;if(!T)return s(v,this.mapper,[C.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(C){n(this);try{r(C)}catch(T){a(this,"throw",T)}return d?e(d,this,C):new w(i(this),{mapper:C})}}),Xb}var Jb;function hx(){return Jb||(Jb=1,cx()),Kb}hx();var Qb={},eC={},lf,tC;function Fm(){if(tC)return lf;tC=1;var t=ot();return lf=t([].slice),lf}var uf,rC;function TT(){if(rC)return uf;rC=1;var t=TypeError;return uf=function(e,r){if(e<r)throw new t("Not enough arguments");return e},uf}var cf,nC;function dx(){if(nC)return cf;nC=1;var t=Zu();return cf=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),cf}var hf,iC;function _T(){if(iC)return hf;iC=1;var t=it(),e=Zu(),r=Co(),n=function(i){return e.slice(0,i.length)===i};return hf=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),hf}var df,oC;function fx(){if(oC)return df;oC=1;var t=_T();return df=t==="NODE",df}var ff,sC;function OT(){if(sC)return ff;sC=1;var t=it(),e=Za(),r=gT(),n=ht(),i=Br(),o=ct(),s=bT(),a=Fm(),l=xm(),u=TT(),c=dx(),h=fx(),d=t.setImmediate,g=t.clearImmediate,w=t.process,v=t.Dispatch,C=t.Function,T=t.MessageChannel,b=t.String,E=0,y={},I="onreadystatechange",x,P,A,F;o(function(){x=t.location});var W=function(K){if(i(y,K)){var te=y[K];delete y[K],te()}},q=function(K){return function(){W(K)}},L=function(K){W(K.data)},se=function(K){t.postMessage(b(K),x.protocol+"//"+x.host)};return(!d||!g)&&(d=function(te){u(arguments.length,1);var dt=n(te)?te:C(te),Re=a(arguments,1);return y[++E]=function(){e(dt,void 0,Re)},P(E),E},g=function(te){delete y[te]},h?P=function(K){w.nextTick(q(K))}:v&&v.now?P=function(K){v.now(q(K))}:T&&!c?(A=new T,F=A.port2,A.port1.onmessage=L,P=r(F.postMessage,F)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&x&&x.protocol!=="file:"&&!o(se)?(P=se,t.addEventListener("message",L,!1)):I in l("script")?P=function(K){s.appendChild(l("script"))[I]=function(){s.removeChild(this),W(K)}}:P=function(K){setTimeout(q(K),0)}),ff={set:d,clear:g},ff}var aC;function gx(){if(aC)return eC;aC=1;var t=Fe(),e=it(),r=OT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),eC}var lC={},gf,uC;function mx(){if(uC)return gf;uC=1;var t=it(),e=Za(),r=ht(),n=_T(),i=Zu(),o=Fm(),s=TT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return gf=function(u,c){var h=c?2:1;return l?function(d,g){var w=s(arguments.length,1)>h,v=r(d)?d:a(d),C=w?o(arguments,h):[],T=w?function(){e(v,this,C)}:v;return c?u(T,g):u(T)}:u},gf}var cC;function px(){if(cC)return lC;cC=1;var t=Fe(),e=it(),r=OT().set,n=mx(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),lC}var hC;function wx(){return hC||(hC=1,gx(),px()),Qb}wx();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:MT,setPrototypeOf:dC,isFrozen:vx,getPrototypeOf:yx,getOwnPropertyDescriptor:bx}=Object;let{freeze:zt,seal:Lr,create:IT}=Object,{apply:Dg,construct:Ng}=typeof Reflect<"u"&&Reflect;zt||(zt=function(e){return e});Lr||(Lr=function(e){return e});Dg||(Dg=function(e,r,n){return e.apply(r,n)});Ng||(Ng=function(e,r){return new e(...r)});const gl=Ut(Array.prototype.forEach),Cx=Ut(Array.prototype.lastIndexOf),fC=Ut(Array.prototype.pop),Ls=Ut(Array.prototype.push),Sx=Ut(Array.prototype.splice),lu=Ut(String.prototype.toLowerCase),mf=Ut(String.prototype.toString),gC=Ut(String.prototype.match),Fs=Ut(String.prototype.replace),Rx=Ut(String.prototype.indexOf),Ex=Ut(String.prototype.trim),Qr=Ut(Object.prototype.hasOwnProperty),Nt=Ut(RegExp.prototype.test),Vs=Tx(TypeError);function Ut(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Dg(t,e,n)}}function Tx(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Ng(t,r)}}function ce(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lu;dC&&dC(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(vx(e)||(e[n]=o),i=o)}t[i]=!0}return t}function _x(t){for(let e=0;e<t.length;e++)Qr(t,e)||(t[e]=null);return t}function jn(t){const e=IT(null);for(const[r,n]of MT(t))Qr(t,r)&&(Array.isArray(n)?e[r]=_x(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=jn(n):e[r]=n);return e}function Ws(t,e){for(;t!==null;){const n=bx(t,e);if(n){if(n.get)return Ut(n.get);if(typeof n.value=="function")return Ut(n.value)}t=yx(t)}function r(){return null}return r}const mC=zt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),pf=zt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),wf=zt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ox=zt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),vf=zt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Mx=zt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),pC=zt(["#text"]),wC=zt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),yf=zt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),vC=zt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ml=zt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ix=Lr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Px=Lr(/<%[\w\W]*|[\w\W]*%>/gm),xx=Lr(/\$\{[\w\W]*/gm),Hx=Lr(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ax=Lr(/^aria-[\-\w]+$/),PT=Lr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Dx=Lr(/^(?:\w+script|data):/i),Nx=Lr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),xT=Lr(/^html$/i),kx=Lr(/^[a-z][.\w]*(-[.\w]+)+$/i);var yC=Object.freeze({__proto__:null,ARIA_ATTR:Ax,ATTR_WHITESPACE:Nx,CUSTOM_ELEMENT:kx,DATA_ATTR:Hx,DOCTYPE_NAME:xT,ERB_EXPR:Px,IS_ALLOWED_URI:PT,IS_SCRIPT_OR_DATA:Dx,MUSTACHE_EXPR:Ix,TMPLIT_EXPR:xx});const $s={element:1,text:3,progressingInstruction:7,comment:8,document:9},Lx=function(){return typeof window>"u"?null:window},Fx=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},bC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function HT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lx();const e=Z=>HT(Z);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==$s.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,w=l.prototype,v=Ws(w,"cloneNode"),C=Ws(w,"remove"),T=Ws(w,"nextSibling"),b=Ws(w,"childNodes"),E=Ws(w,"parentNode");if(typeof s=="function"){const Z=r.createElement("template");Z.content&&Z.content.ownerDocument&&(r=Z.content.ownerDocument)}let y,I="";const{implementation:x,createNodeIterator:P,createDocumentFragment:A,getElementsByTagName:F}=r,{importNode:W}=n;let q=bC();e.isSupported=typeof MT=="function"&&typeof E=="function"&&x&&x.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:se,TMPLIT_EXPR:K,DATA_ATTR:te,ARIA_ATTR:dt,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ee,CUSTOM_ELEMENT:Ye}=yC;let{IS_ALLOWED_URI:$e}=yC,Ie=null;const cn=ce({},[...mC,...pf,...wf,...vf,...pC]);let Te=null;const f=ce({},[...wC,...yf,...vC,...ml]);let m=Object.seal(IT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),p=null,R=null,_=!0,O=!0,H=!1,k=!0,U=!1,$=!0,M=!1,B=!1,Q=!1,ie=!1,ye=!1,ae=!1,de=!0,Ae=!1;const me="user-content-";let ke=!0,Et=!1,Ht={},ar=null;const Hn=ce({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let At=null;const yt=ce({},["audio","video","img","source","image","track"]);let lr=null;const ii=ce({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Yr="http://www.w3.org/1998/Math/MathML",Fi="http://www.w3.org/2000/svg",Er="http://www.w3.org/1999/xhtml";let hn=Er,ur=!1,oi=null;const si=ce({},[Yr,Fi,Er],mf);let dn=ce({},["mi","mo","mn","ms","mtext"]),ai=ce({},["annotation-xml"]);const Tr=ce({},["title","style","font","a","script"]);let bt=null;const hl=["application/xhtml+xml","text/html"],dl="text/html";let mt=null,Ho=null;const VM=r.createElement("form"),Iw=function(S){return S instanceof RegExp||S instanceof Function},kc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ho&&Ho===S)){if((!S||typeof S!="object")&&(S={}),S=jn(S),bt=hl.indexOf(S.PARSER_MEDIA_TYPE)===-1?dl:S.PARSER_MEDIA_TYPE,mt=bt==="application/xhtml+xml"?mf:lu,Ie=Qr(S,"ALLOWED_TAGS")?ce({},S.ALLOWED_TAGS,mt):cn,Te=Qr(S,"ALLOWED_ATTR")?ce({},S.ALLOWED_ATTR,mt):f,oi=Qr(S,"ALLOWED_NAMESPACES")?ce({},S.ALLOWED_NAMESPACES,mf):si,lr=Qr(S,"ADD_URI_SAFE_ATTR")?ce(jn(ii),S.ADD_URI_SAFE_ATTR,mt):ii,At=Qr(S,"ADD_DATA_URI_TAGS")?ce(jn(yt),S.ADD_DATA_URI_TAGS,mt):yt,ar=Qr(S,"FORBID_CONTENTS")?ce({},S.FORBID_CONTENTS,mt):Hn,p=Qr(S,"FORBID_TAGS")?ce({},S.FORBID_TAGS,mt):jn({}),R=Qr(S,"FORBID_ATTR")?ce({},S.FORBID_ATTR,mt):jn({}),Ht=Qr(S,"USE_PROFILES")?S.USE_PROFILES:!1,_=S.ALLOW_ARIA_ATTR!==!1,O=S.ALLOW_DATA_ATTR!==!1,H=S.ALLOW_UNKNOWN_PROTOCOLS||!1,k=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,U=S.SAFE_FOR_TEMPLATES||!1,$=S.SAFE_FOR_XML!==!1,M=S.WHOLE_DOCUMENT||!1,ie=S.RETURN_DOM||!1,ye=S.RETURN_DOM_FRAGMENT||!1,ae=S.RETURN_TRUSTED_TYPE||!1,Q=S.FORCE_BODY||!1,de=S.SANITIZE_DOM!==!1,Ae=S.SANITIZE_NAMED_PROPS||!1,ke=S.KEEP_CONTENT!==!1,Et=S.IN_PLACE||!1,$e=S.ALLOWED_URI_REGEXP||PT,hn=S.NAMESPACE||Er,dn=S.MATHML_TEXT_INTEGRATION_POINTS||dn,ai=S.HTML_INTEGRATION_POINTS||ai,m=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&Iw(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(m.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&Iw(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(m.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(m.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),U&&(O=!1),ye&&(ie=!0),Ht&&(Ie=ce({},pC),Te=[],Ht.html===!0&&(ce(Ie,mC),ce(Te,wC)),Ht.svg===!0&&(ce(Ie,pf),ce(Te,yf),ce(Te,ml)),Ht.svgFilters===!0&&(ce(Ie,wf),ce(Te,yf),ce(Te,ml)),Ht.mathMl===!0&&(ce(Ie,vf),ce(Te,vC),ce(Te,ml))),S.ADD_TAGS&&(Ie===cn&&(Ie=jn(Ie)),ce(Ie,S.ADD_TAGS,mt)),S.ADD_ATTR&&(Te===f&&(Te=jn(Te)),ce(Te,S.ADD_ATTR,mt)),S.ADD_URI_SAFE_ATTR&&ce(lr,S.ADD_URI_SAFE_ATTR,mt),S.FORBID_CONTENTS&&(ar===Hn&&(ar=jn(ar)),ce(ar,S.FORBID_CONTENTS,mt)),ke&&(Ie["#text"]=!0),M&&ce(Ie,["html","head","body"]),Ie.table&&(ce(Ie,["tbody"]),delete p.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Vs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Vs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=S.TRUSTED_TYPES_POLICY,I=y.createHTML("")}else y===void 0&&(y=Fx(g,i)),y!==null&&typeof I=="string"&&(I=y.createHTML(""));zt&&zt(S),Ho=S}},Pw=ce({},[...pf,...wf,...Ox]),xw=ce({},[...vf,...Mx]),WM=function(S){let N=E(S);(!N||!N.tagName)&&(N={namespaceURI:hn,tagName:"template"});const G=lu(S.tagName),Be=lu(N.tagName);return oi[S.namespaceURI]?S.namespaceURI===Fi?N.namespaceURI===Er?G==="svg":N.namespaceURI===Yr?G==="svg"&&(Be==="annotation-xml"||dn[Be]):!!Pw[G]:S.namespaceURI===Yr?N.namespaceURI===Er?G==="math":N.namespaceURI===Fi?G==="math"&&ai[Be]:!!xw[G]:S.namespaceURI===Er?N.namespaceURI===Fi&&!ai[Be]||N.namespaceURI===Yr&&!dn[Be]?!1:!xw[G]&&(Tr[G]||!Pw[G]):!!(bt==="application/xhtml+xml"&&oi[S.namespaceURI]):!1},fn=function(S){Ls(e.removed,{element:S});try{E(S).removeChild(S)}catch{C(S)}},Ao=function(S,N){try{Ls(e.removed,{attribute:N.getAttributeNode(S),from:N})}catch{Ls(e.removed,{attribute:null,from:N})}if(N.removeAttribute(S),S==="is")if(ie||ye)try{fn(N)}catch{}else try{N.setAttribute(S,"")}catch{}},Hw=function(S){let N=null,G=null;if(Q)S="<remove></remove>"+S;else{const ft=gC(S,/^[\r\n\t ]+/);G=ft&&ft[0]}bt==="application/xhtml+xml"&&hn===Er&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const Be=y?y.createHTML(S):S;if(hn===Er)try{N=new d().parseFromString(Be,bt)}catch{}if(!N||!N.documentElement){N=x.createDocument(hn,"template",null);try{N.documentElement.innerHTML=ur?I:Be}catch{}}const Tt=N.body||N.documentElement;return S&&G&&Tt.insertBefore(r.createTextNode(G),Tt.childNodes[0]||null),hn===Er?F.call(N,M?"html":"body")[0]:M?N.documentElement:Tt},Aw=function(S){return P.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Lc=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},Dw=function(S){return typeof a=="function"&&S instanceof a};function An(Z,S,N){gl(Z,G=>{G.call(e,S,N,Ho)})}const Nw=function(S){let N=null;if(An(q.beforeSanitizeElements,S,null),Lc(S))return fn(S),!0;const G=mt(S.nodeName);if(An(q.uponSanitizeElement,S,{tagName:G,allowedTags:Ie}),$&&S.hasChildNodes()&&!Dw(S.firstElementChild)&&Nt(/<[/\w!]/g,S.innerHTML)&&Nt(/<[/\w!]/g,S.textContent)||S.nodeType===$s.progressingInstruction||$&&S.nodeType===$s.comment&&Nt(/<[/\w]/g,S.data))return fn(S),!0;if(!Ie[G]||p[G]){if(!p[G]&&Lw(G)&&(m.tagNameCheck instanceof RegExp&&Nt(m.tagNameCheck,G)||m.tagNameCheck instanceof Function&&m.tagNameCheck(G)))return!1;if(ke&&!ar[G]){const Be=E(S)||S.parentNode,Tt=b(S)||S.childNodes;if(Tt&&Be){const ft=Tt.length;for(let Yt=ft-1;Yt>=0;--Yt){const Dn=v(Tt[Yt],!0);Dn.__removalCount=(S.__removalCount||0)+1,Be.insertBefore(Dn,T(S))}}}return fn(S),!0}return S instanceof l&&!WM(S)||(G==="noscript"||G==="noembed"||G==="noframes")&&Nt(/<\/no(script|embed|frames)/i,S.innerHTML)?(fn(S),!0):(U&&S.nodeType===$s.text&&(N=S.textContent,gl([L,se,K],Be=>{N=Fs(N,Be," ")}),S.textContent!==N&&(Ls(e.removed,{element:S.cloneNode()}),S.textContent=N)),An(q.afterSanitizeElements,S,null),!1)},kw=function(S,N,G){if(de&&(N==="id"||N==="name")&&(G in r||G in VM))return!1;if(!(O&&!R[N]&&Nt(te,N))){if(!(_&&Nt(dt,N))){if(!Te[N]||R[N]){if(!(Lw(S)&&(m.tagNameCheck instanceof RegExp&&Nt(m.tagNameCheck,S)||m.tagNameCheck instanceof Function&&m.tagNameCheck(S))&&(m.attributeNameCheck instanceof RegExp&&Nt(m.attributeNameCheck,N)||m.attributeNameCheck instanceof Function&&m.attributeNameCheck(N))||N==="is"&&m.allowCustomizedBuiltInElements&&(m.tagNameCheck instanceof RegExp&&Nt(m.tagNameCheck,G)||m.tagNameCheck instanceof Function&&m.tagNameCheck(G))))return!1}else if(!lr[N]){if(!Nt($e,Fs(G,Ee,""))){if(!((N==="src"||N==="xlink:href"||N==="href")&&S!=="script"&&Rx(G,"data:")===0&&At[S])){if(!(H&&!Nt(Re,Fs(G,Ee,"")))){if(G)return!1}}}}}}return!0},Lw=function(S){return S!=="annotation-xml"&&gC(S,Ye)},Fw=function(S){An(q.beforeSanitizeAttributes,S,null);const{attributes:N}=S;if(!N||Lc(S))return;const G={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te,forceKeepAttr:void 0};let Be=N.length;for(;Be--;){const Tt=N[Be],{name:ft,namespaceURI:Yt,value:Dn}=Tt,Ns=mt(ft),Fc=Dn;let _t=ft==="value"?Fc:Ex(Fc);if(G.attrName=Ns,G.attrValue=_t,G.keepAttr=!0,G.forceKeepAttr=void 0,An(q.uponSanitizeAttribute,S,G),_t=G.attrValue,Ae&&(Ns==="id"||Ns==="name")&&(Ao(ft,S),_t=me+_t),$&&Nt(/((--!?|])>)|<\/(style|title)/i,_t)){Ao(ft,S);continue}if(G.forceKeepAttr)continue;if(!G.keepAttr){Ao(ft,S);continue}if(!k&&Nt(/\/>/i,_t)){Ao(ft,S);continue}U&&gl([L,se,K],Ww=>{_t=Fs(_t,Ww," ")});const Vw=mt(S.nodeName);if(!kw(Vw,Ns,_t)){Ao(ft,S);continue}if(y&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Yt)switch(g.getAttributeType(Vw,Ns)){case"TrustedHTML":{_t=y.createHTML(_t);break}case"TrustedScriptURL":{_t=y.createScriptURL(_t);break}}if(_t!==Fc)try{Yt?S.setAttributeNS(Yt,ft,_t):S.setAttribute(ft,_t),Lc(S)?fn(S):fC(e.removed)}catch{Ao(ft,S)}}An(q.afterSanitizeAttributes,S,null)},$M=function Z(S){let N=null;const G=Aw(S);for(An(q.beforeSanitizeShadowDOM,S,null);N=G.nextNode();)An(q.uponSanitizeShadowNode,N,null),Nw(N),Fw(N),N.content instanceof o&&Z(N.content);An(q.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(Z){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=null,G=null,Be=null,Tt=null;if(ur=!Z,ur&&(Z="<!-->"),typeof Z!="string"&&!Dw(Z))if(typeof Z.toString=="function"){if(Z=Z.toString(),typeof Z!="string")throw Vs("dirty is not a string, aborting")}else throw Vs("toString is not a function");if(!e.isSupported)return Z;if(B||kc(S),e.removed=[],typeof Z=="string"&&(Et=!1),Et){if(Z.nodeName){const Dn=mt(Z.nodeName);if(!Ie[Dn]||p[Dn])throw Vs("root node is forbidden and cannot be sanitized in-place")}}else if(Z instanceof a)N=Hw("<!---->"),G=N.ownerDocument.importNode(Z,!0),G.nodeType===$s.element&&G.nodeName==="BODY"||G.nodeName==="HTML"?N=G:N.appendChild(G);else{if(!ie&&!U&&!M&&Z.indexOf("<")===-1)return y&&ae?y.createHTML(Z):Z;if(N=Hw(Z),!N)return ie?null:ae?I:""}N&&Q&&fn(N.firstChild);const ft=Aw(Et?Z:N);for(;Be=ft.nextNode();)Nw(Be),Fw(Be),Be.content instanceof o&&$M(Be.content);if(Et)return Z;if(ie){if(ye)for(Tt=A.call(N.ownerDocument);N.firstChild;)Tt.appendChild(N.firstChild);else Tt=N;return(Te.shadowroot||Te.shadowrootmode)&&(Tt=W.call(n,Tt,!0)),Tt}let Yt=M?N.outerHTML:N.innerHTML;return M&&Ie["!doctype"]&&N.ownerDocument&&N.ownerDocument.doctype&&N.ownerDocument.doctype.name&&Nt(xT,N.ownerDocument.doctype.name)&&(Yt="<!DOCTYPE "+N.ownerDocument.doctype.name+`>
`+Yt),U&&gl([L,se,K],Dn=>{Yt=Fs(Yt,Dn," ")}),y&&ae?y.createHTML(Yt):Yt},e.setConfig=function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};kc(Z),B=!0},e.clearConfig=function(){Ho=null,B=!1},e.isValidAttribute=function(Z,S,N){Ho||kc({});const G=mt(Z),Be=mt(S);return kw(G,Be,N)},e.addHook=function(Z,S){typeof S=="function"&&Ls(q[Z],S)},e.removeHook=function(Z,S){if(S!==void 0){const N=Cx(q[Z],S);return N===-1?void 0:Sx(q[Z],N,1)[0]}return fC(q[Z])},e.removeHooks=function(Z){q[Z]=[]},e.removeAllHooks=function(){q=bC()},e}var Vx=HT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var AT;function V(){return AT.apply(null,arguments)}function Wx(t){AT=t}function on(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function uo(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ce(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Vm(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ce(t,e))return!1;return!0}function Jt(t){return t===void 0}function Qn(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function el(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function DT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Si(t,e){for(var r in e)Ce(e,r)&&(t[r]=e[r]);return Ce(e,"toString")&&(t.toString=e.toString),Ce(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Mn(t,e,r,n){return n_(t,e,r,n,!0).utc()}function $x(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function oe(t){return t._pf==null&&(t._pf=$x()),t._pf}var kg;Array.prototype.some?kg=Array.prototype.some:kg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function Wm(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=oe(t),r=kg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function ec(t){var e=Mn(NaN);return t!=null?Si(oe(e),t):oe(e).userInvalidated=!0,e}var CC=V.momentProperties=[],bf=!1;function $m(t,e){var r,n,i,o=CC.length;if(Jt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Jt(e._i)||(t._i=e._i),Jt(e._f)||(t._f=e._f),Jt(e._l)||(t._l=e._l),Jt(e._strict)||(t._strict=e._strict),Jt(e._tzm)||(t._tzm=e._tzm),Jt(e._isUTC)||(t._isUTC=e._isUTC),Jt(e._offset)||(t._offset=e._offset),Jt(e._pf)||(t._pf=oe(e)),Jt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=CC[r],i=e[n],Jt(i)||(t[n]=i);return t}function tl(t){$m(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),bf===!1&&(bf=!0,V.updateOffset(this),bf=!1)}function sn(t){return t instanceof tl||t!=null&&t._isAMomentObject!=null}function NT(t){V.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function jr(t,e){var r=!0;return Si(function(){if(V.deprecationHandler!=null&&V.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Ce(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}NT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var SC={};function kT(t,e){V.deprecationHandler!=null&&V.deprecationHandler(t,e),SC[t]||(NT(e),SC[t]=!0)}V.suppressDeprecationWarnings=!1;V.deprecationHandler=null;function In(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Bx(t){var e,r;for(r in t)Ce(t,r)&&(e=t[r],In(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Lg(t,e){var r=Si({},t),n;for(n in e)Ce(e,n)&&(uo(t[n])&&uo(e[n])?(r[n]={},Si(r[n],t[n]),Si(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Ce(t,n)&&!Ce(e,n)&&uo(t[n])&&(r[n]=Si({},r[n]));return r}function Bm(t){t!=null&&this.set(t)}var Fg;Object.keys?Fg=Object.keys:Fg=function(t){var e,r=[];for(e in t)Ce(t,e)&&r.push(e);return r};var jx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function zx(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return In(n)?n.call(e,r):n}function Tn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var jm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,pl=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Cf={},cs={};function J(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(cs[t]=i),e&&(cs[e[0]]=function(){return Tn(i.apply(this,arguments),e[1],e[2])}),r&&(cs[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Ux(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Yx(t){var e=t.match(jm),r,n;for(r=0,n=e.length;r<n;r++)cs[e[r]]?e[r]=cs[e[r]]:e[r]=Ux(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=In(e[s])?e[s].call(i,t):e[s];return o}}function uu(t,e){return t.isValid()?(e=LT(e,t.localeData()),Cf[e]=Cf[e]||Yx(e),Cf[e](t)):t.localeData().invalidDate()}function LT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(pl.lastIndex=0;r>=0&&pl.test(t);)t=t.replace(pl,n),pl.lastIndex=0,r-=1;return t}var qx={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Gx(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(jm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var Kx="Invalid date";function Xx(){return this._invalidDate}var Zx="%d",Jx=/\d{1,2}/;function Qx(t){return this._ordinal.replace("%d",t)}var eH={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function tH(t,e,r,n){var i=this._relativeTime[r];return In(i)?i(t,e,r,n):i.replace(/%d/i,t)}function rH(t,e){var r=this._relativeTime[t>0?"future":"past"];return In(r)?r(e):r.replace(/%s/i,e)}var RC={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function zr(t){return typeof t=="string"?RC[t]||RC[t.toLowerCase()]:void 0}function zm(t){var e={},r,n;for(n in t)Ce(t,n)&&(r=zr(n),r&&(e[r]=t[n]));return e}var nH={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function iH(t){var e=[],r;for(r in t)Ce(t,r)&&e.push({unit:r,priority:nH[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var FT=/\d/,Rr=/\d\d/,VT=/\d{3}/,Um=/\d{4}/,tc=/[+-]?\d{6}/,We=/\d\d?/,WT=/\d\d\d\d?/,$T=/\d\d\d\d\d\d?/,rc=/\d{1,3}/,Ym=/\d{1,4}/,nc=/[+-]?\d{1,6}/,Ps=/\d+/,ic=/[+-]?\d+/,oH=/Z|[+-]\d\d:?\d\d/gi,oc=/Z|[+-]\d\d(?::?\d\d)?/gi,sH=/[+-]?\d+(\.\d{1,3})?/,rl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,xs=/^[1-9]\d?/,qm=/^([1-9]\d|\d)/,Ou;Ou={};function z(t,e,r){Ou[t]=In(e)?e:function(n,i){return n&&r?r:e}}function aH(t,e){return Ce(Ou,t)?Ou[t](e._strict,e._locale):new RegExp(lH(t))}function lH(t){return Zn(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function Zn(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ar(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ge(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Ar(e)),r}var Vg={};function Ne(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Qn(e)&&(n=function(o,s){s[e]=ge(o)}),i=t.length,r=0;r<i;r++)Vg[t[r]]=n}function nl(t,e){Ne(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function uH(t,e,r){e!=null&&Ce(Vg,t)&&Vg[t](e,r._a,r,t)}function sc(t){return t%4===0&&t%100!==0||t%400===0}var xt=0,Gn=1,Sn=2,gt=3,rn=4,Kn=5,oo=6,cH=7,hH=8;J("Y",0,0,function(){var t=this.year();return t<=9999?Tn(t,4):"+"+t});J(0,["YY",2],0,function(){return this.year()%100});J(0,["YYYY",4],0,"year");J(0,["YYYYY",5],0,"year");J(0,["YYYYYY",6,!0],0,"year");z("Y",ic);z("YY",We,Rr);z("YYYY",Ym,Um);z("YYYYY",nc,tc);z("YYYYYY",nc,tc);Ne(["YYYYY","YYYYYY"],xt);Ne("YYYY",function(t,e){e[xt]=t.length===2?V.parseTwoDigitYear(t):ge(t)});Ne("YY",function(t,e){e[xt]=V.parseTwoDigitYear(t)});Ne("Y",function(t,e){e[xt]=parseInt(t,10)});function _a(t){return sc(t)?366:365}V.parseTwoDigitYear=function(t){return ge(t)+(ge(t)>68?1900:2e3)};var BT=Hs("FullYear",!0);function dH(){return sc(this.year())}function Hs(t,e){return function(r){return r!=null?(jT(this,t,r),V.updateOffset(this,e),this):Na(this,t)}}function Na(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function jT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!sc(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function fH(t){return t=zr(t),In(this[t])?this[t]():this}function gH(t,e){if(typeof t=="object"){t=zm(t);var r=iH(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=zr(t),In(this[t]))return this[t](e);return this}function mH(t,e){return(t%e+e)%e}var rt;Array.prototype.indexOf?rt=Array.prototype.indexOf:rt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Gm(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=mH(e,12);return t+=(e-r)/12,r===1?sc(t)?29:28:31-r%7%2}J("M",["MM",2],"Mo",function(){return this.month()+1});J("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});J("MMMM",0,0,function(t){return this.localeData().months(this,t)});z("M",We,xs);z("MM",We,Rr);z("MMM",function(t,e){return e.monthsShortRegex(t)});z("MMMM",function(t,e){return e.monthsRegex(t)});Ne(["M","MM"],function(t,e){e[Gn]=ge(t)-1});Ne(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Gn]=i:oe(r).invalidMonth=t});var pH="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),zT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),UT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,wH=rl,vH=rl;function yH(t,e){return t?on(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||UT).test(e)?"format":"standalone"][t.month()]:on(this._months)?this._months:this._months.standalone}function bH(t,e){return t?on(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[UT.test(e)?"format":"standalone"][t.month()]:on(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function CH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Mn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=rt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=rt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=rt.call(this._shortMonthsParse,s),i!==-1?i:(i=rt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=rt.call(this._longMonthsParse,s),i!==-1?i:(i=rt.call(this._shortMonthsParse,s),i!==-1?i:null))}function SH(t,e,r){var n,i,o;if(this._monthsParseExact)return CH.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Mn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function YT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ge(e);else if(e=t.localeData().monthsParse(e),!Qn(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,Gm(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function qT(t){return t!=null?(YT(this,t),V.updateOffset(this,!0),this):Na(this,"Month")}function RH(){return Gm(this.year(),this.month())}function EH(t){return this._monthsParseExact?(Ce(this,"_monthsRegex")||GT.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ce(this,"_monthsShortRegex")||(this._monthsShortRegex=wH),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function TH(t){return this._monthsParseExact?(Ce(this,"_monthsRegex")||GT.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ce(this,"_monthsRegex")||(this._monthsRegex=vH),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function GT(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=Mn([2e3,i]),s=Zn(this.monthsShort(o,"")),a=Zn(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function _H(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function ka(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Mu(t,e,r){var n=7+e-r,i=(7+ka(t,0,n).getUTCDay()-e)%7;return-i+n-1}function KT(t,e,r,n,i){var o=(7+r-n)%7,s=Mu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=_a(l)+a):a>_a(t)?(l=t+1,u=a-_a(t)):(l=t,u=a),{year:l,dayOfYear:u}}function La(t,e,r){var n=Mu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Jn(s,e,r)):i>Jn(t.year(),e,r)?(o=i-Jn(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Jn(t,e,r){var n=Mu(t,e,r),i=Mu(t+1,e,r);return(_a(t)-n+i)/7}J("w",["ww",2],"wo","week");J("W",["WW",2],"Wo","isoWeek");z("w",We,xs);z("ww",We,Rr);z("W",We,xs);z("WW",We,Rr);nl(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=ge(t)});function OH(t){return La(t,this._week.dow,this._week.doy).week}var MH={dow:0,doy:6};function IH(){return this._week.dow}function PH(){return this._week.doy}function xH(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function HH(t){var e=La(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}J("d",0,"do","day");J("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});J("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});J("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});J("e",0,0,"weekday");J("E",0,0,"isoWeekday");z("d",We);z("e",We);z("E",We);z("dd",function(t,e){return e.weekdaysMinRegex(t)});z("ddd",function(t,e){return e.weekdaysShortRegex(t)});z("dddd",function(t,e){return e.weekdaysRegex(t)});nl(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:oe(r).invalidWeekday=t});nl(["d","e","E"],function(t,e,r,n){e[n]=ge(t)});function AH(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function DH(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Km(t,e){return t.slice(e,7).concat(t.slice(0,e))}var NH="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),XT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),kH="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),LH=rl,FH=rl,VH=rl;function WH(t,e){var r=on(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Km(r,this._week.dow):t?r[t.day()]:r}function $H(t){return t===!0?Km(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function BH(t){return t===!0?Km(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function jH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Mn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=rt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=rt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=rt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=rt.call(this._weekdaysParse,s),i!==-1||(i=rt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=rt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=rt.call(this._shortWeekdaysParse,s),i!==-1||(i=rt.call(this._weekdaysParse,s),i!==-1)?i:(i=rt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=rt.call(this._minWeekdaysParse,s),i!==-1||(i=rt.call(this._weekdaysParse,s),i!==-1)?i:(i=rt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function zH(t,e,r){var n,i,o;if(this._weekdaysParseExact)return jH.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Mn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function UH(t){if(!this.isValid())return t!=null?this:NaN;var e=Na(this,"Day");return t!=null?(t=AH(t,this.localeData()),this.add(t-e,"d")):e}function YH(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function qH(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=DH(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function GH(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||Xm.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ce(this,"_weekdaysRegex")||(this._weekdaysRegex=LH),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function KH(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||Xm.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ce(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=FH),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function XH(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||Xm.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ce(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=VH),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xm(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Mn([2e3,1]).day(o),a=Zn(this.weekdaysMin(s,"")),l=Zn(this.weekdaysShort(s,"")),u=Zn(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Zm(){return this.hours()%12||12}function ZH(){return this.hours()||24}J("H",["HH",2],0,"hour");J("h",["hh",2],0,Zm);J("k",["kk",2],0,ZH);J("hmm",0,0,function(){return""+Zm.apply(this)+Tn(this.minutes(),2)});J("hmmss",0,0,function(){return""+Zm.apply(this)+Tn(this.minutes(),2)+Tn(this.seconds(),2)});J("Hmm",0,0,function(){return""+this.hours()+Tn(this.minutes(),2)});J("Hmmss",0,0,function(){return""+this.hours()+Tn(this.minutes(),2)+Tn(this.seconds(),2)});function ZT(t,e){J(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}ZT("a",!0);ZT("A",!1);function JT(t,e){return e._meridiemParse}z("a",JT);z("A",JT);z("H",We,qm);z("h",We,xs);z("k",We,xs);z("HH",We,Rr);z("hh",We,Rr);z("kk",We,Rr);z("hmm",WT);z("hmmss",$T);z("Hmm",WT);z("Hmmss",$T);Ne(["H","HH"],gt);Ne(["k","kk"],function(t,e,r){var n=ge(t);e[gt]=n===24?0:n});Ne(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Ne(["h","hh"],function(t,e,r){e[gt]=ge(t),oe(r).bigHour=!0});Ne("hmm",function(t,e,r){var n=t.length-2;e[gt]=ge(t.substr(0,n)),e[rn]=ge(t.substr(n)),oe(r).bigHour=!0});Ne("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[gt]=ge(t.substr(0,n)),e[rn]=ge(t.substr(n,2)),e[Kn]=ge(t.substr(i)),oe(r).bigHour=!0});Ne("Hmm",function(t,e,r){var n=t.length-2;e[gt]=ge(t.substr(0,n)),e[rn]=ge(t.substr(n))});Ne("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[gt]=ge(t.substr(0,n)),e[rn]=ge(t.substr(n,2)),e[Kn]=ge(t.substr(i))});function JH(t){return(t+"").toLowerCase().charAt(0)==="p"}var QH=/[ap]\.?m?\.?/i,eA=Hs("Hours",!0);function tA(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var QT={calendar:jx,longDateFormat:qx,invalidDate:Kx,ordinal:Zx,dayOfMonthOrdinalParse:Jx,relativeTime:eH,months:pH,monthsShort:zT,week:MH,weekdays:NH,weekdaysMin:kH,weekdaysShort:XT,meridiemParse:QH},Ue={},Bs={},Fa;function rA(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function EC(t){return t&&t.toLowerCase().replace("_","-")}function nA(t){for(var e=0,r,n,i,o;e<t.length;){for(o=EC(t[e]).split("-"),r=o.length,n=EC(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=ac(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&rA(o,n)>=r-1)break;r--}e++}return Fa}function iA(t){return!!(t&&t.match("^[^/\\\\]*$"))}function ac(t){var e=null,r;if(Ue[t]===void 0&&typeof Cu<"u"&&Cu&&Cu.exports&&iA(t))try{e=Fa._abbr,r=require,r("./locale/"+t),Mi(e)}catch{Ue[t]=null}return Ue[t]}function Mi(t,e){var r;return t&&(Jt(e)?r=ei(t):r=Jm(t,e),r?Fa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Fa._abbr}function Jm(t,e){if(e!==null){var r,n=QT;if(e.abbr=t,Ue[t]!=null)kT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ue[t]._config;else if(e.parentLocale!=null)if(Ue[e.parentLocale]!=null)n=Ue[e.parentLocale]._config;else if(r=ac(e.parentLocale),r!=null)n=r._config;else return Bs[e.parentLocale]||(Bs[e.parentLocale]=[]),Bs[e.parentLocale].push({name:t,config:e}),null;return Ue[t]=new Bm(Lg(n,e)),Bs[t]&&Bs[t].forEach(function(i){Jm(i.name,i.config)}),Mi(t),Ue[t]}else return delete Ue[t],null}function oA(t,e){if(e!=null){var r,n,i=QT;Ue[t]!=null&&Ue[t].parentLocale!=null?Ue[t].set(Lg(Ue[t]._config,e)):(n=ac(t),n!=null&&(i=n._config),e=Lg(i,e),n==null&&(e.abbr=t),r=new Bm(e),r.parentLocale=Ue[t],Ue[t]=r),Mi(t)}else Ue[t]!=null&&(Ue[t].parentLocale!=null?(Ue[t]=Ue[t].parentLocale,t===Mi()&&Mi(t)):Ue[t]!=null&&delete Ue[t]);return Ue[t]}function ei(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Fa;if(!on(t)){if(e=ac(t),e)return e;t=[t]}return nA(t)}function sA(){return Fg(Ue)}function Qm(t){var e,r=t._a;return r&&oe(t).overflow===-2&&(e=r[Gn]<0||r[Gn]>11?Gn:r[Sn]<1||r[Sn]>Gm(r[xt],r[Gn])?Sn:r[gt]<0||r[gt]>24||r[gt]===24&&(r[rn]!==0||r[Kn]!==0||r[oo]!==0)?gt:r[rn]<0||r[rn]>59?rn:r[Kn]<0||r[Kn]>59?Kn:r[oo]<0||r[oo]>999?oo:-1,oe(t)._overflowDayOfYear&&(e<xt||e>Sn)&&(e=Sn),oe(t)._overflowWeeks&&e===-1&&(e=cH),oe(t)._overflowWeekday&&e===-1&&(e=hH),oe(t).overflow=e),t}var aA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,uA=/Z|[+-]\d\d(?::?\d\d)?/,wl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Sf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],cA=/^\/?Date\((-?\d+)/i,hA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,dA={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function e_(t){var e,r,n=t._i,i=aA.exec(n)||lA.exec(n),o,s,a,l,u=wl.length,c=Sf.length;if(i){for(oe(t).iso=!0,e=0,r=u;e<r;e++)if(wl[e][1].exec(i[1])){s=wl[e][0],o=wl[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(Sf[e][1].exec(i[3])){a=(i[2]||" ")+Sf[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(uA.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),tp(t)}else t._isValid=!1}function fA(t,e,r,n,i,o){var s=[gA(t),zT.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function gA(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function mA(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function pA(t,e,r){if(t){var n=XT.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return oe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function wA(t,e,r){if(t)return dA[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function t_(t){var e=hA.exec(mA(t._i)),r;if(e){if(r=fA(e[4],e[3],e[2],e[5],e[6],e[7]),!pA(e[1],r,t))return;t._a=r,t._tzm=wA(e[8],e[9],e[10]),t._d=ka.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),oe(t).rfc2822=!0}else t._isValid=!1}function vA(t){var e=cA.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(e_(t),t._isValid===!1)delete t._isValid;else return;if(t_(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:V.createFromInputFallback(t)}V.createFromInputFallback=jr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ts(t,e,r){return t??e??r}function yA(t){var e=new Date(V.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ep(t){var e,r,n=[],i,o,s;if(!t._d){for(i=yA(t),t._w&&t._a[Sn]==null&&t._a[Gn]==null&&bA(t),t._dayOfYear!=null&&(s=ts(t._a[xt],i[xt]),(t._dayOfYear>_a(s)||t._dayOfYear===0)&&(oe(t)._overflowDayOfYear=!0),r=ka(s,0,t._dayOfYear),t._a[Gn]=r.getUTCMonth(),t._a[Sn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[gt]===24&&t._a[rn]===0&&t._a[Kn]===0&&t._a[oo]===0&&(t._nextDay=!0,t._a[gt]=0),t._d=(t._useUTC?ka:_H).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[gt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(oe(t).weekdayMismatch=!0)}}function bA(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=ts(e.GG,t._a[xt],La(Ve(),1,4).year),n=ts(e.W,1),i=ts(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=La(Ve(),o,s),r=ts(e.gg,t._a[xt],u.year),n=ts(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>Jn(r,o,s)?oe(t)._overflowWeeks=!0:l!=null?oe(t)._overflowWeekday=!0:(a=KT(r,n,i,o,s),t._a[xt]=a.year,t._dayOfYear=a.dayOfYear)}V.ISO_8601=function(){};V.RFC_2822=function(){};function tp(t){if(t._f===V.ISO_8601){e_(t);return}if(t._f===V.RFC_2822){t_(t);return}t._a=[],oe(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=LT(t._f,t._locale).match(jm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(aH(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&oe(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),cs[o]?(n?oe(t).empty=!1:oe(t).unusedTokens.push(o),uH(o,n,t)):t._strict&&!n&&oe(t).unusedTokens.push(o);oe(t).charsLeftOver=a-l,e.length>0&&oe(t).unusedInput.push(e),t._a[gt]<=12&&oe(t).bigHour===!0&&t._a[gt]>0&&(oe(t).bigHour=void 0),oe(t).parsedDateParts=t._a.slice(0),oe(t).meridiem=t._meridiem,t._a[gt]=CA(t._locale,t._a[gt],t._meridiem),u=oe(t).era,u!==null&&(t._a[xt]=t._locale.erasConvertYear(u,t._a[xt])),ep(t),Qm(t)}function CA(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function SA(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=$m({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],tp(e),Wm(e)&&(s=!0),o+=oe(e).charsLeftOver,o+=oe(e).unusedTokens.length*10,oe(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));Si(t,r||e)}function RA(t){if(!t._d){var e=zm(t._i),r=e.day===void 0?e.date:e.day;t._a=DT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),ep(t)}}function EA(t){var e=new tl(Qm(r_(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function r_(t){var e=t._i,r=t._f;return t._locale=t._locale||ei(t._l),e===null||r===void 0&&e===""?ec({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),sn(e)?new tl(Qm(e)):(el(e)?t._d=e:on(r)?SA(t):r?tp(t):TA(t),Wm(t)||(t._d=null),t))}function TA(t){var e=t._i;Jt(e)?t._d=new Date(V.now()):el(e)?t._d=new Date(e.valueOf()):typeof e=="string"?vA(t):on(e)?(t._a=DT(e.slice(0),function(r){return parseInt(r,10)}),ep(t)):uo(e)?RA(t):Qn(e)?t._d=new Date(e):V.createFromInputFallback(t)}function n_(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(uo(t)&&Vm(t)||on(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,EA(o)}function Ve(t,e,r,n){return n_(t,e,r,n,!1)}var _A=jr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:ec()}),OA=jr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:ec()});function i_(t,e){var r,n;if(e.length===1&&on(e[0])&&(e=e[0]),!e.length)return Ve();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function MA(){var t=[].slice.call(arguments,0);return i_("isBefore",t)}function IA(){var t=[].slice.call(arguments,0);return i_("isAfter",t)}var PA=function(){return Date.now?Date.now():+new Date},js=["year","quarter","month","week","day","hour","minute","second","millisecond"];function xA(t){var e,r=!1,n,i=js.length;for(e in t)if(Ce(t,e)&&!(rt.call(js,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[js[n]]){if(r)return!1;parseFloat(t[js[n]])!==ge(t[js[n]])&&(r=!0)}return!0}function HA(){return this._isValid}function AA(){return ln(NaN)}function lc(t){var e=zm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=xA(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=ei(),this._bubble()}function cu(t){return t instanceof lc}function Wg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function DA(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)ge(t[s])!==ge(e[s])&&o++;return o+i}function o_(t,e){J(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Tn(~~(r/60),2)+e+Tn(~~r%60,2)})}o_("Z",":");o_("ZZ","");z("Z",oc);z("ZZ",oc);Ne(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=rp(oc,t)});var NA=/([\+\-]|\d\d)/gi;function rp(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(NA)||["-",0,0],o=+(i[1]*60)+ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function np(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(sn(t)||el(t)?t.valueOf():Ve(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),V.updateOffset(r,!1),r):Ve(t).local()}function $g(t){return-Math.round(t._d.getTimezoneOffset())}V.updateOffset=function(){};function kA(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=rp(oc,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=$g(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?l_(this,ln(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,V.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:$g(this)}function LA(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function FA(t){return this.utcOffset(0,t)}function VA(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract($g(this),"m")),this}function WA(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=rp(oH,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function $A(t){return this.isValid()?(t=t?Ve(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function BA(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function jA(){if(!Jt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return $m(t,this),t=r_(t),t._a?(e=t._isUTC?Mn(t._a):Ve(t._a),this._isDSTShifted=this.isValid()&&DA(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function zA(){return this.isValid()?!this._isUTC:!1}function UA(){return this.isValid()?this._isUTC:!1}function s_(){return this.isValid()?this._isUTC&&this._offset===0:!1}var YA=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,qA=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ln(t,e){var r=t,n=null,i,o,s;return cu(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Qn(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=YA.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:ge(n[Sn])*i,h:ge(n[gt])*i,m:ge(n[rn])*i,s:ge(n[Kn])*i,ms:ge(Wg(n[oo]*1e3))*i}):(n=qA.exec(t))?(i=n[1]==="-"?-1:1,r={y:Vi(n[2],i),M:Vi(n[3],i),w:Vi(n[4],i),d:Vi(n[5],i),h:Vi(n[6],i),m:Vi(n[7],i),s:Vi(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=GA(Ve(r.from),Ve(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new lc(r),cu(t)&&Ce(t,"_locale")&&(o._locale=t._locale),cu(t)&&Ce(t,"_isValid")&&(o._isValid=t._isValid),o}ln.fn=lc.prototype;ln.invalid=AA;function Vi(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function TC(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function GA(t,e){var r;return t.isValid()&&e.isValid()?(e=np(e,t),t.isBefore(e)?r=TC(t,e):(r=TC(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function a_(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(kT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=ln(r,n),l_(this,i,t),this}}function l_(t,e,r,n){var i=e._milliseconds,o=Wg(e._days),s=Wg(e._months);t.isValid()&&(n=n??!0,s&&YT(t,Na(t,"Month")+s*r),o&&jT(t,"Date",Na(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&V.updateOffset(t,o||s))}var KA=a_(1,"add"),XA=a_(-1,"subtract");function u_(t){return typeof t=="string"||t instanceof String}function ZA(t){return sn(t)||el(t)||u_(t)||Qn(t)||QA(t)||JA(t)||t===null||t===void 0}function JA(t){var e=uo(t)&&!Vm(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Ce(t,o);return e&&r}function QA(t){var e=on(t),r=!1;return e&&(r=t.filter(function(n){return!Qn(n)&&u_(t)}).length===0),e&&r}function e1(t){var e=uo(t)&&!Vm(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Ce(t,o);return e&&r}function t1(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function r1(t,e){arguments.length===1&&(arguments[0]?ZA(arguments[0])?(t=arguments[0],e=void 0):e1(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ve(),n=np(r,this).startOf("day"),i=V.calendarFormat(this,n)||"sameElse",o=e&&(In(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Ve(r)))}function n1(){return new tl(this)}function i1(t,e){var r=sn(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=zr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function o1(t,e){var r=sn(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=zr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function s1(t,e,r,n){var i=sn(t)?t:Ve(t),o=sn(e)?e:Ve(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function a1(t,e){var r=sn(t)?t:Ve(t),n;return this.isValid()&&r.isValid()?(e=zr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function l1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function u1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function c1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=np(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=zr(e),e){case"year":o=hu(this,n)/12;break;case"month":o=hu(this,n);break;case"quarter":o=hu(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Ar(o)}function hu(t,e){if(t.date()<e.date())return-hu(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}V.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";V.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function h1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function d1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?uu(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):In(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",uu(r,"Z")):uu(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function f1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function g1(t){t||(t=this.isUtc()?V.defaultFormatUtc:V.defaultFormat);var e=uu(this,t);return this.localeData().postformat(e)}function m1(t,e){return this.isValid()&&(sn(t)&&t.isValid()||Ve(t).isValid())?ln({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function p1(t){return this.from(Ve(),t)}function w1(t,e){return this.isValid()&&(sn(t)&&t.isValid()||Ve(t).isValid())?ln({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function v1(t){return this.to(Ve(),t)}function c_(t){var e;return t===void 0?this._locale._abbr:(e=ei(t),e!=null&&(this._locale=e),this)}var h_=jr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function d_(){return this._locale}var Iu=1e3,hs=60*Iu,Pu=60*hs,f_=(365*400+97)*24*Pu;function ds(t,e){return(t%e+e)%e}function g_(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-f_:new Date(t,e,r).valueOf()}function m_(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-f_:Date.UTC(t,e,r)}function y1(t){var e,r;if(t=zr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?m_:g_,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ds(e+(this._isUTC?0:this.utcOffset()*hs),Pu);break;case"minute":e=this._d.valueOf(),e-=ds(e,hs);break;case"second":e=this._d.valueOf(),e-=ds(e,Iu);break}return this._d.setTime(e),V.updateOffset(this,!0),this}function b1(t){var e,r;if(t=zr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?m_:g_,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Pu-ds(e+(this._isUTC?0:this.utcOffset()*hs),Pu)-1;break;case"minute":e=this._d.valueOf(),e+=hs-ds(e,hs)-1;break;case"second":e=this._d.valueOf(),e+=Iu-ds(e,Iu)-1;break}return this._d.setTime(e),V.updateOffset(this,!0),this}function C1(){return this._d.valueOf()-(this._offset||0)*6e4}function S1(){return Math.floor(this.valueOf()/1e3)}function R1(){return new Date(this.valueOf())}function E1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function T1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function _1(){return this.isValid()?this.toISOString():null}function O1(){return Wm(this)}function M1(){return Si({},oe(this))}function I1(){return oe(this).overflow}function P1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}J("N",0,0,"eraAbbr");J("NN",0,0,"eraAbbr");J("NNN",0,0,"eraAbbr");J("NNNN",0,0,"eraName");J("NNNNN",0,0,"eraNarrow");J("y",["y",1],"yo","eraYear");J("y",["yy",2],0,"eraYear");J("y",["yyy",3],0,"eraYear");J("y",["yyyy",4],0,"eraYear");z("N",ip);z("NN",ip);z("NNN",ip);z("NNNN",$1);z("NNNNN",B1);Ne(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?oe(r).era=i:oe(r).invalidEra=t});z("y",Ps);z("yy",Ps);z("yyy",Ps);z("yyyy",Ps);z("yo",j1);Ne(["y","yy","yyy","yyyy"],xt);Ne(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[xt]=r._locale.eraYearOrdinalParse(t,i):e[xt]=parseInt(t,10)});function x1(t,e){var r,n,i,o=this._eras||ei("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=V(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=V(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function H1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function A1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?V(t.since).year():V(t.since).year()+(e-t.offset)*r}function D1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function N1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function k1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function L1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-V(i[t].since).year())*r+i[t].offset;return this.year()}function F1(t){return Ce(this,"_erasNameRegex")||op.call(this),t?this._erasNameRegex:this._erasRegex}function V1(t){return Ce(this,"_erasAbbrRegex")||op.call(this),t?this._erasAbbrRegex:this._erasRegex}function W1(t){return Ce(this,"_erasNarrowRegex")||op.call(this),t?this._erasNarrowRegex:this._erasRegex}function ip(t,e){return e.erasAbbrRegex(t)}function $1(t,e){return e.erasNameRegex(t)}function B1(t,e){return e.erasNarrowRegex(t)}function j1(t,e){return e._eraYearOrdinalRegex||Ps}function op(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Zn(u[i].name),a=Zn(u[i].abbr),l=Zn(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}J(0,["gg",2],0,function(){return this.weekYear()%100});J(0,["GG",2],0,function(){return this.isoWeekYear()%100});function uc(t,e){J(0,[t,t.length],0,e)}uc("gggg","weekYear");uc("ggggg","weekYear");uc("GGGG","isoWeekYear");uc("GGGGG","isoWeekYear");z("G",ic);z("g",ic);z("GG",We,Rr);z("gg",We,Rr);z("GGGG",Ym,Um);z("gggg",Ym,Um);z("GGGGG",nc,tc);z("ggggg",nc,tc);nl(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=ge(t)});nl(["gg","GG"],function(t,e,r,n){e[n]=V.parseTwoDigitYear(t)});function z1(t){return p_.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function U1(t){return p_.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Y1(){return Jn(this.year(),1,4)}function q1(){return Jn(this.isoWeekYear(),1,4)}function G1(){var t=this.localeData()._week;return Jn(this.year(),t.dow,t.doy)}function K1(){var t=this.localeData()._week;return Jn(this.weekYear(),t.dow,t.doy)}function p_(t,e,r,n,i){var o;return t==null?La(this,n,i).year:(o=Jn(t,n,i),e>o&&(e=o),X1.call(this,t,e,r,n,i))}function X1(t,e,r,n,i){var o=KT(t,e,r,n,i),s=ka(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}J("Q",0,"Qo","quarter");z("Q",FT);Ne("Q",function(t,e){e[Gn]=(ge(t)-1)*3});function Z1(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}J("D",["DD",2],"Do","date");z("D",We,xs);z("DD",We,Rr);z("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Ne(["D","DD"],Sn);Ne("Do",function(t,e){e[Sn]=ge(t.match(We)[0])});var w_=Hs("Date",!0);J("DDD",["DDDD",3],"DDDo","dayOfYear");z("DDD",rc);z("DDDD",VT);Ne(["DDD","DDDD"],function(t,e,r){r._dayOfYear=ge(t)});function J1(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}J("m",["mm",2],0,"minute");z("m",We,qm);z("mm",We,Rr);Ne(["m","mm"],rn);var Q1=Hs("Minutes",!1);J("s",["ss",2],0,"second");z("s",We,qm);z("ss",We,Rr);Ne(["s","ss"],Kn);var eD=Hs("Seconds",!1);J("S",0,0,function(){return~~(this.millisecond()/100)});J(0,["SS",2],0,function(){return~~(this.millisecond()/10)});J(0,["SSS",3],0,"millisecond");J(0,["SSSS",4],0,function(){return this.millisecond()*10});J(0,["SSSSS",5],0,function(){return this.millisecond()*100});J(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});J(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});J(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});J(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});z("S",rc,FT);z("SS",rc,Rr);z("SSS",rc,VT);var Ri,v_;for(Ri="SSSS";Ri.length<=9;Ri+="S")z(Ri,Ps);function tD(t,e){e[oo]=ge(("0."+t)*1e3)}for(Ri="S";Ri.length<=9;Ri+="S")Ne(Ri,tD);v_=Hs("Milliseconds",!1);J("z",0,0,"zoneAbbr");J("zz",0,0,"zoneName");function rD(){return this._isUTC?"UTC":""}function nD(){return this._isUTC?"Coordinated Universal Time":""}var D=tl.prototype;D.add=KA;D.calendar=r1;D.clone=n1;D.diff=c1;D.endOf=b1;D.format=g1;D.from=m1;D.fromNow=p1;D.to=w1;D.toNow=v1;D.get=fH;D.invalidAt=I1;D.isAfter=i1;D.isBefore=o1;D.isBetween=s1;D.isSame=a1;D.isSameOrAfter=l1;D.isSameOrBefore=u1;D.isValid=O1;D.lang=h_;D.locale=c_;D.localeData=d_;D.max=OA;D.min=_A;D.parsingFlags=M1;D.set=gH;D.startOf=y1;D.subtract=XA;D.toArray=E1;D.toObject=T1;D.toDate=R1;D.toISOString=d1;D.inspect=f1;typeof Symbol<"u"&&Symbol.for!=null&&(D[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});D.toJSON=_1;D.toString=h1;D.unix=S1;D.valueOf=C1;D.creationData=P1;D.eraName=D1;D.eraNarrow=N1;D.eraAbbr=k1;D.eraYear=L1;D.year=BT;D.isLeapYear=dH;D.weekYear=z1;D.isoWeekYear=U1;D.quarter=D.quarters=Z1;D.month=qT;D.daysInMonth=RH;D.week=D.weeks=xH;D.isoWeek=D.isoWeeks=HH;D.weeksInYear=G1;D.weeksInWeekYear=K1;D.isoWeeksInYear=Y1;D.isoWeeksInISOWeekYear=q1;D.date=w_;D.day=D.days=UH;D.weekday=YH;D.isoWeekday=qH;D.dayOfYear=J1;D.hour=D.hours=eA;D.minute=D.minutes=Q1;D.second=D.seconds=eD;D.millisecond=D.milliseconds=v_;D.utcOffset=kA;D.utc=FA;D.local=VA;D.parseZone=WA;D.hasAlignedHourOffset=$A;D.isDST=BA;D.isLocal=zA;D.isUtcOffset=UA;D.isUtc=s_;D.isUTC=s_;D.zoneAbbr=rD;D.zoneName=nD;D.dates=jr("dates accessor is deprecated. Use date instead.",w_);D.months=jr("months accessor is deprecated. Use month instead",qT);D.years=jr("years accessor is deprecated. Use year instead",BT);D.zone=jr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",LA);D.isDSTShifted=jr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",jA);function iD(t){return Ve(t*1e3)}function oD(){return Ve.apply(null,arguments).parseZone()}function y_(t){return t}var Se=Bm.prototype;Se.calendar=zx;Se.longDateFormat=Gx;Se.invalidDate=Xx;Se.ordinal=Qx;Se.preparse=y_;Se.postformat=y_;Se.relativeTime=tH;Se.pastFuture=rH;Se.set=Bx;Se.eras=x1;Se.erasParse=H1;Se.erasConvertYear=A1;Se.erasAbbrRegex=V1;Se.erasNameRegex=F1;Se.erasNarrowRegex=W1;Se.months=yH;Se.monthsShort=bH;Se.monthsParse=SH;Se.monthsRegex=TH;Se.monthsShortRegex=EH;Se.week=OH;Se.firstDayOfYear=PH;Se.firstDayOfWeek=IH;Se.weekdays=WH;Se.weekdaysMin=BH;Se.weekdaysShort=$H;Se.weekdaysParse=zH;Se.weekdaysRegex=GH;Se.weekdaysShortRegex=KH;Se.weekdaysMinRegex=XH;Se.isPM=JH;Se.meridiem=tA;function xu(t,e,r,n){var i=ei(),o=Mn().set(n,e);return i[r](o,t)}function b_(t,e,r){if(Qn(t)&&(e=t,t=void 0),t=t||"",e!=null)return xu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=xu(t,n,r,"month");return i}function sp(t,e,r,n){typeof t=="boolean"?(Qn(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Qn(e)&&(r=e,e=void 0),e=e||"");var i=ei(),o=t?i._week.dow:0,s,a=[];if(r!=null)return xu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=xu(e,(s+o)%7,n,"day");return a}function sD(t,e){return b_(t,e,"months")}function aD(t,e){return b_(t,e,"monthsShort")}function lD(t,e,r){return sp(t,e,r,"weekdays")}function uD(t,e,r){return sp(t,e,r,"weekdaysShort")}function cD(t,e,r){return sp(t,e,r,"weekdaysMin")}Mi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});V.lang=jr("moment.lang is deprecated. Use moment.locale instead.",Mi);V.langData=jr("moment.langData is deprecated. Use moment.localeData instead.",ei);var Nn=Math.abs;function hD(){var t=this._data;return this._milliseconds=Nn(this._milliseconds),this._days=Nn(this._days),this._months=Nn(this._months),t.milliseconds=Nn(t.milliseconds),t.seconds=Nn(t.seconds),t.minutes=Nn(t.minutes),t.hours=Nn(t.hours),t.months=Nn(t.months),t.years=Nn(t.years),this}function C_(t,e,r,n){var i=ln(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function dD(t,e){return C_(this,t,e,1)}function fD(t,e){return C_(this,t,e,-1)}function _C(t){return t<0?Math.floor(t):Math.ceil(t)}function gD(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=_C(Bg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Ar(t/1e3),n.seconds=i%60,o=Ar(i/60),n.minutes=o%60,s=Ar(o/60),n.hours=s%24,e+=Ar(s/24),l=Ar(S_(e)),r+=l,e-=_C(Bg(l)),a=Ar(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function S_(t){return t*4800/146097}function Bg(t){return t*146097/4800}function mD(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=zr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+S_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(Bg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function ti(t){return function(){return this.as(t)}}var R_=ti("ms"),pD=ti("s"),wD=ti("m"),vD=ti("h"),yD=ti("d"),bD=ti("w"),CD=ti("M"),SD=ti("Q"),RD=ti("y"),ED=R_;function TD(){return ln(this)}function _D(t){return t=zr(t),this.isValid()?this[t+"s"]():NaN}function Mo(t){return function(){return this.isValid()?this._data[t]:NaN}}var OD=Mo("milliseconds"),MD=Mo("seconds"),ID=Mo("minutes"),PD=Mo("hours"),xD=Mo("days"),HD=Mo("months"),AD=Mo("years");function DD(){return Ar(this.days()/7)}var zn=Math.round,is={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ND(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function kD(t,e,r,n){var i=ln(t).abs(),o=zn(i.as("s")),s=zn(i.as("m")),a=zn(i.as("h")),l=zn(i.as("d")),u=zn(i.as("M")),c=zn(i.as("w")),h=zn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,ND.apply(null,d)}function LD(t){return t===void 0?zn:typeof t=="function"?(zn=t,!0):!1}function FD(t,e){return is[t]===void 0?!1:e===void 0?is[t]:(is[t]=e,t==="s"&&(is.ss=e-1),!0)}function VD(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=is,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},is,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=kD(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Rf=Math.abs;function No(t){return(t>0)-(t<0)||+t}function cc(){if(!this.isValid())return this.localeData().invalidDate();var t=Rf(this._milliseconds)/1e3,e=Rf(this._days),r=Rf(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Ar(t/60),i=Ar(n/60),t%=60,n%=60,o=Ar(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=No(this._months)!==No(a)?"-":"",c=No(this._days)!==No(a)?"-":"",h=No(this._milliseconds)!==No(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var pe=lc.prototype;pe.isValid=HA;pe.abs=hD;pe.add=dD;pe.subtract=fD;pe.as=mD;pe.asMilliseconds=R_;pe.asSeconds=pD;pe.asMinutes=wD;pe.asHours=vD;pe.asDays=yD;pe.asWeeks=bD;pe.asMonths=CD;pe.asQuarters=SD;pe.asYears=RD;pe.valueOf=ED;pe._bubble=gD;pe.clone=TD;pe.get=_D;pe.milliseconds=OD;pe.seconds=MD;pe.minutes=ID;pe.hours=PD;pe.days=xD;pe.weeks=DD;pe.months=HD;pe.years=AD;pe.humanize=VD;pe.toISOString=cc;pe.toString=cc;pe.toJSON=cc;pe.locale=c_;pe.localeData=d_;pe.toIsoString=jr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",cc);pe.lang=h_;J("X",0,0,"unix");J("x",0,0,"valueOf");z("x",ic);z("X",sH);Ne("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Ne("x",function(t,e,r){r._d=new Date(ge(t))});//! moment.js
V.version="2.30.1";Wx(Ve);V.fn=D;V.min=MA;V.max=IA;V.now=PA;V.utc=Mn;V.unix=iD;V.months=sD;V.isDate=el;V.locale=Mi;V.invalid=ec;V.duration=ln;V.isMoment=sn;V.weekdays=lD;V.parseZone=oD;V.localeData=ei;V.isDuration=cu;V.monthsShort=aD;V.weekdaysMin=cD;V.defineLocale=Jm;V.updateLocale=oA;V.locales=sA;V.weekdaysShort=uD;V.normalizeUnits=zr;V.relativeTimeRounding=LD;V.relativeTimeThreshold=FD;V.calendarFormat=t1;V.prototype=D;V.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var OC={},MC={},IC;function WD(){if(IC)return MC;IC=1;var t=Fe(),e=Is(),r=Cr(),n=vt(),i=ki(),o=Sr(),s=Oo(),a=Za(),l=ct(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(b){o(this,"throw",b)}var w=arguments.length<2,v=w?void 0:arguments[1];if(h)return a(h,this,w?[g]:[g,v]);var C=i(this),T=0;if(e(C,function(b){w?(w=!1,v=b):v=g(v,b,T),T++},{IS_RECORD:!0}),w)throw new u("Reduce of empty iterator with no initial value");return v}}),MC}var PC;function $D(){return PC||(PC=1,WD()),OC}$D();function BD(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function xC(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Ef(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Io(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function ap(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function _n(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function j(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function HC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return j(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function AC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function ir(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Io(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function lp(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function he(t){return typeof t<"u"}function Bt(t){return typeof t>"u"}function go(t){return t===null||t===""||Bt(t)}function jD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const va="length",Oa=t=>parseInt(t,16),DC=t=>parseInt(t,10),Hu=(t,e,r)=>t.substr(e,r),Ma=t=>t.codePointAt(0)-65,jg=t=>`${t}`.replace(/\-/g,""),zD=t=>Oa(Hu(jg(t),Oa("12"),Ma("F")))/(Oa(Hu(jg(t),Ma("B"),~~![][va]))||9),UD=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let NC=!1;const kC={invalid:()=>ir`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ir`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ir`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},LC={invalid:()=>ir`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ir`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ir`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function YD(t,e){const r=!go(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.1.0";let o,s="invalid",a="invalid";t=jg(t||"");const l=qD(t);if(r||n||l)if(l){const u=V("15/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=zD(t);o=V((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(UD()&&(s="valid",a="valid"),!NC&&s!=="valid"&&(kC[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](kC[s]({keyValidityDate:o,hotVersion:i})),NC=!0),a!=="valid"&&e&&LC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=LC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function qD(t){let e=[][va],r=e;if(t[va]!==Ma("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=Ma(i.shift());o;o=Ma(i.shift()||"A"))--o<""[va]?r=r|(DC(`${DC(Oa(n)+(Oa(Hu(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Hu(t,o,o?i[va]===1?9:8:6);return r===e}function zg(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Ug(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function hc(t){return t[0].toUpperCase()+t.substr(1)}function E_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function GD(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function KD(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function T_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function __(t,e){return Vx.sanitize(t,e)}const Po=t=>["tabindex",t],XD=()=>["role","treegrid"],Ei=()=>["role","presentation"],ZD=()=>["role","gridcell"],JD=()=>["role","gridcell button"],QD=()=>["role","rowheader"],O_=()=>["role","rowgroup"],eN=()=>["role","columnheader"],M_=()=>["role","row"],tN=()=>["role","menu"],rN=()=>["role","menuitem"],nN=()=>["role","menuitemcheckbox"],iN=()=>["scope","col"],oN=()=>["scope","row"],Au=t=>["aria-label",t],sN=()=>["aria-hidden","true"],aN=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},lN=()=>["aria-multiselectable","true"],I_=t=>["aria-rowcount",t],dc=t=>["aria-colcount",t],P_=t=>["aria-rowindex",t],up=t=>["aria-colindex",t],du=t=>["aria-expanded",t],FC=()=>["aria-readonly","true"],VC=()=>["aria-invalid","true"],uN=t=>["aria-checked",t],x_=()=>["aria-selected","true"];var WC={},Tf,$C;function cN(){if($C)return Tf;$C=1;var t=ot(),e=hT(),r=ht(),n=Co(),i=Qu(),o=t([].push);return Tf=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,w){if(d)return d=!1,w;if(e(this))return w;for(var v=0;v<h;v++)if(l[v]===g)return w}}},Tf}var BC;function hN(){if(BC)return WC;BC=1;var t=Fe(),e=Ts(),r=Za(),n=wt(),i=ot(),o=ct(),s=ht(),a=Mm(),l=Fm(),u=cN(),c=Om(),h=String,d=e("JSON","stringify"),g=i(/./.exec),w=i("".charAt),v=i("".charCodeAt),C=i("".replace),T=i(1.1.toString),b=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,I=!c||o(function(){var F=e("Symbol")("stringify detection");return d([F])!=="[null]"||d({a:F})!=="{}"||d(Object(F))!=="{}"}),x=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),P=function(F,W){var q=l(arguments),L=u(W);if(!(!s(L)&&(F===void 0||a(F))))return q[1]=function(se,K){if(s(L)&&(K=n(L,this,h(se),K)),!a(K))return K},r(d,null,q)},A=function(F,W,q){var L=w(q,W-1),se=w(q,W+1);return g(E,F)&&!g(y,se)||g(y,F)&&!g(E,L)?"\\u"+T(v(F,0),16):F};return d&&t({target:"JSON",stat:!0,arity:3,forced:I||x},{stringify:function(W,q,L){var se=l(arguments),K=r(I?P:d,null,se);return x&&typeof K=="string"?C(K,b,A):K}}),WC}hN();function Va(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},He(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Va(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Va(r[0])]:e[n]=[]:e[n]=null)})),e}function dN(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function xi(t,e,r){const n=Array.isArray(r);return He(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function H_(t,e){He(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),H_(t[n],e[n])):t[n]=e[n]})}function br(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Je(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j(r,i=>{t.MIXINS.push(i.MIXIN_NAME),He(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=w=>{let v=w;return(Array.isArray(v)||nt(v))&&(v=br(v)),v};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function A_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function nt(t){return Object.prototype.toString.call(t)==="[object Object]"}function ri(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function He(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function Yg(t,e){const r=e.split(".");let n=t;return He(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function _f(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(Fr(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function cp(t){if(!nt(t))return 0;const e=function(r){let n=0;return nt(r)?He(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function pr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Fr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fu(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=fu(t[n],e[n]):r[n]=Fr(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{Fr(r,n)||(r[n]=t[n])}),r}function qg(t){return window.requestAnimationFrame(t)}function jC(t){window.cancelAnimationFrame(t)}function fN(){return"ontouchstart"in window}function gN(){return typeof window<"u"}const Hr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Li={chrome:Hr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Hr(t=>/CriOS/.test(t)),edge:Hr(t=>/Edge/.test(t)),edgeWebKit:Hr(t=>/EdgiOS/.test(t)),firefox:Hr(t=>/Firefox/.test(t)),firefoxWebKit:Hr(t=>/FxiOS/.test(t)),mobile:Hr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Hr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},il={mac:Hr(t=>/^Mac/.test(t)),win:Hr(t=>/^Win/.test(t)),linux:Hr(t=>/^Linux/.test(t)),ios:Hr(t=>/iPhone|iPad|iPod/i.test(t))};function mN(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(Li,r=>{let{test:n}=r;return void n(t,e)})}function pN(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(il,e=>{let{test:r}=e;return void r(t)})}gN()&&(mN(),pN());function wN(){return Li.chrome.value}function vN(){return Li.chromeWebKit.value}function Of(){return Li.firefox.value}function yN(){return Li.firefoxWebKit.value}function hp(){return Li.safari.value}function bN(){return Li.edge.value}function Ti(){return Li.mobile.value}function D_(){return il.ios.value}function N_(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&il.mac.value}function zC(){return il.win.value}function UC(){return il.mac.value}function CN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function gu(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function SN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Wa(t){return SN(t)&&t.parent}function k_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function vl(t,e,r){const n=[];let i=t;for(;i&&(i=k_(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function RN(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function fs(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function EN(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Wi(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function L_(t){return!t||!t.length?[]:t.filter(e=>!!e)}function F_(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=L_(e),e.length>0&&t.classList.add(...e)}function xe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=F_(e,!0);r=L_(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Me(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function ol(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=F_(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function V_(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)V_(e[r])}}function ys(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const TN=/(<(.*)>|&(.*);)/;function W_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;TN.test(e)?t.innerHTML=r?__(e):e:sl(t,e)}function sl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(ys(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function $a(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return $a(n.host.impl);if(n.host)return $a(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function _N(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Dr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function $_(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function dp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function fp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?$_(e):t.scrollTop}function B_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?dp(e):t.scrollLeft}function Du(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function ON(t){return t.scrollHeight-t.clientHeight}function MN(t){return t.scrollWidth-t.clientWidth}function Nu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function YC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function nr(t){return t.offsetWidth}function or(t){return t.getBoundingClientRect().height}function Ia(t){return t.clientHeight||t.innerHeight}function j_(t){return t.clientWidth||t.innerWidth}function IN(t){return t.selectionStart?t.selectionStart:0}function qC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function z_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let Mf;function PN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");hp()&&!Ti()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Mf===void 0&&(Mf=PN(t)),Mf}function xN(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function HN(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function gp(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function fc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function mu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function U_(t){return mu(t)&&t.hasAttribute("data-hot-input")===!1}function AN(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Y_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Me(t,"contenteditable",!0),r&&Me(t,...sN()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function q_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&xe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function DN(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Y_(t,r),e(),q_(t,r)}function co(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Oe(t){return typeof t=="function"}function G_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function NN(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function Gg(t,e,r,n,i,o,s,a){return he(a)?t.call(e,r,n,i,o,s,a):he(s)?t.call(e,r,n,i,o,s):he(o)?t.call(e,r,n,i,o):he(i)?t.call(e,r,n,i):he(n)?t.call(e,r,n):he(r)?t.call(e,r):t.call(e)}const ee={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Of()?182:174,AUDIO_MUTE:Of()?181:173,AUDIO_UP:Of()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},kN=[ee.ALT,ee.ARROW_DOWN,ee.ARROW_LEFT,ee.ARROW_RIGHT,ee.ARROW_UP,ee.AUDIO_DOWN,ee.AUDIO_MUTE,ee.AUDIO_UP,ee.BACKSPACE,ee.CAPS_LOCK,ee.DELETE,ee.END,ee.ENTER,ee.ESCAPE,ee.F1,ee.F2,ee.F3,ee.F4,ee.F5,ee.F6,ee.F7,ee.F8,ee.F9,ee.F10,ee.F11,ee.F12,ee.F13,ee.F14,ee.F15,ee.F16,ee.F17,ee.F18,ee.F19,ee.HOME,ee.INSERT,ee.MEDIA_NEXT,ee.MEDIA_PLAY_PAUSE,ee.MEDIA_PREV,ee.MEDIA_STOP,ee.NULL,ee.NUM_LOCK,ee.PAGE_DOWN,ee.PAGE_UP,ee.PAUSE,ee.SCROLL_LOCK,ee.SHIFT,ee.TAB];function LN(t){return kN.includes(t)}function FN(t){return[ee.CONTROL,ee.COMMAND_LEFT,ee.COMMAND_RIGHT,ee.COMMAND_FIREFOX].includes(t)}function VN(t,e){const r=e.split("|");let n=!1;return j(r,i=>{if(t===ee[i])return n=!0,!1}),n}function gc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function to(t){return t.isImmediatePropagationEnabled===!1}function ku(t){return t.button===2}function K_(t){return t.button===0}function Vr(){he(console)&&console.warn(...arguments)}function WN(t){he(console)&&console.warn(`Deprecated: ${t}`)}function $N(){he(console)&&console.error(...arguments)}const ro=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],If=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Pf=new Map([[]]);var GC={},xf,KC;function BN(){if(KC)return xf;KC=1;var t=Ms();return xf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},xf}var Hf,XC;function jN(){if(XC)return Hf;XC=1;var t=it();return Hf=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},Hf}var Af,ZC;function mp(){if(ZC)return Af;ZC=1;var t=an(),e=Lm(),r=Ni().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),Af=function(o){i[n][o]=!0},Af}var JC;function zN(){if(JC)return GC;JC=1;var t=Fe(),e=ot(),r=Cr(),n=qa(),i=BN(),o=jN(),s=mp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),GC}zN();var QC={},eS={},tS;function UN(){if(tS)return eS;tS=1;var t=Fe(),e=wt(),r=Is(),n=Cr(),i=vt(),o=ki(),s=Sr(),a=Oo(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),eS}var rS;function YN(){return rS||(rS=1,UN()),QC}YN();function qN(t,e){X_(t,e),e.add(t)}function Df(t,e,r){X_(t,e),e.set(t,r)}function X_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nS(t,e,r){return t.set(Lu(t,e),r),r}function St(t,e){return t.get(Lu(t,e))}function Lu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const GN=100;var dr=new WeakMap,rs=new WeakMap,Nf=new WeakMap,kf=new WeakSet;class iS{constructor(){qN(this,kf),Df(this,dr,new Map),Df(this,rs,new Map),Df(this,Nf,new Set),ro.forEach(e=>Lu(kf,this,oS).call(this,e))}getHooks(e){var r;return(r=St(dr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};St(dr,this).has(e)||(Lu(kf,this,oS).call(this,e),ro.push(e));const i=St(dr,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=St(Nf,this).has(e);!u&&o!==0&&(u=!0,St(Nf,this).add(e)),u&&i.length>1&&St(dr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return St(dr,this).has(e)&&St(dr,this).get(e).length>0}remove(e,r){if(!St(dr,this).has(e))return!1;const n=St(dr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=St(rs,this).get(e);return i.skip=!0,o+=1,o>GN&&(St(dr,this).set(e,n.filter(s=>!s.skip)),o=0),St(rs,this).set(e,o),!0}return!1}destroy(){St(dr,this).clear(),St(rs,this).clear(),nS(dr,this,null),nS(rs,this,null)}}function oS(t){St(dr,this).set(t,[]),St(rs,this).set(t,0)}function KN(t,e,r){return(e=XN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XN(t){var e=ZN(t,"string");return typeof e=="symbol"?e:e+""}function ZN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const JN=ir`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class fe{constructor(){KN(this,"globalBucket",new iS)}static getSingleton(){return ek()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new iS),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.add(e,o,n)):(If.has(e)&&Vr(T_(JN,{hookName:e,removedInVersion:If.get(e)})),Pf.has(e)&&Vr(Pf.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?j(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Gg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Gg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ro.push(e)}deregister(e){this.isRegistered(e)&&ro.splice(ro.indexOf(e),1)}isDeprecated(e){return Pf.has(e)||If.has(e)}isRegistered(e){return ro.indexOf(e)>=0}getRegistered(){return ro}}const QN=new fe;function ek(){return QN}const so=new Map;function xo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";so.has(t)||so.set(t,new Map);const e=so.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){so.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function tk(t,e){var r;return so==null||(r=so.get(t.guid))===null||r===void 0?void 0:r.get(e)}const Kg=new WeakMap,{register:rk,getItem:Z_,hasItem:J_}=xo("editors");function nk(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function ik(t,e){let r;if(typeof t=="function")Kg.get(t)||Q_(null,t),r=Kg.get(t);else if(typeof t=="string")r=Z_(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function sS(t){if(typeof t=="function")return t;if(!J_(t))throw Error(`No registered editor found under "${t}" name`);return Z_(t).getConstructor()}function Q_(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new nk(e);typeof t=="string"&&rk(t,r),Kg.set(e,r)}function ok(t,e,r){return(e=sk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sk(t){var e=ak(t,"string");return typeof e=="symbol"?e:e+""}function ak(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ok(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,lk(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function lk(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),gc(this)},t}function uk(t,e){ck(t,e),e.add(t)}function ck(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $i(t,e,r){return(e=hk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hk(t){var e=dk(t,"string");return typeof e=="symbol"?e:e+""}function dk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var yl=new WeakSet;class Xg{constructor(e,r,n){uk(this,yl),$i(this,"hot",void 0),$i(this,"tableMeta",void 0),$i(this,"selection",void 0),$i(this,"eventManager",void 0),$i(this,"destroyed",!1),$i(this,"activeEditor",void 0),$i(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Hi(e),this.hot.addHook("afterDocumentKeyDown",i=>Lf(yl,this,aS).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Lf(yl,this,aS).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Lf(yl,this,fk).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=ik(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function aS(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||to(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!LN(r)&&!FN(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function fk(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const lS=new WeakMap;Xg.getInstance=function(t,e,r){let n=lS.get(t);return n||(n=new Xg(t,e,r),lS.set(t,n)),n};function gk(t,e){e0(t,e),e.add(t)}function zs(t,e,r){e0(t,e),e.set(t,r)}function e0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(t,e){return t.get(qn(t,e))}function Us(t,e,r){return t.set(qn(t,e),r),r}function qn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const gs=Object.freeze({CELL:"cell",MIXED:"mixed"});var at=new WeakMap,bl=new WeakMap,Cl=new WeakMap,Sl=new WeakMap,Rl=new WeakMap,yi=new WeakSet;class mk{constructor(e){var r=this;gk(this,yi),zs(this,at,void 0),zs(this,bl,void 0),zs(this,Cl,1),zs(this,Sl,null),zs(this,Rl,new Map);const n=e.getSettings();Us(at,this,e),Us(bl,this,n.imeFastEdit?gs.MIXED:gs.CELL),Le(at,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return qn(yi,r,wk).call(r,...o)}),Le(at,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return qn(yi,r,uS).call(r,...o)}),Le(at,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return qn(yi,r,uS).call(r,...o)}),Le(at,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return qn(yi,r,pk).call(r,...o)})}getFocusMode(){return Le(bl,this)}setFocusMode(e){Object.values(gs).includes(e)?Us(bl,this,e):Vr(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Le(Cl,this)}setRefocusDelay(e){Us(Cl,this,e)}setRefocusElementGetter(e){Us(Sl,this,e)}getRefocusElement(){var e;return typeof Le(Sl,this)=="function"?Le(Sl,this).call(this):(e=Le(at,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Le(at,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Le(at,this).runHooks("modifyFocusedElement",s.row,s.col,n);co(a)||(a=n),a&&!((o=Le(at,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):qn(yi,this,pp).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Le(Cl,this);if(Le(at,this).getSettings().imeFastEdit&&!((e=Le(at,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Le(at,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Le(Rl,this).has(r)||Le(Rl,this).set(r,G_(()=>{if(!Le(at,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Le(Rl,this).get(r)()}}}function pp(t){var e;const r=(e=Le(at,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!Le(at,this).selection.isCellVisible(r)){t(null);return}const n=Le(at,this).getCell(r.row,r.col,!0);n===null?Le(at,this).addHookOnce("afterScroll",()=>{t(Le(at,this).getCell(r.row,r.col,!0))}):t(n)}function uS(){qn(yi,this,pp).call(this,t=>{const{activeElement:e}=Le(at,this).rootDocument;e&&U_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function pk(){qn(yi,this,pp).call(this,t=>{this.getFocusMode()===gs.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function wk(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?gs.MIXED:gs.CELL)}var cS={},Ff,hS;function vk(){if(hS)return Ff;hS=1;var t=$r(),e=Co(),r=an(),n=r("match");return Ff=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Ff}var Vf,dS;function yk(){if(dS)return Vf;dS=1;var t=it(),e=ct(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return Vf={correct:n},Vf}var Wf,fS;function bk(){if(fS)return Wf;fS=1;var t=vt();return Wf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},Wf}var $f,gS;function Ck(){if(gS)return $f;gS=1;var t=wt(),e=Br(),r=Ga(),n=yk(),i=bk(),o=RegExp.prototype;return $f=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},$f}var Bf,mS;function Sk(){if(mS)return Bf;mS=1;var t=ot(),e=_s(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return Bf=function(l,u,c,h,d,g){var w=c+l.length,v=h.length,C=a;return d!==void 0&&(d=e(d),C=s),i(g,C,function(T,b){var E;switch(n(b,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":E=d[o(b,1,-1)];break;default:var y=+b;if(y===0)return T;if(y>v){var I=r(y/10);return I===0?T:I<=v?h[I-1]===void 0?n(b,1):h[I-1]+n(b,1):T}E=h[y-1]}return E===void 0?"":E})},Bf}var pS;function Rk(){if(pS)return cS;pS=1;var t=Fe(),e=wt(),r=ot(),n=Ya(),i=ht(),o=$r(),s=vk(),a=Qu(),l=Ka(),u=Ck(),c=Sk(),h=an(),d=So(),g=h("replace"),w=TypeError,v=r("".indexOf),C=r("".replace),T=r("".slice),b=Math.max;return t({target:"String",proto:!0},{replaceAll:function(y,I){var x=n(this),P,A,F,W,q,L,se,K,te,dt,Re=0,Ee="";if(o(y)){if(P=s(y),P&&(A=a(n(u(y))),!~v(A,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(F=l(y,g),F)return e(F,y,x,I);if(d&&P)return C(a(x),y,I)}for(W=a(x),q=a(y),L=i(I),L||(I=a(I)),se=q.length,K=b(1,se),te=v(W,q);te!==-1;)dt=L?a(I(q,te,W)):c(q,W,te,[],void 0,I),Ee+=T(W,Re,te)+dt,Re=te+se,te=te+K>W.length?-1:v(W,q,te+K);return Re<W.length&&(Ee+=T(W,Re)),Ee}}),cS}Rk();const t0={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Ek=new RegExp(Object.keys(t0).map(t=>`(${t})`).join("|"),"gi");function Tk(t){return(t&&t.nodeName||"")==="TABLE"}function wS(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,w=[];for(let C=0;C<s;C+=1){const T=!g&&r&&C===0;let b="";if(g)b=`<th>${t.getColHeader(C-c)}</th>`;else if(T)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const E=i[d][C],{hidden:y,rowspan:I,colspan:x}=t.getCellMeta(d-h,C-c);if(!y){const P=[];if(I&&P.push(`rowspan="${I}"`),x&&P.push(`colspan="${x}"`),go(E))b=`<td ${P.join(" ")}></td>`;else{const A=E.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${P.join(" ")}>${A}</td>`}}}w.push(b)}const v=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function vS(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=go(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function yS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const E=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,y=>{const I=y.match(/<td\b[^>]*?>/g)[0],x=/<p.*?>/g,P=y.substring(I.length,y.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(x,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${E}`),o=i.querySelector("table")}if(!o||!Tk(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,y)=>E+y.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,w=0;if(o.tHead){const E=Array.from(o.tHead.rows).filter(y=>{const I=y.querySelector("td")!==null;return I&&h.push(y),!I});g=E.length,d=g>0,g>1?r.nestedHeaders=Array.from(E).reduce((y,I)=>{const x=Array.from(I.cells).reduce((P,A,F)=>{if(a&&F===0)return P;const{colSpan:W,innerHTML:q}=A,L=W>1?{label:q,colspan:W}:q;return P.push(L),P},[]);return y.push(x),y},[]):d&&(r.colHeaders=Array.from(E[0].children).reduce((y,I,x)=>(a&&x===0||y.push(I.innerHTML),y),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((E,y)=>(E.push(...Array.from(y.rows)),E),[]),...c];w=v.length;const C=new Array(w);for(let E=0;E<w;E++)C[E]=new Array(u);const T=[],b=[];for(let E=0;E<w;E++){const y=v[E],I=Array.from(y.cells),x=I.length;for(let P=0;P<x;P++){const A=I[P],{nodeName:F,innerHTML:W,rowSpan:q,colSpan:L}=A,se=C[E].findIndex(K=>K===void 0);if(F==="TD"){if(q>1||L>1){for(let Re=E;Re<E+q;Re++)if(Re<w)for(let Ee=se;Ee<se+L;Ee++)C[Re][Ee]=null;const te=A.getAttribute("style");te&&te.includes("mso-ignore:colspan")||T.push({col:se,row:E,rowspan:q,colspan:L})}let K="";s&&/excel/gi.test(s.content)?K=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):K=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[E][se]=K.replace(Ek,te=>t0[te])}else b.push(W)}}return T.length&&(r.mergeCells=T),b.length&&(r.rowHeaders=b),C.length&&(r.data=C),r}function _k(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Ge(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function bS(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function Ok(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function De(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function ms(t){return Number.isInteger(t)&&t>=0}const Zg="asc",Mk="desc",CS=new Map([[Zg,[-1,1]],[Mk,[1,-1]]]),Ik=t=>`The priority '${t}' is already declared in a map.`,Pk=t=>`The priority '${t}' is not a number.`;function xk(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Oe(t)?t:Ik,e=Oe(e)?e:Pk;function n(o,s){if(!_k(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zg;const[s,a]=CS.get(o)||CS.get(Zg);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const Hk=t=>`The id '${t}' is already declared in a map.`;function mc(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Oe(t)?t:Hk;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const Ak=t=>`'${t}' value is already declared in a unique set.`;function Dk(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Oe(t)?t:Ak;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const wp=t=>`There is already registered "${t}" plugin.`,Nk=t=>`There is already registered plugin on priority "${t}".`,kk=t=>`The priority "${t}" is not a number.`,r0=xk({errorPriorityExists:Nk,errorPriorityNaN:kk}),n0=Dk({errorItemExists:wp}),Jg=mc({errorIdExists:wp});function i0(){return[...r0.getItems(),...n0.getItems()]}function vp(t){const e=hc(t);return Jg.getItem(e)}function Lk(t){return!!vp(t)}function El(t,e,r){[t,e,r]=Vk(t,e,r),vp(t)===void 0&&Fk(t,e,r)}function Fk(t,e,r){const n=hc(t);if(Jg.hasItem(n))throw new Error(wp(n));r===void 0?n0.addItem(n):r0.addItem(r,n),Jg.addItem(n,e)}function Vk(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:Wk,getItem:$k,hasItem:o0}=xo("renderers");function SS(t){if(typeof t=="function")return t;if(!o0(t))throw Error(`No registered renderer found under "${t}" name`);return $k(t)}function Bk(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Wk(t,e)}const{register:jk,getItem:zk,hasItem:s0}=xo("validators");function Uk(t){if(typeof t=="function")return t;if(!s0(t))throw Error(`No registered validator found under "${t}" name`);return zk(t)}function Yk(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),jk(t,e)}var RS={},ES;function qk(){if(ES)return RS;ES=1;var t=Fe(),e=_s(),r=Ms(),n=Xa(),i=mp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),RS}qk();var TS={},_S;function Gk(){if(_S)return TS;_S=1;var t=Fe(),e=ot(),r=Ya(),n=Xa(),i=Qu(),o=ct(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),TS}Gk();function Ys(t,e,r){return(e=Kk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kk(t){var e=Xk(t,"string");return typeof e=="symbol"?e:e+""}function Xk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zk{constructor(){Ys(this,"count",0),Ys(this,"startColumn",null),Ys(this,"endColumn",null),Ys(this,"startPosition",null),Ys(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function qs(t,e,r){return(e=Jk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jk(t){var e=Qk(t,"string");return typeof e=="symbol"?e:e+""}function Qk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eL{constructor(){qs(this,"count",0),qs(this,"startRow",null),qs(this,"endRow",null),qs(this,"startPosition",null),qs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Gs(t,e,r){return(e=tL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tL(t){var e=rL(t,"string");return typeof e=="symbol"?e:e+""}function rL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a0{constructor(){Gs(this,"count",0),Gs(this,"startColumn",null),Gs(this,"endColumn",null),Gs(this,"startPosition",null),Gs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ks(t,e,r){return(e=nL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nL(t){var e=iL(t,"string");return typeof e=="symbol"?e:e+""}function iL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l0{constructor(){Ks(this,"count",0),Ks(this,"startRow",null),Ks(this,"endRow",null),Ks(this,"startPosition",null),Ks(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Xs(t,e,r){return(e=oL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oL(t){var e=sL(t,"string");return typeof e=="symbol"?e:e+""}function sL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aL{constructor(){Xs(this,"count",0),Xs(this,"startColumn",0),Xs(this,"endColumn",0),Xs(this,"startPosition",0),Xs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Zs(t,e,r){return(e=lL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lL(t){var e=uL(t,"string");return typeof e=="symbol"?e:e+""}function uL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cL{constructor(){Zs(this,"count",0),Zs(this,"startRow",0),Zs(this,"endRow",0),Zs(this,"startPosition",0),Zs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function OS(t,e,r){return(e=hL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hL(t){var e=dL(t,"string");return typeof e=="symbol"?e:e+""}function dL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fL extends a0{constructor(){super(...arguments),OS(this,"columnStartOffset",0),OS(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function MS(t,e,r){return(e=gL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gL(t){var e=mL(t,"string");return typeof e=="symbol"?e:e+""}function mL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pL extends l0{constructor(){super(...arguments),MS(this,"rowStartOffset",0),MS(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function IS(t,e,r){return(e=wL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wL(t){var e=vL(t,"string");return typeof e=="symbol"?e:e+""}function vL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u0{constructor(e){IS(this,"calculationTypes",[]),IS(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function qr(t,e,r){return(e=yL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yL(t){var e=bL(t,"string");return typeof e=="symbol"?e:e+""}function bL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yp=50;class CL extends u0{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),qr(this,"viewportWidth",0),qr(this,"scrollOffset",0),qr(this,"zeroBasedScrollOffset",0),qr(this,"totalColumns",0),qr(this,"columnWidthFn",null),qr(this,"columnWidth",0),qr(this,"overrideFn",null),qr(this,"inlineStartOffset",0),qr(this,"totalCalculatedWidth",0),qr(this,"startPositions",[]),qr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?yp:r}}function _r(t,e,r){return(e=SL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SL(t){var e=RL(t,"string");return typeof e=="symbol"?e:e+""}function RL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EL extends u0{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),_r(this,"viewportHeight",0),_r(this,"scrollOffset",0),_r(this,"zeroBasedScrollOffset",0),_r(this,"totalRows",0),_r(this,"rowHeightFn",null),_r(this,"rowHeight",0),_r(this,"overrideFn",null),_r(this,"horizontalScrollbarHeight",0),_r(this,"innerViewportHeight",0),_r(this,"totalCalculatedHeight",0),_r(this,"startPositions",[]),_r(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function TL(t,e,r){_L(t,e),e.set(t,r)}function _L(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,r){return(e=OL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OL(t){var e=ML(t,"string");return typeof e=="symbol"?e:e+""}function ML(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ko(t,e){return t.get(c0(t,e))}function xS(t,e,r){return t.set(c0(t,e),r),r}function c0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kn=new WeakMap;class mo{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;PS(this,"row",null),PS(this,"col",null),TL(this,kn,!1),xS(kn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ko(kn,this)}isSouthEastOf(e){return this.row>=e.row&&(ko(kn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ko(kn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ko(kn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ko(kn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof mo&&xS(kn,this,e.isRtl()),this}clone(){return new mo(this.row,this.col,ko(kn,this))}toObject(){return{row:this.row,col:this.col}}}function IL(t,e,r){PL(t,e),e.set(t,r)}function PL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jf(t,e,r){return(e=xL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xL(t){var e=HL(t,"string");return typeof e=="symbol"?e:e+""}function HL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Or(t,e){return t.get(h0(t,e))}function AL(t,e,r){return t.set(h0(t,e),r),r}function h0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qt=new WeakMap;class al{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;jf(this,"highlight",null),jf(this,"from",null),jf(this,"to",null),IL(this,qt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),AL(qt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Or(qt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Or(qt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Or(qt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Or(qt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Or(qt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Or(qt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Or(qt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Or(qt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof mo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Or(qt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Or(qt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new al(this.highlight,this.from,this.to,Or(qt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new mo(e,r,Or(qt,this))}}function gn(t,e,r){DL(t,e),e.set(t,r)}function DL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y(t,e){return t.get(d0(t,e))}function li(t,e,r){return t.set(d0(t,e),r),r}function d0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mr=new WeakMap,zf=new WeakMap,pt=new WeakMap,Lo=new WeakMap,Tl=new WeakMap,Gr=new WeakMap,Uf=new WeakMap,Js=new WeakMap,Bi=new WeakMap,mn=new WeakMap;let f0=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;gn(this,Mr,void 0),gn(this,zf,void 0),gn(this,pt,void 0),gn(this,Lo,void 0),gn(this,Tl,void 0),gn(this,Gr,void 0),gn(this,Uf,void 0),gn(this,Js,void 0),gn(this,Bi,[null,null]),gn(this,mn,[null,null]),li(Mr,this,n),li(zf,this,r),li(pt,this,o),li(Lo,this,s),li(Tl,this,a),li(Gr,this,i),li(Uf,this,e),this.registerEvents()}registerEvents(){Y(Gr,this).addEventListener(Y(pt,this).holder,"contextmenu",n=>this.onContextMenu(n)),Y(Gr,this).addEventListener(Y(pt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Y(Gr,this).addEventListener(Y(pt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Y(Gr,this).addEventListener(Y(pt,this).holder,"touchstart",n=>this.onTouchStart(n)),Y(Gr,this).addEventListener(Y(pt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Y(Gr,this).addEventListener(Y(pt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Y(Mr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Y(Mr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Y(Gr,this).addEventListener(Y(pt,this).holder,"mouseup",n=>this.onMouseUp(n)),Y(Gr,this).addEventListener(Y(pt,this).holder,"mousedown",n=>this.onMouseDown(n))};Ti()?e():(fN()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Y(Js,this)&&n){const[i,o]=[n.row,Y(Js,this).from.row],[s,a]=[n.col,Y(Js,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=Y(pt,this).TABLE,i=vl(e,["TD","TH"],n);return i?(r.coords=Y(pt,this).getCoords(i),r.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(r.coords=Y(Lo,this).getFocusSelection().cellRange.highlight,r.TD=Y(pt,this).getCell(r.coords)):ve(e,"wtBorder")&&ve(e,"area")&&Y(Lo,this).getAreaSelection().cellRange&&(r.coords=Y(Lo,this).getAreaSelection().cellRange.to,r.TD=Y(pt,this).getCell(r.coords)),r}onMouseDown(e){const r=Y(zf,this).rootDocument.activeElement,n=NN(CN,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);ve(i,"corner")?Y(Mr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&Y(Mr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Y(mn,this)[0]=o.TD,clearTimeout(Y(Bi,this)[0]),Y(Bi,this)[0]=setTimeout(()=>{Y(mn,this)[0]=null},1e3))}onContextMenu(e){if(Y(Mr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Y(Mr,this).has("onCellMouseOver"))return;const r=Y(pt,this).TABLE,n=vl(e.target,["TD","TH"],r),i=Y(Tl,this)||this;n&&n!==i.lastMouseOver&&fs(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Y(pt,this).getCoords(n),n))}onMouseOut(e){if(!Y(Mr,this).has("onCellMouseOut"))return;const r=Y(pt,this).TABLE,n=vl(e.target,["TD","TH"],r),i=vl(e.relatedTarget,["TD","TH"],r),o=Y(Tl,this)||this;n&&n!==i&&fs(n,r)&&(this.callListener("onCellMouseOut",e,Y(pt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Y(Mr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Y(mn,this)[0]&&r.TD===Y(mn,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Y(mn,this)[0]=null,Y(mn,this)[1]=null):r.TD===Y(mn,this)[0]&&(Y(mn,this)[1]=r.TD,clearTimeout(Y(Bi,this)[1]),Y(Bi,this)[1]=setTimeout(()=>{Y(mn,this)[1]=null},500)))}onTouchStart(e){li(Js,this,Y(Lo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=he(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Y(Mr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];D_()&&(vN()||yN())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=Y(Mr,this).getSettingPure(e);o&&o(r,n,i,Y(Uf,this).call(this))}destroy(){clearTimeout(Y(Bi,this)[0]),clearTimeout(Y(Bi,this)[1]),Y(Gr,this).destroy()}};function Yf(t,e,r){return(e=NL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NL(t){var e=kL(t,"string");return typeof e=="symbol"?e:e+""}function kL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LL{constructor(e,r,n){Yf(this,"offset",void 0),Yf(this,"total",void 0),Yf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function qf(t,e,r){return(e=FL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FL(t){var e=VL(t,"string");return typeof e=="symbol"?e:e+""}function VL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WL{constructor(e,r,n){qf(this,"offset",void 0),qf(this,"total",void 0),qf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _l(t,e,r){return(e=$L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $L(t){var e=BL(t,"string");return typeof e=="symbol"?e:e+""}function BL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jL{constructor(){_l(this,"currentSize",0),_l(this,"nextSize",0),_l(this,"currentOffset",0),_l(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const zL=0,HS=1,Qg=2;function Gf(t,e,r){return(e=UL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UL(t){var e=YL(t,"string");return typeof e=="symbol"?e:e+""}function YL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qL{constructor(){Gf(this,"size",new jL),Gf(this,"workingSpace",zL),Gf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=HS,e.workingSpace=Qg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Qg,e.workingSpace=HS,this.sharedSize=e.getViewSize()}}var AS={},Kf,DS;function GL(){if(DS)return Kf;DS=1;var t=Ju(),e=TypeError;return Kf=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},Kf}var NS;function KL(){if(NS)return AS;NS=1;var t=Fe(),e=_s(),r=Ms(),n=dT(),i=GL(),o=fT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var w=d;w--;){var v=w+g;w in h?h[v]=h[w]:i(h,v)}for(var C=0;C<g;C++)h[C]=arguments[C]}return n(h,d+g)}}),AS}KL();function XL(t,e,r){return(e=ZL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZL(t){var e=JL(t,"string");return typeof e=="symbol"?e:e+""}function JL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kS{constructor(e,r){XL(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function QL(t,e,r){return(e=eF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eF(t){var e=tF(t,"string");return typeof e=="symbol"?e:e+""}function tF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rF{constructor(e){QL(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new kS(o,r),l=new kS(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Qg)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function Fo(t,e,r){return(e=nF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nF(t){var e=iF(t,"string");return typeof e=="symbol"?e:e+""}function iF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g0{constructor(e,r){Fo(this,"rootNode",void 0),Fo(this,"nodesPool",void 0),Fo(this,"sizeSet",new qL),Fo(this,"collectedNodes",[]),Fo(this,"viewDiffer",new rF(this.sizeSet)),Fo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class m0 extends g0{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function LS(t,e,r){return(e=oF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oF(t){var e=sF(t,"string");return typeof e=="symbol"?e:e+""}function sF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aF{constructor(e){LS(this,"nodeType",void 0),LS(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Qs(t,e,r){return(e=lF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lF(t){var e=uF(t,"string");return typeof e=="symbol"?e:e+""}function uF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ll{constructor(e,r){Qs(this,"nodesPool",null),Qs(this,"nodeType",void 0),Qs(this,"rootNode",void 0),Qs(this,"table",null),Qs(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new aF(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function FS(t,e,r){return(e=cF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cF(t){var e=hF(t,"string");return typeof e=="symbol"?e:e+""}function hF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dF extends ll{constructor(){super("TH"),FS(this,"orderViews",new WeakMap),FS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new m0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),ol(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(d,[QD(),oN(),up(h+1),Po(-1)]),r[h](a,d,h)}u.end()}}}class fF extends ll{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&ys(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Me(this.rootNode,[O_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Me(s,[M_(),P_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),ol(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(u,[up(a+1+this.table.rowHeadersCount),Po(-1),eN(),...a>=0?[iN()]:[JD(),Au("Select whole grid")]]),n[r](l,u,r)}}}}let VS=!1;class gF extends ll{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!VS&&e>1e3&&(VS=!0,Vr(ir`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&X(n,"rowHeader")}}function mF(t,e,r){return(e=pF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pF(t){var e=wF(t,"string");return typeof e=="symbol"?e:e+""}function wF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vo={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let WS=!1;class vF extends ll{constructor(e){super("TR",e),mF(this,"orderView",void 0),this.orderView=new g0(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!WS&&e>1e3&&(WS=!0,Vr(ir`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Me(this.rootNode,[O_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Me(o,[M_(),P_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?ve(o,Vo.rowEven)||(xe(o,Vo.rowOdd),X(o,Vo.rowEven)):ve(o,Vo.rowOdd)||(xe(o,Vo.rowEven),X(o,Vo.rowOdd))}this.orderView.end()}}function $S(t,e,r){return(e=yF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yF(t){var e=bF(t,"string");return typeof e=="symbol"?e:e+""}function bF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CF extends ll{constructor(){super("TD"),$S(this,"orderViews",new WeakMap),$S(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new m0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),w=c.getCurrentNode();if(ve(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),ol(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,w),this.table.isAriaEnabled()){var o,s;Me(w,[...w.hasAttribute("role")?[]:[ZD()],Po(-1),up(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function st(t,e,r){return(e=SF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SF(t){var e=RF(t,"string");return typeof e=="symbol"?e:e+""}function RF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EF{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};st(this,"rootNode",void 0),st(this,"rootDocument",void 0),st(this,"rowHeaders",null),st(this,"columnHeaders",null),st(this,"colGroup",null),st(this,"rows",null),st(this,"cells",null),st(this,"rowFilter",null),st(this,"columnFilter",null),st(this,"rowUtils",null),st(this,"columnUtils",null),st(this,"rowsToRender",0),st(this,"columnsToRender",0),st(this,"rowHeaderFunctions",[]),st(this,"rowHeadersCount",0),st(this,"columnHeaderFunctions",[]),st(this,"columnHeadersCount",0),st(this,"cellRenderer",void 0),st(this,"activeOverlayName",void 0),st(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class TF{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new EF(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new dF,columnHeaders:new fF(r),colGroup:new gF(n),rows:new vF(i),cells:new CF}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Xf(t,e,r){return(e=_F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _F(t){var e=OF(t,"string");return typeof e=="symbol"?e:e+""}function OF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MF{constructor(e,r){Xf(this,"dataAccessObject",void 0),Xf(this,"wtSettings",void 0),Xf(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function BS(t,e,r){return(e=IF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IF(t){var e=PF(t,"string");return typeof e=="symbol"?e:e+""}function PF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xF{constructor(e,r){BS(this,"dataAccessObject",void 0),BS(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function pn(t,e,r){return(e=HF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HF(t){var e=AF(t,"string");return typeof e=="symbol"?e:e+""}function AF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class As{constructor(e,r,n,i,o){pn(this,"wtSettings",null),pn(this,"domBindings",void 0),pn(this,"TBODY",null),pn(this,"THEAD",null),pn(this,"COLGROUP",null),pn(this,"hasTableHeight",!0),pn(this,"hasTableWidth",!0),pn(this,"isTableVisible",!1),pn(this,"tableOffset",0),pn(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,V_(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new xF(this.dataAccessObject,this.wtSettings),this.columnUtils=new MF(this.dataAccessObject,this.wtSettings),this.tableRenderer=new TF({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Me(n,[Ei()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(n,[Ei()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Me(n,[Po(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Me(n.parentNode,[Ei()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(n,[Ei()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Dr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,w!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Dr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new WL(g,o,c),this.columnFilter=new LL(w,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),v=C.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Rn)||this.is(Ii))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Rn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Rn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Ia(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Rn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=k_(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=EN(n),s=r.cellIndex;Wi(vo,r,this.wtRootElement)||Wi(po,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Wi(Ii,r,this.wtRootElement)||Wi(Rn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Wi(vo,r,this.wtRootElement)||Wi(wo,r,this.wtRootElement)||Wi(Ii,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Ia(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?or:Ia,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const w=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-w||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return nr(this.TABLE)}getHeight(){return or(this.TABLE)}getTotalWidth(){const e=nr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=or(this.hider);return e!==0?e:this.getHeight()}isVisible(){return $a(this.TABLE)}_modifyRowHeaderWidth(e){let r=Oe(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const DF="stickyRowsBottom",bp={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ri(bp,"MIXIN_NAME",DF,{writable:!1,enumerable:!1});const NF="stickyColumnsStart",pc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ri(pc,"MIXIN_NAME",NF,{writable:!1,enumerable:!1});class Cp extends As{constructor(e,r,n,i){super(e,r,n,i,Ii)}}Je(Cp,bp);Je(Cp,pc);const po="top",Rn="bottom",wo="inline_start",vo="top_inline_start_corner",Ii="bottom_inline_start_corner",p0=[po,Rn,wo,vo,Ii],kF=new Map([[po,`ht_clone_${po}`],[Rn,`ht_clone_${Rn}`],[wo,`ht_clone_${wo} ht_clone_left`],[vo,`ht_clone_${vo} ht_clone_top_left_corner`],[Ii,`ht_clone_${Ii} ht_clone_bottom_left_corner`]]);function LF(t,e){FF(t,e),e.add(t)}function FF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VF(t,e,r){return(e=WF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WF(t){var e=$F(t,"string");return typeof e=="symbol"?e:e+""}function $F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ol(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ea=new WeakSet;class BF{constructor(e){LF(this,ea),VF(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=pr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=pr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Ol(ea,this,zS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Ol(ea,this,zS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Ol(ea,this,jS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Ol(ea,this,jS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function jS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Dr(n.wtRootElement).left;const u=Math.abs(B_(s,s));if(l>u){const c=j_(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function zS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Dr(r.wtRootElement),a=fp(o,o);if(s.top>a){const l=Ia(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Ir(t,e,r){return(e=jF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jF(t){var e=zF(t,"string");return typeof e=="symbol"?e:e+""}function zF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sp{get eventManager(){return new Hi(this)}constructor(e,r){Ir(this,"wtTable",void 0),Ir(this,"wtScroll",void 0),Ir(this,"wtViewport",void 0),Ir(this,"wtOverlays",void 0),Ir(this,"selectionManager",void 0),Ir(this,"wtEvent",void 0),Ir(this,"guid",`wt_${E_()}`),Ir(this,"drawInterrupted",!1),Ir(this,"drawn",!1),Ir(this,"activeOverlayName","master"),Ir(this,"domBindings",void 0),Ir(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new BF(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){sl(n,e[r])}])}}createCellCoords(e,r){return new mo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new al(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||_N(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function US(t,e,r){return(e=UF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UF(t){var e=YF(t,"string");return typeof e=="symbol"?e:e+""}function YF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qF extends Sp{constructor(e,r,n){super(e,r),US(this,"cloneSource",void 0),US(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new f0(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function GF(t,e,r){return(e=KF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KF(t){var e=XF(t,"string");return typeof e=="symbol"?e:e+""}function XF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ul{constructor(e,r,n,i,o){GF(this,"wtSettings",null),ri(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Nu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Nu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Du(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Vr(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+jt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(p0.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${kF.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Me(o,[Ei()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===po||u==="vertical"&&this.type===wo?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Du(e.TABLE),new qF(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class ZF extends ul{constructor(e,r,n,i,o,s){super(e,r,Ii,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Cp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else fc(r),this.repositionOverlay();let n=or(this.clone.wtTable.TABLE);const i=nr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=jt(n)),i.style.bottom=`${o}px`}}const JF="calculatedColumns",wc={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ri(wc,"MIXIN_NAME",JF,{writable:!1,enumerable:!1});class Rp extends As{constructor(e,r,n,i){super(e,r,n,i,Rn)}}Je(Rp,bp);Je(Rp,wc);function QF(t,e,r){return(e=eV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eV(t){var e=tV(t,"string");return typeof e=="symbol"?e:e+""}function tV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rV extends ul{constructor(e,r,n,i){super(e,r,Rn,n,i),QF(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Rp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=jt(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(dp(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=or(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=jt(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return fp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(xe(s,"innerBorderBottom"),o=a)}return o}}const nV="calculatedRows",Ep={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ri(Ep,"MIXIN_NAME",nV,{writable:!1,enumerable:!1});class Tp extends As{constructor(e,r,n,i){super(e,r,n,i,wo)}}Je(Tp,Ep);Je(Tp,pc);const iV="localHooks",Pn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Gg(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ri(Pn,"MIXIN_NAME",iV,{writable:!1,enumerable:!1});let w0=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Je(w0,Pn);const oV="active-header",v0="header",_p="area",Fu="focus",sV="fill",aV="row",lV="column",uV="custom-selection",Op=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var YS={},qS;function cV(){if(qS)return YS;qS=1;var t=mp();return t("flat"),YS}cV();function hV(t,e){y0(t,e),e.add(t)}function GS(t,e,r){y0(t,e),e.set(t,r)}function y0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(Pa(t,e))}function KS(t,e,r){return t.set(Pa(t,e),r),r}function Pa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Zr=new WeakMap,Mt=new WeakMap,Ml=new WeakSet;class dV{constructor(){hV(this,Ml),GS(this,Zr,void 0),GS(this,Mt,void 0)}setActiveOverlay(e){return KS(Mt,this,e),this}setActiveSelection(e){return KS(Zr,this,e),this}scan(){const e=qe(Zr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=qe(Zr,this).getCorners(),{wtTable:s}=qe(Mt,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let w=s.getColumnHeader(h,g);const v=qe(Mt,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:qe(Zr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==h&&(w=s.getColumnHeader(v,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=qe(Zr,this).getCorners(),{wtTable:s}=qe(Mt,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let w=s.getRowHeader(h,g);const v=qe(Mt,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:qe(Zr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==h&&(w=s.getRowHeader(v,g)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=qe(Mt,this);Pa(Ml,this,fV).call(this,(n,i)=>{const o=r.getCell(qe(Mt,this).createCellCoords(n,i)),s=qe(Mt,this).getSetting("onAfterDrawSelection",n,i,qe(Zr,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=qe(Zr,this).getCorners(),{wtTable:i}=qe(Mt,this);Pa(Ml,this,XS).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(qe(Mt,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=qe(Zr,this).getCorners(),{wtTable:i}=qe(Mt,this);Pa(Ml,this,XS).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(qe(Mt,this).createCellCoords(o,s));e(a)}})}}function fV(t){let[e,r,n,i]=qe(Zr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=qe(Mt,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(qe(Mt,this).createCellCoords(e,r));if(!co(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function XS(t){const{wtTable:e}=qe(Mt,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class ZS{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Op(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),gc(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ti()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};He(h,(g,w)=>{this.selectionHandles.styles.bottomHitArea[w]=g,this.selectionHandles.styles.topHitArea[w]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};He(d,(g,w)=>{this.selectionHandles.styles.bottom[w]=g,this.selectionHandles.styles.top[w]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const b=Math.min(parseInt(i+o,10),C-w-g*2),E=Math.min(parseInt(i+o-v/4,10),C-v-g*2);h[l]=`${b}px`,d[l]=`${E}px`;const y=Math.min(parseInt(n+s,10),T-w-g*2),I=Math.min(parseInt(n+s-v/4,10),T-v-g*2);h.top=`${y}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),w=s.getLastRenderedColumn();if(g<0&&w<0||h<0&&d<0){this.disappear();return}let v;if(u){if(n=Math.max(n,g),o=Math.min(o,w),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}v=s.getCell(this.wot.createCellCoords(r,n))}else if(v=s.getCell(this.wot.createCellCoords(r,n)),!co(v)){this.disappear();return}const C=u?s.getCell(this.wot.createCellCoords(i,o)):v,T=Dr(v),b=u?Dr(C):T,E=Dr(s.TABLE),y=T.top,I=T.left,x=this.wot.wtSettings.getSetting("rtlMode");let P=0,A=0;if(x){const Ee=nr(s.TABLE),Ye=nr(v),$e=l.innerWidth-E.left-Ee;A=I+Ye-b.left,P=l.innerWidth-I-Ye-$e-1}else A=b.left+nr(C)-I,P=I-E.left-1;if(this.isEntireColumnSelected(r,i)){const Ee=r,Ye=this.getDimensionsFromHeader("columns",n,o,Ee,E);let $e=null;Ye&&([$e,P,A]=Ye),$e&&(v=$e)}let F=y-E.top-1,W=b.top+or(C)-y;if(this.isEntireRowSelected(n,o)){const Ee=n,Ye=this.getDimensionsFromHeader("rows",r,i,Ee,E);let $e=null;Ye&&([$e,F,W]=Ye),$e&&(v=$e)}const q=l.getComputedStyle(v);parseInt(q.borderTopWidth,10)>0&&(F+=1,W=W>0?W-1:0),parseInt(q[x?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,A=A>0?A-1:0);const L=x?"right":"left",se=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${F}px`,this.topStyle[L]=`${P}px`,this.topStyle.width=`${A+se}px`,this.topStyle.display="block",this.startStyle.top=`${F}px`,this.startStyle[L]=`${P}px`,this.startStyle.height=`${W+se}px`,this.startStyle.display="block",this.bottomStyle.top=`${F+W-parseInt(this.bottomStyle.height,10)+se}px`,this.bottomStyle[L]=`${P}px`,this.bottomStyle.width=`${A+se}px`,this.bottomStyle.display="block",this.endStyle.top=`${F}px`,this.endStyle[L]=`${P+A-parseInt(this.endStyle.width,10)+se}px`,this.endStyle.height=`${W+se}px`,this.endStyle.display="block";let K=this.settings.border.cornerVisible;K=typeof K=="function"?K(this.settings.layerLevel):K;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[dt,Re]=[i,o];if(te&&Array.isArray(te)&&([,,dt,Re]=te),Ti()||!K||this.isPartRange(dt,Re))this.cornerStyle.display="none";else{this.cornerStyle.top=`${F+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${P+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ee=Nu(s.TABLE);const Ye=Ee===l;Ye&&(Ee=a.documentElement);const $e=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ie=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),cn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const Te=Ye?C.getBoundingClientRect().left:C.offsetLeft;let f=!1,m=0;if(x?(m=Te-parseInt(this.cornerDefaultStyle.width,10)/2,f=m<0):(m=Te+nr(C)+parseInt(this.cornerDefaultStyle.width,10)/2,f=m>=j_(Ee)),f){const p=Math.floor(P+A+this.cornerCenterPointOffset-Ie-$e);c?(this.cornerStyle[L]=`${p}px`,this.cornerStyle[x?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${p-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Ye?C.getBoundingClientRect().top:C.offsetTop)+or(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Ia(Ee)){const p=Math.floor(F+W+this.cornerCenterPointOffset-cn-$e);c?(this.cornerStyle.top=`${p}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${p-1}px`}this.cornerStyle.display="block"}Ti()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,F,P,A,W)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return or(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return nr(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(w=l(r,C-i),v=l(n,C-i),!w||!v)return!1;const T=Dr(w),b=Dr(v);return w&&v&&(h=T[g]-o[g]-1,d=b[g]+u(v)-T[g]),[w,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?X(this[e],"hidden"):(ve(this[e],"hidden")&&xe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?X(this[e],"hidden"):xe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ti()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function gV(t,e){b0(t,e),e.add(t)}function Wo(t,e,r){b0(t,e),e.set(t,r)}function b0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(Mp(t,e))}function JS(t,e,r){return t.set(Mp(t,e),r),r}function Mp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var It=new WeakMap,Qt=new WeakMap,Zf=new WeakMap,ya=new WeakMap,Jf=new WeakMap,ji=new WeakMap,QS=new WeakSet;class mV{constructor(e){gV(this,QS),Wo(this,It,void 0),Wo(this,Qt,void 0),Wo(this,Zf,new dV),Wo(this,ya,new WeakMap),Wo(this,Jf,new WeakSet),Wo(this,ji,new Map),JS(Qt,this,e)}setActiveOverlay(e){return JS(It,this,e),le(Zf,this).setActiveOverlay(le(It,this)),le(ya,this).has(le(It,this))||le(ya,this).set(le(It,this),new Set),this}getFocusSelection(){return le(Qt,this)!==null?le(Qt,this).getFocus():null}getAreaSelection(){return le(Qt,this)!==null?le(Qt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(ji,this).has(e)){const n=le(ji,this).get(e);if(n.has(le(It,this)))return n.get(le(It,this));const i=new ZS(le(It,this),e.settings);return n.set(le(It,this),i),i}const r=new ZS(le(It,this),e.settings);return le(ji,this).set(e,new Map([[le(It,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(ji,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(ji,this).get(e).forEach(r=>r.destroy()),le(ji,this).delete(e)}render(e){if(le(Qt,this)===null)return;e&&Mp(QS,this,pV).call(this);const r=Array.from(le(Qt,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(Jf,this).has(s)||(le(Jf,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&le(Zf,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const v=n.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const d=s.getCorners();le(It,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(ya,this).get(le(It,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=le(Qt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Me(s,le(Qt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Me(o,[...i.get(o)])})}}function pV(){const t=le(ya,this).get(le(It,this)),e=le(It,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(It,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(Qt,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(Qt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(Qt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(Qt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)xe(o[a],r),ol(o[a],s)}),t.clear()}class wV extends ul{constructor(e,r,n,i){super(e,r,wo,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Tp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),gp(n,`${o}px`,"0px")):(o=this.getScrollPosition(),fc(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,$_(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=nr(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Op(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=jt(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,MN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(B_(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?xe(n,"emptyRows"):X(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(n,"innerBorderInlineStart");e?(X(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(xe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const vV="stickyRowsTop",Ip={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ri(Ip,"MIXIN_NAME",vV,{writable:!1,enumerable:!1});class Pp extends As{constructor(e,r,n,i){super(e,r,n,i,vo)}}Je(Pp,Ip);Je(Pp,pc);function eR(t,e,r){return(e=yV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yV(t){var e=bV(t,"string");return typeof e=="symbol"?e:e+""}function bV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CV extends ul{constructor(e,r,n,i,o,s){super(e,r,vo,n,i),eR(this,"topOverlay",void 0),eR(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Pp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();gp(e,`${i}px`,`${o}px`)}else fc(e);let r=or(this.clone.wtTable.TABLE);const n=nr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class xp extends As{constructor(e,r,n,i){super(e,r,n,i,po)}}Je(xp,Ip);Je(xp,wc);function SV(t,e,r){return(e=RV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RV(t){var e=EV(t,"string");return typeof e=="symbol"?e:e+""}function EV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TV extends ul{constructor(e,r,n,i){super(e,r,po,n,i),SV(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new xp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),gp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),fc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(dp(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=or(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Op(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=jt(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,ON(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return fp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?xe(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(xe(i,"innerBorderTop"),a=h)}}return a}}function Il(t,e,r){_V(t,e),e.set(t,r)}function _V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ln(t,e,r){return(e=OV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OV(t){var e=MV(t,"string");return typeof e=="symbol"?e:e+""}function MV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zi(t,e,r){return t.set(C0(t,e),r),r}function Fn(t,e){return t.get(C0(t,e))}function C0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $o=new WeakMap,Pl=new WeakMap,Bo=new WeakMap,xl=new WeakMap;class IV{constructor(e,r,n,i,o,s){Ln(this,"wot",null),Il(this,$o,[]),Ln(this,"topOverlay",null),Ln(this,"bottomOverlay",null),Ln(this,"inlineStartOverlay",null),Ln(this,"topInlineStartCornerOverlay",null),Ln(this,"bottomInlineStartCornerOverlay",null),Ln(this,"browserLineHeight",void 0),Ln(this,"wtSettings",null),Il(this,Pl,!1),Il(this,Bo,0),Il(this,xl,null),Ln(this,"resizeObserver",new ResizeObserver(c=>{qg(()=>{!Array.isArray(c)||!c.length||(zi(Bo,this,Fn(Bo,this)+1),Fn(Bo,this)===300&&(Vr("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Fn(xl,this)!==null&&clearTimeout(Fn(xl,this)),zi(xl,this,setTimeout(()=>{zi(Bo,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=jt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Du(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Fn($o,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TV(...e),this.bottomOverlay=new rV(...e),this.inlineStartOverlay=new wV(...e),this.topInlineStartCornerOverlay=new CV(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new ZF(...e,this.bottomOverlay,this.inlineStartOverlay),zi($o,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){zi(Pl,this,Fn($o,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Fn($o,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Fn($o,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!wN())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{qg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{zi(Bo,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=VN(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Fn(Pl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),zi(Pl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Du(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),g=r.hider.style,w=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),C=w()?1:0,T=v()?1:0;g.width=`${h+T}px`,g.height=`${c+C}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return j(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];j(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function tR(t,e,r){return(e=PV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PV(t){var e=xV(t,"string");return typeof e=="symbol"?e:e+""}function xV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HV{constructor(e){tR(this,"settings",{}),tR(this,"defaults",Object.freeze(this.getDefaults())),He(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);sl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?He(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Hp extends As{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Nu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=YC(e,"height",r),o=YC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=$a(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Je(Hp,Ep);Je(Hp,wc);class AV{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new cL:new pL],["fullyVisible",()=>new eL],["partiallyVisible",()=>new l0]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new aL:new fL],["fullyVisible",()=>new Zk],["partiallyVisible",()=>new a0]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=or(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?jt():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Dr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=or(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=nr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=jt(this.domBindings.rootDocument),new EL({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=jt(this.domBindings.rootDocument)),new CL({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible"),s=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:o,endRow:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;n=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:o,endColumn:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;n=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){He(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class DV extends Sp{constructor(e,r){super(e,new HV(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Hp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new AV(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new mV(this.wtSettings.getSetting("selections")),this.wtEvent=new f0(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new IV(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];He(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),xe(this.wtTable.wtRootElement.parentNode,r),X(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!p0.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Ap{constructor(e){e instanceof Sp?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Ap(r);return()=>n},this._wot=new DV(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function rR(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function NV(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function nR(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const kV=new Map([["touchstart",rR],["touchend",nR],["mousedown",rR],["mouseover",NV],["mouseup",nR]]);function Qf(t,e){kV.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:K_(t)||t.type==="touchstart",isRightClick:ku(t),...e})}const S0=new WeakMap,Dp=Symbol("rootInstance");function LV(t){S0.set(t,!0)}function FV(t){return t===Dp}function Qi(t){return S0.has(t)}function VV(t,e){R0(t,e),e.add(t)}function ui(t,e,r){R0(t,e),e.set(t,r)}function R0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ci(t,e,r){return(e=WV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WV(t){var e=$V(t,"string");return typeof e=="symbol"?e:e+""}function $V(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function et(t,e){return t.get(ps(t,e))}function Gt(t,e,r){return t.set(ps(t,e),r),r}function ps(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var eg=new WeakMap,Hl=new WeakMap,Al=new WeakMap,Vn=new WeakMap,Kr=new WeakMap,tg=new WeakMap,rg=new WeakMap,jo=new WeakMap,ba=new WeakSet;class BV{constructor(e){VV(this,ba),ci(this,"hot",void 0),ci(this,"eventManager",void 0),ci(this,"settings",void 0),ci(this,"THEAD",void 0),ci(this,"TBODY",void 0),ci(this,"_wt",void 0),ci(this,"activeWt",void 0),ui(this,eg,0),ui(this,Hl,0),ci(this,"postponedAdjustElementsSize",!1),ui(this,Al,!1),ui(this,Vn,void 0),ui(this,Kr,void 0),ui(this,tg,0),ui(this,rg,0),ui(this,jo,null),this.hot=e,this.eventManager=new Hi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),ps(ba,this,zV).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),X(e,"handsontable"),Gt(Kr,this,r.createElement("TABLE")),X(et(Kr,this),"htCore"),this.hot.getSettings().tableClassName&&X(et(Kr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Me(et(Kr,this),[Ei()]),Me(e,[XD(),I_(-1),dc(this.hot.countCols()),lN()])),this.THEAD=r.createElement("THEAD"),et(Kr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),et(Kr,this).appendChild(this.TBODY),this.hot.table=et(Kr,this),this.hot.container.insertBefore(et(Kr,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:o}=this.hot,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Gt(Al,this,!0),this.isTextSelectionAllowed(l.target)||(qC(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Gt(Al,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{et(Al,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&qC(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{var u;i.isInProgress()&&K_(l)&&i.finish(),Gt(Vn,this,!1);const c=U_(n.activeElement),h=(u=n.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(n.activeElement);mu(n.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!ku(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&ku(l)&&(i.finish(),Gt(Vn,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Gt(Vn,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(et(Vn,this)||!r||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(d===g){const v=jt(n);if(n.elementFromPoint(c+v,h)!==g||n.elementFromPoint(c,h+v)!==g)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===r)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Wa(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Wa(a);this.eventManager.addEventListener(et(Kr,this),"selectstart",l=>{this.settings.fragmentSelection||mu(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&X(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&xe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:et(Kr,this),isDataViewInstance:()=>Qi(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Gt(Hl,this,o.length),this.hot.getSettings().ariaTags&&ps(ba,this,E0).call(this)===this.hot.countCols()&&ps(ba,this,jV).call(this,et(Hl,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Gt(eg,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),w=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,v,g),this.hot.runHooks("afterRenderer",a,l,u,w,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&$a(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Gt(Vn,this,!0),Gt(jo,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!to(o)&&(Qf(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Gt(Vn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!to(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!to(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!to(o)&&(et(Vn,this)&&(!et(jo,this)||et(jo,this).x!==o.clientX||et(jo,this).y!==o.clientY)&&Qf(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Gt(jo,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(to(o)||this.hot.isDestroyed)&&(Qf(o,{coords:u,selection:this.hot.selection,cellRangeMapper:tk(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[w,v,C,T]=g;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Ap(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(mu(e))return!0;const i=fs(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return et(Vn,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!ve(n,"relative")){ys(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",X(s,["relative",...o()])):(ys(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Me(a,...Ei()),Me(l,...Ei())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?W_(e,n(r,i)):(sl(e,"Â "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Gt(tg,this,e),Gt(rg,this,r)}getLastSize(){return{width:et(tg,this),height:et(rg,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return et(eg,this)}getRowHeadersCount(){return et(Hl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function E0(){return parseInt(this.hot.rootElement.getAttribute(dc()[0]),10)}function jV(t){const e=ps(ba,this,E0).call(this)+t;Me(this.hot.rootElement,...dc(e))}function zV(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):xe(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?X(t,"htVerticallyScrollableByWindow"):xe(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):xe(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?X(t,"htHorizontallyScrollableByWindow"):xe(t,"htHorizontallyScrollableByWindow")}var iR={},oR={},sR;function UV(){if(sR)return oR;sR=1;var t=Fe(),e=wt(),r=Is(),n=Cr(),i=vt(),o=ki(),s=Sr(),a=Oo(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,w){if(!c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),oR}var aR;function YV(){return aR||(aR=1,UV()),iR}YV();const qV="ABCDEFGHIJKLMNOPQRSTUVWXYZ",lR=qV.length;function GV(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%lR,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/lR,10);return r}function T0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&nt(t[0])&&(e=cp(t[0]))),e}function ta(t,e,r){return(e=KV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KV(t){var e=XV(t,"string");return typeof e=="symbol"?e:e+""}function XV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZV{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];ta(this,"hot",void 0),ta(this,"data",void 0),ta(this,"dataType","array"),ta(this,"colToProp",()=>{}),ta(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return j(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Ge(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(nt(a)||Oe(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Ge(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?_f(l,d,g):l[d]=g}})}else He(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?_f(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=pr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:_f(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?Yg(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=pr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Ge(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return T0(this.data)}destroy(){this.data=null,this.hot=null}}var uR={},cR={},hR;function JV(){if(hR)return cR;hR=1;var t=Fe(),e=wt(),r=Is(),n=Cr(),i=vt(),o=ki(),s=Sr(),a=Oo(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),cR}var dR;function QV(){return dR||(dR=1,JV()),uR}QV();function fR(t,e,r){return(e=eW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eW(t){var e=tW(t,"string");return typeof e=="symbol"?e:e+""}function tW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fR(this,"indexedValues",[]),fR(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Oe(this.initValueOrFn)?Ge(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ge(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Je(cl,Pn);function _0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Oe(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function O0(t,e){return ap(t,(r,n)=>e.includes(n)===!1)}class vc extends cl{insert(e,r){this.indexedValues=_0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=O0(this.indexedValues,e),super.remove(e)}}class M0 extends vc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Io(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function I0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Vu(t,e){return ap(t,r=>e.includes(r)===!1)}function P0(t,e){return _n(t,r=>r-e.filter(n=>n<r).length)}function x0(t,e){const r=e[0],n=e.length;return _n(t,i=>i>=r?i+n:i)}function rW(t,e,r){return(e=nW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nW(t){var e=iW(t,"string");return typeof e=="symbol"?e:e+""}function iW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oW extends cl{constructor(){super(...arguments),rW(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Vu(this.orderOfIndexes,[e]),Oe(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=_0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=x0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=O0(this.indexedValues,e),this.orderOfIndexes=Vu(this.orderOfIndexes,e),this.orderOfIndexes=P0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class H0 extends vc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Io(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class sW extends cl{constructor(){super(e=>e)}insert(e,r){const n=x0(this.indexedValues,r);this.indexedValues=I0(n,e,r),super.insert(e,r)}remove(e){const r=Vu(this.indexedValues,e);this.indexedValues=P0(r,e),super.remove(e)}}const gR=new Map([["hiding",M0],["index",cl],["linkedPhysicalIndexToValue",oW],["physicalIndexToValue",vc],["trimming",H0]]);function aW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!gR.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(gR.get(t))(e)}function lW(t,e,r){return(e=uW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uW(t){var e=cW(t,"string");return typeof e=="symbol"?e:e+""}function cW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Np{constructor(){lW(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);he(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Bt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Je(Np,Pn);function ng(t,e,r){return(e=hW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hW(t){var e=dW(t,"string");return typeof e=="symbol"?e:e+""}function dW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mR extends Np{constructor(e,r){super(),ng(this,"mergedValuesCache",[]),ng(this,"aggregationFunction",void 0),ng(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=_n(this.get(),o=>o.getValues()),n=[],i=he(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return _n(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return he(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function fW(t,e,r){gW(t,e),e.set(t,r)}function gW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mW(t,e,r){return t.set(A0(t,e),r),r}function pW(t,e){return t.get(A0(t,e))}function A0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ig=new WeakMap;class D0{constructor(){fW(this,ig,[])}subscribe(e){return this.addLocalHook("change",e),this._write(pW(ig,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){mW(ig,this,e)}}Je(D0,Pn);function pR(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ra(t,e,r){wW(t,e),e.set(t,r)}function wW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pr(t,e){return t.get(N0(t,e))}function Dl(t,e,r){return t.set(N0(t,e),r),r}function N0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nl=new WeakMap,na=new WeakMap,kl=new WeakMap,Ll=new WeakMap,Fl=new WeakMap;class vW{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ra(this,Nl,new Set),ra(this,na,[]),ra(this,kl,[]),ra(this,Ll,!1),ra(this,Fl,!1),Dl(Fl,this,e??!1)}createObserver(){const e=new D0;return Pr(Nl,this).add(e),e.addLocalHook("unsubscribe",()=>{Pr(Nl,this).delete(e)}),e._writeInitialChanges(pR(Pr(na,this),Pr(kl,this))),e}emit(e){let r=Pr(kl,this);(!Pr(Ll,this)||Pr(na,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Pr(Fl,this)):Dl(na,this,new Array(e.length).fill(Pr(Fl,this))),Pr(Ll,this)||(Dl(Ll,this,!0),r=Pr(na,this)));const n=pR(r,e);Pr(Nl,this).forEach(i=>i._write(n)),Dl(kl,this,e)}}function kt(t,e,r){return(e=yW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yW(t){var e=bW(t,"string");return typeof e=="symbol"?e:e+""}function bW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class em{constructor(){kt(this,"indexesSequence",new sW),kt(this,"trimmingMapsCollection",new mR(e=>e.some(r=>r===!0),!1)),kt(this,"hidingMapsCollection",new mR(e=>e.some(r=>r===!0),!1)),kt(this,"variousMapsCollection",new Np),kt(this,"hidingChangesObservable",new vW({initialIndexValue:!1})),kt(this,"notTrimmedIndexesCache",[]),kt(this,"notHiddenIndexesCache",[]),kt(this,"isBatched",!1),kt(this,"indexesSequenceChanged",!1),kt(this,"indexesChangeSource",void 0),kt(this,"trimmedIndexesChanged",!1),kt(this,"hiddenIndexesChanged",!1),kt(this,"renderablePhysicalIndexesCache",[]),kt(this,"fromPhysicalToVisualIndexesCache",new Map),kt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,aW(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof H0?this.trimmingMapsCollection.register(e,r):r instanceof M0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return he(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return he(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return he(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return he(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=_n(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Vu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(I0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=he(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=_n(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Je(em,Pn);function CW(t,e){return He(e,(r,n)=>{Bt(t[n])&&(t[n]=r)}),t}function k0(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function L0(t){he(t)&&$N(ir`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function SW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function F0(t,e){return Array.isArray(t)?t.map(r=>F0(r,e)):T_(t,e)}const{register:RW,getValues:EW}=xo("phraseFormatters");function V0(t,e){RW(t,e)}function TW(){return EW()}V0("pluralize",SW);V0("substitute",F0);const W0="ContextMenu:items",re=W0,kp=`${re}.noItems`,Lp=`${re}.insertRowAbove`,Fp=`${re}.insertRowBelow`,Vp=`${re}.insertColumnOnTheLeft`,Wp=`${re}.insertColumnOnTheRight`,$p=`${re}.removeRow`,Bp=`${re}.removeColumn`,jp=`${re}.undo`,zp=`${re}.redo`,Wu=`${re}.readOnly`,Up=`${re}.clearColumn`,Yp=`${re}.copy`,qp=`${re}.copyWithHeaders`,Gp=`${re}.copyWithGroupHeaders`,Kp=`${re}.copyHeadersOnly`,Xp=`${re}.cut`,$0=`${re}.freezeColumn`,B0=`${re}.unfreezeColumn`,j0=`${re}.mergeCells`,z0=`${re}.unmergeCells`,U0=`${re}.addComment`,Y0=`${re}.editComment`,q0=`${re}.removeComment`,G0=`${re}.readOnlyComment`,Zp=`${re}.align`,Jp=`${re}.align.left`,Qp=`${re}.align.center`,ew=`${re}.align.right`,tw=`${re}.align.justify`,rw=`${re}.align.top`,nw=`${re}.align.middle`,iw=`${re}.align.bottom`,K0=`${re}.borders`,X0=`${re}.borders.top`,Z0=`${re}.borders.right`,J0=`${re}.borders.bottom`,Q0=`${re}.borders.left`,eO=`${re}.borders.remove`,tO=`${re}.nestedHeaders.insertChildRow`,rO=`${re}.nestedHeaders.detachFromParent`,nO=`${re}.hideColumn`,iO=`${re}.showColumn`,oO=`${re}.hideRow`,sO=`${re}.showRow`,sr="Filters:",Qe=`${sr}conditions`,aO=`${Qe}.none`,lO=`${Qe}.isEmpty`,uO=`${Qe}.isNotEmpty`,cO=`${Qe}.isEqualTo`,hO=`${Qe}.isNotEqualTo`,dO=`${Qe}.beginsWith`,fO=`${Qe}.endsWith`,gO=`${Qe}.contains`,mO=`${Qe}.doesNotContain`,_W=`${Qe}.byValue`,pO=`${Qe}.greaterThan`,wO=`${Qe}.greaterThanOrEqualTo`,vO=`${Qe}.lessThan`,yO=`${Qe}.lessThanOrEqualTo`,bO=`${Qe}.isBetween`,CO=`${Qe}.isNotBetween`,SO=`${Qe}.after`,RO=`${Qe}.before`,EO=`${Qe}.today`,TO=`${Qe}.tomorrow`,_O=`${Qe}.yesterday`,OO=`${sr}labels.filterByCondition`,MO=`${sr}labels.filterByValue`,IO=`${sr}labels.conjunction`,PO=`${sr}labels.disjunction`,xO=`${sr}values.blankCells`,HO=`${sr}buttons.selectAll`,AO=`${sr}buttons.clear`,DO=`${sr}buttons.ok`,NO=`${sr}buttons.cancel`,kO=`${sr}buttons.placeholder.search`,LO=`${sr}buttons.placeholder.value`,FO=`${sr}buttons.placeholder.secondValue`,xn="Pagination:",VO=`${xn}section.pagination`,WO=`${xn}.pageSize.auto`,$O=`${xn}section.pageSize`,BO=`${xn}section.counter`,jO=`${xn}section.navigation`,zO=`${xn}firstPage`,UO=`${xn}prevPage`,YO=`${xn}nextPage`,qO=`${xn}lastPage`,ow="CheckboxRenderer:",GO=`${ow}checked`,KO=`${ow}unchecked`,XO="Loading:",ZO=`${XO}title`,OW=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:GO,CHECKBOX_RENDERER_NAMESPACE:ow,CHECKBOX_UNCHECKED:KO,CONTEXTMENU_ITEMS_ADD_COMMENT:U0,CONTEXTMENU_ITEMS_ALIGNMENT:Zp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:iw,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Qp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:tw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Jp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:nw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ew,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:rw,CONTEXTMENU_ITEMS_BORDERS:K0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:J0,CONTEXTMENU_ITEMS_BORDERS_LEFT:Q0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Z0,CONTEXTMENU_ITEMS_BORDERS_TOP:X0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Up,CONTEXTMENU_ITEMS_COPY:Yp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Kp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Gp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:qp,CONTEXTMENU_ITEMS_CUT:Xp,CONTEXTMENU_ITEMS_EDIT_COMMENT:Y0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:$0,CONTEXTMENU_ITEMS_HIDE_COLUMN:nO,CONTEXTMENU_ITEMS_HIDE_ROW:oO,CONTEXTMENU_ITEMS_INSERT_LEFT:Vp,CONTEXTMENU_ITEMS_INSERT_RIGHT:Wp,CONTEXTMENU_ITEMS_MERGE_CELLS:j0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:rO,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:tO,CONTEXTMENU_ITEMS_NO_ITEMS:kp,CONTEXTMENU_ITEMS_READ_ONLY:Wu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:G0,CONTEXTMENU_ITEMS_REDO:zp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:eO,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Bp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:q0,CONTEXTMENU_ITEMS_REMOVE_ROW:$p,CONTEXTMENU_ITEMS_ROW_ABOVE:Lp,CONTEXTMENU_ITEMS_ROW_BELOW:Fp,CONTEXTMENU_ITEMS_SHOW_COLUMN:iO,CONTEXTMENU_ITEMS_SHOW_ROW:sO,CONTEXTMENU_ITEMS_UNDO:jp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:B0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:z0,CONTEXT_MENU_ITEMS_NAMESPACE:W0,FILTERS_BUTTONS_CANCEL:NO,FILTERS_BUTTONS_CLEAR:AO,FILTERS_BUTTONS_OK:DO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:kO,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:FO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:LO,FILTERS_BUTTONS_SELECT_ALL:HO,FILTERS_CONDITIONS_AFTER:SO,FILTERS_CONDITIONS_BEFORE:RO,FILTERS_CONDITIONS_BEGINS_WITH:dO,FILTERS_CONDITIONS_BETWEEN:bO,FILTERS_CONDITIONS_BY_VALUE:_W,FILTERS_CONDITIONS_CONTAINS:gO,FILTERS_CONDITIONS_EMPTY:lO,FILTERS_CONDITIONS_ENDS_WITH:fO,FILTERS_CONDITIONS_EQUAL:cO,FILTERS_CONDITIONS_GREATER_THAN:pO,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:wO,FILTERS_CONDITIONS_LESS_THAN:vO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:yO,FILTERS_CONDITIONS_NAMESPACE:Qe,FILTERS_CONDITIONS_NONE:aO,FILTERS_CONDITIONS_NOT_BETWEEN:CO,FILTERS_CONDITIONS_NOT_CONTAIN:mO,FILTERS_CONDITIONS_NOT_EMPTY:uO,FILTERS_CONDITIONS_NOT_EQUAL:hO,FILTERS_CONDITIONS_TODAY:EO,FILTERS_CONDITIONS_TOMORROW:TO,FILTERS_CONDITIONS_YESTERDAY:_O,FILTERS_DIVS_FILTER_BY_CONDITION:OO,FILTERS_DIVS_FILTER_BY_VALUE:MO,FILTERS_LABELS_CONJUNCTION:IO,FILTERS_LABELS_DISJUNCTION:PO,FILTERS_NAMESPACE:sr,FILTERS_VALUES_BLANK_CELLS:xO,LOADING_NAMESPACE:XO,LOADING_TITLE:ZO,PAGINATION_COUNTER_SECTION:BO,PAGINATION_FIRST_PAGE:zO,PAGINATION_LAST_PAGE:qO,PAGINATION_NAMESPACE:xn,PAGINATION_NAV_SECTION:jO,PAGINATION_NEXT_PAGE:YO,PAGINATION_PAGE_SIZE_AUTO:WO,PAGINATION_PAGE_SIZE_SECTION:$O,PAGINATION_PREV_PAGE:UO,PAGINATION_SECTION:VO},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const JO={languageCode:"en-US",[kp]:"No available options",[Lp]:"Insert row above",[Fp]:"Insert row below",[Vp]:"Insert column left",[Wp]:"Insert column right",[$p]:["Remove row","Remove rows"],[Bp]:["Remove column","Remove columns"],[jp]:"Undo",[zp]:"Redo",[Wu]:"Read only",[Up]:"Clear column",[Zp]:"Alignment",[Jp]:"Left",[Qp]:"Center",[ew]:"Right",[tw]:"Justify",[rw]:"Top",[nw]:"Middle",[iw]:"Bottom",[$0]:"Freeze column",[B0]:"Unfreeze column",[K0]:"Borders",[X0]:"Top",[Z0]:"Right",[J0]:"Bottom",[Q0]:"Left",[eO]:"Remove border(s)",[U0]:"Add comment",[Y0]:"Edit comment",[q0]:"Delete comment",[G0]:"Read-only comment",[j0]:"Merge cells",[z0]:"Unmerge cells",[Yp]:"Copy",[qp]:["Copy with header","Copy with headers"],[Gp]:["Copy with group header","Copy with group headers"],[Kp]:["Copy header only","Copy headers only"],[Xp]:"Cut",[tO]:"Insert child row",[rO]:"Detach from parent",[nO]:["Hide column","Hide columns"],[iO]:["Show column","Show columns"],[oO]:["Hide row","Hide rows"],[sO]:["Show row","Show rows"],[aO]:"None",[lO]:"Is empty",[uO]:"Is not empty",[cO]:"Is equal to",[hO]:"Is not equal to",[dO]:"Begins with",[fO]:"Ends with",[gO]:"Contains",[mO]:"Does not contain",[pO]:"Greater than",[wO]:"Greater than or equal to",[vO]:"Less than",[yO]:"Less than or equal to",[bO]:"Is between",[CO]:"Is not between",[SO]:"After",[RO]:"Before",[EO]:"Today",[TO]:"Tomorrow",[_O]:"Yesterday",[xO]:"Blank cells",[OO]:"Filter by condition",[MO]:"Filter by value",[IO]:"And",[PO]:"Or",[HO]:"Select all",[AO]:"Clear",[DO]:"OK",[NO]:"Cancel",[kO]:"Search",[LO]:"Value",[FO]:"Second value",[VO]:"Pagination",[$O]:"Page size",[WO]:"Auto",[BO]:"[start] - [end] of [total]",[jO]:"Page [currentPage] of [totalPages]",[zO]:"Go to first page",[UO]:"Go to previous page",[YO]:"Go to next page",[qO]:"Go to last page",[GO]:"Checked",[KO]:"Unchecked",[ZO]:"Loading..."},MW=OW,tm=JO.languageCode,{register:IW,getItem:QO,hasItem:PW,getValues:xW}=xo("languagesDictionaries");eM(JO);function eM(t,e){let r=t,n=e;return nt(t)&&(n=t,r=n.languageCode),HW(r,n),IW(r,br(n)),br(n)}function HW(t,e){t!==tm&&CW(e,QO(tm))}function tM(t){return sw(t)?br(QO(t)):null}function sw(t){return PW(t)}function AW(){return xW()}function rM(t,e,r){const n=tM(t);if(n===null)return null;const i=n[e];if(Bt(i))return null;const o=DW(i,r);return Array.isArray(o)?o[0]:o}function DW(t,e){return TW().reduce((r,n)=>n(r,e),t)}function NW(t){let e=k0(t);return sw(e)||(e=tm,L0(t)),e}function kW(t,e,r){return(e=LW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LW(t){var e=FW(t,"string");return typeof e=="symbol"?e:e+""}function FW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ni extends w0{constructor(e,r){super(e,null),kW(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function og(t){let{activeHeaderClassName:e,...r}=t;return new ni({className:e,...r,selectionType:oV})}function VW(t){let{areaCornerVisible:e,...r}=t;return new ni({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:_p})}function WW(t){let{...e}=t;return new ni({className:"highlight",...e,selectionType:_p})}function $W(t){let{columnClassName:e,...r}=t;return new ni({className:e,...r,selectionType:lV})}function BW(t){let{cellCornerVisible:e,...r}=t;return new ni({className:"current",headerAttributes:[x_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Fu})}function jW(t){let{border:e,visualCellRange:r,...n}=t;return new ni({...e,...n,selectionType:uV},r)}function zW(t){let{...e}=t;return new ni({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:sV})}function wR(t){let{headerClassName:e,...r}=t;return new ni({className:e,...r,selectionType:v0})}function UW(t){let{rowClassName:e,...r}=t;return new ni({className:e,...r,selectionType:aV})}function YW(t,e){qW(t,e),e.add(t)}function qW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e,r){return(e=GW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GW(t){var e=KW(t,"string");return typeof e=="symbol"?e:e+""}function KW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var wn=new WeakSet;class XW{constructor(e){YW(this,wn),Kt(this,"options",void 0),Kt(this,"layerLevel",0),Kt(this,"focus",void 0),Kt(this,"fill",void 0),Kt(this,"layeredAreas",new Map),Kt(this,"areas",new Map),Kt(this,"rowHeaders",new Map),Kt(this,"columnHeaders",new Map),Kt(this,"activeRowHeaders",new Map),Kt(this,"activeColumnHeaders",new Map),Kt(this,"activeCornerHeaders",new Map),Kt(this,"rowHighlights",new Map),Kt(this,"columnHighlights",new Map),Kt(this,"customSelections",[]),this.options=e,this.focus=BW(e),this.fill=zW(e)}isEnabledFor(e,r){let n=e;e===Fu&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Wn(wn,this,$n).call(this,this.layeredAreas,VW)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Wn(wn,this,$n).call(this,this.areas,WW)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Wn(wn,this,$n).call(this,this.rowHeaders,wR)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Wn(wn,this,$n).call(this,this.columnHeaders,wR)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Wn(wn,this,$n).call(this,this.activeRowHeaders,og)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Wn(wn,this,$n).call(this,this.activeColumnHeaders,og)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Wn(wn,this,$n).call(this,this.activeCornerHeaders,og)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Wn(wn,this,$n).call(this,this.rowHighlights,UW)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Wn(wn,this,$n).call(this,this.columnHighlights,$W)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(jW({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),j(this.areas.values(),e=>void e.clear()),j(this.layeredAreas.values(),e=>void e.clear()),j(this.rowHeaders.values(),e=>void e.clear()),j(this.columnHeaders.values(),e=>void e.clear()),j(this.activeRowHeaders.values(),e=>void e.clear()),j(this.activeColumnHeaders.values(),e=>void e.clear()),j(this.activeCornerHeaders.values(),e=>void e.clear()),j(this.rowHighlights.values(),e=>void e.clear()),j(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function $n(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function vR(t,e,r){return(e=ZW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZW(t){var e=JW(t,"string");return typeof e=="symbol"?e:e+""}function JW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aw{constructor(e){vR(this,"ranges",[]),vR(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new aw(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function QW(t,e){nM(t,e),e.add(t)}function e$(t,e,r){return(e=t$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t$(t){var e=r$(t,"string");return typeof e=="symbol"?e:e+""}function r$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sg(t,e,r){nM(t,e),e.set(t,r)}function nM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(t,e){return t.get(_e(t,e))}function os(t,e,r){return t.set(_e(t,e),r),r}function _e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Un=new WeakMap,no=new WeakMap,vr=new WeakMap,Pe=new WeakSet;class lw{constructor(e,r){QW(this,Pe),sg(this,Un,void 0),sg(this,no,0),sg(this,vr,{x:0,y:0}),e$(this,"tableApi",void 0),os(Un,this,e),this.tableApi=r}setActiveLayerIndex(e){os(no,this,e)}getCurrentSelection(){return ut(Un,this).peekByIndex(ut(no,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;os(vr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=_e(Pe,this,rm).call(this);const{row:h,col:d}=_e(Pe,this,SR).call(this,o),g=this.tableApi.fixedRowsBottom(),w=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),C=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),b=this.tableApi.createCellCoords(h+i.row,d+i.col);if(b.row>=c){const I=pr(n&&w>0&&g===0),x=b.col+1,P=x>=u,A=this.tableApi.createCellCoords(b.row-c,P?x-u:x);if(this.runLocalHooks("beforeColumnWrap",I,_e(Pe,this,zo).call(this,A),P),I.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&P&&ut(Un,this).size()>1){_e(Pe,this,yR).call(this);const F=_e(Pe,this,Vl).call(this,"forward");F!==null&&A.assign(F)}b.assign(A)}}else if(b.row<0){const I=pr(T),x=b.col-1,P=x<0,A=this.tableApi.createCellCoords(c+b.row,P?u+x:x);if(this.runLocalHooks("beforeColumnWrap",I,_e(Pe,this,zo).call(this,A),P),T){if(this.shouldSwitchSelectionLayer()&&P&&ut(Un,this).size()>1){_e(Pe,this,bR).call(this);const F=_e(Pe,this,Vl).call(this,"backward");F!==null&&A.assign(F)}b.assign(A)}}if({width:u,height:c}=_e(Pe,this,rm).call(this),b.col>=u){const I=pr(n&&v>0),x=b.row+1,P=x>=c,A=this.tableApi.createCellCoords(P?x-c:x,b.col-u);if(this.runLocalHooks("beforeRowWrap",I,_e(Pe,this,zo).call(this,A),P),I.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(C){if(this.shouldSwitchSelectionLayer()&&P&&ut(Un,this).size()>1){_e(Pe,this,yR).call(this);const F=_e(Pe,this,Vl).call(this,"forward");F!==null&&A.assign(F)}b.assign(A)}}else if(b.col<0){const I=pr(C),x=b.row-1,P=x<0,A=this.tableApi.createCellCoords(P?c+x:x,u+b.col);if(this.runLocalHooks("beforeRowWrap",I,_e(Pe,this,zo).call(this,A),P),C){if(this.shouldSwitchSelectionLayer()&&P&&ut(Un,this).size()>1){_e(Pe,this,bR).call(this);const F=_e(Pe,this,Vl).call(this,"backward");F!==null&&A.assign(F)}b.assign(A)}}const{rowDir:E,colDir:y}=_e(Pe,this,CR).call(this,b);a=E,l=y,o=_e(Pe,this,zo).call(this,b)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:ut(no,this),visualCoords:o}}transformEnd(e,r){os(vr,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=_e(Pe,this,pu).call(this,i.to.row,i.from.row),a=_e(Pe,this,wu).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=_e(Pe,this,SR).call(this,i.highlight),g=this.tableApi.createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),v=i.getTopEndCorner(),C=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const y=g.col-d;g.col=_e(Pe,this,wu).call(this,w.col,v.col)+y}else if(n.col>0&&a<=d&&g.col>d){const y=_e(Pe,this,wu).call(this,v.col,w.col),I=Math.max(g.col-y,1);g.col=y+I}if(n.row<0&&s>=h&&g.row<h){const y=g.row-h;g.row=_e(Pe,this,pu).call(this,w.row,C.row)+y}else if(n.row>0&&s<=h&&g.row>h){const y=_e(Pe,this,pu).call(this,C.row,w.row),I=Math.max(g.row-y,1);g.row=y+I}const{rowDir:T,colDir:b}=_e(Pe,this,CR).call(this,g);u=T,c=b;const E=_e(Pe,this,zo).call(this,g);n.row===0&&n.col!==0?l.col=E.col:n.row!==0&&n.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:ut(no,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function yR(){const t=ut(no,this)+1;this.setActiveLayerIndex(t>=ut(Un,this).size()?0:t),os(vr,this,this.calculateOffset())}function bR(){const t=ut(no,this)-1;this.setActiveLayerIndex(t<0?ut(Un,this).size()-1:t),os(vr,this,this.calculateOffset())}function CR(t){const{width:e,height:r}=_e(Pe,this,rm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function rm(){return{width:ut(vr,this).x+this.countRenderableColumns(),height:ut(vr,this).y+this.countRenderableRows()}}function Vl(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,o,s]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=_e(Pe,this,pu).call(this,n,i),l=_e(Pe,this,wu).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function pu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:ut(vr,this).y+r}function wu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ut(vr,this).x+r}function SR(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(ut(vr,this).y+e,ut(vr,this).x+r)}function zo(t){const e=t.clone();return e.col=t.col-ut(vr,this).x,e.row=t.row-ut(vr,this).y,this.tableApi.renderableToVisualCoords(e)}Je(lw,Pn);class n$ extends lw{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class i$ extends lw{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),o=this.tableApi.countRenderableRowsInRange(0,r-1),s=e.highlight.isHeader(),a=s?Math.abs(n):0,l=s?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const yc=0,bc=1,iM=2,uw=3,o$=[uw,iM],s$=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],ag=Symbol("root"),RR=Symbol("child");function Cc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ag;if(e!==ag&&e!==RR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===ag;let i=yc;if(r){const o=t[0];t.length===0?i=bc:n&&o instanceof al?i=uw:n&&Array.isArray(o)?i=Cc(o,RR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!s$[l].includes(typeof a))&&(i=iM)}return i}function cw(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!o$.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===uw;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Bt(u)&&(u=a),Bt(c)&&(c=l),!n){const w=a,v=l,C=u,T=c;a=Math.min(w,C),l=Math.min(v,T),u=Math.max(w,C),c=Math.max(v,T)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),g=e(u,c);return r(h,d,g)}}function a$(t){const e=Cc(t.getSelected());if(e===yc||e===bc)return[];const r=cw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return Io(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function l$(t){const e=Cc(t.getSelected());if(e===yc||e===bc)return[];const r=cw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return Io(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Ui(t,e,r){u$(t,e),e.set(t,r)}function u$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e,r){return(e=c$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c$(t){var e=h$(t,"string");return typeof e=="symbol"?e:e+""}function h$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function je(t,e){return t.get(oM(t,e))}function cr(t,e,r){return t.set(oM(t,e),r),r}function oM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hr=new WeakMap,Uo=new WeakMap,Wl=new WeakMap,hi=new WeakMap,$l=new WeakMap,ia=new WeakMap,Bl=new WeakMap;class sM{constructor(e,r){var n=this;Yi(this,"settings",void 0),Yi(this,"tableProps",void 0),Yi(this,"inProgress",!1),Yi(this,"selectedRange",new aw((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Yi(this,"highlight",void 0),Ui(this,hr,void 0),Ui(this,Uo,void 0),Yi(this,"selectedByRowHeader",new Set),Yi(this,"selectedByColumnHeader",new Set),Ui(this,Wl,!1),Ui(this,hi,!1),Ui(this,$l,"unknown"),Ui(this,ia,-1),Ui(this,Bl,0),this.settings=e,this.tableProps=r,this.highlight=new XW({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[x_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),cr(hr,this,new n$(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),cr(Uo,this,new i$(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),je(hr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),je(hr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),je(hr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),je(hr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),je(hr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),je(hr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),je(hr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),je(hr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),je(Uo,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),je(Uo,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(je(Bl,this))}getActiveSelectionLayerIndex(){return je(Bl,this)}setActiveSelectionLayerIndex(e){cr(Bl,this,e)}markSource(e){cr($l,this,e)}markEndSource(){cr($l,this,"unknown")}getSelectionSource(){return je($l,this)}setExpectedLayers(e){cr(ia,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,cr(ia,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Bt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();cr(hi,this,!1),cr(Wl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&Bt(r))&&(this.selectedRange.clear(),j(this.highlight.getAreas(),l=>void l.clear()),j(this.highlight.getLayeredAreas(),l=>void l.clear()),j(this.highlight.getRowHeaders(),l=>void l.clear()),j(this.highlight.getColumnHeaders(),l=>void l.clear()),j(this.highlight.getActiveRowHeaders(),l=>void l.clear()),j(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),j(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),j(this.highlight.getRowHighlights(),l=>void l.clear()),j(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&n.col<0&&!s||o===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(n),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const l=je(ia,this)===-1||this.selectedRange.size()===je(ia,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(_p,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(v0,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(b).commit(),d.add(C).commit(),g.add(b).commit()):(a.add(C).add(T).commit(),l.add(b).add(E).commit(),d.add(C).add(T).commit(),g.add(b).add(E).commit())}const w=!je(hi,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!je(hi,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),je(hr,this).setActiveLayerIndex(r),je(Uo,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Fu,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(cr(Wl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=je(hr,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=je(hr,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=je(Uo,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(De(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(De(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(De(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,De(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,De(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,De(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=pr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&je(Wl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(De(d.row,u,o-1),De(d.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",w,v,h),this.setRangeStartOnly(w,void 0,h),cr(hi,this,g),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",w,v,h),this.finish()}selectCells(e){var r=this;const n=Cc(e);if(n===bc)return!1;if(n===yc)throw new Error(ir`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=cw(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),j(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,w=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=De(n.row,u,s-1),w=De(n.col,Math.min(i,o),Math.max(i,o))):(g=De(n,u,s-1),w=i);const v=this.tableProps.createCellCoords(g,w),C=l===0?0:De(v.row,u,-1),T=s-1,b=this.tableProps.createCellCoords(C,i),E=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",b,E,v),this.setRangeStartOnly(b,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",b,E,v),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=De(n.row,Math.min(e,r),Math.max(e,r)),d=De(n.col,a,o-1)):(h=e,d=De(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),w=s===0?0:De(g.col,a,-1),v=o-1,C=this.tableProps.createCellCoords(e,w),T=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",C,T,g),this.setRangeStartOnly(C,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",C,T,g),this.finish()}return c}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,cr(hi,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),cr(hi,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:je(hi,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:De(u.row,this.settings.navigableHeaders?-1/0:0,c),col:De(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:De(a.row,-1/0,c),col:De(a.col,-1/0,h)}),l.assign({row:De(l.row,-1/0,c),col:De(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(Fu,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Je(sM,Pn);const ER=/^(\r\n|\n\r|\r|\n)/,d$=/^[^\t\r\n]+/,TR=/^\t/;function f$(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(TR))t=t.replace(TR,""),r+=1,e[n][r]="";else if(t.match(ER))t=t.replace(ER,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(d$);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function $u(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function lg(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:o}=e;return Oe(o)?o.call(r,t,n,i,e):t}function g$(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:o}=e;return Oe(o)?o.call(r,t,n,i,e):t}function qi(t,e,r){return(e=m$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m$(t){var e=p$(t,"string");return typeof e=="symbol"?e:e+""}function p$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ss{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){qi(this,"hot",void 0),qi(this,"metaManager",void 0),qi(this,"tableMeta",void 0),qi(this,"dataSource",void 0),qi(this,"duckSchema",void 0),qi(this,"colToPropCache",void 0),qi(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=cp(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(nt(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return T0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&He(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&he(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(he(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Va(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=br(this.getSchema()):(w=[],Ge(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},H_(w,this.getSchema())),d.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let w=d;g<r&&l+g<s;w++){if(typeof c!="number"||c>=l+g)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(w,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=he(this.tableMeta.columns)||he(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];xC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return BD(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];xC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Fr(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let c=i;if(!c)return null;const h=r.split(".");for(let d=0,g=h.length;d<g;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(ms(n)&&ms(u)&&(a=g$(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=pr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=pr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Fr(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,ss.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===ss.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return $u(this.getRange(e,r,ss.DESTINATION_RENDERER))}getCopyableText(e,r){return $u(this.getRange(e,r,ss.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:w$,getItem:v$,hasItem:aM}=xo("cellTypes");function y$(t){if(!aM(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return v$(t)}function b$(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&Q_(t,r),n&&Bk(t,n),i&&Yk(t,i),w$(t,e)}function C$(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Fr(e,t)}function Sc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?y$(e.type):e.type;if(t._automaticallyAssignedMetaProps&&He(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!nt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};He(n,(o,s)=>{if(C$(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),xi(t,i)}function S$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}dN(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function vu(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function jl(t){return t==null}const lM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),go(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),go(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),A_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function _R(t,e,r){return(e=R$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R$(t){var e=E$(t,"string");return typeof e=="symbol"?e:e+""}function E$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T$(){return class{}}class _${constructor(e){_R(this,"metaCtor",T$()),_R(this,"meta",void 0),this.meta=this.metaCtor.prototype,xi(this.meta,lM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;xi(this.meta,e),Sc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function O$(t,e,r){return(e=M$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M$(t){var e=I$(t,"string");return typeof e=="symbol"?e:e+""}function I$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P${constructor(e){O$(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){xi(this.meta,e),Sc(this.meta,e,e)}}function zl(t,e,r){return(e=x$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x$(t){var e=H$(t,"string");return typeof e=="symbol"?e:e+""}function H$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bu{constructor(e){zl(this,"valueFactory",void 0),zl(this,"data",[]),zl(this,"index",[]),zl(this,"holes",new Set),this.valueFactory=e}obtain(e){vu(()=>ms(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;vu(()=>ms(e)||jl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=jl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;vu(()=>ms(e)||jl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(jl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function OR(t,e,r){return(e=A$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A$(t){var e=D$(t,"string");return typeof e=="symbol"?e:e+""}function D$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const N$=["data","width"];class k${constructor(e){OR(this,"globalMeta",void 0),OR(this,"metas",new Bu(()=>this._createMeta())),this.globalMeta=e,this.metas=new Bu(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);xi(n,r),Sc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return S$(this.globalMeta.getMetaConstructor(),N$).prototype}}function MR(t,e,r){return(e=L$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L$(t){var e=F$(t,"string");return typeof e=="symbol"?e:e+""}function F$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V${constructor(e){MR(this,"columnMeta",void 0),MR(this,"metas",new Bu(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);xi(i,n),Sc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)he(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){vu(()=>ms(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Bu(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class uM{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new _$(e),this.tableMeta=new P$(this.globalMeta),this.columnMeta=new k$(this.globalMeta),this.cellMeta=new V$(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Je(uM,Pn);function IR(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=hc(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Oe(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new ss(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let v,C=0,T=0;for(C=0,T=d.startRows;C<T;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=br(w),t.push(v);else if(i.dataType==="array")v=br(w[0]),t.push(v);else{v=[];for(let b=0,E=d.startCols;b<E;b++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Me(i.rootElement,[I_(-1),dc(i.countCols()+(i.view?i.countRowHeaders():0))])}function PR(t,e,r){return(e=W$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W$(t){var e=$$(t,"string");return typeof e=="symbol"?e:e+""}function $$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B${constructor(e){var r=this;PR(this,"metaManager",void 0),PR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Fr(e,"type")?e.type:null;let c=Oe(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function j$(t,e,r){z$(t,e),e.set(t,r)}function z$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ug(t,e,r){return(e=U$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U$(t){var e=Y$(t,"string");return typeof e=="symbol"?e:e+""}function Y$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q$(t,e){return t.get(G$(t,e))}function G$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xR=new WeakMap;class K${constructor(e){ug(this,"metaManager",void 0),ug(this,"usageTracker",new Set),ug(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),j$(this,xR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,q$(xR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const cM="gridDefault",hM="editorManager.handlingEditor",X$={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Z$="hooksRefRegisterer",dM={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){j(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){He(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ri(dM,"MIXIN_NAME",Z$,{writable:!1,enumerable:!1});function Xr(t,e,r){return(e=J$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J$(t){var e=Q$(t,"string");return typeof e=="symbol"?e:e+""}function Q$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eB="base",lt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class hw{static get EDITOR_TYPE(){return eB}constructor(e){Xr(this,"hot",void 0),Xr(this,"state",lt.VIRGIN),Xr(this,"_opened",!1),Xr(this,"_fullEditMode",!1),Xr(this,"_closeCallback",null),Xr(this,"TD",null),Xr(this,"row",null),Xr(this,"col",null),Xr(this,"prop",null),Xr(this,"originalValue",null),Xr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:lt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();n=u.row,i=u.col,o=c.row,s=c.col}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==lt.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=lt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:lp(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===lt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===lt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=lt.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=lt.FINISHED,this.discardEditor(s)}):(this.state=lt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=lt.FINISHED,this.discardEditor()}discardEditor(e){this.state===lt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=lt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=lt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===lt.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Dr(r),a=nr(r),l=Dr(this.hot.rootElement),u=nr(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,C=v.name,T=["master","inline_start"].includes(C)?d:0,b=["master","top","bottom"].includes(C)?g:0,E=s.top===l.top?0:1;let y=s.top-l.top-E-T,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-w-1+b:I=s.left-l.left-1-b,["top","top_inline_start_corner"].includes(C)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(I+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const x=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),A=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&P<=0||P===W)&&(y+=1),A<=0&&(I+=1);const q=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,se=Math.abs(n.inlineStartOverlay.getScrollPosition()),K=n.topOverlay.getScrollPosition(),te=jt(this.hot.rootDocument);let dt=r.offsetTop;if(["inline_start","master"].includes(C)&&(dt+=q-K),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:_,wtTable:O}=n.bottomOverlay.clone;dt+=_.getWorkspaceHeight()-O.getHeight()-te}let Re=r.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-r.offsetLeft:Re=Math.abs(Re),Re+=L-se-a):["top","master","bottom"].includes(C)&&(Re+=L-se);const Ee=o.getComputedStyle(this.TD),Ye=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",$e=parseInt(Ee[Ye],10)>0?0:1,Ie=parseInt(Ee.borderTopWidth,10)>0?0:1,cn=nr(r)+$e,Te=or(r)+Ie,f=xN(c)?te:0,m=HN(h)?te:0,p=this.hot.view.maximumVisibleElementWidth(Re)-f+$e,R=Math.max(this.hot.view.maximumVisibleElementHeight(dt)-m+Ie,this.hot.stylesHandler.getDefaultRowHeight());return{top:y,start:I,height:Te,maxHeight:R,width:cn,maxWidth:p}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Je(hw,dM);const tB={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===lt.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},rB={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},nB={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},iB={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},oB={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>n.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),gc(e))}};function sB(){return[X$,tB,rB,nB,iB,oB]}const aB={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},lB={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},uB={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},cB={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},hB={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},dB={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},fB={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},gB={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},mB={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},pB={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},wB={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},vB={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},yB={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},bB={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function CB(){return[aB,lB,uB,cB,hB,dB,fB,gB,mB,pB,wB,vB,yB,bB]}const SB={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},RB={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},EB={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},TB={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},_B={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},OB={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},MB={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},IB={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},PB={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},xB={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},HB={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},AB={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},DB={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},NB={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},kB={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},LB={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function FB(){return[SB,RB,EB,TB,_B,OB,MB,IB,PB,xB,HB,AB,DB,NB,kB,LB]}const VB={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},WB={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},$B={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},BB={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},jB={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},zB=[...sB(),...CB(),...FB(),VB,WB,$B,BB,jB];function fM(t){const e={};return zB.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function UB(t){const e=t.getShortcutManager().addContext("editor"),r=fM(t),n={group:hM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function YB(t){const e=t.getShortcutManager().addContext("grid"),r=fM(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return he(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:cM};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:hM,runOnlyIf:()=>he(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function qB(t){[YB,UB].forEach(e=>e(t))}function GB(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=HR(t),i=HR(t);return n.addEventListener("focus",()=>r?.onFocus("from_above")),i.addEventListener("focus",()=>r?.onFocus("from_below")),e.prepend(n),e.append(i),{focus(o){o==="from_above"?n.focus():i.focus()},activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function HR(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Me(r,[Au("Focus catcher")]),r}function KB(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=zg(t),o=Ug(t);return e.row=De(e.row,i.row,o.row),e.col=De(e.col,i.col,o.col),e}}function XB(t){const e=KB(t);let r;const{activate:n,deactivate:i}=GB(t,t.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const w=(d=e(r))!==null&&d!==void 0?d:zg(t),v=t.runHooks("modifyFocusOnTabNavigation","from_above",w);w&&v!==!1&&t.selectCell(w.row,w.col)}else{var g;const w=(g=e(r))!==null&&g!==void 0?g:Ug(t),v=t.runHooks("modifyFocusOnTabNavigation","from_below",w);w&&v!==!1&&t.selectCell(w.row,w.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&i()}),t.addHook("afterUnlisten",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&n()}),t.addHook("afterSelection",(h,d,g,w,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var C;r=(C=t.getSelectedRangeActive())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:cM,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeActive()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?zg(t):Ug(t)),u(),!1;h.preventDefault()},position:"after"}])}function Ds(t){co(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Rc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,v=g<=h,C=w>=d;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?n.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:v&&C?n.highlight.row:v?g:C?w:T.row}}}function ZB(t){return e=>{const r=Rc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Ds(t.getCell(n?-1:0,r,!0))})}}function JB(){return()=>{}}function QB(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;Ds(t.getCell(n,i,!0))})}}function ej(t){return e=>{const r=Rc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Ds(t.getCell(i,o,!0))})}}function tj(t){return e=>{const r=Rc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Ds(t.getCell(i,o,!0))})}}function rj(t){return e=>{const r=Rc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Ds(t.getCell(r,n?-1:0,!0))})}}function nj(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{Ds(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function ij(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=QB(t):e.isSelectedByCorner()?s=JB():e.isSelectedByRowHeader()?s=rj(t):e.isSelectedByColumnHeader()?s=ZB(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=ej(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=nj(t):e.getSelectedRange().size()>1&&(s=tj(t)),(o=s)===null||o===void 0||o(i)}}}const AR=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ul=t=>t.map(e=>{const r=e.toLowerCase();return AR.has(r)?AR.get(r):r}).sort().join("+"),oj=t=>t.split("+"),DR=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),cg=t=>{let{which:e,key:r}=t;if(DR.has(e))return DR.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},gM=Symbol("shortcut-context");function nm(t){return nt(t)&&t.__kindOf===gM}const sj=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=mc({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:w=!0,stopPropagation:v=!1,relativeToGroup:C,position:T,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Bt(h))throw new Error("You need to define the shortcut's group.");if(Oe(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(ir`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const E={callback:c,group:h,runOnlyIf:d,captureCtrl:g,preventDefault:w,stopPropagation:v};he(C)&&(E.relativeToGroup=C,E.position=T),nm(b)&&(E.forwardToContext=b),u.forEach(y=>{const I=Ul(y);if(r.hasItem(I)){const P=r.getItem(I);let A=P.findIndex(F=>F.group===C);A!==-1?T==="before"?A-=1:A+=1:A=P.length,P.splice(A,0,E)}else r.addItem(I,[E])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{He(c,(d,g)=>{Object.prototype.hasOwnProperty.call(h,g)===!1&&(h[g]=c[g])}),n(h)})},o=u=>{const c=Ul(u);r.removeItem(c)};return{__kindOf:gM,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const c=Ul(u),h=r.getItem(c);return he(h)?h.slice():[]},hasShortcut:u=>{const c=Ul(u);return r.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{r.getItems().forEach(h=>{let[d,g]=h;const w=g.filter(v=>v.group!==u);w.length===0?o(oj(d)):(g.length=0,g.push(...w))})}}};function aj(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const lj=["meta","alt","shift","control"],oa=aj(),sa=[];let Yl=0;function uj(t,e,r,n,i){const o=g=>lj.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),w&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||to(g))return;const v=cg(g);let C=[];o(v)||(C=s(g));const T=[v].concat(C);!i(g,T)&&(UC()&&C.includes("meta")||!UC()&&C.includes("control"))&&i(g,[v].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const w=cg(g);o(w)&&oa.press(w)}},u=g=>{if(typeof g.key=="string"){const w=cg(g);o(w)&&oa.release(w)}},c=()=>{oa.releaseAll()};return{mount:()=>{let g=t;for(Yl+=1;g;)Yl===1&&(g.document.documentElement.addEventListener("keydown",l),sa.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),sa.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Wa(g)},unmount:()=>{let g=t;for(Yl-=1;g;){if(Yl===0){for(let w=0;w<sa.length;w++){const{event:v,listener:C}=sa[w];g.document.documentElement.removeEventListener(v,C)}sa.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Wa(g)}},isPressed:g=>oa.isPressed(g),releasePressedKeys:()=>oa.releaseAll()}}const cj=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=mc({errorIdExists:v=>`The "${v}" context name is already registered.`});let s="grid";const a=function(v){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const T=sj(v,C);return o.addItem(v,T),T},l=()=>s,u=v=>o.getItem(v),c=v=>{if(!o.hasItem(v))throw new Error(ir`You've tried to activate the "${v}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=v};let h=!1;const d=function(v,C){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=nm(T)?T:u(T);let E=!1;if(!b.hasShortcut(C))return E;const y=b.getShortcuts(C);for(let I=0;I<y.length;I++){const{callback:x,runOnlyIf:P,preventDefault:A,stopPropagation:F,captureCtrl:W,forwardToContext:q}=y[I];if(P(v)===!0){if(h=W,E=x(v,C)===!1,h=!1,A&&v.preventDefault(),F&&(gc(v),v.stopPropagation()),E)break;q&&d(v,C,q)}}return E},w=uj(e,v=>{const C=l(),T=nm(C)?C:u(C);return r(v,T.scope)},n,i,d);return w.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(w.isPressed("control")||w.isPressed("meta")),releasePressedKeys:()=>w.releasePressedKeys(),destroy:()=>w.unmount()}};function NR(t){const{classNames:e}=RN(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function hj(t,e){mM(t,e),e.add(t)}function di(t,e,r){mM(t,e),e.set(t,r)}function mM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(t,e){return t.get(tn(t,e))}function mr(t,e,r){return t.set(tn(t,e),r),r}function tn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const kR=23;var vn=new WeakMap,ju=new WeakMap,dw=new WeakMap,im=new WeakMap,wi=new WeakMap,Ca=new WeakMap,Ba=new WeakMap,aa=new WeakMap,bn=new WeakSet;class dj{constructor(e){let{rootElement:r,rootDocument:n,onThemeChange:i=()=>{}}=e;hj(this,bn),di(this,vn,void 0),di(this,ju,void 0),di(this,dw,void 0),di(this,im,void 0),di(this,wi,!0),di(this,Ca,{}),di(this,Ba,{}),di(this,aa,void 0),mr(ju,this,r),mr(im,this,n),mr(aa,this,i)}isClassicTheme(){return Xe(wi,this)}getCSSVariableValue(e){var r;if(Xe(wi,this))return null;if(Xe(Ca,this)[`--ht-${e}`])return Xe(Ca,this)[`--ht-${e}`];const n=(r=tn(bn,this,mj).call(this,`--ht-${e}`))!==null&&r!==void 0?r:tn(bn,this,pM).call(this,`--ht-${e}`);if(n!==null)return Xe(Ca,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Xe(Ba,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Xe(wi,this))return kR;const e=tn(bn,this,fj).call(this);return e||kR}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){mr(vn,this,void 0),mr(wi,this,!0),Xe(aa,this).call(this,Xe(vn,this)),tn(bn,this,hg).call(this);return}if(e&&e!==Xe(vn,this)){if(!/ht-theme-.*/.test(e)){Vr(`Invalid theme name: ${e}. Please provide a valid theme name.`),mr(vn,this,void 0),mr(wi,this,!1),Xe(aa,this).call(this,Xe(vn,this)),tn(bn,this,hg).call(this);return}Xe(vn,this)&&tn(bn,this,pj).call(this),mr(vn,this,e),mr(wi,this,!1),Xe(aa,this).call(this,Xe(vn,this)),tn(bn,this,hg).call(this)}}getThemeName(){return Xe(vn,this)}}function fj(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function hg(){this.isClassicTheme()||mr(dw,this,getComputedStyle(Xe(ju,this)));const t=tn(bn,this,gj).call(this,["box-sizing","border-bottom-width"]);Xe(Ba,this).td={...Xe(Ba,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function gj(t){const e=Xe(im,this),r=Xe(ju,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function mj(t){const e=Math.ceil(parseFloat(tn(bn,this,pM).call(this,t)));return Number.isNaN(e)?null:e}function pM(t){const e=Xe(dw,this).getPropertyValue(t);return e===""?null:e}function pj(){mr(Ba,this,{}),mr(Ca,this,{}),mr(wi,this,!0)}function wj(t,e){wM(t,e),e.add(t)}function LR(t,e,r){wM(t,e),e.set(t,r)}function wM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FR(t,e){return t.get(bs(t,e))}function VR(t,e,r){return t.set(bs(t,e),r),r}function bs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var om=new WeakMap,sm=new WeakMap,xa=new WeakSet;class vj{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;wj(this,xa),LR(this,om,void 0),LR(this,sm,void 0),VR(om,this,r),VR(sm,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=bs(xa,this,WR).call(this,e.from,r,n);if(i===null)return null;const o=bs(xa,this,WR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function WR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=bs(xa,this,$R).call(this,FR(om,this),t.row,e);if(n===null)return null;const i=bs(xa,this,$R).call(this,FR(sm,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function $R(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let Yn=null,yu=0;function yj(t){const e=t.ownerDocument;if(!Yn){Yn=e.createElement("div"),Yn.setAttribute("role","status"),Yn.setAttribute("aria-live","assertive"),Yn.setAttribute("aria-atomic","true");const r=Yn.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(Yn)}yu+=1}function bj(){yu!==0&&(yu===1&&(Yn.remove(),Yn=null),yu-=1)}let dg=null;const ql=new WeakSet,fg=new Map;function vM(t,e){var r,n,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Hi(s);let l,u,c,h,d,g,w=!0;const v={...e.initialState,...e};FV(o)&&LV(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Qi(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Qi(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),X(this.rootElement,["ht-wrapper","handsontable"]),X(this.rootWrapperElement,"ht-root-wrapper"),X(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),X(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(r=v?.layoutDirection)!==null&&r!==void 0?r:"inherit",T=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new dj({rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:f=>{Qi(this)&&(xe(this.rootWrapperElement,/ht-theme-.*/g),xe(this.rootPortalElement,/ht-theme-.*/g),f&&(X(this.rootWrapperElement,f),X(this.rootPortalElement,f),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Vr(`The "${f}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=NW(v.language);const b=Object.fromEntries(Object.entries(v).filter(f=>{let[m]=f;return!(fe.getSingleton().isRegistered(m)||fe.getSingleton().isDeprecated(m))})),E=new uM(s,b,[B$,K$]),y=E.getTableMeta(),I=E.getGlobalMeta(),x=mc();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${E_()}`,fg.set(this.guid,this),this.columnIndexMapper=new em,this.rowIndexMapper=new em,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{s.runHooks("beforeCompositionStart",f)}),u=new ZV(s);const P=xo(this.guid);P.register("cellRangeMapper",new vj({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},F=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)},W=(f,m)=>{const p=m>f?1:-1,R=Math.min(f,m),_=Math.max(f,m),O=s.rowIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<R?null:O>=0?s.rowIndexMapper.getRenderableFromVisualIndex(O):O},q=(f,m)=>{const p=m>f?1:-1,R=Math.min(f,m),_=Math.max(f,m),O=s.columnIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<R?null:O>=0?s.columnIndexMapper.getRenderableFromVisualIndex(O):O};let L=new sM(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,p)=>s._createCellRange(f,m,p),visualToRenderableCoords:A,renderableToVisualCoords:F,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:q,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=L;const se=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",se),this.rowIndexMapper.addLocalHook("cacheUpdated",se),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const p=pr(!1),R=this.selection.getSelectedRange(),{from:_,to:O}=R.current(),H=R.size()-1;this.runHooks("afterSelection",_.row,_.col,O.row,O.col,p,H),this.runHooks("afterSelectionByProp",_.row,s.colToProp(_.col),O.row,s.colToProp(O.col),p,H),m&&(!p.isTouched()||p.isTouched()&&!p.value)&&g.scrollTo(f);const k=L.isSelectedByRowHeader(),U=L.isSelectedByColumnHeader();k&&U?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):k?(xe(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):U?(xe(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(L.getSelectionSource())||h.closeEditor(null),L.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=pr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(f),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:p,to:R}=f[m];this.runHooks("afterSelectionEnd",p.row,p.col,R.row,R.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),R.row,s.colToProp(R.col),m),L.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectAll",...m)}).addLocalHook("afterSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectAll",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,R=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0;const O=H=>{if(H.length===0)return[];const k=[...H];return k.sort(($,M)=>{let[B]=$,[Q]=M;return B===Q?0:B>Q?1:-1}),Io(k,($,M)=>{let[B,Q]=M;const ie=$[$.length-1],[ye,ae]=ie,de=ye+ae;if(B<=de){const Ae=Math.max(Q-(de-B),0);ie[1]+=Ae}else $.push([B,Q]);return $},[k[0]])};switch(f){case"insert_row_below":case"insert_row_above":const H=s.countSourceRows();if(y.maxRows===H)return;const k=f==="insert_row_below"?"below":"above";m=m??(k==="below"?H:0);const{delta:U,startPhysicalIndex:$}=l.createRow(m,p,{source:R,mode:k});L.shiftRows(s.toVisualRow($),U);break;case"insert_col_start":case"insert_col_end":const M=f==="insert_col_end"?"end":"start";m=m??(M==="end"?s.countSourceCols():0);const{delta:B,startPhysicalIndex:Q}=l.createCol(m,p,{source:R,mode:M});if(B){if(Array.isArray(y.colHeaders)){const ae=[s.toVisualColumn(Q),0];ae.length+=B,Array.prototype.splice.apply(y.colHeaders,ae)}L.shiftColumns(s.toVisualColumn(Q),B)}break;case"remove_row":const ie=ae=>{let de=0;j(ae,Ae=>{let[me,ke]=Ae;const Et=go(me)?s.countRows()-1:Math.max(me-de,0);if(Number.isInteger(me)&&(me=Math.max(me-de,0)),!l.removeRow(me,ke,R))return;if(L.isSelected()){const{row:yt}=s.getSelectedRangeActive().highlight;yt>=me&&yt<=me+ke-1&&h.closeEditor(!0)}const ar=s.countRows(),Hn=y.fixedRowsTop;Hn>=Et+1&&(y.fixedRowsTop-=Math.min(ke,Hn-Et));const At=y.fixedRowsBottom;if(At&&Et>=ar-At&&(y.fixedRowsBottom-=Math.min(ke,At)),ar===0)L.deselect();else if(R==="ContextMenu.removeRow"){const yt=L.getSelectedRange(),lr=yt.pop();yt.clear().set(lr.from).current().setTo(lr.to),L.refresh()}else L.shiftRows(me,-ke);de+=ke})};Array.isArray(m)?ie(O(m)):ie([[m,p]]);break;case"remove_col":const ye=ae=>{let de=0;j(ae,Ae=>{let[me,ke]=Ae;const Et=go(me)?s.countCols()-1:Math.max(me-de,0);let Ht=s.toPhysicalColumn(Et);if(Number.isInteger(me)&&(me=Math.max(me-de,0)),!l.removeCol(me,ke,R))return;if(L.isSelected()){const{col:yt}=s.getSelectedRangeActive().highlight;yt>=me&&yt<=me+ke-1&&h.closeEditor(!0)}if(s.countCols()===0)L.deselect();else if(R==="ContextMenu.removeColumn"){const yt=L.getSelectedRange(),lr=yt.pop();yt.clear().set(lr.from).current().setTo(lr.to),L.refresh()}else L.shiftColumns(me,-ke);const At=y.fixedColumnsStart;At>=Et+1&&(y.fixedColumnsStart-=Math.min(ke,At-Et)),Array.isArray(y.colHeaders)&&(typeof Ht>"u"&&(Ht=-1),y.colHeaders.splice(Ht,ke)),de+=ke})};Array.isArray(m)?ye(O(m)):ye([[m,p]]);break;default:throw new Error(`There is no such action "${f}"`)}_||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,p=y.minCols,R=y.minSpareCols;if(f){const _=s.countRows();_<f&&l.createRow(_,f-_,{source:"auto"})}if(m){const _=s.countEmptyRows(!0);if(_<m){const O=m-_,H=Math.min(O,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),H,{source:"auto"})}}{let _;(p||R)&&(_=s.countEmptyCols(!0));let O=s.countCols();if(p&&!y.columns&&O<p){const H=p-O;_+=H,l.createCol(O,H,{source:"auto"})}if(R&&!y.columns&&s.dataType==="array"&&_<R){O=s.countCols();const H=R-_,k=Math.min(H,y.maxCols-O);l.createCol(O,k,{source:"auto"})}}},populateFromArray(f,m,p,R,_){let O,H,k,U;const $=[],M={},B=[],Q=f.row,ie=f.col;if(H=m.length,H===0)return!1;let ye=0,ae=0;switch(nt(p)&&(ye=p.col-ie+1,ae=p.row-Q+1),_){case"shift_down":const Ae=Ef(m),me=Ae.length,ke=Math.max(me,ye),Et=s.getData().slice(Q),Ht=Ef(Et).slice(ie,ie+ke);for(k=0;k<ke;k+=1)if(k<me){for(O=0,H=Ae[k].length;O<ae-H;O+=1)Ae[k].push(Ae[k][O%H]);k<Ht.length?B.push(Ae[k].concat(Ht[k])):B.push(Ae[k].concat(new Array(Et.length).fill(null)))}else B.push(Ae[k%me].concat(Ht[k]));s.populateFromArray(Q,ie,Ef(B));break;case"shift_right":const ar=m.length,Hn=Math.max(ar,ae),At=s.getData().slice(Q).map(ur=>ur.slice(ie));for(O=0;O<Hn;O+=1)if(O<ar){for(k=0,U=m[O].length;k<ye-U;k+=1)m[O].push(m[O][k%U]);if(O<At.length)for(let ur=0;ur<At[O].length;ur+=1)m[O].push(At[O][ur]);else m[O].push(...new Array(At[0].length).fill(null))}else m.push(m[O%H].slice(0,Hn).concat(At[O]));s.populateFromArray(Q,ie,m);break;case"overwrite":default:M.row=f.row,M.col=f.col;let yt=0,lr=0,ii=!0,Yr;const Fi=function(oi){let si=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const dn=m[oi%m.length];return si!==null?dn[si%dn.length]:dn},Er=m.length,hn=p?p.row-f.row+1:0;for(p?H=hn:H=Math.max(Er,hn),O=0;O<H&&!(p&&M.row>p.row&&hn>Er||!y.allowInsertRow&&M.row>s.countRows()-1||M.row>=y.maxRows);O++){const ur=O-yt,oi=Fi(ur).length,si=p?p.col-f.col+1:0;if(p?U=si:U=Math.max(oi,si),M.col=f.col,Yr=s.getCellMeta(M.row,M.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Yr.skipRowOnPaste){yt+=1,M.row+=1,H+=1;continue}for(lr=0,k=0;k<U;k++){var de;if(p&&M.col>p.col&&si>oi||!y.allowInsertColumn&&M.col>s.countCols()-1||M.col>=y.maxCols)break;if(Yr=s.getCellMeta(M.row,M.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Yr.skipColumnOnPaste){lr+=1,M.col+=1,U+=1;continue}if(Yr.readOnly&&R!=="UndoRedo.undo"){M.col+=1;continue}const dn=k-lr,ai=!!Yr.valueSetter;let Tr=Fi(ur,dn),bt=(de=s.getSourceDataAtCell(M.row,M.col))!==null&&de!==void 0?de:null;if(Tr!==null&&typeof Tr=="object"){if(Array.isArray(Tr)&&bt===null&&(bt=[]),!ai&&(typeof bt!="object"||bt===null))ii=!1;else if(bt!==null){const hl=Va(Array.isArray(bt)?bt:bt[0]||bt),dl=Va(Array.isArray(Tr)?Tr:Tr[0]||Tr);ai||A_(hl,dl)||Array.isArray(hl)&&Array.isArray(dl)?Tr=br(Tr):ii=!1}}else!ai&&bt!==null&&typeof bt=="object"&&(ii=!1);ii&&$.push([M.row,M.col,Tr]),ii=!0,M.col+=1}M.row+=1}s.setDataAtCell($,null,null,R||"populateFromArray");break}}};function K(f){const m=k0(f);sw(m)?(s.runHooks("beforeLanguageChange",m),I.language=m,s.runHooks("afterLanguageChange",m)):L0(f)}function te(f,m){const p=f==="className"?s.rootElement:s.table;if(w)X(p,m);else{let R=[],_=[];I[f]&&(R=Array.isArray(I[f])?I[f]:AC(I[f])),m&&(_=Array.isArray(m)?m:AC(m));const O=HC(R,_),H=HC(_,R);O.length&&xe(p,O),H.length&&X(p,H)}I[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(Ti()||N_())&&X(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new BV(this),h=Xg.getInstance(s,y,L),g=ij(s),d=new mk(s),Qi(this)&&(XB(s),yj(s.rootPortalElement),YD(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),w&&s.rootElement.offsetParent===null&&AN(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof w=="object"&&(s.runHooks("afterChange",w[0],w[1]),w=!1),s.runHooks("afterInit")};function dt(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Re(f,m,p){if(!f.length){p();return}const R=s.getActiveEditor(),_=new dt;let O=!0;_.onQueueEmpty=()=>{R&&O&&R.cancelChanges(),p()};for(let H=f.length-1;H>=0;H--){const[k,U,,$]=f[H],M=l.propToCol(U);let B;Number.isInteger(M)?B=s.getCellMeta(k,M):B={...Object.getPrototypeOf(y),...y},s.getCellValidator(B)&&(_.addValidatorToQueue(),s.validateCell($,B,function(Q,ie){return function(ye){if(typeof ye!="boolean")throw new Error("Validation error: result is not boolean");ye===!1&&ie.allowInvalid===!1&&(O=!1,f.splice(Q,1),ie.valid=!0),_.removeValidatorFormQueue()}}(H,B),m))}_.checkIfQueueIsEmpty()}function Ee(f,m){for(let R=f.length-1;R>=0;R--){let _=!1;if(f[R]===null){f.splice(R,1);continue}if(!((f[R][2]===null||f[R][2]===void 0)&&(f[R][3]===null||f[R][3]===void 0))){if(y.allowInsertRow)for(;f[R][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[R][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}_||l.set(f[R][0],f[R][1],f[R][3])}}if(f.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",f,m||"edit");const R=s.getActiveEditor();R&&he(R.refreshValue)&&R.refreshValue()}else s.render()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,p){return s.view._wt.createCellRange(f,m,p)},this.validateCell=function(f,m,p,R){let _=s.getCellValidator(m);function O(H){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(H);return}const U=m.visualCol,$=m.visualRow,M=s.getCell($,U,!0);if(M&&M.nodeName!=="TH"){const B=s.rowIndexMapper.getRenderableFromVisualIndex($),Q=s.columnIndexMapper.getRenderableFromVisualIndex(U);s.view._wt.getSetting("cellRenderer",B,Q,M)}p(H)}jD(_)&&(_=function(H){return function(k,U){U(H.test(k))}}(_)),Oe(_)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,R),s._registerImmediate(()=>{_.call(m,f,H=>{s&&(H=s.runHooks("afterValidate",H,f,m.visualRow,m.prop,R),m.valid=H,O(H),s.runHooks("postAfterValidate",H,f,m.visualRow,m.prop,R))})})):s._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function Ye(f,m,p){return Array.isArray(f)?f:[[f,m,p]]}function $e(f,m){const p=s.runHooks("beforeChange",f,m||"edit"),R=f.filter(O=>O!==null);if(p===!1||R.length===0){var _;return(_=s.getActiveEditor())===null||_===void 0||_.cancelChanges(),[]}for(let O=R.length-1;O>=0;O--){const[H,k,,U]=R[O],$=l.propToCol(k);let M;Number.isInteger($)?M=s.getCellMeta(H,$):M={...Object.getPrototypeOf(y),...y},R[O][3]=lg(U,M)}return R}this.setDataAtCell=function(f,m,p,R){const _=Ye(f,m,p),O=[];let H=R,k,U,$;for(k=0,U=_.length;k<U;k++){const[B,Q,ie]=_[k];if(typeof _[k]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Q!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Q>=this.countCols()?$=Q:$=l.colToProp(Q),O.push([B,$,u.getAtCell(this.toPhysicalRow(B),Q),ie])}!H&&typeof f=="object"&&(H=m);const M=$e(O,H);s.runHooks("afterSetDataAtCell",M,H),Re(M,H,()=>{Ee(M,H)})},this.setDataAtRowProp=function(f,m,p,R){const _=Ye(f,m,p),O=[];let H=R,k,U;for(k=0,U=_.length;k<U;k++){const[M,B,Q]=_[k];O.push([M,B,u.getAtCell(this.toPhysicalRow(M),B),Q])}!H&&typeof f=="object"&&(H=m);const $=$e(O,R);s.runHooks("afterSetDataAtRowProp",$,H),Re($,H,()=>{Ee($,H)})},this.listen=function(){s&&!s.isListening()&&(fg.forEach(f=>{s!==f&&f.unlisten()}),dg=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(dg=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return dg===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(f),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this.populateFromArray=function(f,m,p,R,_,O,H){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const k=typeof R=="number"?s._createCellCoords(R,_):null;return c.populateFromArray(s._createCellCoords(f,m),p,k,O,H)},this.spliceCol=function(f,m,p){for(var R=arguments.length,_=new Array(R>3?R-3:0),O=3;O<R;O++)_[O-3]=arguments[O];return l.spliceCol(f,m,p,..._)},this.spliceRow=function(f,m,p){for(var R=arguments.length,_=new Array(R>3?R-3:0),O=3;O<R;O++)_[O-3]=arguments[O];return l.spliceRow(f,m,p,..._)},this.getSelected=function(){if(L.isSelected())return _n(L.getSelectedRange(),f=>{let{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedActive=function(){const f=this.getSelectedRangeActive();if(!f)return;const{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRangeActive=function(){return L.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return L.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(f){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];j(L.getSelectedRange(),p=>{if(p.isSingleHeader())return;const R=p.getTopStartCorner(),_=p.getBottomEndCorner();Ge(R.row,_.row,O=>{Ge(R.col,_.col,H=>{this.getCellMeta(O,H).readOnly||m.push([O,H,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=f();return this.resumeExecution(m),p},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const f=s.view,{width:m,height:p}=f.getLastSize(),{width:R,height:_}=s.rootElement.getBoundingClientRect(),O=R!==m||_!==p;s.runHooks("beforeRefreshDimensions",{width:m,height:p},{width:R,height:_},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===s.rootWindow)&&(f.setLastSize(R,_),f.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:m,height:p},{width:R,height:_},O))},this.updateData=function(f,m){IR(f,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),L.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:E,firstRun:w})},this.loadData=function(f,m){IR(f,p=>{l=p},()=>{E.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),L.refresh(),w&&(w=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:E,firstRun:w})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Oe(f))if(s.dataType==="array"){const p=this.countSourceCols();for(let R=0;R<p;R+=1)f(R)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(he(y.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:cp(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,p,R){return Bt(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(p,R),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,p,R){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(p,R))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getCopyableSourceData=function(f,m){return u.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(w?s.loadData:s.updateData).bind(this);let R=!1,_,O;if(he(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(he(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(he(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(_ in f)if(!(_==="data"||_==="language"))if(_==="className")te("className",f.className);else if(_==="tableClassName"&&s.table)te("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(fe.getSingleton().isRegistered(_)||fe.getSingleton().isDeprecated(_)){const M=f[_];Oe(M)?(fe.getSingleton().addAsFixed(_,M,s),y[_]=M):Array.isArray(M)&&(fe.getSingleton().add(_,M,s),y[_]=M)}else!m&&Fr(f,_)&&(I[_]=f[_]);if(m)s.useTheme(y.themeName||NR(s.rootContainer));else{const M=s.getCurrentThemeName();Fr(f,"themeName")&&M!==f.themeName&&s.useTheme(f.themeName)}ql.has(s)&&s.stylesHandler.getThemeName()!==void 0&&ql.delete(s),Qi(s)&&!ql.has(s)&&s.stylesHandler.isClassicTheme()&&(WN("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),ql.add(s)),f.data===void 0&&y.data===void 0?p(null,"updateSettings"):f.data!==void 0?p(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!w&&f.language&&K(f.language);const H=s.countCols(),k=y.columns;if(k&&Oe(k)&&(R=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&E.clearCache(),H>0)for(_=0,O=0;_<H;_++){if(k){const M=R?k(_):k[O];M&&E.updateColumnMeta(O,M)}O+=1}he(f.cell)&&He(f.cell,M=>{s.setCellMetaObject(M.row,M.col,M)}),s.runHooks("afterCellMetaReset");let U=s.rootElement.style.height;U!==""&&(U=parseInt(s.rootElement.style.height,10)),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let $=f.height;if(typeof f.height<"u")if(Oe($)&&($=$()),$=s.runHooks("beforeHeightChange",$),$===null){const M=s.rootElement.getAttribute("data-initialstyle");M&&(M.indexOf("height")>-1||M.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",M):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else $!==void 0&&(s.rootElement.style.height=isNaN($)?`${$}`:`${$}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let M=f.width;Oe(M)&&(M=M()),M=s.runHooks("beforeWidthChange",M),s.rootElement.style.width=isNaN(M)?`${M}`:`${M}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!w&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(U===""||$===""||$===void 0)&&U!==$&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedRangeActive();if(y.getValue){if(Oe(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f.highlight.row][y.getValue]}else if(f)return s.getDataAtCell(f.highlight.row,f.highlight.col);return null},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,p,R,_){c.alter(f,m,p,R,_)},this.getCell=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=m,_=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;R=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return _===null||R===null||_===void 0||R===void 0?null:s.view.getCellAtCoords(s._createCellCoords(_,R),p)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:p,col:R}=m;let _=p,O=R;return p>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(p)),R>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(R)),s._createCellCoords(_,O)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],p=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let R=0;R<p.length;R+=1)for(let _=0;_<p[R].length;_+=1)m.push(p[R][_]);return m},this.getDataAtProp=function(f){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let R=0;R<p.length;R+=1)for(let _=0;_<p[R].length;_+=1)m.push(p[R][_]);return m},this.getSourceData=function(f,m,p,R){let _;return f===void 0?_=u.getData():_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,R)),_},this.getSourceDataArray=function(f,m,p,R){let _;return f===void 0?_=u.getData(!0):_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,R),!0),_},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,p,R){const _=Ye(f,m,p),O=this.hasHook("afterSetSourceDataAtCell"),H=[],k=($,M)=>{const B=this.toVisualRow($),Q=this.toVisualColumn(M);return Number.isInteger(Q)?this.getCellMeta(B,Q):{...Object.getPrototypeOf(y),...y}};O&&j(_,$=>{let[M,B,Q]=$;const ie=lg(Q,k(M,B));H.push([M,B,u.getAtCell(M,B),ie])}),j(_,$=>{let[M,B,Q]=$;const ie=lg(Q,k(M,B));u.setAtCell(M,B,ie)}),O&&this.runHooks("afterSetSourceDataAtCell",H,R),this.render();const U=s.getActiveEditor();U&&he(U.refreshValue)&&U.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,p,R){const _=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,p,R],[O,H]=_;let[,,k,U]=_,$=null,M=null;k===void 0&&(k=O),U===void 0&&(U=H);let B="mixed";return Ge(Math.max(Math.min(O,k),0),Math.max(O,k),Q=>{let ie=!0;return Ge(Math.max(Math.min(H,U),0),Math.max(H,U),ye=>(M=this.getCellMeta(Q,ye).type,$?ie=$===M:$=M,ie)),B=ie?M:"mixed",ie}),B},this.removeCellMeta=function(f,m,p){const[R,_]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=E.getCellMetaKeyValue(R,_,p);s.runHooks("beforeRemoveCellMeta",f,m,p,O)!==!1&&(E.removeCellMeta(R,_,p),s.runHooks("afterRemoveCellMeta",f,m,p,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,R=new Array(p>2?p-2:0),_=2;_<p;_++)R[_-2]=arguments[_];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(f),m),R.length>0&&j(R.reverse(),O=>{E.createRow(this.toPhysicalRow(f)),j(O,(H,k)=>this.setCellMetaObject(f,k,H))}),s.render()},this.setCellMetaObject=function(f,m,p){typeof p=="object"&&He(p,(R,_)=>{this.setCellMeta(f,m,_,R)})},this.setCellMeta=function(f,m,p,R){if(s.runHooks("beforeSetCellMeta",f,m,p,R)===!1)return;let O=f,H=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(H=this.toPhysicalColumn(m)),E.setCellMeta(O,H,p,R),s.runHooks("afterSetCellMeta",f,m,p,R)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},R=this.toPhysicalRow(f),_=this.toPhysicalColumn(m);return R===null&&(R=f),_===null&&(_=m),E.getCellMeta(R,_,{visualRow:f,visualColumn:m,...p})},this.getColumnMeta=function(f){return E.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return E.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof p=="string"?SS(p):Bt(p)?SS("text"):p},this.getCellEditor=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof p=="string"?sS(p):Bt(p)?sS("text"):p},this.getCellValidator=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof p=="string"?Uk(p):p},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,p){const R=new dt;f&&(R.onQueueEmpty=f);let _=s.countRows()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}R.addValidatorToQueue(),s.validateCell(s.getDataAtCell(_,O),s.getCellMeta(_,O),H=>{if(typeof H!="boolean")throw new Error("Validation error: result is not boolean");H===!1&&(R.valid=!1),R.removeValidatorFormQueue()},"validateCells"),O-=1}_-=1}R.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,p=f;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],Ge(s.countRows()-1,R=>{m.push(s.getRowHeader(R))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:Oe(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",f);if(p===void 0){const k=[],U=s.countCols();for(let $=0;$<U;$++)k.push(s.getColHeader($));return k}let R=y.colHeaders;const _=function(k){const U=[],$=s.countCols();let M=0;for(;M<$;M++)Oe(y.columns)&&y.columns(M)&&U.push(M);return U[k]},O=s.toPhysicalColumn(p),H=_(O);return y.colHeaders===!1?R=null:y.columns&&Oe(y.columns)&&y.columns(H)&&y.columns(H).title?R=y.columns(H).title:y.columns&&y.columns[O]&&y.columns[O].title?R=y.columns[O].title:Array.isArray(y.colHeaders)&&y.colHeaders[O]!==void 0?R=y.colHeaders[O]:Oe(y.colHeaders)?R=y.colHeaders(O):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(R=GV(p)),R=s.runHooks("modifyColumnHeaderValue",R,f,m),R},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let p=s._getColWidthFromSettings(f);return p=s.runHooks("modifyColWidth",p,f,m),p===void 0&&(p=yp),p},this._getRowHeightFromSettings=function(f){const m=s.stylesHandler.getDefaultRowHeight();let p=y.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<m?m:p},this.getRowHeight=function(f,m){let p=s._getRowHeightFromSettings(f);return p=s.runHooks("modifyRowHeight",p,f,m),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return bS(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return bS(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,p,R){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Bt(f)||Bt(m)?!1:this.selectCells([[f,m,p,R]],_,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const R=L.selectCells(f);return R&&p&&s.listen(),g.resume(),R},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectColumns(f,m,p)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectRows(f,m,p)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),L.selectAll(f,m,p)};const Ie=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var p;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:R,col:_,considerHiddenIndexes:O}=f??{};let H=R,k=_;if(Oe(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const B=Number.isInteger(R)&&R>=0,Q=Number.isInteger(_)&&_>=0,ie=B?Ie(this.rowIndexMapper,R):void 0,ye=Q?Ie(this.columnIndexMapper,_):void 0;if(ie===null||ye===null)return!1;H=B?s.rowIndexMapper.getRenderableFromVisualIndex(ie):R,k=Q?s.columnIndexMapper.getRenderableFromVisualIndex(ye):_}const U=Number.isInteger(H),$=Number.isInteger(k);let M=!1;return U&&H>=0&&$&&k>=0?M=s.view.scrollViewport(s._createCellCoords(H,k),f.horizontalSnap,f.verticalSnap):U&&H>=0&&($&&k<0||!$)?M=s.view.scrollViewportVertically(H,f.verticalSnap):$&&k>=0&&(U&&H<0||!U)&&(M=s.view.scrollViewportHorizontally(k,f.horizontalSnap)),Oe(m)&&(M?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),M},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Oe(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeActive(),p=this.scrollViewportTo(m.toObject());return p?this.view.render():Oe(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),p},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,Qi(this)&&bj(),this.getShortcutManager().destroy(),P.clear(),E.clearCache(),fg.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&ys(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),x.getItems().forEach(f=>{let[,m]=f;m.destroy()}),x.clear(),s.runHooks("afterDestroy")},!0),fe.getSingleton().destroy(s),He(s,(f,m,p)=>{Oe(f)?p[m]=cn(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function cn(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return x.getItem(hc(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m,p){fe.getSingleton().add(f,m,s,p)},this.hasHook=function(f){return fe.getSingleton().has(f,s)||fe.getSingleton().has(f)},this.addHookOnce=function(f,m,p){fe.getSingleton().once(f,m,s,p)},this.removeHook=function(f,m){fe.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,p,R,_,O,H){return fe.getSingleton().run(s,f,m,p,R,_,O,H)},this.getTranslatedPhrase=function(f,m){return rM(y.language,f,m)},this.toHTML=()=>wS(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",wS(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!w;this.stylesHandler.useTheme(f);const p=this.stylesHandler.getThemeName();m||(s.render(),s.scrollViewportTo(0,0),NR(this.rootContainer)&&(xe(this.rootContainer,/ht-theme-.*/g),p&&X(this.rootContainer,p))),this.runHooks("afterSetTheme",p,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=f;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){j(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){j(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return h};const Te=cj({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&Te.releasePressedKeys()}),this.getShortcutManager=function(){return Te},this.getFocusManager=function(){return d},i0().forEach(f=>{const m=vp(f);x.addItem(f,new m(this))}),qB(s),Te.setActiveContextName("grid"),fe.getSingleton().run(s,"construct")}function BR(t,e,r){t.addEventListener(e,r,!1)}function jR(t,e,r){t.removeEventListener(e,r,!1)}function Gl(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Cj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=Gl(s).fontSize,o.style.fontFamily=Gl(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=Gl(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),w=parseInt(((d=Gl(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+g+w+1;n.removeChild(o);const C=s.style;C.height=`${r.minHeight}px`,r.minWidth>v?C.width=`${r.minWidth}px`:v>r.maxWidth?C.width=`${r.maxWidth}px`:C.width=`${v}px`;const T=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>T?C.height=`${r.minHeight}px`:r.maxHeight<T?(C.height=`${r.maxHeight}px`,C.overflowY="visible"):C.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(BR(s,"input",a),BR(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){jR(s,"input",a),jR(s,"keydown",l)}}}function zR(t,e){const r=IN(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}z_(e,i)}function Gi(t,e,r){return(e=Sj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sj(t){var e=Rj(t,"string");return typeof e=="symbol"?e:e+""}function Rj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ej="ht_editor_visible",Kl="ht_editor_hidden",UR="textEditor",Tj="text";class _j extends hw{static get EDITOR_TYPE(){return Tj}constructor(e){super(e),Gi(this,"eventManager",new Hi(this)),Gi(this,"autoResize",Cj(this.hot.rootDocument)),Gi(this,"TEXTAREA",void 0),Gi(this,"textareaStyle",void 0),Gi(this,"TEXTAREA_PARENT",void 0),Gi(this,"textareaParentStyle",void 0),Gi(this,"layerClass",void 0),this.eventManager=new Hi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),gu(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==lt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===lt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),z_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Me(this.TEXTAREA,[["data-hot-input",""],Po(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Kl),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){bN()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Kl)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ge(e.length-1,n=>{const i=e[n];if(ve(i,"handsontableEditor"))return r=!0,!1}),ve(this.TEXTAREA_PARENT,Kl)&&xe(this.TEXTAREA_PARENT,Kl),r?(this.layerClass=Ej,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==lt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){D_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===lt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===lt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>he(this.hot.getSelected()),group:UR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;zR(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;zR(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UR)}}const Oj="base",Mj="htTextEllipsis";function yM(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(FC())):a&&c.push(FC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(VC())):(u.push(s.invalidCellClassName),a&&c.push(VC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(Mj),xe(e,u),X(e,l),ol(e,c),Me(e,h)}yM.RENDERER_TYPE=Oj;const Ij="text";function bM(t,e,r,n,i,o,s){yM.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=lp(a),s.trimWhitespace&&(a=a.trim()),sl(e,a)}bM.RENDERER_TYPE=Ij;const Pj="text",xj={CELL_TYPE:Pj,editor:_j,renderer:bM};b$(xj);un.editors={BaseEditor:hw};function un(t,e){const r=new vM(t,e||{},Dp);return r.init(),r}un.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new vM(t,e,Dp)};un.DefaultSettings=lM();un.hooks=fe.getSingleton();un.CellCoords=mo;un.CellRange=al;un.packageName="handsontable";un.buildDate="15/09/2025 10:06:12";un.version="16.1.0";un.languages={dictionaryKeys:MW,getLanguageDictionary:tM,getLanguagesDictionaries:AW,registerLanguageDictionary:eM,getTranslatedPhrase:rM};function Hj(t,e){CM(t,e),e.add(t)}function Yo(t,e,r){return(e=Aj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Aj(t){var e=Dj(t,"string");return typeof e=="symbol"?e:e+""}function Dj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YR(t,e,r){CM(t,e),e.set(t,r)}function CM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xl(t,e,r){return t.set(fw(t,e),r),r}function Ke(t,e){return t.get(fw(t,e))}function fw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const qR=new Map([["plugin",Lk],["cell-type",aM],["editor",J_],["renderer",o0],["validator",s0]]),Nj=Symbol("mainSetting"),kj="base",Zl=[];let Ki=null;var tt=new WeakMap,Xi=new WeakMap,GR=new WeakSet;class Ec{static get PLUGIN_KEY(){return kj}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Hj(this,GR),YR(this,tt,null),Yo(this,"eventManager",new Hi(this)),Yo(this,"pluginName",null),Yo(this,"pluginsInitializedCallbacks",[]),Yo(this,"isPluginsReady",!1),Yo(this,"enabled",!1),Yo(this,"initialized",!1),YR(this,Xi,{}),ri(this,"hot",e,{writable:!1}),Ki=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!qR.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);qR.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Zl.push(o)}}if(Ki||(Ki=i0()),Ki.indexOf(this.pluginName)>=0&&Ki.splice(Ki.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ki.length===0){if(Zl.length>0){const i=[`${Zl.join(`
`)}
`,"You have to import and register them manually."].join("");throw Zl.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return nt(Ke(tt,this))?fu(Ke(tt,this),r):Ke(tt,this);if((Array.isArray(Ke(tt,this))||nt(Ke(tt,this)))&&r[Nj]===e){var n;return Array.isArray(Ke(tt,this))?Ke(tt,this):(n=Ke(tt,this)[e])!==null&&n!==void 0?n:r[e]}if(e.includes(".")){const i=Yg(Ke(tt,this),e),o=Yg(r,e);return nt(i)?fu(i,o):i!==void 0?i:o}return nt(Ke(tt,this))?fu(Ke(tt,this),r)[e]:r[e]}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){Vr(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Xl(tt,this,e),Ke(tt,this)}return r&&typeof r=="object"&&typeof e=="object"?((Ke(tt,this)===null||typeof Ke(tt,this)!="object")&&Xl(tt,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){Vr(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}Ke(tt,this)[n]=e[n]}),Ke(tt,this)):(Xl(tt,this,e),e)}addHook(e,r,n){Ke(Xi,this)[e]=Ke(Xi,this)[e]||[];const i=Ke(Xi,this)[e];this.hot.addHook(e,r,n),i.push(r),Ke(Xi,this)[e]=i}removeHooks(e){j(Ke(Xi,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Ke(Xi,this);He(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){j(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=fw(GR,this,Lj).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Xl(tt,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),He(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function Lj(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Zi(t,e,r){return(e=Fj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fj(t){var e=Vj(t,"string");return typeof e=="symbol"?e:e+""}function Vj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wj{constructor(e){Zi(this,"hot",null),Zi(this,"container",null),Zi(this,"injected",!1),Zi(this,"rows",[]),Zi(this,"columns",[]),Zi(this,"samples",null),Zi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),j(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),j(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{j(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{j(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{j(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),j(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{j(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function la(t,e,r){return(e=$j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $j(t){var e=Bj(t,"string");return typeof e=="symbol"?e:e+""}function Bj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gw{static get SAMPLE_COUNT(){return 3}constructor(e){la(this,"samples",null),la(this,"dataFactory",null),la(this,"customSampleCount",null),la(this,"allowDuplicates",!1),la(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:gw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Ge(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ge(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:nt(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${lp(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function jj(t,e){SM(t,e),e.add(t)}function gg(t,e,r){SM(t,e),e.set(t,r)}function SM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ua(t,e,r){return(e=zj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zj(t){var e=Uj(t,"string");return typeof e=="symbol"?e:e+""}function Uj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _i(t,e){return t.get(tr(t,e))}function zu(t,e,r){return t.set(tr(t,e),r),r}function tr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}fe.getSingleton().register("modifyAutoColumnSizeSeed");const mg="autoColumnSize",Yj=10,qj="autoColumnSize";var mw=new WeakMap,ns=new WeakMap,Cs=new WeakMap,gr=new WeakSet;class Ha extends Ec{static get PLUGIN_KEY(){return mg}static get PLUGIN_PRIORITY(){return Yj}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),jj(this,gr),ua(this,"ghostTable",new Wj(this.hot)),ua(this,"samplesGenerator",new gw((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ua(this,"inProgress",!1),ua(this,"measuredColumns",0),ua(this,"columnWidthsMap",new vc),gg(this,mw,!1),gg(this,ns,[]),gg(this,Cs,[]),this.hot.columnIndexMapper.registerMap(qj,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>tr(gr,this,KR).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[mg]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return tr(gr,e,Xj).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return tr(gr,e,Zj).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return tr(gr,e,Qj).call(e,...i)}),this.addHook("beforeRender",()=>tr(gr,this,Kj).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>tr(gr,this,Jj).call(this)),super.enablePlugin()}updatePlugin(){zu(Cs,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>tr(gr,this,KR).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Ge(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&tr(gr,this,RM).call(this,s,o)}),this.ghostTable.columns.length&&(tr(gr,this,EM).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){jC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ha.CALCULATION_STEP,i)},e,r),n=n+Ha.CALCULATION_STEP+1,n<i?o=qg(s):(jC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[mg];let r=Ha.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return nt(e)&&(r=e.syncLimit,KD(r)?r=Ok(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,yp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=_i(ns,this).length;return(s-1<o||_i(ns,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?_i(ns,this).push(i):_i(ns,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Gj(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||tr(gr,this,RM).call(this,r,e))}),this.ghostTable.columns.length&&(tr(gr,this,EM).call(this),this.ghostTable.clean())}function RM(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function EM(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function Kj(){this.calculateVisibleColumnsWidth(),this.inProgress||(tr(gr,this,Gj).call(this,_i(Cs,this)),zu(Cs,this,[]))}function Xj(t,e){e||this.recalculateAllColumnsWidth()}function Zj(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);_i(Cs,this).push(...e)}function KR(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function Jj(){zu(ns,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),zu(mw,this,!0)}function Qj(t){if(!_i(mw,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);_i(Cs,this).push(...e)}function ez(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function tz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ji(t,e){const r={};return j(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function vi(t,e,r,n,i){j(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&rz(s,a,e,r,n,i)})})}function rz(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=ez(s.className,n):a=tz(s.className,n)),o(t,e,"className",a)}function nz(t){return`<span class="selected">â</span>${t}`}function pg(t,e){let r=!1;return Array.isArray(t)&&j(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function TM(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const Rt="---------";function iz(){return{name:Rt}}const en="alignment";function oz(){return{key:en,name(){return this.getTranslatedPhrase(Zp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${en}:left`,name(){return this.getTranslatedPhrase(Jp)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${en}:center`,name(){return this.getTranslatedPhrase(Qp)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${en}:right`,name(){return this.getTranslatedPhrase(ew)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${en}:justify`,name(){return this.getTranslatedPhrase(tw)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Rt},{key:`${en}:top`,name(){return this.getTranslatedPhrase(rw)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${en}:middle`,name(){return this.getTranslatedPhrase(nw)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${en}:bottom`,name(){return this.getTranslatedPhrase(iw)},callback(){const t=this.getSelectedRange(),e=Ji(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),vi(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const pw="clear_column";function sz(){return{key:pw,name(){return this.getTranslatedPhrase(Up)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const Tc="col_left";function az(){return{key:Tc,name(){return this.getTranslatedPhrase(Vp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const _c="col_right";function lz(){return{key:_c,name(){return this.getTranslatedPhrase(Wp)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Oc="make_read_only";function uz(){return{key:Oc,checkable:!0,ariaChecked(){return pg(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Wu)},name(){let t=this.getTranslatedPhrase(Wu);return pg(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=nz(t)),t},callback(){const t=this.getSelectedRange(),e=pg(t,(r,n)=>this.getCellMeta(r,n).readOnly);j(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Mc="redo";function cz(){return{key:Mc,name(){return this.getTranslatedPhrase(zp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ic="remove_col";function hz(){return{key:Ic,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Bp,e)},callback(){this.alter("remove_col",a$(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Pc="remove_row";function dz(){return{key:Pc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase($p,e)},callback(){this.alter("remove_row",l$(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const xc="row_above";function fz(){return{key:xc,name(){return this.getTranslatedPhrase(Lp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Hc="row_below";function gz(){return{key:Hc,name(){return this.getTranslatedPhrase(Fp)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const ja="no_items";function mz(){return{key:ja,name(){return this.getTranslatedPhrase(kp)},disabled:!0,isCommand:!1}}const Ac="undo";function pz(){return{key:Ac,name(){return this.getTranslatedPhrase(jp)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const wz=[xc,Hc,Tc,_c,pw,Pc,Ic,Ac,Mc,Oc,en,Rt,ja],vz={[Rt]:iz,[ja]:mz,[xc]:fz,[Hc]:gz,[Tc]:az,[_c]:lz,[pw]:sz,[Pc]:dz,[Ic]:hz,[Ac]:pz,[Mc]:cz,[Oc]:uz,[en]:oz};function _M(){const t={};return He(vz,(e,r)=>{t[r]=e()}),t}function wg(t,e,r){return(e=yz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yz(t){var e=bz(t,"string");return typeof e=="symbol"?e:e+""}function bz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cz{constructor(e){wg(this,"hot",void 0),wg(this,"commands",{}),wg(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Sz(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Fr(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),j(u,c=>c.apply(this.hot,n))}}function Sz(t,e){let r;return j(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function vg(t,e,r){return(e=Rz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rz(t){var e=Ez(t,"string");return typeof e=="symbol"?e:e+""}function Ez(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tz{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;vg(this,"hot",void 0),vg(this,"predefinedItems",_M()),vg(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,He(e,(n,i)=>{let o="";n.name===Rt?(r[Rt]=n,o=Rt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return _z(e,this.defaultOrderPattern,this.predefinedItems)}}function _z(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),nt(i)?He(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),nt(o)?xi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):j(i,(o,s)=>{let a=r[o];!a&&wz.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),nt(o)&&xi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function fi(t,e,r){return(e=Oz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oz(t){var e=Mz(t,"string");return typeof e=="symbol"?e:e+""}function Mz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iz{constructor(e,r){fi(this,"top",void 0),fi(this,"topRelative",void 0),fi(this,"left",void 0),fi(this,"leftRelative",void 0),fi(this,"scrollTop",void 0),fi(this,"scrollLeft",void 0),fi(this,"cellHeight",void 0),fi(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ca(t,e,r){Pz(t,e),e.set(t,r)}function Pz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ne(t,e){return t.get(OM(t,e))}function Jl(t,e,r){return t.set(OM(t,e),r),r}function OM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Lt=new WeakMap,Xt=new WeakMap,Zt=new WeakMap,yg=new WeakMap,qo=new WeakMap;class xz{constructor(e){ca(this,Lt,void 0),ca(this,Xt,void 0),ca(this,Zt,void 0),ca(this,yg,!1),ca(this,qo,{above:0,below:0,left:0,right:0}),Jl(yg,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ne(qo,this)[e]=r,this}setElement(e){return Jl(Lt,this,e),this}setParentElement(e){return Jl(Xt,this,e),this}updatePosition(e){Jl(Zt,this,new Iz(e,ne(Lt,this).ownerDocument.defaultView)),ne(yg,this)?(ne(Zt,this).fitsBelow(ne(Lt,this))?this.setPositionBelowCursor():ne(Zt,this).fitsAbove(ne(Lt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ne(Lt,this).dir==="rtl"?ne(Zt,this).fitsOnLeft(ne(Lt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ne(Zt,this).fitsOnRight(ne(Lt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ne(qo,this).above+ne(Zt,this).top-ne(Lt,this).offsetHeight;if(ne(Xt,this)){const n=ne(Xt,this).ownerDocument.defaultView.getComputedStyle(ne(Xt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(Zt,this).top+ne(Zt,this).cellHeight-ne(Lt,this).scrollHeight+i+o}ne(Lt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ne(qo,this).below+ne(Zt,this).top+1;if(ne(Xt,this)){const n=ne(Xt,this).ownerDocument.defaultView.getComputedStyle(ne(Xt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(Zt,this).top-i-o}ne(Lt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ne(Zt,this).left;if(ne(Xt,this)){const r=ne(Xt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Xt,this).querySelector(".htCore")).borderRightWidth,10);e+=ne(Zt,this).cellWidth+n}else e+=ne(qo,this).right;ne(Lt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ne(qo,this).left+ne(Zt,this).left-ne(Lt,this).offsetWidth;if(ne(Xt,this)){const r=ne(Xt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Xt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ne(Lt,this).style.left=`${e}px`}}function Hz(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=De(e,-1,v()-1);function a(T,b){const E=v()-1;return T<0&&(T=E),T>E&&(T=0),o.has(T)?-1:(o.add(T),n(T,!1)===!1&&(T=a(b===1?++T:--T,b)),T)}function l(T){T>-1&&T<v()&&n(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<v()&&(s=T)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function g(){v()>0&&(o.clear(),s=a(++s,1))}function w(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(r(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:w,getSize:v,clear:C}}function Az(t){return _n(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function am(t){return Fr(t,"submenu")}function lm(t){return new RegExp(Rt,"i").test(t.name)}function bu(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function XR(t){return Fr(t,"disableSelection")}function Dz(t){return ve(t,"htSeparator")}function Nz(t){return ve(t,"htSubmenu")}function kz(t){return ve(t,"htDisabled")}function Lz(t){return ve(t,"htSelectionDisabled")}function Fz(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function MM(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function Vz(t,e){let r=t.slice(0);return r.reverse(),r=MM(r,e),r.reverse(),r}function Wz(t){const e=[];return j(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function $z(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rt,r=t.slice(0);return r=MM(r,e),r=Vz(r,e),r=Wz(r),r}function Bz(t){return t.checkable===!0}function jz(t){return Hz({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||Dz(n)||kz(n)||Lz(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function zz(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const IM="menu",ZR=IM;function Uz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(zz(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:IM})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(w=>h.removeShortcutsByKeys(w))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${ZR}:${u}`:ZR}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Yz(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ys(r),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!bu(a,t)&&!XR(a)&&!lm(a);Me(r,[...Bz(a)?[nN(),Au(c),uN(h)]:[rN(),Au(u)],...d?[Po(-1)]:[],...bu(a,t)?[aN()]:[],...am(a)?[du(!1)]:[]])}r.className="",r.appendChild(l),lm(a)?X(r,"htSeparator"):typeof a.renderer=="function"?(X(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):W_(l,u),bu(a,t)?X(r,"htDisabled"):XR(a)?X(r,"htSelectionDisabled"):am(a)&&X(r,"htSubmenu")}}function bg(t,e,r){qz(t,e),e.set(t,r)}function qz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yn(t,e,r){return(e=Gz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gz(t){var e=Kz(t,"string");return typeof e=="symbol"?e:e+""}function Kz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cg(t,e,r){return t.set(PM(t,e),r),r}function gi(t,e){return t.get(PM(t,e))}function PM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const JR=215;var Go=new WeakMap,Ql=new WeakMap,eu=new WeakMap;class Dc{get tableBorderWidth(){return gi(eu,this)===void 0&&this.hotMenu&&Cg(eu,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),gi(eu,this)}constructor(e,r){var n=this;yn(this,"hot",void 0),yn(this,"options",void 0),yn(this,"eventManager",new Hi(this)),yn(this,"container",void 0),yn(this,"positioner",void 0),yn(this,"hotMenu",null),yn(this,"hotSubMenus",{}),yn(this,"parentMenu",void 0),yn(this,"menuItems",null),yn(this,"origOutsideClickDeselects",null),bg(this,Go,void 0),bg(this,Ql,void 0),bg(this,eu,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:JR,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new xz(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(xe(this.options.container,/ht-theme-.*/g),X(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Wa(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return gi(Go,this)}getKeyboardShortcutsCtrl(){return gi(Ql,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=G_(a=>this.openSubMenu(a),300),r=this.options.minWidth||JR;let n=!1,i=ap(this.menuItems,a=>(a.key===ja&&(n=!0),Fz(a,this.hot)));if(i.length<1&&!n)i.push(_M()[ja]);else if(i.length===0)return;i=$z(i,Rt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return he(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Yz(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?gi(Go,this).setCurrentPage(l.row):gi(Go,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),zC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!zC()||!ku(a))&&o&&this.hasSelectedItem()&&(Ti()||N_()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Cg(Go,this,jz(this.hotMenu)),Cg(Ql,this,Uz(this)),gi(Ql,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(gi(Go,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Me(n,[du(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!Nz(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Dc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Me(r,[du(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Me(i,[du(!1)])}}closeAllSubMenus(){j(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?Az(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||lm(e)||bu(e,this.hot)||am(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=Io(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?or(this.hotMenu.getCell(u,0)):0;return a+(l.name===Rt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Oe(n)&&(n=n.call(this.hot),n===null||Bt(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),n&&X(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Me(this.hotMenu.rootElement,[tN(),Po(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!fs(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!fs(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&fs(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Je(Dc,Pn);function Xz(t,e){Zz(t,e),e.add(t)}function Zz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sg(t,e,r){return(e=Jz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jz(t){var e=Qz(t,"string");return typeof e=="symbol"?e:e+""}function Qz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Sa="contextMenu",eU=70,QR=Sa;fe.getSingleton().register("afterContextMenuDefaultOptions");fe.getSingleton().register("beforeContextMenuShow");fe.getSingleton().register("afterContextMenuShow");fe.getSingleton().register("afterContextMenuHide");fe.getSingleton().register("afterContextMenuExecute");var ha=new WeakSet;class Nc extends Ec{constructor(){super(...arguments),Xz(this,ha),Sg(this,"commandExecutor",new Cz(this.hot)),Sg(this,"itemsFactory",null),Sg(this,"menu",null)}static get PLUGIN_KEY(){return Sa}static get PLUGIN_PRIORITY(){return eU}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[xc,Hc,Rt,Tc,_c,Rt,Pc,Ic,Rt,Ac,Mc,Rt,Oc,Rt,en]}isEnabled(){return!!this.hot.getSettings()[Sa]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Sa];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Dc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>tu(ha,this,rU).call(this)),this.menu.addLocalHook("afterOpen",()=>tu(ha,this,nU).call(this)),this.menu.addLocalHook("afterClose",()=>tu(ha,this,iU).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>tu(ha,this,tU).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=TM(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:QR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(QR)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),He(n,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new Tz(this.hot,Nc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Sa],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),j(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function tU(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=TM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function rU(){this.hot.runHooks("beforeContextMenuShow",this)}function nU(){this.hot.runHooks("afterContextMenuShow",this)}function iU(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Nc.SEPARATOR={name:Rt};function oU(t){return{key:"copy",name(){return this.getTranslatedPhrase(Yp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function sU(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Kp,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function aU(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Gp,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function lU(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(qp,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function uU(t){return{key:"cut",name(){return this.getTranslatedPhrase(Xp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class cU{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class hU{constructor(){this.clipboardData=new cU}preventDefault(){}composedPath(){return[]}}function dU(t,e){xM(t,e),e.add(t)}function Ko(t,e,r){xM(t,e),e.set(t,r)}function xM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(as(t,e))}function Xo(t,e,r){return t.set(as(t,e),r),r}function as(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mi=new WeakMap,Rg=new WeakMap,da=new WeakMap,um=new WeakMap,cm=new WeakMap,fa=new WeakMap,ga=new WeakSet;class fU{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;dU(this,ga),Ko(this,mi,void 0),Ko(this,Rg,void 0),Ko(this,da,void 0),Ko(this,um,void 0),Ko(this,cm,void 0),Ko(this,fa,void 0),Xo(Rg,this,r),Xo(da,this,n),Xo(um,this,i),Xo(cm,this,o),Xo(fa,this,s)}setSelectedRange(e){Xo(mi,this,e)}getCellsRange(){if(Ft(Rg,this).call(this)===0||Ft(da,this).call(this)===0)return null;const{row:e,col:r}=Ft(mi,this).getTopStartCorner(),{row:n,col:i}=Ft(mi,this).getBottomEndCorner(),o=as(ga,this,gU).call(this,e,n),s=as(ga,this,Eg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Ft(da,this).call(this)===0||Ft(fa,this).call(this)===0)return null;const{col:e}=Ft(mi,this).getTopStartCorner(),{col:r}=Ft(mi,this).getBottomEndCorner(),n=as(ga,this,Eg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Ft(da,this).call(this)===0||Ft(fa,this).call(this)===0)return null;const{col:e}=Ft(mi,this).getTopStartCorner(),{col:r}=Ft(mi,this).getBottomEndCorner(),n=as(ga,this,Eg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Ft(fa,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Eg(t,e){return Math.min(e,Math.max(t+Ft(cm,this).call(this)-1,t))}function gU(t,e){return Math.min(e,Math.max(t+Ft(um,this).call(this)-1,t))}function HM(t){const e=[],r=[];return j(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Ge(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Ge(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function mU(t,e){AM(t,e),e.add(t)}function pi(t,e,r){AM(t,e),e.set(t,r)}function AM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ma(t,e,r){return(e=pU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pU(t){var e=wU(t,"string");return typeof e=="symbol"?e:e+""}function wU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function er(t,e){return t.get(Pt(t,e))}function Jr(t,e,r){return t.set(Pt(t,e),r),r}function Pt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}fe.getSingleton().register("afterCopyLimit");fe.getSingleton().register("modifyCopyableRange");fe.getSingleton().register("beforeCut");fe.getSingleton().register("afterCut");fe.getSingleton().register("beforePaste");fe.getSingleton().register("afterPaste");fe.getSingleton().register("beforeCopy");fe.getSingleton().register("afterCopy");const Tg="copyPaste",vU=80,yU=["fragmentSelection"],DM="application/ht-source-data-json-html",eE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var hm=new WeakMap,dm=new WeakMap,fm=new WeakMap,Zo=new WeakMap,ru=new WeakMap,nu=new WeakMap,Jo=new WeakMap,Uu=new WeakMap,Vt=new WeakSet;class bU extends Ec{constructor(){super(...arguments),mU(this,Vt),ma(this,"columnsLimit",1/0),ma(this,"rowsLimit",1/0),ma(this,"pasteMode","overwrite"),ma(this,"uiContainer",this.hot.rootDocument.body),pi(this,hm,!1),pi(this,dm,!1),pi(this,fm,!1),pi(this,Zo,"cells-only"),pi(this,ru,!1),pi(this,nu,!1),pi(this,Jo,new fU({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),pi(this,Uu,!1),ma(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Tg}static get SETTING_KEYS(){return[Tg,...yU]}static get PLUGIN_PRIORITY(){return vU}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Tg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Jr(hm,this,this.getSetting("copyColumnHeaders")),Jr(dm,this,this.getSetting("copyColumnGroupHeaders")),Jr(fm,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Pt(Vt,this,RU).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Vt,n,EU).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Pt(Vt,this,TU).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),hp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Vt,n,_U).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Vt,n,OU).call(n,...o)}),this.addHook("afterSelection",()=>Pt(Vt,this,MU).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Jr(Zo,this,e),Jr(ru,this,!0),Pt(Vt,this,tE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Jr(nu,this,!0),Pt(Vt,this,tE).call(this,"cut")}getRangedCopyableData(e){return $u(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:o}=HM(e);return j(i,s=>{const a=[];j(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=r?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);r&&nt(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new hU;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}er(Jo,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);er(Zo,this)==="column-headers-only"?r.set("headers",er(Jo,this).getMostBottomColumnHeadersRange()):(er(Zo,this)==="with-column-headers"?r.set("headers",er(Jo,this).getMostBottomColumnHeadersRange()):er(Zo,this)==="with-column-group-headers"&&r.set("headers",er(Jo,this).getAllColumnHeadersRange()),r.set("cells",er(Jo,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner();let h=a,d=l,g=a,w=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:C,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,C===!0)continue;g=T,d=l;const b=[],E=s.length%i;for(;b.length<o||d<=c;){var v;const{skipColumnOnPaste:y,visualCol:I}=this.hot.getCellMeta(T,d),x=this.hot.getSourceDataAtCell(T,d),P=b.length%o;if(d=I+1,y===!0)continue;w=I;const A=r==null||(v=r[E])===null||v===void 0?void 0:v[P];let F=e[E][P];if(r&&GD(A)){const W=JSON.parse(A);(nt(x)||x===null)&&(F=W)}b.push(F)}s.push(b)}return Jr(Uu,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,w]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!er(ru,this)||this.isEditorOpened()||co(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!gu(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Jr(ru,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Pt(Vt,this,CU).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Pt(Vt,this,rE).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),Jr(Zo,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!er(nu,this)||this.isEditorOpened()||co(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!gu(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Jr(nu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Pt(Vt,this,rE).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||co(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!gu(r,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(DM);h&&(s=yS(h,this.hot.rootDocument).data);const d=__(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=yS(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=f$(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function tE(t){if(hp()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&DN(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function CU(t){const{rows:e}=HM(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function SU(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&Y_(n)}}}function NM(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&q_(n)}}}function rE(t,e,r){const n=$u(e);if(t&&t.clipboardData){const i=vS(e),o=vS(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[eE,i].join("")),t.clipboardData.setData(DM,[eE,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function RU(t){t.items.push({name:"---------"},oU(this)),er(hm,this)&&t.items.push(lU(this)),er(dm,this)&&t.items.push(aU(this)),er(fm,this)&&t.items.push(sU(this)),t.items.push(uU(this))}function EU(t,e,r,n,i){er(Uu,this)&&(i.value=!0),Jr(Uu,this,!1)}function TU(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _U(){Pt(Vt,this,NM).call(this)}function OU(){Pt(Vt,this,SU).call(this)}function MU(){Pt(Vt,this,NM).call(this)}function IU(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function PU(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function xU(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function kM(t,e,r){const n=PU(t,IU(t,e,r));return xU(n)}function HU(t,e,r){return(e=AU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AU(t){var e=DU(t,"string");return typeof e=="symbol"?e:e+""}function DU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ur{constructor(e){HU(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function iu(t,e,r){return(e=NU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NU(t){var e=kU(t,"string");return typeof e=="symbol"?e:e+""}function kU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ww extends Ur{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),iu(this,"stateBefore",void 0),iu(this,"range",void 0),iu(this,"type",void 0),iu(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new ww({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){j(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){vi(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function nE(t,e,r){return(e=LU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LU(t){var e=FU(t,"string");return typeof e=="symbol"?e:e+""}function FU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vw extends Ur{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),nE(this,"columns",void 0),nE(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new vw({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),kM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function iE(t,e,r){return(e=VU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VU(t){var e=WU(t,"string");return typeof e=="symbol"?e:e+""}function WU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yw extends Ur{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),iE(this,"previousSortState",void 0),iE(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new yw({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function oE(t,e,r){return(e=$U(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $U(t){var e=BU(t,"string");return typeof e=="symbol"?e:e+""}function BU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bw extends Ur{constructor(e){let{index:r,amount:n}=e;super("insert_col"),oE(this,"index",void 0),oE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new bw({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function sE(t,e,r){return(e=jU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jU(t){var e=zU(t,"string");return typeof e=="symbol"?e:e+""}function zU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cw extends Ur{constructor(e){let{index:r,amount:n}=e;super("insert_row"),sE(this,"index",void 0),sE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Cw({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function ou(t,e,r){return(e=UU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UU(t){var e=YU(t,"string");return typeof e=="symbol"?e:e+""}function YU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sw extends Ur{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),ou(this,"changes",void 0),ou(this,"selected",void 0),ou(this,"countCols",void 0),ou(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new Sw({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=br(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,r){const n=br(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.redo")}}function aE(t,e,r){return(e=qU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qU(t){var e=GU(t,"string");return typeof e=="symbol"?e:e+""}function GU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rw extends Ur{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),aE(this,"conditionsStack",void 0),aE(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new Rw({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function KU(t,e,r){return(e=XU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XU(t){var e=ZU(t,"string");return typeof e=="symbol"?e:e+""}function ZU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ew extends Ur{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),KU(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new Ew({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function LM(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Ge(n,i,l=>{Ge(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Bn(t,e,r){return(e=JU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JU(t){var e=QU(t,"string");return typeof e=="symbol"?e:e+""}function QU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tw extends Ur{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Bn(this,"index",void 0),Bn(this,"indexes",void 0),Bn(this,"data",void 0),Bn(this,"amount",void 0),Bn(this,"headers",void 0),Bn(this,"columnPositions",void 0),Bn(this,"rowPositions",void 0),Bn(this,"fixedColumnsStart",void 0),Bn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return Ge(l.length-1,w=>{const v=[],C=l[w];Ge(u,c,T=>{v.push(C[e.toPhysicalColumn(T)])}),h.push(v)}),Ge(i-1,w=>{g.push(e.toPhysicalColumn(u+w))}),Array.isArray(e.getSettings().colHeaders)&&Ge(i-1,w=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+w)]||null)}),new Tw({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:LM(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(_n(this.data[c],o));const l=_n(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),j(e.getSourceDataArray(),(c,h)=>{j(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&j(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Qo(t,e,r){return(e=e2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e2(t){var e=t2(t,"string");return typeof e=="symbol"?e:e+""}function t2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _w extends Ur{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Qo(this,"index",void 0),Qo(this,"data",void 0),Qo(this,"fixedRowsBottom",void 0),Qo(this,"fixedRowsTop",void 0),Qo(this,"rowIndexesSequence",void 0),Qo(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=br(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new _w({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:LM(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function lE(t,e,r){return(e=r2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r2(t){var e=n2(t,"string");return typeof e=="symbol"?e:e+""}function n2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ow extends Ur{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),lE(this,"rows",void 0),lE(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new Ow({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),kM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function i2(t,e,r){return(e=o2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o2(t){var e=s2(t,"string");return typeof e=="symbol"?e:e+""}function s2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mw extends Ur{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),i2(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new Mw({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function a2(t,e){[ww,vw,yw,bw,Cw,Sw,Rw,Ew,Tw,_w,Ow,Mw].forEach(r=>r.startRegisteringEvents(t,e))}function l2(t,e){u2(t,e),e.add(t)}function u2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _g(t,e,r){return(e=c2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c2(t){var e=h2(t,"string");return typeof e=="symbol"?e:e+""}function h2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Og(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const uE="undoRedo",d2="undoRedo",f2=1e3;fe.getSingleton().register("beforeUndo");fe.getSingleton().register("afterUndo");fe.getSingleton().register("beforeRedo");fe.getSingleton().register("afterRedo");const cE=new Set;var su=new WeakSet;class g2 extends Ec{static get PLUGIN_KEY(){return d2}static get PLUGIN_PRIORITY(){return f2}static get SETTING_KEYS(){return!0}constructor(e){super(e),l2(this,su),_g(this,"doneActions",[]),_g(this,"undoneActions",[]),_g(this,"ignoreNewActions",!1),a2(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Og(su,e,m2).call(e,...n)}),this.registerShortcuts(),Og(su,this,p2).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Og(su,this,w2).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:uE};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uE)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=br(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=br(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function m2(t,e){e==="loadData"&&this.clear()}function p2(){const t=e=>{cE.has(e)||(Vr(ir`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),cE.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function w2(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class v2{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=b=>{if(b=this.postProcess(b,n),i){setTimeout(function(){i(b)},0);return}else return b},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let w=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&w+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let v=-1/0,C=1/0;const T=()=>{for(let b=Math.max(v,-u);b<=Math.min(C,u);b+=2){let E;const y=g[b-1],I=g[b+1];y&&(g[b-1]=void 0);let x=!1;if(I){const A=I.oldPos-b;x=I&&0<=A&&A<a}const P=y&&y.oldPos+1<l;if(!x&&!P){g[b]=void 0;continue}if(!P||x&&y.oldPos<I.oldPos?E=this.addToPath(I,!0,!1,0,n):E=this.addToPath(y,!1,!0,1,n),w=this.extractCommon(E,r,e,b,n),E.oldPos+1>=l&&w+1>=a)return s(this.buildValues(E.lastComponent,r,e))||!0;g[b]=E,E.oldPos+1>=l&&(C=Math.min(C,b-1)),w+1>=a&&(v=Math.max(v,b+1))}u++};if(i)(function b(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);T()||b()},0)})();else for(;u<=c&&Date.now()<=d;){const b=T();if(b)return b}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const w=n[u+g];return w.length>d.length?w:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class y2 extends v2{constructor(){super(...arguments),this.tokenize=C2}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const b2=new y2;function hE(t,e,r){return b2.diff(t,e,r)}function C2(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function S2(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;hE(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(hE(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(b){return b.map(function(E){return" "+E})}const d=[];let g=0,w=0,v=[],C=1,T=1;for(let b=0;b<c.length;b++){const E=c[b],y=E.lines||E2(E.value);if(E.lines=y,E.added||E.removed){if(!g){const I=c[b-1];g=C,w=T,I&&(v=l>0?h(I.lines.slice(-l)):[],g-=v.length,w-=v.length)}for(const I of y)v.push((E.added?"+":"-")+I);E.added?T+=y.length:C+=y.length}else{if(g)if(y.length<=l*2&&b<c.length-2)for(const I of h(y))v.push(I);else{const I=Math.min(y.length,l);for(const P of h(y.slice(0,I)))v.push(P);const x={oldStart:g,oldLines:C-g+I,newStart:w,newLines:T-w+I,lines:v};d.push(x),g=0,w=0,v=[]}C+=y.length,T+=y.length}}for(const b of d)for(let E=0;E<b.lines.length;E++)b.lines[E].endsWith(`
`)?b.lines[E]=b.lines[E].slice(0,-1):(b.lines.splice(E+1,0,"\\ No newline at end of file"),E++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function FM(t){if(Array.isArray(t))return t.map(FM).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function R2(t,e,r,n,i,o,s){{const a=S2(t,e,r,n,i,o);return a?FM(a):void 0}}function E2(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var gm;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(gm||(gm={}));const es=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,Ss=gm;class dE{data;constructor(e){this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class fE{data;constructor(e){this.data=e}run(){return[...new Set(this.data)]}}class mm{data1;data2;ignoreDuplicates;constructor(e,r,n=!0){n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)Ss.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return Ss.sort(e)}}class T2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)Ss.contains(this.data2,r[n])&&e.push(r[n]);return Ss.sort(e)}}class gE{data;constructor(e){this.data=Ss.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new mm(Ss.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class _2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){return R2("Data1","Data2",this.data1,this.data2)}}const O2=async(t,e)=>{ue(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(ue(e).trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var M2=(t,e)=>e("chkDuplicates"),I2=(t,e)=>e("rmDuplicates"),P2=(t,e)=>e("chkConsecutive"),x2=(t,e)=>e("compare"),H2=(t,e)=>e("diff"),A2=qI('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row svelte-1n46o8q"><div id="Table1" class="col-3 svelte-1n46o8q"></div> <div id="Table2" class="col-3 pl-0 svelte-1n46o8q"></div> <div class="col-2 p-0 pt-5 svelte-1n46o8q"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-1n46o8q"><label for="result">Result</label> <textarea class="form-control svelte-1n46o8q" id="result" readonly=""></textarea></div></div></div>',1);function D2(t,e){CE(e,!0);const r=[],n=[];El(Ha),El(Nc),El(bU),El(g2);const i=64;let o,s,a=rr(""),l=rr("Data1"),u=rr("comm"),c=rr(!0),h=rr(!0),d=rr(!1);const g=(M,B,Q)=>{let ie;try{ie=JSON.parse(localStorage.getItem(Q)||"")}catch{ie=void 0}const ye=new un(document.getElementById(M),{data:ie,colHeaders:[B],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return ye.addHook("beforePaste",()=>ye.updateSettings({readOnly:!0})),ye.addHook("afterPaste",ae=>{ye.updateSettings({readOnly:!1}),ye.deselectCell();for(let de=ae.length-1;de>=0;de--)if(ae[de][0]!==""){ye.loadData(ae.slice(0,de+1));return}ye.loadData([[""]])}),ye};tP(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const w=M=>M.getDataAtCol(0).filter(B=>B!==null),v=M=>{const B=w(o).filter(Ae=>Ae!=""),Q=w(s).filter(Ae=>Ae!="");switch(M){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(ue(l)=="Data1"&&!B.length){ze(a,`Data1 is empty.
Please enter something...`);return}else if(ue(l)=="Data2"&&!Q.length){ze(a,`Data2 is empty.
Please enter something...`);return}break;default:if(B.length){if(!Q.length){ze(a,`Data2 is empty.
Please enter something...`);return}}else{ze(a,`Data1 is empty.
Please enter something...`);return}}ze(d,!0);const ie=b(),ye=new Date().getTime();let ae="",de;switch(M){case"chkDuplicates":let Ae;ue(l)=="Data1"?Ae=new dE(B).run():Ae=new dE(Q).run(),Object.keys(Ae).length?ue(c)?ae=`Duplicate values found in ${ue(l)}.
`+es(Object.keys(Ae).length,Object.keys(Ae).map(me=>`${me} appears ${Ae[me]} times.`)):ae=Object.keys(Ae).join(`
`):ae=`${ue(l)} has no duplicate value.`;break;case"rmDuplicates":ue(l)=="Data1"?de=new fE(B).run():de=new fE(Q).run(),ae=de.join(`
`);break;case"chkConsecutive":ue(l)=="Data1"?de=new gE(B).run():de=new gE(Q).run(),de.length?de.length==1&&de[0]=="!Error!"?ae=`Error!
${ue(l)} contains non-numeric value. Please check!`:ae=`${ue(l)} is not consecutive.

The following numbers are missing:
${de.join(`
`)}`:ae=`${ue(l)} contains consecutive numbers.`;break;case"compare":if(ue(u)=="comm")de=new T2(B,Q).run(),de.length?ae=`Common values found between two data.
${es(de.length,de)}`:ae="Two data contain no common value.";else{const me=new mm(B,Q,ue(h)).run(),ke=new mm(Q,B,ue(h)).run();me.length+ke.length==0?ae="Data1 is same as Data2.":me.length?ke.length?ae=`Two files have inconsistent content.

Data1 is more than Data2
${es(me.length,me)}

Data2 is more than Data1
${es(ke.length,ke)}`:ae=`Data1 completely contains Data2.

Data1 is more than Data2
${es(me.length,me)}`:ae=`Data2 completely contains Data1.

Data2 is more than Data1
${es(ke.length,ke)}`}break;case"diff":ae=new _2(B.join(`
`)+`
`,Q.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(ie),M=="rmDuplicates"||M=="chkDuplicates"&&!ue(c)?ze(a,ae,!0):ze(a,ae+`

Duration for process: ${Date.now()-ye}ms`),ze(d,!1)},C=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),ze(a,""))},T=()=>{const M=o.getData();o.loadData(s.getData()),s.loadData(M)},b=()=>setInterval(()=>{const M=ue(a).split("Processing");let B=M.length>=2?M[1].length:0;B<3?B++:B-=3,ze(a,"Processing"+".".repeat(B))},200);var E=A2();UI("beforeunload",Hg,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var y=Ct(_I(E),2),I=Dt(y),x=Ct(Dt(I),4),P=Dt(x);P.__click=[M2,v];var A=Ct(P,2),F=Dt(A),W=Dt(F),q=Ct(A,2);q.__click=[I2,v];var L=Ct(q,2);L.__click=[P2,v];var se=Ct(L,2),K=Dt(se),te=Dt(K);te.value=te.__value="Data1";var dt=Ct(K,2),Re=Dt(dt);Re.value=Re.__value="Data2";var Ee=Ct(se,4);Ee.__click=[x2,v];var Ye=Ct(Ee,2),$e=Dt(Ye),Ie=Dt($e);Ie.value=Ie.__value="comm";var cn=Ct($e,2),Te=Dt(cn);Te.value=Te.__value="diff";var f=Ct(Ye,2),m=Dt(f),p=Dt(m),R=Ct(f,4);R.__click=[H2,v];var _=Ct(R,6);_.__click=[O2,a];var O=Ct(_,6);O.__click=T;var H=Dt(O);JI(H,()=>"Data1 <=> Data2");var k=Ct(O,6);k.__click=C;var U=Ct(x,2),$=Ct(Dt(U),2);LE(()=>{P.disabled=ue(d),q.disabled=ue(d),L.disabled=ue(d),Ee.disabled=ue(d),p.disabled=ue(u)=="comm",R.disabled=ue(d),_.disabled=ue(d),O.disabled=ue(d),k.disabled=ue(d)}),Zw(W,()=>ue(c),M=>ze(c,M)),fl(r,[],te,()=>ue(l),M=>ze(l,M)),fl(r,[],Re,()=>ue(l),M=>ze(l,M)),fl(n,[],Ie,()=>ue(u),M=>ze(u,M)),fl(n,[],Te,()=>ue(u),M=>ze(u,M)),Zw(p,()=>ue(h),M=>ze(h,M)),QI($,()=>ue(a),M=>ze(a,M)),GI(t,E),SE()}YI(["click"]);KI(D2,{target:document.body})});export default N2();
