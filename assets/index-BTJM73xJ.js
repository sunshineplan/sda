var wW=Object.defineProperty;var vW=(t,e,n)=>e in t?wW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var CW=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var bi=(t,e,n)=>vW(t,typeof e!="symbol"?e+"":e,n);var cde=CW((_de,Lm)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();const WM=!1;var GN=Array.isArray,yW=Array.prototype.indexOf,bW=Array.from,SW=Object.defineProperty,td=Object.getOwnPropertyDescriptor,RW=Object.prototype,EW=Array.prototype,_W=Object.getPrototypeOf,BM=Object.isExtensible;function TW(t){for(var e=0;e<t.length;e++)t[e]()}const ui=2,qN=4,$p=8,gE=16,Ea=32,yc=64,mE=128,Wr=256,$m=512,ci=1024,bs=2048,Bl=4096,Fm=8192,pE=16384,KN=32768,MW=65536,jM=1<<18,IW=1<<19,XN=1<<20,eR=1<<21,nd=Symbol("$state");function ZN(t){return t===this.v}function PW(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function OW(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function xW(t){throw new Error("https://svelte.dev/e/effect_orphan")}function AW(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function HW(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function NW(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function DW(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let kW=!1;const LW=2,Tr=Symbol();function $W(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Br=null;function UM(t){Br=t}function QN(t,e=!1,n){var r=Br={p:Br,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};vE(()=>{r.d=!0})}function JN(t){const e=Br;if(e!==null){const s=e.e;if(s!==null){var n=bt,r=et;e.e=null;try{for(var i=0;i<s.length;i++){var o=s[i];wa(o.effect),Io(o.reaction),lD(o.fn)}}finally{wa(n),Io(r)}}Br=e.p,e.m=!0}return{}}function eD(){return!0}function zh(t){if(typeof t!="object"||t===null||nd in t)return t;const e=_W(t);if(e!==RW&&e!==EW)return t;var n=new Map,r=GN(t),i=br(0),o=et,s=a=>{var l=et;Io(o);var u=a();return Io(l),u};return r&&n.set("length",br(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&HW();var c=n.get(l);return c===void 0?c=s(()=>{var h=br(u.value);return n.set(l,h),h}):Mt(c,u.value,!0),!0},deleteProperty(a,l){var u=n.get(l);if(u===void 0){if(l in a){const d=s(()=>br(Tr));n.set(l,d),Yw(i)}}else{if(r&&typeof l=="string"){var c=n.get("length"),h=Number(l);Number.isInteger(h)&&h<c.v&&Mt(c,h)}Mt(u,Tr),Yw(i)}return!0},get(a,l,u){var f;if(l===nd)return t;var c=n.get(l),h=l in a;if(c===void 0&&(!h||(f=td(a,l))!=null&&f.writable)&&(c=s(()=>{var g=zh(h?a[l]:Tr),C=br(g);return C}),n.set(l,c)),c!==void 0){var d=Le(c);return d===Tr?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=n.get(l);c&&(u.value=Le(c))}else if(u===void 0){var h=n.get(l),d=h==null?void 0:h.v;if(h!==void 0&&d!==Tr)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){var d;if(l===nd)return!0;var u=n.get(l),c=u!==void 0&&u.v!==Tr||Reflect.has(a,l);if(u!==void 0||bt!==null&&(!c||(d=td(a,l))!=null&&d.writable)){u===void 0&&(u=s(()=>{var f=c?zh(a[l]):Tr,g=br(f);return g}),n.set(l,u));var h=Le(u);if(h===Tr)return!1}return c},set(a,l,u,c){var _;var h=n.get(l),d=l in a;if(r&&l==="length")for(var f=u;f<h.v;f+=1){var g=n.get(f+"");g!==void 0?Mt(g,Tr):f in a&&(g=s(()=>br(Tr)),n.set(f+"",g))}if(h===void 0)(!d||(_=td(a,l))!=null&&_.writable)&&(h=s(()=>br(void 0)),Mt(h,zh(u)),n.set(l,h));else{d=h.v!==Tr;var C=s(()=>zh(u));Mt(h,C)}var y=Reflect.getOwnPropertyDescriptor(a,l);if(y!=null&&y.set&&y.set.call(c,u),!d){if(r&&typeof l=="string"){var E=n.get("length"),p=Number(l);Number.isInteger(p)&&p>=E.v&&Mt(E,p+1)}Yw(i)}return!0},ownKeys(a){Le(i);var l=Reflect.ownKeys(a).filter(h=>{var d=n.get(h);return d===void 0||d.v!==Tr});for(var[u,c]of n)c.v!==Tr&&!(u in a)&&l.push(u);return l},setPrototypeOf(){NW()}})}function Yw(t,e=1){Mt(t,t.v+e)}function zM(t){try{if(t!==null&&typeof t=="object"&&nd in t)return t[nd]}catch{}return t}function FW(t,e){return Object.is(zM(t),zM(e))}function VW(t){var e=ui|bs,n=et!==null&&(et.f&ui)!==0?et:null;return bt===null||n!==null&&(n.f&Wr)!==0?e|=Wr:bt.f|=XN,{ctx:Br,deps:null,effects:null,equals:ZN,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:n??bt}}function tD(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)Hl(e[n])}}function WW(t){for(var e=t.parent;e!==null;){if((e.f&ui)===0)return e;e=e.parent}return null}function nD(t){var e,n=bt;wa(WW(t));try{tD(t),e=CD(t)}finally{wa(n)}return e}function rD(t){var e=nD(t);if(t.equals(e)||(t.v=e,t.wv=wD()),!Sc){var n=(ia||(t.f&Wr)!==0)&&t.deps!==null?Bl:ci;Po(t,n)}}const Id=new Map;function BW(t,e){var n={f:0,v:t,reactions:null,equals:ZN,rv:0,wv:0};return n}function br(t,e){const n=BW(t);return iB(n),n}function Mt(t,e,n=!1){et!==null&&(!yo||(et.f&jM)!==0)&&eD()&&(et.f&(ui|gE|jM))!==0&&!(_n!=null&&_n[1].includes(t)&&_n[0]===et)&&DW();let r=n?zh(e):e;return jW(t,r)}function jW(t,e){if(!t.equals(e)){var n=t.v;Sc?Id.set(t,e):Id.set(t,n),t.v=e,(t.f&ui)!==0&&((t.f&bs)!==0&&nD(t),Po(t,(t.f&Wr)===0?ci:Bl)),t.wv=wD(),iD(t,bs),bt!==null&&(bt.f&ci)!==0&&(bt.f&(Ea|yc))===0&&(Qr===null?oB([t]):Qr.push(t))}return e}function iD(t,e){var n=t.reactions;if(n!==null)for(var r=n.length,i=0;i<r;i++){var o=n[i],s=o.f;(s&bs)===0&&(Po(o,e),(s&(ci|Wr))!==0&&((s&ui)!==0?iD(o,Bl):bE(o)))}}var tR,oD,sD,aD;function UW(){if(tR===void 0){tR=window,oD=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;sD=td(e,"firstChild").get,aD=td(e,"nextSibling").get,BM(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),BM(n)&&(n.__t=void 0)}}function zW(t=""){return document.createTextNode(t)}function Rl(t){return sD.call(t)}function wE(t){return aD.call(t)}function Un(t,e){return Rl(t)}function YW(t,e){{var n=Rl(t);return n instanceof Comment&&n.data===""?wE(n):n}}function Tn(t,e=1,n=!1){let r=t;for(;e--;)r=wE(r);return r}function GW(t){bt===null&&et===null&&xW(),et!==null&&(et.f&Wr)!==0&&bt===null&&OW(),Sc&&PW()}function qW(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function bc(t,e,n,r=!0){var i=bt,o={ctx:Br,deps:null,nodes_start:null,nodes_end:null,f:t|bs,first:null,fn:e,last:null,next:null,parent:i,prev:null,teardown:null,transitions:null,wv:0};if(n)try{yE(o),o.f|=KN}catch(l){throw Hl(o),l}else e!==null&&bE(o);var s=n&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(XN|mE))===0;if(!s&&r&&(i!==null&&qW(o,i),et!==null&&(et.f&ui)!==0)){var a=et;(a.effects??(a.effects=[])).push(o)}return o}function vE(t){const e=bc($p,null,!1);return Po(e,ci),e.teardown=t,e}function KW(t){GW();var e=bt!==null&&(bt.f&Ea)!==0&&Br!==null&&!Br.m;if(e){var n=Br;(n.e??(n.e=[])).push({fn:t,effect:bt,reaction:et})}else{var r=lD(t);return r}}function XW(t){const e=bc(yc,t,!0);return(n={})=>new Promise(r=>{n.outro?eB(e,()=>{Hl(e),r(void 0)}):(Hl(e),r(void 0))})}function lD(t){return bc(qN,t,!1)}function CE(t){return bc($p,t,!0)}function uD(t,e=[],n=VW){const r=e.map(n);return ZW(()=>t(...r.map(Le)))}function ZW(t,e=0){return bc($p|gE|e,t,!0)}function QW(t,e=!0){return bc($p|Ea,t,!0,e)}function cD(t){var e=t.teardown;if(e!==null){const n=Sc,r=et;YM(!0),Io(null);try{e.call(null)}finally{YM(n),Io(r)}}}function hD(t,e=!1){var n=t.first;for(t.first=t.last=null;n!==null;){var r=n.next;(n.f&yc)!==0?n.parent=null:Hl(n,e),n=r}}function JW(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&Ea)===0&&Hl(e),e=n}}function Hl(t,e=!0){var n=!1;(e||(t.f&IW)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(dD(t.nodes_start,t.nodes_end),n=!0),hD(t,e&&!n),jm(t,0),Po(t,pE);var r=t.transitions;if(r!==null)for(const o of r)o.stop();cD(t);var i=t.parent;i!==null&&i.first!==null&&fD(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=null}function dD(t,e){for(;t!==null;){var n=t===e?null:wE(t);t.remove(),t=n}}function fD(t){var e=t.parent,n=t.prev,r=t.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),e!==null&&(e.first===t&&(e.first=r),e.last===t&&(e.last=n))}function eB(t,e){var n=[];gD(t,n,!0),tB(n,()=>{Hl(t),e&&e()})}function tB(t,e){var n=t.length;if(n>0){var r=()=>--n||e();for(var i of t)i.out(r)}else e()}function gD(t,e,n){if((t.f&Fm)===0){if(t.f^=Fm,t.transitions!==null)for(const s of t.transitions)(s.is_global||n)&&e.push(s);for(var r=t.first;r!==null;){var i=r.next,o=(r.f&MW)!==0||(r.f&Ea)!==0;gD(r,e,o?n:!1),r=i}}}let Vm=[];function nB(){var t=Vm;Vm=[],TW(t)}function nR(t){Vm.length===0&&queueMicrotask(nB),Vm.push(t)}function rB(t){var e=bt;if((e.f&KN)===0){if((e.f&mE)===0)throw t;e.fn(t)}else mD(t,e)}function mD(t,e){for(;e!==null;){if((e.f&mE)!==0)try{e.fn(t);return}catch{}e=e.parent}throw t}let rR=!1,Wm=null,Ol=!1,Sc=!1;function YM(t){Sc=t}let fm=[],et=null,yo=!1;function Io(t){et=t}let bt=null;function wa(t){bt=t}let _n=null;function iB(t){et!==null&&et.f&eR&&(_n===null?_n=[et,[t]]:_n[1].push(t))}let Qn=null,Hr=0,Qr=null;function oB(t){Qr=t}let pD=1,Bm=0,ia=!1;function wD(){return++pD}function Fp(t){var h;var e=t.f;if((e&bs)!==0)return!0;if((e&Bl)!==0){var n=t.deps,r=(e&Wr)!==0;if(n!==null){var i,o,s=(e&$m)!==0,a=r&&bt!==null&&!ia,l=n.length;if(s||a){var u=t,c=u.parent;for(i=0;i<l;i++)o=n[i],(s||!((h=o==null?void 0:o.reactions)!=null&&h.includes(u)))&&(o.reactions??(o.reactions=[])).push(u);s&&(u.f^=$m),a&&c!==null&&(c.f&Wr)===0&&(u.f^=Wr)}for(i=0;i<l;i++)if(o=n[i],Fp(o)&&rD(o),o.wv>t.wv)return!0}(!r||bt!==null&&!ia)&&Po(t,ci)}return!1}function vD(t,e,n=!0){var r=t.reactions;if(r!==null)for(var i=0;i<r.length;i++){var o=r[i];_n!=null&&_n[1].includes(t)&&_n[0]===et||((o.f&ui)!==0?vD(o,e,!1):e===o&&(n?Po(o,bs):(o.f&ci)!==0&&Po(o,Bl),bE(o)))}}function CD(t){var f;var e=Qn,n=Hr,r=Qr,i=et,o=ia,s=_n,a=Br,l=yo,u=t.f;Qn=null,Hr=0,Qr=null,ia=(u&Wr)!==0&&(yo||!Ol||et===null),et=(u&(Ea|yc))===0?t:null,_n=null,UM(t.ctx),yo=!1,Bm++,t.f|=eR;try{var c=(0,t.fn)(),h=t.deps;if(Qn!==null){var d;if(jm(t,Hr),h!==null&&Hr>0)for(h.length=Hr+Qn.length,d=0;d<Qn.length;d++)h[Hr+d]=Qn[d];else t.deps=h=Qn;if(!ia||(u&ui)!==0&&t.reactions!==null)for(d=Hr;d<h.length;d++)((f=h[d]).reactions??(f.reactions=[])).push(t)}else h!==null&&Hr<h.length&&(jm(t,Hr),h.length=Hr);if(eD()&&Qr!==null&&!yo&&h!==null&&(t.f&(ui|Bl|bs))===0)for(d=0;d<Qr.length;d++)vD(Qr[d],t);return i!==null&&i!==t&&(Bm++,Qr!==null&&(r===null?r=Qr:r.push(...Qr))),c}catch(g){rB(g)}finally{Qn=e,Hr=n,Qr=r,et=i,ia=o,_n=s,UM(a),yo=l,t.f^=eR}}function sB(t,e){let n=e.reactions;if(n!==null){var r=yW.call(n,t);if(r!==-1){var i=n.length-1;i===0?n=e.reactions=null:(n[r]=n[i],n.pop())}}n===null&&(e.f&ui)!==0&&(Qn===null||!Qn.includes(e))&&(Po(e,Bl),(e.f&(Wr|$m))===0&&(e.f^=$m),tD(e),jm(e,0))}function jm(t,e){var n=t.deps;if(n!==null)for(var r=e;r<n.length;r++)sB(t,n[r])}function yE(t){var e=t.f;if((e&pE)===0){Po(t,ci);var n=bt,r=Ol;bt=t,Ol=!0;try{(e&gE)!==0?JW(t):hD(t),cD(t);var i=CD(t);t.teardown=typeof i=="function"?i:null,t.wv=pD;var o;WM&&kW&&(t.f&bs)!==0&&t.deps}finally{Ol=r,bt=n}}}function aB(){try{AW()}catch(t){if(Wm!==null)mD(t,Wm);else throw t}}function lB(){var t=Ol;try{var e=0;for(Ol=!0;fm.length>0;){e++>1e3&&aB();var n=fm,r=n.length;fm=[];for(var i=0;i<r;i++){var o=cB(n[i]);uB(o)}Id.clear()}}finally{rR=!1,Ol=t,Wm=null}}function uB(t){var e=t.length;if(e!==0)for(var n=0;n<e;n++){var r=t[n];(r.f&(pE|Fm))===0&&Fp(r)&&(yE(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?fD(r):r.fn=null))}}function bE(t){rR||(rR=!0,queueMicrotask(lB));for(var e=Wm=t;e.parent!==null;){e=e.parent;var n=e.f;if((n&(yc|Ea))!==0){if((n&ci)===0)return;e.f^=ci}}fm.push(e)}function cB(t){for(var e=[],n=t;n!==null;){var r=n.f,i=(r&(Ea|yc))!==0,o=i&&(r&ci)!==0;if(!o&&(r&Fm)===0){(r&qN)!==0?e.push(n):i?n.f^=ci:Fp(n)&&yE(n);var s=n.first;if(s!==null){n=s;continue}}var a=n.parent;for(n=n.next;n===null&&a!==null;)n=a.next,a=a.parent}return e}function Le(t){var e=t.f,n=(e&ui)!==0;if(et!==null&&!yo){if(!(_n!=null&&_n[1].includes(t))||_n[0]!==et){var r=et.deps;t.rv<Bm&&(t.rv=Bm,Qn===null&&r!==null&&r[Hr]===t?Hr++:Qn===null?Qn=[t]:(!ia||!Qn.includes(t))&&Qn.push(t))}}else if(n&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&Wr)===0&&(i.f^=Wr)}return n&&(i=t,Fp(i)&&rD(i)),Sc&&Id.has(t)?Id.get(t):t.v}function SE(t){var e=yo;try{return yo=!0,t()}finally{yo=e}}const hB=-7169;function Po(t,e){t.f=t.f&hB|e}const dB=["touchstart","touchmove"];function fB(t){return dB.includes(t)}let GM=!1;function gB(){GM||(GM=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function yD(t){var e=et,n=bt;Io(null),wa(null);try{return t()}finally{Io(e),wa(n)}}function RE(t,e,n,r=n){t.addEventListener(e,()=>yD(n));const i=t.__on_r;i?t.__on_r=()=>{i(),r(!0)}:t.__on_r=()=>r(!0),gB()}const bD=new Set,iR=new Set;function mB(t,e,n,r={}){function i(o){if(r.capture||Yh.call(e,o),!o.cancelBubble)return yD(()=>n==null?void 0:n.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?nR(()=>{e.addEventListener(t,i,r)}):e.addEventListener(t,i,r),i}function pB(t,e,n,r,i){var o={capture:r,passive:i},s=mB(t,e,n,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&vE(()=>{e.removeEventListener(t,s,o)})}function wB(t){for(var e=0;e<t.length;e++)bD.add(t[e]);for(var n of iR)n(t)}function Yh(t){var p;var e=this,n=e.ownerDocument,r=t.type,i=((p=t.composedPath)==null?void 0:p.call(t))||[],o=i[0]||t.target,s=0,a=t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){SW(t,"currentTarget",{configurable:!0,get(){return o||n}});var c=et,h=bt;Io(null),wa(null);try{for(var d,f=[];o!==null;){var g=o.assignedSlot||o.parentNode||o.host||null;try{var C=o["__"+r];if(C!=null&&(!o.disabled||t.target===o))if(GN(C)){var[y,...E]=C;y.apply(o,[t,...E])}else C.call(o,t)}catch(_){d?f.push(_):d=_}if(t.cancelBubble||g===e||g===null)break;o=g}if(d){for(let _ of f)queueMicrotask(()=>{throw _});throw d}}finally{t.__root=e,delete t.currentTarget,Io(c),wa(h)}}}function SD(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function RD(t,e){var n=bt;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function vB(t,e){var n=(e&LW)!==0,r,i=!t.startsWith("<!>");return()=>{r===void 0&&(r=SD(i?t:"<!>"+t));var o=n||oD?document.importNode(r,!0):r.cloneNode(!0);{var s=Rl(o),a=o.lastChild;RD(s,a)}return o}}function CB(t,e){t!==null&&t.before(e)}function yB(t,e){return bB(t,e)}const ru=new Map;function bB(t,{target:e,anchor:n,props:r={},events:i,context:o,intro:s=!0}){UW();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var f=h[d];if(!a.has(f)){a.add(f);var g=fB(f);e.addEventListener(f,Yh,{passive:g});var C=ru.get(f);C===void 0?(document.addEventListener(f,Yh,{passive:g}),ru.set(f,1)):ru.set(f,C+1)}}};l(bW(bD)),iR.add(l);var u=void 0,c=XW(()=>{var h=n??e.appendChild(zW());return QW(()=>{if(o){QN({});var d=Br;d.c=o}i&&(r.$$events=i),u=t(h,r)||{},o&&JN()}),()=>{var g;for(var d of a){e.removeEventListener(d,Yh);var f=ru.get(d);--f===0?(document.removeEventListener(d,Yh),ru.delete(d)):ru.set(d,f)}iR.delete(l),h!==n&&((g=h.parentNode)==null||g.removeChild(h))}});return SB.set(u,c),u}let SB=new WeakMap;function RB(t,e,n=!1,r=!1,i=!1){var o=t,s="";uD(()=>{var a=bt;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(dD(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=SD(l);if((n||r)&&(u=Rl(u)),RD(Rl(u),u.lastChild),n||r)for(;Rl(u);)o.before(Rl(u));else o.before(u)}})}function EB(t,e,n=e){RE(t,"input",r=>{var i=r?t.defaultValue:t.value;if(i=qw(t)?Kw(i):i,n(i),i!==(i=e())){var o=t.selectionStart,s=t.selectionEnd;t.value=i??"",s!==null&&(t.selectionStart=o,t.selectionEnd=Math.min(s,t.value.length))}}),SE(e)==null&&t.value&&n(qw(t)?Kw(t.value):t.value),CE(()=>{var r=e();qw(t)&&r===Kw(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}const Gw=new Set;function Of(t,e,n,r,i=r){var o=n.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??(s[a]=[]);s.push(n),RE(n,"change",()=>{var l=n.__value;o&&(l=_B(s,l,n.checked)),i(l)},()=>i(o?[]:null)),CE(()=>{var l=r();o?(l=l||[],n.checked=l.includes(n.__value)):n.checked=FW(n.__value,l)}),vE(()=>{var l=s.indexOf(n);l!==-1&&s.splice(l,1)}),Gw.has(s)||(Gw.add(s),nR(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Gw.delete(s)})),nR(()=>{})}function qM(t,e,n=e){RE(t,"change",r=>{var i=r?t.defaultChecked:t.checked;n(i)}),SE(e)==null&&n(t.checked),CE(()=>{var r=e();t.checked=!!r})}function _B(t,e,n){for(var r=new Set,i=0;i<t.length;i+=1)t[i].checked&&r.add(t[i].__value);return n||r.delete(e),Array.from(r)}function qw(t){var e=t.type;return e==="number"||e==="range"}function Kw(t){return t===""?null:+t}function TB(t){Br===null&&$W(),KW(()=>{const e=SE(t);if(typeof e=="function")return e})}const MB="5";var YN;typeof window<"u"&&((YN=window.__svelte??(window.__svelte={})).v??(YN.v=new Set)).add(MB);var KM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},XM={},Wc,ZM;function nn(){if(ZM)return Wc;ZM=1;var t=function(e){return e&&e.Math===Math&&e};return Wc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof KM=="object"&&KM)||t(typeof Wc=="object"&&Wc)||function(){return this}()||Function("return this")(),Wc}var Xw={},Zw,QM;function cn(){return QM||(QM=1,Zw=function(t){try{return!!t()}catch{return!0}}),Zw}var Qw,JM;function fi(){if(JM)return Qw;JM=1;var t=cn();return Qw=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Qw}var Jw,eI;function Vp(){if(eI)return Jw;eI=1;var t=cn();return Jw=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Jw}var ev,tI;function hn(){if(tI)return ev;tI=1;var t=Vp(),e=Function.prototype.call;return ev=t?e.bind(e):function(){return e.apply(e,arguments)},ev}var tv={},nI;function IB(){if(nI)return tv;nI=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return tv.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,tv}var nv,rI;function Wp(){return rI||(rI=1,nv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),nv}var rv,iI;function rn(){if(iI)return rv;iI=1;var t=Vp(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return rv=t?r:function(i){return function(){return n.apply(i,arguments)}},rv}var iv,oI;function jl(){if(oI)return iv;oI=1;var t=rn(),e=t({}.toString),n=t("".slice);return iv=function(r){return n(e(r),8,-1)},iv}var ov,sI;function PB(){if(sI)return ov;sI=1;var t=rn(),e=cn(),n=jl(),r=Object,i=t("".split);return ov=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,ov}var sv,aI;function EE(){return aI||(aI=1,sv=function(t){return t==null}),sv}var av,lI;function Qd(){if(lI)return av;lI=1;var t=EE(),e=TypeError;return av=function(n){if(t(n))throw new e("Can't call method on "+n);return n},av}var lv,uI;function Jd(){if(uI)return lv;uI=1;var t=PB(),e=Qd();return lv=function(n){return t(e(n))},lv}var uv,cI;function dn(){if(cI)return uv;cI=1;var t=typeof document=="object"&&document.all;return uv=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},uv}var cv,hI;function gi(){if(hI)return cv;hI=1;var t=dn();return cv=function(e){return typeof e=="object"?e!==null:t(e)},cv}var hv,dI;function Rc(){if(dI)return hv;dI=1;var t=nn(),e=dn(),n=function(r){return e(r)?r:void 0};return hv=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},hv}var dv,fI;function ef(){if(fI)return dv;fI=1;var t=rn();return dv=t({}.isPrototypeOf),dv}var fv,gI;function Bp(){if(gI)return fv;gI=1;var t=nn(),e=t.navigator,n=e&&e.userAgent;return fv=n?String(n):"",fv}var gv,mI;function OB(){if(mI)return gv;mI=1;var t=nn(),e=Bp(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),gv=a,gv}var mv,pI;function _E(){if(pI)return mv;pI=1;var t=OB(),e=cn(),n=nn(),r=n.String;return mv=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),mv}var pv,wI;function ED(){if(wI)return pv;wI=1;var t=_E();return pv=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",pv}var wv,vI;function TE(){if(vI)return wv;vI=1;var t=Rc(),e=dn(),n=ef(),r=ED(),i=Object;return wv=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},wv}var vv,CI;function jp(){if(CI)return vv;CI=1;var t=String;return vv=function(e){try{return t(e)}catch{return"Object"}},vv}var Cv,yI;function Er(){if(yI)return Cv;yI=1;var t=dn(),e=jp(),n=TypeError;return Cv=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},Cv}var yv,bI;function tf(){if(bI)return yv;bI=1;var t=Er(),e=EE();return yv=function(n,r){var i=n[r];return e(i)?void 0:t(i)},yv}var bv,SI;function xB(){if(SI)return bv;SI=1;var t=hn(),e=dn(),n=gi(),r=TypeError;return bv=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},bv}var Sv={exports:{}},Rv,RI;function _a(){return RI||(RI=1,Rv=!1),Rv}var Ev,EI;function ME(){if(EI)return Ev;EI=1;var t=nn(),e=Object.defineProperty;return Ev=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},Ev}var _I;function IE(){if(_I)return Sv.exports;_I=1;var t=_a(),e=nn(),n=ME(),r="__core-js_shared__",i=Sv.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Sv.exports}var _v,TI;function _D(){if(TI)return _v;TI=1;var t=IE();return _v=function(e,n){return t[e]||(t[e]=n||{})},_v}var Tv,MI;function Ec(){if(MI)return Tv;MI=1;var t=Qd(),e=Object;return Tv=function(n){return e(t(n))},Tv}var Mv,II;function mi(){if(II)return Mv;II=1;var t=rn(),e=Ec(),n=t({}.hasOwnProperty);return Mv=Object.hasOwn||function(i,o){return n(e(i),o)},Mv}var Iv,PI;function TD(){if(PI)return Iv;PI=1;var t=rn(),e=0,n=Math.random(),r=t(1.1.toString);return Iv=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},Iv}var Pv,OI;function zi(){if(OI)return Pv;OI=1;var t=nn(),e=_D(),n=mi(),r=TD(),i=_E(),o=ED(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return Pv=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},Pv}var Ov,xI;function AB(){if(xI)return Ov;xI=1;var t=hn(),e=gi(),n=TE(),r=tf(),i=xB(),o=zi(),s=TypeError,a=o("toPrimitive");return Ov=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Ov}var xv,AI;function MD(){if(AI)return xv;AI=1;var t=AB(),e=TE();return xv=function(n){var r=t(n,"string");return e(r)?r:r+""},xv}var Av,HI;function PE(){if(HI)return Av;HI=1;var t=nn(),e=gi(),n=t.document,r=e(n)&&e(n.createElement);return Av=function(i){return r?n.createElement(i):{}},Av}var Hv,NI;function ID(){if(NI)return Hv;NI=1;var t=fi(),e=cn(),n=PE();return Hv=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),Hv}var DI;function PD(){if(DI)return Xw;DI=1;var t=fi(),e=hn(),n=IB(),r=Wp(),i=Jd(),o=MD(),s=mi(),a=ID(),l=Object.getOwnPropertyDescriptor;return Xw.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},Xw}var Nv={},Dv,kI;function OD(){if(kI)return Dv;kI=1;var t=fi(),e=cn();return Dv=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Dv}var kv,LI;function fn(){if(LI)return kv;LI=1;var t=gi(),e=String,n=TypeError;return kv=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},kv}var $I;function Ta(){if($I)return Nv;$I=1;var t=fi(),e=ID(),n=OD(),r=fn(),i=MD(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Nv.f=t?n?function(d,f,g){if(r(d),f=i(f),r(g),typeof d=="function"&&f==="prototype"&&"value"in g&&c in g&&!g[c]){var C=a(d,f);C&&C[c]&&(d[f]=g.value,g={configurable:u in g?g[u]:C[u],enumerable:l in g?g[l]:C[l],writable:!1})}return s(d,f,g)}:s:function(d,f,g){if(r(d),f=i(f),r(g),e)try{return s(d,f,g)}catch{}if("get"in g||"set"in g)throw new o("Accessors not supported");return"value"in g&&(d[f]=g.value),d},Nv}var Lv,FI;function _c(){if(FI)return Lv;FI=1;var t=fi(),e=Ta(),n=Wp();return Lv=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Lv}var $v={exports:{}},Fv,VI;function HB(){if(VI)return Fv;VI=1;var t=fi(),e=mi(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Fv={EXISTS:i,PROPER:o,CONFIGURABLE:s},Fv}var Vv,WI;function NB(){if(WI)return Vv;WI=1;var t=rn(),e=dn(),n=IE(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),Vv=n.inspectSource,Vv}var Wv,BI;function DB(){if(BI)return Wv;BI=1;var t=nn(),e=dn(),n=t.WeakMap;return Wv=e(n)&&/native code/.test(String(n)),Wv}var Bv,jI;function OE(){if(jI)return Bv;jI=1;var t=_D(),e=TD(),n=t("keys");return Bv=function(r){return n[r]||(n[r]=e(r))},Bv}var jv,UI;function xE(){return UI||(UI=1,jv={}),jv}var Uv,zI;function xD(){if(zI)return Uv;zI=1;var t=DB(),e=nn(),n=gi(),r=_c(),i=mi(),o=IE(),s=OE(),a=xE(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,g=function(p){return f(p)?d(p):h(p,{})},C=function(p){return function(_){var P;if(!n(_)||(P=d(_)).type!==p)throw new u("Incompatible receiver, "+p+" required");return P}};if(t||o.state){var y=o.state||(o.state=new c);y.get=y.get,y.has=y.has,y.set=y.set,h=function(p,_){if(y.has(p))throw new u(l);return _.facade=p,y.set(p,_),_},d=function(p){return y.get(p)||{}},f=function(p){return y.has(p)}}else{var E=s("state");a[E]=!0,h=function(p,_){if(i(p,E))throw new u(l);return _.facade=p,r(p,E,_),_},d=function(p){return i(p,E)?p[E]:{}},f=function(p){return i(p,E)}}return Uv={set:h,get:d,has:f,enforce:g,getterFor:C},Uv}var YI;function AD(){if(YI)return $v.exports;YI=1;var t=rn(),e=cn(),n=dn(),r=mi(),i=fi(),o=HB().CONFIGURABLE,s=NB(),a=xD(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),C=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),y=String(String).split("String"),E=$v.exports=function(p,_,P){d(c(_),0,7)==="Symbol("&&(_="["+f(c(_),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),P&&P.getter&&(_="get "+_),P&&P.setter&&(_="set "+_),(!r(p,"name")||o&&p.name!==_)&&(i?h(p,"name",{value:_,configurable:!0}):p.name=_),C&&P&&r(P,"arity")&&p.length!==P.arity&&h(p,"length",{value:P.arity});try{P&&r(P,"constructor")&&P.constructor?i&&h(p,"prototype",{writable:!1}):p.prototype&&(p.prototype=void 0)}catch{}var D=l(p);return r(D,"source")||(D.source=g(y,typeof _=="string"?_:"")),p};return Function.prototype.toString=E(function(){return n(this)&&u(this).source||s(this)},"toString"),$v.exports}var zv,GI;function AE(){if(GI)return zv;GI=1;var t=dn(),e=Ta(),n=AD(),r=ME();return zv=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},zv}var Yv={},Gv,qI;function kB(){if(qI)return Gv;qI=1;var t=Math.ceil,e=Math.floor;return Gv=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Gv}var qv,KI;function nf(){if(KI)return qv;KI=1;var t=kB();return qv=function(e){var n=+e;return n!==n||n===0?0:t(n)},qv}var Kv,XI;function LB(){if(XI)return Kv;XI=1;var t=nf(),e=Math.max,n=Math.min;return Kv=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},Kv}var Xv,ZI;function $B(){if(ZI)return Xv;ZI=1;var t=nf(),e=Math.min;return Xv=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},Xv}var Zv,QI;function Tc(){if(QI)return Zv;QI=1;var t=$B();return Zv=function(e){return t(e.length)},Zv}var Qv,JI;function FB(){if(JI)return Qv;JI=1;var t=Jd(),e=LB(),n=Tc(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return Qv={includes:r(!0),indexOf:r(!1)},Qv}var Jv,eP;function HD(){if(eP)return Jv;eP=1;var t=rn(),e=mi(),n=Jd(),r=FB().indexOf,i=xE(),o=t([].push);return Jv=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},Jv}var eC,tP;function HE(){return tP||(tP=1,eC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),eC}var nP;function VB(){if(nP)return Yv;nP=1;var t=HD(),e=HE(),n=e.concat("length","prototype");return Yv.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Yv}var tC={},rP;function WB(){return rP||(rP=1,tC.f=Object.getOwnPropertySymbols),tC}var nC,iP;function BB(){if(iP)return nC;iP=1;var t=Rc(),e=rn(),n=VB(),r=WB(),i=fn(),o=e([].concat);return nC=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},nC}var rC,oP;function ND(){if(oP)return rC;oP=1;var t=mi(),e=BB(),n=PD(),r=Ta();return rC=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},rC}var iC,sP;function jB(){if(sP)return iC;sP=1;var t=cn(),e=dn(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return iC=r,iC}var oC,aP;function pt(){if(aP)return oC;aP=1;var t=nn(),e=PD().f,n=_c(),r=AE(),i=ME(),o=ND(),s=jB();return oC=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,g,C,y,E;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(g in l){if(y=l[g],a.dontCallGetSet?(E=e(f,g),C=E&&E.value):C=f[g],d=s(c?g:u+(h?".":"#")+g,a.forced),!d&&C!==void 0){if(typeof y==typeof C)continue;o(y,C)}(a.sham||C&&C.sham)&&n(y,"sham",!0),r(f,g,y,a)}},oC}var sC,lP;function rf(){if(lP)return sC;lP=1;var t=Vp(),e=Function.prototype,n=e.apply,r=e.call;return sC=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),sC}var aC,uP;function DD(){if(uP)return aC;uP=1;var t=rn(),e=Er();return aC=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},aC}var lC,cP;function UB(){if(cP)return lC;cP=1;var t=gi();return lC=function(e){return t(e)||e===null},lC}var uC,hP;function zB(){if(hP)return uC;hP=1;var t=UB(),e=String,n=TypeError;return uC=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},uC}var cC,dP;function kD(){if(dP)return cC;dP=1;var t=DD(),e=gi(),n=Qd(),r=zB();return cC=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),cC}var hC,fP;function YB(){if(fP)return hC;fP=1;var t=Ta().f;return hC=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},hC}var dC,gP;function GB(){if(gP)return dC;gP=1;var t=dn(),e=gi(),n=kD();return dC=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},dC}var fC,mP;function qB(){if(mP)return fC;mP=1;var t=zi(),e=t("toStringTag"),n={};return n[e]="z",fC=String(n)==="[object z]",fC}var gC,pP;function LD(){if(pP)return gC;pP=1;var t=qB(),e=dn(),n=jl(),r=zi(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return gC=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},gC}var mC,wP;function Up(){if(wP)return mC;wP=1;var t=LD(),e=String;return mC=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},mC}var pC,vP;function KB(){if(vP)return pC;vP=1;var t=Up();return pC=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},pC}var wC,CP;function XB(){if(CP)return wC;CP=1;var t=gi(),e=_c();return wC=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},wC}var vC,yP;function ZB(){if(yP)return vC;yP=1;var t=rn(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return vC=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},vC}var CC,bP;function QB(){if(bP)return CC;bP=1;var t=cn(),e=Wp();return CC=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),CC}var yC,SP;function JB(){if(SP)return yC;SP=1;var t=_c(),e=ZB(),n=QB(),r=Error.captureStackTrace;return yC=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},yC}var bC,RP;function ej(){if(RP)return bC;RP=1;var t=Rc(),e=mi(),n=_c(),r=ef(),i=kD(),o=ND(),s=YB(),a=GB(),l=KB(),u=XB(),c=JB(),h=fi(),d=_a();return bC=function(f,g,C,y){var E="stackTraceLimit",p=y?2:1,_=f.split("."),P=_[_.length-1],D=t.apply(null,_);if(D){var M=D.prototype;if(!d&&e(M,"cause")&&delete M.cause,!C)return D;var x=t("Error"),Y=g(function(U,B){var Z=l(y?B:U,void 0),Q=y?new D(U):new D;return Z!==void 0&&n(Q,"message",Z),c(Q,Y,Q.stack,2),this&&r(M,this)&&a(Q,this,Y),arguments.length>p&&u(Q,arguments[p]),Q});if(Y.prototype=M,P!=="Error"?i?i(Y,x):o(Y,x,{name:!0}):h&&E in D&&(s(Y,D,E),s(Y,D,"prepareStackTrace")),o(Y,D),!d)try{M.name!==P&&n(M,"name",P),M.constructor=Y}catch{}return Y}},bC}var EP;function tj(){if(EP)return XM;EP=1;var t=pt(),e=nn(),n=rf(),r=ej(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),XM}tj();var _P={},SC,TP;function $D(){if(TP)return SC;TP=1;var t=jl();return SC=Array.isArray||function(n){return t(n)==="Array"},SC}var RC,MP;function FD(){if(MP)return RC;MP=1;var t=fi(),e=$D(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return RC=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},RC}var EC,IP;function VD(){if(IP)return EC;IP=1;var t=TypeError,e=9007199254740991;return EC=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},EC}var PP;function nj(){if(PP)return _P;PP=1;var t=pt(),e=Ec(),n=Tc(),r=FD(),i=VD(),o=cn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return r(h,d),d}}),_P}nj();var OP={},_C,xP;function rj(){if(xP)return _C;xP=1;var t=jl(),e=rn();return _C=function(n){if(t(n)==="Function")return e(n)},_C}var TC,AP;function WD(){if(AP)return TC;AP=1;var t=rj(),e=Er(),n=Vp(),r=t(t.bind);return TC=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},TC}var MC,HP;function BD(){return HP||(HP=1,MC={}),MC}var IC,NP;function ij(){if(NP)return IC;NP=1;var t=zi(),e=BD(),n=t("iterator"),r=Array.prototype;return IC=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},IC}var PC,DP;function NE(){if(DP)return PC;DP=1;var t=LD(),e=tf(),n=EE(),r=BD(),i=zi(),o=i("iterator");return PC=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},PC}var OC,kP;function oj(){if(kP)return OC;kP=1;var t=hn(),e=Er(),n=fn(),r=jp(),i=NE(),o=TypeError;return OC=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},OC}var xC,LP;function _r(){if(LP)return xC;LP=1;var t=hn(),e=fn(),n=tf();return xC=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},xC}var AC,$P;function Mc(){if($P)return AC;$P=1;var t=WD(),e=hn(),n=fn(),r=jp(),i=ij(),o=Tc(),s=ef(),a=oj(),l=NE(),u=_r(),c=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return AC=function(f,g,C){var y=C&&C.that,E=!!(C&&C.AS_ENTRIES),p=!!(C&&C.IS_RECORD),_=!!(C&&C.IS_ITERATOR),P=!!(C&&C.INTERRUPTED),D=t(g,y),M,x,Y,U,B,Z,Q,se=function(le){return M&&u(M,"normal"),new h(!0,le)},te=function(le){return E?(n(le),P?D(le[0],le[1],se):D(le[0],le[1])):P?D(le,se):D(le)};if(p)M=f.iterator;else if(_)M=f;else{if(x=l(f),!x)throw new c(r(f)+" is not iterable");if(i(x)){for(Y=0,U=o(f);U>Y;Y++)if(B=te(f[Y]),B&&s(d,B))return B;return new h(!1)}M=a(f,x)}for(Z=p?f.next:M.next;!(Q=e(Z,M)).done;){try{B=te(Q.value)}catch(le){u(M,"throw",le)}if(typeof B=="object"&&B&&s(d,B))return B}return new h(!1)},AC}var HC,FP;function jD(){if(FP)return HC;FP=1;var t=fi(),e=Ta(),n=Wp();return HC=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},HC}var VP;function sj(){if(VP)return OP;VP=1;var t=pt(),e=Mc(),n=jD();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),OP}sj();var WP={},NC,BP;function Ao(){if(BP)return NC;BP=1;var t=rn(),e=Set.prototype;return NC={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},NC}var DC,jP;function Ul(){if(jP)return DC;jP=1;var t=Ao().has;return DC=function(e){return t(e),e},DC}var kC,UP;function zl(){if(UP)return kC;UP=1;var t=hn();return kC=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},kC}var LC,zP;function of(){if(zP)return LC;zP=1;var t=rn(),e=zl(),n=Ao(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return LC=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},LC}var $C,YP;function DE(){if(YP)return $C;YP=1;var t=Ao(),e=of(),n=t.Set,r=t.add;return $C=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},$C}var FC,GP;function sf(){if(GP)return FC;GP=1;var t=DD(),e=Ao();return FC=t(e.proto,"size","get")||function(n){return n.size},FC}var VC,qP;function Ho(){return qP||(qP=1,VC=function(t){return{iterator:t,next:t.next,done:!1}}),VC}var WC,KP;function Yl(){if(KP)return WC;KP=1;var t=Er(),e=fn(),n=hn(),r=nf(),i=Ho(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},WC=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},WC}var BC,XP;function aj(){if(XP)return BC;XP=1;var t=Ul(),e=Ao(),n=DE(),r=sf(),i=Yl(),o=of(),s=zl(),a=e.has,l=e.remove;return BC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(g){d.includes(g)&&l(f,g)}):s(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},BC}var jC,ZP;function Gl(){if(ZP)return jC;ZP=1;var t=Rc(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return jC=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},jC}var QP;function lj(){if(QP)return WP;QP=1;var t=pt(),e=aj(),n=cn(),r=Gl(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),WP}lj();var JP={},UC,eO;function uj(){if(eO)return UC;eO=1;var t=Ul(),e=Ao(),n=sf(),r=Yl(),i=of(),o=zl(),s=e.Set,a=e.add,l=e.has;return UC=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(g){l(h,g)&&a(f,g)}):i(h,function(g){d.includes(g)&&a(f,g)}),f},UC}var tO;function cj(){if(tO)return JP;tO=1;var t=pt(),e=cn(),n=uj(),r=Gl(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),JP}cj();var nO={},zC,rO;function hj(){if(rO)return zC;rO=1;var t=Ul(),e=Ao().has,n=sf(),r=Yl(),i=of(),o=zl(),s=_r();return zC=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},zC}var iO;function dj(){if(iO)return nO;iO=1;var t=pt(),e=hj(),n=Gl(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),nO}dj();var oO={},YC,sO;function fj(){if(sO)return YC;sO=1;var t=Ul(),e=sf(),n=of(),r=Yl();return YC=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},YC}var aO;function gj(){if(aO)return oO;aO=1;var t=pt(),e=fj(),n=Gl(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),oO}gj();var lO={},GC,uO;function mj(){if(uO)return GC;uO=1;var t=Ul(),e=Ao().has,n=sf(),r=Yl(),i=zl(),o=_r();return GC=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},GC}var cO;function pj(){if(cO)return lO;cO=1;var t=pt(),e=mj(),n=Gl(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),lO}pj();var hO={},qC,dO;function wj(){if(dO)return qC;dO=1;var t=Ul(),e=Ao(),n=DE(),r=Yl(),i=zl(),o=e.add,s=e.has,a=e.remove;return qC=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},qC}var KC,fO;function UD(){return fO||(fO=1,KC=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size!==1||r.values().next().value!==4}catch{return!1}}),KC}var gO;function vj(){if(gO)return hO;gO=1;var t=pt(),e=wj(),n=UD(),r=Gl(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),hO}vj();var mO={},XC,pO;function Cj(){if(pO)return XC;pO=1;var t=Ul(),e=Ao().add,n=DE(),r=Yl(),i=zl();return XC=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},XC}var wO;function yj(){if(wO)return mO;wO=1;var t=pt(),e=Cj(),n=UD(),r=Gl(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),mO}yj();var vO={},CO={},ZC,yO;function bj(){if(yO)return ZC;yO=1;var t=ef(),e=TypeError;return ZC=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},ZC}var QC,bO;function Sj(){if(bO)return QC;bO=1;var t=cn();return QC=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),QC}var JC,SO;function zD(){if(SO)return JC;SO=1;var t=mi(),e=dn(),n=Ec(),r=OE(),i=Sj(),o=r("IE_PROTO"),s=Object,a=s.prototype;return JC=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},JC}var ey,RO;function Rj(){if(RO)return ey;RO=1;var t=AD(),e=Ta();return ey=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},ey}var ty={},ny,EO;function Ej(){if(EO)return ny;EO=1;var t=HD(),e=HE();return ny=Object.keys||function(r){return t(r,e)},ny}var _O;function _j(){if(_O)return ty;_O=1;var t=fi(),e=OD(),n=Ta(),r=fn(),i=Jd(),o=Ej();return ty.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},ty}var ry,TO;function YD(){if(TO)return ry;TO=1;var t=Rc();return ry=t("document","documentElement"),ry}var iy,MO;function kE(){if(MO)return iy;MO=1;var t=fn(),e=_j(),n=HE(),r=xE(),i=YD(),o=PE(),s=OE(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(p){return l+c+a+p+l+"/"+c+a},g=function(p){p.write(f("")),p.close();var _=p.parentWindow.Object;return p=null,_},C=function(){var p=o("iframe"),_="java"+c+":",P;return p.style.display="none",i.appendChild(p),p.src=String(_),P=p.contentWindow.document,P.open(),P.write(f("document.F=Object")),P.close(),P.F},y,E=function(){try{y=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&y?g(y):C():g(y);for(var p=n.length;p--;)delete E[u][n[p]];return E()};return r[h]=!0,iy=Object.create||function(_,P){var D;return _!==null?(d[u]=t(_),D=new d,d[u]=null,D[h]=_):D=E(),P===void 0?D:e.f(D,P)},iy}var oy,IO;function GD(){if(IO)return oy;IO=1;var t=cn(),e=dn(),n=gi(),r=kE(),i=zD(),o=AE(),s=zi(),a=_a(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var g={};return c[l].call(g)!==g});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),oy={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},oy}var PO;function Tj(){if(PO)return CO;PO=1;var t=pt(),e=nn(),n=bj(),r=fn(),i=dn(),o=zD(),s=Rj(),a=jD(),l=cn(),u=mi(),c=zi(),h=GD().IteratorPrototype,d=fi(),f=_a(),g="constructor",C="Iterator",y=c("toStringTag"),E=TypeError,p=e[C],_=f||!i(p)||p.prototype!==h||!l(function(){p({})}),P=function(){if(n(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},D=function(M,x){d?s(h,M,{configurable:!0,get:function(){return x},set:function(Y){if(r(this),this===h)throw new E("You can't redefine this property");u(this,M)?this[M]=Y:a(this,M,Y)}}):h[M]=x};return u(h,y)||D(y,C),(_||!u(h,g)||h[g]===Object)&&D(g,P),P.prototype=h,t({global:!0,constructor:!0,forced:_},{Iterator:P}),CO}var OO;function Mj(){return OO||(OO=1,Tj()),vO}Mj();var xO={},AO={},sy,HO;function Ij(){if(HO)return sy;HO=1;var t=AE();return sy=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},sy}var ay,NO;function Pj(){return NO||(NO=1,ay=function(t,e){return{value:t,done:e}}),ay}var ly,DO;function Oj(){if(DO)return ly;DO=1;var t=_r();return ly=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},ly}var uy,kO;function LE(){if(kO)return uy;kO=1;var t=hn(),e=kE(),n=_c(),r=Ij(),i=zi(),o=xD(),s=tf(),a=GD().IteratorPrototype,l=Pj(),u=_r(),c=Oj(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",C="throw",y=o.set,E=function(P){var D=o.getterFor(P?f:d);return r(e(a),{next:function(){var x=D(this);if(P)return x.nextHandler();if(x.done)return l(void 0,!0);try{var Y=x.nextHandler();return x.returnHandlerResult?Y:l(Y,x.done)}catch(U){throw x.done=!0,U}},return:function(){var M=D(this),x=M.iterator;if(M.done=!0,P){var Y=s(x,"return");return Y?t(Y,x):l(void 0,!0)}if(M.inner)try{u(M.inner.iterator,g)}catch(U){return u(x,C,U)}if(M.openIters)try{c(M.openIters,g)}catch(U){return u(x,C,U)}return x&&u(x,g),l(void 0,!0)}})},p=E(!0),_=E(!1);return n(_,h,"Iterator Helper"),uy=function(P,D,M){var x=function(U,B){B?(B.iterator=U.iterator,B.next=U.next):B=U,B.type=D?f:d,B.returnHandlerResult=!!M,B.nextHandler=P,B.counter=0,B.done=!1,y(this,B)};return x.prototype=D?p:_,x},uy}var cy,LO;function qD(){if(LO)return cy;LO=1;var t=fn(),e=_r();return cy=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},cy}var hy,$O;function $E(){return $O||($O=1,hy=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),hy}var dy,FO;function Ma(){if(FO)return dy;FO=1;var t=nn();return dy=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},dy}var VO;function xj(){if(VO)return AO;VO=1;var t=pt(),e=hn(),n=Er(),r=fn(),i=Ho(),o=LE(),s=qD(),a=_a(),l=_r(),u=$E(),c=Ma(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,g=o(function(){for(var C=this.iterator,y=this.predicate,E=this.next,p,_,P;;){if(p=r(e(E,C)),_=this.done=!!p.done,_)return;if(P=p.value,s(C,y,[P,this.counter++],!0))return P}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(y){r(this);try{n(y)}catch(E){l(this,"throw",E)}return d?e(d,this,y):new g(i(this),{predicate:y})}}),AO}var WO;function Aj(){return WO||(WO=1,xj()),xO}Aj();var BO={},jO={},UO;function Hj(){if(UO)return jO;UO=1;var t=pt(),e=hn(),n=Mc(),r=Er(),i=fn(),o=Ho(),s=_r(),a=Ma(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),jO}var zO;function Nj(){return zO||(zO=1,Hj()),BO}Nj();var YO={},GO={},qO;function Dj(){if(qO)return GO;qO=1;var t=pt(),e=hn(),n=Er(),r=fn(),i=Ho(),o=LE(),s=qD(),a=_r(),l=$E(),u=Ma(),c=_a(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,g=o(function(){var C=this.iterator,y=r(e(this.next,C)),E=this.done=!!y.done;if(!E)return s(C,this.mapper,[y.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(y){r(this);try{n(y)}catch(E){a(this,"throw",E)}return d?e(d,this,y):new g(i(this),{mapper:y})}}),GO}var KO;function kj(){return KO||(KO=1,Dj()),YO}kj();var XO={},ZO={},fy,QO;function FE(){if(QO)return fy;QO=1;var t=rn();return fy=t([].slice),fy}var gy,JO;function KD(){if(JO)return gy;JO=1;var t=TypeError;return gy=function(e,n){if(e<n)throw new t("Not enough arguments");return e},gy}var my,ex;function Lj(){if(ex)return my;ex=1;var t=Bp();return my=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),my}var py,tx;function XD(){if(tx)return py;tx=1;var t=nn(),e=Bp(),n=jl(),r=function(i){return e.slice(0,i.length)===i};return py=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),py}var wy,nx;function $j(){if(nx)return wy;nx=1;var t=XD();return wy=t==="NODE",wy}var vy,rx;function ZD(){if(rx)return vy;rx=1;var t=nn(),e=rf(),n=WD(),r=dn(),i=mi(),o=cn(),s=YD(),a=FE(),l=PE(),u=KD(),c=Lj(),h=$j(),d=t.setImmediate,f=t.clearImmediate,g=t.process,C=t.Dispatch,y=t.Function,E=t.MessageChannel,p=t.String,_=0,P={},D="onreadystatechange",M,x,Y,U;o(function(){M=t.location});var B=function(te){if(i(P,te)){var le=P[te];delete P[te],le()}},Z=function(te){return function(){B(te)}},Q=function(te){B(te.data)},se=function(te){t.postMessage(p(te),M.protocol+"//"+M.host)};return(!d||!f)&&(d=function(le){u(arguments.length,1);var ct=r(le)?le:y(le),be=a(arguments,1);return P[++_]=function(){e(ct,void 0,be)},x(_),_},f=function(le){delete P[le]},h?x=function(te){g.nextTick(Z(te))}:C&&C.now?x=function(te){C.now(Z(te))}:E&&!c?(Y=new E,U=Y.port2,Y.port1.onmessage=Q,x=n(U.postMessage,U)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&M&&M.protocol!=="file:"&&!o(se)?(x=se,t.addEventListener("message",Q,!1)):D in l("script")?x=function(te){s.appendChild(l("script"))[D]=function(){s.removeChild(this),B(te)}}:x=function(te){setTimeout(Z(te),0)}),vy={set:d,clear:f},vy}var ix;function Fj(){if(ix)return ZO;ix=1;var t=pt(),e=nn(),n=ZD().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),ZO}var ox={},Cy,sx;function Vj(){if(sx)return Cy;sx=1;var t=nn(),e=rf(),n=dn(),r=XD(),i=Bp(),o=FE(),s=KD(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return Cy=function(u,c){var h=c?2:1;return l?function(d,f){var g=s(arguments.length,1)>h,C=n(d)?d:a(d),y=g?o(arguments,h):[],E=g?function(){e(C,this,y)}:C;return c?u(E,f):u(E)}:u},Cy}var ax;function Wj(){if(ax)return ox;ax=1;var t=pt(),e=nn(),n=ZD().set,r=Vj(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),ox}var lx;function Bj(){return lx||(lx=1,Fj(),Wj()),XO}Bj();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:QD,setPrototypeOf:ux,isFrozen:jj,getPrototypeOf:Uj,getOwnPropertyDescriptor:zj}=Object;let{freeze:tr,seal:hi,create:JD}=Object,{apply:oR,construct:sR}=typeof Reflect<"u"&&Reflect;tr||(tr=function(e){return e});hi||(hi=function(e){return e});oR||(oR=function(e,n,r){return e.apply(n,r)});sR||(sR=function(e,n){return new e(...n)});const xf=nr(Array.prototype.forEach),Yj=nr(Array.prototype.lastIndexOf),cx=nr(Array.prototype.pop),Bc=nr(Array.prototype.push),Gj=nr(Array.prototype.splice),gm=nr(String.prototype.toLowerCase),yy=nr(String.prototype.toString),hx=nr(String.prototype.match),jc=nr(String.prototype.replace),qj=nr(String.prototype.indexOf),Kj=nr(String.prototype.trim),xi=nr(Object.prototype.hasOwnProperty),zn=nr(RegExp.prototype.test),Uc=Xj(TypeError);function nr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return oR(t,e,r)}}function Xj(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return sR(t,n)}}function Ve(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gm;ux&&ux(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(jj(e)||(e[r]=o),i=o)}t[i]=!0}return t}function Zj(t){for(let e=0;e<t.length;e++)xi(t,e)||(t[e]=null);return t}function ts(t){const e=JD(null);for(const[n,r]of QD(t))xi(t,n)&&(Array.isArray(r)?e[n]=Zj(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ts(r):e[n]=r);return e}function zc(t,e){for(;t!==null;){const r=zj(t,e);if(r){if(r.get)return nr(r.get);if(typeof r.value=="function")return nr(r.value)}t=Uj(t)}function n(){return null}return n}const dx=tr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),by=tr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Sy=tr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Qj=tr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ry=tr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Jj=tr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),fx=tr(["#text"]),gx=tr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ey=tr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mx=tr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Af=tr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),eU=hi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),tU=hi(/<%[\w\W]*|[\w\W]*%>/gm),nU=hi(/\$\{[\w\W]*/gm),rU=hi(/^data-[\-\w.\u00B7-\uFFFF]+$/),iU=hi(/^aria-[\-\w]+$/),ek=hi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),oU=hi(/^(?:\w+script|data):/i),sU=hi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),tk=hi(/^html$/i),aU=hi(/^[a-z][.\w]*(-[.\w]+)+$/i);var px=Object.freeze({__proto__:null,ARIA_ATTR:iU,ATTR_WHITESPACE:sU,CUSTOM_ELEMENT:aU,DATA_ATTR:rU,DOCTYPE_NAME:tk,ERB_EXPR:tU,IS_ALLOWED_URI:ek,IS_SCRIPT_OR_DATA:oU,MUSTACHE_EXPR:eU,TMPLIT_EXPR:nU});const Yc={element:1,text:3,progressingInstruction:7,comment:8,document:9},lU=function(){return typeof window>"u"?null:window},uU=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},wx=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function nk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lU();const e=ve=>nk(ve);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Yc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,C=zc(g,"cloneNode"),y=zc(g,"remove"),E=zc(g,"nextSibling"),p=zc(g,"childNodes"),_=zc(g,"parentNode");if(typeof s=="function"){const ve=n.createElement("template");ve.content&&ve.content.ownerDocument&&(n=ve.content.ownerDocument)}let P,D="";const{implementation:M,createNodeIterator:x,createDocumentFragment:Y,getElementsByTagName:U}=n,{importNode:B}=r;let Z=wx();e.isSupported=typeof QD=="function"&&typeof _=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Q,ERB_EXPR:se,TMPLIT_EXPR:te,DATA_ATTR:le,ARIA_ATTR:ct,IS_SCRIPT_OR_DATA:be,ATTR_WHITESPACE:He,CUSTOM_ELEMENT:ft}=px;let{IS_ALLOWED_URI:jt}=px,Ze=null;const m=Ve({},[...dx,...by,...Sy,...Ry,...fx]);let v=null;const w=Ve({},[...gx,...Ey,...mx,...Af]);let A=Object.seal(JD(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),F=null,j=null,G=!0,K=!0,b=!1,R=!0,S=!1,O=!0,T=!1,k=!1,W=!1,H=!1,N=!1,V=!1,$=!0,z=!1;const ne="user-content-";let ce=!0,Ee=!1,ke={},je=null;const Re=Ve({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $e=null;const St=Ve({},["audio","video","img","source","image","track"]);let yi=null;const $o=Ve({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ur="http://www.w3.org/1998/Math/MathML",Rt="http://www.w3.org/2000/svg",sn="http://www.w3.org/1999/xhtml";let wt=sn,Et=!1,Fe=null;const zr=Ve({},[Ur,Rt,sn],yy);let Oa=Ve({},["mi","mo","mn","ms","mtext"]),xa=Ve({},["annotation-xml"]);const hW=Ve({},["title","style","font","a","script"]);let Fc=null;const dW=["application/xhtml+xml","text/html"],fW="text/html";let bn=null,tu=null;const gW=n.createElement("form"),PM=function(L){return L instanceof RegExp||L instanceof Function},jw=function(){let L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(tu&&tu===L)){if((!L||typeof L!="object")&&(L={}),L=ts(L),Fc=dW.indexOf(L.PARSER_MEDIA_TYPE)===-1?fW:L.PARSER_MEDIA_TYPE,bn=Fc==="application/xhtml+xml"?yy:gm,Ze=xi(L,"ALLOWED_TAGS")?Ve({},L.ALLOWED_TAGS,bn):m,v=xi(L,"ALLOWED_ATTR")?Ve({},L.ALLOWED_ATTR,bn):w,Fe=xi(L,"ALLOWED_NAMESPACES")?Ve({},L.ALLOWED_NAMESPACES,yy):zr,yi=xi(L,"ADD_URI_SAFE_ATTR")?Ve(ts($o),L.ADD_URI_SAFE_ATTR,bn):$o,$e=xi(L,"ADD_DATA_URI_TAGS")?Ve(ts(St),L.ADD_DATA_URI_TAGS,bn):St,je=xi(L,"FORBID_CONTENTS")?Ve({},L.FORBID_CONTENTS,bn):Re,F=xi(L,"FORBID_TAGS")?Ve({},L.FORBID_TAGS,bn):ts({}),j=xi(L,"FORBID_ATTR")?Ve({},L.FORBID_ATTR,bn):ts({}),ke=xi(L,"USE_PROFILES")?L.USE_PROFILES:!1,G=L.ALLOW_ARIA_ATTR!==!1,K=L.ALLOW_DATA_ATTR!==!1,b=L.ALLOW_UNKNOWN_PROTOCOLS||!1,R=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,S=L.SAFE_FOR_TEMPLATES||!1,O=L.SAFE_FOR_XML!==!1,T=L.WHOLE_DOCUMENT||!1,H=L.RETURN_DOM||!1,N=L.RETURN_DOM_FRAGMENT||!1,V=L.RETURN_TRUSTED_TYPE||!1,W=L.FORCE_BODY||!1,$=L.SANITIZE_DOM!==!1,z=L.SANITIZE_NAMED_PROPS||!1,ce=L.KEEP_CONTENT!==!1,Ee=L.IN_PLACE||!1,jt=L.ALLOWED_URI_REGEXP||ek,wt=L.NAMESPACE||sn,Oa=L.MATHML_TEXT_INTEGRATION_POINTS||Oa,xa=L.HTML_INTEGRATION_POINTS||xa,A=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&PM(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(A.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&PM(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(A.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(A.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),S&&(K=!1),N&&(H=!0),ke&&(Ze=Ve({},fx),v=[],ke.html===!0&&(Ve(Ze,dx),Ve(v,gx)),ke.svg===!0&&(Ve(Ze,by),Ve(v,Ey),Ve(v,Af)),ke.svgFilters===!0&&(Ve(Ze,Sy),Ve(v,Ey),Ve(v,Af)),ke.mathMl===!0&&(Ve(Ze,Ry),Ve(v,mx),Ve(v,Af))),L.ADD_TAGS&&(Ze===m&&(Ze=ts(Ze)),Ve(Ze,L.ADD_TAGS,bn)),L.ADD_ATTR&&(v===w&&(v=ts(v)),Ve(v,L.ADD_ATTR,bn)),L.ADD_URI_SAFE_ATTR&&Ve(yi,L.ADD_URI_SAFE_ATTR,bn),L.FORBID_CONTENTS&&(je===Re&&(je=ts(je)),Ve(je,L.FORBID_CONTENTS,bn)),ce&&(Ze["#text"]=!0),T&&Ve(Ze,["html","head","body"]),Ze.table&&(Ve(Ze,["tbody"]),delete F.tbody),L.TRUSTED_TYPES_POLICY){if(typeof L.TRUSTED_TYPES_POLICY.createHTML!="function")throw Uc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof L.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Uc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=L.TRUSTED_TYPES_POLICY,D=P.createHTML("")}else P===void 0&&(P=uU(f,i)),P!==null&&typeof D=="string"&&(D=P.createHTML(""));tr&&tr(L),tu=L}},OM=Ve({},[...by,...Sy,...Qj]),xM=Ve({},[...Ry,...Jj]),mW=function(L){let ee=_(L);(!ee||!ee.tagName)&&(ee={namespaceURI:wt,tagName:"template"});const me=gm(L.tagName),At=gm(ee.tagName);return Fe[L.namespaceURI]?L.namespaceURI===Rt?ee.namespaceURI===sn?me==="svg":ee.namespaceURI===Ur?me==="svg"&&(At==="annotation-xml"||Oa[At]):!!OM[me]:L.namespaceURI===Ur?ee.namespaceURI===sn?me==="math":ee.namespaceURI===Rt?me==="math"&&xa[At]:!!xM[me]:L.namespaceURI===sn?ee.namespaceURI===Rt&&!xa[At]||ee.namespaceURI===Ur&&!Oa[At]?!1:!xM[me]&&(hW[me]||!OM[me]):!!(Fc==="application/xhtml+xml"&&Fe[L.namespaceURI]):!1},qi=function(L){Bc(e.removed,{element:L});try{_(L).removeChild(L)}catch{y(L)}},nu=function(L,ee){try{Bc(e.removed,{attribute:ee.getAttributeNode(L),from:ee})}catch{Bc(e.removed,{attribute:null,from:ee})}if(ee.removeAttribute(L),L==="is")if(H||N)try{qi(ee)}catch{}else try{ee.setAttribute(L,"")}catch{}},AM=function(L){let ee=null,me=null;if(W)L="<remove></remove>"+L;else{const mn=hx(L,/^[\r\n\t ]+/);me=mn&&mn[0]}Fc==="application/xhtml+xml"&&wt===sn&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");const At=P?P.createHTML(L):L;if(wt===sn)try{ee=new d().parseFromString(At,Fc)}catch{}if(!ee||!ee.documentElement){ee=M.createDocument(wt,"template",null);try{ee.documentElement.innerHTML=Et?D:At}catch{}}const xn=ee.body||ee.documentElement;return L&&me&&xn.insertBefore(n.createTextNode(me),xn.childNodes[0]||null),wt===sn?U.call(ee,T?"html":"body")[0]:T?ee.documentElement:xn},HM=function(L){return x.call(L.ownerDocument||L,L,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Uw=function(L){return L instanceof h&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof c)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},NM=function(L){return typeof a=="function"&&L instanceof a};function Fo(ve,L,ee){xf(ve,me=>{me.call(e,L,ee,tu)})}const DM=function(L){let ee=null;if(Fo(Z.beforeSanitizeElements,L,null),Uw(L))return qi(L),!0;const me=bn(L.nodeName);if(Fo(Z.uponSanitizeElement,L,{tagName:me,allowedTags:Ze}),O&&L.hasChildNodes()&&!NM(L.firstElementChild)&&zn(/<[/\w!]/g,L.innerHTML)&&zn(/<[/\w!]/g,L.textContent)||L.nodeType===Yc.progressingInstruction||O&&L.nodeType===Yc.comment&&zn(/<[/\w]/g,L.data))return qi(L),!0;if(!Ze[me]||F[me]){if(!F[me]&&LM(me)&&(A.tagNameCheck instanceof RegExp&&zn(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me)))return!1;if(ce&&!je[me]){const At=_(L)||L.parentNode,xn=p(L)||L.childNodes;if(xn&&At){const mn=xn.length;for(let ir=mn-1;ir>=0;--ir){const Vo=C(xn[ir],!0);Vo.__removalCount=(L.__removalCount||0)+1,At.insertBefore(Vo,E(L))}}}return qi(L),!0}return L instanceof l&&!mW(L)||(me==="noscript"||me==="noembed"||me==="noframes")&&zn(/<\/no(script|embed|frames)/i,L.innerHTML)?(qi(L),!0):(S&&L.nodeType===Yc.text&&(ee=L.textContent,xf([Q,se,te],At=>{ee=jc(ee,At," ")}),L.textContent!==ee&&(Bc(e.removed,{element:L.cloneNode()}),L.textContent=ee)),Fo(Z.afterSanitizeElements,L,null),!1)},kM=function(L,ee,me){if($&&(ee==="id"||ee==="name")&&(me in n||me in gW))return!1;if(!(K&&!j[ee]&&zn(le,ee))){if(!(G&&zn(ct,ee))){if(!v[ee]||j[ee]){if(!(LM(L)&&(A.tagNameCheck instanceof RegExp&&zn(A.tagNameCheck,L)||A.tagNameCheck instanceof Function&&A.tagNameCheck(L))&&(A.attributeNameCheck instanceof RegExp&&zn(A.attributeNameCheck,ee)||A.attributeNameCheck instanceof Function&&A.attributeNameCheck(ee))||ee==="is"&&A.allowCustomizedBuiltInElements&&(A.tagNameCheck instanceof RegExp&&zn(A.tagNameCheck,me)||A.tagNameCheck instanceof Function&&A.tagNameCheck(me))))return!1}else if(!yi[ee]){if(!zn(jt,jc(me,He,""))){if(!((ee==="src"||ee==="xlink:href"||ee==="href")&&L!=="script"&&qj(me,"data:")===0&&$e[L])){if(!(b&&!zn(be,jc(me,He,"")))){if(me)return!1}}}}}}return!0},LM=function(L){return L!=="annotation-xml"&&hx(L,ft)},$M=function(L){Fo(Z.beforeSanitizeAttributes,L,null);const{attributes:ee}=L;if(!ee||Uw(L))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let At=ee.length;for(;At--;){const xn=ee[At],{name:mn,namespaceURI:ir,value:Vo}=xn,Vc=bn(mn),zw=Vo;let An=mn==="value"?zw:Kj(zw);if(me.attrName=Vc,me.attrValue=An,me.keepAttr=!0,me.forceKeepAttr=void 0,Fo(Z.uponSanitizeAttribute,L,me),An=me.attrValue,z&&(Vc==="id"||Vc==="name")&&(nu(mn,L),An=ne+An),O&&zn(/((--!?|])>)|<\/(style|title)/i,An)){nu(mn,L);continue}if(me.forceKeepAttr)continue;if(!me.keepAttr){nu(mn,L);continue}if(!R&&zn(/\/>/i,An)){nu(mn,L);continue}S&&xf([Q,se,te],VM=>{An=jc(An,VM," ")});const FM=bn(L.nodeName);if(!kM(FM,Vc,An)){nu(mn,L);continue}if(P&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!ir)switch(f.getAttributeType(FM,Vc)){case"TrustedHTML":{An=P.createHTML(An);break}case"TrustedScriptURL":{An=P.createScriptURL(An);break}}if(An!==zw)try{ir?L.setAttributeNS(ir,mn,An):L.setAttribute(mn,An),Uw(L)?qi(L):cx(e.removed)}catch{nu(mn,L)}}Fo(Z.afterSanitizeAttributes,L,null)},pW=function ve(L){let ee=null;const me=HM(L);for(Fo(Z.beforeSanitizeShadowDOM,L,null);ee=me.nextNode();)Fo(Z.uponSanitizeShadowNode,ee,null),DM(ee),$M(ee),ee.content instanceof o&&ve(ee.content);Fo(Z.afterSanitizeShadowDOM,L,null)};return e.sanitize=function(ve){let L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ee=null,me=null,At=null,xn=null;if(Et=!ve,Et&&(ve="<!-->"),typeof ve!="string"&&!NM(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw Uc("dirty is not a string, aborting")}else throw Uc("toString is not a function");if(!e.isSupported)return ve;if(k||jw(L),e.removed=[],typeof ve=="string"&&(Ee=!1),Ee){if(ve.nodeName){const Vo=bn(ve.nodeName);if(!Ze[Vo]||F[Vo])throw Uc("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof a)ee=AM("<!---->"),me=ee.ownerDocument.importNode(ve,!0),me.nodeType===Yc.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?ee=me:ee.appendChild(me);else{if(!H&&!S&&!T&&ve.indexOf("<")===-1)return P&&V?P.createHTML(ve):ve;if(ee=AM(ve),!ee)return H?null:V?D:""}ee&&W&&qi(ee.firstChild);const mn=HM(Ee?ve:ee);for(;At=mn.nextNode();)DM(At),$M(At),At.content instanceof o&&pW(At.content);if(Ee)return ve;if(H){if(N)for(xn=Y.call(ee.ownerDocument);ee.firstChild;)xn.appendChild(ee.firstChild);else xn=ee;return(v.shadowroot||v.shadowrootmode)&&(xn=B.call(r,xn,!0)),xn}let ir=T?ee.outerHTML:ee.innerHTML;return T&&Ze["!doctype"]&&ee.ownerDocument&&ee.ownerDocument.doctype&&ee.ownerDocument.doctype.name&&zn(tk,ee.ownerDocument.doctype.name)&&(ir="<!DOCTYPE "+ee.ownerDocument.doctype.name+`>
`+ir),S&&xf([Q,se,te],Vo=>{ir=jc(ir,Vo," ")}),P&&V?P.createHTML(ir):ir},e.setConfig=function(){let ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jw(ve),k=!0},e.clearConfig=function(){tu=null,k=!1},e.isValidAttribute=function(ve,L,ee){tu||jw({});const me=bn(ve),At=bn(L);return kM(me,At,ee)},e.addHook=function(ve,L){typeof L=="function"&&Bc(Z[ve],L)},e.removeHook=function(ve,L){if(L!==void 0){const ee=Yj(Z[ve],L);return ee===-1?void 0:Gj(Z[ve],ee,1)[0]}return cx(Z[ve])},e.removeHooks=function(ve){Z[ve]=[]},e.removeAllHooks=function(){Z=wx()},e}var cU=nk();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var rk;function X(){return rk.apply(null,arguments)}function hU(t){rk=t}function Bi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function xl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function tt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function VE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(tt(t,e))return!1;return!0}function gr(t){return t===void 0}function Ss(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function af(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function ik(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function oa(t,e){for(var n in e)tt(e,n)&&(t[n]=e[n]);return tt(e,"toString")&&(t.toString=e.toString),tt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function No(t,e,n,r){return Mk(t,e,n,r,!0).utc()}function dU(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Oe(t){return t._pf==null&&(t._pf=dU()),t._pf}var aR;Array.prototype.some?aR=Array.prototype.some:aR=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function WE(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Oe(t),n=aR.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function zp(t){var e=No(NaN);return t!=null?oa(Oe(e),t):Oe(e).userInvalidated=!0,e}var vx=X.momentProperties=[],_y=!1;function BE(t,e){var n,r,i,o=vx.length;if(gr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),gr(e._i)||(t._i=e._i),gr(e._f)||(t._f=e._f),gr(e._l)||(t._l=e._l),gr(e._strict)||(t._strict=e._strict),gr(e._tzm)||(t._tzm=e._tzm),gr(e._isUTC)||(t._isUTC=e._isUTC),gr(e._offset)||(t._offset=e._offset),gr(e._pf)||(t._pf=Oe(e)),gr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=vx[n],i=e[r],gr(i)||(t[r]=i);return t}function lf(t){BE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),_y===!1&&(_y=!0,X.updateOffset(this),_y=!1)}function ji(t){return t instanceof lf||t!=null&&t._isAMomentObject!=null}function ok(t){X.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function pi(t,e){var n=!0;return oa(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])tt(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}ok(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var Cx={};function sk(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),Cx[t]||(ok(e),Cx[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function Do(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function fU(t){var e,n;for(n in t)tt(t,n)&&(e=t[n],Do(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function lR(t,e){var n=oa({},t),r;for(r in e)tt(e,r)&&(xl(t[r])&&xl(e[r])?(n[r]={},oa(n[r],t[r]),oa(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)tt(t,r)&&!tt(e,r)&&xl(t[r])&&(n[r]=oa({},n[r]));return n}function jE(t){t!=null&&this.set(t)}var uR;Object.keys?uR=Object.keys:uR=function(t){var e,n=[];for(e in t)tt(t,e)&&n.push(e);return n};var gU={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function mU(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Do(r)?r.call(e,n):r}function Oo(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var UE=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Hf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ty={},rc={};function Ce(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(rc[t]=i),e&&(rc[e[0]]=function(){return Oo(i.apply(this,arguments),e[1],e[2])}),n&&(rc[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function pU(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function wU(t){var e=t.match(UE),n,r;for(n=0,r=e.length;n<r;n++)rc[e[n]]?e[n]=rc[e[n]]:e[n]=pU(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Do(e[s])?e[s].call(i,t):e[s];return o}}function mm(t,e){return t.isValid()?(e=ak(e,t.localeData()),Ty[e]=Ty[e]||wU(e),Ty[e](t)):t.localeData().invalidDate()}function ak(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Hf.lastIndex=0;n>=0&&Hf.test(t);)t=t.replace(Hf,r),Hf.lastIndex=0,n-=1;return t}var vU={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function CU(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(UE).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var yU="Invalid date";function bU(){return this._invalidDate}var SU="%d",RU=/\d{1,2}/;function EU(t){return this._ordinal.replace("%d",t)}var _U={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function TU(t,e,n,r){var i=this._relativeTime[n];return Do(i)?i(t,e,n,r):i.replace(/%d/i,t)}function MU(t,e){var n=this._relativeTime[t>0?"future":"past"];return Do(n)?n(e):n.replace(/%s/i,e)}var yx={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function wi(t){return typeof t=="string"?yx[t]||yx[t.toLowerCase()]:void 0}function zE(t){var e={},n,r;for(r in t)tt(t,r)&&(n=wi(r),n&&(e[n]=t[r]));return e}var IU={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function PU(t){var e=[],n;for(n in t)tt(t,n)&&e.push({unit:n,priority:IU[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var lk=/\d/,jr=/\d\d/,uk=/\d{3}/,YE=/\d{4}/,Yp=/[+-]?\d{6}/,xt=/\d\d?/,ck=/\d\d\d\d?/,hk=/\d\d\d\d\d\d?/,Gp=/\d{1,3}/,GE=/\d{1,4}/,qp=/[+-]?\d{1,6}/,Ic=/\d+/,Kp=/[+-]?\d+/,OU=/Z|[+-]\d\d:?\d\d/gi,Xp=/Z|[+-]\d\d(?::?\d\d)?/gi,xU=/[+-]?\d+(\.\d{1,3})?/,uf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Pc=/^[1-9]\d?/,qE=/^([1-9]\d|\d)/,Um;Um={};function ue(t,e,n){Um[t]=Do(e)?e:function(r,i){return r&&n?n:e}}function AU(t,e){return tt(Um,t)?Um[t](e._strict,e._locale):new RegExp(HU(t))}function HU(t){return Cs(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Cs(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function oi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ze(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=oi(e)),n}var cR={};function gt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ss(e)&&(r=function(o,s){s[e]=ze(o)}),i=t.length,n=0;n<i;n++)cR[t[n]]=r}function cf(t,e){gt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function NU(t,e,n){e!=null&&tt(cR,t)&&cR[t](e,n._a,n,t)}function Zp(t){return t%4===0&&t%100!==0||t%400===0}var Wn=0,ds=1,bo=2,Cn=3,Fi=4,fs=5,El=6,DU=7,kU=8;Ce("Y",0,0,function(){var t=this.year();return t<=9999?Oo(t,4):"+"+t});Ce(0,["YY",2],0,function(){return this.year()%100});Ce(0,["YYYY",4],0,"year");Ce(0,["YYYYY",5],0,"year");Ce(0,["YYYYYY",6,!0],0,"year");ue("Y",Kp);ue("YY",xt,jr);ue("YYYY",GE,YE);ue("YYYYY",qp,Yp);ue("YYYYYY",qp,Yp);gt(["YYYYY","YYYYYY"],Wn);gt("YYYY",function(t,e){e[Wn]=t.length===2?X.parseTwoDigitYear(t):ze(t)});gt("YY",function(t,e){e[Wn]=X.parseTwoDigitYear(t)});gt("Y",function(t,e){e[Wn]=parseInt(t,10)});function rd(t){return Zp(t)?366:365}X.parseTwoDigitYear=function(t){return ze(t)+(ze(t)>68?1900:2e3)};var dk=Oc("FullYear",!0);function LU(){return Zp(this.year())}function Oc(t,e){return function(n){return n!=null?(fk(this,t,n),X.updateOffset(this,e),this):Pd(this,t)}}function Pd(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function fk(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Zp(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function $U(t){return t=wi(t),Do(this[t])?this[t]():this}function FU(t,e){if(typeof t=="object"){t=zE(t);var n=PU(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=wi(t),Do(this[t]))return this[t](e);return this}function VU(t,e){return(t%e+e)%e}var Qt;Array.prototype.indexOf?Qt=Array.prototype.indexOf:Qt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function KE(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=VU(e,12);return t+=(e-n)/12,n===1?Zp(t)?29:28:31-n%7%2}Ce("M",["MM",2],"Mo",function(){return this.month()+1});Ce("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ce("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",xt,Pc);ue("MM",xt,jr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});gt(["M","MM"],function(t,e){e[ds]=ze(t)-1});gt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ds]=i:Oe(n).invalidMonth=t});var WU="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),gk="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),mk=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,BU=uf,jU=uf;function UU(t,e){return t?Bi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||mk).test(e)?"format":"standalone"][t.month()]:Bi(this._months)?this._months:this._months.standalone}function zU(t,e){return t?Bi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[mk.test(e)?"format":"standalone"][t.month()]:Bi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function YU(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=No([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Qt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:(i=Qt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Qt.call(this._longMonthsParse,s),i!==-1?i:(i=Qt.call(this._shortMonthsParse,s),i!==-1?i:null))}function GU(t,e,n){var r,i,o;if(this._monthsParseExact)return YU.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=No([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function pk(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ze(e);else if(e=t.localeData().monthsParse(e),!Ss(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,KE(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function wk(t){return t!=null?(pk(this,t),X.updateOffset(this,!0),this):Pd(this,"Month")}function qU(){return KE(this.year(),this.month())}function KU(t){return this._monthsParseExact?(tt(this,"_monthsRegex")||vk.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(tt(this,"_monthsShortRegex")||(this._monthsShortRegex=BU),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function XU(t){return this._monthsParseExact?(tt(this,"_monthsRegex")||vk.call(this),t?this._monthsStrictRegex:this._monthsRegex):(tt(this,"_monthsRegex")||(this._monthsRegex=jU),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function vk(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=No([2e3,i]),s=Cs(this.monthsShort(o,"")),a=Cs(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ZU(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Od(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function zm(t,e,n){var r=7+e-n,i=(7+Od(t,0,r).getUTCDay()-e)%7;return-i+r-1}function Ck(t,e,n,r,i){var o=(7+n-r)%7,s=zm(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=rd(l)+a):a>rd(t)?(l=t+1,u=a-rd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function xd(t,e,n){var r=zm(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ys(s,e,n)):i>ys(t.year(),e,n)?(o=i-ys(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ys(t,e,n){var r=zm(t,e,n),i=zm(t+1,e,n);return(rd(t)-r+i)/7}Ce("w",["ww",2],"wo","week");Ce("W",["WW",2],"Wo","isoWeek");ue("w",xt,Pc);ue("ww",xt,jr);ue("W",xt,Pc);ue("WW",xt,jr);cf(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=ze(t)});function QU(t){return xd(t,this._week.dow,this._week.doy).week}var JU={dow:0,doy:6};function ez(){return this._week.dow}function tz(){return this._week.doy}function nz(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function rz(t){var e=xd(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ce("d",0,"do","day");Ce("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ce("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ce("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ce("e",0,0,"weekday");Ce("E",0,0,"isoWeekday");ue("d",xt);ue("e",xt);ue("E",xt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});cf(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Oe(n).invalidWeekday=t});cf(["d","e","E"],function(t,e,n,r){e[r]=ze(t)});function iz(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function oz(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function XE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var sz="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),yk="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),az="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),lz=uf,uz=uf,cz=uf;function hz(t,e){var n=Bi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?XE(n,this._week.dow):t?n[t.day()]:n}function dz(t){return t===!0?XE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function fz(t){return t===!0?XE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function gz(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=No([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Qt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Qt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Qt.call(this._weekdaysParse,s),i!==-1||(i=Qt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Qt.call(this._shortWeekdaysParse,s),i!==-1||(i=Qt.call(this._weekdaysParse,s),i!==-1)?i:(i=Qt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Qt.call(this._minWeekdaysParse,s),i!==-1||(i=Qt.call(this._weekdaysParse,s),i!==-1)?i:(i=Qt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function mz(t,e,n){var r,i,o;if(this._weekdaysParseExact)return gz.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=No([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function pz(t){if(!this.isValid())return t!=null?this:NaN;var e=Pd(this,"Day");return t!=null?(t=iz(t,this.localeData()),this.add(t-e,"d")):e}function wz(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function vz(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=oz(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Cz(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||ZE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(tt(this,"_weekdaysRegex")||(this._weekdaysRegex=lz),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function yz(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||ZE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(tt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=uz),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function bz(t){return this._weekdaysParseExact?(tt(this,"_weekdaysRegex")||ZE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(tt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cz),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ZE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=No([2e3,1]).day(o),a=Cs(this.weekdaysMin(s,"")),l=Cs(this.weekdaysShort(s,"")),u=Cs(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function QE(){return this.hours()%12||12}function Sz(){return this.hours()||24}Ce("H",["HH",2],0,"hour");Ce("h",["hh",2],0,QE);Ce("k",["kk",2],0,Sz);Ce("hmm",0,0,function(){return""+QE.apply(this)+Oo(this.minutes(),2)});Ce("hmmss",0,0,function(){return""+QE.apply(this)+Oo(this.minutes(),2)+Oo(this.seconds(),2)});Ce("Hmm",0,0,function(){return""+this.hours()+Oo(this.minutes(),2)});Ce("Hmmss",0,0,function(){return""+this.hours()+Oo(this.minutes(),2)+Oo(this.seconds(),2)});function bk(t,e){Ce(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}bk("a",!0);bk("A",!1);function Sk(t,e){return e._meridiemParse}ue("a",Sk);ue("A",Sk);ue("H",xt,qE);ue("h",xt,Pc);ue("k",xt,Pc);ue("HH",xt,jr);ue("hh",xt,jr);ue("kk",xt,jr);ue("hmm",ck);ue("hmmss",hk);ue("Hmm",ck);ue("Hmmss",hk);gt(["H","HH"],Cn);gt(["k","kk"],function(t,e,n){var r=ze(t);e[Cn]=r===24?0:r});gt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});gt(["h","hh"],function(t,e,n){e[Cn]=ze(t),Oe(n).bigHour=!0});gt("hmm",function(t,e,n){var r=t.length-2;e[Cn]=ze(t.substr(0,r)),e[Fi]=ze(t.substr(r)),Oe(n).bigHour=!0});gt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Cn]=ze(t.substr(0,r)),e[Fi]=ze(t.substr(r,2)),e[fs]=ze(t.substr(i)),Oe(n).bigHour=!0});gt("Hmm",function(t,e,n){var r=t.length-2;e[Cn]=ze(t.substr(0,r)),e[Fi]=ze(t.substr(r))});gt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Cn]=ze(t.substr(0,r)),e[Fi]=ze(t.substr(r,2)),e[fs]=ze(t.substr(i))});function Rz(t){return(t+"").toLowerCase().charAt(0)==="p"}var Ez=/[ap]\.?m?\.?/i,_z=Oc("Hours",!0);function Tz(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var Rk={calendar:gU,longDateFormat:vU,invalidDate:yU,ordinal:SU,dayOfMonthOrdinalParse:RU,relativeTime:_U,months:WU,monthsShort:gk,week:JU,weekdays:sz,weekdaysMin:az,weekdaysShort:yk,meridiemParse:Ez},Ht={},Gc={},Ad;function Mz(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function bx(t){return t&&t.toLowerCase().replace("_","-")}function Iz(t){for(var e=0,n,r,i,o;e<t.length;){for(o=bx(t[e]).split("-"),n=o.length,r=bx(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Qp(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&Mz(o,r)>=n-1)break;n--}e++}return Ad}function Pz(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Qp(t){var e=null,n;if(Ht[t]===void 0&&typeof Lm<"u"&&Lm&&Lm.exports&&Pz(t))try{e=Ad._abbr,n=require,n("./locale/"+t),da(e)}catch{Ht[t]=null}return Ht[t]}function da(t,e){var n;return t&&(gr(e)?n=Ts(t):n=JE(t,e),n?Ad=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ad._abbr}function JE(t,e){if(e!==null){var n,r=Rk;if(e.abbr=t,Ht[t]!=null)sk("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ht[t]._config;else if(e.parentLocale!=null)if(Ht[e.parentLocale]!=null)r=Ht[e.parentLocale]._config;else if(n=Qp(e.parentLocale),n!=null)r=n._config;else return Gc[e.parentLocale]||(Gc[e.parentLocale]=[]),Gc[e.parentLocale].push({name:t,config:e}),null;return Ht[t]=new jE(lR(r,e)),Gc[t]&&Gc[t].forEach(function(i){JE(i.name,i.config)}),da(t),Ht[t]}else return delete Ht[t],null}function Oz(t,e){if(e!=null){var n,r,i=Rk;Ht[t]!=null&&Ht[t].parentLocale!=null?Ht[t].set(lR(Ht[t]._config,e)):(r=Qp(t),r!=null&&(i=r._config),e=lR(i,e),r==null&&(e.abbr=t),n=new jE(e),n.parentLocale=Ht[t],Ht[t]=n),da(t)}else Ht[t]!=null&&(Ht[t].parentLocale!=null?(Ht[t]=Ht[t].parentLocale,t===da()&&da(t)):Ht[t]!=null&&delete Ht[t]);return Ht[t]}function Ts(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ad;if(!Bi(t)){if(e=Qp(t),e)return e;t=[t]}return Iz(t)}function xz(){return uR(Ht)}function e0(t){var e,n=t._a;return n&&Oe(t).overflow===-2&&(e=n[ds]<0||n[ds]>11?ds:n[bo]<1||n[bo]>KE(n[Wn],n[ds])?bo:n[Cn]<0||n[Cn]>24||n[Cn]===24&&(n[Fi]!==0||n[fs]!==0||n[El]!==0)?Cn:n[Fi]<0||n[Fi]>59?Fi:n[fs]<0||n[fs]>59?fs:n[El]<0||n[El]>999?El:-1,Oe(t)._overflowDayOfYear&&(e<Wn||e>bo)&&(e=bo),Oe(t)._overflowWeeks&&e===-1&&(e=DU),Oe(t)._overflowWeekday&&e===-1&&(e=kU),Oe(t).overflow=e),t}var Az=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Hz=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Nz=/Z|[+-]\d\d(?::?\d\d)?/,Nf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],My=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Dz=/^\/?Date\((-?\d+)/i,kz=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Lz={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Ek(t){var e,n,r=t._i,i=Az.exec(r)||Hz.exec(r),o,s,a,l,u=Nf.length,c=My.length;if(i){for(Oe(t).iso=!0,e=0,n=u;e<n;e++)if(Nf[e][1].exec(i[1])){s=Nf[e][0],o=Nf[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(My[e][1].exec(i[3])){a=(i[2]||" ")+My[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(Nz.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),n0(t)}else t._isValid=!1}function $z(t,e,n,r,i,o){var s=[Fz(t),gk.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Fz(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Vz(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Wz(t,e,n){if(t){var r=yk.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Oe(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Bz(t,e,n){if(t)return Lz[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function _k(t){var e=kz.exec(Vz(t._i)),n;if(e){if(n=$z(e[4],e[3],e[2],e[5],e[6],e[7]),!Wz(e[1],n,t))return;t._a=n,t._tzm=Bz(e[8],e[9],e[10]),t._d=Od.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Oe(t).rfc2822=!0}else t._isValid=!1}function jz(t){var e=Dz.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(Ek(t),t._isValid===!1)delete t._isValid;else return;if(_k(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=pi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ju(t,e,n){return t??e??n}function Uz(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function t0(t){var e,n,r=[],i,o,s;if(!t._d){for(i=Uz(t),t._w&&t._a[bo]==null&&t._a[ds]==null&&zz(t),t._dayOfYear!=null&&(s=ju(t._a[Wn],i[Wn]),(t._dayOfYear>rd(s)||t._dayOfYear===0)&&(Oe(t)._overflowDayOfYear=!0),n=Od(s,0,t._dayOfYear),t._a[ds]=n.getUTCMonth(),t._a[bo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Cn]===24&&t._a[Fi]===0&&t._a[fs]===0&&t._a[El]===0&&(t._nextDay=!0,t._a[Cn]=0),t._d=(t._useUTC?Od:ZU).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Cn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Oe(t).weekdayMismatch=!0)}}function zz(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=ju(e.GG,t._a[Wn],xd(Ot(),1,4).year),r=ju(e.W,1),i=ju(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=xd(Ot(),o,s),n=ju(e.gg,t._a[Wn],u.year),r=ju(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>ys(n,o,s)?Oe(t)._overflowWeeks=!0:l!=null?Oe(t)._overflowWeekday=!0:(a=Ck(n,r,i,o,s),t._a[Wn]=a.year,t._dayOfYear=a.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function n0(t){if(t._f===X.ISO_8601){Ek(t);return}if(t._f===X.RFC_2822){_k(t);return}t._a=[],Oe(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=ak(t._f,t._locale).match(UE)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(AU(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Oe(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),rc[o]?(r?Oe(t).empty=!1:Oe(t).unusedTokens.push(o),NU(o,r,t)):t._strict&&!r&&Oe(t).unusedTokens.push(o);Oe(t).charsLeftOver=a-l,e.length>0&&Oe(t).unusedInput.push(e),t._a[Cn]<=12&&Oe(t).bigHour===!0&&t._a[Cn]>0&&(Oe(t).bigHour=void 0),Oe(t).parsedDateParts=t._a.slice(0),Oe(t).meridiem=t._meridiem,t._a[Cn]=Yz(t._locale,t._a[Cn],t._meridiem),u=Oe(t).era,u!==null&&(t._a[Wn]=t._locale.erasConvertYear(u,t._a[Wn])),t0(t),e0(t)}function Yz(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Gz(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Oe(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=BE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],n0(e),WE(e)&&(s=!0),o+=Oe(e).charsLeftOver,o+=Oe(e).unusedTokens.length*10,Oe(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));oa(t,n||e)}function qz(t){if(!t._d){var e=zE(t._i),n=e.day===void 0?e.date:e.day;t._a=ik([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),t0(t)}}function Kz(t){var e=new lf(e0(Tk(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Tk(t){var e=t._i,n=t._f;return t._locale=t._locale||Ts(t._l),e===null||n===void 0&&e===""?zp({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ji(e)?new lf(e0(e)):(af(e)?t._d=e:Bi(n)?Gz(t):n?n0(t):Xz(t),WE(t)||(t._d=null),t))}function Xz(t){var e=t._i;gr(e)?t._d=new Date(X.now()):af(e)?t._d=new Date(e.valueOf()):typeof e=="string"?jz(t):Bi(e)?(t._a=ik(e.slice(0),function(n){return parseInt(n,10)}),t0(t)):xl(e)?qz(t):Ss(e)?t._d=new Date(e):X.createFromInputFallback(t)}function Mk(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(xl(t)&&VE(t)||Bi(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,Kz(o)}function Ot(t,e,n,r){return Mk(t,e,n,r,!1)}var Zz=pi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:zp()}),Qz=pi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:zp()});function Ik(t,e){var n,r;if(e.length===1&&Bi(e[0])&&(e=e[0]),!e.length)return Ot();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function Jz(){var t=[].slice.call(arguments,0);return Ik("isBefore",t)}function eY(){var t=[].slice.call(arguments,0);return Ik("isAfter",t)}var tY=function(){return Date.now?Date.now():+new Date},qc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function nY(t){var e,n=!1,r,i=qc.length;for(e in t)if(tt(t,e)&&!(Qt.call(qc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[qc[r]]){if(n)return!1;parseFloat(t[qc[r]])!==ze(t[qc[r]])&&(n=!0)}return!0}function rY(){return this._isValid}function iY(){return Yi(NaN)}function Jp(t){var e=zE(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=nY(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Ts(),this._bubble()}function pm(t){return t instanceof Jp}function hR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function oY(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)ze(t[s])!==ze(e[s])&&o++;return o+i}function Pk(t,e){Ce(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Oo(~~(n/60),2)+e+Oo(~~n%60,2)})}Pk("Z",":");Pk("ZZ","");ue("Z",Xp);ue("ZZ",Xp);gt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=r0(Xp,t)});var sY=/([\+\-]|\d\d)/gi;function r0(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(sY)||["-",0,0],o=+(i[1]*60)+ze(i[2]),o===0?0:i[0]==="+"?o:-o)}function i0(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ji(t)||af(t)?t.valueOf():Ot(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),X.updateOffset(n,!1),n):Ot(t).local()}function dR(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function aY(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=r0(Xp,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=dR(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?Ak(this,Yi(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:dR(this)}function lY(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function uY(t){return this.utcOffset(0,t)}function cY(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(dR(this),"m")),this}function hY(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=r0(OU,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function dY(t){return this.isValid()?(t=t?Ot(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function fY(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function gY(){if(!gr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return BE(t,this),t=Tk(t),t._a?(e=t._isUTC?No(t._a):Ot(t._a),this._isDSTShifted=this.isValid()&&oY(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function mY(){return this.isValid()?!this._isUTC:!1}function pY(){return this.isValid()?this._isUTC:!1}function Ok(){return this.isValid()?this._isUTC&&this._offset===0:!1}var wY=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,vY=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Yi(t,e){var n=t,r=null,i,o,s;return pm(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ss(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=wY.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:ze(r[bo])*i,h:ze(r[Cn])*i,m:ze(r[Fi])*i,s:ze(r[fs])*i,ms:ze(hR(r[El]*1e3))*i}):(r=vY.exec(t))?(i=r[1]==="-"?-1:1,n={y:Aa(r[2],i),M:Aa(r[3],i),w:Aa(r[4],i),d:Aa(r[5],i),h:Aa(r[6],i),m:Aa(r[7],i),s:Aa(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=CY(Ot(n.from),Ot(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Jp(n),pm(t)&&tt(t,"_locale")&&(o._locale=t._locale),pm(t)&&tt(t,"_isValid")&&(o._isValid=t._isValid),o}Yi.fn=Jp.prototype;Yi.invalid=iY;function Aa(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Sx(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function CY(t,e){var n;return t.isValid()&&e.isValid()?(e=i0(e,t),t.isBefore(e)?n=Sx(t,e):(n=Sx(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function xk(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(sk(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Yi(n,r),Ak(this,i,t),this}}function Ak(t,e,n,r){var i=e._milliseconds,o=hR(e._days),s=hR(e._months);t.isValid()&&(r=r??!0,s&&pk(t,Pd(t,"Month")+s*n),o&&fk(t,"Date",Pd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&X.updateOffset(t,o||s))}var yY=xk(1,"add"),bY=xk(-1,"subtract");function Hk(t){return typeof t=="string"||t instanceof String}function SY(t){return ji(t)||af(t)||Hk(t)||Ss(t)||EY(t)||RY(t)||t===null||t===void 0}function RY(t){var e=xl(t)&&!VE(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||tt(t,o);return e&&n}function EY(t){var e=Bi(t),n=!1;return e&&(n=t.filter(function(r){return!Ss(r)&&Hk(t)}).length===0),e&&n}function _Y(t){var e=xl(t)&&!VE(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||tt(t,o);return e&&n}function TY(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function MY(t,e){arguments.length===1&&(arguments[0]?SY(arguments[0])?(t=arguments[0],e=void 0):_Y(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Ot(),r=i0(n,this).startOf("day"),i=X.calendarFormat(this,r)||"sameElse",o=e&&(Do(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Ot(n)))}function IY(){return new lf(this)}function PY(t,e){var n=ji(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function OY(t,e){var n=ji(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function xY(t,e,n,r){var i=ji(t)?t:Ot(t),o=ji(e)?e:Ot(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function AY(t,e){var n=ji(t)?t:Ot(t),r;return this.isValid()&&n.isValid()?(e=wi(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function HY(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function NY(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function DY(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=i0(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=wi(e),e){case"year":o=wm(this,r)/12;break;case"month":o=wm(this,r);break;case"quarter":o=wm(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:oi(o)}function wm(t,e){if(t.date()<e.date())return-wm(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function kY(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function LY(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?mm(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Do(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",mm(n,"Z")):mm(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function $Y(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function FY(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=mm(this,t);return this.localeData().postformat(e)}function VY(t,e){return this.isValid()&&(ji(t)&&t.isValid()||Ot(t).isValid())?Yi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function WY(t){return this.from(Ot(),t)}function BY(t,e){return this.isValid()&&(ji(t)&&t.isValid()||Ot(t).isValid())?Yi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function jY(t){return this.to(Ot(),t)}function Nk(t){var e;return t===void 0?this._locale._abbr:(e=Ts(t),e!=null&&(this._locale=e),this)}var Dk=pi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function kk(){return this._locale}var Ym=1e3,ic=60*Ym,Gm=60*ic,Lk=(365*400+97)*24*Gm;function oc(t,e){return(t%e+e)%e}function $k(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Lk:new Date(t,e,n).valueOf()}function Fk(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Lk:Date.UTC(t,e,n)}function UY(t){var e,n;if(t=wi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Fk:$k,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=oc(e+(this._isUTC?0:this.utcOffset()*ic),Gm);break;case"minute":e=this._d.valueOf(),e-=oc(e,ic);break;case"second":e=this._d.valueOf(),e-=oc(e,Ym);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function zY(t){var e,n;if(t=wi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Fk:$k,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Gm-oc(e+(this._isUTC?0:this.utcOffset()*ic),Gm)-1;break;case"minute":e=this._d.valueOf(),e+=ic-oc(e,ic)-1;break;case"second":e=this._d.valueOf(),e+=Ym-oc(e,Ym)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function YY(){return this._d.valueOf()-(this._offset||0)*6e4}function GY(){return Math.floor(this.valueOf()/1e3)}function qY(){return new Date(this.valueOf())}function KY(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function XY(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function ZY(){return this.isValid()?this.toISOString():null}function QY(){return WE(this)}function JY(){return oa({},Oe(this))}function eG(){return Oe(this).overflow}function tG(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ce("N",0,0,"eraAbbr");Ce("NN",0,0,"eraAbbr");Ce("NNN",0,0,"eraAbbr");Ce("NNNN",0,0,"eraName");Ce("NNNNN",0,0,"eraNarrow");Ce("y",["y",1],"yo","eraYear");Ce("y",["yy",2],0,"eraYear");Ce("y",["yyy",3],0,"eraYear");Ce("y",["yyyy",4],0,"eraYear");ue("N",o0);ue("NN",o0);ue("NNN",o0);ue("NNNN",dG);ue("NNNNN",fG);gt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Oe(n).era=i:Oe(n).invalidEra=t});ue("y",Ic);ue("yy",Ic);ue("yyy",Ic);ue("yyyy",Ic);ue("yo",gG);gt(["y","yy","yyy","yyyy"],Wn);gt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Wn]=n._locale.eraYearOrdinalParse(t,i):e[Wn]=parseInt(t,10)});function nG(t,e){var n,r,i,o=this._eras||Ts("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=X(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=X(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function rG(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function iG(t,e){var n=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*n}function oG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function sG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function aG(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function lG(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-X(i[t].since).year())*n+i[t].offset;return this.year()}function uG(t){return tt(this,"_erasNameRegex")||s0.call(this),t?this._erasNameRegex:this._erasRegex}function cG(t){return tt(this,"_erasAbbrRegex")||s0.call(this),t?this._erasAbbrRegex:this._erasRegex}function hG(t){return tt(this,"_erasNarrowRegex")||s0.call(this),t?this._erasNarrowRegex:this._erasRegex}function o0(t,e){return e.erasAbbrRegex(t)}function dG(t,e){return e.erasNameRegex(t)}function fG(t,e){return e.erasNarrowRegex(t)}function gG(t,e){return e._eraYearOrdinalRegex||Ic}function s0(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Cs(u[i].name),a=Cs(u[i].abbr),l=Cs(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ce(0,["gg",2],0,function(){return this.weekYear()%100});Ce(0,["GG",2],0,function(){return this.isoWeekYear()%100});function ew(t,e){Ce(0,[t,t.length],0,e)}ew("gggg","weekYear");ew("ggggg","weekYear");ew("GGGG","isoWeekYear");ew("GGGGG","isoWeekYear");ue("G",Kp);ue("g",Kp);ue("GG",xt,jr);ue("gg",xt,jr);ue("GGGG",GE,YE);ue("gggg",GE,YE);ue("GGGGG",qp,Yp);ue("ggggg",qp,Yp);cf(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=ze(t)});cf(["gg","GG"],function(t,e,n,r){e[r]=X.parseTwoDigitYear(t)});function mG(t){return Vk.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function pG(t){return Vk.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function wG(){return ys(this.year(),1,4)}function vG(){return ys(this.isoWeekYear(),1,4)}function CG(){var t=this.localeData()._week;return ys(this.year(),t.dow,t.doy)}function yG(){var t=this.localeData()._week;return ys(this.weekYear(),t.dow,t.doy)}function Vk(t,e,n,r,i){var o;return t==null?xd(this,r,i).year:(o=ys(t,r,i),e>o&&(e=o),bG.call(this,t,e,n,r,i))}function bG(t,e,n,r,i){var o=Ck(t,e,n,r,i),s=Od(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ce("Q",0,"Qo","quarter");ue("Q",lk);gt("Q",function(t,e){e[ds]=(ze(t)-1)*3});function SG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ce("D",["DD",2],"Do","date");ue("D",xt,Pc);ue("DD",xt,jr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});gt(["D","DD"],bo);gt("Do",function(t,e){e[bo]=ze(t.match(xt)[0])});var Wk=Oc("Date",!0);Ce("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Gp);ue("DDDD",uk);gt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ze(t)});function RG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ce("m",["mm",2],0,"minute");ue("m",xt,qE);ue("mm",xt,jr);gt(["m","mm"],Fi);var EG=Oc("Minutes",!1);Ce("s",["ss",2],0,"second");ue("s",xt,qE);ue("ss",xt,jr);gt(["s","ss"],fs);var _G=Oc("Seconds",!1);Ce("S",0,0,function(){return~~(this.millisecond()/100)});Ce(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ce(0,["SSS",3],0,"millisecond");Ce(0,["SSSS",4],0,function(){return this.millisecond()*10});Ce(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ce(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ce(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ce(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ce(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Gp,lk);ue("SS",Gp,jr);ue("SSS",Gp,uk);var sa,Bk;for(sa="SSSS";sa.length<=9;sa+="S")ue(sa,Ic);function TG(t,e){e[El]=ze(("0."+t)*1e3)}for(sa="S";sa.length<=9;sa+="S")gt(sa,TG);Bk=Oc("Milliseconds",!1);Ce("z",0,0,"zoneAbbr");Ce("zz",0,0,"zoneName");function MG(){return this._isUTC?"UTC":""}function IG(){return this._isUTC?"Coordinated Universal Time":""}var J=lf.prototype;J.add=yY;J.calendar=MY;J.clone=IY;J.diff=DY;J.endOf=zY;J.format=FY;J.from=VY;J.fromNow=WY;J.to=BY;J.toNow=jY;J.get=$U;J.invalidAt=eG;J.isAfter=PY;J.isBefore=OY;J.isBetween=xY;J.isSame=AY;J.isSameOrAfter=HY;J.isSameOrBefore=NY;J.isValid=QY;J.lang=Dk;J.locale=Nk;J.localeData=kk;J.max=Qz;J.min=Zz;J.parsingFlags=JY;J.set=FU;J.startOf=UY;J.subtract=bY;J.toArray=KY;J.toObject=XY;J.toDate=qY;J.toISOString=LY;J.inspect=$Y;typeof Symbol<"u"&&Symbol.for!=null&&(J[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});J.toJSON=ZY;J.toString=kY;J.unix=GY;J.valueOf=YY;J.creationData=tG;J.eraName=oG;J.eraNarrow=sG;J.eraAbbr=aG;J.eraYear=lG;J.year=dk;J.isLeapYear=LU;J.weekYear=mG;J.isoWeekYear=pG;J.quarter=J.quarters=SG;J.month=wk;J.daysInMonth=qU;J.week=J.weeks=nz;J.isoWeek=J.isoWeeks=rz;J.weeksInYear=CG;J.weeksInWeekYear=yG;J.isoWeeksInYear=wG;J.isoWeeksInISOWeekYear=vG;J.date=Wk;J.day=J.days=pz;J.weekday=wz;J.isoWeekday=vz;J.dayOfYear=RG;J.hour=J.hours=_z;J.minute=J.minutes=EG;J.second=J.seconds=_G;J.millisecond=J.milliseconds=Bk;J.utcOffset=aY;J.utc=uY;J.local=cY;J.parseZone=hY;J.hasAlignedHourOffset=dY;J.isDST=fY;J.isLocal=mY;J.isUtcOffset=pY;J.isUtc=Ok;J.isUTC=Ok;J.zoneAbbr=MG;J.zoneName=IG;J.dates=pi("dates accessor is deprecated. Use date instead.",Wk);J.months=pi("months accessor is deprecated. Use month instead",wk);J.years=pi("years accessor is deprecated. Use year instead",dk);J.zone=pi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",lY);J.isDSTShifted=pi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",gY);function PG(t){return Ot(t*1e3)}function OG(){return Ot.apply(null,arguments).parseZone()}function jk(t){return t}var nt=jE.prototype;nt.calendar=mU;nt.longDateFormat=CU;nt.invalidDate=bU;nt.ordinal=EU;nt.preparse=jk;nt.postformat=jk;nt.relativeTime=TU;nt.pastFuture=MU;nt.set=fU;nt.eras=nG;nt.erasParse=rG;nt.erasConvertYear=iG;nt.erasAbbrRegex=cG;nt.erasNameRegex=uG;nt.erasNarrowRegex=hG;nt.months=UU;nt.monthsShort=zU;nt.monthsParse=GU;nt.monthsRegex=XU;nt.monthsShortRegex=KU;nt.week=QU;nt.firstDayOfYear=tz;nt.firstDayOfWeek=ez;nt.weekdays=hz;nt.weekdaysMin=fz;nt.weekdaysShort=dz;nt.weekdaysParse=mz;nt.weekdaysRegex=Cz;nt.weekdaysShortRegex=yz;nt.weekdaysMinRegex=bz;nt.isPM=Rz;nt.meridiem=Tz;function qm(t,e,n,r){var i=Ts(),o=No().set(r,e);return i[n](o,t)}function Uk(t,e,n){if(Ss(t)&&(e=t,t=void 0),t=t||"",e!=null)return qm(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=qm(t,r,n,"month");return i}function a0(t,e,n,r){typeof t=="boolean"?(Ss(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ss(e)&&(n=e,e=void 0),e=e||"");var i=Ts(),o=t?i._week.dow:0,s,a=[];if(n!=null)return qm(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=qm(e,(s+o)%7,r,"day");return a}function xG(t,e){return Uk(t,e,"months")}function AG(t,e){return Uk(t,e,"monthsShort")}function HG(t,e,n){return a0(t,e,n,"weekdays")}function NG(t,e,n){return a0(t,e,n,"weekdaysShort")}function DG(t,e,n){return a0(t,e,n,"weekdaysMin")}da("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ze(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});X.lang=pi("moment.lang is deprecated. Use moment.locale instead.",da);X.langData=pi("moment.langData is deprecated. Use moment.localeData instead.",Ts);var Wo=Math.abs;function kG(){var t=this._data;return this._milliseconds=Wo(this._milliseconds),this._days=Wo(this._days),this._months=Wo(this._months),t.milliseconds=Wo(t.milliseconds),t.seconds=Wo(t.seconds),t.minutes=Wo(t.minutes),t.hours=Wo(t.hours),t.months=Wo(t.months),t.years=Wo(t.years),this}function zk(t,e,n,r){var i=Yi(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function LG(t,e){return zk(this,t,e,1)}function $G(t,e){return zk(this,t,e,-1)}function Rx(t){return t<0?Math.floor(t):Math.ceil(t)}function FG(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=Rx(fR(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=oi(t/1e3),r.seconds=i%60,o=oi(i/60),r.minutes=o%60,s=oi(o/60),r.hours=s%24,e+=oi(s/24),l=oi(Yk(e)),n+=l,e-=Rx(fR(l)),a=oi(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function Yk(t){return t*4800/146097}function fR(t){return t*146097/4800}function VG(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=wi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+Yk(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(fR(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function Ms(t){return function(){return this.as(t)}}var Gk=Ms("ms"),WG=Ms("s"),BG=Ms("m"),jG=Ms("h"),UG=Ms("d"),zG=Ms("w"),YG=Ms("M"),GG=Ms("Q"),qG=Ms("y"),KG=Gk;function XG(){return Yi(this)}function ZG(t){return t=wi(t),this.isValid()?this[t+"s"]():NaN}function ql(t){return function(){return this.isValid()?this._data[t]:NaN}}var QG=ql("milliseconds"),JG=ql("seconds"),e2=ql("minutes"),t2=ql("hours"),n2=ql("days"),r2=ql("months"),i2=ql("years");function o2(){return oi(this.days()/7)}var ss=Math.round,Zu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function s2(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function a2(t,e,n,r){var i=Yi(t).abs(),o=ss(i.as("s")),s=ss(i.as("m")),a=ss(i.as("h")),l=ss(i.as("d")),u=ss(i.as("M")),c=ss(i.as("w")),h=ss(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,s2.apply(null,d)}function l2(t){return t===void 0?ss:typeof t=="function"?(ss=t,!0):!1}function u2(t,e){return Zu[t]===void 0?!1:e===void 0?Zu[t]:(Zu[t]=e,t==="s"&&(Zu.ss=e-1),!0)}function c2(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Zu,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Zu,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=a2(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Iy=Math.abs;function iu(t){return(t>0)-(t<0)||+t}function tw(){if(!this.isValid())return this.localeData().invalidDate();var t=Iy(this._milliseconds)/1e3,e=Iy(this._days),n=Iy(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=oi(t/60),i=oi(r/60),t%=60,r%=60,o=oi(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=iu(this._months)!==iu(a)?"-":"",c=iu(this._days)!==iu(a)?"-":"",h=iu(this._milliseconds)!==iu(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Xe=Jp.prototype;Xe.isValid=rY;Xe.abs=kG;Xe.add=LG;Xe.subtract=$G;Xe.as=VG;Xe.asMilliseconds=Gk;Xe.asSeconds=WG;Xe.asMinutes=BG;Xe.asHours=jG;Xe.asDays=UG;Xe.asWeeks=zG;Xe.asMonths=YG;Xe.asQuarters=GG;Xe.asYears=qG;Xe.valueOf=KG;Xe._bubble=FG;Xe.clone=XG;Xe.get=ZG;Xe.milliseconds=QG;Xe.seconds=JG;Xe.minutes=e2;Xe.hours=t2;Xe.days=n2;Xe.weeks=o2;Xe.months=r2;Xe.years=i2;Xe.humanize=c2;Xe.toISOString=tw;Xe.toString=tw;Xe.toJSON=tw;Xe.locale=Nk;Xe.localeData=kk;Xe.toIsoString=pi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",tw);Xe.lang=Dk;Ce("X",0,0,"unix");Ce("x",0,0,"valueOf");ue("x",Kp);ue("X",xU);gt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});gt("x",function(t,e,n){n._d=new Date(ze(t))});//! moment.js
X.version="2.30.1";hU(Ot);X.fn=J;X.min=Jz;X.max=eY;X.now=tY;X.utc=No;X.unix=PG;X.months=xG;X.isDate=af;X.locale=da;X.invalid=zp;X.duration=Yi;X.isMoment=ji;X.weekdays=HG;X.parseZone=OG;X.localeData=Ts;X.isDuration=pm;X.monthsShort=AG;X.weekdaysMin=DG;X.defineLocale=JE;X.updateLocale=Oz;X.locales=xz;X.weekdaysShort=NG;X.normalizeUnits=wi;X.relativeTimeRounding=l2;X.relativeTimeThreshold=u2;X.calendarFormat=TY;X.prototype=J;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function qk(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function gR(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function id(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function gn(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function va(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Be(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function I(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function Kk(t){return gn(t,(e,n)=>e+n,0)}function h2(t){return gn(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function d2(t){return gn(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function f2(t){return t.length?Kk(t)/t.length:0}function Xk(t){return gn(t,(e,n)=>e.concat(Array.isArray(n)?Xk(n):n),[])}function Zk(t){const e=[];return I(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function mR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return I(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function g2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return I(i,s=>{o=o.filter(a=>s.includes(a))}),o}function m2(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return I(i,s=>{I(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function pR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const p2=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:f2,arrayEach:I,arrayFilter:va,arrayFlatten:Xk,arrayMap:Be,arrayMax:h2,arrayMin:d2,arrayReduce:gn,arraySum:Kk,arrayUnique:Zk,extendArray:gR,getDifferenceOfArrays:mR,getIntersectionOfArrays:g2,getUnionOfArrays:m2,pivot:id,stringToArray:pR,to2dArray:qk},Symbol.toStringTag,{value:"Module"}));function ot(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return gn(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function yt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ae(t){return typeof t<"u"}function Pt(t){return typeof t>"u"}function Wt(t){return t===null||t===""||Pt(t)}function Qk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Gh="length",od=t=>parseInt(t,16),Ex=t=>parseInt(t,10),Km=(t,e,n)=>t.substr(e,n),sd=t=>t.codePointAt(0)-65,wR=t=>`${t}`.replace(/\-/g,""),w2=t=>od(Km(wR(t),od("12"),sd("F")))/(od(Km(wR(t),sd("B"),~~![][Gh]))||9),v2=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _x=!1;const Tx={invalid:()=>ot`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ot`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ot`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Mx={invalid:()=>ot`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ot`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ot`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Jk(t,e){const n=!Wt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=wR(t||"");const l=C2(t);if(n||r||l)if(l){const u=X("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=w2(t);o=X((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(v2()&&(s="valid",a="valid"),!_x&&s!=="valid"&&(Tx[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Tx[s]({keyValidityDate:o,hotVersion:i})),_x=!0),a!=="valid"&&e.parentNode&&Mx[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=Mx[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function C2(t){let e=[][Gh],n=e;if(t[Gh]!==sd("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=sd(i.shift());o;o=sd(i.shift()||"A"))--o<""[Gh]?n=n|(Ex(`${Ex(od(r)+(od(Km(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Km(t,o,o?i[Gh]===1?9:8:6);return n===e}const y2=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Jk,isDefined:ae,isEmpty:Wt,isRegExp:Qk,isUndefined:Pt,stringify:yt},Symbol.toStringTag,{value:"Module"}));function Bn(t){return t[0].toUpperCase()+t.substr(1)}function b2(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=yt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function l0(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function u0(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function c0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function vR(t){return nw(`${t}`,{ALLOWED_TAGS:[]})}function nw(t,e){return cU.sanitize(t,e)}const S2=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:b2,isPercentValue:u0,randomString:l0,sanitize:nw,stripTags:vR,substitute:c0,toUpperCaseFirst:Bn},Symbol.toStringTag,{value:"Module"})),Kl=t=>["tabindex",t],R2=()=>["role","treegrid"],gs=()=>["role","presentation"],E2=()=>["role","gridcell"],_2=()=>["role","rowheader"],eL=()=>["role","rowgroup"],T2=()=>["role","columnheader"],CR=()=>["role","row"],M2=()=>["role","menu"],I2=()=>["role","menuitem"],P2=()=>["role","menuitemcheckbox"],O2=()=>["role","combobox"],tL=()=>["role","listbox"],x2=()=>["role","option"],A2=()=>["role","checkbox"],H2=()=>["scope","col"],N2=()=>["scope","row"],D2=()=>["type","text"],Hd=t=>["aria-label",t],Xl=()=>["aria-hidden","true"],k2=()=>["aria-disabled","true"],L2=()=>["aria-multiselectable","true"],nL=t=>["aria-haspopup",t],rL=t=>["aria-rowcount",t],rw=t=>["aria-colcount",t],iL=t=>["aria-rowindex",t],h0=t=>["aria-colindex",t],li=t=>["aria-expanded",t],$2=t=>["aria-sort",t],Ix=()=>["aria-readonly","true"],Px=()=>["aria-invalid","true"],oL=t=>["aria-checked",t],d0=()=>["aria-selected","true"],F2=()=>["aria-autocomplete","list"],V2=t=>["aria-controls",t],W2=t=>["aria-activedescendant",t],B2=t=>["aria-live",t],j2=t=>["aria-relevant",t],U2=t=>["aria-setsize",t],z2=t=>["aria-posinset",t];function sL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function ad(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function aL(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Nl(t){return aL(t)&&t.parent}function Y2(t){return!!Object.getPrototypeOf(t.parent)}function Ca(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function qh(t,e,n){const r=[];let i=t;for(;i&&(i=Ca(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function lL(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function fa(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function uL(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Ys(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function cL(t){return!t||!t.length?[]:t.filter(e=>!!e)}function hL(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=cL(e),e.length>0&&t.classList.add(...e)}function pe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=hL(e,!0);n=cL(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Zl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=hL(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function f0(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)f0(e[n])}}function xo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const dL=/(<(.*)>|&(.*);)/;function Ql(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;dL.test(e)?t.innerHTML=n?nw(e):e:ya(t,e)}function ya(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(xo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Dl(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Dl(r.host.impl);if(r.host)return Dl(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function fL(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Pn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function g0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function iw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ow(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?g0(e):t.scrollTop}function m0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?iw(e):t.scrollLeft}function Nd(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function gL(t){return t.scrollHeight-t.clientHeight}function mL(t){return t.scrollWidth-t.clientWidth}function dc(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Dd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function G2(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Kt(t){return t.offsetWidth}function en(t){return t.offsetHeight}function sc(t){return t.clientHeight||t.innerHeight}function p0(t){return t.clientWidth||t.innerWidth}function q2(t,e,n){t.addEventListener(e,n,!1)}function K2(t,e,n){t.removeEventListener(e,n,!1)}function w0(t){return t.selectionStart?t.selectionStart:0}function pL(t){return t.selectionEnd?t.selectionEnd:0}function X2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function yR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function hf(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Py;function Z2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function yn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Py===void 0&&(Py=Z2(t)),Py}function v0(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function C0(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function sw(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Q2(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function df(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function ld(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function aw(t){return ld(t)&&t.hasAttribute("data-hot-input")===!1}function J2(t){const e=t.ownerDocument.activeElement;aw(e)||t.select()}function y0(t){return!t.parentNode}function wL(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function b0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ye(t,"contenteditable",!0),n&&ye(t,...Xl()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function S0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&pe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function vL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;b0(t,n),e(),S0(t,n)}function To(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const eq=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:dL,addClass:q,addEvent:q2,clearTextSelection:yR,closest:Ca,closestDown:qh,empty:xo,fastInnerHTML:Ql,fastInnerText:ya,findFirstParentWithClass:lL,getCaretPosition:w0,getCssTransform:Q2,getFrameElement:aL,getMaximumScrollLeft:mL,getMaximumScrollTop:gL,getParent:sL,getParentWindow:Nl,getScrollLeft:m0,getScrollTop:ow,getScrollableElement:Nd,getScrollbarWidth:yn,getSelectionEndPosition:pL,getSelectionText:X2,getStyle:Dd,getTrimmingContainer:dc,getWindowScrollLeft:iw,getWindowScrollTop:g0,hasAccessToParentWindow:Y2,hasClass:we,hasHorizontalScrollbar:C0,hasVerticalScrollbar:v0,hasZeroHeight:fL,index:uL,innerHeight:sc,innerWidth:p0,isChildOf:fa,isDetached:y0,isHTMLElement:To,isInput:ld,isInternalElement:ad,isOutsideInput:aw,isVisible:Dl,makeElementContentEditableAndSelectItsContent:b0,matchesCSSRules:G2,observeVisibilityChangeOnce:wL,offset:Pn,outerHeight:en,outerWidth:Kt,overlayContainsElement:Ys,removeAttribute:Zl,removeClass:pe,removeContentEditableFromElementAndDeselect:S0,removeEvent:K2,removeTextNodes:f0,resetCssTransform:df,runWithSelectedContendEditableElement:vL,selectElementIfAllowed:J2,setAttribute:ye,setCaretPosition:hf,setOverlayPosition:sw},Symbol.toStringTag,{value:"Module"}));function it(t){return typeof t=="function"}function CL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function tq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=CL(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function ff(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function nq(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return gn(i,(u,c)=>c(u),r.apply(this,a))}}function R0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function yL(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function rq(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Xm(t,e,n,r,i,o,s,a){return ae(a)?t.call(e,n,r,i,o,s,a):ae(s)?t.call(e,n,r,i,o,s):ae(o)?t.call(e,n,r,i,o):ae(i)?t.call(e,n,r,i):ae(r)?t.call(e,n,r):ae(n)?t.call(e,n):t.call(e)}const iq=Object.freeze(Object.defineProperty({__proto__:null,curry:yL,curryRight:rq,debounce:ff,fastCall:Xm,isFunction:it,partial:R0,pipe:nq,throttle:CL,throttleAfterHits:tq},Symbol.toStringTag,{value:"Module"}));var Ox={},Oy,xx;function oq(){if(xx)return Oy;xx=1;var t=rn(),e=$D(),n=dn(),r=jl(),i=Up(),o=t([].push);return Oy=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,g){if(d)return d=!1,g;if(e(this))return g;for(var C=0;C<h;C++)if(l[C]===f)return g}}},Oy}var Ax;function sq(){if(Ax)return Ox;Ax=1;var t=pt(),e=Rc(),n=rf(),r=hn(),i=rn(),o=cn(),s=dn(),a=TE(),l=FE(),u=oq(),c=_E(),h=String,d=e("JSON","stringify"),f=i(/./.exec),g=i("".charAt),C=i("".charCodeAt),y=i("".replace),E=i(1.1.toString),p=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,P=/^[\uDC00-\uDFFF]$/,D=!c||o(function(){var U=e("Symbol")("stringify detection");return d([U])!=="[null]"||d({a:U})!=="{}"||d(Object(U))!=="{}"}),M=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),x=function(U,B){var Z=l(arguments),Q=u(B);if(!(!s(Q)&&(U===void 0||a(U))))return Z[1]=function(se,te){if(s(Q)&&(te=r(Q,this,h(se),te)),!a(te))return te},n(d,null,Z)},Y=function(U,B,Z){var Q=g(Z,B-1),se=g(Z,B+1);return f(_,U)&&!f(P,se)||f(P,U)&&!f(_,Q)?"\\u"+E(C(U,0),16):U};return d&&t({target:"JSON",stat:!0,arity:3,forced:D||M},{stringify:function(B,Z,Q){var se=l(arguments),te=n(D?x:d,null,se);return M&&typeof te=="string"?y(te,p,Y):te}}),Ox}sq();function fc(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ae(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=fc(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[fc(n[0])]:e[r]=[]:e[r]=null)})),e}function bL(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function tn(t,e,n){const r=Array.isArray(n);return Ae(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function gf(t,e){Ae(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),gf(t[r],e[r])):t[r]=e[r]})}function jn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ui(t){const e={};return Ae(t,(n,r)=>{e[r]=n}),e}function ut(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return I(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ae(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=g=>{let C=g;return(Array.isArray(C)||xe(C))&&(C=jn(C)),C};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function lw(t,e){return JSON.stringify(t)===JSON.stringify(e)}function xe(t){return Object.prototype.toString.call(t)==="[object Object]"}function ko(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ae(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function SL(t,e){const n=e.split(".");let r=t;return Ae(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function vm(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(Jt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function uw(t){if(!xe(t))return 0;const e=function(n){let r=0;return xe(n)?Ae(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Rr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Jt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const aq=Object.freeze(Object.defineProperty({__proto__:null,clone:Ui,createObjectPropListener:Rr,deepClone:jn,deepExtend:gf,deepObjectSize:uw,defineGetter:ko,duckSchema:fc,extend:tn,getProperty:SL,hasOwnProperty:Jt,inherit:bL,isObject:xe,isObjectEqual:lw,mixin:ut,objectEach:Ae,setProperty:vm},Symbol.toStringTag,{value:"Module"}));function kd(t){return window.requestAnimationFrame(t)}function Ld(t){window.cancelAnimationFrame(t)}function E0(){return"ontouchstart"in window}function RL(){return typeof window<"u"}let ou;function EL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ou||(typeof Intl=="object"?ou=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ou=(n,r)=>`${n}`.localeCompare(r):ou=(n,r)=>n===r?0:n>r?-1:1,ou)}const lq=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Ld,getComparisonFunction:EL,isCSR:RL,isTouchSupported:E0,requestAnimationFrame:kd},Symbol.toStringTag,{value:"Module"})),ei=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Is={chrome:ei((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ei(t=>/CriOS/.test(t)),edge:ei(t=>/Edge/.test(t)),edgeWebKit:ei(t=>/EdgiOS/.test(t)),firefox:ei(t=>/Firefox/.test(t)),firefoxWebKit:ei(t=>/FxiOS/.test(t)),mobile:ei(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ei((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},xc={mac:ei(t=>/^Mac/.test(t)),win:ei(t=>/^Win/.test(t)),linux:ei(t=>/^Linux/.test(t)),ios:ei(t=>/iPhone|iPad|iPod/i.test(t))};function _L(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(Is,n=>{let{test:r}=n;return void r(t,e)})}function TL(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ae(xc,e=>{let{test:n}=e;return void n(t)})}RL()&&(_L(),TL());function _0(){return Is.chrome.value}function ML(){return Is.chromeWebKit.value}function Cm(){return Is.firefox.value}function IL(){return Is.firefoxWebKit.value}function $d(){return Is.safari.value}function PL(){return Is.edge.value}function uq(){return Is.edgeWebKit.value}function _o(){return Is.mobile.value}function T0(){return xc.ios.value}function M0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&xc.mac.value}function bR(){return xc.win.value}function Zm(){return xc.mac.value}function cq(){return xc.linux.value}const hq=Object.freeze(Object.defineProperty({__proto__:null,isChrome:_0,isChromeWebKit:ML,isEdge:PL,isEdgeWebKit:uq,isFirefox:Cm,isFirefoxWebKit:IL,isIOS:T0,isIpadOS:M0,isLinuxOS:cq,isMacOS:Zm,isMobileBrowser:_o,isSafari:$d,isWindowsOS:bR,setBrowserMeta:_L,setPlatformMeta:TL},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Cm()?182:174,AUDIO_MUTE:Cm()?181:173,AUDIO_UP:Cm()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},dq=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function OL(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function I0(t){return dq.includes(t)}function fq(t){const e=[];return Zm()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function xL(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function Ac(t,e){const n=e.split("|");let r=!1;return I(n,i=>{if(t===de[i])return r=!0,!1}),r}const gq=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:fq,isCtrlMetaKey:xL,isFunctionKey:I0,isKey:Ac,isPrintableChar:OL},Symbol.toStringTag,{value:"Module"}));function vi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function ea(t){return t.isImmediatePropagationEnabled===!1}function ba(t){return t.button===2}function cw(t){return t.button===0}function AL(t){return t instanceof TouchEvent}function HL(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!To(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const mq=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:ea,isLeftClick:cw,isRightClick:ba,isTouchEvent:AL,offsetRelativeTo:HL,stopImmediatePropagation:vi},Symbol.toStringTag,{value:"Module"}));function Je(){ae(console)&&console.warn(...arguments)}function P0(){ae(console)&&console.error(...arguments)}const yl=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],xy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Ay=new Map([[]]);var Hx={},Hy,Nx;function pq(){if(Nx)return Hy;Nx=1;var t=Tc();return Hy=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},Hy}var Ny,Dx;function wq(){if(Dx)return Ny;Dx=1;var t=nn();return Ny=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},Ny}var Dy,kx;function hw(){if(kx)return Dy;kx=1;var t=zi(),e=kE(),n=Ta().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),Dy=function(o){i[r][o]=!0},Dy}var Lx;function vq(){if(Lx)return Hx;Lx=1;var t=pt(),e=rn(),n=Er(),r=Jd(),i=pq(),o=wq(),s=hw(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),Hx}vq();var $x={},Fx={},Vx;function Cq(){if(Vx)return Fx;Vx=1;var t=pt(),e=hn(),n=Mc(),r=Er(),i=fn(),o=Ho(),s=_r(),a=Ma(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),Fx}var Wx;function yq(){return Wx||(Wx=1,Cq()),$x}yq();function bq(t,e){NL(t,e),e.add(t)}function ky(t,e,n){NL(t,e),e.set(t,n)}function NL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bx(t,e,n){return t.set(Qm(t,e),n),n}function In(t,e){return t.get(Qm(t,e))}function Qm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sq=100;var xr=new WeakMap,Uu=new WeakMap,Ly=new WeakMap,$y=new WeakSet;class jx{constructor(){bq(this,$y),ky(this,xr,new Map),ky(this,Uu,new Map),ky(this,Ly,new Set),yl.forEach(e=>Qm($y,this,Ux).call(this,e))}getHooks(e){var n;return(n=In(xr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};In(xr,this).has(e)||(Qm($y,this,Ux).call(this,e),yl.push(e));const i=In(xr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=In(Ly,this).has(e);!u&&o!==0&&(u=!0,In(Ly,this).add(e)),u&&i.length>1&&In(xr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return In(xr,this).has(e)&&In(xr,this).get(e).length>0}remove(e,n){if(!In(xr,this).has(e))return!1;const r=In(xr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=In(Uu,this).get(e);return i.skip=!0,o+=1,o>Sq&&(In(xr,this).set(e,r.filter(s=>!s.skip)),o=0),In(Uu,this).set(e,o),!0}return!1}destroy(){In(xr,this).clear(),In(Uu,this).clear(),Bx(xr,this,null),Bx(Uu,this,null)}}function Ux(t){In(xr,this).set(t,[]),In(Uu,this).set(t,0)}function Rq(t,e,n){return(e=Eq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eq(t){var e=_q(t,"string");return typeof e=="symbol"?e:e+""}function _q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tq=ot`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ie{constructor(){Rq(this,"globalBucket",new jx)}static getSingleton(){return Iq()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new jx),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?I(n,o=>this.add(e,o,r)):(xy.has(e)&&Je(c0(Tq,{hookName:e,removedInVersion:xy.get(e)})),Ay.has(e)&&Je(Ay.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?I(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?I(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Xm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Xm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||yl.push(e)}deregister(e){this.isRegistered(e)&&yl.splice(yl.indexOf(e),1)}isDeprecated(e){return Ay.has(e)||xy.has(e)}isRegistered(e){return yl.indexOf(e)>=0}getRegistered(){return yl}}const Mq=new ie;function Iq(){return Mq}const Fy=new Map;function Gi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Fy.has(t)||Fy.set(t,new Map);const e=Fy.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const SR=new WeakMap,{register:Pq,getItem:DL,hasItem:kL,getNames:Oq,getValues:dde}=Gi("editors");function xq(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function LL(t,e){let n;if(typeof t=="function")SR.get(t)||mr(null,t),n=SR.get(t);else if(typeof t=="string")n=DL(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Jm(t){if(typeof t=="function")return t;if(!kL(t))throw Error(`No registered editor found under "${t}" name`);return DL(t).getConstructor()}function mr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new xq(e);typeof t=="string"&&Pq(t,n),SR.set(e,n)}function Aq(t,e,n){return(e=Hq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hq(t){var e=Nq(t,"string");return typeof e=="symbol"?e:e+""}function Nq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let ym=0;class di{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Aq(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,Dq(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),ym+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),ym-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),ym-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function Dq(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),vi(this)},t}function kq(){return ym}function Lq(t,e){$q(t,e),e.add(t)}function $q(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ha(t,e,n){return(e=Fq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fq(t){var e=Vq(t,"string");return typeof e=="symbol"?e:e+""}function Vq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Df=new WeakSet;class RR{constructor(e,n,r){Lq(this,Df),Ha(this,"hot",void 0),Ha(this,"tableMeta",void 0),Ha(this,"selection",void 0),Ha(this,"eventManager",void 0),Ha(this,"destroyed",!1),Ha(this,"activeEditor",void 0),Ha(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new di(e),this.hot.addHook("afterDocumentKeyDown",i=>Vy(Df,this,zx).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Vy(Df,this,zx).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Vy(Df,this,Wq).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=LL(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function zx(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||ea(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!I0(n)&&!xL(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function Wq(t,e){e.isCell()&&this.openEditor(null,t,!0)}const Yx=new WeakMap;RR.getInstance=function(t,e,n){let r=Yx.get(t);return r||(r=new RR(t,e,n),Yx.set(t,r)),r};function Bq(t,e){$L(t,e),e.add(t)}function Kc(t,e,n){$L(t,e),e.set(t,n)}function $L(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(cs(t,e))}function Xc(t,e,n){return t.set(cs(t,e),n),n}function cs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ac=Object.freeze({CELL:"cell",MIXED:"mixed"});var un=new WeakMap,kf=new WeakMap,Lf=new WeakMap,$f=new WeakMap,Ff=new WeakMap,Ks=new WeakSet;class jq{constructor(e){var n=this;Bq(this,Ks),Kc(this,un,void 0),Kc(this,kf,void 0),Kc(this,Lf,1),Kc(this,$f,null),Kc(this,Ff,new Map);const r=e.getSettings();Xc(un,this,e),Xc(kf,this,r.imeFastEdit?ac.MIXED:ac.CELL),vt(un,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Ks,n,zq).call(n,...o)}),vt(un,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Ks,n,Gx).call(n,...o)}),vt(un,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Ks,n,Gx).call(n,...o)}),vt(un,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return cs(Ks,n,Uq).call(n,...o)})}getFocusMode(){return vt(kf,this)}setFocusMode(e){Object.values(ac).includes(e)?Xc(kf,this,e):Je(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vt(Lf,this)}setRefocusDelay(e){Xc(Lf,this,e)}setRefocusElementGetter(e){Xc($f,this,e)}getRefocusElement(){var e;return typeof vt($f,this)=="function"?vt($f,this).call(this):(e=vt(un,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=vt(un,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=vt(un,this).runHooks("modifyFocusedElement",s.row,s.col,r);To(a)||(a=r),a&&!((o=vt(un,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):cs(Ks,this,O0).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vt(Lf,this);if(vt(un,this).getSettings().imeFastEdit&&!((e=vt(un,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=vt(un,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),vt(Ff,this).has(n)||vt(Ff,this).set(n,ff(()=>{if(!vt(un,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),vt(Ff,this).get(n)()}}}function O0(t){var e;const n=(e=vt(un,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!vt(un,this).selection.isCellVisible(n)){t(null);return}const r=vt(un,this).getCell(n.row,n.col,!0);r===null?vt(un,this).addHookOnce("afterScroll",()=>{t(vt(un,this).getCell(n.row,n.col,!0))}):t(r)}function Gx(){cs(Ks,this,O0).call(this,t=>{const{activeElement:e}=vt(un,this).rootDocument;e&&aw(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Uq(){cs(Ks,this,O0).call(this,t=>{this.getFocusMode()===ac.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function zq(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?ac.MIXED:ac.CELL)}var qx={},Wy,Kx;function Yq(){if(Kx)return Wy;Kx=1;var t=gi(),e=jl(),n=zi(),r=n("match");return Wy=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},Wy}var By,Xx;function Gq(){if(Xx)return By;Xx=1;var t=nn(),e=cn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return By={correct:r},By}var jy,Zx;function qq(){if(Zx)return jy;Zx=1;var t=fn();return jy=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},jy}var Uy,Qx;function Kq(){if(Qx)return Uy;Qx=1;var t=hn(),e=mi(),n=ef(),r=Gq(),i=qq(),o=RegExp.prototype;return Uy=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},Uy}var zy,Jx;function Xq(){if(Jx)return zy;Jx=1;var t=rn(),e=Ec(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return zy=function(l,u,c,h,d,f){var g=c+l.length,C=h.length,y=a;return d!==void 0&&(d=e(d),y=s),i(f,y,function(E,p){var _;switch(r(p,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,g);case"<":_=d[o(p,1,-1)];break;default:var P=+p;if(P===0)return E;if(P>C){var D=n(P/10);return D===0?E:D<=C?h[D-1]===void 0?r(p,1):h[D-1]+r(p,1):E}_=h[P-1]}return _===void 0?"":_})},zy}var e1;function Zq(){if(e1)return qx;e1=1;var t=pt(),e=hn(),n=rn(),r=Qd(),i=dn(),o=gi(),s=Yq(),a=Up(),l=tf(),u=Kq(),c=Xq(),h=zi(),d=_a(),f=h("replace"),g=TypeError,C=n("".indexOf),y=n("".replace),E=n("".slice),p=Math.max;return t({target:"String",proto:!0},{replaceAll:function(P,D){var M=r(this),x,Y,U,B,Z,Q,se,te,le,ct,be=0,He="";if(o(P)){if(x=s(P),x&&(Y=a(r(u(P))),!~C(Y,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(U=l(P,f),U)return e(U,P,M,D);if(d&&x)return y(a(M),P,D)}for(B=a(M),Z=a(P),Q=i(D),Q||(D=a(D)),se=Z.length,te=p(1,se),le=C(B,Z);le!==-1;)ct=Q?a(D(Z,le,B)):c(Z,B,le,[],void 0,D),He+=E(B,be,le)+ct,be=le+se,le=le+te>B.length?-1:C(B,Z,le+te);return be<B.length&&(He+=E(B,be)),He}}),qx}Zq();var t1={},n1={},r1;function Qq(){if(r1)return n1;r1=1;var t=pt(),e=Mc(),n=Er(),r=fn(),i=Ho(),o=_r(),s=Ma(),a=rf(),l=cn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(p){o(this,"throw",p)}var g=arguments.length<2,C=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,C]);var y=i(this),E=0;if(e(y,function(p){g?(g=!1,C=p):C=f(C,p,E),E++},{IS_RECORD:!0}),g)throw new u("Reduce of empty iterator with no initial value");return C}}),n1}var i1;function Jq(){return i1||(i1=1,Qq()),t1}Jq();const FL={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},eK=new RegExp(Object.keys(FL).map(t=>`(${t})`).join("|"),"gi");function tK(t){return(t&&t.nodeName||"")==="TABLE"}function ER(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,g=[];for(let y=0;y<s;y+=1){const E=!f&&n&&y===0;let p="";if(f)p=`<th>${t.getColHeader(y-c)}</th>`;else if(E)p=`<th>${t.getRowHeader(d-h)}</th>`;else{const _=i[d][y],{hidden:P,rowspan:D,colspan:M}=t.getCellMeta(d-h,y-c);if(!P){const x=[];if(D&&x.push(`rowspan="${D}"`),M&&x.push(`colspan="${M}"`),Wt(_))p=`<td ${x.join(" ")}></td>`;else{const Y=_.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");p=`<td ${x.join(" ")}>${Y}</td>`}}}g.push(p)}const C=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function _R(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Wt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function VL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const _=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,P=>{const D=P.match(/<td\b[^>]*?>/g)[0],M=/<p.*?>/g,x=P.substring(D.length,P.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(M,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${D}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${_}`),o=i.querySelector("table")}if(!o||!tK(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((_,P)=>_+P.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const _=Array.from(o.tHead.rows).filter(P=>{const D=P.querySelector("td")!==null;return D&&h.push(P),!D});f=_.length,d=f>0,f>1?n.nestedHeaders=Array.from(_).reduce((P,D)=>{const M=Array.from(D.cells).reduce((x,Y,U)=>{if(a&&U===0)return x;const{colSpan:B,innerHTML:Z}=Y,Q=B>1?{label:Z,colspan:B}:Z;return x.push(Q),x},[]);return P.push(M),P},[]):d&&(n.colHeaders=Array.from(_[0].children).reduce((P,D,M)=>(a&&M===0||P.push(D.innerHTML),P),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((_,P)=>(_.push(...Array.from(P.rows)),_),[]),...c];g=C.length;const y=new Array(g);for(let _=0;_<g;_++)y[_]=new Array(u);const E=[],p=[];for(let _=0;_<g;_++){const P=C[_],D=Array.from(P.cells),M=D.length;for(let x=0;x<M;x++){const Y=D[x],{nodeName:U,innerHTML:B,rowSpan:Z,colSpan:Q}=Y,se=y[_].findIndex(te=>te===void 0);if(U==="TD"){if(Z>1||Q>1){for(let be=_;be<_+Z;be++)if(be<g)for(let He=se;He<se+Q;He++)y[be][He]=null;const le=Y.getAttribute("style");le&&le.includes("mso-ignore:colspan")||E.push({col:se,row:_,rowspan:Z,colspan:Q})}let te="";s&&/excel/gi.test(s.content)?te=B.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):te=B.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[_][se]=te.replace(eK,le=>FL[le])}else p.push(B)}}return E.length&&(n.mergeCells=E),p.length&&(n.rowHeaders=p),y.length&&(n.data=y),n}const nK=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:_R,htmlToGridSettings:VL,instanceToHTML:ER},Symbol.toStringTag,{value:"Module"}));function Fn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function WL(t){return Fn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function TR(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function x0(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ue(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const rK=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ue,isNumeric:Fn,isNumericLike:WL,rangeEach:fe,rangeEachReverse:TR,valueAccordingPercent:x0},Symbol.toStringTag,{value:"Module"})),MR="asc",iK="desc",o1=new Map([[MR,[-1,1]],[iK,[1,-1]]]),oK=t=>`The priority '${t}' is already declared in a map.`,sK=t=>`The priority '${t}' is not a number.`;function aK(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=it(t)?t:oK,e=it(e)?e:sK;function r(o,s){if(!Fn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MR;const[s,a]=o1.get(o)||o1.get(MR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const lK=t=>`The id '${t}' is already declared in a map.`;function dw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=it(t)?t:lK;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const uK=t=>`'${t}' value is already declared in a unique set.`;function cK(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=it(t)?t:uK;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const A0=t=>`There is already registered "${t}" plugin.`,hK=t=>`There is already registered plugin on priority "${t}".`,dK=t=>`The priority "${t}" is not a number.`,BL=aK({errorPriorityExists:hK,errorPriorityNaN:dK}),jL=cK({errorItemExists:A0}),IR=dw({errorIdExists:A0});function H0(){return[...BL.getItems(),...jL.getItems()]}function mf(t){const e=Bn(t);return IR.getItem(e)}function fK(t){return!!mf(t)}function Ye(t,e,n){[t,e,n]=mK(t,e,n),mf(t)===void 0&&gK(t,e,n)}function gK(t,e,n){const r=Bn(t);if(IR.hasItem(r))throw new Error(A0(r));n===void 0?jL.addItem(r):BL.addItem(n,r),IR.addItem(r,e)}function mK(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:pK,getItem:wK,hasItem:UL,getNames:vK,getValues:fde}=Gi("renderers");function ep(t){if(typeof t=="function")return t;if(!UL(t))throw Error(`No registered renderer found under "${t}" name`);return wK(t)}function Nr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),pK(t,e)}const{register:CK,getItem:yK,hasItem:zL,getNames:bK,getValues:gde}=Gi("validators");function N0(t){if(typeof t=="function")return t;if(!zL(t))throw Error(`No registered validator found under "${t}" name`);return yK(t)}function bl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),CK(t,e)}var s1={},a1;function SK(){if(a1)return s1;a1=1;var t=pt(),e=Ec(),n=Tc(),r=nf(),i=hw();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),s1}SK();var l1={},u1;function RK(){if(u1)return l1;u1=1;var t=pt(),e=rn(),n=Qd(),r=nf(),i=Up(),o=cn(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),l1}RK();function Zc(t,e,n){return(e=EK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TK{constructor(){Zc(this,"count",0),Zc(this,"startColumn",null),Zc(this,"endColumn",null),Zc(this,"startPosition",null),Zc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(g<=i&&(this.startColumn-=1),g>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Qc(t,e,n){return(e=MK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MK(t){var e=IK(t,"string");return typeof e=="symbol"?e:e+""}function IK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PK{constructor(){Qc(this,"count",0),Qc(this,"startRow",null),Qc(this,"endRow",null),Qc(this,"startPosition",null),Qc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Jc(t,e,n){return(e=OK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OK(t){var e=xK(t,"string");return typeof e=="symbol"?e:e+""}function xK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YL{constructor(){Jc(this,"count",0),Jc(this,"startColumn",null),Jc(this,"endColumn",null),Jc(this,"startPosition",null),Jc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function eh(t,e,n){return(e=AK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AK(t){var e=HK(t,"string");return typeof e=="symbol"?e:e+""}function HK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GL{constructor(){eh(this,"count",0),eh(this,"startRow",null),eh(this,"endRow",null),eh(this,"startPosition",null),eh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function th(t,e,n){return(e=NK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NK(t){var e=DK(t,"string");return typeof e=="symbol"?e:e+""}function DK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kK{constructor(){th(this,"count",0),th(this,"startColumn",0),th(this,"endColumn",0),th(this,"startPosition",0),th(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function nh(t,e,n){return(e=LK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=$K(t,"string");return typeof e=="symbol"?e:e+""}function $K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FK{constructor(){nh(this,"count",0),nh(this,"startRow",0),nh(this,"endRow",0),nh(this,"startPosition",0),nh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function c1(t,e,n){return(e=VK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VK(t){var e=WK(t,"string");return typeof e=="symbol"?e:e+""}function WK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BK extends YL{constructor(){super(...arguments),c1(this,"columnStartOffset",0),c1(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function h1(t,e,n){return(e=jK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=UK(t,"string");return typeof e=="symbol"?e:e+""}function UK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zK extends GL{constructor(){super(...arguments),h1(this,"rowStartOffset",0),h1(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function d1(t,e,n){return(e=YK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:e+""}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qL{constructor(e){d1(this,"calculationTypes",[]),d1(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Si(t,e,n){return(e=qK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qK(t){var e=KK(t,"string");return typeof e=="symbol"?e:e+""}function KK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gc=50;class XK extends qL{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Si(this,"viewportWidth",0),Si(this,"scrollOffset",0),Si(this,"zeroBasedScrollOffset",0),Si(this,"totalColumns",0),Si(this,"columnWidthFn",null),Si(this,"columnWidth",0),Si(this,"overrideFn",null),Si(this,"inlineStartOffset",0),Si(this,"totalCalculatedWidth",0),Si(this,"startPositions",[]),Si(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?gc:n}}function Yr(t,e,n){return(e=ZK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZK(t){var e=QK(t,"string");return typeof e=="symbol"?e:e+""}function QK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JK extends qL{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Yr(this,"viewportHeight",0),Yr(this,"scrollOffset",0),Yr(this,"zeroBasedScrollOffset",0),Yr(this,"totalRows",0),Yr(this,"rowHeightFn",null),Yr(this,"rowHeight",0),Yr(this,"overrideFn",null),Yr(this,"horizontalScrollbarHeight",0),Yr(this,"innerViewportHeight",0),Yr(this,"totalCalculatedHeight",0),Yr(this,"startPositions",[]),Yr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function e3(t,e,n){t3(t,e),e.set(t,n)}function t3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f1(t,e,n){return(e=n3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n3(t){var e=r3(t,"string");return typeof e=="symbol"?e:e+""}function r3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function su(t,e){return t.get(KL(t,e))}function g1(t,e,n){return t.set(KL(t,e),n),n}function KL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bo=new WeakMap;class kl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;f1(this,"row",null),f1(this,"col",null),e3(this,Bo,!1),g1(Bo,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return su(Bo,this)}isSouthEastOf(e){return this.row>=e.row&&(su(Bo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(su(Bo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(su(Bo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(su(Bo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof kl&&g1(Bo,this,e.isRtl()),this}clone(){return new kl(this.row,this.col,su(Bo,this))}toObject(){return{row:this.row,col:this.col}}}function i3(t,e,n){o3(t,e),e.set(t,n)}function o3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yy(t,e,n){return(e=s3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s3(t){var e=a3(t,"string");return typeof e=="symbol"?e:e+""}function a3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gr(t,e){return t.get(XL(t,e))}function l3(t,e,n){return t.set(XL(t,e),n),n}function XL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var or=new WeakMap;class pf{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Yy(this,"highlight",null),Yy(this,"from",null),Yy(this,"to",null),i3(this,or,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),l3(or,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Gr(or,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Gr(or,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Gr(or,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Gr(or,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Gr(or,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Gr(or,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Gr(or,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Gr(or,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof kl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Gr(or,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Gr(or,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new pf(this.highlight,this.from,this.to,Gr(or,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new kl(e,n,Gr(or,this))}}function Ki(t,e,n){u3(t,e),e.set(t,n)}function u3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(ZL(t,e))}function xs(t,e,n){return t.set(ZL(t,e),n),n}function ZL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var qr=new WeakMap,Gy=new WeakMap,Sn=new WeakMap,au=new WeakMap,Vf=new WeakMap,Ri=new WeakMap,qy=new WeakMap,rh=new WeakMap,Na=new WeakMap,Xi=new WeakMap;let QL=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ki(this,qr,void 0),Ki(this,Gy,void 0),Ki(this,Sn,void 0),Ki(this,au,void 0),Ki(this,Vf,void 0),Ki(this,Ri,void 0),Ki(this,qy,void 0),Ki(this,rh,void 0),Ki(this,Na,[null,null]),Ki(this,Xi,[null,null]),xs(qr,this,r),xs(Gy,this,n),xs(Sn,this,o),xs(au,this,s),xs(Vf,this,a),xs(Ri,this,i),xs(qy,this,e),this.registerEvents()}registerEvents(){ge(Ri,this).addEventListener(ge(Sn,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(Ri,this).addEventListener(ge(Sn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(Ri,this).addEventListener(ge(Sn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(Ri,this).addEventListener(ge(Sn,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(Ri,this).addEventListener(ge(Sn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(Ri,this).addEventListener(ge(Sn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(qr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(qr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(Ri,this).addEventListener(ge(Sn,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(Ri,this).addEventListener(ge(Sn,this).holder,"mousedown",r=>this.onMouseDown(r))};_o()?e():(E0()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(rh,this)&&r){const[i,o]=[r.row,ge(rh,this).from.row],[s,a]=[r.col,ge(rh,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(Sn,this).TABLE,i=qh(e,["TD","TH"],r);return i?(n.coords=ge(Sn,this).getCoords(i),n.TD=i):we(e,"wtBorder")&&we(e,"current")?(n.coords=ge(au,this).getFocusSelection().cellRange.highlight,n.TD=ge(Sn,this).getCell(n.coords)):we(e,"wtBorder")&&we(e,"area")&&ge(au,this).getAreaSelection().cellRange&&(n.coords=ge(au,this).getAreaSelection().cellRange.to,n.TD=ge(Sn,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(Gy,this).rootDocument.activeElement,r=R0(sL,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);we(i,"corner")?ge(qr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(qr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(Xi,this)[0]=o.TD,clearTimeout(ge(Na,this)[0]),ge(Na,this)[0]=setTimeout(()=>{ge(Xi,this)[0]=null},1e3))}onContextMenu(e){if(ge(qr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(qr,this).has("onCellMouseOver"))return;const n=ge(Sn,this).TABLE,r=qh(e.target,["TD","TH"],n),i=ge(Vf,this)||this;r&&r!==i.lastMouseOver&&fa(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(Sn,this).getCoords(r),r))}onMouseOut(e){if(!ge(qr,this).has("onCellMouseOut"))return;const n=ge(Sn,this).TABLE,r=qh(e.target,["TD","TH"],n),i=qh(e.relatedTarget,["TD","TH"],n),o=ge(Vf,this)||this;r&&r!==i&&fa(r,n)&&(this.callListener("onCellMouseOut",e,ge(Sn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(qr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(Xi,this)[0]&&n.TD===ge(Xi,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(Xi,this)[0]=null,ge(Xi,this)[1]=null):n.TD===ge(Xi,this)[0]&&(ge(Xi,this)[1]=n.TD,clearTimeout(ge(Na,this)[1]),ge(Na,this)[1]=setTimeout(()=>{ge(Xi,this)[1]=null},500)))}onTouchStart(e){xs(rh,this,ge(au,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ae(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(qr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];T0()&&(ML()||IL())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(qr,this).getSettingPure(e);o&&o(n,r,i,ge(qy,this).call(this))}destroy(){clearTimeout(ge(Na,this)[0]),clearTimeout(ge(Na,this)[1]),ge(Ri,this).destroy()}};function Ky(t,e,n){return(e=c3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c3(t){var e=h3(t,"string");return typeof e=="symbol"?e:e+""}function h3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d3{constructor(e,n,r){Ky(this,"offset",void 0),Ky(this,"total",void 0),Ky(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Xy(t,e,n){return(e=f3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f3(t){var e=g3(t,"string");return typeof e=="symbol"?e:e+""}function g3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m3{constructor(e,n,r){Xy(this,"offset",void 0),Xy(this,"total",void 0),Xy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Wf(t,e,n){return(e=p3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:e+""}function w3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v3{constructor(){Wf(this,"currentSize",0),Wf(this,"nextSize",0),Wf(this,"currentOffset",0),Wf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const C3=0,m1=1,PR=2;function Zy(t,e,n){return(e=y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y3(t){var e=b3(t,"string");return typeof e=="symbol"?e:e+""}function b3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S3{constructor(){Zy(this,"size",new v3),Zy(this,"workingSpace",C3),Zy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=m1,e.workingSpace=PR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=PR,e.workingSpace=m1,this.sharedSize=e.getViewSize()}}var p1={},Qy,w1;function R3(){if(w1)return Qy;w1=1;var t=jp(),e=TypeError;return Qy=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},Qy}var v1;function E3(){if(v1)return p1;v1=1;var t=pt(),e=Ec(),n=Tc(),r=FD(),i=R3(),o=VD(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var g=d;g--;){var C=g+f;g in h?h[C]=h[g]:i(h,C)}for(var y=0;y<f;y++)h[y]=arguments[y]}return r(h,d+f)}}),p1}E3();function _3(t,e,n){return(e=T3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T3(t){var e=M3(t,"string");return typeof e=="symbol"?e:e+""}function M3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C1{constructor(e,n){_3(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function I3(t,e,n){return(e=P3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=O3(t,"string");return typeof e=="symbol"?e:e+""}function O3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x3{constructor(e){I3(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new C1(o,n),l=new C1(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(PR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function lu(t,e,n){return(e=A3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A3(t){var e=H3(t,"string");return typeof e=="symbol"?e:e+""}function H3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JL{constructor(e,n){lu(this,"rootNode",void 0),lu(this,"nodesPool",void 0),lu(this,"sizeSet",new S3),lu(this,"collectedNodes",[]),lu(this,"viewDiffer",new x3(this.sizeSet)),lu(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class e$ extends JL{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function y1(t,e,n){return(e=N3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=D3(t,"string");return typeof e=="symbol"?e:e+""}function D3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k3{constructor(e){y1(this,"nodeType",void 0),y1(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function ih(t,e,n){return(e=L3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L3(t){var e=$3(t,"string");return typeof e=="symbol"?e:e+""}function $3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wf{constructor(e,n){ih(this,"nodesPool",null),ih(this,"nodeType",void 0),ih(this,"rootNode",void 0),ih(this,"table",null),ih(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new k3(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function b1(t,e,n){return(e=F3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F3(t){var e=V3(t,"string");return typeof e=="symbol"?e:e+""}function V3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W3 extends wf{constructor(){super("TH"),b1(this,"orderViews",new WeakMap),b1(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new e$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Zl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(d,[_2(),N2(),h0(h+1),Kl(-1)]),n[h](a,d,h)}u.end()}}}class B3 extends wf{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&xo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ye(this.rootNode,[eL()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ye(s,[CR(),iL(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Zl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ye(u,[h0(a+1+this.table.rowHeadersCount),Kl(-1),T2(),...a>=0?[H2()]:[CR()]]),r[n](l,u,n)}}}}let S1=!1;class j3 extends wf{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!S1&&e>1e3&&(S1=!0,Je(ot`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function U3(t,e,n){return(e=z3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z3(t){var e=Y3(t,"string");return typeof e=="symbol"?e:e+""}function Y3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uu={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let R1=!1;class G3 extends wf{constructor(e){super("TR",e),U3(this,"orderView",void 0),this.orderView=new JL(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!R1&&e>1e3&&(R1=!0,Je(ot`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ye(this.rootNode,[eL()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ye(o,[CR(),iL(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?we(o,uu.rowEven)||(pe(o,uu.rowOdd),q(o,uu.rowEven)):we(o,uu.rowOdd)||(pe(o,uu.rowEven),q(o,uu.rowOdd))}this.orderView.end()}}function E1(t,e,n){return(e=q3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q3(t){var e=K3(t,"string");return typeof e=="symbol"?e:e+""}function K3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X3 extends wf{constructor(){super("TD"),E1(this,"orderViews",new WeakMap),E1(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new e$(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),g=c.getCurrentNode();if(we(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Zl(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var o,s;ye(g,[...g.hasAttribute("role")?[]:[E2()],Kl(-1),h0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function an(t,e,n){return(e=Z3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z3(t){var e=Q3(t,"string");return typeof e=="symbol"?e:e+""}function Q3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J3{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};an(this,"rootNode",void 0),an(this,"rootDocument",void 0),an(this,"rowHeaders",null),an(this,"columnHeaders",null),an(this,"colGroup",null),an(this,"rows",null),an(this,"cells",null),an(this,"rowFilter",null),an(this,"columnFilter",null),an(this,"rowUtils",null),an(this,"columnUtils",null),an(this,"rowsToRender",0),an(this,"columnsToRender",0),an(this,"rowHeaderFunctions",[]),an(this,"rowHeadersCount",0),an(this,"columnHeaderFunctions",[]),an(this,"columnHeadersCount",0),an(this,"cellRenderer",void 0),an(this,"activeOverlayName",void 0),an(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class eX{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new J3(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new W3,columnHeaders:new B3(n),colGroup:new j3(r),rows:new G3(i),cells:new X3}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Jy(t,e,n){return(e=tX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tX(t){var e=nX(t,"string");return typeof e=="symbol"?e:e+""}function nX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rX{constructor(e,n){Jy(this,"dataAccessObject",void 0),Jy(this,"wtSettings",void 0),Jy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function _1(t,e,n){return(e=iX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iX(t){var e=oX(t,"string");return typeof e=="symbol"?e:e+""}function oX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sX{constructor(e,n){_1(this,"dataAccessObject",void 0),_1(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Zi(t,e,n){return(e=aX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aX(t){var e=lX(t,"string");return typeof e=="symbol"?e:e+""}function lX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hc{constructor(e,n,r,i,o){Zi(this,"wtSettings",null),Zi(this,"domBindings",void 0),Zi(this,"TBODY",null),Zi(this,"THEAD",null),Zi(this,"COLGROUP",null),Zi(this,"hasTableHeight",!0),Zi(this,"hasTableWidth",!0),Zi(this,"isTableVisible",!1),Zi(this,"tableOffset",0),Zi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,f0(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new sX(this.dataAccessObject,this.wtSettings),this.columnUtils=new rX(this.dataAccessObject,this.wtSettings),this.tableRenderer=new eX({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ye(r,[gs()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(r,[gs()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!we(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",ye(r,[Kl(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ye(r.parentNode,[gs()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ye(r,[gs()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Pn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Pn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new m3(f,o,c),this.columnFilter=new d3(g,s,l);let C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),C=y.skipRender!==!0}C&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(So)||this.is(ga))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(So))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(So)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=sc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(So))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ca(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=uL(r),s=n.cellIndex;Ys(Fl,n,this.wtRootElement)||Ys(Ll,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Ys(ga,n,this.wtRootElement)||Ys(So,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Ys(Fl,n,this.wtRootElement)||Ys($l,n,this.wtRootElement)||Ys(ga,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),r=sc(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?en:sc,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const f=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-f||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Kt(this.TABLE)}getHeight(){return en(this.TABLE)}getTotalWidth(){const e=Kt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=en(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Dl(this.TABLE)}_modifyRowHeaderWidth(e){let n=it(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const uX="stickyRowsBottom",D0={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ko(D0,"MIXIN_NAME",uX,{writable:!1,enumerable:!1});const cX="stickyColumnsStart",fw={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ko(fw,"MIXIN_NAME",cX,{writable:!1,enumerable:!1});class k0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,ga)}}ut(k0,D0);ut(k0,fw);const Ll="top",So="bottom",$l="inline_start",Fl="top_inline_start_corner",ga="bottom_inline_start_corner",t$=[Ll,So,$l,Fl,ga],hX=new Map([[Ll,`ht_clone_${Ll}`],[So,`ht_clone_${So}`],[$l,`ht_clone_${$l} ht_clone_left`],[Fl,`ht_clone_${Fl} ht_clone_top_left_corner`],[ga,`ht_clone_${ga} ht_clone_bottom_left_corner`]]);function dX(t,e){fX(t,e),e.add(t)}function fX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gX(t,e,n){return(e=mX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mX(t){var e=pX(t,"string");return typeof e=="symbol"?e:e+""}function pX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oh=new WeakSet;class wX{constructor(e){dX(this,oh),gX(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=Rr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=Rr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Bf(oh,this,M1).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Bf(oh,this,M1).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Bf(oh,this,T1).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Bf(oh,this,T1).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function T1(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Pn(r.wtRootElement).left;const u=Math.abs(m0(s,s));if(l>u){const c=p0(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function M1(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Pn(n.wtRootElement),a=ow(o,o);if(s.top>a){const l=sc(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Kr(t,e,n){return(e=vX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vX(t){var e=CX(t,"string");return typeof e=="symbol"?e:e+""}function CX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L0{get eventManager(){return new di(this)}constructor(e,n){Kr(this,"wtTable",void 0),Kr(this,"wtScroll",void 0),Kr(this,"wtViewport",void 0),Kr(this,"wtOverlays",void 0),Kr(this,"selectionManager",void 0),Kr(this,"wtEvent",void 0),Kr(this,"guid",`wt_${l0()}`),Kr(this,"drawInterrupted",!1),Kr(this,"drawn",!1),Kr(this,"activeOverlayName","master"),Kr(this,"domBindings",void 0),Kr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new wX(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ya(r,e[n])}])}}createCellCoords(e,n){return new kl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new pf(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||fL(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function I1(t,e,n){return(e=yX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yX(t){var e=bX(t,"string");return typeof e=="symbol"?e:e+""}function bX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SX extends L0{constructor(e,n,r){super(e,n),I1(this,"cloneSource",void 0),I1(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.stylesHandler=r.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new QL(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function RX(t,e,n){return(e=EX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EX(t){var e=_X(t,"string");return typeof e=="symbol"?e:e+""}function _X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vf{constructor(e,n,r,i,o){RX(this,"wtSettings",null),ko(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=dc(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=dc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Nd(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Je(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+yn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(t$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${hX.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ye(o,[gs()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ll||u==="vertical"&&this.type===$l?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Nd(e.TABLE),new SX(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class TX extends vf{constructor(e,n,r,i,o,s){super(e,n,ga,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new k0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else df(n),this.repositionOverlay();let r=en(this.clone.wtTable.TABLE);const i=Kt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=yn(r)),i.style.bottom=`${o}px`}}const MX="calculatedColumns",gw={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ko(gw,"MIXIN_NAME",MX,{writable:!1,enumerable:!1});class $0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,So)}}ut($0,D0);ut($0,gw);function IX(t,e,n){return(e=PX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PX(t){var e=OX(t,"string");return typeof e=="symbol"?e:e+""}function OX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xX extends vf{constructor(e,n,r,i){super(e,n,So,r,i),IX(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new $0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=yn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(iw(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=yn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=yn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ow(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(pe(s,"innerBorderBottom"),o=a)}return o}}const AX="calculatedRows",F0={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ko(F0,"MIXIN_NAME",AX,{writable:!1,enumerable:!1});class V0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,$l)}}ut(V0,F0);ut(V0,fw);const HX="localHooks",On={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Xm(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ko(On,"MIXIN_NAME",HX,{writable:!1,enumerable:!1});let n$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ut(n$,On);const r$="active-header",W0="header",B0="area",ud="focus",NX="fill",DX="row",kX="column",LX="custom-selection",j0=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var P1={},O1;function $X(){if(O1)return P1;O1=1;var t=hw();return t("flat"),P1}$X();function FX(t,e){i$(t,e),e.add(t)}function x1(t,e,n){i$(t,e),e.set(t,n)}function i$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lt(t,e){return t.get(cd(t,e))}function A1(t,e,n){return t.set(cd(t,e),n),n}function cd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pi=new WeakMap,kn=new WeakMap,jf=new WeakSet;class VX{constructor(){FX(this,jf),x1(this,Pi,void 0),x1(this,kn,void 0)}setActiveOverlay(e){return A1(kn,this,e),this}setActiveSelection(e){return A1(Pi,this,e),this}scan(){const e=Lt(Pi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Lt(Pi,this).getCorners(),{wtTable:s}=Lt(kn,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let g=s.getColumnHeader(h,f);const C=Lt(kn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Lt(Pi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(g=s.getColumnHeader(C,f)),e(g))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Lt(Pi,this).getCorners(),{wtTable:s}=Lt(kn,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let g=s.getRowHeader(h,f);const C=Lt(kn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Lt(Pi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(g=s.getRowHeader(C,f)),e(g))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Lt(kn,this);cd(jf,this,WX).call(this,(r,i)=>{const o=n.getCell(Lt(kn,this).createCellCoords(r,i)),s=Lt(kn,this).getSetting("onAfterDrawSelection",r,i,Lt(Pi,this).settings.layerLevel);typeof s=="string"&&q(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=Lt(Pi,this).getCorners(),{wtTable:i}=Lt(kn,this);cd(jf,this,H1).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Lt(kn,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Lt(Pi,this).getCorners(),{wtTable:i}=Lt(kn,this);cd(jf,this,H1).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Lt(kn,this).createCellCoords(o,s));e(a)}})}}function WX(t){let[e,n,r,i]=Lt(Pi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Lt(kn,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(Lt(kn,this).createCellCoords(e,n));if(!To(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function H1(t){const{wtTable:e}=Lt(kn,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class N1{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=j0(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),vi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),_o()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:n}=this.wot,r=n.getCSSVariableValue("cell-mobile-handle-size"),i=n.getCSSVariableValue("cell-mobile-handle-border-radius"),o=n.getCSSVariableValue("cell-mobile-handle-background-color"),s=n.getCSSVariableValue("cell-mobile-handle-border-width"),a=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Ae(c,(d,f)=>{this.selectionHandles.styles.bottomHitArea[f]=d,this.selectionHandles.styles.topHitArea[f]=d});const h=n.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Ae(h,(d,f)=>{this.selectionHandles.styles.bottom[f]=d,this.selectionHandles.styles.top[f]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),g=parseInt(u.width,10),C=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-g-1,10)}px`,u[l]=`${parseInt(i-g-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const p=Math.min(parseInt(i+o,10),y-g-f*2),_=Math.min(parseInt(i+o-C/4,10),y-C-f*2);h[l]=`${p}px`,d[l]=`${_}px`;const P=Math.min(parseInt(r+s,10),E-g-f*2),D=Math.min(parseInt(r+s-C/4,10),E-C-f*2);h.top=`${P}px`,d.top=`${D}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),f=s.getLastRenderedColumn();if(d<0&&f<0||c<0&&h<0){this.disappear();return}let g;if(u){if(r=Math.max(r,d),o=Math.min(o,f),n=Math.max(n,c),i=Math.min(i,h),o<r||i<n){this.disappear();return}g=s.getCell(this.wot.createCellCoords(n,r))}else if(g=s.getCell(this.wot.createCellCoords(n,r)),!To(g)){this.disappear();return}const C=u?s.getCell(this.wot.createCellCoords(i,o)):g,y=Pn(g),E=u?Pn(C):y,p=Pn(s.TABLE),_=y.top,P=y.left,D=this.wot.wtSettings.getSetting("rtlMode");let M=0,x=0;if(D){const be=Kt(s.TABLE),He=Kt(g),ft=l.innerWidth-p.left-be;x=P+He-E.left,M=l.innerWidth-P-He-ft-1}else x=E.left+Kt(C)-P,M=P-p.left-1;if(this.isEntireColumnSelected(n,i)){const be=n,He=this.getDimensionsFromHeader("columns",r,o,be,p);let ft=null;He&&([ft,M,x]=He),ft&&(g=ft)}let Y=_-p.top-1,U=E.top+en(C)-_;if(this.isEntireRowSelected(r,o)){const be=r,He=this.getDimensionsFromHeader("rows",n,i,be,p);let ft=null;He&&([ft,Y,U]=He),ft&&(g=ft)}const B=l.getComputedStyle(g);parseInt(B.borderTopWidth,10)>0&&(Y+=1,U=U>0?U-1:0),parseInt(B[D?"borderRightWidth":"borderLeftWidth"],10)>0&&(M+=1,x=x>0?x-1:0);const Z=D?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[Z]=`${M}px`,this.topStyle.width=`${x}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[Z]=`${M}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const Q=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+U-Q}px`,this.bottomStyle[Z]=`${M}px`,this.bottomStyle.width=`${x}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[Z]=`${M+x-Q}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let se=this.settings.border.cornerVisible;se=typeof se=="function"?se(this.settings.layerLevel):se;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[le,ct]=[i,o];if(te&&Array.isArray(te)&&([,,le,ct]=te),_o()||!se||this.isPartRange(le,ct))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Z]=`${M+x+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let be=dc(s.TABLE);const He=be===l;He&&(be=a.documentElement);const ft=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,jt=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Ze=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const m=He?C.getBoundingClientRect().left:C.offsetLeft;let v=!1,w=0;D?(w=m-parseInt(this.cornerDefaultStyle.width,10)/2,v=w<0):(w=m+Kt(C)+parseInt(this.cornerDefaultStyle.width,10)/2,v=w>=p0(be)),v&&(this.cornerStyle[Z]=`${Math.floor(M+x+this.cornerCenterPointOffset-jt-ft)}px`,this.cornerStyle[D?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const w=(He?C.getBoundingClientRect().top:C.offsetTop)+en(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=sc(be),A=this.wot.stylesHandler.isClassicTheme();if(w){const F=Math.floor(Y+U+this.cornerCenterPointOffset-Ze-ft);A?(this.cornerStyle.top=`${F}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${F-1}px`}}this.cornerStyle.display="block"}_o()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,Y,M,x,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,g=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return en(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Kt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(g=l(n,y-i),C=l(r,y-i),!g||!C)return!1;const E=Pn(g),p=Pn(C);return g&&C&&(h=E[f]-o[f]-1,d=p[f]+u(C)-E[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(we(this[e],"hidden")&&pe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",_o()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function BX(t,e){o$(t,e),e.add(t)}function cu(t,e,n){o$(t,e),e.set(t,n)}function o$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get(U0(t,e))}function D1(t,e,n){return t.set(U0(t,e),n),n}function U0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ln=new WeakMap,pr=new WeakMap,eb=new WeakMap,Kh=new WeakMap,tb=new WeakMap,Da=new WeakMap,k1=new WeakSet;class jX{constructor(e){BX(this,k1),cu(this,Ln,void 0),cu(this,pr,void 0),cu(this,eb,new VX),cu(this,Kh,new WeakMap),cu(this,tb,new WeakSet),cu(this,Da,new Map),D1(pr,this,e)}setActiveOverlay(e){return D1(Ln,this,e),Ne(eb,this).setActiveOverlay(Ne(Ln,this)),Ne(Kh,this).has(Ne(Ln,this))||Ne(Kh,this).set(Ne(Ln,this),new Set),this}getFocusSelection(){return Ne(pr,this)!==null?Ne(pr,this).getFocus():null}getAreaSelection(){return Ne(pr,this)!==null?Ne(pr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ne(Da,this).has(e)){const r=Ne(Da,this).get(e);if(r.has(Ne(Ln,this)))return r.get(Ne(Ln,this));const i=new N1(Ne(Ln,this),e.settings);return r.set(Ne(Ln,this),i),i}const n=new N1(Ne(Ln,this),e.settings);return Ne(Da,this).set(e,new Map([[Ne(Ln,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ne(Da,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ne(Da,this).get(e).forEach(n=>n.destroy()),Ne(Da,this).delete(e)}render(e){if(Ne(pr,this)===null)return;e&&U0(k1,this,UX).call(this);const n=Array.from(Ne(pr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Ne(tb,this).has(s)||(Ne(tb,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Ne(eb,this).setActiveSelection(s).scan().forEach(g=>{if(r.has(g)){const C=r.get(g);C.has(a)&&u===!0?C.set(a,C.get(a)+1):C.set(a,1)}else r.set(g,new Map([[a,1]]));l&&(i.has(g)||i.set(g,[]),g.nodeName==="TH"&&i.get(g).push(...l))});const d=s.getCorners();Ne(Ln,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Ne(Kh,this).get(Ne(Ln,this)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=Ne(pr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&ye(s,Ne(pr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{ye(o,[...i.get(o)])})}}function UX(){const t=Ne(Kh,this).get(Ne(Ln,this)),e=Ne(Ln,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Ne(Ln,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Ne(pr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Ne(pr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ne(pr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Ne(pr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)pe(o[a],n),Zl(o[a],s)}),t.clear()}class zX extends vf{constructor(e,n,r,i){super(e,n,$l,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new V0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),sw(r,`${o}px`,"0px")):(o=this.getScrollPosition(),df(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,g0(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=yn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Kt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=j0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=yn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,mL(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(m0(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?pe(r,"emptyRows"):q(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)q(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(r,"innerBorderInlineStart");e?(q(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(pe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const YX="stickyRowsTop",z0={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ko(z0,"MIXIN_NAME",YX,{writable:!1,enumerable:!1});class Y0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,Fl)}}ut(Y0,z0);ut(Y0,fw);function L1(t,e,n){return(e=GX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=qX(t,"string");return typeof e=="symbol"?e:e+""}function qX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KX extends vf{constructor(e,n,r,i,o,s){super(e,n,Fl,r,i),L1(this,"topOverlay",void 0),L1(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Y0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();sw(e,`${i}px`,`${o}px`)}else df(e);let n=en(this.clone.wtTable.TABLE);const r=Kt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class G0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,Ll)}}ut(G0,z0);ut(G0,gw);function XX(t,e,n){return(e=ZX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZX(t){var e=QX(t,"string");return typeof e=="symbol"?e:e+""}function QX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JX extends vf{constructor(e,n,r,i){super(e,n,Ll,r,i),XX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new G0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),sw(e,"0px",`${i}px`)}else i=this.getScrollPosition(),df(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(iw(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=yn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=en(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=j0(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=yn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,gL(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ow(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?pe(i,"emptyColumns"):q(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(q(i,"innerBorderTop"),a=!h):(pe(i,"innerBorderTop"),a=h)}}return a}}function Uf(t,e,n){e4(t,e),e.set(t,n)}function e4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jo(t,e,n){return(e=t4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t4(t){var e=n4(t,"string");return typeof e=="symbol"?e:e+""}function n4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ka(t,e,n){return t.set(s$(t,e),n),n}function Uo(t,e){return t.get(s$(t,e))}function s$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hu=new WeakMap,zf=new WeakMap,du=new WeakMap,Yf=new WeakMap;class r4{constructor(e,n,r,i,o,s){jo(this,"wot",null),Uf(this,hu,[]),jo(this,"topOverlay",null),jo(this,"bottomOverlay",null),jo(this,"inlineStartOverlay",null),jo(this,"topInlineStartCornerOverlay",null),jo(this,"bottomInlineStartCornerOverlay",null),jo(this,"browserLineHeight",void 0),jo(this,"wtSettings",null),Uf(this,zf,!1),Uf(this,du,0),Uf(this,Yf,null),jo(this,"resizeObserver",new ResizeObserver(c=>{kd(()=>{!Array.isArray(c)||!c.length||(ka(du,this,Uo(du,this)+1),Uo(du,this)===100&&(Je("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Uo(Yf,this)!==null&&clearTimeout(Uo(Yf,this)),ka(Yf,this,setTimeout(()=>{ka(du,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=yn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Nd(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Uo(hu,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new JX(...e),this.bottomOverlay=new xX(...e),this.inlineStartOverlay=new zX(...e),this.topInlineStartCornerOverlay=new KX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new TX(...e,this.bottomOverlay,this.inlineStartOverlay),ka(hu,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ka(zf,this,Uo(hu,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Uo(hu,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Uo(hu,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!_0())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{kd(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ka(du,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ac(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Uo(zf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ka(zf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Nd(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),g=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),C=f()?1:0,y=g()?1:0;d.width=`${c+y}px`,d.height=`${u+C}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return I(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function $1(t,e,n){return(e=i4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i4(t){var e=o4(t,"string");return typeof e=="symbol"?e:e+""}function o4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s4{constructor(e){$1(this,"settings",{}),$1(this,"defaults",Object.freeze(this.getDefaults())),Ae(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ya(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ae(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class q0 extends Hc{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=dc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Dd(e,"height",n),o=Dd(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Dl(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}ut(q0,F0);ut(q0,gw);class a4{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new FK:new zK],["fullyVisible",()=>new PK],["partiallyVisible",()=>new GL]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new kK:new BK],["fullyVisible",()=>new TK],["partiallyVisible",()=>new YL]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=en(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Pn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=en(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=Kt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=yn(this.domBindings.rootDocument),new JK({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=yn(this.domBindings.rootDocument)),new XK({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Ae(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}function l4(t,e){a$(t,e),e.add(t)}function La(t,e,n){a$(t,e),e.set(t,n)}function a$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(Li(t,e))}function ki(t,e,n){return t.set(Li(t,e),n),n}function Li(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const F1=23;var co=new WeakMap,hs=new WeakMap,K0=new WeakMap,OR=new WeakMap,Gs=new WeakMap,Xh=new WeakMap,Fd=new WeakMap,go=new WeakSet;class u4{constructor(e){l4(this,go),La(this,co,void 0),La(this,hs,void 0),La(this,K0,void 0),La(this,OR,void 0),La(this,Gs,!0),La(this,Xh,{}),La(this,Fd,{}),ki(hs,this,e.rootTable.parentElement.parentElement),ki(OR,this,e.rootDocument)}isClassicTheme(){return It(Gs,this)}getCSSVariableValue(e){var n;if(It(Gs,this))return null;if(It(Xh,this)[`--ht-${e}`])return It(Xh,this)[`--ht-${e}`];const r=(n=Li(go,this,f4).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Li(go,this,l$).call(this,`--ht-${e}`);if(r!==null)return It(Xh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=It(Fd,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(It(Gs,this))return F1;const e=Li(go,this,c4).call(this);return!e&&we(It(hs,this),"ht-wrapper")?(Je(`The "${It(co,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),ki(Gs,this,!0),this.useTheme(),F1):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Li(go,this,V1).call(this),ki(Gs,this,!0),ki(co,this,e||void 0);return}e&&e!==It(co,this)&&(It(co,this)&&Li(go,this,g4).call(this),ki(co,this,e),ki(Gs,this,!1),Li(go,this,h4).call(this),Li(go,this,V1).call(this))}getThemeName(){return It(co,this)}removeClassNames(){we(It(hs,this),It(co,this))&&pe(It(hs,this),It(co,this))}}function c4(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function h4(){pe(It(hs,this),/ht-theme-.*/g),q(It(hs,this),It(co,this))}function V1(){this.isClassicTheme()||ki(K0,this,getComputedStyle(It(hs,this)));const t=Li(go,this,d4).call(this,["box-sizing","border-bottom-width"]);It(Fd,this).td={...It(Fd,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function d4(t){const e=It(OR,this),n=It(hs,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function f4(t){const e=Math.ceil(parseFloat(Li(go,this,l$).call(this,t)));return Number.isNaN(e)?null:e}function l$(t){const e=It(K0,this).getPropertyValue(t);return e===""?null:e}function g4(){ki(Fd,this,{}),ki(Xh,this,{}),ki(Gs,this,!0)}class m4 extends L0{constructor(e,n){super(e,new s4(n)),this.stylesHandler=new u4(this.domBindings);const r=this.wtSettings.getSetting("facade",this);this.wtTable=new q0(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new a4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new jX(this.wtSettings.getSetting("selections")),this.wtEvent=new QL(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new r4(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ae(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),pe(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!t$.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class X0{constructor(e){e instanceof L0?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new X0(n);return()=>r},this._wot=new m4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function W1(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function p4(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}const w4=new Map([["mousedown",W1],["mouseover",p4],["touchstart",W1]]);function B1(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;w4.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:cw(t)||t.type==="touchstart",isRightClick:ba(t)})}const u$=new WeakMap,Z0=Symbol("rootInstance");function v4(t){u$.set(t,!0)}function C4(t){return t===Z0}function bm(t){return u$.has(t)}function y4(t,e){c$(t,e),e.add(t)}function As(t,e,n){c$(t,e),e.set(t,n)}function c$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hs(t,e,n){return(e=b4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b4(t){var e=S4(t,"string");return typeof e=="symbol"?e:e+""}function S4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zt(t,e){return t.get(lc(t,e))}function sr(t,e,n){return t.set(lc(t,e),n),n}function lc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nb=new WeakMap,Gf=new WeakMap,qf=new WeakMap,zo=new WeakMap,Ei=new WeakMap,rb=new WeakMap,ib=new WeakMap,fu=new WeakMap,Zh=new WeakSet;class R4{constructor(e){y4(this,Zh),Hs(this,"hot",void 0),Hs(this,"eventManager",void 0),Hs(this,"settings",void 0),Hs(this,"THEAD",void 0),Hs(this,"TBODY",void 0),Hs(this,"_wt",void 0),Hs(this,"activeWt",void 0),As(this,nb,0),As(this,Gf,0),Hs(this,"postponedAdjustElementsSize",!1),As(this,qf,!1),As(this,zo,void 0),As(this,Ei,void 0),As(this,rb,0),As(this,ib,0),As(this,fu,null),this.hot=e,this.eventManager=new di(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),lc(Zh,this,_4).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),sr(Ei,this,n.createElement("TABLE")),q(Zt(Ei,this),"htCore"),this.hot.getSettings().tableClassName&&q(Zt(Ei,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ye(Zt(Ei,this),[gs()]),ye(e,[R2(),rL(-1),rw(this.hot.countCols()),L2()])),this.THEAD=n.createElement("THEAD"),Zt(Ei,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Zt(Ei,this).appendChild(this.TBODY),this.hot.table=Zt(Ei,this),this.hot.container.insertBefore(Zt(Ei,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{sr(qf,this,!0),this.isTextSelectionAllowed(a.target)||(yR(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{sr(qf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Zt(qf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&yR(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&cw(a)&&r.finish(),sr(zo,this,!1);const l=aw(n.activeElement);ld(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ba(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&ba(a)&&(r.finish(),sr(zo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),sr(zo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Zt(zo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const g=yn(n);if(n.elementFromPoint(u+g,c)!==d||n.elementFromPoint(u,c+g)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Nl(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Nl(s);this.eventManager.addEventListener(Zt(Ei,this),"selectstart",a=>{this.settings.fragmentSelection||ld(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&q(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&pe(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Zt(Ei,this),isDataViewInstance:()=>bm(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),sr(Gf,this,o.length),this.hot.getSettings().ariaTags&&lc(Zh,this,h$).call(this)===this.hot.countCols()&&lc(Zh,this,E4).call(this,Zt(Gf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),sr(nb,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let C=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,f)),this.hot.runHooks("beforeRenderer",a,l,u,g,C,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,g,C,f),this.hot.runHooks("afterRenderer",a,l,u,g,C,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Dl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,sr(zo,this,!0),sr(fu,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!ea(o)&&(B1(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,sr(zo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!ea(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!ea(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!ea(o)&&(Zt(zo,this)&&(!Zt(fu,this)||Zt(fu,this).x!==o.clientX||Zt(fu,this).y!==o.clientY)&&B1(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,sr(fu,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(ea(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,C,y,E]=f;return[g>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1)):g,C>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(C,1)):C,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new X0(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(ld(e))return!0;const n=fa(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Zt(zo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!we(r,"relative")){xo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",q(s,["relative",...o()])):(xo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(ye(a,...gs()),ye(l,...gs())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ql(e,r(n,i)):(ya(e," "),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){sr(rb,this,e),sr(ib,this,n)}getLastSize(){return{width:Zt(rb,this),height:Zt(ib,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Zt(nb,this)}getRowHeadersCount(){return Zt(Gf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function h$(){return parseInt(this.hot.rootElement.getAttribute(rw()[0]),10)}function E4(t){const e=lc(Zh,this,h$).call(this)+t;ye(this.hot.rootElement,...rw(e))}function _4(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):pe(t,"htHasScrollY"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):pe(t,"htHasScrollX")}var j1={},U1={},z1;function T4(){if(z1)return U1;z1=1;var t=pt(),e=hn(),n=Mc(),r=Er(),i=fn(),o=Ho(),s=_r(),a=Ma(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,g){if(!c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),U1}var Y1;function M4(){return Y1||(Y1=1,T4()),j1}M4();const d$="ABCDEFGHIJKLMNOPQRSTUVWXYZ",xR=d$.length;function mw(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%xR,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/xR,10);return n}function I4(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=xR**r*(d$.indexOf(t[n])+1);return e-=1,e}function P4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(mw(i)+(r+1));n.push(o)}return n}function O4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=mw(i)+(r+1);n.push(o)}return n}function x4(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function Q0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function J0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&xe(t[0])&&(e=uw(t[0]))),e}function f$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function g$(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const A4=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:J0,createEmptySpreadsheetData:x4,createSpreadsheetData:P4,createSpreadsheetObjectData:O4,dataRowToChangesArray:Q0,isArrayOfArrays:f$,isArrayOfObjects:g$,spreadsheetColumnIndex:I4,spreadsheetColumnLabel:mw},Symbol.toStringTag,{value:"Module"}));function sh(t,e,n){return(e=H4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H4(t){var e=N4(t,"string");return typeof e=="symbol"?e:e+""}function N4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];sh(this,"hot",void 0),sh(this,"data",void 0),sh(this,"dataType","array"),sh(this,"colToProp",()=>{}),sh(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return I(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(xe(a)||it(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?vm(l,d,f):l[d]=f}})}else Ae(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?vm(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Rr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:vm(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?SL(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=Rr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return J0(this.data)}destroy(){this.data=null,this.hot=null}}var G1={},q1={},K1;function k4(){if(K1)return q1;K1=1;var t=pt(),e=hn(),n=Mc(),r=Er(),i=fn(),o=Ho(),s=_r(),a=Ma(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,g){if(c(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),q1}var X1;function L4(){return X1||(X1=1,k4()),G1}L4();function Z1(t,e,n){return(e=$4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $4(t){var e=F4(t,"string");return typeof e=="symbol"?e:e+""}function F4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Z1(this,"indexedValues",[]),Z1(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,it(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ut(Jl,On);function e_(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>it(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function t_(t,e){return va(t,(n,r)=>e.includes(r)===!1)}class Ia extends Jl{insert(e,n){this.indexedValues=e_(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=t_(this.indexedValues,e),super.remove(e)}}class pw extends Ia{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return gn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function n_(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Vd(t,e){return va(t,n=>e.includes(n)===!1)}function r_(t,e){return Be(t,n=>n-e.filter(r=>r<n).length)}function i_(t,e){const n=e[0],r=e.length;return Be(t,i=>i>=n?i+r:i)}function V4(t,e,n){return(e=W4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=B4(t,"string");return typeof e=="symbol"?e:e+""}function B4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ww extends Jl{constructor(){super(...arguments),V4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Vd(this.orderOfIndexes,[e]),it(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=e_(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=i_(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=t_(this.indexedValues,e),this.orderOfIndexes=Vd(this.orderOfIndexes,e),this.orderOfIndexes=r_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Cf extends Ia{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return gn(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const Q1=new Map([["indexesSequence",{getListWithInsertedItems:n_,getListWithRemovedItems:Vd}],["physicallyIndexed",{getListWithInsertedItems:e_,getListWithRemovedItems:t_}]]),m$=t=>{if(Q1.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return Q1.get(t)};class p$ extends Jl{constructor(){super(e=>e)}insert(e,n){const r=i_(this.indexedValues,n);this.indexedValues=n_(r,e,n),super.insert(e,n)}remove(e){const n=Vd(this.indexedValues,e);this.indexedValues=r_(n,e),super.remove(e)}}const J1=new Map([["hiding",pw],["index",Jl],["linkedPhysicalIndexToValue",ww],["physicalIndexToValue",Ia],["trimming",Cf]]);function j4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!J1.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(J1.get(t))(e)}function U4(t,e,n){return(e=z4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z4(t){var e=Y4(t,"string");return typeof e=="symbol"?e:e+""}function Y4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let AR=0;class o_{constructor(){U4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),AR+=1)}unregister(e){const n=this.collection.get(e);ae(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),AR-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Pt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ut(o_,On);function G4(){return AR}function ob(t,e,n){return(e=q4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q4(t){var e=K4(t,"string");return typeof e=="symbol"?e:e+""}function K4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eA extends o_{constructor(e,n){super(),ob(this,"mergedValuesCache",[]),ob(this,"aggregationFunction",void 0),ob(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Be(this.get(),o=>o.getValues()),r=[],i=ae(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Be(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ae(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function X4(t,e,n){Z4(t,e),e.set(t,n)}function Z4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Q4(t,e,n){return t.set(w$(t,e),n),n}function J4(t,e){return t.get(w$(t,e))}function w$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sb=new WeakMap;class v${constructor(){X4(this,sb,[])}subscribe(e){return this.addLocalHook("change",e),this._write(J4(sb,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Q4(sb,this,e)}}ut(v$,On);function tA(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function ah(t,e,n){e9(t,e),e.set(t,n)}function e9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xr(t,e){return t.get(C$(t,e))}function Kf(t,e,n){return t.set(C$(t,e),n),n}function C$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xf=new WeakMap,lh=new WeakMap,Zf=new WeakMap,Qf=new WeakMap,Jf=new WeakMap;class t9{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ah(this,Xf,new Set),ah(this,lh,[]),ah(this,Zf,[]),ah(this,Qf,!1),ah(this,Jf,!1),Kf(Jf,this,e??!1)}createObserver(){const e=new v$;return Xr(Xf,this).add(e),e.addLocalHook("unsubscribe",()=>{Xr(Xf,this).delete(e)}),e._writeInitialChanges(tA(Xr(lh,this),Xr(Zf,this))),e}emit(e){let n=Xr(Zf,this);(!Xr(Qf,this)||Xr(lh,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Xr(Jf,this)):Kf(lh,this,new Array(e.length).fill(Xr(Jf,this))),Xr(Qf,this)||(Kf(Qf,this,!0),n=Xr(lh,this)));const r=tA(n,e);Xr(Xf,this).forEach(i=>i._write(r)),Kf(Zf,this,e)}}function Yn(t,e,n){return(e=n9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n9(t){var e=r9(t,"string");return typeof e=="symbol"?e:e+""}function r9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HR{constructor(){Yn(this,"indexesSequence",new p$),Yn(this,"trimmingMapsCollection",new eA(e=>e.some(n=>n===!0),!1)),Yn(this,"hidingMapsCollection",new eA(e=>e.some(n=>n===!0),!1)),Yn(this,"variousMapsCollection",new o_),Yn(this,"hidingChangesObservable",new t9({initialIndexValue:!1})),Yn(this,"notTrimmedIndexesCache",[]),Yn(this,"notHiddenIndexesCache",[]),Yn(this,"isBatched",!1),Yn(this,"indexesSequenceChanged",!1),Yn(this,"indexesChangeSource",void 0),Yn(this,"trimmedIndexesChanged",!1),Yn(this,"hiddenIndexesChanged",!1),Yn(this,"renderablePhysicalIndexesCache",[]),Yn(this,"fromPhysicalToVisualIndexesCache",new Map),Yn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,j4(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Cf?this.trimmingMapsCollection.register(e,n):n instanceof pw?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ae(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ae(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ae(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ae(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Be(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Vd(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(n_(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ae(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Be(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}ut(HR,On);function i9(t,e){return Ae(e,(n,r)=>{Pt(t[r])&&(t[r]=n)}),t}function y$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function b$(t){ae(t)&&P0(ot`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function o9(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:s9,getValues:a9}=Gi("phraseFormatters");function l9(t,e){s9(t,e)}function u9(){return a9()}l9("pluralize",o9);const S$="ContextMenu:items",Me=S$,s_=`${Me}.noItems`,a_=`${Me}.insertRowAbove`,l_=`${Me}.insertRowBelow`,u_=`${Me}.insertColumnOnTheLeft`,c_=`${Me}.insertColumnOnTheRight`,h_=`${Me}.removeRow`,d_=`${Me}.removeColumn`,f_=`${Me}.undo`,g_=`${Me}.redo`,tp=`${Me}.readOnly`,m_=`${Me}.clearColumn`,p_=`${Me}.copy`,w_=`${Me}.copyWithHeaders`,v_=`${Me}.copyWithGroupHeaders`,C_=`${Me}.copyHeadersOnly`,y_=`${Me}.cut`,b_=`${Me}.freezeColumn`,S_=`${Me}.unfreezeColumn`,R_=`${Me}.mergeCells`,E_=`${Me}.unmergeCells`,__=`${Me}.addComment`,T_=`${Me}.editComment`,M_=`${Me}.removeComment`,I_=`${Me}.readOnlyComment`,P_=`${Me}.align`,O_=`${Me}.align.left`,x_=`${Me}.align.center`,A_=`${Me}.align.right`,H_=`${Me}.align.justify`,N_=`${Me}.align.top`,D_=`${Me}.align.middle`,k_=`${Me}.align.bottom`,L_=`${Me}.borders`,$_=`${Me}.borders.top`,F_=`${Me}.borders.right`,V_=`${Me}.borders.bottom`,W_=`${Me}.borders.left`,B_=`${Me}.borders.remove`,j_=`${Me}.nestedHeaders.insertChildRow`,U_=`${Me}.nestedHeaders.detachFromParent`,z_=`${Me}.hideColumn`,Y_=`${Me}.showColumn`,G_=`${Me}.hideRow`,q_=`${Me}.showRow`,rr="Filters:",Bt=`${rr}conditions`,vw=`${Bt}.none`,K_=`${Bt}.isEmpty`,X_=`${Bt}.isNotEmpty`,Z_=`${Bt}.isEqualTo`,Q_=`${Bt}.isNotEqualTo`,J_=`${Bt}.beginsWith`,eT=`${Bt}.endsWith`,tT=`${Bt}.contains`,nT=`${Bt}.doesNotContain`,c9=`${Bt}.byValue`,rT=`${Bt}.greaterThan`,iT=`${Bt}.greaterThanOrEqualTo`,oT=`${Bt}.lessThan`,sT=`${Bt}.lessThanOrEqualTo`,aT=`${Bt}.isBetween`,lT=`${Bt}.isNotBetween`,uT=`${Bt}.after`,cT=`${Bt}.before`,hT=`${Bt}.today`,dT=`${Bt}.tomorrow`,fT=`${Bt}.yesterday`,gT=`${rr}labels.filterByCondition`,mT=`${rr}labels.filterByValue`,pT=`${rr}labels.conjunction`,Cw=`${rr}labels.disjunction`,np=`${rr}values.blankCells`,wT=`${rr}buttons.selectAll`,vT=`${rr}buttons.clear`,CT=`${rr}buttons.ok`,yT=`${rr}buttons.cancel`,bT=`${rr}buttons.placeholder.search`,ST=`${rr}buttons.placeholder.value`,RT=`${rr}buttons.placeholder.secondValue`,ET="CheckboxRenderer:",_T=`${ET}checked`,TT=`${ET}unchecked`,h9=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:_T,CHECKBOX_RENDERER_NAMESPACE:ET,CHECKBOX_UNCHECKED:TT,CONTEXTMENU_ITEMS_ADD_COMMENT:__,CONTEXTMENU_ITEMS_ALIGNMENT:P_,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:k_,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:x_,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:H_,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:O_,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:D_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:A_,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:N_,CONTEXTMENU_ITEMS_BORDERS:L_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:V_,CONTEXTMENU_ITEMS_BORDERS_LEFT:W_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:F_,CONTEXTMENU_ITEMS_BORDERS_TOP:$_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:m_,CONTEXTMENU_ITEMS_COPY:p_,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:C_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:v_,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:w_,CONTEXTMENU_ITEMS_CUT:y_,CONTEXTMENU_ITEMS_EDIT_COMMENT:T_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:b_,CONTEXTMENU_ITEMS_HIDE_COLUMN:z_,CONTEXTMENU_ITEMS_HIDE_ROW:G_,CONTEXTMENU_ITEMS_INSERT_LEFT:u_,CONTEXTMENU_ITEMS_INSERT_RIGHT:c_,CONTEXTMENU_ITEMS_MERGE_CELLS:R_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:U_,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:j_,CONTEXTMENU_ITEMS_NO_ITEMS:s_,CONTEXTMENU_ITEMS_READ_ONLY:tp,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:I_,CONTEXTMENU_ITEMS_REDO:g_,CONTEXTMENU_ITEMS_REMOVE_BORDERS:B_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:d_,CONTEXTMENU_ITEMS_REMOVE_COMMENT:M_,CONTEXTMENU_ITEMS_REMOVE_ROW:h_,CONTEXTMENU_ITEMS_ROW_ABOVE:a_,CONTEXTMENU_ITEMS_ROW_BELOW:l_,CONTEXTMENU_ITEMS_SHOW_COLUMN:Y_,CONTEXTMENU_ITEMS_SHOW_ROW:q_,CONTEXTMENU_ITEMS_UNDO:f_,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:S_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:E_,CONTEXT_MENU_ITEMS_NAMESPACE:S$,FILTERS_BUTTONS_CANCEL:yT,FILTERS_BUTTONS_CLEAR:vT,FILTERS_BUTTONS_OK:CT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:bT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:RT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:ST,FILTERS_BUTTONS_SELECT_ALL:wT,FILTERS_CONDITIONS_AFTER:uT,FILTERS_CONDITIONS_BEFORE:cT,FILTERS_CONDITIONS_BEGINS_WITH:J_,FILTERS_CONDITIONS_BETWEEN:aT,FILTERS_CONDITIONS_BY_VALUE:c9,FILTERS_CONDITIONS_CONTAINS:tT,FILTERS_CONDITIONS_EMPTY:K_,FILTERS_CONDITIONS_ENDS_WITH:eT,FILTERS_CONDITIONS_EQUAL:Z_,FILTERS_CONDITIONS_GREATER_THAN:rT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:iT,FILTERS_CONDITIONS_LESS_THAN:oT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:sT,FILTERS_CONDITIONS_NAMESPACE:Bt,FILTERS_CONDITIONS_NONE:vw,FILTERS_CONDITIONS_NOT_BETWEEN:lT,FILTERS_CONDITIONS_NOT_CONTAIN:nT,FILTERS_CONDITIONS_NOT_EMPTY:X_,FILTERS_CONDITIONS_NOT_EQUAL:Q_,FILTERS_CONDITIONS_TODAY:hT,FILTERS_CONDITIONS_TOMORROW:dT,FILTERS_CONDITIONS_YESTERDAY:fT,FILTERS_DIVS_FILTER_BY_CONDITION:gT,FILTERS_DIVS_FILTER_BY_VALUE:mT,FILTERS_LABELS_CONJUNCTION:pT,FILTERS_LABELS_DISJUNCTION:Cw,FILTERS_NAMESPACE:rr,FILTERS_VALUES_BLANK_CELLS:np},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const R$={languageCode:"en-US",[s_]:"No available options",[a_]:"Insert row above",[l_]:"Insert row below",[u_]:"Insert column left",[c_]:"Insert column right",[h_]:["Remove row","Remove rows"],[d_]:["Remove column","Remove columns"],[f_]:"Undo",[g_]:"Redo",[tp]:"Read only",[m_]:"Clear column",[P_]:"Alignment",[O_]:"Left",[x_]:"Center",[A_]:"Right",[H_]:"Justify",[N_]:"Top",[D_]:"Middle",[k_]:"Bottom",[b_]:"Freeze column",[S_]:"Unfreeze column",[L_]:"Borders",[$_]:"Top",[F_]:"Right",[V_]:"Bottom",[W_]:"Left",[B_]:"Remove border(s)",[__]:"Add comment",[T_]:"Edit comment",[M_]:"Delete comment",[I_]:"Read-only comment",[R_]:"Merge cells",[E_]:"Unmerge cells",[p_]:"Copy",[w_]:["Copy with header","Copy with headers"],[v_]:["Copy with group header","Copy with group headers"],[C_]:["Copy header only","Copy headers only"],[y_]:"Cut",[j_]:"Insert child row",[U_]:"Detach from parent",[z_]:["Hide column","Hide columns"],[Y_]:["Show column","Show columns"],[G_]:["Hide row","Hide rows"],[q_]:["Show row","Show rows"],[vw]:"None",[K_]:"Is empty",[X_]:"Is not empty",[Z_]:"Is equal to",[Q_]:"Is not equal to",[J_]:"Begins with",[eT]:"Ends with",[tT]:"Contains",[nT]:"Does not contain",[rT]:"Greater than",[iT]:"Greater than or equal to",[oT]:"Less than",[sT]:"Less than or equal to",[aT]:"Is between",[lT]:"Is not between",[uT]:"After",[cT]:"Before",[hT]:"Today",[dT]:"Tomorrow",[fT]:"Yesterday",[np]:"Blank cells",[gT]:"Filter by condition",[mT]:"Filter by value",[pT]:"And",[Cw]:"Or",[wT]:"Select all",[vT]:"Clear",[CT]:"OK",[yT]:"Cancel",[bT]:"Search",[ST]:"Value",[RT]:"Second value",[_T]:"Checked",[TT]:"Unchecked"},d9=h9,NR=R$.languageCode,{register:f9,getItem:E$,hasItem:g9,getValues:m9}=Gi("languagesDictionaries");_$(R$);function _$(t,e){let n=t,r=e;return xe(t)&&(r=t,n=r.languageCode),p9(n,r),f9(n,jn(r)),jn(r)}function p9(t,e){t!==NR&&i9(e,E$(NR))}function T$(t){return MT(t)?jn(E$(t)):null}function MT(t){return g9(t)}function w9(){return m9()}function M$(t,e,n){const r=T$(t);if(r===null)return null;const i=r[e];if(Pt(i))return null;const o=v9(i,n);return Array.isArray(o)?o[0]:o}function v9(t,e){let n=t;return I(u9(),r=>{n=r(t,e)}),n}function C9(t){let e=y$(t);return MT(e)||(e=NR,b$(t)),e}function y9(t,e,n){return(e=b9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b9(t){var e=S9(t,"string");return typeof e=="symbol"?e:e+""}function S9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ps extends n${constructor(e,n){super(e,null),y9(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function ab(t){let{activeHeaderClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:r$})}function R9(t){let{areaCornerVisible:e,...n}=t;return new Ps({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:B0})}function E9(t){let{...e}=t;return new Ps({className:"highlight",...e,selectionType:B0})}function _9(t){let{columnClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:kX})}function T9(t){let{cellCornerVisible:e,...n}=t;return new Ps({className:"current",headerAttributes:[d0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:ud})}function M9(t){let{border:e,visualCellRange:n,...r}=t;return new Ps({...e,...r,selectionType:LX},n)}function I9(t){let{...e}=t;return new Ps({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:NX})}function nA(t){let{headerClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:W0})}function P9(t){let{rowClassName:e,...n}=t;return new Ps({className:e,...n,selectionType:DX})}function O9(t,e){x9(t,e),e.add(t)}function x9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ar(t,e,n){return(e=A9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A9(t){var e=H9(t,"string");return typeof e=="symbol"?e:e+""}function H9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Qi=new WeakSet;class N9{constructor(e){O9(this,Qi),ar(this,"options",void 0),ar(this,"layerLevel",0),ar(this,"focus",void 0),ar(this,"fill",void 0),ar(this,"layeredAreas",new Map),ar(this,"areas",new Map),ar(this,"rowHeaders",new Map),ar(this,"columnHeaders",new Map),ar(this,"activeRowHeaders",new Map),ar(this,"activeColumnHeaders",new Map),ar(this,"activeCornerHeaders",new Map),ar(this,"rowHighlights",new Map),ar(this,"columnHighlights",new Map),ar(this,"customSelections",[]),this.options=e,this.focus=T9(e),this.fill=I9(e)}isEnabledFor(e,n){let r=e;e===ud&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Yo(Qi,this,Go).call(this,this.layeredAreas,R9)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Yo(Qi,this,Go).call(this,this.areas,E9)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Yo(Qi,this,Go).call(this,this.rowHeaders,nA)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Yo(Qi,this,Go).call(this,this.columnHeaders,nA)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Yo(Qi,this,Go).call(this,this.activeRowHeaders,ab)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Yo(Qi,this,Go).call(this,this.activeColumnHeaders,ab)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Yo(Qi,this,Go).call(this,this.activeCornerHeaders,ab)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Yo(Qi,this,Go).call(this,this.rowHighlights,P9)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Yo(Qi,this,Go).call(this,this.columnHighlights,_9)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(M9({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),I(this.areas.values(),e=>void e.clear()),I(this.layeredAreas.values(),e=>void e.clear()),I(this.rowHeaders.values(),e=>void e.clear()),I(this.columnHeaders.values(),e=>void e.clear()),I(this.activeRowHeaders.values(),e=>void e.clear()),I(this.activeColumnHeaders.values(),e=>void e.clear()),I(this.activeCornerHeaders.values(),e=>void e.clear()),I(this.rowHighlights.values(),e=>void e.clear()),I(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Go(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function rA(t,e,n){return(e=D9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D9(t){var e=k9(t,"string");return typeof e=="symbol"?e:e+""}function k9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L9{constructor(e){rA(this,"ranges",[]),rA(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function $9(t,e){I$(t,e),e.add(t)}function lb(t,e,n){I$(t,e),e.set(t,n)}function I$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){return t.get(ln(t,e))}function eg(t,e,n){return t.set(ln(t,e),n),n}function ln(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tg=new WeakMap,Ct=new WeakMap,Vi=new WeakMap,wn=new WeakSet;class DR{constructor(e,n){$9(this,wn),lb(this,tg,void 0),lb(this,Ct,void 0),lb(this,Vi,{x:0,y:0}),eg(tg,this,e),eg(Ct,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ke(Ct,this).createCellCoords(e,n);let o=Ke(tg,this).current().highlight;const s=Ke(Ct,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=ln(wn,this,P$).call(this),{row:h,col:d}=ln(wn,this,oA).call(this,o),f=Ke(Ct,this).fixedRowsBottom(),g=Ke(Ct,this).minSpareRows(),C=Ke(Ct,this).minSpareCols(),y=Ke(Ct,this).autoWrapRow(),E=Ke(Ct,this).autoWrapCol(),p=Ke(Ct,this).createCellCoords(h+i.row,d+i.col);if(p.row>=c){const D=Rr(r&&g>0&&f===0),M=p.col+1,x=Ke(Ct,this).createCellCoords(p.row-c,M>=u?M-u:M);this.runLocalHooks("beforeColumnWrap",D,ln(wn,this,gu).call(this,x),M>=u),D.value?this.runLocalHooks("insertRowRequire",Ke(Ct,this).countRenderableRows()):E&&p.assign(x)}else if(p.row<0){const D=Rr(E),M=p.col-1,x=Ke(Ct,this).createCellCoords(c+p.row,M<0?u+M:M);this.runLocalHooks("beforeColumnWrap",D,ln(wn,this,gu).call(this,x),M<0),E&&p.assign(x)}if(p.col>=u){const D=Rr(r&&C>0),M=p.row+1,x=Ke(Ct,this).createCellCoords(M>=c?M-c:M,p.col-u);this.runLocalHooks("beforeRowWrap",D,ln(wn,this,gu).call(this,x),M>=c),D.value?this.runLocalHooks("insertColRequire",Ke(Ct,this).countRenderableColumns()):y&&p.assign(x)}else if(p.col<0){const D=Rr(y),M=p.row-1,x=Ke(Ct,this).createCellCoords(M<0?c+M:M,u+p.col);this.runLocalHooks("beforeRowWrap",D,ln(wn,this,gu).call(this,x),M<0),y&&p.assign(x)}const{rowDir:_,colDir:P}=ln(wn,this,iA).call(this,p);a=_,l=P,o=ln(wn,this,gu).call(this,p)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Ke(Ct,this).createCellCoords(e,n),i=Ke(tg,this).current(),o=Ke(Ct,this).visualToRenderableCoords(i.highlight),s=ln(wn,this,ub).call(this,i.to.row,i.from.row),a=ln(wn,this,cb).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=ln(wn,this,oA).call(this,i.highlight),f=Ke(Ct,this).createCellCoords(s+r.row,a+r.col),g=i.getTopStartCorner(),C=i.getTopEndCorner(),y=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const P=f.col-d;f.col=ln(wn,this,cb).call(this,g.col,C.col)+P}else if(r.col>0&&a<=d&&f.col>d){const P=ln(wn,this,cb).call(this,C.col,g.col),D=Math.max(f.col-P,1);f.col=P+D}if(r.row<0&&s>=h&&f.row<h){const P=f.row-h;f.row=ln(wn,this,ub).call(this,g.row,y.row)+P}else if(r.row>0&&s<=h&&f.row>h){const P=ln(wn,this,ub).call(this,y.row,g.row),D=Math.max(f.row-P,1);f.row=P+D}const{rowDir:E,colDir:p}=ln(wn,this,iA).call(this,f);u=E,c=p;const _=ln(wn,this,gu).call(this,f);r.row===0&&r.col!==0?l.col=_.col:r.row!==0&&r.col===0?l.row=_.row:(l.row=_.row,l.col=_.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;eg(Vi,this,{x:n,y:r})}resetOffsetSize(){eg(Vi,this,{x:0,y:0})}}function iA(t){const{width:e,height:n}=ln(wn,this,P$).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function P$(){return{width:Ke(Vi,this).x+Ke(Ct,this).countRenderableColumns(),height:Ke(Vi,this).y+Ke(Ct,this).countRenderableRows()}}function ub(t,e){const n=Ke(Ct,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ke(Vi,this).y+n}function cb(t,e){const n=Ke(Ct,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ke(Vi,this).x+n}function oA(t){const{row:e,col:n}=Ke(Ct,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ke(Ct,this).createCellCoords(Ke(Vi,this).y+e,Ke(Vi,this).x+n)}function gu(t){const e=t.clone();return e.col=t.col-Ke(Vi,this).x,e.row=t.row-Ke(Vi,this).y,Ke(Ct,this).renderableToVisualCoords(e)}ut(DR,On);const yw=0,bw=1,O$=2,IT=3,F9=[IT,O$],V9=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],hb=Symbol("root"),sA=Symbol("child");function mc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hb;if(e!==hb&&e!==sA)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===hb;let i=yw;if(n){const o=t[0];t.length===0?i=bw:r&&o instanceof pf?i=IT:r&&Array.isArray(o)?i=mc(o,sA):t.length>=2&&t.length<=4&&!t.some((a,l)=>!V9[l].includes(typeof a))&&(i=O$)}return i}function Wd(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!F9.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===IT;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Pt(u)&&(u=a),Pt(c)&&(c=l),!r){const f=a,g=l,C=u,y=c;a=Math.min(f,C),l=Math.min(g,y),u=Math.max(f,C),c=Math.max(g,y)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function W9(t){const e=mc(t.getSelected());if(e===yw||e===bw)return[];const n=Wd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;I(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;I(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return gn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function B9(t){const e=mc(t.getSelected());if(e===yw||e===bw)return[];const n=Wd(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;I(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;I(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return gn(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function mu(t,e,n){j9(t,e),e.set(t,n)}function j9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(t,e,n){return(e=U9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U9(t){var e=z9(t,"string");return typeof e=="symbol"?e:e+""}function z9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _t(t,e){return t.get(x$(t,e))}function Ji(t,e,n){return t.set(x$(t,e),n),n}function x$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hn=new WeakMap,Fa=new WeakMap,ng=new WeakMap,uh=new WeakMap,rg=new WeakMap,ch=new WeakMap;class A${constructor(e,n){var r=this;$a(this,"settings",void 0),$a(this,"tableProps",void 0),$a(this,"inProgress",!1),$a(this,"selectedRange",new L9((i,o,s)=>this.tableProps.createCellRange(i,o,s))),$a(this,"highlight",void 0),mu(this,Hn,void 0),mu(this,Fa,void 0),$a(this,"selectedByRowHeader",new Set),$a(this,"selectedByColumnHeader",new Set),mu(this,ng,!1),mu(this,uh,!1),mu(this,rg,"unknown"),mu(this,ch,-1),this.settings=e,this.tableProps=n,this.highlight=new N9({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[d0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Ji(Hn,this,new DR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Ji(Fa,this,new DR(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_t(Hn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),_t(Hn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),_t(Hn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),_t(Hn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),_t(Hn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),_t(Hn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),_t(Hn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),_t(Hn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),_t(Fa,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),_t(Fa,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Ji(rg,this,e)}markEndSource(){Ji(rg,this,"unknown")}getSelectionSource(){return _t(rg,this)}setExpectedLayers(e){Ji(ch,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Ji(ch,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Pt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Ji(ng,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Pt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=_t(ch,this)===-1||this.selectedRange.size()===_t(ch,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(I(this.highlight.getAreas(),g=>void g.clear()),I(this.highlight.getLayeredAreas(),g=>void g.clear()),I(this.highlight.getRowHeaders(),g=>void g.clear()),I(this.highlight.getColumnHeaders(),g=>void g.clear()),I(this.highlight.getActiveRowHeaders(),g=>void g.clear()),I(this.highlight.getActiveColumnHeaders(),g=>void g.clear()),I(this.highlight.getActiveCornerHeaders(),g=>void g.clear()),I(this.highlight.getRowHighlights(),g=>void g.clear()),I(this.highlight.getColumnHighlights(),g=>void g.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(B0,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(W0,e.highlight)){if(!e.isSingleHeader()){const y=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),p=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),_=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(y).commit(),l.add(p).commit(),d.add(y).commit(),f.add(p).commit()):(a.add(y).add(E).commit(),l.add(p).add(_).commit(),d.add(y).add(E).commit(),f.add(p).add(_).commit())}const g=!_t(uh,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),C=!_t(uh,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());g&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),C&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&C&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(ud,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Ji(ng,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?_t(Hn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_t(Hn,this).resetOffsetSize(),this.setRangeStart(_t(Hn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?_t(Hn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):_t(Hn,this).resetOffsetSize(),this.setRangeEnd(_t(Hn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?_t(Fa,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):_t(Fa,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=_t(Fa,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ue(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ue(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ue(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ue(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ue(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ue(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=Rr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&_t(ng,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Ji(uh,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ue(d.row,u,o-1),Ue(d.col,c,s-1)));const g=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(g,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),Ji(uh,this,!1)}selectCells(e){var n=this;const r=mc(e);if(r===bw)return!1;if(r===yw)throw new Error(ot`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Wd(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),I(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(f=Ue(r.row,u,s-1),g=Ue(r.col,Math.min(i,o),Math.max(i,o))):(f=Ue(r,u,s-1),g=i);const C=this.tableProps.createCellCoords(f,g),y=l===0?0:Ue(C.row,u,-1),E=s-1,p=this.tableProps.createCellCoords(y,i),_=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",p,_,C),p.row=y,_.row=E,this.setRangeStartOnly(p,void 0,C),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(_),this.runLocalHooks("afterSelectColumns",p,_,C),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r==null?void 0:r.row)&&Number.isInteger(r==null?void 0:r.col)?(h=Ue(r.row,Math.min(e,n),Math.max(e,n)),d=Ue(r.col,a,o-1)):(h=e,d=Ue(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),g=s===0?0:Ue(f.col,a,-1),C=o-1,y=this.tableProps.createCellCoords(e,g),E=this.tableProps.createCellCoords(n,C);this.runLocalHooks("beforeSelectRows",y,E,f),y.col=g,E.col=C,this.setRangeStartOnly(y,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",y,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=r;this.clear(),s.assign({row:Ue(s.row,-1/0,e-1),col:Ue(s.col,-1/0,n-1)}),i.assign({row:Ue(i.row,-1/0,e-1),col:Ue(i.col,-1/0,n-1)}),o.assign({row:Ue(o.row,0,e-1),col:Ue(o.col,0,n-1)}),this.selectedRange.ranges.push(r),this.highlight.isEnabledFor(ud,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(ud,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ut(A$,On);const aA=/^(\r\n|\n\r|\r|\n)/,Y9=/^[^\t\r\n]+/,lA=/^\t/;function G9(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(lA))t=t.replace(lA,""),n+=1,e[r][n]="";else if(t.match(aA))t=t.replace(aA,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(Y9);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function hd(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Va(t,e,n){return(e=q9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q9(t){var e=K9(t,"string");return typeof e=="symbol"?e:e+""}function K9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Va(this,"hot",void 0),Va(this,"metaManager",void 0),Va(this,"tableMeta",void 0),Va(this,"dataSource",void 0),Va(this,"duckSchema",void 0),Va(this,"colToPropCache",void 0),Va(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=uw(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(xe(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return J0(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ae(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ae(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ae(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?fc(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=jn(this.getSchema()):(g=[],fe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},gf(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,g=c;i==="end"&&(g=Math.min(g+1,a));const C=g;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(g,0,null);f+=1,g+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(C,n));const y=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",y,f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ae(this.tableMeta.columns)||ae(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];gR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return qk(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];gR(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Jt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=Rr(a);this.hot.runHooks("modifyData",r,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=Rr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Jt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Qu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Qu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return hd(this.getRange(e,n,Qu.DESTINATION_RENDERER))}getCopyableText(e,n){return hd(this.getRange(e,n,Qu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:X9,getItem:Z9,hasItem:H$,getNames:Q9,getValues:wde}=Gi("cellTypes");function PT(t){if(!H$(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Z9(t)}function Zr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&mr(t,n),r&&Nr(t,r),i&&bl(t,i),X9(t,e)}function J9(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Jt(e,t)}function Sw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?PT(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ae(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!xe(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ae(r,(o,s)=>{if(J9(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),tn(t,i)}function e6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}bL(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Sm(t){return Number.isInteger(t)&&t>=0}function Rm(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function ig(t){return t==null}const N$=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Wt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Wt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),lw(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function uA(t,e,n){return(e=t6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t6(t){var e=n6(t,"string");return typeof e=="symbol"?e:e+""}function n6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r6(){return class{}}class i6{constructor(e){uA(this,"metaCtor",r6()),uA(this,"meta",void 0),this.meta=this.metaCtor.prototype,tn(this.meta,N$()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;tn(this.meta,e),Sw(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function o6(t,e,n){return(e=s6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s6(t){var e=a6(t,"string");return typeof e=="symbol"?e:e+""}function a6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l6{constructor(e){o6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){tn(this.meta,e),Sw(this.meta,e,e)}}function og(t,e,n){return(e=u6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u6(t){var e=c6(t,"string");return typeof e=="symbol"?e:e+""}function c6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rp{constructor(e){og(this,"valueFactory",void 0),og(this,"data",[]),og(this,"index",[]),og(this,"holes",new Set),this.valueFactory=e}obtain(e){Rm(()=>Sm(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Rm(()=>Sm(e)||ig(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=ig(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Rm(()=>Sm(e)||ig(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(ig(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function cA(t,e,n){return(e=h6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h6(t){var e=d6(t,"string");return typeof e=="symbol"?e:e+""}function d6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const f6=["data","width"];class g6{constructor(e){cA(this,"globalMeta",void 0),cA(this,"metas",new rp(()=>this._createMeta())),this.globalMeta=e,this.metas=new rp(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);tn(r,n),Sw(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return e6(this.globalMeta.getMetaConstructor(),f6).prototype}}function hA(t,e,n){return(e=m6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m6(t){var e=p6(t,"string");return typeof e=="symbol"?e:e+""}function p6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w6{constructor(e){hA(this,"columnMeta",void 0),hA(this,"metas",new rp(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);tn(i,r),Sw(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ae(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Rm(()=>Sm(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new rp(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class D${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new i6(e),this.tableMeta=new l6(this.globalMeta),this.columnMeta=new g6(this.globalMeta),this.cellMeta=new w6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ut(D$,On);function dA(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Bn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":it(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Qu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let C,y=0,E=0;for(y=0,E=d.startRows;y<E;y++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)C=jn(g),t.push(C);else if(i.dataType==="array")C=jn(g[0]),t.push(C);else{C=[];for(let p=0,_=d.startCols;p<_;p++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ye(i.rootElement,[rL(-1),rw(i.countCols()+(i.view?i.countRowHeaders():0))])}function fA(t,e,n){return(e=v6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v6(t){var e=C6(t,"string");return typeof e=="symbol"?e:e+""}function C6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y6{constructor(e){var n=this;fA(this,"metaManager",void 0),fA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ie.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Jt(e,"type")?e.type:null;let c=it(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function b6(t,e,n){S6(t,e),e.set(t,n)}function S6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function db(t,e,n){return(e=R6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R6(t){var e=E6(t,"string");return typeof e=="symbol"?e:e+""}function E6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _6(t,e){return t.get(T6(t,e))}function T6(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gA=new WeakMap;class M6{constructor(e){db(this,"metaManager",void 0),db(this,"usageTracker",new Set),db(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),b6(this,gA,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,_6(gA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const k$="gridDefault",Pa="editorManager.handlingEditor",I6={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},P6="hooksRefRegisterer",L$={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){I(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ae(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ko(L$,"MIXIN_NAME",P6,{writable:!1,enumerable:!1});function _i(t,e,n){return(e=O6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O6(t){var e=x6(t,"string");return typeof e=="symbol"?e:e+""}function x6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const A6="base",Gt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Nc{static get EDITOR_TYPE(){return A6}constructor(e){_i(this,"hot",void 0),_i(this,"state",Gt.VIRGIN),_i(this,"_opened",!1),_i(this,"_fullEditMode",!1),_i(this,"_closeCallback",null),_i(this,"TD",null),_i(this,"row",null),_i(this,"col",null),_i(this,"prop",null),_i(this,"originalValue",null),_i(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Gt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Gt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Gt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:yt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Gt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Gt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Gt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Gt.FINISHED,this.discardEditor(s)}):(this.state=Gt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Gt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Gt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Gt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Gt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Gt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Pn(n),a=Kt(n),l=Pn(this.hot.rootElement),u=Kt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,g=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=C.name,E=["master","inline_start"].includes(y)?d:0,p=["master","top","bottom"].includes(y)?f:0,_=s.top===l.top?0:1;let P=s.top-l.top-_-E,D=0;this.hot.isRtl()?D=o.innerWidth-s.left-a-g-1+p:D=s.left-l.left-1-p,["top","top_inline_start_corner"].includes(y)&&(P+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(D+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const M=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),B=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(M&&x<=0||x===B)&&(P+=1),Y<=0&&(D+=1);const Z=i.rowsRenderCalculator.startPosition,Q=i.columnsRenderCalculator.startPosition,se=Math.abs(r.inlineStartOverlay.getScrollPosition()),te=r.topOverlay.getScrollPosition(),le=yn(this.hot.rootDocument);let ct=n.offsetTop;if(["inline_start","master"].includes(y)&&(ct+=Z-te),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:G,wtTable:K}=r.bottomOverlay.clone;ct+=G.getWorkspaceHeight()-K.getHeight()-le}let be=n.offsetLeft;this.hot.isRtl()?(be>=0?be=C.getWidth()-n.offsetLeft:be=Math.abs(be),be+=Q-se-a):["top","master","bottom"].includes(y)&&(be+=Q-se);const He=o.getComputedStyle(this.TD),ft=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",jt=parseInt(He[ft],10)>0?0:1,Ze=parseInt(He.borderTopWidth,10)>0?0:1,m=Kt(n)+jt,v=en(n)+Ze,w=v0(c)?le:0,A=C0(h)?le:0,F=this.hot.view.maximumVisibleElementWidth(be)-w+jt,j=Math.max(this.hot.view.maximumVisibleElementHeight(ct)-A+Ze,this.hot.view.getDefaultRowHeight());return{top:P,start:D,height:v,maxHeight:j,width:m,maxWidth:F}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ut(Nc,L$);const H6={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Gt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},N6={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},D6={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},k6={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},L6={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),vi(e))}};function $6(){return[I6,H6,N6,D6,k6,L6]}const F6={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},V6={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},W6={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},B6={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},j6={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},U6={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},z6={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Y6={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},G6={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},q6={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},K6={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},X6={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},Z6={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},Q6={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function J6(){return[F6,V6,W6,B6,j6,U6,z6,Y6,G6,q6,K6,X6,Z6,Q6]}const e8={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},t8={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},n8={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},r8={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},i8={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},o8={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},s8={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},a8={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},l8={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},u8={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},c8={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},h8={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},d8={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},f8={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},g8={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},m8={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function p8(){return[e8,t8,n8,r8,i8,o8,s8,a8,l8,u8,c8,h8,d8,f8,g8,m8]}const w8={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},v8={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},C8={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},y8={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},b8={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},S8=[...$6(),...J6(),...p8(),w8,v8,C8,y8,b8];function $$(t){const e={};return S8.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function R8(t){const e=t.getShortcutManager().addContext("editor"),n=$$(t),r={group:Pa};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function E8(t){const e=t.getShortcutManager().addContext("grid"),n=$$(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ae(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:k$};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Pa,runOnlyIf:()=>ae(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function _8(t){[E8,R8].forEach(e=>e(t))}function T8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=mA(t),i=mA(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function mA(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ye(n,[Hd("Focus catcher")]),n}function M8(t){const e=I8(t);let n;const{activate:r,deactivate:i}=T8(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:kR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:LR(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,g,C)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,C.value=!0),s){var y;n=(y=t.getSelectedRangeLast())===null||y===void 0?void 0:y.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:k$,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?kR(t):LR(t)),u(),!1;h.preventDefault()},position:"after"}])}function kR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function LR(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function I8(t){return e=>{if(!e)return null;const n=kR(t),r=LR(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function Dc(t){To(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Rw(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,C=f<=h,y=g>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:C&&y?r.highlight.row:C?f:y?g:E.row}}}function P8(t){return e=>{const n=Rw(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;Dc(t.getCell(r?-1:0,n,!0))})}}function O8(){return()=>{}}function x8(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;Dc(t.getCell(n,r,!0))})}}function A8(t){return e=>{const n=Rw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Dc(t.getCell(i,o,!0))})}}function H8(t){return e=>{const n=Rw(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;Dc(t.getCell(i,o,!0))})}}function N8(t){return e=>{const n=Rw(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;Dc(t.getCell(n,r?-1:0,!0))})}}function D8(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{Dc(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function k8(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=x8(t):e.isSelectedByCorner()?s=O8():e.isSelectedByRowHeader()?s=N8(t):e.isSelectedByColumnHeader()?s=P8(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=A8(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=D8(t):e.getSelectedRange().size()>1&&(s=H8(t)),(o=s)===null||o===void 0||o(i)}}}const pA=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),sg=t=>t.map(e=>{const n=e.toLowerCase();return pA.has(n)?pA.get(n):n}).sort().join("+"),L8=t=>t.split("+"),wA=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),fb=t=>{let{which:e,key:n}=t;if(wA.has(e))return wA.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},F$=Symbol("shortcut-context");function V$(t){return xe(t)&&t.__kindOf===F$}const $8=t=>{const e=dw({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:g=!1,relativeToGroup:C,position:y,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Pt(c))throw new Error("You need to define the shortcut's group.");if(it(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ot`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const p={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:g};ae(C)&&(p.relativeToGroup=C,p.position=y),V$(E)&&(p.forwardToContext=E),l.forEach(_=>{const P=sg(_);if(e.hasItem(P)){const M=e.getItem(P);let x=M.findIndex(Y=>Y.group===C);x!==-1?y==="before"?x-=1:x+=1:x=M.length,M.splice(x,0,p)}else e.addItem(P,[p])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ae(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=sg(l);e.removeItem(u)};return{__kindOf:F$,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=sg(l),c=e.getItem(u);return ae(c)?c.slice():[]},hasShortcut:l=>{const u=sg(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(g=>g.group!==l);f.length===0?i(L8(h)):(d.length=0,d.push(...f))})}}};function F8(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const V8=["meta","alt","shift","control"],hh=F8(),dh=[];let ag=0;function W8(t,e,n,r,i){const o=f=>V8.includes(f),s=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return f.altKey&&C.push("alt"),g&&(f.ctrlKey||f.metaKey)?C.push("control/meta"):(f.ctrlKey&&C.push("control"),f.metaKey&&C.push("meta")),f.shiftKey&&C.push("shift"),C},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||ea(f))return;const C=fb(f);let y=[];o(C)||(y=s(f));const E=[C].concat(y);!i(f,E)&&(Zm()&&y.includes("meta")||!Zm()&&y.includes("control"))&&i(f,[C].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const g=fb(f);o(g)&&hh.press(g)}},u=f=>{if(typeof f.key=="string"){const g=fb(f);o(g)&&hh.release(g)}},c=()=>{hh.releaseAll()};return{mount:()=>{let f=t;for(ag+=1;f;)ag===1&&(f.document.documentElement.addEventListener("keydown",l),dh.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),dh.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Nl(f)},unmount:()=>{let f=t;for(ag-=1;f;){if(ag===0){for(let g=0;g<dh.length;g++){const{event:C,listener:y}=dh[g];f.document.documentElement.removeEventListener(C,y)}dh.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Nl(f)}},isPressed:f=>hh.isPressed(f),releasePressedKeys:()=>hh.releaseAll()}}const B8=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=dw({errorIdExists:g=>`The "${g}" context name is already registered.`});let s="grid";const a=g=>{const C=$8(g);return o.addItem(g,C),C},l=()=>s,u=g=>o.getItem(g),c=g=>{if(!o.hasItem(g))throw new Error(ot`You've tried to activate the "${g}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=g};let h=!1;const d=function(g,C){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=V$(y)?y:u(y);let p=!1;if(!E.hasShortcut(C))return p;const _=E.getShortcuts(C);for(let P=0;P<_.length;P++){const{callback:D,runOnlyIf:M,preventDefault:x,stopPropagation:Y,captureCtrl:U,forwardToContext:B}=_[P];if(M(g)===!0){if(h=U,p=D(g,C)===!1,h=!1,x&&g.preventDefault(),Y&&(vi(g),g.stopPropagation()),p)break;B&&d(g,C,B)}}return p},f=W8(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function vA(t){const{classNames:e}=lL(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let gb=null;const mb=new Map;function W$(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new di(o);let a,l,u,c,h,d,f=!0;C4(i)&&v4(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=C9(e.language);const y=Object.fromEntries(Object.entries(e).filter(m=>{let[v]=m;return!(ie.getSingleton().isRegistered(v)||ie.getSingleton().isDeprecated(v))})),E=new D$(o,y,[y6,M6]),p=E.getTableMeta(),_=E.getGlobalMeta(),P=dw();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),bm(this)&&(Jk(e.licenseKey,t),q(t,"ht-wrapper")),this.guid=`ht_${l0()}`,mb.set(this.guid,this),this.columnIndexMapper=new HR,this.rowIndexMapper=new HR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterColumnSequenceChange",m)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",m=>{o.runHooks("afterRowSequenceChange",m)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",m=>{o.runHooks("beforeCompositionStart",m)}),l=new D4(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const D=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getRenderableFromVisualIndex(v):v,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},M=m=>{const{row:v,col:w}=m;return o._createCellCoords(v>=0?o.rowIndexMapper.getVisualFromRenderableIndex(v):v,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},x=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),F=Math.max(m,v),j=o.rowIndexMapper.getNearestNotHiddenIndex(m,w);return j===null||w===1&&j>F||w===-1&&j<A?null:j>=0?o.rowIndexMapper.getRenderableFromVisualIndex(j):j},Y=(m,v)=>{const w=v>m?1:-1,A=Math.min(m,v),F=Math.max(m,v),j=o.columnIndexMapper.getNearestNotHiddenIndex(m,w);return j===null||w===1&&j>F||w===-1&&j<A?null:j>=0?o.columnIndexMapper.getRenderableFromVisualIndex(j):j};let U=new A$(p,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:m=>a.propToCol(m),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(m,v)=>o._createCellCoords(m,v),createCellRange:(m,v,w)=>o._createCellRange(m,v,w),visualToRenderableCoords:D,renderableToVisualCoords:M,findFirstNonHiddenRenderableRow:x,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(m,v)=>m<0||v<0?o.getSettings().disableVisualSelection:o.getCellMeta(m,v).disableVisualSelection});this.selection=U;const B=m=>{let{hiddenIndexesChanged:v}=m;this.forceFullRender=!0,v&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("afterSetRangeEnd",(m,v)=>{const w=Rr(!1),A=this.selection.getSelectedRange(),{from:F,to:j}=A.current(),G=A.size()-1;this.runHooks("afterSelection",F.row,F.col,j.row,j.col,w,G),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),j.row,o.colToProp(j.col),w,G),v&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(m);const K=U.isSelectedByRowHeader(),b=U.isSelectedByColumnHeader();K&&b?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):K?(pe(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):b?(pe(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),U.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",m=>{this.runHooks("beforeSelectionFocusSet",m.row,m.col)}),this.selection.addLocalHook("afterSetFocus",m=>{const v=Rr(!1);this.runHooks("afterSelectionFocusSet",m.row,m.col,v),(!v.isTouched()||v.isTouched()&&!v.value)&&d.scrollTo(m),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",m=>{const v=m.length-1,{from:w,to:A}=m[v];this.runHooks("afterSelectionEnd",w.row,w.col,A.row,A.col,v),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),A.row,o.colToProp(A.col),v)}),this.selection.addLocalHook("afterIsMultipleSelection",m=>{const v=this.runHooks("afterIsMultipleSelection",m.value);m.value&&(m.value=v)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...v)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...v)}).addLocalHook("beforeSetRangeEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...v)}).addLocalHook("beforeSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectColumns",...v)}).addLocalHook("afterSelectColumns",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectColumns",...v)}).addLocalHook("beforeSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeSelectRows",...v)}).addLocalHook("afterSelectRows",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterSelectRows",...v)}).addLocalHook("beforeModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformStart",...v)}).addLocalHook("afterModifyTransformStart",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...v)}).addLocalHook("beforeModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformFocus",...v)}).addLocalHook("afterModifyTransformFocus",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformFocus",...v)}).addLocalHook("beforeModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("modifyTransformEnd",...v)}).addLocalHook("afterModifyTransformEnd",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...v)}).addLocalHook("beforeRowWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeRowWrap",...v)}).addLocalHook("beforeColumnWrap",function(){for(var m=arguments.length,v=new Array(m),w=0;w<m;w++)v[w]=arguments[w];return r.runHooks("beforeColumnWrap",...v)}).addLocalHook("insertRowRequire",m=>this.alter("insert_row_above",m,1,"auto")).addLocalHook("insertColRequire",m=>this.alter("insert_col_start",m,1,"auto")),u={alter(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const j=G=>{if(G.length===0)return[];const K=[...G];return K.sort((R,S)=>{let[O]=R,[T]=S;return O===T?0:O>T?1:-1}),gn(K,(R,S)=>{let[O,T]=S;const k=R[R.length-1],[W,H]=k,N=W+H;if(O<=N){const V=Math.max(T-(N-O),0);k[1]+=V}else R.push([O,T]);return R},[K[0]])};switch(m){case"insert_row_below":case"insert_row_above":const G=o.countSourceRows();if(p.maxRows===G)return;const K=m==="insert_row_below"?"below":"above";v=v??(K==="below"?G:0);const{delta:b,startPhysicalIndex:R}=a.createRow(v,w,{source:A,mode:K});U.shiftRows(o.toVisualRow(R),b);break;case"insert_col_start":case"insert_col_end":const S=m==="insert_col_end"?"end":"start";v=v??(S==="end"?o.countSourceCols():0);const{delta:O,startPhysicalIndex:T}=a.createCol(v,w,{source:A,mode:S});if(O){if(Array.isArray(p.colHeaders)){const H=[o.toVisualColumn(T),0];H.length+=O,Array.prototype.splice.apply(p.colHeaders,H)}U.shiftColumns(o.toVisualColumn(T),O)}break;case"remove_row":const k=H=>{let N=0;I(H,V=>{let[$,z]=V;const ne=Wt($)?o.countRows()-1:Math.max($-N,0);if(Number.isInteger($)&&($=Math.max($-N,0)),!a.removeRow($,z,A))return;if(U.isSelected()){const{row:Re}=o.getSelectedRangeLast().highlight;Re>=$&&Re<=$+z-1&&c.closeEditor(!0)}const Ee=o.countRows(),ke=p.fixedRowsTop;ke>=ne+1&&(p.fixedRowsTop-=Math.min(z,ke-ne));const je=p.fixedRowsBottom;je&&ne>=Ee-je&&(p.fixedRowsBottom-=Math.min(z,je)),Ee===0?U.deselect():A==="ContextMenu.removeRow"?U.refresh():U.shiftRows($,-z),N+=z})};Array.isArray(v)?k(j(v)):k([[v,w]]);break;case"remove_col":const W=H=>{let N=0;I(H,V=>{let[$,z]=V;const ne=Wt($)?o.countCols()-1:Math.max($-N,0);let ce=o.toPhysicalColumn(ne);if(Number.isInteger($)&&($=Math.max($-N,0)),!a.removeCol($,z,A))return;if(U.isSelected()){const{col:Re}=o.getSelectedRangeLast().highlight;Re>=$&&Re<=$+z-1&&c.closeEditor(!0)}o.countCols()===0?U.deselect():A==="ContextMenu.removeColumn"?U.refresh():U.shiftColumns($,-z);const je=p.fixedColumnsStart;je>=ne+1&&(p.fixedColumnsStart-=Math.min(z,je-ne)),Array.isArray(p.colHeaders)&&(typeof ce>"u"&&(ce=-1),p.colHeaders.splice(ce,z)),N+=z})};Array.isArray(v)?W(j(v)):W([[v,w]]);break;default:throw new Error(`There is no such action "${m}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const m=p.minRows,v=p.minSpareRows,w=p.minCols,A=p.minSpareCols;if(m){const F=o.countRows();F<m&&a.createRow(F,m-F,{source:"auto"})}if(v){const F=o.countEmptyRows(!0);if(F<v){const j=v-F,G=Math.min(j,p.maxRows-o.countSourceRows());a.createRow(o.countRows(),G,{source:"auto"})}}{let F;(w||A)&&(F=o.countEmptyCols(!0));let j=o.countCols();if(w&&!p.columns&&j<w){const G=w-j;F+=G,a.createCol(j,G,{source:"auto"})}if(A&&!p.columns&&o.dataType==="array"&&F<A){j=o.countCols();const G=A-F,K=Math.min(G,p.maxCols-j);a.createCol(j,K,{source:"auto"})}}},populateFromArray(m,v,w,A,F){let j,G,K,b;const R=[],S={},O=[],T=m.row,k=m.col;if(G=v.length,G===0)return!1;let W=0,H=0;switch(xe(w)&&(W=w.col-k+1,H=w.row-T+1),F){case"shift_down":const N=id(v),V=N.length,$=Math.max(V,W),z=o.getData().slice(T),ne=id(z).slice(k,k+$);for(K=0;K<$;K+=1)if(K<V){for(j=0,G=N[K].length;j<H-G;j+=1)N[K].push(N[K][j%G]);K<ne.length?O.push(N[K].concat(ne[K])):O.push(N[K].concat(new Array(z.length).fill(null)))}else O.push(N[K%V].concat(ne[K]));o.populateFromArray(T,k,id(O));break;case"shift_right":const ce=v.length,Ee=Math.max(ce,H),ke=o.getData().slice(T).map(Rt=>Rt.slice(k));for(j=0;j<Ee;j+=1)if(j<ce){for(K=0,b=v[j].length;K<W-b;K+=1)v[j].push(v[j][K%b]);if(j<ke.length)for(let Rt=0;Rt<ke[j].length;Rt+=1)v[j].push(ke[j][Rt]);else v[j].push(...new Array(ke[0].length).fill(null))}else v.push(v[j%G].slice(0,Ee).concat(ke[j]));o.populateFromArray(T,k,v);break;case"overwrite":default:S.row=m.row,S.col=m.col;let je=0,Re=0,$e=!0,St;const yi=function(sn){let wt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Et=v[sn%v.length];return wt!==null?Et[wt%Et.length]:Et},$o=v.length,Ur=w?w.row-m.row+1:0;for(w?G=Ur:G=Math.max($o,Ur),j=0;j<G&&!(w&&S.row>w.row&&Ur>$o||!p.allowInsertRow&&S.row>o.countRows()-1||S.row>=p.maxRows);j++){const Rt=j-je,sn=yi(Rt).length,wt=w?w.col-m.col+1:0;if(w?b=wt:b=Math.max(sn,wt),S.col=m.col,St=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&St.skipRowOnPaste){je+=1,S.row+=1,G+=1;continue}for(Re=0,K=0;K<b&&!(w&&S.col>w.col&&wt>sn||!p.allowInsertColumn&&S.col>o.countCols()-1||S.col>=p.maxCols);K++){if(St=o.getCellMeta(S.row,S.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&St.skipColumnOnPaste){Re+=1,S.col+=1,b+=1;continue}if(St.readOnly&&A!=="UndoRedo.undo"){S.col+=1;continue}const Et=K-Re;let Fe=yi(Rt,Et),zr=o.getDataAtCell(S.row,S.col);if(Fe!==null&&typeof Fe=="object")if(Array.isArray(Fe)&&zr===null&&(zr=[]),zr===null||typeof zr!="object")$e=!1;else{const Oa=fc(Array.isArray(zr)?zr:zr[0]||zr),xa=fc(Array.isArray(Fe)?Fe:Fe[0]||Fe);lw(Oa,xa)||Array.isArray(Oa)&&Array.isArray(xa)?Fe=jn(Fe):$e=!1}else zr!==null&&typeof zr=="object"&&($e=!1);$e&&R.push([S.row,S.col,Fe]),$e=!0,S.col+=1}S.row+=1}o.setDataAtCell(R,null,null,A||"populateFromArray");break}}};function Z(m){const v=y$(m);MT(v)?(o.runHooks("beforeLanguageChange",v),_.language=v,o.runHooks("afterLanguageChange",v)):b$(m)}function Q(m,v){const w=m==="className"?o.rootElement:o.table;if(f)q(w,v);else{let A=[],F=[];_[m]&&(A=Array.isArray(_[m])?_[m]:pR(_[m])),v&&(F=Array.isArray(v)?v:pR(v));const j=mR(A,F),G=mR(F,A);j.length&&pe(w,j),G.length&&q(w,G)}_[m]=v}this.init=function(){l.setData(p.data),o.runHooks("beforeInit"),(_o()||M0())&&q(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new R4(this);const m=p.themeName||vA(o.rootElement);o.useTheme(m),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=RR.getInstance(o,p,U),d=k8(o),h=new jq(o),bm(this)&&M8(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&wL(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function se(){let m=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,m=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&m===!1&&(m=!0,this.onQueueEmpty(this.valid))}}}function te(m){const v=m.replace(",",".");return isNaN(parseFloat(v))===!1?parseFloat(v):m}function le(m,v,w){if(!m.length){w();return}const A=o.getActiveEditor(),F=new se;let j=!0;F.onQueueEmpty=()=>{A&&j&&A.cancelChanges(),w()};for(let G=m.length-1;G>=0;G--){const[K,b]=m[G],R=a.propToCol(b);let S;Number.isInteger(R)?S=o.getCellMeta(K,R):S={...Object.getPrototypeOf(p),...p},o.getCellValidator(S)&&(F.addValidatorToQueue(),o.validateCell(m[G][3],S,function(O,T){return function(k){if(typeof k!="boolean")throw new Error("Validation error: result is not boolean");k===!1&&T.allowInvalid===!1&&(j=!1,m.splice(O,1),T.valid=!0),F.removeValidatorFormQueue()}}(G,S),v))}F.checkIfQueueIsEmpty()}function ct(m,v){for(let A=m.length-1;A>=0;A--){let F=!1;if(m[A]===null){m.splice(A,1);continue}if(!((m[A][2]===null||m[A][2]===void 0)&&(m[A][3]===null||m[A][3]===void 0))){if(p.allowInsertRow)for(;m[A][0]>o.countRows()-1;){const{delta:j}=a.createRow(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}if(o.dataType==="array"&&(!p.columns||p.columns.length===0)&&p.allowInsertColumn)for(;a.propToCol(m[A][1])>o.countCols()-1;){const{delta:j}=a.createCol(void 0,void 0,{source:"auto"});if(j===0){F=!0;break}}F||a.set(m[A][0],m[A][1],m[A][3])}}if(m.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",m,v),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",m,v||"edit");const A=o.getActiveEditor();A&&ae(A.refreshValue)&&A.refreshValue()}else o.render()}this._createCellCoords=function(m,v){return o.view._wt.createCellCoords(m,v)},this._createCellRange=function(m,v,w){return o.view._wt.createCellRange(m,v,w)},this.validateCell=function(m,v,w,A){let F=o.getCellValidator(v);function j(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||v.hidden===!0){w(G);return}const b=v.visualCol,R=v.visualRow,S=o.getCell(R,b,!0);if(S&&S.nodeName!=="TH"){const O=o.rowIndexMapper.getRenderableFromVisualIndex(R),T=o.columnIndexMapper.getRenderableFromVisualIndex(b);o.view._wt.getSetting("cellRenderer",O,T,S)}w(G)}Qk(F)&&(F=function(G){return function(K,b){b(G.test(K))}}(F)),it(F)?(m=o.runHooks("beforeValidate",m,v.visualRow,v.prop,A),o._registerImmediate(()=>{F.call(v,m,G=>{o&&(G=o.runHooks("afterValidate",G,m,v.visualRow,v.prop,A),v.valid=G,j(G),o.runHooks("postAfterValidate",G,m,v.visualRow,v.prop,A))})})):o._registerImmediate(()=>{v.valid=!0,j(v.valid,!1)})};function be(m,v,w){return Array.isArray(m)?m:[[m,v,w]]}function He(m,v){const w=o.runHooks("beforeChange",m,v||"edit"),A=m.filter(j=>j!==null);if(w===!1||A.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let j=A.length-1;j>=0;j--){const[G,K,,b]=A[j],R=a.propToCol(K);let S;Number.isInteger(R)?S=o.getCellMeta(G,R):S={...Object.getPrototypeOf(p),...p};const{type:O,checkedTemplate:T,uncheckedTemplate:k}=S;if(O==="numeric"&&typeof b=="string"&&WL(b)&&(A[j][3]=te(b)),O==="checkbox"){const W=yt(b),H=W===yt(T),N=W===yt(k);(H||N)&&(A[j][3]=H?T:k)}}return A}this.setDataAtCell=function(m,v,w,A){const F=be(m,v,w),j=[];let G=A,K,b,R;for(K=0,b=F.length;K<b;K++){if(typeof F[K]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[K][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[K][1]>=this.countCols()?R=F[K][1]:R=a.colToProp(F[K][1]),j.push([F[K][0],R,l.getAtCell(this.toPhysicalRow(F[K][0]),F[K][1]),F[K][2]])}!G&&typeof m=="object"&&(G=v);const S=He(j,G);o.runHooks("afterSetDataAtCell",S,G),le(S,G,()=>{ct(S,G)})},this.setDataAtRowProp=function(m,v,w,A){const F=be(m,v,w),j=[];let G=A,K,b;for(K=0,b=F.length;K<b;K++)j.push([F[K][0],F[K][1],l.getAtCell(this.toPhysicalRow(F[K][0]),F[K][1]),F[K][2]]);!G&&typeof m=="object"&&(G=v);const R=He(j,A);o.runHooks("afterSetDataAtRowProp",R,G),le(R,G,()=>{ct(R,G)})},this.listen=function(){o&&!o.isListening()&&(mb.forEach(m=>{o!==m&&m.unlisten()}),gb=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(gb=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return gb===o.guid},this.destroyEditor=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(m),o.view.render(),v&&U.isSelected()&&c.prepareEditor()},this.populateFromArray=function(m,v,w,A,F,j,G){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const K=typeof A=="number"?o._createCellCoords(A,F):null;return u.populateFromArray(o._createCellCoords(m,v),w,K,j,G)},this.spliceCol=function(m,v,w){for(var A=arguments.length,F=new Array(A>3?A-3:0),j=3;j<A;j++)F[j-3]=arguments[j];return a.spliceCol(m,v,w,...F)},this.spliceRow=function(m,v,w){for(var A=arguments.length,F=new Array(A>3?A-3:0),j=3;j<A;j++)F[j-3]=arguments[j];return a.spliceRow(m,v,w,...F)},this.getSelected=function(){if(U.isSelected())return Be(U.getSelectedRange(),m=>{let{from:v,to:w}=m;return[v.row,v.col,w.row,w.col]})},this.getSelectedLast=function(){const m=this.getSelected();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.getSelectedRange=function(){if(U.isSelected())return Array.from(U.getSelectedRange())},this.getSelectedRangeLast=function(){const m=this.getSelectedRange();let v;return m&&m.length>0&&(v=m[m.length-1]),v},this.emptySelectedCells=function(m){if(!U.isSelected()||this.countRows()===0||this.countCols()===0)return;const v=[];I(U.getSelectedRange(),w=>{if(w.isSingleHeader())return;const A=w.getTopStartCorner(),F=w.getBottomEndCorner();fe(A.row,F.row,j=>{fe(A.col,F.col,G=>{this.getCellMeta(j,G).readOnly||v.push([j,G,null])})})}),v.length>0&&this.setDataAtCell(v,m)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const m=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(m,0),!this.isRenderSuspended()&&m===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(m){this.suspendRender();const v=m();return this.resumeRender(),v},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const v=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(v,0),(!this.isExecutionSuspended()&&v===this.executionSuspendedCounter||m)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=m();return this.resumeExecution(v),w},this.batch=function(m){this.suspendRender(),this.suspendExecution();const v=m();return this.resumeExecution(),this.resumeRender(),v},this.refreshDimensions=function(){if(!o.view)return;const m=o.view,{width:v,height:w}=m.getLastSize(),{width:A,height:F}=o.rootElement.getBoundingClientRect(),j=A!==v||F!==w;o.runHooks("beforeRefreshDimensions",{width:v,height:w},{width:A,height:F},j)!==!1&&((j||m._wt.wtOverlays.scrollableElement===o.rootWindow)&&(m.setLastSize(A,F),o.render(),m.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:v,height:w},{width:A,height:F},j))},this.updateData=function(m,v){dA(m,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),U.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:v,metaManager:E,firstRun:f})},this.loadData=function(m,v){dA(m,w=>{a=w},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),U.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:v,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const m=p.columns;let v=0;if(Array.isArray(m))v=m.length;else if(it(m))if(o.dataType==="array"){const w=this.countSourceCols();for(let A=0;A<w;A+=1)m(A)&&(v+=1)}else(o.dataType==="object"||o.dataType==="function")&&(v=a.colToPropCache.length);else if(ae(p.dataSchema)){const w=a.getSchema();v=Array.isArray(w)?w.length:uw(w)}else v=this.countSourceCols();return v},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(m,v,w,A){return Pt(m)?a.getAll():a.getRange(o._createCellCoords(m,v),o._createCellCoords(w,A),a.DESTINATION_RENDERER)},this.getCopyableText=function(m,v,w,A){return a.getCopyableText(o._createCellCoords(m,v),o._createCellCoords(w,A))},this.getCopyableData=function(m,v){return a.getCopyable(m,a.colToProp(v))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?o.loadData:o.updateData).bind(this);let A=!1,F,j;if(ae(m.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ae(m.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ae(m.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');m.language&&Z(m.language);for(F in m)if(!(F==="data"||F==="language"))if(F==="className")Q("className",m.className);else if(F==="tableClassName"&&o.table)Q("tableClassName",m.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ie.getSingleton().isRegistered(F)||ie.getSingleton().isDeprecated(F)){const S=m[F];it(S)?(ie.getSingleton().addAsFixed(F,S,o),p[F]=S):Array.isArray(S)&&(ie.getSingleton().add(F,S,o),p[F]=S)}else!v&&Jt(m,F)&&(_[F]=m[F]);m.data===void 0&&p.data===void 0?w(null,"updateSettings"):m.data!==void 0?w(m.data,"updateSettings"):m.columns!==void 0&&(a.createMap(),o.initIndexMappers());const G=o.countCols(),K=p.columns;if(K&&it(K)&&(A=!0),(m.cell!==void 0||m.cells!==void 0||m.columns!==void 0)&&E.clearCache(),G>0)for(F=0,j=0;F<G;F++){if(K){const S=A?K(F):K[j];S&&E.updateColumnMeta(j,S)}j+=1}ae(m.cell)&&Ae(m.cell,S=>{o.setCellMetaObject(S.row,S.col,S)}),o.runHooks("afterCellMetaReset");let b=o.rootElement.style.height;b!==""&&(b=parseInt(o.rootElement.style.height,10));let R=m.height;if(it(R)&&(R=R()),v&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const S=o.rootElement.getAttribute("data-initialstyle");S&&(S.indexOf("height")>-1||S.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",S):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof m.width<"u"){let S=m.width;it(S)&&(S=S()),o.rootElement.style.width=isNaN(S)?`${S}`:`${S}px`}if(!v){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const S=o.getCurrentThemeName(),O=Jt(m,"themeName");S&&O&&S!==m.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(S));const T=O&&m.themeName||vA(o.rootElement);o.useTheme(T),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",m)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!v&&o.view&&(b===""||R===""||R===void 0)&&b!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const m=o.getSelectedLast();if(p.getValue){if(it(p.getValue))return p.getValue.call(o);if(m)return o.getData()[m[0][0]][p.getValue]}else if(m)return o.getDataAtCell(m[0],m[1])},this.getSettings=function(){return p},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(m,v,w,A,F){u.alter(m,v,w,A,F)},this.getCell=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=v,F=m;if(v>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(v)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(v)}if(m>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(m)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(m)}return F===null||A===null||F===void 0||A===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,A),w)},this.getCoords=function(m){const v=this.view._wt.wtTable.getCoords(m);if(v===null)return null;const{row:w,col:A}=v;let F=w,j=A;return w>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(w)),A>=0&&(j=this.columnIndexMapper.getVisualFromRenderableIndex(A)),o._createCellCoords(F,j)},this.colToProp=function(m){return a.colToProp(m)},this.propToCol=function(m){return a.propToCol(m)},this.toVisualRow=m=>this.rowIndexMapper.getVisualFromPhysicalIndex(m),this.toVisualColumn=m=>this.columnIndexMapper.getVisualFromPhysicalIndex(m),this.toPhysicalRow=m=>this.rowIndexMapper.getPhysicalFromVisualIndex(m),this.toPhysicalColumn=m=>this.columnIndexMapper.getPhysicalFromVisualIndex(m),this.getDataAtCell=function(m,v){return a.get(m,a.colToProp(v))},this.getDataAtRowProp=function(m,v){return a.get(m,v)},this.getDataAtCol=function(m){const v=[],w=a.getRange(o._createCellCoords(0,m),o._createCellCoords(p.data.length-1,m),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let F=0;F<w[A].length;F+=1)v.push(w[A][F]);return v},this.getDataAtProp=function(m){const v=[],w=a.getRange(o._createCellCoords(0,a.propToCol(m)),o._createCellCoords(p.data.length-1,a.propToCol(m)),a.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let F=0;F<w[A].length;F+=1)v.push(w[A][F]);return v},this.getSourceData=function(m,v,w,A){let F;return m===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A)),F},this.getSourceDataArray=function(m,v,w,A){let F;return m===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(m,v),o._createCellCoords(w,A),!0),F},this.getSourceDataAtCol=function(m){return l.getAtColumn(m)},this.setSourceDataAtCell=function(m,v,w,A){const F=be(m,v,w),j=this.hasHook("afterSetSourceDataAtCell"),G=[];j&&I(F,b=>{let[R,S,O]=b;G.push([R,S,l.getAtCell(R,S),O])}),I(F,b=>{let[R,S,O]=b;l.setAtCell(R,S,O)}),j&&this.runHooks("afterSetSourceDataAtCell",G,A),this.render();const K=o.getActiveEditor();K&&ae(K.refreshValue)&&K.refreshValue()},this.getSourceDataAtRow=function(m){return l.getAtRow(m)},this.getSourceDataAtCell=function(m,v){return l.getAtCell(m,v)},this.getDataAtRow=function(m){return a.getRange(o._createCellCoords(m,0),o._createCellCoords(m,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(m,v,w,A){const F=m===void 0?[0,0,this.countRows(),this.countCols()]:[m,v,w,A],[j,G]=F;let[,,K,b]=F,R=null,S=null;K===void 0&&(K=j),b===void 0&&(b=G);let O="mixed";return fe(Math.max(Math.min(j,K),0),Math.max(j,K),T=>{let k=!0;return fe(Math.max(Math.min(G,b),0),Math.max(G,b),W=>(S=this.getCellMeta(T,W).type,R?k=R===S:R=S,k)),O=k?S:"mixed",k}),O},this.removeCellMeta=function(m,v,w){const[A,F]=[this.toPhysicalRow(m),this.toPhysicalColumn(v)];let j=E.getCellMetaKeyValue(A,F,w);o.runHooks("beforeRemoveCellMeta",m,v,w,j)!==!1&&(E.removeCellMeta(A,F,w),o.runHooks("afterRemoveCellMeta",m,v,w,j)),j=null},this.spliceCellsMeta=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,A=new Array(w>2?w-2:0),F=2;F<w;F++)A[F-2]=arguments[F];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");v>0&&E.removeRow(this.toPhysicalRow(m),v),A.length>0&&I(A.reverse(),j=>{E.createRow(this.toPhysicalRow(m)),I(j,(G,K)=>this.setCellMetaObject(m,K,G))}),o.render()},this.setCellMetaObject=function(m,v,w){typeof w=="object"&&Ae(w,(A,F)=>{this.setCellMeta(m,v,F,A)})},this.setCellMeta=function(m,v,w,A){if(o.runHooks("beforeSetCellMeta",m,v,w,A)===!1)return;let j=m,G=v;m<this.countRows()&&(j=this.toPhysicalRow(m)),v<this.countCols()&&(G=this.toPhysicalColumn(v)),E.setCellMeta(j,G,w,A),o.runHooks("afterSetCellMeta",m,v,w,A)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(m,v){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},A=this.toPhysicalRow(m),F=this.toPhysicalColumn(v);return A===null&&(A=m),F===null&&(F=v),E.getCellMeta(A,F,{visualRow:m,visualColumn:v,...w})},this.getColumnMeta=function(m){return E.getColumnMeta(this.toPhysicalColumn(m))},this.getCellMetaAtRow=function(m){return E.getCellsMetaAtRow(m)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||p.columns)},this.getCellRenderer=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).renderer:m.renderer;return typeof w=="string"?ep(w):Pt(w)?ep("text"):w},this.getCellEditor=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).editor:m.editor;return typeof w=="string"?Jm(w):Pt(w)?Jm("text"):w},this.getCellValidator=function(m,v){const w=typeof m=="number"?o.getCellMeta(m,v).validator:m.validator;return typeof w=="string"?N0(w):w},this.validateCells=function(m){this._validateCells(m)},this.validateRows=function(m,v){if(!Array.isArray(m))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(v,m)},this.validateColumns=function(m,v){if(!Array.isArray(m))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(v,void 0,m)},this._validateCells=function(m,v,w){const A=new se;m&&(A.onQueueEmpty=m);let F=o.countRows()-1;for(;F>=0;){if(v!==void 0&&v.indexOf(F)===-1){F-=1;continue}let j=o.countCols()-1;for(;j>=0;){if(w!==void 0&&w.indexOf(j)===-1){j-=1;continue}A.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,j),o.getCellMeta(F,j),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),j-=1}F-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(m){let v=p.rowHeaders,w=m;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(v=[],fe(o.countRows()-1,A=>{v.push(o.getRowHeader(A))})):Array.isArray(v)&&v[w]!==void 0?v=v[w]:it(v)?v=v(w):v&&typeof v!="string"&&typeof v!="number"&&(v=w+1),v},this.hasRowHeaders=function(){return!!p.rowHeaders},this.hasColHeaders=function(){if(p.colHeaders!==void 0&&p.colHeaders!==null)return!!p.colHeaders;for(let m=0,v=o.countCols();m<v;m++)if(o.getColHeader(m))return!0;return!1},this.getColHeader=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",m);if(w===void 0){const K=[],b=o.countCols();for(let R=0;R<b;R++)K.push(o.getColHeader(R));return K}let A=p.colHeaders;const F=function(K){const b=[],R=o.countCols();let S=0;for(;S<R;S++)it(p.columns)&&p.columns(S)&&b.push(S);return b[K]},j=o.toPhysicalColumn(w),G=F(j);return p.colHeaders===!1?A=null:p.columns&&it(p.columns)&&p.columns(G)&&p.columns(G).title?A=p.columns(G).title:p.columns&&p.columns[j]&&p.columns[j].title?A=p.columns[j].title:Array.isArray(p.colHeaders)&&p.colHeaders[j]!==void 0?A=p.colHeaders[j]:it(p.colHeaders)?A=p.colHeaders(j):p.colHeaders&&typeof p.colHeaders!="string"&&typeof p.colHeaders!="number"&&(A=mw(w)),A=o.runHooks("modifyColumnHeaderValue",A,m,v),A},this._getColWidthFromSettings=function(m){let v;if(m>=0&&(v=o.getCellMeta(0,m).width),(v===void 0||v===p.width)&&(v=p.colWidths),v!=null){switch(typeof v){case"object":v=v[m];break;case"function":v=v(m);break}typeof v=="string"&&(v=parseInt(v,10))}return v},this.getColWidth=function(m,v){let w=o._getColWidthFromSettings(m);return w=o.runHooks("modifyColWidth",w,m,v),w===void 0&&(w=gc),w},this._getRowHeightFromSettings=function(m){const v=this.view.getDefaultRowHeight();let w=p.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[m];break;case"function":w=w(m);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<v?v:w},this.getRowHeight=function(m,v){let w=o._getRowHeightFromSettings(m);return w=o.runHooks("modifyRowHeight",w,m,v),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const m=p.maxCols,v=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(m,v)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return TR(o.countRows()-1,w=>{if(o.isEmptyRow(w))v+=1;else if(m===!0)return!1}),v},this.countEmptyCols=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,v=0;return TR(o.countCols()-1,w=>{if(o.isEmptyCol(w))v+=1;else if(m===!0)return!1}),v},this.isEmptyRow=function(m){return p.isEmptyRow.call(o,m)},this.isEmptyCol=function(m){return p.isEmptyCol.call(o,m)},this.selectCell=function(m,v,w,A){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,j=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Pt(m)||Pt(v)?!1:this.selectCells([[m,v,w,A]],F,j)},this.selectCells=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;v===!1&&d.suspend();const A=U.selectCells(m);return A&&w&&o.listen(),d.resume(),A},this.selectColumns=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return U.selectColumns(m,v,w)},this.selectRows=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;return U.selectRows(m,v,w)},this.deselectCell=function(){U.deselect()},this.selectAll=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),U.selectAll(m,v,w)};const ft=(m,v)=>m.getNearestNotHiddenIndex(v,1,!0);this.scrollViewportTo=function(m,v){if(typeof m=="number"){var w;m={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:A,col:F,considerHiddenIndexes:j}=m??{};let G=A,K=F;if(it(v)&&this.addHookOnce("afterScroll",v),j===void 0||j){const O=Number.isInteger(A)&&A>=0,T=Number.isInteger(F)&&F>=0,k=O?ft(this.rowIndexMapper,A):void 0,W=T?ft(this.columnIndexMapper,F):void 0;if(k===null||W===null)return!1;G=O?o.rowIndexMapper.getRenderableFromVisualIndex(k):A,K=T?o.columnIndexMapper.getRenderableFromVisualIndex(W):F}const b=Number.isInteger(G),R=Number.isInteger(K);let S=!1;return b&&G>=0&&R&&K>=0?S=o.view.scrollViewport(o._createCellCoords(G,K),m.horizontalSnap,m.verticalSnap):b&&G>=0&&(R&&K<0||!R)?S=o.view.scrollViewportVertically(G,m.verticalSnap):R&&K>=0&&(b&&G<0||!b)&&(S=o.view.scrollViewportHorizontally(K,m.horizontalSnap)),it(v)&&(S?this.view.render():(this.removeHook("afterScroll",v),this._registerMicrotask(()=>v()))),S},this.scrollToFocusedCell=function(m){if(!this.selection.isSelected())return!1;it(m)&&this.addHookOnce("afterScroll",m);const{highlight:v}=this.getSelectedRangeLast(),w=this.scrollViewportTo(v.toObject());return w?this.view.render():it(m)&&(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m())),w},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),mb.delete(this.guid),bm(o)){const m=this.rootDocument.querySelector(".hot-display-license-info");m&&m.parentNode.removeChild(m)}xo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),P.getItems().forEach(m=>{let[,v]=m;v.destroy()}),P.clear(),o.runHooks("afterDestroy")},!0),ie.getSingleton().destroy(o),Ae(o,(m,v,w)=>{it(m)?w[v]=jt(v):v!=="guid"&&(w[v]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,U=null,c=null,o=null};function jt(m){return()=>{throw new Error(`The "${m}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(m){return P.getItem(Bn(m))},this.getPluginName=function(m){return m===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:P.getId(m)},this.getInstance=function(){return o},this.addHook=function(m,v,w){ie.getSingleton().add(m,v,o,w)},this.hasHook=function(m){return ie.getSingleton().has(m,o)||ie.getSingleton().has(m)},this.addHookOnce=function(m,v,w){ie.getSingleton().once(m,v,o,w)},this.removeHook=function(m,v){ie.getSingleton().remove(m,v,o)},this.runHooks=function(m,v,w,A,F,j,G){return ie.getSingleton().run(o,m,v,w,A,F,j,G)},this.getTranslatedPhrase=function(m,v){return M$(p.language,m,v)},this.toHTML=()=>ER(this),this.toTableElement=()=>{const m=this.rootDocument.createElement("div");return m.insertAdjacentHTML("afterbegin",ER(this)),m.firstElementChild},this.timeouts=[],this.useTheme=m=>{this.view.getStylesHandler().useTheme(m),this.runHooks("afterSetTheme",m,!!f)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=m;typeof w=="function"&&(w=setTimeout(w,v)),this.timeouts.push(w)},this._clearTimeouts=function(){I(this.timeouts,m=>{clearTimeout(m)})},this.immediates=[],this._registerImmediate=function(m){this.immediates.push(setImmediate(m))},this._clearImmediates=function(){I(this.immediates,m=>{clearImmediate(m)})},this._registerMicrotask=function(m){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||m()})},this._getEditorManager=function(){return c};const Ze=B8({handleEvent(){return o.isListening()},beforeKeyDown:m=>this.runHooks("beforeKeyDown",m),afterKeyDown:m=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",m)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",m=>{m.ctrlKey===!1&&m.metaKey===!1&&Ze.releasePressedKeys()}),this.getShortcutManager=function(){return Ze},this.getFocusManager=function(){return h},H0().forEach(m=>{const v=mf(m);P.addItem(m,new v(this))}),_8(o),Ze.setActiveContextName("grid"),ie.getSingleton().run(o,"construct")}function CA(t,e,n){t.addEventListener(e,n,!1)}function yA(t,e,n){t.removeEventListener(e,n,!1)}function lg(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function B$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=lg(s).fontSize,o.style.fontFamily=lg(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=lg(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=lg(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),C=o.clientWidth+f+g+1;r.removeChild(o);const y=s.style;y.height=`${n.minHeight}px`,n.minWidth>C?y.width=`${n.minWidth}px`:C>n.maxWidth?y.width=`${n.maxWidth}px`:y.width=`${C}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?y.height=`${n.minHeight}px`:n.maxHeight<E?(y.height=`${n.maxHeight}px`,y.overflowY="visible"):y.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(CA(s,"input",a),CA(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){yA(s,"input",a),yA(s,"keydown",l)}}}function bA(t,e){const n=w0(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}hf(e,i)}function Wa(t,e,n){return(e=j8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j8(t){var e=U8(t,"string");return typeof e=="symbol"?e:e+""}function U8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const z8="ht_editor_visible",ug="ht_editor_hidden",SA="textEditor",Y8="text";class eu extends Nc{static get EDITOR_TYPE(){return Y8}constructor(e){super(e),Wa(this,"eventManager",new di(this)),Wa(this,"autoResize",B$(this.hot.rootDocument)),Wa(this,"TEXTAREA",void 0),Wa(this,"textareaStyle",void 0),Wa(this,"TEXTAREA_PARENT",void 0),Wa(this,"textareaParentStyle",void 0),Wa(this,"layerClass",void 0),this.eventManager=new di(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),ad(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Gt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Gt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),hf(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ye(this.TEXTAREA,[["data-hot-input",""],Kl(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,ug),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){PL()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",pe(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,ug)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(we(i,"handsontableEditor"))return n=!0,!1}),we(this.TEXTAREA_PARENT,ug)&&pe(this.TEXTAREA_PARENT,ug),n?(this.layerClass=z8,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Gt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){T0()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Gt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Gt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ae(this.hot.getSelected()),group:SA},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;bA(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;bA(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SA)}}const G8="base";function yf(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(Ix())):a&&c.push(Ix()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(Px())):(u.push(s.invalidCellClassName),a&&c.push(Px()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),pe(e,u),q(e,l),Zl(e,c),ye(e,h)}yf.RENDERER_TYPE=G8;const q8="text";function Os(t,e,n,r,i,o,s){yf.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=yt(a),s.trimWhitespace&&(a=a.trim()),ya(e,a)}Os.RENDERER_TYPE=q8;const K8="text",j$={CELL_TYPE:K8,editor:eu,renderer:Os};Zr(j$);Se.editors={BaseEditor:Nc};function Se(t,e){const n=new W$(t,e||{},Z0);return n.init(),n}Se.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new W$(t,e,Z0)};Se.DefaultSettings=N$();Se.hooks=ie.getSingleton();Se.CellCoords=kl;Se.CellRange=pf;Se.packageName="handsontable";Se.buildDate="24/04/2025 10:59:00";Se.version="15.3.0";Se.languages={dictionaryKeys:d9,getLanguageDictionary:T$,getLanguagesDictionaries:w9,registerLanguageDictionary:_$,getTranslatedPhrase:M$};const RA="handsontableEditor",X8="handsontable";class OT extends eu{static get EDITOR_TYPE(){return X8}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),hf(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&tn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{if(!n){var r;(r=this.htEditor)===null||r===void 0||r.useTheme(e)}})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:RA,relativeToGroup:Pa,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),vi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(RA)}}function Z8(t,e){U$(t,e),e.add(t)}function EA(t,e,n){U$(t,e),e.set(t,n)}function U$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,n){return(e=Q8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q8(t){var e=J8(t,"string");return typeof e=="symbol"?e:e+""}function J8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pb(t,e){return t.get($R(t,e))}function $R(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const e7="autocomplete";var wb=new WeakMap,_A=new WeakMap,vb=new WeakSet;class xT extends OT{constructor(){super(...arguments),Z8(this,vb),cg(this,"query",null),cg(this,"strippedChoices",[]),cg(this,"rawChoices",[]),EA(this,wb,this.hot.guid.slice(0,9)),EA(this,_A,ff(()=>{this.focus()},100)),cg(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=vR(yt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return e7}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ae(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[D2(),O2(),nL("listbox"),F2()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[li("false"),V2(`${pb(wb,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",pb(_A,this)),this.htEditor.updateSettings({colWidths:e?[Kt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{Os(a,l,u,c,h,d,f);const{filteringCaseSensitive:g,allowHtml:C,locale:y}=this.cellProperties,E=this.query;let p=yt(d),_,P;p&&!C&&(_=g===!0?p.indexOf(E):p.toLocaleLowerCase(y).indexOf(E.toLocaleLowerCase(y)),_!==-1&&(P=p.substr(_,E.length),p=p.replace(P,`<strong>${P}</strong>`))),n&&ye(l,[x2(),...r?[U2(i)]:[],...r?[z2(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=p},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{ye(h,[d0()]),ye(this.TEXTAREA,...W2(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(ye(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...gs()),ye(this.htEditor.rootElement,[tL(),B2("polite"),j2("text"),["id",`${pb(wb,this)}-listbox-${o}-${s}`]]),ye(this.TEXTAREA,...li("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ye(this.TEXTAREA,[li("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=w0(this.TEXTAREA),r=pL(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(id([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),hf(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),n=e.height;let r=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const a=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getHeight(),o=this.hot.view.getWorkspaceHeight()-r-n,s=i>o&&r>o+n;return s?this.flipDropdown(i):this.unflipDropdown(),this.limitDropdownIfNeeded(s?r:o,i),s}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view.getDefaultRowHeight(),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),$R(vb,this,TA).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),$R(vb,this,TA).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(o,s)=>s).reduce((o,s)=>{const a=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight();return o+a},0)+n+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),n=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+n}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Be(e,o=>yt(o));return Be(r,o=>n?o:vR(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(OL(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function TA(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+yn(this.hot.rootDocument)})}const t7="checkbox";class z$ extends Nc{static get EDITOR_TYPE(){return t7}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');we(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const aa=()=>window,ii=()=>window.document,FR=(t,e)=>window.setTimeout(t,e),ho=function(t,e,n,r){t.addEventListener(e,n,!!r)},qo=function(t,e,n,r){t.removeEventListener(e,n,!!r)},n7=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ar=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Cb=function(t,e){Ar(t,e)||(t.className=t.className===""?e:t.className+" "+e)},yb=function(t,e){t.className=n7((" "+t.className+" ").replace(" "+e+" "," "))},AT=function(t){return/Array/.test(Object.prototype.toString.call(t))},Lr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},r7=function(t){let e=t.getDay();return e===0||e===6},i7=function(t){return t%4===0&&t%100!==0||t%400===0},MA=function(t,e){return[31,i7(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},hg=function(t){Lr(t)&&t.setHours(0,0,0,0)},dg=function(t,e){return t.getTime()===e.getTime()},ip=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Lr(e[r])?n&&(t[r]=new Date(e[r].getTime())):AT(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=ip({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},IA=function(t,e,n){let r=ii().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=ip(r,n),t.dispatchEvent(r)},PA=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},eo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},OA=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},o7=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},s7=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},a7=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():s7(o,i))+"</td>"},l7=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},u7=function(t){return"<tbody>"+t.join("")+"</tbody>"},c7=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+OA(t,e)+'">'+OA(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},h7=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,g,C=!0,y=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",AT(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return g='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=g+f:d+=f+g,c&&(r===0||u.minMonth>=r)&&(C=!1),h&&(r===11||u.maxMonth<=r)&&(y=!1),e===0&&(d+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(y?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},d7=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+c7(t)+u7(e)+"</table>"};function VR(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||aa().event;let o=i.target||i.srcElement;if(o)if(Ar(o,"is-disabled")||(Ar(o,"pika-button")&&!Ar(o,"is-empty")&&!Ar(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&FR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ar(o,"pika-prev")?e.prevMonth():Ar(o,"pika-next")&&e.nextMonth()),Ar(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||aa().event;let o=i.target||i.srcElement;o&&(Ar(o,"pika-select-month")?e.gotoMonth(o.value):Ar(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||aa().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Lr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=ii().activeElement;do if(Ar(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=FR(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||aa().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Ar(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),ho(o,"change",e._onChange)));do if(Ar(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=ii().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),ho(e.el,"mousedown",e._onMouseDown,!0),ho(e.el,"touchend",e._onMouseDown,!0),ho(e.el,"change",e._onChange),n.keyboardInput&&ho(ii(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?ii().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),ho(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Lr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",ho(n.trigger,"click",e._onInputClick),ho(n.trigger,"focus",e._onInputFocus),ho(n.trigger,"blur",e._onInputBlur)):this.show()}VR.prototype={config:function(t){this._o||(this._o=ip({},eo,!0));let e=ip(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Lr(e.minDate)||(e.minDate=!1),Lr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),AT(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||eo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Lr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Lr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",IA(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Lr(t))return;let n=this._o.minDate,r=this._o.maxDate;Lr(n)&&t<n?t=n:Lr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),hg(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),IA(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Lr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=PA(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=PA({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(hg(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=eo.minDate,this._o.minYear=eo.minYear,this._o.minMonth=eo.minMonth,this._o.startRange=eo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(hg(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=eo.maxDate,this._o.maxYear=eo.maxYear,this._o.maxMonth=eo.maxMonth,this._o.endRange=eo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+h7(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&FR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=aa().innerWidth||ii().documentElement.clientWidth,i=aa().innerHeight||ii().documentElement.clientHeight,o=ii().body.scrollTop||ii().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+aa().pageXOffset,a=l.bottom+aa().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Cb(this.el,u?"left-aligned":"right-aligned"),Cb(this.el,c?"bottom-aligned":"top-aligned"),yb(this.el,u?"right-aligned":"left-aligned"),yb(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=MA(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];hg(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=MA(h,u),g=o+s,C=g;for(;C>7;)C-=7;g+=7-C;let y=!1;for(let E=0,p=0;E<g;E++){let _=new Date(t,e,1+(E-s)),P=Lr(this._d)?dg(_,this._d):!1,D=dg(_,i),M=r.events.indexOf(_.toDateString())!==-1,x=E<s||E>=o+s,Y=1+(E-s),U=e,B=t,Z=r.startRange&&dg(r.startRange,_),Q=r.endRange&&dg(r.endRange,_),se=r.startRange&&r.endRange&&r.startRange<_&&_<r.endRange,te=r.minDate&&_<r.minDate||r.maxDate&&_>r.maxDate||r.disableWeekends&&r7(_)||r.disableDayFn&&r.disableDayFn(_);x&&(E<s?(Y=f+Y,U=u,B=h):(Y=Y-o,U=c,B=d));let le={day:Y,month:U,year:B,hasEvent:M,isSelected:P,isToday:D,isDisabled:te,isEmpty:x,isStartRange:Z,isEndRange:Q,isInRange:se,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&P&&(y=!0),l.push(o7(le)),++p===7&&(r.showWeekNumber&&l.unshift(a7(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(l7(l,r.isRTL,r.pickWholeWeek,y)),l=[],p=0,y=!1)}return d7(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),yb(this.el,"is-hidden"),this._o.bound&&(ho(ii(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&qo(ii(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Cb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),qo(this.el,"mousedown",this._onMouseDown,!0),qo(this.el,"touchend",this._onMouseDown,!0),qo(this.el,"change",this._onChange),t.keyboardInput&&qo(ii(),"keydown",this._onKeyChange),t.field&&(qo(t.field,"change",this._onInputChange),t.bound&&(qo(t.trigger,"click",this._onInputClick),qo(t.trigger,"focus",this._onInputFocus),qo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function f7(t,e){g7(t,e),e.add(t)}function g7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xA(t,e,n){return(e=m7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m7(t){var e=p7(t,"string");return typeof e=="symbol"?e:e+""}function p7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Y$="date",AA="dateEditor",w7="DD/MM/YYYY";var fg=new WeakSet;class G$ extends eu{constructor(){super(...arguments),f7(this,fg),xA(this,"parentDestroyed",!1),xA(this,"$datePicker",null)}static get EDITOR_TYPE(){return Y$}init(){if(typeof X!="function")throw new Error("You need to include moment.js to your project.");if(typeof VR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||(pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();pe(this.datePicker,/ht-theme-.*/g),q(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",n=>{we(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:AA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(AA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=bb(fg,this,Sb).call(this),r=this.hot.view.isMouseDown(),i=e?I0(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new VR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(X),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,X(o,n,!0).isValid()&&this.$datePicker.setMoment(X(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&gf(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:bb(fg,this,Sb).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=X(a).format(bb(fg,this,Sb).call(this))),this.setValue(a),i&&i(),_o()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Gt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+en(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-Kt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Sb(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:w7}const v7="dropdown";class q$ extends xT{static get EDITOR_TYPE(){return v7}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const C7="numeric";class K$ extends eu{static get EDITOR_TYPE(){return C7}}function y7(t,e,n){return(e=b7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b7(t){var e=S7(t,"string");return typeof e=="symbol"?e:e+""}function S7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R7="password";class X$ extends eu{constructor(){super(...arguments),y7(this,"autoResize",B$(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return R7}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,xo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Rb="ht_editor_visible",HA="selectEditor",E7="select";class Z$ extends Nc{static get EDITOR_TYPE(){return E7}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Xl()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",we(this.selectWrapper,Rb)&&pe(this.selectWrapper,Rb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),xo(this.select),Ae(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ql(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Gt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.selectWrapper,Rb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:HA};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(HA)}}const _7="time";class Q$ extends eu{static get EDITOR_TYPE(){return _7}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function T7(){mr(Nc),mr(xT),mr(z$),mr(G$),mr(q$),mr(OT),mr(K$),mr(X$),mr(Z$),mr(eu),mr(Q$)}const M7="html";function HT(t,e,n,r,i,o,s){yf.apply(this,[t,e,n,r,i,o,s]),Ql(e,o??"",!1)}HT.RENDERER_TYPE=M7;const I7="autocomplete";function kc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?HT:Os,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Xl()),u.appendChild(a.createTextNode("▼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(" ")),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new di(t);t.acArrowListener=function(d){we(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}kc.RENDERER_TYPE=I7;const P7="dropdown";function NT(t,e,n,r,i,o,s){kc.apply(this,[t,e,n,r,i,o,s])}NT.RENDERER_TYPE=P7;const NA=new WeakMap,DA=new WeakMap,O7="htBadValue",pc="data-row",wc="data-col",x7="checkboxRenderer",J$="checkbox";ie.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===J$){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function DT(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;yf.apply(this,[t,e,n,r,i,o,s]),A7(t);let u=H7(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),xo(e),o===s.checkedTemplate||yt(o).toLocaleLowerCase(s.locale)===yt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||yt(o).toLocaleLowerCase(s.locale)===yt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Wt(o)?q(u,"noValue"):(u.style.display="none",q(u,O7),h=!0),ye(u,[[pc,n],[wc,r]]),l&&ye(u,[Hd(u.checked?t.getTranslatedPhrase(_T):t.getTranslatedPhrase(TT)),oL(u.checked),A2()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);C=E!==null?E:""}const y=N7(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),NA.has(t)||(NA.set(t,!0),d());function d(){const y=t.getShortcutManager().getContext("grid"),E={group:x7,relativeToGroup:Pa,position:"before"};y.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var p;return(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const p=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(p==null?void 0:p.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var p;return(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight.isCell()}}],E)}function f(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange(),E=[],p=new Map;let _=[],P=0;if(y){for(let D=0;D<y.length;D++){const{row:M,col:x}=y[D].getTopStartCorner(),{row:Y,col:U}=y[D].getBottomEndCorner();for(let B=M;B<=Y;B+=1)for(let Z=x;Z<=U;Z+=1){const Q=t.getCellMeta(B,Z);if(Q.hidden)continue;const se={checkedTemplate:Q.checkedTemplate,uncheckedTemplate:Q.uncheckedTemplate};if(Q.type!=="checkbox"){C===!0&&!Q.readOnly&&(p.has(E.length)?p.set(E.length,[...p.get(E.length),[B,Z,null]]):p.set(E.length,[[B,Z,null]]));continue}if(Q.readOnly===!0)continue;typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);const te=t.getDataAtCell(B,Z);C===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(te)?_.push([B,Z,Q.uncheckedTemplate,se]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(te)&&_.push([B,Z,Q.checkedTemplate,se]):_.push([B,Z,Q.uncheckedTemplate,se]),P+=1}E.push(P),P=0}_.every(D=>{let[,,M]=D;return M===_[0][2]})?_=_.map(D=>{let[M,x,Y]=D;return[M,x,Y]}):_=_.map(D=>{let[M,x,,Y]=D;return[M,x,Y.checkedTemplate]}),_.length>0&&E.forEach((D,M)=>{let x=_.splice(0,D);p.size&&p.has(M)&&(x=[...x,...p.get(M)]),t.setDataAtCell(x)})}}function g(){const C=t.getSelectedRange();if(C){for(let y=0;y<C.length;y++){const E=C[y].getTopStartCorner(),p=C[y].getBottomEndCorner();for(let _=E.row;_<=p.row;_++)for(let P=E.col;P<=p.col;P++){if(t.getCellMeta(_,P).readOnly)continue;const M=t.getCell(_,P);if(To(M)&&M.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}DT.RENDERER_TYPE=J$;function A7(t){let e=DA.get(t);if(!e){const{rootElement:n}=t;e=new di(t),e.addEventListener(n,"click",r=>k7(r,t)),e.addEventListener(n,"mouseup",r=>D7(r,t)),e.addEventListener(n,"change",r=>L7(r,t)),DA.set(t,e)}return e}function H7(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function N7(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function D7(t,e){const{target:n}=t;kT(n)&&(!n.hasAttribute(pc)||!n.hasAttribute(wc)||setTimeout(e.listen,10))}function k7(t,e){const{target:n}=t;if(!kT(n)||!n.hasAttribute(pc)||!n.hasAttribute(wc))return;const r=parseInt(n.getAttribute(pc),10),i=parseInt(n.getAttribute(wc),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function L7(t,e){const{target:n}=t;if(!kT(n)||!n.hasAttribute(pc)||!n.hasAttribute(wc))return;const r=parseInt(n.getAttribute(pc),10),i=parseInt(n.getAttribute(wc),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function kT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const $7="handsontable";function LT(t,e,n,r,i,o,s){kc.apply(this,[t,e,n,r,i,o,s])}LT.RENDERER_TYPE=$7;var F7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V7(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Eb,kA;function W7(){return kA||(kA=1,Eb={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Eb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var _b,LA;function eF(){if(LA)return _b;LA=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,g){if(!isNaN(+l))return+l;let C="",y=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(y!==l)return-1*n(y,u,c,h,d,f);for(let M=0;M<t.length;M++){let x=t[M];if(C=l.replace(RegExp(`([0-9 ])(${x.key})$`),"$1"),C!==l)return n(C,u,c,h,d,f)*x.factor}if(C=l.replace("%",""),C!==l)return n(C,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let p=h(E);if(p&&p!=="."&&(C=l.replace(new RegExp(`${e(p)}$`),""),C!==l))return n(C,u,c,h,d,f);let _={};Object.keys(f).forEach(M=>{_[f[M]]=M});let P=Object.keys(_).sort().reverse(),D=P.length;for(let M=0;M<D;M++){let x=P[M],Y=_[x];if(C=l.replace(x,""),C!==l){let U;switch(Y){case"thousand":U=Math.pow(10,3);break;case"million":U=Math.pow(10,6);break;case"billion":U=Math.pow(10,9);break;case"trillion":U=Math.pow(10,12);break}return n(C,u,c,h,d,f)*U}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,g){if(l==="")return;if(l===d)return 0;let C=r(l,u,c);return n(C,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=VT();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),g=c.getZeroFormat(),C=c.currentAbbreviations(),y;if(typeof l=="string")o(l,h)?y=s(l):y=i(l,h,d,f,g,C);else if(typeof l=="number")y=l;else return;if(y!==void 0)return y}return _b={unformat:a},_b}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Tb,$A;function $T(){if($A)return Tb;$A=1;let t=eF();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(y,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:y=>y.output==="byte"},characteristic:{type:"number",restriction:y=>y>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(y,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:y=>y>=0,message:"value must be positive"},{restriction:(y,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:y=>y>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(y,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:y=>y.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(y,E){let p=d(y),_=g(E);return p&&_}function d(y){return t.unformat(y)!==void 0}function f(y,E,p,_=!1){let P=Object.keys(y).map(D=>{if(!E[D])return console.error(`${p} Invalid key: ${D}`),!1;let M=y[D],x=E[D];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(M,u,`[Validate ${D}]`,!0))return!1}else if(typeof M!==x.type)return console.error(`${p} ${D} type mismatched: "${x.type}" expected, "${typeof M}" provided`),!1;if(x.restrictions&&x.restrictions.length){let Y=x.restrictions.length;for(let U=0;U<Y;U++){let{restriction:B,message:Z}=x.restrictions[U];if(!B(M,y))return console.error(`${p} ${D} invalid value: ${Z}`),!1}}return x.restriction&&!x.restriction(M,y)?(console.error(`${p} ${D} invalid value: ${x.message}`),!1):x.validValues&&x.validValues.indexOf(M)===-1?(console.error(`${p} ${D} invalid value: must be among ${JSON.stringify(x.validValues)}, "${M}" provided`),!1):!(x.children&&!f(M,x.children,`[Validate ${D}]`))});return _||P.push(...Object.keys(E).map(D=>{let M=E[D];if(typeof M=="string"&&(M={type:M}),M.mandatory){let x=M.mandatory;if(typeof x=="function"&&(x=x(y)),x&&y[D]===void 0)return console.error(`${p} Missing mandatory key "${D}"`),!1}return!0})),P.reduce((D,M)=>D&&M,!0)}function g(y){return f(y,u,"[Validate format]")}function C(y){return f(y,c,"[Validate language]")}return Tb={validate:h,validateFormat:g,validateInput:d,validateLanguage:C},Tb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function B7(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function j7(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function U7(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function z7(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function Y7(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function G7(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function q7(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function K7(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function X7(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function Z7(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function Q7(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function J7(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function e5(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function t5(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function n5(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function r5(t,e={}){return typeof t!="string"?t:(t=B7(t,e),t=j7(t,e),U7(t,e),G7(t,e),q7(t,e),e5(t,e),Z7(t,e),Q7(t,e),K7(t,e),J7(t,e),X7(t,e),z7(t,e),Y7(t,e),t5(t,e),n5(t,e),e)}var FT={parseFormat:r5};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Mb,FA;function VT(){if(FA)return Mb;FA=1;const t=W7(),e=$T(),n=FT;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(g=>g.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,Mb=r,Mb}function i5(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function o5(t,e){t.forEach(n=>{let r;try{r=i5(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var s5=t=>({loadLanguagesInNode:e=>o5(e,t)}),tF={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(M){var x,Y,U,B=w.prototype={constructor:w,toString:null,valueOf:null},Z=new w(1),Q=20,se=4,te=-7,le=21,ct=-1e7,be=1e7,He=!1,ft=1,jt=0,Ze={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},m="0123456789abcdefghijklmnopqrstuvwxyz",v=!0;function w(b,R){var S,O,T,k,W,H,N,V,$=this;if(!($ instanceof w))return new w(b,R);if(R==null){if(b&&b._isBigNumber===!0){$.s=b.s,!b.c||b.e>be?$.c=$.e=null:b.e<ct?$.c=[$.e=0]:($.e=b.e,$.c=b.c.slice());return}if((H=typeof b=="number")&&b*0==0){if($.s=1/b<0?(b=-b,-1):1,b===~~b){for(k=0,W=b;W>=10;W/=10,k++);k>be?$.c=$.e=null:($.e=k,$.c=[b]);return}V=String(b)}else{if(!r.test(V=String(b)))return U($,V,H);$.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(k=V.indexOf("."))>-1&&(V=V.replace(".","")),(W=V.search(/e/i))>0?(k<0&&(k=W),k+=+V.slice(W+1),V=V.substring(0,W)):k<0&&(k=V.length)}else{if(p(R,2,m.length,"Base"),R==10&&v)return $=new w(b),G($,Q+$.e+1,se);if(V=String(b),H=typeof b=="number"){if(b*0!=0)return U($,V,H,R);if($.s=1/b<0?(V=V.slice(1),-1):1,w.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+b)}else $.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(S=m.slice(0,R),k=W=0,N=V.length;W<N;W++)if(S.indexOf(O=V.charAt(W))<0){if(O=="."){if(W>k){k=N;continue}}else if(!T&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){T=!0,W=-1,k=0;continue}return U($,String(b),H,R)}H=!1,V=Y(V,R,10,$.s),(k=V.indexOf("."))>-1?V=V.replace(".",""):k=V.length}for(W=0;V.charCodeAt(W)===48;W++);for(N=V.length;V.charCodeAt(--N)===48;);if(V=V.slice(W,++N)){if(N-=W,H&&w.DEBUG&&N>15&&(b>c||b!==o(b)))throw Error(a+$.s*b);if((k=k-W-1)>be)$.c=$.e=null;else if(k<ct)$.c=[$.e=0];else{if($.e=k,$.c=[],W=(k+1)%u,k<0&&(W+=u),W<N){for(W&&$.c.push(+V.slice(0,W)),N-=u;W<N;)$.c.push(+V.slice(W,W+=u));W=u-(V=V.slice(W)).length}else W-=N;for(;W--;V+="0");$.c.push(+V)}}else $.c=[$.e=0]}w.clone=g,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(b){var R,S;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(R="DECIMAL_PLACES")&&(S=b[R],p(S,0,f,R),Q=S),b.hasOwnProperty(R="ROUNDING_MODE")&&(S=b[R],p(S,0,8,R),se=S),b.hasOwnProperty(R="EXPONENTIAL_AT")&&(S=b[R],S&&S.pop?(p(S[0],-1e9,0,R),p(S[1],0,f,R),te=S[0],le=S[1]):(p(S,-1e9,f,R),te=-(le=S<0?-S:S))),b.hasOwnProperty(R="RANGE"))if(S=b[R],S&&S.pop)p(S[0],-1e9,-1,R),p(S[1],1,f,R),ct=S[0],be=S[1];else if(p(S,-1e9,f,R),S)ct=-(be=S<0?-S:S);else throw Error(s+R+" cannot be zero: "+S);if(b.hasOwnProperty(R="CRYPTO"))if(S=b[R],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))He=S;else throw He=!S,Error(s+"crypto unavailable");else He=S;else throw Error(s+R+" not true or false: "+S);if(b.hasOwnProperty(R="MODULO_MODE")&&(S=b[R],p(S,0,9,R),ft=S),b.hasOwnProperty(R="POW_PRECISION")&&(S=b[R],p(S,0,f,R),jt=S),b.hasOwnProperty(R="FORMAT"))if(S=b[R],typeof S=="object")Ze=S;else throw Error(s+R+" not an object: "+S);if(b.hasOwnProperty(R="ALPHABET"))if(S=b[R],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))v=S.slice(0,10)=="0123456789",m=S;else throw Error(s+R+" invalid: "+S)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:Q,ROUNDING_MODE:se,EXPONENTIAL_AT:[te,le],RANGE:[ct,be],CRYPTO:He,MODULO_MODE:ft,POW_PRECISION:jt,FORMAT:Ze,ALPHABET:m}},w.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var R,S,O=b.c,T=b.e,k=b.s;e:if({}.toString.call(O)=="[object Array]"){if((k===1||k===-1)&&T>=-1e9&&T<=f&&T===o(T)){if(O[0]===0){if(T===0&&O.length===1)return!0;break e}if(R=(T+1)%u,R<1&&(R+=u),String(O[0]).length==R){for(R=0;R<O.length;R++)if(S=O[R],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(O===null&&T===null&&(k===null||k===1||k===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},w.maximum=w.max=function(){return F(arguments,-1)},w.minimum=w.min=function(){return F(arguments,1)},w.random=function(){var b=9007199254740992,R=Math.random()*b&2097151?function(){return o(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var O,T,k,W,H,N=0,V=[],$=new w(Z);if(S==null?S=Q:p(S,0,f),W=i(S/u),He)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(W*=2));N<W;)H=O[N]*131072+(O[N+1]>>>11),H>=9e15?(T=crypto.getRandomValues(new Uint32Array(2)),O[N]=T[0],O[N+1]=T[1]):(V.push(H%1e14),N+=2);N=W/2}else if(crypto.randomBytes){for(O=crypto.randomBytes(W*=7);N<W;)H=(O[N]&31)*281474976710656+O[N+1]*1099511627776+O[N+2]*4294967296+O[N+3]*16777216+(O[N+4]<<16)+(O[N+5]<<8)+O[N+6],H>=9e15?crypto.randomBytes(7).copy(O,N):(V.push(H%1e14),N+=7);N=W/7}else throw He=!1,Error(s+"crypto unavailable");if(!He)for(;N<W;)H=R(),H<9e15&&(V[N++]=H%1e14);for(W=V[--N],S%=u,W&&S&&(H=h[u-S],V[N]=o(W/H)*H);V[N]===0;V.pop(),N--);if(N<0)V=[k=0];else{for(k=-1;V[0]===0;V.splice(0,1),k-=u);for(N=1,H=V[0];H>=10;H/=10,N++);N<u&&(k-=u-N)}return $.e=k,$.c=V,$}}(),w.sum=function(){for(var b=1,R=arguments,S=new w(R[0]);b<R.length;)S=S.plus(R[b++]);return S},Y=function(){var b="0123456789";function R(S,O,T,k){for(var W,H=[0],N,V=0,$=S.length;V<$;){for(N=H.length;N--;H[N]*=O);for(H[0]+=k.indexOf(S.charAt(V++)),W=0;W<H.length;W++)H[W]>T-1&&(H[W+1]==null&&(H[W+1]=0),H[W+1]+=H[W]/T|0,H[W]%=T)}return H.reverse()}return function(S,O,T,k,W){var H,N,V,$,z,ne,ce,Ee,ke=S.indexOf("."),je=Q,Re=se;for(ke>=0&&($=jt,jt=0,S=S.replace(".",""),Ee=new w(O),ne=Ee.pow(S.length-ke),jt=$,Ee.c=R(D(y(ne.c),ne.e,"0"),10,T,b),Ee.e=Ee.c.length),ce=R(S,O,T,W?(H=m,b):(H=b,m)),V=$=ce.length;ce[--$]==0;ce.pop());if(!ce[0])return H.charAt(0);if(ke<0?--V:(ne.c=ce,ne.e=V,ne.s=k,ne=x(ne,Ee,je,Re,T),ce=ne.c,z=ne.r,V=ne.e),N=V+je+1,ke=ce[N],$=T/2,z=z||N<0||ce[N+1]!=null,z=Re<4?(ke!=null||z)&&(Re==0||Re==(ne.s<0?3:2)):ke>$||ke==$&&(Re==4||z||Re==6&&ce[N-1]&1||Re==(ne.s<0?8:7)),N<1||!ce[0])S=z?D(H.charAt(1),-je,H.charAt(0)):H.charAt(0);else{if(ce.length=N,z)for(--T;++ce[--N]>T;)ce[N]=0,N||(++V,ce=[1].concat(ce));for($=ce.length;!ce[--$];);for(ke=0,S="";ke<=$;S+=H.charAt(ce[ke++]));S=D(S,V,H.charAt(0))}return S}}(),x=function(){function b(O,T,k){var W,H,N,V,$=0,z=O.length,ne=T%d,ce=T/d|0;for(O=O.slice();z--;)N=O[z]%d,V=O[z]/d|0,W=ce*N+V*ne,H=ne*N+W%d*d+$,$=(H/k|0)+(W/d|0)+ce*V,O[z]=H%k;return $&&(O=[$].concat(O)),O}function R(O,T,k,W){var H,N;if(k!=W)N=k>W?1:-1;else for(H=N=0;H<k;H++)if(O[H]!=T[H]){N=O[H]>T[H]?1:-1;break}return N}function S(O,T,k,W){for(var H=0;k--;)O[k]-=H,H=O[k]<T[k]?1:0,O[k]=H*W+O[k]-T[k];for(;!O[0]&&O.length>1;O.splice(0,1));}return function(O,T,k,W,H){var N,V,$,z,ne,ce,Ee,ke,je,Re,$e,St,yi,$o,Ur,Rt,sn,wt=O.s==T.s?1:-1,Et=O.c,Fe=T.c;if(!Et||!Et[0]||!Fe||!Fe[0])return new w(!O.s||!T.s||(Et?Fe&&Et[0]==Fe[0]:!Fe)?NaN:Et&&Et[0]==0||!Fe?wt*0:wt/0);for(ke=new w(wt),je=ke.c=[],V=O.e-T.e,wt=k+V+1,H||(H=l,V=C(O.e/u)-C(T.e/u),wt=wt/u|0),$=0;Fe[$]==(Et[$]||0);$++);if(Fe[$]>(Et[$]||0)&&V--,wt<0)je.push(1),z=!0;else{for($o=Et.length,Rt=Fe.length,$=0,wt+=2,ne=o(H/(Fe[0]+1)),ne>1&&(Fe=b(Fe,ne,H),Et=b(Et,ne,H),Rt=Fe.length,$o=Et.length),yi=Rt,Re=Et.slice(0,Rt),$e=Re.length;$e<Rt;Re[$e++]=0);sn=Fe.slice(),sn=[0].concat(sn),Ur=Fe[0],Fe[1]>=H/2&&Ur++;do{if(ne=0,N=R(Fe,Re,Rt,$e),N<0){if(St=Re[0],Rt!=$e&&(St=St*H+(Re[1]||0)),ne=o(St/Ur),ne>1)for(ne>=H&&(ne=H-1),ce=b(Fe,ne,H),Ee=ce.length,$e=Re.length;R(ce,Re,Ee,$e)==1;)ne--,S(ce,Rt<Ee?sn:Fe,Ee,H),Ee=ce.length,N=1;else ne==0&&(N=ne=1),ce=Fe.slice(),Ee=ce.length;if(Ee<$e&&(ce=[0].concat(ce)),S(Re,ce,$e,H),$e=Re.length,N==-1)for(;R(Fe,Re,Rt,$e)<1;)ne++,S(Re,Rt<$e?sn:Fe,$e,H),$e=Re.length}else N===0&&(ne++,Re=[0]);je[$++]=ne,Re[0]?Re[$e++]=Et[yi]||0:(Re=[Et[yi]],$e=1)}while((yi++<$o||Re[0]!=null)&&wt--);z=Re[0]!=null,je[0]||je.splice(0,1)}if(H==l){for($=1,wt=je[0];wt>=10;wt/=10,$++);G(ke,k+(ke.e=$+V*u-1)+1,W,z)}else ke.e=V,ke.r=+z;return ke}}();function A(b,R,S,O){var T,k,W,H,N;if(S==null?S=se:p(S,0,8),!b.c)return b.toString();if(T=b.c[0],W=b.e,R==null)N=y(b.c),N=O==1||O==2&&(W<=te||W>=le)?P(N,W):D(N,W,"0");else if(b=G(new w(b),R,S),k=b.e,N=y(b.c),H=N.length,O==1||O==2&&(R<=k||k<=te)){for(;H<R;N+="0",H++);N=P(N,k)}else if(R-=W,N=D(N,k,"0"),k+1>H){if(--R>0)for(N+=".";R--;N+="0");}else if(R+=k-H,R>0)for(k+1==H&&(N+=".");R--;N+="0");return b.s<0&&T?"-"+N:N}function F(b,R){for(var S,O,T=1,k=new w(b[0]);T<b.length;T++)O=new w(b[T]),(!O.s||(S=E(k,O))===R||S===0&&k.s===R)&&(k=O);return k}function j(b,R,S){for(var O=1,T=R.length;!R[--T];R.pop());for(T=R[0];T>=10;T/=10,O++);return(S=O+S*u-1)>be?b.c=b.e=null:S<ct?b.c=[b.e=0]:(b.e=S,b.c=R),b}U=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,R=/^([^.]+)\.$/,S=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,T=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,W,H,N){var V,$=H?W:W.replace(T,"");if(O.test($))k.s=isNaN($)?null:$<0?-1:1;else{if(!H&&($=$.replace(b,function(z,ne,ce){return V=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,!N||N==V?ne:z}),N&&(V=N,$=$.replace(R,"$1").replace(S,"0.$1")),W!=$))return new w($,V);if(w.DEBUG)throw Error(s+"Not a"+(N?" base "+N:"")+" number: "+W);k.s=null}k.c=k.e=null}}();function G(b,R,S,O){var T,k,W,H,N,V,$,z=b.c,ne=h;if(z){e:{for(T=1,H=z[0];H>=10;H/=10,T++);if(k=R-T,k<0)k+=u,W=R,N=z[V=0],$=o(N/ne[T-W-1]%10);else if(V=i((k+1)/u),V>=z.length)if(O){for(;z.length<=V;z.push(0));N=$=0,T=1,k%=u,W=k-u+1}else break e;else{for(N=H=z[V],T=1;H>=10;H/=10,T++);k%=u,W=k-u+T,$=W<0?0:o(N/ne[T-W-1]%10)}if(O=O||R<0||z[V+1]!=null||(W<0?N:N%ne[T-W-1]),O=S<4?($||O)&&(S==0||S==(b.s<0?3:2)):$>5||$==5&&(S==4||O||S==6&&(k>0?W>0?N/ne[T-W]:0:z[V-1])%10&1||S==(b.s<0?8:7)),R<1||!z[0])return z.length=0,O?(R-=b.e+1,z[0]=ne[(u-R%u)%u],b.e=-R||0):z[0]=b.e=0,b;if(k==0?(z.length=V,H=1,V--):(z.length=V+1,H=ne[u-k],z[V]=W>0?o(N/ne[T-W]%ne[W])*H:0),O)for(;;)if(V==0){for(k=1,W=z[0];W>=10;W/=10,k++);for(W=z[0]+=H,H=1;W>=10;W/=10,H++);k!=H&&(b.e++,z[0]==l&&(z[0]=1));break}else{if(z[V]+=H,z[V]!=l)break;z[V--]=0,H=1}for(k=z.length;z[--k]===0;z.pop());}b.e>be?b.c=b.e=null:b.e<ct&&(b.c=[b.e=0])}return b}function K(b){var R,S=b.e;return S===null?b.toString():(R=y(b.c),R=S<=te||S>=le?P(R,S):D(R,S,"0"),b.s<0?"-"+R:R)}return B.absoluteValue=B.abs=function(){var b=new w(this);return b.s<0&&(b.s=1),b},B.comparedTo=function(b,R){return E(this,new w(b,R))},B.decimalPlaces=B.dp=function(b,R){var S,O,T,k=this;if(b!=null)return p(b,0,f),R==null?R=se:p(R,0,8),G(new w(k),b+k.e+1,R);if(!(S=k.c))return null;if(O=((T=S.length-1)-C(this.e/u))*u,T=S[T])for(;T%10==0;T/=10,O--);return O<0&&(O=0),O},B.dividedBy=B.div=function(b,R){return x(this,new w(b,R),Q,se)},B.dividedToIntegerBy=B.idiv=function(b,R){return x(this,new w(b,R),0,1)},B.exponentiatedBy=B.pow=function(b,R){var S,O,T,k,W,H,N,V,$,z=this;if(b=new w(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+K(b));if(R!=null&&(R=new w(R)),H=b.e>14,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!b.c||!b.c[0])return $=new w(Math.pow(+K(z),H?b.s*(2-_(b)):+K(b))),R?$.mod(R):$;if(N=b.s<0,R){if(R.c?!R.c[0]:!R.s)return new w(NaN);O=!N&&z.isInteger()&&R.isInteger(),O&&(z=z.mod(R))}else{if(b.e>9&&(z.e>0||z.e<-1||(z.e==0?z.c[0]>1||H&&z.c[1]>=24e7:z.c[0]<8e13||H&&z.c[0]<=9999975e7)))return k=z.s<0&&_(b)?-0:0,z.e>-1&&(k=1/k),new w(N?1/k:k);jt&&(k=i(jt/u+2))}for(H?(S=new w(.5),N&&(b.s=1),V=_(b)):(T=Math.abs(+K(b)),V=T%2),$=new w(Z);;){if(V){if($=$.times(z),!$.c)break;k?$.c.length>k&&($.c.length=k):O&&($=$.mod(R))}if(T){if(T=o(T/2),T===0)break;V=T%2}else if(b=b.times(S),G(b,b.e+1,1),b.e>14)V=_(b);else{if(T=+K(b),T===0)break;V=T%2}z=z.times(z),k?z.c&&z.c.length>k&&(z.c.length=k):O&&(z=z.mod(R))}return O?$:(N&&($=Z.div($)),R?$.mod(R):k?G($,jt,se,W):$)},B.integerValue=function(b){var R=new w(this);return b==null?b=se:p(b,0,8),G(R,R.e+1,b)},B.isEqualTo=B.eq=function(b,R){return E(this,new w(b,R))===0},B.isFinite=function(){return!!this.c},B.isGreaterThan=B.gt=function(b,R){return E(this,new w(b,R))>0},B.isGreaterThanOrEqualTo=B.gte=function(b,R){return(R=E(this,new w(b,R)))===1||R===0},B.isInteger=function(){return!!this.c&&C(this.e/u)>this.c.length-2},B.isLessThan=B.lt=function(b,R){return E(this,new w(b,R))<0},B.isLessThanOrEqualTo=B.lte=function(b,R){return(R=E(this,new w(b,R)))===-1||R===0},B.isNaN=function(){return!this.s},B.isNegative=function(){return this.s<0},B.isPositive=function(){return this.s>0},B.isZero=function(){return!!this.c&&this.c[0]==0},B.minus=function(b,R){var S,O,T,k,W=this,H=W.s;if(b=new w(b,R),R=b.s,!H||!R)return new w(NaN);if(H!=R)return b.s=-R,W.plus(b);var N=W.e/u,V=b.e/u,$=W.c,z=b.c;if(!N||!V){if(!$||!z)return $?(b.s=-R,b):new w(z?W:NaN);if(!$[0]||!z[0])return z[0]?(b.s=-R,b):new w($[0]?W:se==3?-0:0)}if(N=C(N),V=C(V),$=$.slice(),H=N-V){for((k=H<0)?(H=-H,T=$):(V=N,T=z),T.reverse(),R=H;R--;T.push(0));T.reverse()}else for(O=(k=(H=$.length)<(R=z.length))?H:R,H=R=0;R<O;R++)if($[R]!=z[R]){k=$[R]<z[R];break}if(k&&(T=$,$=z,z=T,b.s=-b.s),R=(O=z.length)-(S=$.length),R>0)for(;R--;$[S++]=0);for(R=l-1;O>H;){if($[--O]<z[O]){for(S=O;S&&!$[--S];$[S]=R);--$[S],$[O]+=l}$[O]-=z[O]}for(;$[0]==0;$.splice(0,1),--V);return $[0]?j(b,$,V):(b.s=se==3?-1:1,b.c=[b.e=0],b)},B.modulo=B.mod=function(b,R){var S,O,T=this;return b=new w(b,R),!T.c||!b.s||b.c&&!b.c[0]?new w(NaN):!b.c||T.c&&!T.c[0]?new w(T):(ft==9?(O=b.s,b.s=1,S=x(T,b,0,3),b.s=O,S.s*=O):S=x(T,b,0,ft),b=T.minus(S.times(b)),!b.c[0]&&ft==1&&(b.s=T.s),b)},B.multipliedBy=B.times=function(b,R){var S,O,T,k,W,H,N,V,$,z,ne,ce,Ee,ke,je,Re=this,$e=Re.c,St=(b=new w(b,R)).c;if(!$e||!St||!$e[0]||!St[0])return!Re.s||!b.s||$e&&!$e[0]&&!St||St&&!St[0]&&!$e?b.c=b.e=b.s=null:(b.s*=Re.s,!$e||!St?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(O=C(Re.e/u)+C(b.e/u),b.s*=Re.s,N=$e.length,z=St.length,N<z&&(Ee=$e,$e=St,St=Ee,T=N,N=z,z=T),T=N+z,Ee=[];T--;Ee.push(0));for(ke=l,je=d,T=z;--T>=0;){for(S=0,ne=St[T]%je,ce=St[T]/je|0,W=N,k=T+W;k>T;)V=$e[--W]%je,$=$e[W]/je|0,H=ce*V+$*ne,V=ne*V+H%je*je+Ee[k]+S,S=(V/ke|0)+(H/je|0)+ce*$,Ee[k--]=V%ke;Ee[k]=S}return S?++O:Ee.splice(0,1),j(b,Ee,O)},B.negated=function(){var b=new w(this);return b.s=-b.s||null,b},B.plus=function(b,R){var S,O=this,T=O.s;if(b=new w(b,R),R=b.s,!T||!R)return new w(NaN);if(T!=R)return b.s=-R,O.minus(b);var k=O.e/u,W=b.e/u,H=O.c,N=b.c;if(!k||!W){if(!H||!N)return new w(T/0);if(!H[0]||!N[0])return N[0]?b:new w(H[0]?O:T*0)}if(k=C(k),W=C(W),H=H.slice(),T=k-W){for(T>0?(W=k,S=N):(T=-T,S=H),S.reverse();T--;S.push(0));S.reverse()}for(T=H.length,R=N.length,T-R<0&&(S=N,N=H,H=S,R=T),T=0;R;)T=(H[--R]=H[R]+N[R]+T)/l|0,H[R]=l===H[R]?0:H[R]%l;return T&&(H=[T].concat(H),++W),j(b,H,W)},B.precision=B.sd=function(b,R){var S,O,T,k=this;if(b!=null&&b!==!!b)return p(b,1,f),R==null?R=se:p(R,0,8),G(new w(k),b,R);if(!(S=k.c))return null;if(T=S.length-1,O=T*u+1,T=S[T]){for(;T%10==0;T/=10,O--);for(T=S[0];T>=10;T/=10,O++);}return b&&k.e+1>O&&(O=k.e+1),O},B.shiftedBy=function(b){return p(b,-9007199254740991,c),this.times("1e"+b)},B.squareRoot=B.sqrt=function(){var b,R,S,O,T,k=this,W=k.c,H=k.s,N=k.e,V=Q+4,$=new w("0.5");if(H!==1||!W||!W[0])return new w(!H||H<0&&(!W||W[0])?NaN:W?k:1/0);if(H=Math.sqrt(+K(k)),H==0||H==1/0?(R=y(W),(R.length+N)%2==0&&(R+="0"),H=Math.sqrt(+R),N=C((N+1)/2)-(N<0||N%2),H==1/0?R="5e"+N:(R=H.toExponential(),R=R.slice(0,R.indexOf("e")+1)+N),S=new w(R)):S=new w(H+""),S.c[0]){for(N=S.e,H=N+V,H<3&&(H=0);;)if(T=S,S=$.times(T.plus(x(k,T,V,1))),y(T.c).slice(0,H)===(R=y(S.c)).slice(0,H))if(S.e<N&&--H,R=R.slice(H-3,H+1),R=="9999"||!O&&R=="4999"){if(!O&&(G(T,T.e+Q+2,0),T.times(T).eq(k))){S=T;break}V+=4,H+=4,O=1}else{(!+R||!+R.slice(1)&&R.charAt(0)=="5")&&(G(S,S.e+Q+2,1),b=!S.times(S).eq(k));break}}return G(S,S.e+Q+1,se,b)},B.toExponential=function(b,R){return b!=null&&(p(b,0,f),b++),A(this,b,R,1)},B.toFixed=function(b,R){return b!=null&&(p(b,0,f),b=b+this.e+1),A(this,b,R)},B.toFormat=function(b,R,S){var O,T=this;if(S==null)b!=null&&R&&typeof R=="object"?(S=R,R=null):b&&typeof b=="object"?(S=b,b=R=null):S=Ze;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(O=T.toFixed(b,R),T.c){var k,W=O.split("."),H=+S.groupSize,N=+S.secondaryGroupSize,V=S.groupSeparator||"",$=W[0],z=W[1],ne=T.s<0,ce=ne?$.slice(1):$,Ee=ce.length;if(N&&(k=H,H=N,N=k,Ee-=k),H>0&&Ee>0){for(k=Ee%H||H,$=ce.substr(0,k);k<Ee;k+=H)$+=V+ce.substr(k,H);N>0&&($+=V+ce.slice(k)),ne&&($="-"+$)}O=z?$+(S.decimalSeparator||"")+((N=+S.fractionGroupSize)?z.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):z):$}return(S.prefix||"")+O+(S.suffix||"")},B.toFraction=function(b){var R,S,O,T,k,W,H,N,V,$,z,ne,ce=this,Ee=ce.c;if(b!=null&&(H=new w(b),!H.isInteger()&&(H.c||H.s!==1)||H.lt(Z)))throw Error(s+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+K(H));if(!Ee)return new w(ce);for(R=new w(Z),V=S=new w(Z),O=N=new w(Z),ne=y(Ee),k=R.e=ne.length-ce.e-1,R.c[0]=h[(W=k%u)<0?u+W:W],b=!b||H.comparedTo(R)>0?k>0?R:V:H,W=be,be=1/0,H=new w(ne),N.c[0]=0;$=x(H,R,0,1),T=S.plus($.times(O)),T.comparedTo(b)!=1;)S=O,O=T,V=N.plus($.times(T=V)),N=T,R=H.minus($.times(T=R)),H=T;return T=x(b.minus(S),O,0,1),N=N.plus(T.times(V)),S=S.plus(T.times(O)),N.s=V.s=ce.s,k=k*2,z=x(V,O,k,se).minus(ce).abs().comparedTo(x(N,S,k,se).minus(ce).abs())<1?[V,O]:[N,S],be=W,z},B.toNumber=function(){return+K(this)},B.toPrecision=function(b,R){return b!=null&&p(b,1,f),A(this,b,R,2)},B.toString=function(b){var R,S=this,O=S.s,T=S.e;return T===null?O?(R="Infinity",O<0&&(R="-"+R)):R="NaN":(b==null?R=T<=te||T>=le?P(y(S.c),T):D(y(S.c),T,"0"):b===10&&v?(S=G(new w(S),Q+T+1,se),R=D(y(S.c),S.e,"0")):(p(b,2,m.length,"Base"),R=Y(D(y(S.c),T,"0"),10,b,O,!0)),O<0&&S.c[0]&&(R="-"+R)),R},B.valueOf=B.toJSON=function(){return K(this)},B._isBigNumber=!0,M!=null&&w.set(M),w}function C(M){var x=M|0;return M>0||M===x?x:x-1}function y(M){for(var x,Y,U=1,B=M.length,Z=M[0]+"";U<B;){for(x=M[U++]+"",Y=u-x.length;Y--;x="0"+x);Z+=x}for(B=Z.length;Z.charCodeAt(--B)===48;);return Z.slice(0,B+1||1)}function E(M,x){var Y,U,B=M.c,Z=x.c,Q=M.s,se=x.s,te=M.e,le=x.e;if(!Q||!se)return null;if(Y=B&&!B[0],U=Z&&!Z[0],Y||U)return Y?U?0:-se:Q;if(Q!=se)return Q;if(Y=Q<0,U=te==le,!B||!Z)return U?0:!B^Y?1:-1;if(!U)return te>le^Y?1:-1;for(se=(te=B.length)<(le=Z.length)?te:le,Q=0;Q<se;Q++)if(B[Q]!=Z[Q])return B[Q]>Z[Q]^Y?1:-1;return te==le?0:te>le^Y?1:-1}function p(M,x,Y,U){if(M<x||M>Y||M!==o(M))throw Error(s+(U||"Argument")+(typeof M=="number"?M<x||M>Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(M))}function _(M){var x=M.c.length-1;return C(M.e/u)==x&&M.c[x]%2!=0}function P(M,x){return(M.length>1?M.charAt(0)+"."+M.slice(1):M)+(x<0?"e":"e+")+x}function D(M,x,Y){var U,B;if(x<0){for(B=Y+".";++x;B+=Y);M=B+M}else if(U=M.length,++x>U){for(B=Y,x-=U;--x;B+=Y);M+=B}else x<U&&(M=M.slice(0,x)+"."+M.slice(x));return M}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(F7)})(tF);var nF=tF.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ai=VT(),a5=$T(),l5=FT,u5=nF,Mn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},bf={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:rF,decimalSuffixes:op}=Ai.currentBytes(),WT={general:{scale:1024,suffixes:op},binary:{scale:1024,suffixes:rF},decimal:{scale:1e3,suffixes:op}};function c5(t,e={},n){if(typeof e=="string"&&(e=l5.parseFormat(e)),!a5.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=h5(t,e,n);return s=O5(s,i),s=x5(s,o),s}function h5(t,e,n){switch(e.output){case"currency":return e=zu(e,Ai.currentCurrencyDefaultFormat()),C5(t,e,Ai);case"percent":return e=zu(e,Ai.currentPercentageDefaultFormat()),v5(t,e,Ai,n);case"byte":return e=zu(e,Ai.currentByteDefaultFormat()),m5(t,e,Ai,n);case"time":return e=zu(e,Ai.currentTimeDefaultFormat()),w5(t);case"ordinal":return e=zu(e,Ai.currentOrdinalDefaultFormat()),p5(t,e,Ai);case"number":default:return Sf({instance:t,providedFormat:e})}}function d5(t){let e=WT.decimal;return Ew(t._value,e.suffixes,e.scale).suffix}function f5(t){let e=WT.binary;return Ew(t._value,e.suffixes,e.scale).suffix}function g5(t){let e=WT.general;return Ew(t._value,e.suffixes,e.scale).suffix}function Ew(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function m5(t,e,n,r){let i=e.base||"binary",o=Object.assign({},bf,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||op,marker:"bd"},binary:{scale:1024,suffixes:s||rF,marker:"b"},decimal:{scale:1e3,suffixes:a||op,marker:"d"}}[i],{value:c,suffix:h}=Ew(t._value,u.suffixes,u.scale);return`${Sf({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function p5(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},bf,e),o=Sf({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function w5(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function v5(t,e,n,r){let i=e.prefixSymbol,o=Sf({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},bf,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function C5(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},bf,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Sf({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function y5({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&Mn[e]?(a=r[e],t=t/Mn[e]):l>=Mn.trillion||n&&s(l/Mn.trillion)===1?(a=r.trillion,t=t/Mn.trillion):l<Mn.trillion&&l>=Mn.billion||n&&s(l/Mn.billion)===1?(a=r.billion,t=t/Mn.billion):l<Mn.billion&&l>=Mn.million||n&&s(l/Mn.million)===1?(a=r.million,t=t/Mn.million):(l<Mn.million&&l>=Mn.thousand||n&&s(l/Mn.thousand)===1)&&(a=r.thousand,t=t/Mn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function b5({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function gg(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function S5(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+gg(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(gg(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=gg(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${gg(e)}`),n}function R5(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?S5(t,e):new u5(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function E5(t,e,n,r,i,o){if(r===-1)return t;let s=R5(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function _5(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function T5(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function M5(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),T5(u.length,a).forEach((f,g)=>{u=u.slice(0,f+g)+s+u.slice(f+g)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function I5(t,e){return t+e}function P5(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function O5(t,e){return e+t}function x5(t,e){return t+e}function Sf({instance:t,providedFormat:e,state:n=Ai,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},bf,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,C=s.trimMantissa,y=s.thousandSeparated,E=s.spaceSeparated,p=s.negative,_=s.forceSign,P=s.exponential,D=s.roundingFunction,M="";if(d){let Y=y5({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:D,totalLength:a});o=Y.value,M+=Y.abbreviation,a&&(f=Y.mantissaPrecision)}if(P){let Y=b5({value:o,characteristicPrecision:l});o=Y.value,M=Y.abbreviation+M}let x=E5(o.toString(),o,g,f,C,D);return x=_5(x,o,u,l),x=M5(x,o,y,n,r),(d||P)&&(x=I5(x,M)),(_||o<0)&&(x=P5(x,o,p)),x}function zu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var A5=t=>({format:(...e)=>c5(...e,t),getByteUnit:(...e)=>g5(...e,t),getBinaryByteUnit:(...e)=>f5(...e,t),getDecimalByteUnit:(...e)=>d5(...e,t),formatOrDefault:zu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Rs=nF;function H5(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.plus(i).toNumber(),t}function iF(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.minus(i).toNumber(),t}function N5(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.times(i).toNumber(),t}function D5(t,e,n){let r=new Rs(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new Rs(i),t._value=r.dividedBy(i).toNumber(),t}function k5(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function L5(t,e,n){let r=n(t._value);return iF(r,e,n),Math.abs(r._value)}var $5=t=>({add:(e,n)=>H5(e,n,t),subtract:(e,n)=>iF(e,n,t),multiply:(e,n)=>N5(e,n,t),divide:(e,n)=>D5(e,n,t),set:(e,n)=>k5(e,n,t),difference:(e,n)=>L5(e,n,t),BigNumber:Rs});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const F5="2.5.0",Lo=VT(),V5=$T(),W5=s5(Xt),B5=eF();let Ba=A5(Xt),wl=$5(Xt);const j5=FT;class oF{constructor(e){this._value=e}clone(){return Xt(this._value)}format(e={}){return Ba.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=j5.parseFormat(e)),e=Ba.formatOrDefault(e,Lo.currentCurrencyDefaultFormat()),e.output="currency",Ba.format(this,e)}formatTime(e={}){return e.output="time",Ba.format(this,e)}binaryByteUnits(){return Ba.getBinaryByteUnit(this)}decimalByteUnits(){return Ba.getDecimalByteUnit(this)}byteUnits(){return Ba.getByteUnit(this)}difference(e){return wl.difference(this,e)}add(e){return wl.add(this,e)}subtract(e){return wl.subtract(this,e)}multiply(e){return wl.multiply(this,e)}divide(e){return wl.divide(this,e)}set(e){return wl.set(this,sF(e))}value(){return this._value}valueOf(){return this._value}}function sF(t){let e=t;return Xt.isNumbro(t)?e=t._value:typeof t=="string"?e=Xt.unformat(t):isNaN(t)&&(e=NaN),e}function Xt(t){return new oF(sF(t))}Xt.version=F5;Xt.isNumbro=function(t){return t instanceof oF};Xt.language=Lo.currentLanguage;Xt.registerLanguage=Lo.registerLanguage;Xt.setLanguage=Lo.setLanguage;Xt.languages=Lo.languages;Xt.languageData=Lo.languageData;Xt.zeroFormat=Lo.setZeroFormat;Xt.defaultFormat=Lo.currentDefaults;Xt.setDefaults=Lo.setDefaults;Xt.defaultCurrencyFormat=Lo.currentCurrencyDefaultFormat;Xt.validate=V5.validate;Xt.loadLanguagesInNode=W5.loadLanguagesInNode;Xt.unformat=B5.unformat;Xt.BigNumber=wl.BigNumber;var U5=Xt,ja=V7(U5);const z5="numeric";function aF(t,e){if(Fn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!ja.languages()[r]){const o=r.replace("-",""),s=ja.allLanguages?ja.allLanguages[r]:ja[o];s&&ja.registerLanguage(s)}ja.setLanguage(r),t=ja(t).format(i||"0")}return t}function BT(t,e,n,r,i,o,s){let a=o;if(Fn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=aF(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}Os(t,e,n,r,i,a,s)}BT.RENDERER_TYPE=z5;const Y5="password";function jT(t,e,n,r,i,o,s){Os.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),Ql(e,u)}jT.RENDERER_TYPE=Y5;const G5="select";function UT(t,e,n,r,i,o,s){Os.apply(this,[t,e,n,r,i,o,s])}UT.RENDERER_TYPE=G5;const q5="time";function zT(t,e,n,r,i,o,s){Os.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}zT.RENDERER_TYPE=q5;function K5(){Nr(kc),Nr(yf),Nr(DT),Nr(NT),Nr(LT),Nr(HT),Nr(BT),Nr(jT),Nr(UT),Nr(Os),Nr(zT)}const X5="autocomplete";function _w(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,VA(n,e)):VA(n,e)(this.source):e(!0)}_w.VALIDATOR_TYPE=X5;function VA(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function lF(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Z5=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:lF},Symbol.toStringTag,{value:"Module"})),Q5="date";function YT(t,e){const n=LL(Y$,this.instance);let r=t,i=!0;r==null&&(r="");let o=X(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=X(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=J5(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}YT.VALIDATOR_TYPE=Q5;function J5(t,e){const n=X(lF(t)),r=X(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const eZ="dropdown";function GT(t,e){_w.apply(this,[t,e])}GT.VALIDATOR_TYPE=eZ;const tZ="numeric";function qT(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Fn(t))}qT.VALIDATOR_TYPE=tZ;const nZ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],rZ="time";function KT(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=X(i,nZ,!0).isValid()?X(i):X(i,n);let a=s.isValid(),l=X(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}KT.VALIDATOR_TYPE=rZ;function iZ(){bl(_w),bl(GT),bl(YT),bl(qT),bl(KT)}const oZ="autocomplete",sZ={CELL_TYPE:oZ,editor:xT,renderer:kc,validator:_w},aZ="checkbox",lZ={CELL_TYPE:aZ,editor:z$,renderer:DT},uZ="date";function uF(t,e,n,r,i,o,s){kc.apply(this,[t,e,n,r,i,o,s])}uF.RENDERER_TYPE=uZ;const cZ="date",hZ={CELL_TYPE:cZ,editor:G$,renderer:uF,validator:YT},dZ="dropdown",fZ={CELL_TYPE:dZ,editor:q$,renderer:NT,validator:GT,filter:!1,strict:!0},gZ="handsontable",mZ={CELL_TYPE:gZ,editor:OT,renderer:LT},pZ="numeric",wZ={CELL_TYPE:pZ,editor:K$,renderer:BT,validator:qT,dataType:"number"},vZ="password",CZ={CELL_TYPE:vZ,editor:X$,renderer:jT,copyable:!1},yZ="select",bZ={CELL_TYPE:yZ,editor:Z$,renderer:UT},SZ="time",RZ={CELL_TYPE:SZ,editor:Q$,renderer:zT,validator:KT};function EZ(){Zr(sZ),Zr(lZ),Zr(hZ),Zr(fZ),Zr(mZ),Zr(wZ),Zr(CZ),Zr(bZ),Zr(j$),Zr(RZ)}function _Z(t,e){cF(t,e),e.add(t)}function TZ(t,e,n){cF(t,e),e.set(t,n)}function cF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pu(t,e,n){return(e=MZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MZ(t){var e=IZ(t,"string");return typeof e=="symbol"?e:e+""}function IZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(t,e){return t.get(hF(t,e))}function hF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const WA=new Map([["plugin",fK],["cell-type",H$],["editor",kL],["renderer",UL],["validator",zL]]),dF=Symbol("mainSetting"),PZ="base",mg=[];let Ua=null;var za=new WeakMap,BA=new WeakSet;class Ge{static get PLUGIN_KEY(){return PZ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){_Z(this,BA),pu(this,"eventManager",new di(this)),pu(this,"pluginName",null),pu(this,"pluginsInitializedCallbacks",[]),pu(this,"isPluginsReady",!1),pu(this,"enabled",!1),pu(this,"initialized",!1),TZ(this,za,{}),ko(this,"hot",e,{writable:!1}),Ua=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!WA.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);WA.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");mg.push(o)}}if(Ua||(Ua=H0()),Ua.indexOf(this.pluginName)>=0&&Ua.splice(Ua.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ua.length===0){if(mg.length>0){const i=[`${mg.join(`
`)}
`,"You have to import and register them manually."].join("");throw mg.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||xe(n))&&r[dF]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(xe(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){wu(za,this)[e]=wu(za,this)[e]||[];const i=wu(za,this)[e];this.hot.addHook(e,n,r),i.push(n),wu(za,this)[e]=i}removeHooks(e){I(wu(za,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=wu(za,this);Ae(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){I(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=hF(BA,this,OZ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ae(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function OZ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ya(t,e,n){return(e=xZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xZ(t){var e=AZ(t,"string");return typeof e=="symbol"?e:e+""}function AZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let XT=class{constructor(e){Ya(this,"hot",null),Ya(this,"container",null),Ya(this,"injected",!1),Ya(this,"rows",[]),Ya(this,"columns",[]),Ya(this,"samples",null),Ya(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&q(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),I(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),I(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{I(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{I(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{I(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),I(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{I(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function pg(t,e,n){return(e=HZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HZ(t){var e=NZ(t,"string");return typeof e=="symbol"?e:e+""}function NZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tw{static get SAMPLE_COUNT(){return 3}constructor(e){pg(this,"samples",null),pg(this,"dataFactory",null),pg(this,"customSampleCount",null),pg(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Tw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:xe(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${yt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function DZ(t,e){fF(t,e),e.add(t)}function Ib(t,e,n){fF(t,e),e.set(t,n)}function fF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fh(t,e,n){return(e=kZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kZ(t){var e=LZ(t,"string");return typeof e=="symbol"?e:e+""}function LZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function la(t,e){return t.get(vr(t,e))}function sp(t,e,n){return t.set(vr(t,e),n),n}function vr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutoColumnSizeSeed");const Pb="autoColumnSize",$Z=10,FZ="autoColumnSize";var ZT=new WeakMap,Yu=new WeakMap,vc=new WeakMap,Dr=new WeakSet;class dd extends Ge{static get PLUGIN_KEY(){return Pb}static get PLUGIN_PRIORITY(){return $Z}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),DZ(this,Dr),fh(this,"ghostTable",new XT(this.hot)),fh(this,"samplesGenerator",new Tw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),fh(this,"inProgress",!1),fh(this,"measuredColumns",0),fh(this,"columnWidthsMap",new Ia),Ib(this,ZT,!1),Ib(this,Yu,[]),Ib(this,vc,[]),this.hot.columnIndexMapper.registerMap(FZ,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>vr(Dr,this,jA).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Pb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vr(Dr,e,BZ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vr(Dr,e,jZ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vr(Dr,e,zZ).call(e,...i)}),this.addHook("beforeRender",()=>vr(Dr,this,WZ).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>vr(Dr,this,UZ).call(this)),super.enablePlugin()}updatePlugin(){sp(vc,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>vr(Dr,this,jA).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&vr(Dr,this,gF).call(this,s,o)}),this.ghostTable.columns.length&&(vr(Dr,this,mF).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Ld(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+dd.CALCULATION_STEP,i)},e,n),r=r+dd.CALCULATION_STEP+1,r<i?o=kd(s):(Ld(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Pb];let n=dd.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return xe(e)&&(n=e.syncLimit,u0(n)?n=x0(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,gc))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=la(Yu,this).length;return(s-1<o||la(Yu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?la(Yu,this).push(i):la(Yu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function VZ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||vr(Dr,this,gF).call(this,n,e))}),this.ghostTable.columns.length&&(vr(Dr,this,mF).call(this),this.ghostTable.clean())}function gF(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function mF(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function WZ(){this.calculateVisibleColumnsWidth(),this.inProgress||(vr(Dr,this,VZ).call(this,la(vc,this)),sp(vc,this,[]))}function BZ(t,e){e||this.recalculateAllColumnsWidth()}function jZ(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);la(vc,this).push(...e)}function jA(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function UZ(){sp(Yu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),sp(ZT,this,!0)}function zZ(t){if(!la(ZT,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);la(vc,this).push(...e)}const _l={horizontal:"horizontal",vertical:"vertical"};function YZ(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function GZ(t){const e={};return t===!0?(e.directions=Object.keys(_l),e.autoInsertRow=!0):xe(t)?(ae(t.autoInsertRow)?t.direction===_l.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ae(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(_l)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function qZ(t,e){KZ(t,e),e.add(t)}function KZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vu(t,e,n){return(e=XZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XZ(t){var e=ZZ(t,"string");return typeof e=="symbol"?e:e+""}function ZZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutofillRange");ie.getSingleton().register("beforeAutofill");ie.getSingleton().register("afterAutofill");const UA="autofill",QZ=20,JZ=["fillHandle"],eQ="insert_row_below",tQ=200;var Cu=new WeakSet;class nQ extends Ge{constructor(){super(...arguments),qZ(this,Cu),vu(this,"addingStarted",!1),vu(this,"mouseDownOnCellCorner",!1),vu(this,"mouseDragOutside",!1),vu(this,"handleDraggedCells",0),vu(this,"directions",[]),vu(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return UA}static get PLUGIN_PRIORITY(){return QZ}static get SETTING_KEYS(){return[UA,...JZ]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>gh(Cu,this,iQ).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>gh(Cu,this,rQ).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>gh(Cu,this,oQ).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return I(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),I(a,c=>{const h=[];I(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=YZ(l,u,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=o.clone(),C=this.hot._createCellRange(h,h,d),y=this.hot.runHooks("beforeAutofill",f,g,C,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=y;const p=y;if(["up","left"].indexOf(c)>-1&&!(p.length===1&&p[0].length===0))if(E=[],c==="up"){const _=d.row-h.row+1,P=_%p.length;for(let D=0;D<_;D++)E.push(p[(D+(p.length-P))%p.length])}else{const _=d.col-h.col+1,P=_%p[0].length;for(let D=0;D<p.length;D++){E.push([]);for(let M=0;M<_;M++)E[D].push(p[D][(M+(p[D].length-P))%p[D].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,g,C,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(_l.vertical)&&this.directions.includes(_l.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(_l.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(_l.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(eQ,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},tQ)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Wt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Wt(s)||!Wt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Be(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Pn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+en(this.hot.table),i=Pn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+Kt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>gh(Cu,this,sQ).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>gh(Cu,this,aQ).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=GZ(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function rQ(){this.selectAdjacent()&&this.fillIn()}function iQ(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function oQ(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function sQ(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function aQ(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function lQ(t,e){pF(t,e),e.add(t)}function zA(t,e,n){pF(t,e),e.set(t,n)}function pF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,n){return(e=uQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uQ(t){var e=cQ(t,"string");return typeof e=="symbol"?e:e+""}function cQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wF(t,e,n){return t.set(vo(t,e),n),n}function ap(t,e){return t.get(vo(t,e))}function vo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ob="autoRowSize",hQ=40,dQ="autoRowSize";var Bd=new WeakMap,QT=new WeakMap,ns=new WeakSet;class fd extends Ge{static get PLUGIN_KEY(){return Ob}static get PLUGIN_PRIORITY(){return hQ}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),lQ(this,ns),yu(this,"headerHeight",null),yu(this,"ghostTable",new XT(this.hot)),yu(this,"samplesGenerator",new Tw((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),yu(this,"inProgress",!1),yu(this,"measuredRows",0),yu(this,"rowHeightsMap",new Ia),zA(this,Bd,[]),zA(this,QT,!1),this.hot.rowIndexMapper.registerMap(dQ,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>vo(ns,this,YA).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Ob];return e===!0||xe(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vo(ns,e,mQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vo(ns,e,pQ).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vo(ns,e,vQ).call(e,...i)}),this.addHook("beforeRender",()=>vo(ns,this,gQ).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>vo(ns,this,wQ).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>vo(ns,this,YA).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Ld(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+fd.CALCULATION_STEP,i)},e,n),r=r+fd.CALCULATION_STEP+1,r<i?o=kd(s):(Ld(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ob];let n=fd.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return xe(e)&&(n=e.syncLimit,u0(n)?n=x0(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fQ(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function gQ(){this.calculateVisibleRowsHeight(),this.inProgress||(vo(ns,this,fQ).call(this,ap(Bd,this)),wF(Bd,this,[]))}function YA(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function mQ(t,e){e||this.recalculateAllRowsHeight()}function pQ(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);ap(Bd,this).push(...e)}function wQ(){this.recalculateAllRowsHeight(),wF(QT,this,!0)}function vQ(t){if(!ap(QT,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);ap(Bd,this).push(...e)}const{getListWithInsertedItems:CQ,getListWithRemovedItems:yQ}=m$("physicallyIndexed");class bQ extends Jl{constructor(){super(e=>e)}insert(e,n){const r=i_(this.indexedValues,n);this.indexedValues=CQ(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=yQ(this.indexedValues,e);this.indexedValues=r_(n,e),super.remove(e)}}const{getListWithInsertedItems:SQ,getListWithRemovedItems:RQ}=m$("physicallyIndexed");class EQ extends Jl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=SQ(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=RQ(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function _Q(t,e){TQ(t,e),e.add(t)}function TQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MQ(t,e,n){return(e=IQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IQ(t){var e=PQ(t,"string");return typeof e=="symbol"?e:e+""}function PQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OQ(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const GA="bindRowsWithHeaders",xQ=210,AQ="loose",qA=new Map([["loose",bQ],["strict",EQ]]);var KA=new WeakSet;class HQ extends Ge{constructor(){super(...arguments),_Q(this,KA),MQ(this,"headerIndexes",null)}static get PLUGIN_KEY(){return GA}static get PLUGIN_PRIORITY(){return xQ}isEnabled(){return!!this.hot.getSettings()[GA]}enablePlugin(){var e;if(this.enabled)return;const n=(e=qA.get(this.getSetting()))!==null&&e!==void 0?e:qA.get(AQ);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>OQ(KA,this,NQ).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function NQ(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function DQ(t,e){vF(t,e),e.add(t)}function kQ(t,e,n){vF(t,e),e.set(t,n)}function vF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XA(t,e,n){return(e=LQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LQ(t){var e=$Q(t,"string");return typeof e=="symbol"?e:e+""}function $Q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZA(t,e){return t.get(Ju(t,e))}function xb(t,e,n){return t.set(Ju(t,e),n),n}function Ju(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Em="collapsibleColumns",FQ=290,VQ=["nestedHeaders"],uc="collapsibleIndicator",QA=Em,JA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var bu=new WeakMap,mh=new WeakSet;class WQ extends Ge{constructor(){super(...arguments),DQ(this,mh),XA(this,"nestedHeadersPlugin",null),XA(this,"headerStateManager",null),kQ(this,bu,null)}static get PLUGIN_KEY(){return Em}static get PLUGIN_PRIORITY(){return FQ}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Em,...VQ]}isEnabled(){return!!this.hot.getSettings()[Em]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Je("You need to configure the Nested Headers plugin in order to use collapsible headers."),xb(bu,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ju(mh,this,UQ).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ju(mh,e,zQ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ju(mh,e,BQ).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Ju(mh,this,jQ).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),xb(bu,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:QA,relativeToGroup:Pa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(QA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${uc}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${uc}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${uc}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!JA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=va(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;I(r,f=>{var g;let{row:C,col:y}=f;const{collapsible:E,isCollapsed:p}=(g=this.headerStateManager.getHeaderSettings(C,y))!==null&&g!==void 0?g:{};if(!E||p&&n==="collapse"||!p&&n==="expand")return i=!1,!1});const o=[],s=[];i&&I(r,f=>{let{row:g,col:C}=f;const{colspanCompensation:y,affectedColumns:E,rollbackModification:p}=this.headerStateManager.triggerNodeModification(n,g,C);y>0&&(s.push(...E),o.push(p))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=Zk([...a,...s]):n==="expand"&&(l=va(a,f=>!s.includes(f)));const u=JA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){I(o,f=>{f()});return}this.hot.batchExecution(()=>{I(s,f=>{ZA(bu,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&s.includes(g)){const y=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;y!==null&&E!==null&&this.hot.selectCell(y,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return ZA(bu,this).getHiddenIndexes()}destroy(){xb(bu,this,null),super.destroy()}}function BQ(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${uc}`);if(Zl(e,[li("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,uc),e.querySelector("div:first-child").appendChild(u)),pe(u,["collapsed","expanded"]),s?(q(u,"collapsed"),ya(u,"+"),l&&ye(e,...li(!1))):(q(u,"expanded"),ya(u,"-"),l&&ye(e,...li(!0))),l&&ye(u,...Xl());else{var c;(c=u)===null||c===void 0||c.remove()}}function jQ(t,e){we(t.target,uc)&&(we(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):we(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),vi(t))}function UQ(){this.updatePlugin()}function zQ(t,e){e||this.updatePlugin()}function Ga(t,e,n){return(e=YQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=GQ(t,"string");return typeof e=="symbol"?e:e+""}function GQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const qQ=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],KQ=!1,XQ=!0,ZQ=!0;class QQ{constructor(e,n){Ga(this,"hot",void 0),Ga(this,"sortingStates",new ww),Ga(this,"sortEmptyCells",KQ),Ga(this,"indicator",XQ),Ga(this,"headerAction",ZQ),Ga(this,"compareFunctionFactory",void 0),Ga(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){xe(e)&&Ae(e,(n,r)=>{qQ.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return xe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ae(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function CF(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Mo:Wt(i)?Wt(o)?Mo:s&&t==="asc"?Ft:Vt:Wt(o)?s&&t==="asc"?Vt:Ft:isNaN(i)&&!isNaN(o)?t==="asc"?Vt:Ft:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ft:Vt:i>o?t==="asc"?Vt:Ft:Mo}}const yF="default";function JQ(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Mo;if(a){if(Wt(r))return t==="asc"?Ft:Vt;if(Wt(i))return t==="asc"?Vt:Ft}return isNaN(o)?Vt:isNaN(s)?Ft:o<s?t==="asc"?Ft:Vt:o>s?t==="asc"?Vt:Ft:Mo}}const eJ="numeric";function tJ(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),u=Wt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Vt;if(l===!1&&u)return Ft}return d===!1&&f?t==="asc"?Ft:Vt:d&&f===!1?t==="asc"?Vt:Ft:d===!1&&f===!1?CF(t,e,n)(s,a):c===i&&h===r?t==="asc"?Ft:Vt:c===r&&h===i?t==="asc"?Vt:Ft:Mo}}const nJ="checkbox";function rJ(t,e,n){return TF(t,e.dateFormat,n)}const iJ="date";function oJ(t,e,n){return TF(t,e.timeFormat,n)}const sJ="time",{register:Rf,getItem:eH,hasItem:aJ}=Gi("sorting.compareFunctionFactory"),{register:bF,getItem:lJ}=Gi("sorting.mainSortComparator");function SF(t){return aJ(t)?eH(t):eH(yF)}Rf(nJ,tJ);Rf(iJ,rJ);Rf(yF,CF);Rf(eJ,JQ);Rf(sJ,oJ);const Mo=0,Ft=-1,Vt=1;function uJ(t,e){const n=lJ(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const lp="asc",up="desc",RF="colHeader";function cJ(t){if(xe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[lp,up].includes(n)}function hJ(t){if(t.some(n=>cJ(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function tH(t){if(t!==up)return t===lp?up:lp}function EF(t){return t.querySelector(`.${RF}`)}function _F(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function JT(t,e,n){return t===-1&&e>=0&&ba(n)===!1}function TF(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Mo;if(Wt(r))return Wt(i)?Mo:o&&t==="asc"?Ft:Vt;if(Wt(i))return o&&t==="asc"?Vt:Ft;const s=X(r,e),a=X(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Ft:Vt:a.isBefore(s)?t==="asc"?Vt:Ft:Mo:Ft:Vt}}function dJ(t,e){Je(ot`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const fJ="ascending",gJ="descending",MF="indicatorDisabled",IF="columnSorting",PF="sortAction",OF=new Map([[lp,fJ],[up,gJ]]);function mJ(t,e,n,r){const i=[IF];if(r&&i.push(PF),n===!1)return i.push(MF),i;const o=t.getSortOrderOfColumn(e);return ae(o)&&i.push(OF.get(o)),i}function pJ(){return Array.from(OF.values()).concat(PF,MF,IF)}function wJ(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:SF(u.type))(l,u,d)(c,h)}(0)}}function vJ(t,e){CJ(t,e),e.add(t)}function CJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wg(t,e,n){return(e=yJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:e+""}function bJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cp="columnSorting",SJ=50,hp="append",RJ="replace",nH=cp;bF(cp,wJ);ie.getSingleton().register("beforeColumnSort");ie.getSingleton().register("afterColumnSort");const ph=new WeakMap;var vl=new WeakSet;class xF extends Ge{constructor(){super(...arguments),vJ(this,vl),wg(this,"columnStatesManager",null),wg(this,"columnMetaCache",null),wg(this,"pluginKey",cp),wg(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return cp}static get PLUGIN_PRIORITY(){return SJ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(ph.has(this.hot)&&ph.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),dJ(ph.get(this.hot),this.pluginKey);return}this.enabled||(ph.set(this.hot,this.pluginKey),this.columnStatesManager=new QQ(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ia(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Gu(vl,this,EJ).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gu(vl,e,TJ).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Gu(vl,this,WR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Gu(vl,e,_J).call(e,...r)}),this.hot.view&&Gu(vl,this,WR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=EF(r);_F(n,r)===!1||i===null||this.updateHeaderClasses(i)};ph.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:Pa,position:"before",group:nH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nH)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new p$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ae(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return hJ(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Be(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ae(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Be(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ae(n)){const i=tH(n);return ae(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:tH()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hp;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Pt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===hp)return[...o.slice(0,r),...o.slice(r+1),s];if(n===RJ)return[...o.slice(0,r),s,...o.slice(r+1)]}return ae(s)?o.concat(s):o}getPluginColumnConfig(e){if(xe(e)){const n=e[this.pluginKey];if(xe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):it(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Be(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Be(n,u=>u[0]);uJ(n,this.pluginKey,Be(e,u=>u.sortOrder),Be(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Be(n,u=>u[0]),a=new Map(Be(o,(u,c)=>[u,s[c]])),l=Be(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(xe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||xe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(pe(e,pJ()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,mJ(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ae(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&we(e.target,RF)}onAfterOnCellMouseDown(e,n){if(JT(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function WR(){const t=this.getAllSavedSortSettings();if(xe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function EJ(t,e){const n=EF(e);if(_F(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);ye(e,...$2(s?`${s}ending`:"none"))}}function _J(t){t===!0&&this.hot.view&&Gu(vl,this,WR).call(this)}function TJ(t,e,n,r){JT(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function qa(t,e,n){return(e=MJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MJ(t){var e=IJ(t,"string");return typeof e=="symbol"?e:e+""}function IJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PJ{constructor(e,n){qa(this,"plugin",void 0),qa(this,"hot",void 0),qa(this,"endpoints",[]),qa(this,"settings",void 0),qa(this,"settingsType","array"),qa(this,"currentEndpoint",null),qa(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),I(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();I(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;I(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?I(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):I(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){I(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];I(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),I(i,o=>{let s=[];I(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,I(e.ranges,r=>{I(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],I(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],I(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],I(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&I(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),I(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Je("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Ab(t){return t==null||isNaN(t)}function OJ(t,e){xJ(t,e),e.add(t)}function xJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function AJ(t,e,n){return(e=HJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:e+""}function NJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hb="columnSummary",DJ=220;var wh=new WeakSet;class kJ extends Ge{constructor(){super(...arguments),OJ(this,wh),AJ(this,"endpoints",null)}static get PLUGIN_KEY(){return Hb}static get PLUGIN_PRIORITY(){return DJ}isEnabled(){return!!this.hot.getSettings()[Hb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Hb],this.endpoints=new PJ(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(wh,e,LJ).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(wh,e,FJ).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(wh,e,$J).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vg(wh,e,VJ).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ae(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Ab(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ae(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Ab(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Ab(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ae(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ot`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function LJ(){this.endpoints.initEndpoints()}function $J(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function FJ(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function VJ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function WJ(t,e){AF(t,e),e.add(t)}function Nb(t,e,n){AF(t,e),e.set(t,n)}function AF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qu(t,e){return t.get(eM(t,e))}function BR(t,e,n){return t.set(eM(t,e),n),n}function eM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dp=new WeakMap,Cg=new WeakMap,yg=new WeakMap,rH=new WeakSet;class HF{constructor(){WJ(this,rH),Nb(this,dp,!0),Nb(this,Cg,null),Nb(this,yg,new ResizeObserver(e=>eM(rH,this,BJ).call(this,e)))}setObservedElement(e){BR(Cg,this,e)}unobserve(){qu(yg,this).unobserve(qu(Cg,this))}observe(){BR(dp,this,!0),qu(yg,this).observe(qu(Cg,this))}destroy(){qu(yg,this).disconnect()}}function BJ(t){if(qu(dp,this)||!Array.isArray(t)||!t.length){BR(dp,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}ut(HF,On);function Ka(t,e,n){jJ(t,e),e.set(t,n)}function jJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(NF(t,e))}function Ko(t,e,n){return t.set(NF(t,e),n),n}function NF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xa=new WeakMap,Db=new WeakMap,Xo=new WeakMap,Ns=new WeakMap,Ds=new WeakMap,bg=new WeakMap,Su=new WeakMap;class Tl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){var r=this;Ka(this,Xa,void 0),Ka(this,Db,!1),Ka(this,Xo,null),Ka(this,Ns,void 0),Ka(this,Ds,void 0),Ka(this,bg,!0),Ka(this,Su,new HF),Ko(Xa,this,e),Ko(Db,this,n),Ko(Ns,this,this.createEditor()),Ko(Ds,this,ht(Ns,this).style),ht(Su,this).setObservedElement(this.getInputElement()),ht(Su,this).addLocalHook("resize",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){ht(Ds,this).left=`${e}px`,ht(Ds,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:Kt(this.getInputElement()),height:en(this.getInputElement())}}observeSize(){ht(Su,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){ht(Ds,this).display="block",Ko(bg,this,!1)}hide(){ht(Su,this).unobserve(),ht(bg,this)||(ht(Ds,this).display="none"),Ko(bg,this,!0)}isVisible(){return ht(Ds,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return ht(Xa,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=ht(Xa,this).createElement("div"),n=ht(Xa,this).createElement("textarea");return e.style.display="none",Ko(Xo,this,ht(Xa,this).createElement("div")),ht(Xo,this).setAttribute("dir",ht(Db,this)?"rtl":"ltr"),q(ht(Xo,this),Tl.CLASS_EDITOR_CONTAINER),ht(Xa,this).body.appendChild(ht(Xo,this)),q(e,Tl.CLASS_EDITOR),q(n,Tl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),ht(Xo,this).appendChild(e),e}getInputElement(){return ht(Ns,this).querySelector(`.${Tl.CLASS_INPUT}`)}getEditorElement(){return ht(Ns,this)}destroy(){const e=ht(Xo,this)?ht(Xo,this).parentNode:null;ht(Ns,this).parentNode.removeChild(ht(Ns,this)),Ko(Ns,this,null),Ko(Ds,this,null),ht(Su,this).destroy(),e&&e.removeChild(ht(Xo,this))}}ut(Tl,On);function kb(t,e,n){return(e=UJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UJ(t){var e=zJ(t,"string");return typeof e=="symbol"?e:e+""}function zJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const YJ=250,GJ=250;class DF{constructor(e){kb(this,"wasLastActionShow",!0),kb(this,"showDebounced",null),kb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},GJ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:YJ;this.showDebounced=ff(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ut(DF,On);function qJ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function KJ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Za(t,e){const n={};return I(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function qs(t,e,n,r,i){I(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&XJ(s,a,e,n,r,i)})})}function XJ(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=qJ(s.className,r):a=KJ(s.className,r)),o(t,e,"className",a)}function kF(t){return`<span class="selected">✓</span>${t}`}function _m(t,e){let n=!1;return Array.isArray(t)&&I(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Mw(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const De="---------";function ZJ(){return{name:De}}const ti="alignment";function QJ(){return{key:ti,name(){return this.getTranslatedPhrase(P_)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${ti}:left`,name(){return this.getTranslatedPhrase(O_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:center`,name(){return this.getTranslatedPhrase(x_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:right`,name(){return this.getTranslatedPhrase(A_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:justify`,name(){return this.getTranslatedPhrase(H_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:De},{key:`${ti}:top`,name(){return this.getTranslatedPhrase(N_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:middle`,name(){return this.getTranslatedPhrase(D_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ti}:bottom`,name(){return this.getTranslatedPhrase(k_)},callback(){const t=this.getSelectedRange(),e=Za(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),qs(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Iw="clear_column";function JJ(){return{key:Iw,name(){return this.getTranslatedPhrase(m_)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Ef="col_left";function eee(){return{key:Ef,name(){return this.getTranslatedPhrase(u_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const _f="col_right";function tee(){return{key:_f,name(){return this.getTranslatedPhrase(c_)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Tf="make_read_only";function nee(){return{key:Tf,checkable:!0,ariaChecked(){return _m(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(tp)},name(){let t=this.getTranslatedPhrase(tp);return _m(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=kF(t)),t},callback(){const t=this.getSelectedRange(),e=_m(t,(n,r)=>this.getCellMeta(n,r).readOnly);I(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Pw="redo";function ree(){return{key:Pw,name(){return this.getTranslatedPhrase(g_)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Mf="remove_col";function iee(){return{key:Mf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(d_,e)},callback(){this.alter("remove_col",W9(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Ow="remove_row";function oee(){return{key:Ow,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(h_,e)},callback(){this.alter("remove_row",B9(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const xw="row_above";function see(){return{key:xw,name(){return this.getTranslatedPhrase(a_)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Aw="row_below";function aee(){return{key:Aw,name(){return this.getTranslatedPhrase(l_)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const jd="no_items";function lee(){return{key:jd,name(){return this.getTranslatedPhrase(s_)},disabled:!0,isCommand:!1}}const Hw="undo";function uee(){return{key:Hw,name(){return this.getTranslatedPhrase(f_)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const cee=[xw,Aw,Ef,_f,Iw,Ow,Mf,Hw,Pw,Tf,ti,De,jd],hee={[De]:ZJ,[jd]:lee,[xw]:see,[Aw]:aee,[Ef]:eee,[_f]:tee,[Iw]:JJ,[Ow]:oee,[Mf]:iee,[Hw]:uee,[Pw]:ree,[Tf]:nee,[ti]:QJ};function LF(){const t={};return Ae(hee,(e,n)=>{t[n]=e()}),t}function dee(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(T_):this.getTranslatedPhrase(__)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fee(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(M_)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function gee(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(I_);return _m(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Tm))?kF(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Tm);t.updateCommentMeta(n,r,{[Tm]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function mee(t,e){$F(t,e),e.add(t)}function Ru(t,e,n){$F(t,e),e.set(t,n)}function $F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pee(t,e,n){return(e=wee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=vee(t,"string");return typeof e=="symbol"?e:e+""}function vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ua(t,e,n){return t.set(dr(t,e),n),n}function Pe(t,e){return t.get(dr(t,e))}function dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fp="comments",Cee=60,as="comment",Qh="value",FF="style",Tm="readOnly",vh=fp,jR=`plugin:${fp}`;var at=new WeakMap,mo=new WeakMap,Nw=new WeakMap,Mm=new WeakMap,UR=new WeakMap,gp=new WeakMap,Mr=new WeakSet;class yee extends Ge{constructor(){super(...arguments),mee(this,Mr),pee(this,"range",{}),Ru(this,at,null),Ru(this,mo,null),Ru(this,Nw,!1),Ru(this,Mm,!1),Ru(this,UR,null),Ru(this,gp,"")}static get PLUGIN_KEY(){return fp}static get PLUGIN_PRIORITY(){return Cee}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[fp]}enablePlugin(){var e=this;this.enabled||(Pe(at,this)||(ua(at,this,new Tl(this.hot.rootDocument,this.hot.isRtl())),Pe(at,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dr(Mr,e,Iee).call(e,...r)})),Pe(mo,this)||ua(mo,this,new DF(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>dr(Mr,this,_ee).call(this,n,a)),this.addHook("afterScroll",()=>dr(Mr,this,Pee).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>dr(Mr,this,iH).call(this,n)),this.addHook("beforeCompositionStart",n=>dr(Mr,this,iH).call(this,n)),this.addHook("afterSetTheme",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dr(Mr,e,Oee).call(e,...r)}),Pe(mo,this).addLocalHook("hide",()=>this.hide()),Pe(mo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Pe(mo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(jR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ua(Mm,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(jR),this.hot._registerTimeout(()=>{ua(Mm,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:vh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Pe(at,this).setValue(Pe(gp,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Pe(at,this).isVisible()&&Pe(at,this).isFocused(),group:vh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Pe(at,this).isVisible()&&Pe(at,this).isFocused(),group:vh}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Pe(at,this).setValue(Pe(at,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:vh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>dr(Mr,this,Ree).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>dr(Mr,this,bee).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>dr(Mr,this,Eee).call(this)),this.eventManager.addEventListener(n,"focus",()=>dr(Mr,this,Mee).call(this)),this.eventManager.addEventListener(n,"blur",()=>dr(Mr,this,Tee).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>dr(Mr,this,See).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ca(e.target,"TD","TBODY");return!!(n&&we(n,"htCommentCell")&&Ca(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Pe(at,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Qh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,as),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Qh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Qh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Pe(mo,this).cancelHiding(),Pe(at,this).setValue((e=i[as]?i[as][Qh]:null)!==null&&e!==void 0?e:""),Pe(at,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Pe(at,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Pe(at,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;Pe(at,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:s,col:a},!0),C=this.getCommentMeta(i,o,FF);C?Pe(at,this).setSize(C.width,C.height):Pe(at,this).resetSize();const y=c?0:f.getColumnWidth(a),E=l&&!u?en(g):0,{left:p,top:_,width:P,height:D}=g.getBoundingClientRect(),{width:M,height:x}=Pe(at,this).getSize(),{innerWidth:Y,innerHeight:U}=this.hot.rootWindow,B=this.hot.rootDocument.documentElement,Z=yn(this.hot.rootDocument),Q=v0(this.hot.rootWindow)?Z:0,se=C0(this.hot.rootWindow)?Z:0;let te=p+h.scrollX+y,le=_+h.scrollY+E;this.hot.isRtl()&&(te-=M+y),this.hot.isLtr()&&p+P+M>Y-Q?te=p+h.scrollX-M-1:this.hot.isRtl()&&te<-(B.scrollWidth-B.clientWidth)&&(te=p+h.scrollX+y+1),_+x>U-se&&(le-=x-D+1),Pe(at,this).setPosition(te,le),Pe(at,this).setReadOnlyState(this.getCommentMeta(i,o,Tm)),Pe(at,this).observeSize()}focusEditor(){Pe(at,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[as];let o;i?(o=jn(i),gf(o,r)):o=r,this.hot.setCellMeta(e,n,as,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[as])return i[as][r]}addToContextMenu(e){e.items.push({name:De},dee(this),fee(this),gee(this))}getEditorInputElement(){return Pe(at,this).getInputElement()}destroy(){var e,n;(e=Pe(at,this))===null||e===void 0||e.destroy(),(n=Pe(mo,this))===null||n===void 0||n.destroy(),super.destroy()}}function bee(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Pe(Nw,this)&&!this.targetIsCommentTextArea(t)){const e=Ca(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function See(t){t.stopPropagation()}function Ree(t){const{rootDocument:e}=this.hot;if(!(Pe(Nw,this)||Pe(at,this).isFocused()||we(t.target,"wtBorder")||Pe(UR,this)===t.target||!Pe(at,this)))if(ua(UR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Pe(mo,this).show(n)}else fa(t.target,e)&&!this.targetIsCommentTextArea(t)&&Pe(mo,this).hide()}function Eee(){ua(Nw,this,!1)}function _ee(t,e){e[as]&&e[as][Qh]&&q(t,e.commentedCellClassName)}function Tee(){ua(gp,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Mee(){ua(gp,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(jR)}function Iee(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[FF]:{width:t,height:e}})}function iH(t){Pe(at,this).isFocused()&&vi(t)}function Pee(){Pe(Mm,this)||this.hide()}function Oee(){const t=Pe(at,this).getEditorElement();pe(t,/ht-theme-.*/g),q(t,this.hot.getCurrentThemeName())}function Lb(t,e,n){return(e=xee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xee(t){var e=Aee(t,"string");return typeof e=="symbol"?e:e+""}function Aee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VF{constructor(e){Lb(this,"hot",void 0),Lb(this,"commands",{}),Lb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Hee(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Jt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),I(u,c=>c.apply(this.hot,r))}}function Hee(t,e){let n;return I(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function $b(t,e,n){return(e=Nee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:e+""}function Dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;$b(this,"hot",void 0),$b(this,"predefinedItems",LF()),$b(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ae(e,(r,i)=>{let o="";r.name===De?(n[De]=r,o=De):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return kee(e,this.defaultOrderPattern,this.predefinedItems)}}function kee(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),xe(i)?Ae(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),xe(o)?tn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):I(i,(o,s)=>{let a=n[o];!a&&cee.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),xe(o)&&tn(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ks(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:e+""}function $ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fee{constructor(e,n){ks(this,"top",void 0),ks(this,"topRelative",void 0),ks(this,"left",void 0),ks(this,"leftRelative",void 0),ks(this,"scrollTop",void 0),ks(this,"scrollLeft",void 0),ks(this,"cellHeight",void 0),ks(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Ch(t,e,n){Vee(t,e),e.set(t,n)}function Vee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(BF(t,e))}function Sg(t,e,n){return t.set(BF(t,e),n),n}function BF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gn=new WeakMap,lr=new WeakMap,ur=new WeakMap,Fb=new WeakMap,Eu=new WeakMap;class Wee{constructor(e){Ch(this,Gn,void 0),Ch(this,lr,void 0),Ch(this,ur,void 0),Ch(this,Fb,!1),Ch(this,Eu,{above:0,below:0,left:0,right:0}),Sg(Fb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ie(Eu,this)[e]=n,this}setElement(e){return Sg(Gn,this,e),this}setParentElement(e){return Sg(lr,this,e),this}updatePosition(e){Sg(ur,this,new Fee(e,Ie(Gn,this).ownerDocument.defaultView)),Ie(Fb,this)?(Ie(ur,this).fitsBelow(Ie(Gn,this))?this.setPositionBelowCursor():Ie(ur,this).fitsAbove(Ie(Gn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ie(Gn,this).dir==="rtl"?Ie(ur,this).fitsOnLeft(Ie(Gn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ie(ur,this).fitsOnRight(Ie(Gn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ie(Eu,this).above+Ie(ur,this).top-Ie(Gn,this).offsetHeight;if(Ie(lr,this)){const r=Ie(lr,this).ownerDocument.defaultView.getComputedStyle(Ie(lr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ie(ur,this).top+Ie(ur,this).cellHeight-Ie(Gn,this).scrollHeight+i+o}Ie(Gn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Ie(Eu,this).below+Ie(ur,this).top+1;if(Ie(lr,this)){const r=Ie(lr,this).ownerDocument.defaultView.getComputedStyle(Ie(lr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=Ie(ur,this).top-i-o-1}Ie(Gn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ie(ur,this).left;if(Ie(lr,this)){const n=Ie(lr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ie(lr,this).querySelector(".htCore")).borderRightWidth,10);e+=Ie(ur,this).cellWidth+r}else e+=Ie(Eu,this).right;Ie(Gn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ie(Eu,this).left+Ie(ur,this).left-Ie(Gn,this).offsetWidth;if(Ie(lr,this)){const n=Ie(lr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(Ie(lr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}Ie(Gn,this).style.left=`${e}px`}}function jF(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ue(e,-1,g()-1);function a(y,E){const p=g()-1;return y<0&&(y=p),y>p&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(E===1?++y:--y,E)),y)}function l(y){y>-1&&y<g()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){g()>0&&(o.clear(),s=a(0,1))}function h(){g()>0&&(o.clear(),s=a(g()-1,-1))}function d(){g()>0&&(o.clear(),s=a(++s,1))}function f(){g()>0&&(o.clear(),s=a(--s,-1))}function g(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:g,clear:C}}function Bee(t){return Be(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function zR(t){return Jt(t,"submenu")}function YR(t){return new RegExp(De,"i").test(t.name)}function Im(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function oH(t){return Jt(t,"disableSelection")}function jee(t){return we(t,"htSeparator")}function Uee(t){return we(t,"htSubmenu")}function zee(t){return we(t,"htDisabled")}function Yee(t){return we(t,"htSelectionDisabled")}function Gee(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function UF(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function qee(t,e){let n=t.slice(0);return n.reverse(),n=UF(n,e),n.reverse(),n}function Kee(t){const e=[];return I(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Xee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:De,n=t.slice(0);return n=UF(n,e),n=qee(n,e),n=Kee(n),n}function Zee(t){return t.checkable===!0}function Qee(t){return jF({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||jee(r)||zee(r)||Yee(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Jee(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const zF="menu",sH=zF;function ete(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Jee(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:zF})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${sH}:${u}`:sH}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function tte(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(xo(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Im(a,t)&&!oH(a)&&!YR(a);ye(n,[...Zee(a)?[P2(),Hd(c),oL(h)]:[I2(),Hd(u)],...d?[Kl(-1)]:[],...Im(a,t)?[k2()]:[],...zR(a)?[li(!1)]:[]])}n.className="",n.appendChild(l),YR(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ql(l,u),Im(a,t)?q(n,"htDisabled"):oH(a)?q(n,"htSelectionDisabled"):zR(a)&&q(n,"htSubmenu")}}function Vb(t,e,n){nte(t,e),e.set(t,n)}function nte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function to(t,e,n){return(e=rte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wb(t,e,n){return t.set(YF(t,e),n),n}function Qa(t,e){return t.get(YF(t,e))}function YF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aH=215;var yh=new WeakMap,Rg=new WeakMap,Eg=new WeakMap;class Lc{get tableBorderWidth(){return Qa(Eg,this)===void 0&&this.hotMenu&&Wb(Eg,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Qa(Eg,this)}constructor(e,n){var r=this;to(this,"hot",void 0),to(this,"options",void 0),to(this,"eventManager",new di(this)),to(this,"container",void 0),to(this,"positioner",void 0),to(this,"hotMenu",null),to(this,"hotSubMenus",{}),to(this,"parentMenu",void 0),to(this,"menuItems",null),to(this,"origOutsideClickDeselects",null),Vb(this,yh,void 0),Vb(this,Rg,void 0),Vb(this,Eg,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:aH,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Wee(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Nl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Qa(yh,this)}getKeyboardShortcutsCtrl(){return Qa(Rg,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=ff(a=>this.openSubMenu(a),300),n=this.options.minWidth||aH;let r=!1,i=va(this.menuItems,a=>(a.key===jd&&(r=!0),Gee(a,this.hot)));if(i.length<1&&!r)i.push(LF()[jd]);else if(i.length===0)return;i=Xee(i,De);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ae(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:tte(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Qa(yh,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),bR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!bR()||!ba(a))&&o&&this.hasSelectedItem()&&(_o()||M0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Wb(yh,this,Qee(this.hotMenu)),Wb(Rg,this,ete(this)),Qa(Rg,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Qa(yh,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ye(r,[li(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Uee(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Lc(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ye(n,[li(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ye(i,[li(!1)])}}closeAllSubMenus(){I(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Bee(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||YR(e)||Im(e,this.hot)||zR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:n}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=n.hider.style,o=n.holder.style,s=parseInt(i.width,10),a=gn(r,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?en(this.hotMenu.getCell(c,0)):0;return l+(u.name===De?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(it(r)&&(r=r.call(this.hot),r===null||Pt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu handsontable ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&ye(this.hotMenu.rootElement,[M2(),Kl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!fa(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!fa(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&fa(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ut(Lc,On);function ote(t,e){ste(t,e),e.add(t)}function ste(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bb(t,e,n){return(e=ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ate(t){var e=lte(t,"string");return typeof e=="symbol"?e:e+""}function lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _g(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jh="contextMenu",ute=70,lH=Jh;ie.getSingleton().register("afterContextMenuDefaultOptions");ie.getSingleton().register("beforeContextMenuShow");ie.getSingleton().register("afterContextMenuShow");ie.getSingleton().register("afterContextMenuHide");ie.getSingleton().register("afterContextMenuExecute");var bh=new WeakSet;class Dw extends Ge{constructor(){super(...arguments),ote(this,bh),Bb(this,"commandExecutor",new VF(this.hot)),Bb(this,"itemsFactory",null),Bb(this,"menu",null)}static get PLUGIN_KEY(){return Jh}static get PLUGIN_PRIORITY(){return ute}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[xw,Aw,De,Ef,_f,De,Ow,Mf,De,Hw,Pw,De,Tf,De,ti]}isEnabled(){return!!this.hot.getSettings()[Jh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Jh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Lc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>_g(bh,this,hte).call(this)),this.menu.addLocalHook("afterOpen",()=>_g(bh,this,dte).call(this)),this.menu.addLocalHook("afterClose",()=>_g(bh,this,fte).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>_g(bh,this,cte).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Mw(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:lH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lH)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Ae(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new WF(this.hot,Dw.DEFAULT_ITEMS);const e=this.hot.getSettings()[Jh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),I(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function cte(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=Mw(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function hte(){this.hot.runHooks("beforeContextMenuShow",this)}function dte(){this.hot.runHooks("afterContextMenuShow",this)}function fte(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Dw.SEPARATOR={name:De};function gte(t){return{key:"copy",name(){return this.getTranslatedPhrase(p_)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function mte(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(C_,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function pte(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(v_,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wte(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(w_,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function vte(t){return{key:"cut",name(){return this.getTranslatedPhrase(y_)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Cte{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class yte{constructor(){this.clipboardData=new Cte}preventDefault(){}composedPath(){return[]}}function bte(t,e){GF(t,e),e.add(t)}function _u(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xn(t,e){return t.get(ec(t,e))}function Tu(t,e,n){return t.set(ec(t,e),n),n}function ec(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ls=new WeakMap,jb=new WeakMap,Sh=new WeakMap,GR=new WeakMap,qR=new WeakMap,Rh=new WeakMap,Eh=new WeakSet;class Ste{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;bte(this,Eh),_u(this,Ls,void 0),_u(this,jb,void 0),_u(this,Sh,void 0),_u(this,GR,void 0),_u(this,qR,void 0),_u(this,Rh,void 0),Tu(jb,this,n),Tu(Sh,this,r),Tu(GR,this,i),Tu(qR,this,o),Tu(Rh,this,s)}setSelectedRange(e){Tu(Ls,this,e)}getCellsRange(){if(Xn(jb,this).call(this)===0||Xn(Sh,this).call(this)===0)return null;const{row:e,col:n}=Xn(Ls,this).getTopStartCorner(),{row:r,col:i}=Xn(Ls,this).getBottomEndCorner(),o=ec(Eh,this,Rte).call(this,e,r),s=ec(Eh,this,Ub).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Xn(Sh,this).call(this)===0||Xn(Rh,this).call(this)===0)return null;const{col:e}=Xn(Ls,this).getTopStartCorner(),{col:n}=Xn(Ls,this).getBottomEndCorner(),r=ec(Eh,this,Ub).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Xn(Sh,this).call(this)===0||Xn(Rh,this).call(this)===0)return null;const{col:e}=Xn(Ls,this).getTopStartCorner(),{col:n}=Xn(Ls,this).getBottomEndCorner(),r=ec(Eh,this,Ub).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Xn(Rh,this).call(this),startCol:e,endRow:-1,endCol:r}}}function Ub(t,e){return Math.min(e,Math.max(t+Xn(qR,this).call(this)-1,t))}function Rte(t,e){return Math.min(e,Math.max(t+Xn(GR,this).call(this)-1,t))}function qF(t){const e=[],n=[];return I(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Ete(t,e){KF(t,e),e.add(t)}function $s(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _h(t,e,n){return(e=_te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _te(t){var e=Tte(t,"string");return typeof e=="symbol"?e:e+""}function Tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wr(t,e){return t.get(Cr(t,e))}function Oi(t,e,n){return t.set(Cr(t,e),n),n}function Cr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterCopyLimit");ie.getSingleton().register("modifyCopyableRange");ie.getSingleton().register("beforeCut");ie.getSingleton().register("afterCut");ie.getSingleton().register("beforePaste");ie.getSingleton().register("afterPaste");ie.getSingleton().register("beforeCopy");ie.getSingleton().register("afterCopy");const zb="copyPaste",Mte=80,Ite=["fragmentSelection"],uH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var KR=new WeakMap,XR=new WeakMap,ZR=new WeakMap,Mu=new WeakMap,Tg=new WeakMap,Mg=new WeakMap,Iu=new WeakMap,mp=new WeakMap,kr=new WeakSet;class Pte extends Ge{constructor(){super(...arguments),Ete(this,kr),_h(this,"columnsLimit",1/0),_h(this,"rowsLimit",1/0),_h(this,"pasteMode","overwrite"),_h(this,"uiContainer",this.hot.rootDocument.body),$s(this,KR,!1),$s(this,XR,!1),$s(this,ZR,!1),$s(this,Mu,"cells-only"),$s(this,Tg,!1),$s(this,Mg,!1),$s(this,Iu,new Ste({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),$s(this,mp,!1),_h(this,"copyableRanges",[])}static get PLUGIN_KEY(){return zb}static get SETTING_KEYS(){return[zb,...Ite]}static get PLUGIN_PRIORITY(){return Mte}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[zb]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Oi(KR,this,this.getSetting("copyColumnHeaders")),Oi(XR,this,this.getSetting("copyColumnGroupHeaders")),Oi(ZR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Cr(kr,this,Ate).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cr(kr,r,Hte).call(r,...o)}),this.addHook("afterSelectionEnd",()=>Cr(kr,this,Nte).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),$d()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cr(kr,r,Dte).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Cr(kr,r,kte).call(r,...o)}),this.addHook("afterSelection",()=>Cr(kr,this,Lte).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Oi(Mu,this,e),Oi(Tg,this,!0),Cr(kr,this,cH).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Oi(Mg,this,!0),Cr(kr,this,cH).call(this,"cut")}getRangedCopyableData(e){return hd(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=qF(e);return I(r,o=>{const s=[];I(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new yte;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}wr(Iu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);wr(Mu,this)==="column-headers-only"?n.set("headers",wr(Iu,this).getMostBottomColumnHeadersRange()):(wr(Mu,this)==="with-column-headers"?n.set("headers",wr(Iu,this).getMostBottomColumnHeadersRange()):wr(Mu,this)==="with-column-group-headers"&&n.set("headers",wr(Iu,this).getAllColumnHeadersRange()),n.set("cells",wr(Iu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:g,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,g===!0)continue;d=C,h=a;const y=[],E=o.length%r;for(;y.length<i||h<=u;){const{skipColumnOnPaste:p,visualCol:_}=this.hot.getCellMeta(s,h);if(h=_+1,p===!0)continue;f=_;const P=y.length%i;y.push(e[E][P])}o.push(y)}return Oi(mp,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!wr(Tg,this)||this.isEditorOpened()||To(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!ad(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Oi(Tg,this,!1);const o=this.getRangedData(this.copyableRanges),s=Cr(kr,this,Ote).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=hd(o);if(e&&e.clipboardData){const u=_R(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[uH,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Oi(Mu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!wr(Mg,this)||this.isEditorOpened()||To(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!ad(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Oi(Mg,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=hd(o);if(e&&e.clipboardData){const l=_R(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[uH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||To(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!ad(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=nw(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=VL(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=G9(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function cH(t){if($d()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&vL(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Ote(t){const{rows:e}=qF(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function xte(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&b0(r)}}}function XF(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&S0(r)}}}function Ate(t){t.items.push({name:"---------"},gte(this)),wr(KR,this)&&t.items.push(wte(this)),wr(XR,this)&&t.items.push(pte(this)),wr(ZR,this)&&t.items.push(mte(this)),t.items.push(vte(this))}function Hte(t,e,n,r,i){wr(mp,this)&&(i.value=!0),Oi(mp,this,!1)}function Nte(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Dte(){Cr(kr,this,XF).call(this)}function kte(){Cr(kr,this,xte).call(this)}function Lte(){Cr(kr,this,XF).call(this)}function ZF(t,e){return`border_row${t}col${e}`}function ed(){return{width:1,color:"#000"}}function ms(){return{hide:!0}}function $te(){return{width:1,color:"#000",cornerVisible:!1}}function Yb(t){if(ae(t.start)||ae(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ae(t.end)||ae(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Th(t){return ae(t.start)&&(t.left=t.start),ae(t.end)&&(t.right=t.end),t}function Gb(t,e){return{id:ZF(t,e),border:$te(),row:t,col:e,top:ms(),bottom:ms(),start:ms(),end:ms()}}function Fte(t,e){return Jt(e,"border")&&e.border&&(t.border=e.border),Jt(e,"top")&&ae(e.top)&&(e.top?(xe(e.top)||(e.top=ed()),t.top=e.top):(e.top=ms(),t.top=e.top)),Jt(e,"bottom")&&ae(e.bottom)&&(e.bottom?(xe(e.bottom)||(e.bottom=ed()),t.bottom=e.bottom):(e.bottom=ms(),t.bottom=e.bottom)),Jt(e,"start")&&ae(e.start)&&(e.start?(xe(e.start)||(e.start=ed()),t.start=e.start):(e.start=ms(),t.start=e.start)),Jt(e,"end")&&ae(e.end)&&(e.end?(xe(e.end)||(e.end=ed()),t.end=e.end):(e.end=ms(),t.end=e.end)),t}function Es(t,e){let n=!1;return I(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Jt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function kw(t){return`<span class="selected">✓</span>${t}`}function Vte(t){return t.some(e=>ae(e.left)||ae(e.right))}function Wte(t){return t.some(e=>ae(e.start)||ae(e.end))}const Bte=new Map([["left","start"],["right","end"]]);function jte(t){var e;return(e=Bte.get(t))!==null&&e!==void 0?e:t}function Ute(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(V_);return Es(this,"bottom")&&(e=kw(e)),e},callback(e,n){const r=Es(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function zte(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(W_);return Es(this,e)&&(n=kw(n)),n},callback(n,r){const i=Es(this,e);t.prepareBorder(r,e,i)}}}function Yte(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(B_)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Es(this)}}}function Gte(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(F_);return Es(this,e)&&(n=kw(n)),n},callback(n,r){const i=Es(this,e);t.prepareBorder(r,e,i)}}}function qte(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase($_);return Es(this,"top")&&(e=kw(e)),e},callback(e,n){const r=Es(this,"top");t.prepareBorder(n,"top",r)}}}function Kte(t,e){Xte(t,e),e.add(t)}function Xte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zte(t,e,n){return(e=Qte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qte(t){var e=Jte(t,"string");return typeof e=="symbol"?e:e+""}function Jte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pm="customBorders",ene=90;var qb=new WeakSet;class tne extends Ge{constructor(){super(...arguments),Kte(this,qb),Zte(this,"savedBorders",[])}static get PLUGIN_KEY(){return Pm}static get PLUGIN_PRIORITY(){return ene}isEnabled(){return!!this.hot.getSettings()[Pm]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>hH(qb,this,nne).call(this,e)),this.addHook("init",()=>hH(qb,this,rne).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Yb(n));const o=mc(e),s=Wd(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});I(e,a=>{s(a).forAll((l,u)=>{I(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,jte(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=mc(e),r=Wd(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return I(e,o=>{r(o).forAll((s,a)=>{I(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Th(l))})})}),i}clearBorders(e){e?this.setBorders(e):(I(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Gb(e,n);r&&(a=Fte(a,r),I(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Th(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=Gb(o,s);let l=0;o===e.from.row&&Jt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Jt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Jt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Jt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Th(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=ZF(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Gb(e,n):o=Yb(o),i?(o[r]=ms(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Th(o)))):(o[r]=ed(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Th(o)))}prepareBorder(e,n,r){I(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){I(e,n=>{const r=Yb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return gn([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Be(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){I(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){I(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Be(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):I(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return I(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return I(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):I(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);I(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Pm];if(Array.isArray(e)){const n=jn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=Vte(e),r=Wte(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function nne(t){this.hot.getSettings()[Pm]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(L_)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[qte(this),Gte(this),Ute(this),zte(this),Yte(this)]}})}function rne(){this.changeBorderSettings()}function ine(t,e){one(t,e),e.add(t)}function one(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kb(t,e,n){return(e=sne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:e+""}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fH="dragToScroll",lne=100;var Xb=new WeakSet;class une extends Ge{constructor(){super(...arguments),ine(this,Xb),Kb(this,"boundaries",null),Kb(this,"callback",null),Kb(this,"listening",!1)}static get PLUGIN_KEY(){return fH}static get PLUGIN_PRIORITY(){return lne}isEnabled(){return!!this.hot.getSettings()[fH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>dH(Xb,this,gH).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>dH(Xb,this,gH).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Nl(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function gH(t){if(ba(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function cne(t,e){QF(t,e),e.add(t)}function hne(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zb(t,e,n){return(e=dne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dne(t){var e=fne(t,"string");return typeof e=="symbol"?e:e+""}function fne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gne(t,e){return t.get(ni(t,e))}function JF(t,e,n){return t.set(ni(t,e),n),n}function ni(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterDropdownMenuDefaultOptions");ie.getSingleton().register("beforeDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuHide");ie.getSingleton().register("afterDropdownMenuExecute");const Om="dropdownMenu",mne=230,Ud="changeType",Qb=Om;var Lw=new WeakMap,Hi=new WeakSet;class $w extends Ge{static get PLUGIN_KEY(){return Om}static get PLUGIN_PRIORITY(){return mne}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ef,_f,De,Mf,De,Iw,De,Tf,De,ti]}constructor(e){super(e),cne(this,Hi),Zb(this,"commandExecutor",new VF(this.hot)),Zb(this,"itemsFactory",null),Zb(this,"menu",null),hne(this,Lw,!1),this.hot.addHook("afterGetColHeader",(n,r)=>ni(Hi,this,wne).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Om]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new WF(this.hot,$w.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ni(Hi,e,Rne).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ni(Hi,e,Sne).call(e,...o)});const n=this.hot.getSettings()[Om],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Lc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>ni(Hi,this,vne).call(this)),this.menu.addLocalHook("afterOpen",()=>ni(Hi,this,Cne).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ni(Hi,this,yne).call(this,o)),this.menu.addLocalHook("afterClose",()=>ni(Hi,this,bne).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),I(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Mw(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${Ud}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Qb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Qb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Qb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ni(Hi,this,pne).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ae(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function eV(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function pne(t){if(we(t.target,Ud)){const e=Mw(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),JF(Lw,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function wne(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Ud}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Ud,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ye(s,[Xl(),Hd(" ")]),ye(e,[nL("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function vne(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Cne(){this.hot.runHooks("afterDropdownMenuShow",this),ni(Hi,this,eV).call(this,this.menu)}function yne(t){ni(Hi,this,eV).call(this,t)}function bne(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Sne(t){return gne(Lw,this)?null:t}function Rne(t){we(t.target,Ud)&&JF(Lw,this,!0)}$w.SEPARATOR={name:De};function mH(t,e,n){return(e=Ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ene(t){var e=_ne(t,"string");return typeof e=="symbol"?e:e+""}function _ne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tne{constructor(e){mH(this,"hot",void 0),mH(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function pH(t,e,n){return(e=Mne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mne(t){var e=Ine(t,"string");return typeof e=="symbol"?e:e+""}function Ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){pH(this,"dataProvider",void 0),pH(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Ui(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=tn(Ui(tM.DEFAULT_OPTIONS),n),n=tn(n,e),n.filename=c0(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function Pne(t,e){One(t,e),e.add(t)}function One(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tV="\r",xne='"',Ane=`
`,Hne="=",Nne="+",Dne="-",kne="@",Lne="	";var Jb=new WeakSet;class $ne extends tM{constructor(){super(...arguments),Pne(this,Jb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Be(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),I(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=yt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=wH(Jb,this,Vne).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=wH(Jb,this,Fne).call(this,i)),(n||i.indexOf(tV)>=0||i.indexOf(xne)>=0||i.indexOf(Ane)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Fne(t){return t.startsWith(Hne)||t.startsWith(Nne)||t.startsWith(Dne)||t.startsWith(kne)||t.startsWith(Lne)||t.startsWith(tV)?`'${t}`:t}function Vne(t,e){return e.test(t)?`'${t}`:t}const Wne="csv",QR={[Wne]:$ne};function Bne(t,e,n){return typeof QR[t]=="function"?new QR[t](e,n):null}const jne="exportFile",Une=240;class zne extends Ge{static get PLUGIN_KEY(){return jne}static get PLUGIN_PRIORITY(){return Une}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QR[e])throw new Error(`Export format type "${e}" is not supported.`);return Bne(e,new Tne(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Pu(t,e,n){return(e=Yne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yne(t){var e=Gne(t,"string");return typeof e=="symbol"?e:e+""}function Gne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class If{constructor(e,n){let{id:r,stateless:i=!0}=n;Pu(this,"hot",void 0),Pu(this,"id",void 0),Pu(this,"elements",[]),Pu(this,"hidden",!1),Pu(this,"stateId",""),Pu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new ww)}getElements(){return this.elements}reset(){I(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ut(If,On);const zd={};function Sa(t,e){if(!zd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=zd[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Ml(t){if(!zd[t])throw Error(`Filter condition "${t}" does not exist.`);return zd[t].descriptor}function on(t,e,n){n.key=t,zd[t]={condition:e,descriptor:n}}const En="none";function qne(){return!0}on(En,qne,{name:vw,inputsCount:0,showOperators:!1});const gd="empty";function Kne(t){return Wt(t.value)}on(gd,Kne,{name:K_,inputsCount:0,showOperators:!0});const xm="not_empty";function Xne(t,e){return!Sa(gd,e)(t)}on(xm,Xne,{name:X_,inputsCount:0,showOperators:!0});const md="eq";function Zne(t,e){let[n]=e;return yt(t.value).toLocaleLowerCase(t.meta.locale)===yt(n)}on(md,Zne,{name:Z_,inputsCount:1,showOperators:!0});const Am="neq";function Qne(t,e){return!Sa(md,e)(t)}on(Am,Qne,{name:Q_,inputsCount:1,showOperators:!0});const nV="gt";function Jne(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}on(nV,Jne,{name:rT,inputsCount:1,showOperators:!0});const rV="gte";function ere(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}on(rV,ere,{name:iT,inputsCount:1,showOperators:!0});const iV="lt";function tre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}on(iV,tre,{name:oT,inputsCount:1,showOperators:!0});const oV="lte";function nre(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}on(oV,nre,{name:sT,inputsCount:1,showOperators:!0});const nM="date_after";function rre(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}on(nM,rre,{name:uT,inputsCount:1,showOperators:!0});const rM="date_before";function ire(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}on(rM,ire,{name:cT,inputsCount:1,showOperators:!0});const pp="between";function ore(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Sa(rM,[o]),a=Sa(nM,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}on(pp,ore,{name:aT,inputsCount:2,showOperators:!0});const sV="not_between";function sre(t,e){return!Sa(pp,e)(t)}on(sV,sre,{name:lT,inputsCount:2,showOperators:!0});const aV="begins_with";function are(t,e){let[n]=e;return yt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(yt(n))}on(aV,are,{name:J_,inputsCount:1,showOperators:!0});const lV="ends_with";function lre(t,e){let[n]=e;return yt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(yt(n))}on(lV,lre,{name:eT,inputsCount:1,showOperators:!0});const iM="contains";function ure(t,e){let[n]=e;return yt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(yt(n))>=0}on(iM,ure,{name:tT,inputsCount:1,showOperators:!0});const uV="not_contains";function cre(t,e){return!Sa(iM,e)(t)}on(uV,cre,{name:nT,inputsCount:1,showOperators:!0});const cV="date_tomorrow";function hre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(-1,"days").startOf("day"),"d"):!1}on(cV,hre,{name:dT,inputsCount:0});const hV="date_today";function dre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().startOf("day"),"d"):!1}on(hV,dre,{name:hT,inputsCount:0});const dV="date_yesterday";function fre(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(1,"days").startOf("day"),"d"):!1}on(dV,fre,{name:fT,inputsCount:0});EL();function gre(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Pf(t){const e=new Set(t);return function(n){return e.has(n)}}function oM(t){return t??""}function JR(t){return Array.from(new Set(t)).map(e=>oM(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function vH(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Pf(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:gre(a,n)};r&&r(u),i.push(u)}),i}const Il="by_value";function mre(t,e){let[n]=e;return n(t.value)}on(Il,mre,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Pf(e)]},showOperators:!1});const Yd={};function pre(t){if(!Yd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Yd[t].func;return function(n,r){return e(n,r)}}function wre(t){return Yd[t].name}function sM(t,e,n){Yd[t]={name:e,func:n}}const ma="conjunction",vre=pT;function Cre(t,e){return t.every(n=>n.func(e))}sM(ma,vre,Cre);const wp="disjunction",yre=Cw;function bre(t,e){return t.some(n=>n.func(e))}sM(wp,yre,bre);const aM="disjunctionWithExtraCondition",Sre=Cw;function Rre(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}sM(aM,Sre,Rre);const Ere="numeric",fV="text",_re="date",CH={[Ere]:[En,De,gd,xm,De,md,Am,De,nV,rV,iV,oV,pp,sV],[fV]:[En,De,gd,xm,De,md,Am,De,aV,lV,De,iM,uV],[_re]:[En,De,gd,xm,De,md,Am,De,rM,nM,pp,De,cV,hV,dV]};function Tre(t){const e=[];let n=t;return CH[n]||(n=fV),I(CH[n],r=>{let i;r===De?i={name:De}:i=Ui(Ml(r)),e.push(i)}),e}function Mh(t,e,n){return(e=Mre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mre(t){var e=Ire(t,"string");return typeof e=="symbol"?e:e+""}function Ire(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eS="built",tS="building",yH=["click","input","keydown","keypress","keyup","focus","blur","change"];let Wi=class gV{static get DEFAULTS(){return Ui({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Mh(this,"hot",void 0),Mh(this,"eventManager",new di(this)),Mh(this,"options",void 0),Mh(this,"_element",void 0),Mh(this,"buildState",void 0),this.hot=e,this.options=tn(gV.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===tS?this._element:this.buildState===eS?(this.update(),this._element):(this.buildState=tS,this.build(),this.buildState=eS,this._element)}isBuilt(){return this.buildState===eS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(rr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=tS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)I(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ae(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),I(yH,r=>e(n,r))}else I(yH,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ut(Wi,On);function Pre(t,e){mV(t,e),e.add(t)}function Ore(t,e,n){mV(t,e),e.set(t,n)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ig(t,e){return t.get(lM(t,e))}function xre(t,e,n){return t.set(lM(t,e),n),n}function lM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ou=new WeakMap,bH=new WeakSet;class pa extends Wi{static get DEFAULTS(){return Ui({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,tn(pa.DEFAULTS,n)),Pre(this,bH),Ore(this,Ou,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>lM(bH,this,Are).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");xre(Ou,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ig(Ou,this).type=this.options.type,Ig(Ou,this).placeholder=this.translateIfPossible(this.options.placeholder),Ig(Ou,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Ig(Ou,this).focus()}}function Are(t){this.options.value=t.target.value}function Hre(t,e){pV(t,e),e.add(t)}function Ih(t,e,n){pV(t,e),e.set(t,n)}function pV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xu(t,e,n){return t.set(pd(t,e),n),n}function Nt(t,e){return t.get(pd(t,e))}function pd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pn=new WeakMap,Pg=new WeakMap,Og=new WeakMap,nS=new WeakMap,xg=new WeakMap,Ag=new WeakSet;class Gd extends Wi{static get DEFAULTS(){return Ui({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,tn(Gd.DEFAULTS,n)),Hre(this,Ag),Ih(this,pn,null),Ih(this,Pg,[]),Ih(this,Og,void 0),Ih(this,nS,void 0),Ih(this,xg,void 0),this.registerHooks()}getMenu(){return Nt(pn,this)}registerHooks(){this.addLocalHook("click",()=>pd(Ag,this,kre).call(this))}setItems(e){xu(Pg,this,this.translateNames(e)),Nt(pn,this)&&Nt(pn,this).setMenuItems(Nt(Pg,this))}translateNames(e){return I(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),xu(pn,this,new Lc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Nt(pn,this).setMenuItems(Nt(Pg,this));const e=new Wi(this.hot,{className:"htUISelectCaption"}),n=new Wi(this.hot,{className:"htUISelectDropdown"});xu(Og,this,e),xu(nS,this,e.element),xu(xg,this,n),this.hot.getSettings().ariaTags&&(ye(n.element,[Xl()]),ye(this._element,[tL()])),I([e,n],r=>this._element.appendChild(r.element)),Nt(pn,this).addLocalHook("select",r=>pd(Ag,this,Nre).call(this,r)),Nt(pn,this).addLocalHook("afterClose",()=>pd(Ag,this,Dre).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Nt(pn,this).hot.getTranslatedPhrase(vw),Nt(nS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Nt(pn,this)&&(Nt(pn,this).open(),Nt(pn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Nt(pn,this).getNavigator().toFirstItem(),Nt(pn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Nt(pn,this)&&Nt(pn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Nt(pn,this)&&(Nt(pn,this).destroy(),xu(pn,this,null)),Nt(Og,this)&&Nt(Og,this).destroy(),Nt(xg,this)&&Nt(xg,this).destroy(),super.destroy()}}function Nre(t){t.name!==De&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Dre(){this.runLocalHooks("afterClose")}function kre(){this.openOptions()}function Lre(t,e){$re(t,e),e.add(t)}function $re(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SH(t,e,n){return(e=Fre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fre(t){var e=Vre(t,"string");return typeof e=="symbol"?e:e+""}function Vre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RH(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rS=new WeakSet;class eE extends If{constructor(e,n){super(e,{id:n.id,stateless:!1}),Lre(this,rS),SH(this,"name",""),SH(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Gd(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new pa(this.hot,{placeholder:ST})),this.elements.push(new pa(this.hot,{placeholder:RT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>RH(rS,this,Wre).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),I(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>RH(rS,this,Bre).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Ui(e.command);n.name.startsWith(Bt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),I(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ml(En),n=[];return I(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Ml(e?e.name:En);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||I(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Gd)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof pa)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||I(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Ml(En)];if(e!==null){const{visualIndex:r}=e;n=Tre(this.hot.getDataType(0,r,this.hot.countRows(),r))}I(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Wre(t){I(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Bre(t){Ac(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),vi(t))}function EH(t,e,n){jre(t,e),e.set(t,n)}function jre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ph(t,e){return t.get(wV(t,e))}function _H(t,e,n){return t.set(wV(t,e),n),n}function wV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Au=new WeakMap,iS=new WeakMap;class vp extends Wi{static get DEFAULTS(){return Ui({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,tn(vp.DEFAULTS,n)),EH(this,Au,void 0),EH(this,iS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_H(iS,this,e),_H(Au,this,this._element.firstChild),Ph(Au,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ph(iS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Ph(Au,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Ph(Au,this).checked=e)}focus(){this.isBuilt()&&Ph(Au,this).focus()}}function Ure(t,e){zre(t,e),e.add(t)}function zre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yre(t,e,n){return(e=Gre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gre(t){var e=qre(t,"string");return typeof e=="symbol"?e:e+""}function qre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kre(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TH=0;var MH=new WeakSet;class Xre extends If{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ure(this,MH),Yre(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),I(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ma,wp];I(e,n=>{const r=new vp(this.hot,{name:"operator",label:{htmlFor:n,textContent:wre(n)},value:n,checked:n===e[TH],id:n});r.addLocalHook("change",i=>Kre(MH,this,Zre).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ot`Radio button with index ${e} doesn't exist.`);I(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof vp&&n.isChecked());return e?e.getValue():ma}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&I(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ma,n=arguments.length>1?arguments[1]:void 0,r=e;r===aM&&(r=wp),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(TH)}}function Zre(t){this.setState(t.target.value)}function Qre(t,e,n){Jre(t,e),e.set(t,n)}function Jre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oS(t,e){return t.get(vV(t,e))}function eie(t,e,n){return t.set(vV(t,e),n),n}function vV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Oh=new WeakMap;class qd extends Wi{static get DEFAULTS(){return Ui({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,tn(qd.DEFAULTS,n)),Qre(this,Oh,void 0)}build(){super.build(),eie(Oh,this,this._element.firstChild)}update(){this.isBuilt()&&(oS(Oh,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&oS(Oh,this).focus()}activate(){oS(Oh,this).click()}}function tie(t,e){CV(t,e),e.add(t)}function Hu(t,e,n){CV(t,e),e.set(t,n)}function CV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Te(t,e){return t.get(tc(t,e))}function Ti(t,e,n){return t.set(tc(t,e),n),n}function tc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IH="multipleSelect.itemBox";var Ni=new WeakMap,Yt=new WeakMap,sS=new WeakMap,Zo=new WeakMap,Fs=new WeakMap,Vs=new WeakMap,xh=new WeakSet;class Kd extends Wi{static get DEFAULTS(){return Ui({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,tn(Kd.DEFAULTS,n)),tie(this,xh),Hu(this,Ni,[]),Hu(this,Yt,void 0),Hu(this,sS,void 0),Hu(this,Zo,void 0),Hu(this,Fs,void 0),Hu(this,Vs,void 0),Ti(Zo,this,new pa(this.hot,{placeholder:bT,className:"htUIMultipleSelectSearch"})),Ti(Fs,this,new qd(this.hot,{textContent:wT,className:"htUISelectAll"})),Ti(Vs,this,new qd(this.hot,{textContent:vT,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Te(Yt,this)}registerHooks(){Te(Zo,this).addLocalHook("keydown",e=>tc(xh,this,rie).call(this,e)),Te(Zo,this).addLocalHook("input",e=>tc(xh,this,nie).call(this,e)),Te(Fs,this).addLocalHook("click",e=>tc(xh,this,iie).call(this,e)),Te(Vs,this).addLocalHook("click",e=>tc(xh,this,oie).call(this,e))}setItems(e){var n;Ti(Ni,this,e),(n=Te(Yt,this))===null||n===void 0||n.loadData(Te(Ni,this))}setLocale(e){Ti(sS,this,e)}getLocale(){return Te(sS,this)}getItems(){return[...Te(Ni,this)]}getValue(){return aie(Te(Ni,this))}getSearchInputElement(){return Te(Zo,this)}getSelectAllElement(){return Te(Fs,this)}getClearAllElement(){return Te(Vs,this)}isSelectedAllValues(){return Te(Ni,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Wi(this.hot,{className:"htUISelectionControls",children:[Te(Fs,this),Te(Vs,this)]});this._element.appendChild(Te(Zo,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Te(Yt,this))===null||s===void 0||s.destroy(),q(o,"htUIMultipleSelectHot"),Ti(Yt,this,new this.hot.constructor(o,{data:Te(Ni,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,g)=>{u.title=g.instance.getDataAtRowProp(c,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Te(Yt,this).listen()},modifyColWidth:u=>{const c=Te(Yt,this).container.scrollWidth-yn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Te(Yt,this).init(),this.hot.addHook("afterSetTheme",(u,c)=>{c||Te(Yt,this).useTheme(u)});const l=Te(Yt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:IH}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Te(Yt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:IH})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Te(Yt,this).listen()}reset(){Te(Zo,this).reset(),Te(Fs,this).reset(),Te(Vs,this).reset()}update(){this.isBuilt()&&(Te(Yt,this).loadData(sie(Te(Ni,this),this.options.value)),super.update())}destroy(){var e;(e=Te(Yt,this))===null||e===void 0||e.destroy(),Te(Zo,this).destroy(),Te(Vs,this).destroy(),Te(Fs,this).destroy(),Ti(Zo,this,null),Ti(Vs,this,null),Ti(Fs,this,null),Ti(Yt,this,null),Ti(Ni,this,null),super.destroy()}}function nie(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Te(Ni,this)]:n=Te(Ni,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Te(Yt,this).loadData(n)}function rie(t){this.runLocalHooks("keydown",t,this),R0(Ac,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),vi(t),Te(Yt,this).listen(),Te(Yt,this).selectCell(0,0))}function iie(t){const e=[];t.preventDefault(),Te(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(Q0(n,r)[0])}),Te(Yt,this).setSourceDataAtCell(e)}function oie(t){const e=[];t.preventDefault(),Te(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(Q0(n,r)[0])}),Te(Yt,this).setSourceDataAtCell(e)}function sie(t,e){const n=Pf(e);return t.map(r=>(r.checked=n(r.value),r))}function aie(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function lie(t,e){uie(t,e),e.add(t)}function uie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cie(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=die(t,"string");return typeof e=="symbol"?e:e+""}function die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ah=new WeakSet;class fie extends If{constructor(e,n){super(e,{id:n.id,stateless:!1}),lie(this,Ah),cie(this,"name",""),this.name=n.name,this.elements.push(new Kd(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Hg(Ah,this,gie).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Hg(Ah,this,mie).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Il){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?En:Il},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=va(i,h=>h.name===Il),u={},c=this.hot.getTranslatedPhrase(np);if(l){const h=s(r,a),d=Be(h,p=>p.value),f=new Map(h.map(p=>[p.value,this.hot.getCellMeta(p.meta.visualRow,p.meta.visualCol)])),g=JR(d);o&&(l.args[0]=o);const C=[],y=vH(g,l.args[0],c,p=>{p.checked&&C.push(p.value),Hg(Ah,this,PH).call(this,p,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[C],u.command=Ml(Il),u.itemsSnapshot=y}else u.args=[],u.command=Ml(En);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Kd)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||I(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(np),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=JR(r),s=vH(o,o,e,l=>{Hg(Ah,this,PH).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Be(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:oM(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function gie(t){Ac(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),vi(t))}function PH(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function mie(t,e){switch(e.type){case"numeric":return aF(t,e);default:return t}}var yV;function pie(t,e){wie(t,e),e.add(t)}function wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vie(t,e,n){return(e=Cie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cie(t){var e=yie(t,"string");return typeof e=="symbol"?e:e+""}function yie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bie(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OH=new WeakSet;class Xd extends If{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),pie(this,OH),vie(this,"name",""),this.name=n.name,this.elements.push(new pa(this.hot,{type:"button",value:CT,className:"htUIButton htUIButtonOK",identifier:Xd.BUTTON_OK})),this.elements.push(new pa(this.hot,{type:"button",value:yT,className:"htUIButton htUIButtonCancel",identifier:Xd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){I(this.elements,e=>{e.addLocalHook("click",(n,r)=>bie(OH,this,Sie).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),I(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}yV=Xd;function Sie(t,e){e.options.identifier===yV.BUTTON_OK?this.accept():this.cancel()}function aS(t,e,n){return(e=Rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rie(t){var e=Eie(t,"string");return typeof e=="symbol"?e:e+""}function Eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xH="ConditionCollection.filteringStates";class uM{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;aS(this,"hot",void 0),aS(this,"isMapRegistrable",void 0),aS(this,"filteringStates",new ww),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(xH,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ma;return e.length?pre(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ma,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ot`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Pt(Yd[r]))throw new Error(ot`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Sa(a,s)}]},i):u.push({name:a,args:s,func:Sa(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(xH),this.filteringStates=null,this.clearLocalHooks()}}ut(uM,On);function AH(t,e,n){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Tie(t,"string");return typeof e=="symbol"?e:e+""}function Tie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];AH(this,"conditionCollection",void 0),AH(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return I(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return I(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return I(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function Mie(t,e){Iie(t,e),e.add(t)}function Iie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ja(t,e,n){return(e=Pie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pie(t){var e=Oie(t,"string");return typeof e=="symbol"?e:e+""}function Oie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ng=new WeakSet;class SV{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Mie(this,Ng),Ja(this,"hot",void 0),Ja(this,"conditionCollection",void 0),Ja(this,"columnDataFactory",void 0),Ja(this,"changes",[]),Ja(this,"grouping",!1),Ja(this,"latestEditedColumnPosition",-1),Ja(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>lS(Ng,this,xie).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>lS(Ng,this,Aie).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>lS(Ng,this,Hie).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,I(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=yL(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new uM(r.hot,!1),g=[].concat(c,d);f.importAllConditions(g);const C=r.columnDataFactory(h);let y;f.isEmpty()?y=C:y=new bV(f,p=>r.columnDataFactory(p)).filter(),y=Be(y,p=>p.meta.visualRow);const E=Pf(y);return f.destroy(),va(C,p=>E(p.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ae(this,(e,n)=>{this[n]=null})}}function xie(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Aie(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Hie(){I(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ut(SV,On);function Nie(t){return jF({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Kd)return r;if(i.element&&!Dl(i.element))return!1;i.focus()}})}const Hh="filters";function Die(t,e){let n=-1,r;const i=Nie(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(Hh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Wi&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Hh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Hh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const C=r.getNavigator();C.getCurrentPage()>-1&&(n=C.getCurrentPage()),C.clear(),g.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const C=e[i.getCurrentPage()];C instanceof Gd&&(C.openOptions(),g.preventDefault()),C instanceof qd&&(C.activate(),g.preventDefault()),C instanceof Wi||g.preventDefault()}}],Hh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(Hh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function kie(t,e){RV(t,e),e.add(t)}function uS(t,e,n){RV(t,e),e.set(t,n)}function RV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nh(t,e,n){return(e=Lie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lie(t){var e=$ie(t,"string");return typeof e=="symbol"?e:e+""}function $ie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hm(t,e,n){return t.set(fr(t,e),n),n}function ri(t,e){return t.get(fr(t,e))}function fr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tE="filters",Fie=250,HH=tE;var rs=new WeakMap,nE=new WeakMap,Sl=new WeakMap,Ir=new WeakSet;class Vie extends Ge{static get PLUGIN_KEY(){return tE}static get PLUGIN_PRIORITY(){return Fie}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,kie(this,Ir),Nh(this,"dropdownMenuPlugin",null),Nh(this,"conditionCollection",null),Nh(this,"conditionUpdateObserver",null),Nh(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Nh(this,"filtersRowsMap",null),uS(this,rs,void 0),uS(this,nE,new WeakSet),uS(this,Sl,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return fr(Ir,n,Gie).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[tE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Cf),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootDocument.body,i=a=>(a.addLocalHook("accept",()=>fr(Ir,this,NH).call(this,"accept")),a.addLocalHook("cancel",()=>fr(Ir,this,NH).call(this,"cancel")),a.addLocalHook("change",l=>fr(Ir,this,Yie).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(gT)}:`,s=()=>`${this.hot.getTranslatedPhrase(mT)}:`;if(!this.components.get("filter_by_condition")){const a=new eE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>fr(Ir,this,DH).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Xre(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new eE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>fr(Ir,this,DH).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new fie(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new Xd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new uM(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new SV(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>fr(Ir,this,qie).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return fr(Ir,e,zie).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>fr(Ir,this,Uie).call(this)),this.addHook("afterDropdownMenuShow",()=>fr(Ir,this,Bie).call(this)),this.addHook("afterDropdownMenuHide",()=>fr(Ir,this,jie).call(this)),this.addHook("afterChange",a=>fr(Ir,this,Wie).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ri(rs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=ri(rs,this).getMenu(),c=u.getNavigator(),h=ri(rs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Hm(rs,this,Die(this.dropdownMenuPlugin.menu,a));const l=u=>{ri(rs,this).listen(),u.preventDefault(),Ac(u.keyCode,"TAB")&&(u.shiftKey?ri(rs,this).toPreviousItem():ri(rs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:HH})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HH)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ma;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,ri(Sl,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Be(n.filter(),u=>u.meta.visualRow);const l=Pf(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),I(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),Hm(Sl,this,this.exportConditions())}else s!==!1&&!r?(Hm(Sl,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(ri(Sl,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return I(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:g},value:oM(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=JR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===wp&&n.command.key!==En&&r.command.key!==En&&i.command.key!==En?o=aM:i.command.key!==En&&(n.command.key===En||r.command.key===En)&&(o=ma),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new bV(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return I(i,s=>{I(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Wie(t){t&&I(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Bie(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function jie(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Uie(){const t=this.dropdownMenuPlugin.menu;ri(nE,this).has(t)||ri(rs,this).setMenu(t),ri(nE,this).add(t)}function zie(t){t.items.push({name:De}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function NH(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==En&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==En&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==En&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Yie(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===eE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function DH(){this.setListeningDropdownMenu()}function Gie(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):pe(e,"htFiltersActive")}function qie(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&Hm(Sl,this,ri(Sl,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===Il),s=n.filter(a=>a.name!==Il);if(o.length>=2||s.length>=3)Je(ot`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const EV="internal-use-in-handsontable",rE={licenseKey:EV,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function _V(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Vn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function TV(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Kie(t){var e;const n=t[Vn],r=TV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=_V(t);return{...rE,...r,...i}}function Xie(t){var e;const n=t[Vn],r=TV(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=_V(t);return{...r,...i}}function Zie(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function Fw(){const t="engine_relationship",e=Gi(Vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function cM(){const t="shared_engine_usage",e=Gi(Vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Qie(t){const e=t.getSettings(),n=e[Vn],r=n==null?void 0:n.engine;if(n===!0||Pt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Jie((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Pt(r.hyperformula)){const o=Fw(),s=cM().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:EV}),(r.getConfig().leapYear1900!==rE.leapYear1900||lw(r.getConfig().nullDate,rE.nullDate)===!1)&&Je(ot`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Jie(t,e,n){const r=e[Vn],i=Kie(e),o=Fw(),s=cM();eoe(t,r.functions),toe(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),noe(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function kH(t){var e;const n=Fw(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function LH(t,e){if(t){const n=Fw(),r=n.get(t),i=cM(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function eoe(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Je(s.message)}})}function toe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Je(r.message)}}}function noe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Je(a.message)}}),t.resumeEvaluation())}function roe(t,e){return(Pt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const MV="DD/MM/YYYY";function ioe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function ooe(t){return ioe(t)?t.substr(1):t}function soe(t){return typeof t=="string"&&t.startsWith("=")}function hM(t,e){return typeof t=="string"&&e==="date"}function IV(t,e){return X(t,e,!0).isValid()}function PV(t,e){return X(t,e,!0).format(MV)}function aoe(t,e){return X(t,MV,!0).format(e)}function OV(t,e){const r=new Date(Date.UTC(0,0,t+-1));return X(r).format(e)}function loe(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function uoe(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function coe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function dM(t,e,n){const r=uoe(t,loe(t,e,n));return coe(r)}function el(t,e,n){hoe(t,e),e.set(t,n)}function hoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tt(t,e){return t.get(xV(t,e))}function Ws(t,e,n){return t.set(xV(t,e),n),n}function xV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Dh=new WeakMap,Bs=new WeakMap,Pr=new WeakMap,Dg=new WeakMap,cS=new WeakMap,hS=new WeakMap,kg=new WeakMap;class $H{constructor(e,n,r){el(this,Dh,void 0),el(this,Bs,void 0),el(this,Pr,void 0),el(this,Dg,[]),el(this,cS,[]),el(this,hS,void 0),el(this,kg,[]),Ws(Dh,this,e),Ws(Bs,this,n),Ws(Pr,this,r)}setRemovedHfIndexes(e){return Ws(kg,this,e.map(n=>{const r=Tt(Bs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Tt(kg,this)}getRemovedHfIndexes(){return Tt(kg,this)}getHfIndexFromVisualIndex(e){const n=Tt(Bs,this).getIndexesSequence(),r=Tt(Bs,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Bn(Tt(Dh,this))}s`;Tt(Pr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Tt(Pr,this).getEngine()[r](Tt(Pr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Ws(cS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Ws(hS,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Tt(Pr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=dM(Tt(cS,this),Tt(hS,this),Tt(Bs,this).getNumberOfIndexes());Tt(Pr,this).getSheetId()===null?Tt(Pr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Bn(Tt(Dh,this))}Order`;return n=>{if(Tt(Pr,this).isPerformingUndoRedo())return;const r=Tt(Bs,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=Tt(Dg,this).map(l=>r.indexOf(l)),o=Tt(Pr,this).getEngine().getSheetDimensions(Tt(Pr,this).getSheetId());let s;Tt(Dh,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);Tt(Pr,this).getEngine()[e](Tt(Pr,this).getSheetId(),i)}Ws(Dg,this,r)}}init(){Ws(Dg,this,Tt(Bs,this).getIndexesSequence())}}function tl(t,e,n){doe(t,e),e.set(t,n)}function doe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(t,e){return t.get(AV(t,e))}function nl(t,e,n){return t.set(AV(t,e),n),n}function AV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lg=new WeakMap,$g=new WeakMap,dS=new WeakMap,fS=new WeakMap,gS=new WeakMap,mS=new WeakMap,pS=new WeakMap;class foe{constructor(e,n,r){tl(this,Lg,void 0),tl(this,$g,void 0),tl(this,dS,void 0),tl(this,fS,!1),tl(this,gS,!1),tl(this,mS,null),tl(this,pS,null),nl(Lg,this,new $H("row",e,this)),nl($g,this,new $H("column",n,this)),nl(dS,this,r)}getForAxis(e){return e==="row"?Qo(Lg,this):Qo($g,this)}setPerformUndo(e){nl(fS,this,e)}setPerformRedo(e){nl(gS,this,e)}isPerformingUndoRedo(){return Qo(fS,this)||Qo(gS,this)}getSheetId(){return Qo(pS,this)}getEngine(){return Qo(mS,this)}getPostponeAction(){return Qo(dS,this)}setupSyncEndpoint(e,n){nl(mS,this,e),nl(pS,this,n),Qo(Lg,this).init(),Qo($g,this).init()}}function goe(t,e){HV(t,e),e.add(t)}function rl(t,e,n){return(e=moe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function moe(t){var e=poe(t,"string");return typeof e=="symbol"?e:e+""}function poe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wS(t,e,n){HV(t,e),e.set(t,n)}function HV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ra(t,e,n){return t.set(qe(t,e),n),n}function Al(t,e){return t.get(qe(t,e))}function qe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vn="formulas",woe=["maxRows","maxColumns","language"],voe=260;ie.getSingleton().register("afterNamedExpressionAdded");ie.getSingleton().register("afterNamedExpressionRemoved");ie.getSingleton().register("afterSheetAdded");ie.getSingleton().register("afterSheetRemoved");ie.getSingleton().register("afterSheetRenamed");ie.getSingleton().register("afterFormulasValuesUpdate");const $c=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var _s=new WeakMap,Vw=new WeakMap,kh=new WeakMap,Qe=new WeakSet;class Coe extends Ge{constructor(){var e;super(...arguments),e=this,goe(this,Qe),wS(this,_s,!1),wS(this,Vw,!1),wS(this,kh,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qe(Qe,e,Doe).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qe(Qe,e,koe).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qe(Qe,e,Loe).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qe(Qe,e,$oe).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qe(Qe,e,Foe).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qe(Qe,e,Voe).call(e,...r)}]]),rl(this,"staticRegister",Gi("formulas")),rl(this,"engine",null),rl(this,"sheetId",null),rl(this,"sheetName",null),rl(this,"indexSyncer",null),rl(this,"rowAxisSyncer",null),rl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Vn}static get PLUGIN_PRIORITY(){return voe}static get SETTING_KEYS(){return[Vn,...woe]}isEnabled(){return!!this.hot.getSettings()[Vn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Qie(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Je("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&qe(Qe,this,wd).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,FH).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,VH).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,FH).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,VH).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Roe).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Eoe).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,yoe).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,_oe).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,WH).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,WH).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Toe).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Moe).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Ooe).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,xoe).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Ioe).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Poe).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Aoe).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Hoe).call(n,...i)}),this.indexSyncer=new foe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Soe).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,Noe).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return qe(Qe,n,boe).call(n,...i)}),Al(kh,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Al(kh,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),LH(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Xie(this.hot.getSettings());Zie(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Vn];if(ae(r)&&ae(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Vn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());qe(Qe,this,wd).call(this,o)}}super.updatePlugin(e)}destroy(){Al(kh,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ra(kh,this,null),LH(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ae(n)&&!f$(n))return Je("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Je("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Je(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){P0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}qe(Qe,this,wd).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Bn(Vn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),kH(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ae(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ae(l)===!1||ae(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=kH(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Je(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return hM(r,o.type)&&(IV(r,o.dateFormat)?r=PV(r,o.dateFormat):soe(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function wd(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function yoe(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Fn(s)&&(s=OV(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function boe(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:C}=h.start,{row:y,col:E}=h.end,p=y-g+1,_=E-C+1;for(let P=0;P<f.length;P+=1)for(let D=0;D<f[P].length;D+=1){const M=f[P][D],x=g+P%p,Y=C+D%_,U=this.hot.getCellMeta(x,Y);hM(M,U.type)&&(M.startsWith("'")?f[P][D]=M.slice(1):this.isFormulaCellType(x,Y,this.sheetId)===!1&&(f[P][D]=aoe(M,U.dateFormat)))}return f}function FH(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Bn(Vn))||Ra(Vw,this,Pt(this.hot.getSettings().data))}function Soe(){if(Al(Vw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;hM(i,s.type)&&(IV(i,a)?t[r][o]=PV(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),Ra(_s,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ra(_s,this,!1)}function VH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Bn(Vn)))return;const r=roe(this.engine,this.hot.getSettings()[Vn].sheetName);if(qe(Qe,this,wd).call(this,r),n!=="updateSettings")if(Al(Vw,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Ra(_s,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Ra(_s,this,!1)}}}function Roe(t,e,n,r){if(r!=="get"||Al(_s,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;const o=this.getCellType(i,e);if(o==="VALUE"||o==="EMPTY"){n.value=ooe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e,{skipMetaExtension:!0});l.type==="date"&&Fn(a)&&(a=OV(a,l.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function Eoe(t,e,n,r){if(r!=="get"||Al(_s,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function WH(t,e){if($c(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function _oe(t,e){if($c(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Fn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Je(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Toe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Moe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Ioe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Poe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Ooe(t,e,n){if($c(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function xoe(t,e,n){if($c(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Aoe(t,e,n,r){if($c(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Hoe(t,e,n,r){if($c(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Noe(t,e,n){var r;Ra(_s,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ra(_s,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Doe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function koe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Loe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function $oe(t){this.hot.runHooks("afterSheetAdded",t)}function Foe(t,e){qe(Qe,this,wd).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function Voe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Woe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(z_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Boe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Y_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Be(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return I(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function joe(t,e){NV(t,e),e.add(t)}function Uoe(t,e,n){NV(t,e),e.set(t,n)}function NV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function il(t,e){return t.get(Xs(t,e))}function BH(t,e,n){return t.set(Xs(t,e),n),n}function Xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideColumns");ie.getSingleton().register("afterHideColumns");ie.getSingleton().register("beforeUnhideColumns");ie.getSingleton().register("afterUnhideColumns");const jH="hiddenColumns",zoe=310;var no=new WeakMap,ol=new WeakSet;class Yoe extends Ge{constructor(){super(...arguments),joe(this,ol),Uoe(this,no,null)}static get PLUGIN_KEY(){return jH}static get PLUGIN_PRIORITY(){return zoe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[jH]}enablePlugin(){var e=this;this.enabled||(BH(no,this,new pw),il(no,this).addLocalHook("init",()=>Xs(ol,this,Qoe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,il(no,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xs(ol,e,Zoe).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Xs(ol,this,qoe).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>Xs(ol,this,Goe).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Xs(ol,e,Xoe).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Xs(ol,this,Koe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=il(no,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));I(l,u=>{o[u]=!1}),i=gn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&il(no,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{I(e,s=>{il(no,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Be(il(no,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return il(no,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){BH(no,this,null),super.destroy()}}function Goe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function qoe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Koe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return I(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Xoe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function Zoe(t){t.items.push({name:De},Woe(this),Boe(this))}function Qoe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Joe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(G_,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function ese(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(q_,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Be(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return I(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function tse(t,e){DV(t,e),e.add(t)}function nse(t,e,n){DV(t,e),e.set(t,n)}function DV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sl(t,e){return t.get(Zs(t,e))}function UH(t,e,n){return t.set(Zs(t,e),n),n}function Zs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideRows");ie.getSingleton().register("afterHideRows");ie.getSingleton().register("beforeUnhideRows");ie.getSingleton().register("afterUnhideRows");const zH="hiddenRows",rse=320;var ro=new WeakMap,al=new WeakSet;class ise extends Ge{constructor(){super(...arguments),tse(this,al),nse(this,ro,null)}static get PLUGIN_KEY(){return zH}static get PLUGIN_PRIORITY(){return rse}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[zH]}enablePlugin(){var e=this;this.enabled||(UH(ro,this,new pw),sl(ro,this).addLocalHook("init",()=>Zs(al,this,cse).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,sl(ro,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zs(al,e,use).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Zs(al,this,sse).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Zs(al,this,ose).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Zs(al,e,lse).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Zs(al,this,ase).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=sl(ro,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));I(l,u=>{o[u]=!1}),i=gn(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&sl(ro,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{I(e,s=>{sl(ro,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Be(sl(ro,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return sl(ro,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){UH(ro,this,null),super.destroy()}}function ose(t,e){return this.isHidden(e)?0:t}function sse(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function ase(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return I(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function lse(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function use(t){t.items.push({name:De},Joe(this),ese(this))}function cse(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function hse(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(b_)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function dse(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(S_)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function fse(t,e){kV(t,e),e.add(t)}function gse(t,e,n){kV(t,e),e.set(t,n)}function kV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iE(t,e){return t.get(Cp(t,e))}function vS(t,e,n){return t.set(Cp(t,e),n),n}function Cp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnFreeze");ie.getSingleton().register("afterColumnFreeze");ie.getSingleton().register("beforeColumnUnfreeze");ie.getSingleton().register("afterColumnUnfreeze");const YH="manualColumnFreeze",mse=110;var Cl=new WeakMap,CS=new WeakSet;class pse extends Ge{constructor(){super(...arguments),fse(this,CS),gse(this,Cl,!1)}static get PLUGIN_KEY(){return YH}static get PLUGIN_PRIORITY(){return mse}isEnabled(){return!!this.hot.getSettings()[YH]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Cp(CS,this,wse).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Cp(CS,this,vse).call(this,e,n)),super.enablePlugin())}disablePlugin(){vS(Cl,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;iE(Cl,this)||vS(Cl,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;iE(Cl,this)||vS(Cl,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function wse(t){t.items.push({name:"---------"},hse(this),dse(this))}function vse(t,e){if(iE(Cl,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Fg(t,e,n){return(e=Cse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cse(t){var e=yse(t,"string");return typeof e=="symbol"?e:e+""}function yse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yS=0,GH=1,qH=2,Nu="px";let LV=class{constructor(e){Fg(this,"hot",void 0),Fg(this,"_element",null),Fg(this,"state",yS),Fg(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=qH}build(){this.state===yS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=GH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=yS}isAppended(){return this.state===qH}isBuilt(){return this.state>=GH}setPosition(e,n){Fn(e)&&(this._element.style.top=e+Nu),Fn(n)&&(this._element.style[this.inlineProperty]=n+Nu)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Fn(e)&&(this._element.style.width=e+Nu),Fn(n)&&(this._element.style.height=n+Nu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Fn(e)&&(this._element.style.marginTop=e+Nu),Fn(n)&&(this._element.style[`margin${Bn(this.inlineProperty)}`]=n+Nu)}getOffset(){const e=this._element.style,n=`margin${Bn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const bse="ht__manualColumnMove--backlight";let Sse=class extends LV{build(){super.build(),q(this._element,bse)}};const Rse="ht__manualColumnMove--guideline";let Ese=class extends LV{build(){super.build(),q(this._element,Rse)}};function _se(t,e){$V(t,e),e.add(t)}function Mi(t,e,n){$V(t,e),e.set(t,n)}function $V(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(t,e,n){return t.set(Qs(t,e),n),n}function he(t,e){return t.get(Qs(t,e))}function Qs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnMove");ie.getSingleton().register("afterColumnMove");const bS="manualColumnMove",Tse=120,KH="ht__manualColumnMove",yp="show-ui",oE="on-moving--columns",sE="after-selection--columns";var Jn=new WeakMap,ta=new WeakMap,ps=new WeakMap,Nm=new WeakMap,ca=new WeakMap,Zn=new WeakMap,Vg=new WeakMap,Jr=new WeakMap,Ku=new WeakMap,bp=new WeakMap,vd=new WeakMap,ll=new WeakSet;class Mse extends Ge{constructor(){super(...arguments),_se(this,ll),Mi(this,Jn,new Sse(this.hot)),Mi(this,ta,new Ese(this.hot)),Mi(this,ps,[]),Mi(this,Nm,0),Mi(this,ca,!1),Mi(this,Zn,{}),Mi(this,Vg,void 0),Mi(this,Jr,void 0),Mi(this,Ku,void 0),Mi(this,bp,void 0),Mi(this,vd,void 0)}static get PLUGIN_KEY(){return bS}static get PLUGIN_PRIORITY(){return Tse}isEnabled(){return!!this.hot.getSettings()[bS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Qs(ll,e,Ise).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Qs(ll,e,Ose).call(e,...r)}),this.addHook("afterScrollVertically",()=>Qs(ll,this,Ase).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Qs(ll,e,Hse).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,KH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,KH),this.unregisterEvents(),he(Jn,this).destroy(),he(ta,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(Vg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(yr(Vg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return yr(Vg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=gn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[bS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(Jr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(Jr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(Jn,this).getOffset().start,u=he(Jn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,C=Kt(this.hot.rootElement),y=g.innerWidth-he(Ku,this)-C;h=g.innerWidth-he(Zn,this).eventPageX-y-(r.scrollX===void 0?i:0)}else h=he(Zn,this).eventPageX-(he(Ku,this)-(r.scrollX===void 0?i:0));if(he(bp,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(Jr,this))&&(o+=i),o+=c,he(Jr,this)<0)he(vd,this)>0?he(Zn,this).col=0:he(Zn,this).col=e>0?e-1:e;else if(he(Zn,this).TD.offsetWidth/2+o<=h){const g=he(Jr,this)>=he(Nm,this)?he(Nm,this)-1:he(Jr,this);he(Zn,this).col=g+1,o+=he(Zn,this).TD.offsetWidth}else he(Zn,this).col=he(Jr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(Jr,this)<he(vd,this)&&(f-=he(Ku,this)<=r.scrollX?he(Ku,this):0),he(Jn,this).setPosition(null,d),he(ta,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Qs(ll,this,Pse).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Qs(ll,this,xse).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(Jn,this).build(),he(ta,this).build()}destroy(){he(Jn,this).destroy(),he(ta,this).destroy(),super.destroy()}}function Ise(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=we(t.target,"sortAction");if(!s||!o||he(ca,this)||t.button!==0||a){yr(ca,this,!1),he(ps,this).length=0,pe(this.hot.rootElement,[oE,yp]);return}const l=he(ta,this).isBuilt()&&!he(ta,this).isAppended(),u=he(Jn,this).isBuilt()&&!he(Jn,this).isAppended();l&&u&&(he(ta,this).appendTo(i.hider),he(Jn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,yr(ca,this,!0);const g=n.firstChild?HL(t,n.firstChild).x:t.offsetX;he(Zn,this).eventPageX=t.pageX,yr(Jr,this,e.col),he(Zn,this).TD=n,he(Zn,this).col=e.col,yr(ps,this,this.prepareColumnsToMoving(d,f)),yr(bp,this,!!this.hot.getSettings().rowHeaders),yr(Nm,this,this.hot.countCols()),yr(vd,this,this.hot.getSettings().fixedColumnsStart),yr(Ku,this,Pn(this.hot.rootElement).left);const C=he(bp,this)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(vd,this),p=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),_=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),P=this.getColumnsWidth(d,e.col-1)+_,D=this.getColumnsWidth(C,d-1)+(E?p:0)+P;he(Jn,this).setPosition(y,D),he(Jn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-y),he(Jn,this).setOffset(null,-P),q(this.hot.rootElement,oE)}else pe(this.hot.rootElement,sE),yr(ca,this,!1),he(ps,this).length=0}function Pse(t){he(ca,this)&&(he(Zn,this).eventPageX=t.pageX,this.refreshPositions())}function Ose(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(ca,this)||(he(ps,this).indexOf(e.col)>-1?pe(this.hot.rootElement,yp):q(this.hot.rootElement,yp),r.row=!0,r.column=!0,r.cell=!0,yr(Jr,this,e.col),he(Zn,this).TD=n)}function xse(){const t=he(Zn,this).col,e=he(ps,this).length;if(yr(Jr,this,void 0),yr(ca,this,!1),pe(this.hot.rootElement,[oE,yp,sE]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,sE),e<1||t===void 0)return;const n=he(ps,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(ps,this),t);if(he(ps,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Ase(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(Jn,this).setPosition(r),he(Jn,this).setSize(null,t.hider.offsetHeight-r)}function Hse(){this.moveBySettingsOrLoad()}function Nse(t,e){FV(t,e),e.add(t)}function Nn(t,e,n){FV(t,e),e.set(t,n)}function FV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e,n){return t.set(Di(t,e),n),n}function oe(t,e){return t.get(Di(t,e))}function Di(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sp="manualColumnResize",Dse=130,XH="manualColumnWidths";var ls=new WeakMap,Wg=new WeakMap,$r=new WeakMap,Rp=new WeakMap,Ro=new WeakMap,kse=new WeakMap,cc=new WeakMap,Bg=new WeakMap,hr=new WeakMap,is=new WeakMap,Vl=new WeakMap,Ep=new WeakMap,Cd=new WeakMap,yd=new WeakMap,Vr=new WeakMap,bd=new WeakMap,io=new WeakSet;class Lse extends Ge{static get PLUGIN_KEY(){return Sp}static get PLUGIN_PRIORITY(){return Dse}constructor(e){super(e),Nse(this,io),Nn(this,ls,null),Nn(this,Wg,null),Nn(this,$r,[]),Nn(this,Rp,null),Nn(this,Ro,null),Nn(this,kse,null),Nn(this,cc,null),Nn(this,Bg,null),Nn(this,hr,this.hot.rootDocument.createElement("DIV")),Nn(this,is,this.hot.rootDocument.createElement("DIV")),Nn(this,Vl,null),Nn(this,Ep,!1),Nn(this,Cd,0),Nn(this,yd,null),Nn(this,Vr,void 0),Nn(this,bd,void 0),q(oe(hr,this),"manualColumnResizer"),q(oe(is,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Sp]}enablePlugin(){var e=this;this.enabled||(qt(Vr,this,new Ia),oe(Vr,this).addLocalHook("init",()=>Di(io,this,$se).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,oe(Vr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Di(io,e,Use).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Di(io,e,zse).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Di(io,e,Yse).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){qt(bd,this,oe(Vr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",XH,oe(Vr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",XH,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return oe(Vr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);oe(Vr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;qt(ls,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(oe(ls,this)),i=r.col;if(i<0)return;const o=en(oe(ls,this)),s=oe(ls,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(ls,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(oe(ls,this),r.row,r.col)),qt(Wg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),qt($r,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();I(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,g=>{oe($r,this).includes(g)||oe($r,this).push(g)})})}oe($r,this).includes(oe(Wg,this))||qt($r,this,[oe(Wg,this)]),qt(Bg,this,l.start-6),qt(cc,this,parseInt(s.width,10)),oe(hr,this).style.top=`${l.top}px`,oe(hr,this).style[this.inlineDir]=`${oe(Bg,this)+oe(cc,this)}px`,oe(hr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(oe(hr,this))}refreshHandlePosition(){oe(hr,this).style[this.inlineDir]=`${oe(Bg,this)+oe(Rp,this)}px`}setupGuidePosition(){const e=parseInt(en(oe(hr,this)),10),n=parseInt(oe(hr,this).style.top,10)+e,r=this.hot.view.getTableHeight();q(oe(hr,this),"active"),q(oe(is,this),"active"),oe(is,this).style.top=`${n}px`,this.refreshGuidePosition(),oe(is,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(oe(is,this))}refreshGuidePosition(){oe(is,this).style[this.inlineDir]=oe(hr,this).style[this.inlineDir]}hideHandleAndGuide(){pe(oe(hr,this),"active"),pe(oe(is,this),"active")}checkIfColumnHeader(e){const n=Ca(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",oe(Ro,this),r,!0);o!==void 0&&qt(Ro,this,o),this.setManualSize(r,oe(Ro,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(Ro,this),r,!0),i&&e()};oe(Cd,this)>=2&&(oe($r,this).length>1?(I(oe($r,this),i=>{n(i)}),e()):I(oe($r,this),i=>{n(i,!0)})),qt(Cd,this,0),qt(yd,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Di(io,this,Fse).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Di(io,this,Vse).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Di(io,this,Wse).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Di(io,this,Bse).call(this)),this.eventManager.addEventListener(oe(hr,this),"contextmenu",()=>Di(io,this,jse).call(this))}destroy(){super.destroy()}}function $se(){const t=this.hot.getSettings()[Sp],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{oe(Vr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{oe(Vr,this).setValueAtIndex(r,n)})},!0),qt(bd,this,t)):t===!0&&Array.isArray(oe(bd,this))&&this.hot.batchExecution(()=>{oe(bd,this).forEach((n,r)=>{oe(Vr,this).setValueAtIndex(r,n)})},!0)}function Fse(t){if(!y0(t.target)&&oe(Ep,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(oe(Vl,this)||this.setupHandlePosition(e))}}function Vse(t){t.target.parentNode===this.hot.rootElement&&we(t.target,"manualColumnResizer")&&(this.setupHandlePosition(oe(ls,this)),this.setupGuidePosition(),qt(Vl,this,!0),oe(yd,this)===null&&(qt(yd,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(yd,this))),qt(Cd,this,oe(Cd,this)+1),this.startX=t.pageX,qt(Ro,this,oe(cc,this)))}function Wse(t){if(oe(Vl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();qt(Rp,this,oe(cc,this)+e),I(oe($r,this),n=>{qt(Ro,this,this.setManualSize(n,oe(Rp,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Bse(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",oe(Ro,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",oe(Ro,this),n,!1)};oe(Vl,this)&&(this.hideHandleAndGuide(),qt(Vl,this,!1),oe(Ro,this)!==oe(cc,this)&&(oe($r,this).length>1?(I(oe($r,this),r=>{e(r)}),t()):I(oe($r,this),r=>{e(r,!0)})),this.setupHandlePosition(oe(ls,this)))}function jse(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(hr,this)),this.hot.rootElement.removeChild(oe(is,this)),qt(Vl,this,!1),qt(Ep,this,!0),this.hot._registerImmediate(()=>{qt(Ep,this,!1)})}function Use(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=oe(Vr,this).getValueAtIndex(r);this.hot.getSettings()[Sp]&&i&&(n=i)}return n}function zse(t,e){const n=oe(Vr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function Yse(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function SS(t,e,n){return(e=Gse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gse(t){var e=qse(t,"string");return typeof e=="symbol"?e:e+""}function qse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RS=0,ZH=1,QH=2,Du="px";let VV=class{constructor(e){SS(this,"hot",void 0),SS(this,"_element",null),SS(this,"state",RS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=QH}build(){this.state===RS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ZH)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=RS}isAppended(){return this.state===QH}isBuilt(){return this.state>=ZH}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Du),n!==void 0&&(this._element.style.left=n+Du)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Du),n&&(this._element.style.height=n+Du)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Du),n&&(this._element.style.marginLeft=n+Du)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Kse="ht__manualRowMove--backlight";class Xse extends VV{build(){super.build(),q(this._element,Kse)}}const Zse="ht__manualRowMove--guideline";class Qse extends VV{build(){super.build(),q(this._element,Zse)}}function Jse(t,e){WV(t,e),e.add(t)}function ku(t,e,n){WV(t,e),e.set(t,n)}function WV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pl(t,e,n){return t.set(Js(t,e),n),n}function _e(t,e){return t.get(Js(t,e))}function Js(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeRowMove");ie.getSingleton().register("afterRowMove");const ES="manualRowMove",eae=140,JH="ht__manualRowMove",_p="show-ui",aE="on-moving--rows",lE="after-selection--rows";var er=new WeakMap,na=new WeakMap,ws=new WeakMap,ha=new WeakMap,Sr=new WeakMap,jg=new WeakMap,ul=new WeakSet;class tae extends Ge{constructor(){super(...arguments),Jse(this,ul),ku(this,er,new Xse(this.hot)),ku(this,na,new Qse(this.hot)),ku(this,ws,[]),ku(this,ha,void 0),ku(this,Sr,{}),ku(this,jg,void 0)}static get PLUGIN_KEY(){return ES}static get PLUGIN_PRIORITY(){return eae}isEnabled(){return!!this.hot.getSettings()[ES]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Js(ul,e,nae).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Js(ul,e,iae).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Js(ul,this,sae).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Js(ul,e,aae).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,JH),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,JH),this.unregisterEvents(),_e(er,this).destroy(),_e(na,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=_e(jg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Pl(jg,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Pl(jg,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=gn(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.view.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[ES];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=_e(Sr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=_e(Sr,this).TD,a=this.hot.rootElement,l=Pn(a),u=dc(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=_e(Sr,this).eventPageY-d+c,g=o.hider.offsetHeight,C=o.TBODY.offsetTop,y=_e(er,this).getOffset().top,E=_e(er,this).getSize().height,p=s.offsetHeight/2,_=s.offsetHeight;let P=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const D=f>=P+p;this.isFixedRowTop(e.row)&&(P+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_e(Sr,this).row=n>0?n-1:n:D?(_e(Sr,this).row=e.row+1,P+=e.row===0?_-1:_):_e(Sr,this).row=e.row;let M=f,x=P;f+E+y>=g?M=g-E-y:f+y<C&&(M=C+Math.abs(y)),P>=g-1&&(x=g-1),_e(er,this).setPosition(M),_e(na,this).setPosition(x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Js(ul,this,rae).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Js(ul,this,oae).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_e(er,this).build(),_e(na,this).build()}destroy(){_e(er,this).destroy(),_e(na,this).destroy(),super.destroy()}}function nae(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||_e(ha,this)||t.button!==0){Pl(ha,this,!1),_e(ws,this).length=0,pe(this.hot.rootElement,[aE,_p]);return}const l=_e(na,this).isBuilt()&&!_e(na,this).isAppended(),u=_e(er,this).isBuilt()&&!_e(er,this).isAppended();l&&u&&(_e(na,this).appendTo(i.hider),_e(er,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,Pl(ha,this,!0),_e(Sr,this).eventPageY=t.pageY,_e(Sr,this).coords=e,_e(Sr,this).TD=n,Pl(ws,this,this.prepareRowsToMoving());const g=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);_e(er,this).setPosition(null,g),_e(er,this).setSize(i.hider.offsetWidth-g,this.getRowsHeight(d,f)),_e(er,this).setOffset(-C,null),q(this.hot.rootElement,aE),this.refreshPositions()}else pe(this.hot.rootElement,lE),Pl(ha,this,!1),_e(ws,this).length=0}function rae(t){_e(ha,this)&&(_e(Sr,this).eventPageY=t.pageY,this.refreshPositions())}function iae(t,e,n,r){!this.hot.getSelectedRangeLast()||!_e(ha,this)||(_e(ws,this).indexOf(e.row)>-1?pe(this.hot.rootElement,_p):q(this.hot.rootElement,_p),r.row=!0,r.column=!0,r.cell=!0,_e(Sr,this).coords=e,_e(Sr,this).TD=n)}function oae(){const t=_e(Sr,this).row,e=_e(ws,this).length;if(Pl(ha,this,!1),pe(this.hot.rootElement,[aE,_p,lE]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,lE),e<1||t===void 0)return;const n=_e(ws,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(_e(ws,this),t);if(_e(ws,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function sae(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;_e(er,this).setPosition(null,r),_e(er,this).setSize(t.hider.offsetWidth-r)}function aae(){this.moveBySettingsOrLoad()}function lae(t,e){BV(t,e),e.add(t)}function Dn(t,e,n){BV(t,e),e.set(t,n)}function BV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e,n){return t.set(us(t,e),n),n}function re(t,e){return t.get(us(t,e))}function us(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Tp="manualRowResize",uae=30,eN="manualRowHeights";var po=new WeakMap,Ug=new WeakMap,Fr=new WeakMap,Sd=new WeakMap,ra=new WeakMap,fM=new WeakMap,hc=new WeakMap,zg=new WeakMap,Kn=new WeakMap,fo=new WeakMap,Wl=new WeakMap,Mp=new WeakMap,Rd=new WeakMap,Ed=new WeakMap,$i=new WeakMap,_d=new WeakMap,js=new WeakSet;class cae extends Ge{static get PLUGIN_KEY(){return Tp}static get PLUGIN_PRIORITY(){return uae}constructor(e){super(e),lae(this,js),Dn(this,po,null),Dn(this,Ug,null),Dn(this,Fr,[]),Dn(this,Sd,null),Dn(this,ra,null),Dn(this,fM,null),Dn(this,hc,null),Dn(this,zg,null),Dn(this,Kn,this.hot.rootDocument.createElement("DIV")),Dn(this,fo,this.hot.rootDocument.createElement("DIV")),Dn(this,Wl,!1),Dn(this,Mp,!1),Dn(this,Rd,0),Dn(this,Ed,null),Dn(this,$i,void 0),Dn(this,_d,void 0),q(re(Kn,this),"manualRowResizer"),q(re(fo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Tp]}enablePlugin(){this.enabled||($t($i,this,new Ia),re($i,this).addLocalHook("init",()=>us(js,this,wae).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,re($i,this)),this.addHook("modifyRowHeight",(e,n)=>us(js,this,pae).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){$t(_d,this,re($i,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",eN,re($i,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",eN,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.view.getDefaultRowHeight());return re($i,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return re(Sd,this)}setupHandlePosition(e){$t(po,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(re(po,this)),o=i.row;if(o<0)return;const s=Kt(re(po,this)),a=re(po,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(po,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(re(po,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(re(po,this),i.row,i.col)),$t(Ug,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),$t(Fr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();I(d,f=>{const g=f.getTopStartCorner().row,C=f.getBottomStartCorner().row;fe(g,C,y=>{re(Fr,this).includes(y)||re(Fr,this).push(y)})})}re(Fr,this).includes(re(Ug,this))||$t(Fr,this,[re(Ug,this)]),$t(zg,this,c.top-6),$t(hc,this,parseInt(a.height,10)),re(Kn,this).style.top=`${re(zg,this)+re(hc,this)}px`,re(Kn,this).style[this.inlineDir]=`${c.start}px`,re(Kn,this).style.width=`${s}px`,this.hot.rootElement.appendChild(re(Kn,this))}refreshHandlePosition(){re(Kn,this).style.top=`${re(zg,this)+re(Sd,this)}px`}setupGuidePosition(){const e=parseInt(Kt(re(Kn,this)),10),n=parseInt(re(Kn,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();q(re(Kn,this),"active"),q(re(fo,this),"active"),re(fo,this).style.top=re(Kn,this).style.top,re(fo,this).style[this.inlineDir]=`${n}px`,re(fo,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(re(fo,this))}refreshGuidePosition(){re(fo,this).style.top=re(Kn,this).style.top}hideHandleAndGuide(){pe(re(Kn,this),"active"),pe(re(fo,this),"active")}checkIfRowHeader(e){const n=Ca(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&re(ra,this)<n?n:re(ra,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&$t(ra,this,o),this.setManualSize(r,re(ra,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};re(Rd,this)>=2&&(re(Fr,this).length>1?(I(re(Fr,this),i=>{n(i)}),e()):I(re(Fr,this),i=>{n(i,!0)})),$t(Rd,this,0),$t(Ed,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>us(js,this,hae).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>us(js,this,dae).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>us(js,this,fae).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>us(js,this,gae).call(this)),this.eventManager.addEventListener(re(Kn,this),"contextmenu",()=>us(js,this,mae).call(this))}destroy(){super.destroy()}}function hae(t){if(!y0(t.target)&&re(Mp,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(re(Wl,this)||this.setupHandlePosition(e))}}function dae(t){we(t.target,"manualRowResizer")&&(this.setupHandlePosition(re(po,this)),this.setupGuidePosition(),$t(Wl,this,!0),re(Ed,this)===null&&($t(Ed,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(Ed,this))),$t(Rd,this,re(Rd,this)+1),$t(fM,this,t.pageY),$t(ra,this,re(hc,this)))}function fae(t){re(Wl,this)&&($t(Sd,this,re(hc,this)+(t.pageY-re(fM,this))),I(re(Fr,this),e=>{$t(ra,this,this.setManualSize(e,re(Sd,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function gae(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};re(Wl,this)&&(this.hideHandleAndGuide(),$t(Wl,this,!1),re(ra,this)!==re(hc,this)&&(re(Fr,this).length>1?(I(re(Fr,this),r=>{e(r)}),t()):I(re(Fr,this),r=>{e(r,!0)})),this.setupHandlePosition(re(po,this)))}function mae(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(Kn,this)),this.hot.rootElement.removeChild(re(fo,this)),$t(Wl,this,!1),$t(Mp,this,!0),this.hot._registerImmediate(()=>{$t(Mp,this,!1)})}function pae(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=re($i,this).getValueAtIndex(r);this.hot.getSettings()[Tp]&&i&&(n=i)}return n}function wae(){const t=this.hot.getSettings()[Tp],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{re($i,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{re($i,this).setValueAtIndex(r,n)}),$t(_d,this,t)):t===!0&&Array.isArray(re(_d,this))&&re(_d,this).forEach((n,r)=>{re($i,this).setValueAtIndex(r,n)})},!0)}var tN={},nN;function vae(){if(nN)return tN;nN=1;var t=hw();return t("flatMap"),tN}vae();var rN={},iN={},_S,oN;function Cae(){if(oN)return _S;oN=1;var t=hn(),e=fn(),n=Ho(),r=NE();return _S=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},_S}var sN;function yae(){if(sN)return iN;sN=1;var t=pt(),e=hn(),n=Er(),r=fn(),i=Ho(),o=Cae(),s=LE(),a=_r(),l=_a(),u=$E(),c=Ma(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,g=s(function(){for(var C=this.iterator,y=this.mapper,E,p;;){if(p=this.inner)try{if(E=r(e(p.next,p.iterator)),!E.done)return E.value;this.inner=null}catch(_){a(C,"throw",_)}if(E=r(e(this.next,C)),this.done=!!E.done)return;try{this.inner=o(y(E.value,this.counter++),!1)}catch(_){a(C,"throw",_)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(y){r(this);try{n(y)}catch(E){a(this,"throw",E)}return d?e(d,this,y):new g(i(this),{mapper:y,inner:null})}}),iN}var aN;function bae(){return aN||(aN=1,yae()),rN}bae();function Sae(t,e,n){Rae(t,e),e.set(t,n)}function Rae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cl(t,e,n){return(e=Eae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eae(t){var e=_ae(t,"string");return typeof e=="symbol"?e:e+""}function _ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lN(t,e){return t.get(jV(t,e))}function Yg(t,e,n){return t.set(jV(t,e),n),n}function jV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hl=new WeakMap;class wo{constructor(e,n,r,i,o,s){cl(this,"row",void 0),cl(this,"col",void 0),cl(this,"rowspan",void 0),cl(this,"colspan",void 0),cl(this,"removed",!1),cl(this,"cellCoordsFactory",void 0),cl(this,"cellRangeFactory",void 0),Sae(this,hl,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return ot`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return ot`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return ot`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return ot`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),Yg(hl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,Yg(hl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return Yg(hl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return lN(hl,this)||Yg(hl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),lN(hl,this)}}function Tae(t,e){Mae(t,e),e.add(t)}function Mae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gg(t,e,n){return(e=Iae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iae(t){var e=Pae(t,"string");return typeof e=="symbol"?e:e+""}function Pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Us=new WeakSet;class Ip{constructor(e){Tae(this,Us),Gg(this,"plugin",void 0),Gg(this,"mergedCells",[]),Gg(this,"mergedCellsMatrix",new Map),Gg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return ot`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Je(Ip.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new wo(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),dl(Us,this,uN).call(this,a),a):(u&&Je(Ip.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),dl(Us,this,Oae).call(this,r),r):!1}clear(){I(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ue(u,i,i+s-1),d=Ue(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=dl(Us,this,qg).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=dl(Us,this,qg).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=dl(Us,this,qg).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=dl(Us,this,qg).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{dl(Us,this,uN).call(this,s)})}}function qg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function uN(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function Oae(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function TS(t,e,n){return(e=xae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xae(t){var e=Aae(t,"string");return typeof e=="symbol"?e:e+""}function Aae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hae{constructor(e){TS(this,"plugin",void 0),TS(this,"mergedCellsCollection",void 0),TS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,g=s-f,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const y=C.row+C.rowspan-a-g;o[2]+y>=this.plugin.hot.countRows()?o[2]-=g:o[2]+=g?y:0}else if(r==="right"){const y=C.col+C.colspan-l-g;o[3]+y>=this.plugin.hot.countCols()?o[3]-=g:o[3]+=g?y:0}else if(r==="up"){const y=u-g-C.row+1;o[0]+y<0?o[0]+=g:o[0]-=g?y:0}else if(r==="left"){const y=c-g-C.col+1;o[1]+y<0?o[1]+=g:o[1]-=g?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),tn(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,g=Math.floor(d/f)*f,C=d-g;let y=null,E=null,p=null;switch(r){case"up":y="includesVertically",p=c-C+1;break;case"left":y="includesHorizontally",p=c-C+1;break;case"down":y="includesVertically",p=h+C-1;break;case"right":y="includesHorizontally",p=h+C-1;break}return I(i,_=>{_[y](p)&&_.isFarther(E,r)&&(E=_)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return I(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(g=>{let{colspan:C}=g;return C===h.getWidth()}):!f.every(g=>{let{rowspan:C}=g;return C===h.getHeight()})}}function MS(t,e,n){return(e=Nae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nae(t){var e=Dae(t,"string");return typeof e=="symbol"?e:e+""}function Dae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kae{constructor(e){MS(this,"plugin",void 0),MS(this,"hot",void 0),MS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function Lae(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(E_)}return this.getTranslatedPhrase(R_)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?wo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Td(t,e,n){return(e=$ae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ae(t){var e=Fae(t,"string");return typeof e=="symbol"?e:e+""}function Fae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cN{constructor(e){Td(this,"data",void 0),Td(this,"next",null),Td(this,"prev",null),this.data=e}}class Kg{constructor(){Td(this,"first",null),Td(this,"last",null)}push(e){const n=new cN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new cN(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function Vae(t,e){UV(t,e),e.add(t)}function fl(t,e,n){UV(t,e),e.set(t,n)}function UV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rt(t,e){return t.get(Pp(t,e))}function Or(t,e,n){return t.set(Pp(t,e),n),n}function Pp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oo=new WeakMap,so=new WeakMap,ao=new WeakMap,lo=new WeakMap,uE=new WeakMap,Xg=new WeakMap,Zg=new WeakMap,IS=new WeakSet;class Wae{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;Vae(this,IS),fl(this,oo,new Kg),fl(this,so,new Kg),fl(this,ao,null),fl(this,lo,null),fl(this,uE,null),fl(this,Xg,null),fl(this,Zg,null),Or(uE,this,n),Or(Xg,this,r),Or(Zg,this,i)}getCurrentVerticalNode(){return rt(lo,this).data}getFirstVerticalNode(){return rt(so,this).first.data}getNextVerticalNode(){return rt(lo,this).next.data}getPrevVerticalNode(){return rt(lo,this).prev.data}getCurrentHorizontalNode(){return rt(ao,this).data}getFirstHorizontalNode(){return rt(oo,this).first.data}getNextHorizontalNode(){return rt(ao,this).next.data}getPrevHorizontalNode(){return rt(ao,this).prev.data}setPrevNodeAsActive(){Or(lo,this,rt(lo,this).prev),Or(ao,this,rt(ao,this).prev)}setNextNodeAsActive(){Or(lo,this,rt(lo,this).next),Or(ao,this,rt(ao,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;Or(oo,this,new Kg);for(let s=n.row;s<=r.row;s++)if(!rt(Xg,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(rt(Zg,this).isHidden(a))continue;const l=Pp(IS,this,hN).call(this,e,rt(oo,this),i,s,a);l&&Or(ao,this,l)}rt(oo,this).first&&(rt(oo,this).first.prev=rt(oo,this).last,rt(oo,this).last.next=rt(oo,this).first);const o=new WeakSet;Or(so,this,new Kg);for(let s=n.col;s<=r.col;s++)if(!rt(Zg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(rt(Xg,this).isHidden(a))continue;const l=Pp(IS,this,hN).call(this,e,rt(so,this),o,a,s);l&&Or(lo,this,l)}rt(so,this).first&&(rt(so,this).first.prev=rt(so,this).last,rt(so,this).last.next=rt(so,this).first)}setActiveNode(e,n){return rt(oo,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Or(ao,this,r),!1}),rt(so,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return Or(lo,this,r),!1}),this}}function hN(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=rt(uE,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function zV(t,e,n){const{view:r,rowIndexMapper:i}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let u=e;u<e+n;u++)if(!i.isHidden(u)){var l;a+=(l=t.getRowHeight(u))!==null&&l!==void 0?l:s,u===0&&!o.isClassicTheme()&&(a+=1)}return a}function Bae(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!xe(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),$d()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=c,[C,y]=t.translateMergedCellToRenderable(h,g,d,f),E=t.getSetting("virtualized");if($d()&&d===0&&!e.getSettings().rowHeaders){const B=zV(e,h,g);i.set(l,B/g)}const p=n.getRenderableFromVisualIndex(l),_=r.getRenderableFromVisualIndex(u),P=C-p+1,D=y-_+1;let M=n.getNearestNotHiddenIndex(h,1),x=r.getNearestNotHiddenIndex(d,1);if(E){const B=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(B)||(M=Math.max(M,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(B)||(x=Math.max(x,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(g,P),U=Math.min(f,D);M===l&&x===u?(a.setAttribute("rowspan",Y),a.setAttribute("colspan",U)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function jae(t,e){YV(t,e),e.add(t)}function Qg(t,e,n){YV(t,e),e.set(t,n)}function YV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,n){return(e=Uae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uae(t){var e=zae(t,"string");return typeof e=="symbol"?e:e+""}function zae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zd(t,e,n){return t.set(st(t,e),n),n}function mt(t,e){return t.get(st(t,e))}function st(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeMergeCells");ie.getSingleton().register("afterMergeCells");ie.getSingleton().register("beforeUnmergeCells");ie.getSingleton().register("afterUnmergeCells");const cE="mergeCells",Yae=150,dN=cE;var si=new WeakMap,ai=new WeakMap,Eo=new WeakMap,fN=new WeakMap,dt=new WeakSet;class Gae extends Ge{constructor(){super(...arguments),jae(this,dt),PS(this,"mergedCellsCollection",null),PS(this,"autofillCalculations",null),PS(this,"selectionCalculations",null),Qg(this,si,null),Qg(this,ai,{row:0,col:0}),Qg(this,Eo,new Wae({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Qg(this,fN,Bae(this))}static get PLUGIN_KEY(){return cE}static get PLUGIN_PRIORITY(){return Yae}static get DEFAULT_SETTINGS(){return{[dF]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[cE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Ip(this),this.autofillCalculations=new Hae(this),this.selectionCalculations=new kae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,qae).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,Xae).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,Zae).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,Qae).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,Jae).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,mN).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,mN).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,tle).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,nle).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,rle).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,gN).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,gN).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,Kae).call(e,...r)}),this.addHook("afterRenderer",function(){return mt(fN,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,ele).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,ile).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,ole).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,sle).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,ale).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,lle).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,ule).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,cle).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,hle).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,dle).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,fle).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,gle).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,mle).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,ple).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return st(dt,e,wle).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!_0())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Dd(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=Dd(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?wo.containsNegativeValues(e)?(Je(wo.NEGATIVE_VALUES_WARNING(e)),!1):wo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Je(wo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):wo.isSingleCell(e)?(Je(wo.IS_SINGLE_CELL(e)),!1):wo.containsZeroSpan(e)?(Je(wo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),I(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:dN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dN)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(xe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(xe(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(xe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(xe(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function qae(){this.generateFromSettings(),this.hot.render()}function Kae(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Xae(t){mt(ai,this).row=t.row,mt(ai,this).col=t.col}function Zae(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;mt(si,this)&&(i.getRenderableFromVisualIndex(mt(si,this).row)!==null&&(n.row=mt(si,this).row),r.getRenderableFromVisualIndex(mt(si,this).col)!==null&&(n.col=mt(si,this).col),Zd(si,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Qae(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Jae(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Zd(si,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Zd(si,this,e.clone()),n&&e.assign(n)}function gN(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),C=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ue(g,u,h),Ue(C,c,d),Ue(this.hot.getLastRenderedVisibleRow(),u,h),Ue(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function ele(t){t.items.push({name:"---------"},Lae(this))}function mN(){Zd(si,this,null)}function tle(){if(mt(si,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=mt(si,this).clone().normalize();mt(Eo,this).setActiveNode(r.row,r.col),mt(ai,this).row>0||mt(ai,this).col>0?mt(Eo,this).setPrevNodeAsActive():(n==="E-W"&&mt(ai,this).col<0||e==="S-N"&&mt(ai,this).row<0)&&mt(Eo,this).setNextNodeAsActive()}function nle(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(mt(ai,this).col<0){const{rowEnd:a,colEnd:l}=mt(Eo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(mt(ai,this).col>0){const{rowStart:a,colStart:l}=mt(Eo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(mt(ai,this).row<0){const{rowEnd:a,colEnd:l}=mt(Eo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(mt(ai,this).row>0){const{rowStart:a,colStart:l}=mt(Eo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}mt(Eo,this).setActiveNode(t,e),Zd(ai,this,{row:0,col:0})}function rle(){this.hot.getSelectedRangeLast().isHeader()||mt(Eo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function ile(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function ole(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function sle(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function ale(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function lle(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function ule(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function cle(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function hle(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function dle(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function fle(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);I(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function gle(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function mle(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function ple(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function wle(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,zV(this.hot,e,g))}),t}function vle(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:SF(u.type))(l,u,d)(c,h);if(g===Mo){const C=a+1;if(typeof e[C]<"u")return s(C)}return g}(0)}}const GV="sort";function Cle(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${GV}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function yle(t){const e=t.className.split(" "),n=new RegExp(`^${GV}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function ble(t,e,n){return(e=Sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sle(t){var e=Rle(t,"string");return typeof e=="symbol"?e:e+""}function Rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Op="multiColumnSorting",Ele=170,pN=Op;bF(Op,vle);class _le extends xF{constructor(){super(...arguments),ble(this,"pluginKey",Op)}static get PLUGIN_KEY(){return Op}static get PLUGIN_PRIORITY(){return Ele}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,hp)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:Pa,position:"before",group:pN})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pN)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),pe(e,yle(e)),this.enabled!==!1&&q(e,Cle(...r))}onAfterOnCellMouseDown(e,n){JT(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,hp))):this.sort(this.getColumnNextConfig(n.col)))}}function wN(t,e,n){return(e=Tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tle(t){var e=Mle(t,"string");return typeof e=="symbol"?e:e+""}function Mle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ile="multipleSelectionHandles",Ple=160;class Ole extends Ge{constructor(){super(...arguments),wN(this,"dragged",[]),wN(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Ile}static get PLUGIN_PRIORITY(){return Ple}isEnabled(){return _o()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(we(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(we(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(we(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function hE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function qV(){return{label:"",isPlaceholder:!0}}function xle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;I(t,i=>{const o=[];let s=0;n.push(o),I(i,a=>{const l=hE();if(xe(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=yt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=yt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(qV());return!u})});const r=Math.max(...Be(n,i=>i.length));return I(n,i=>{if(i.length<r){const o=Be(new Array(r-i.length),()=>hE());i.splice(i.length,0,...o)}}),n}function OS(t,e,n){Ale(t,e),e.set(t,n)}function Ale(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ii(t,e){return t.get(KV(t,e))}function Lh(t,e,n){return t.set(KV(t,e),n),n}function KV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vN=["label","collapsible"];var Jo=new WeakMap,gl=new WeakMap,xS=new WeakMap;class Hle{constructor(){OS(this,Jo,[]),OS(this,gl,0),OS(this,xS,1/0)}setColumnsLimit(e){Lh(xS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Lh(Jo,this,xle(e,Ii(xS,this))),Lh(gl,this,Ii(Jo,this).length)}getData(){return Ii(Jo,this)}mergeWith(e){I(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&tn(s,o,vN)})}map(e){I(Ii(Jo,this),n=>{I(n,r=>{const i=e({...r});xe(i)&&tn(r,i,vN)})})}getHeaderSettings(e,n){var r;if(e>=Ii(gl,this)||e<0)return null;const i=Ii(Jo,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Ii(gl,this)||e<0)return i;const o=Ii(Jo,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ii(gl,this)}getColumnsCount(){return Ii(gl,this)>0?Ii(Jo,this)[0].length:0}clear(){Lh(Jo,this,[]),Lh(gl,this,0)}}function AS(t,e,n){return(e=Nle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nle(t){var e=Dle(t,"string");return typeof e=="symbol"?e:e+""}function Dle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XV="DF-pre-order";function ZV(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=ZV.call(this.childs[r],t,e)}return n}const kle="DF-post-order";function QV(t,e){for(let n=0;n<this.childs.length;n++)if(QV.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const JV="BF";function Lle(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const $le=JV,CN=new Map([[XV,ZV],[kle,QV],[JV,Lle]]);class xp{constructor(e){AS(this,"data",{}),AS(this,"parent",null),AS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new xp({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$le;if(!CN.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);CN.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function HS(t,e,n){Fle(t,e),e.set(t,n)}function Fle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qn(t,e){return t.get(eW(t,e))}function Vle(t,e,n){return t.set(eW(t,e),n),n}function eW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lu=new WeakMap,ml=new WeakMap,$u=new WeakMap;class Wle{constructor(e){HS(this,Lu,new Map),HS(this,ml,new Map),HS(this,$u,null),Vle($u,this,e)}getRoots(){return Array.from(qn(Lu,this).values())}getRootByColumn(e){let n;return qn(ml,this).has(e)&&(n=qn(Lu,this).get(qn(ml,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-qn(ml,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;qn(ml,this).clear(),I(qn(Lu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)qn(ml,this).set(i,e);e+=r})}buildTree(){this.clear();const e=qn($u,this).getColumnsCount();let n=0;for(;n<e;){const r=qn($u,this).getHeaderSettings(0,n),i=new xp;qn(Lu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=qn($u,this).getHeadersSettings(r,n,i);r+=1,I(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new xp(a),e.addChild(l)),r<qn($u,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){qn(Lu,this).clear(),qn(ml,this).clear()}}function tW(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Ap(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Hp(t){return Ap(t,"origColspan")===t.data.origColspan}function gM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Hp(t))return gM(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)I(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,tW(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Hp(a)&&(l.isCollapsed=Ap(a,"isCollapsed"))}),{rollbackModification:()=>mM(t),affectedColumns:Array.from(o),colspanCompensation:s}}function mM(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Hp(t))return mM(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)I(o,l=>{tW(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Ap(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Hp(l)&&(u.isCollapsed=Ap(l,"isCollapsed"))}),{rollbackModification:()=>gM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Ble(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function jle(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ot`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const yN=new Map([["collapse",mM],["expand",gM],["hide-column",Ble],["show-column",jle]]);function Ule(t,e,n){if(!yN.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return yN.get(t)(e,n)}function Jg(t){const e=[];return I(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=Yle(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(qV());else{const f=zle(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function zle(t){const{crossHiddenColumns:e,...n}=hE(t);return n}function Yle(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function NS(t,e,n){Gle(t,e),e.set(t,n)}function Gle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,n){return t.set(nW(t,e),n),n}function Dt(t,e){return t.get(nW(t,e))}function nW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uo=new WeakMap,cr=new WeakMap,pl=new WeakMap;class qle{constructor(){NS(this,uo,new Hle),NS(this,cr,new Wle(Dt(uo,this))),NS(this,pl,[[]])}setState(e){Dt(uo,this).setData(e);let n=!1;try{Dt(cr,this).buildTree()}catch{Dt(cr,this).clear(),Dt(uo,this).clear(),n=!0}return $h(pl,this,Jg(Dt(cr,this).getRoots())),n}setColumnsLimit(e){Dt(uo,this).setColumnsLimit(e)}mergeStateWith(e){const n=Be(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Dt(uo,this).mergeWith(n),Dt(cr,this).buildTree(),$h(pl,this,Jg(Dt(cr,this).getRoots()))}mapState(e){Dt(uo,this).map(e),Dt(cr,this).buildTree(),$h(pl,this,Jg(Dt(cr,this).getRoots()))}mapNodes(e){return gn(Dt(cr,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Dt(cr,this).getNode(n,r);let o;return i&&(o=Ule(e,i,r),$h(pl,this,Jg(Dt(cr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Dt(pl,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Dt(cr,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=Dt(cr,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},XV)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Dt(uo,this).getLayersCount()}getColumnsCount(){return Dt(uo,this).getColumnsCount()}clear(){$h(pl,this,[]),Dt(uo,this).clear(),Dt(cr,this).clear()}}function Fh(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zle{constructor(e,n){Fh(this,"hot",void 0),Fh(this,"nestedHeaderSettingsGetter",void 0),Fh(this,"layersCount",0),Fh(this,"container",void 0),Fh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;s&&(g+='<button class="changeType"></button>'),Ql(d,g),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Qle(t,e){rW(t,e),e.add(t)}function bN(t,e,n){return(e=Jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jle(t){var e=eue(t,"string");return typeof e=="symbol"?e:e+""}function eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vh(t,e,n){rW(t,e),e.set(t,n)}function rW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e,n){return t.set(kt(t,e),n),n}function We(t,e){return t.get(kt(t,e))}function kt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const SN="nestedHeaders",tue=280;var lt=new WeakMap,zs=new WeakMap,Md=new WeakMap,Ww=new WeakMap,Np=new WeakMap,Ut=new WeakSet;class nue extends Ge{constructor(){super(...arguments),Qle(this,Ut),Vh(this,lt,new qle),Vh(this,zs,null),Vh(this,Md,null),Vh(this,Ww,!1),Vh(this,Np,null),bN(this,"ghostTable",new Zle(this.hot,(e,n)=>this.getHeaderSettings(e,n))),bN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return SN}static get PLUGIN_PRIORITY(){return tue}isEnabled(){return!!this.hot.getSettings()[SN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Je(ot`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>kt(Ut,this,vue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,Cue).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,sue).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,aue).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,lue).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,uue).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,cue).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,hue).call(e,...i)}),this.addHook("afterSelection",()=>kt(Ut,this,em).call(this)),this.addHook("afterSelectionFocusSet",()=>kt(Ut,this,em).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,rue).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>kt(Ut,this,fue).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,mue).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,pue).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,iue).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,oue).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,due).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,gue).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return kt(Ut,e,wue).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>kt(Ut,this,em).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>kt(Ut,this,em).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();We(lt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=We(lt,this).setState(e)),this.detectedOverlappedHeaders&&Je(ot`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";We(lt,this).triggerColumnModification(i,r)}),!We(zs,this)&&this.enabled&&vs(zs,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";We(lt,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),We(lt,this).clear(),We(zs,this).unsubscribe(),vs(zs,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return We(lt,this)}getLayersCount(){return We(lt,this).getLayersCount()}getHeaderSettings(e,n){return We(lt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),pe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),pe(o,"hiddenHeader"),pe(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=We(lt,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,C,y;const{wtOverlays:E}=l._wt,p=(g=E.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),_=(C=E.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o);((y=E.topOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(o))&&u<r&&q(o,"hiddenHeaderText");const D=p||_?Math.min(c,r-i):c;D>1&&o.setAttribute("colspan",D)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(pe(E,this.hot.getColumnMeta(u).headerClassName),q(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=We(lt,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){vs(lt,this,null),We(zs,this)!==null&&(We(zs,this).unsubscribe(),vs(zs,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return We(lt,this).getHeaderTreeNodeData(e.row,e.col)}}function em(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=We(lt,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function rue(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=We(Np,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(vs(Np,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=We(lt,this).findLeftMostColumnIndex(a,l),g=We(lt,this).findRightMostColumnIndex(a,l),C=g-f+1;if(f<c&&g>h)return f;if(s){let y=null;return f>=c&&g>h?C>d?(e.value="start",y=f):(e.value="end",y=g):f<c&&g<=h&&(C>d?(e.value="end",y=g):(e.value="start",y=f)),y}return f<=c?f:g}function iue(t,e,n){const r=We(lt,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=We(lt,this).getHeaderSettings(e,t);if(o===W0){if(!a)return r.columnIndex}else if(o===r$&&(l>s-i||!a))return null;return t}function oue(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const g=c+f,C=d-a;if(C===0)continue;((i=We(lt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[g][C]="")}}}function sue(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function aue(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;vs(Md,this,e.clone()),vs(Ww,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(cw(t)||ba(t)&&l||AL(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function lue(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=Ue(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function uue(){vs(Ww,this,!1)}function cue(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!We(Ww,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=We(lt,this).getHeaderTreeNodeData(We(Md,this).row,We(Md,this).col);if(e.setHighlight(We(Md,this)),o>e.getWidth()||i<n||i+o-1>r){const s=We(lt,this).findTopMostEntireHeaderLevel(Ue(n,i,i+o-1),Ue(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function hue(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=We(lt,this).findLeftMostColumnIndex(n.row,n.col),o=We(lt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function due(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});vs(Np,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function fue(t){if(We(lt,this).getLayersCount()>0){t.length=0;for(let e=0;e<We(lt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function gue(t){const e=We(lt,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=We(lt,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Fn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?We(lt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function mue(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function pue(t,e,n){var r;const{label:i}=(r=We(lt,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function wue(t,e){if(t<0)return this.hot.getCell(t,We(lt,this).findLeftMostColumnIndex(t,e),!0)}function vue(){this.updatePlugin()}function Cue(t,e){e||this.updatePlugin()}function Wh(t,e,n){return(e=yue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yue(t){var e=bue(t,"string");return typeof e=="symbol"?e:e+""}function bue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sue{constructor(e,n){Wh(this,"hot",void 0),Wh(this,"data",null),Wh(this,"plugin",void 0),Wh(this,"parentReference",new WeakMap),Wh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&I(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&I(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ae(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(I(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];I(r,o=>{i.push(this.getDataObject(o))}),I(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function RN(t,e,n){return(e=Rue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rue(t){var e=Eue(t,"string");return typeof e=="symbol"?e:e+""}function Eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pM{constructor(e,n){RN(this,"hot",void 0),RN(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Co extends pM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(I(l,c=>{c&&s.removeChild(c)}),q(n,Co.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");q(d,Co.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ye(c,[Xl()]),q(n,Co.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${Co.CSS_CLASSES.button} ${Co.CSS_CLASSES.expandButton}`),u&&ye(n,[li(!1)])):(q(c,`${Co.CSS_CLASSES.button} ${Co.CSS_CLASSES.collapseButton}`),u&&ye(n,[li(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);const r=this.hot.view.getStylesHandler();let i=11;r.isClassicTheme()||(i=r.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class _ue extends pM{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),I(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&I(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];I(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return I(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);I(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return I(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);I(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&I(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];I(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];I(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];I(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{I(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{I(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&I(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);we(e.target,Co.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),vi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Tue(t,e,n){Mue(t,e),e.set(t,n)}function Mue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iue(t,e,n){return(e=Pue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pue(t){var e=Oue(t,"string");return typeof e=="symbol"?e:e+""}function Oue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xue(t,e){return t.get(Aue(t,e))}function Aue(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var EN=new WeakMap;class Hue extends pM{constructor(){super(...arguments),Iue(this,"dataManager",this.plugin.dataManager),Tue(this,EN,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(j_)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(U_)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return I(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=xue(EN,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function tm(t,e,n){return(e=Nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nue(t){var e=Due(t,"string");return typeof e=="symbol"?e:e+""}function Due(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kue{constructor(e){tm(this,"plugin",void 0),tm(this,"hot",void 0),tm(this,"dataManager",void 0),tm(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(g=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Pt(i)&&(Je(ot`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Lue(t,e){iW(t,e),e.add(t)}function _N(t,e,n){iW(t,e),e.set(t,n)}function iW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DS(t,e,n){return(e=$ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ue(t){var e=Fue(t,"string");return typeof e=="symbol"?e:e+""}function Fue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dm(t,e){return t.get(vn(t,e))}function Dp(t,e,n){return t.set(vn(t,e),n),n}function vn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kp="nestedRows",Vue=300,TN=kp,Wue="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Bw=new WeakMap,Fu=new WeakMap,Rn=new WeakSet;class Bue extends Ge{constructor(){super(...arguments),Lue(this,Rn),DS(this,"dataManager",null),DS(this,"headersUI",null),DS(this,"collapsedRowsMap",null),_N(this,Bw,!1),_N(this,Fu,!1)}static get PLUGIN_KEY(){return kp}static get PLUGIN_PRIORITY(){return Vue}isEnabled(){return!!this.hot.getSettings()[kp]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Cf),this.dataManager=new Sue(this,this.hot),this.collapsingUI=new _ue(this,this.hot),this.headersUI=new Co(this,this.hot),this.contextMenuUI=new Hue(this,this.hot),this.rowMoveController=new kue(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,nce).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,rce).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,zue).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Yue).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Gue).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Uue).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Xue).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Kue).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Zue).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Que).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,Jue).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,ece).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,que).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,tce).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vn(Rn,e,jue).call(e,...r)}),this.addHook("beforeLoadData",n=>vn(Rn,this,MN).call(this,n)),this.addHook("beforeUpdateData",n=>vn(Rn,this,MN).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:TN,relativeToGroup:Pa,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TN)}disableCoreAPIModifiers(){Dp(Fu,this,!0)}enableCoreAPIModifiers(){Dp(Fu,this,!1)}onModifyRowData(e){if(!Dm(Fu,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Dm(Fu,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Dm(Fu,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function jue(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Uue(t,e,n){this.collapsingUI.toggleState(t,e,n)}function zue(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Dp(Bw,this,!0),this.dataManager.getData().slice()}function Yue(t){return this.contextMenuUI.appendOptions(t)}function Gue(t,e){this.headersUI.appendLevelIndicators(t,e)}function que(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Kue(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Dp(Bw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Xue(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Zue(){this.collapsingUI.collapsedRowsStash.stash()}function Que(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Jue(){this.collapsingUI.collapsedRowsStash.stash()}function ece(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function tce(){this.dataManager.rewriteCache()}function nce(){this.headersUI.updateRowHeaderWidth()}function rce(t,e){Dm(Bw,this)&&(e.skipRender=!0)}function MN(t){if(!g$(t)){P0(Wue),this.hot.getSettings()[kp]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function kS(t,e,n){return(e=ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ice(t){var e=oce(t,"string");return typeof e=="symbol"?e:e+""}function oce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;kS(this,"rootWindow",void 0),kS(this,"prefix",void 0),kS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){I(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function ace(t,e,n){return(e=lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lce(t){var e=uce(t,"string");return typeof e=="symbol"?e:e+""}function uce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ie.getSingleton().register("persistentStateSave");ie.getSingleton().register("persistentStateLoad");ie.getSingleton().register("persistentStateReset");const IN="persistentState",cce=0;class hce extends Ge{constructor(){super(...arguments),ace(this,"storage",void 0)}static get PLUGIN_KEY(){return IN}static get PLUGIN_PRIORITY(){return cce}isEnabled(){return!!this.hot.getSettings()[IN]}enablePlugin(){this.enabled||(this.storage||(this.storage=new sce(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function dce(t,e){fce(t,e),e.add(t)}function fce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e,n){return(e=gce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gce(t){var e=mce(t,"string");return typeof e=="symbol"?e:e+""}function mce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PN(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $S="search",pce=190,wce="htSearchResult",vce=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Cce=function(t,e,n){return Pt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Pt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var FS=new WeakSet;class yce extends Ge{constructor(){super(...arguments),dce(this,FS),LS(this,"callback",vce),LS(this,"queryMethod",Cce),LS(this,"searchResultClass",wce)}static get PLUGIN_KEY(){return $S}static get PLUGIN_PRIORITY(){return pce}isEnabled(){return this.hot.getSettings()[$S]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[$S];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return PN(FS,e,ON).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return PN(FS,e,ON).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,g=(h.search.queryMethod||r)(e,c,h);if(g){const C={row:l,col:u,data:c};s.push(C)}d&&d(a,l,u,c,g)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){xe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function ON(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function nm(t,e,n){return(e=bce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bce(t){var e=Sce(t,"string");return typeof e=="symbol"?e:e+""}function Sce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oW{constructor(e){nm(this,"viewportWidth",void 0),nm(this,"overwriteColumnWidthFn",void 0),nm(this,"baseWidths",new Map),nm(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Rce extends oW{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=gc?(i.push([d,g]),a+=g):f!==g&&(i.push([d,g]),o.push(d),s-=g)}),s<=gc){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,g]=h,C=g;o.includes(f)||(C=Math.round(g*l)),this.stretchedWidths.set(f,C),u=f,d<i.length-1&&(c+=C)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function xN(t,e,n){Ece(t,e),e.set(t,n)}function Ece(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VS(t,e){return t.get(sW(t,e))}function rm(t,e,n){return t.set(sW(t,e),n),n}function sW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var im=new WeakMap,Bh=new WeakMap;class _ce extends oW{constructor(){super(...arguments),xN(this,im,0),xN(this,Bh,-1)}prepare(e){super.prepare(e),rm(im,this,0),rm(Bh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),rm(Bh,this,e),rm(im,this,n)}calculate(){if(VS(Bh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+VS(im,this),0);this.stretchedWidths.set(VS(Bh,this),n)}}function Tce(t,e){aW(t,e),e.add(t)}function om(t,e,n){aW(t,e),e.set(t,n)}function aW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e){return t.get(nc(t,e))}function WS(t,e,n){return t.set(nc(t,e),n),n}function nc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mce="stretchColumns";var $n=new WeakMap,Vu=new WeakMap,BS=new WeakMap,sm=new WeakMap,jh=new WeakSet;class Ice{constructor(e){Tce(this,jh),om(this,$n,void 0),om(this,Vu,void 0),om(this,BS,new Map([["all",new Rce(nc(jh,this,AN).bind(this))],["last",new _ce(nc(jh,this,AN).bind(this))]])),om(this,sm,"none"),WS($n,this,e),WS(Vu,this,zt($n,this).columnIndexMapper.createAndRegisterIndexMap(Mce,"physicalIndexToValue"))}useStrategy(e){WS(sm,this,zt(BS,this).has(e)?e:"none")}refreshStretching(){if(zt(sm,this)==="none"){zt(Vu,this).clear();return}zt($n,this).batchExecution(()=>{zt(Vu,this).clear();const e=zt(BS,this).get(zt(sm,this));let r=zt($n,this).view.getViewportWidth();nc(jh,this,Pce).call(this)&&(r-=yn(zt($n,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<zt($n,this).countCols();i++)zt($n,this).columnIndexMapper.isHidden(zt($n,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,nc(jh,this,Oce).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;zt(Vu,this).setValueAtIndex(zt($n,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return zt(Vu,this).getValueAtIndex(zt($n,this).toPhysicalColumn(e))}}function Pce(){const{view:t}=zt($n,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),n=zt($n,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=((s=zt($n,this).getRowHeight(a))!==null&&s!==void 0?s:r)+(a===0?1:0),i>e){o=!0;break}}return o}function Oce(t){var e;return(e=zt($n,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:gc}function AN(t,e){return zt($n,this).runHooks("beforeStretchingColumnWidth",t,e)}function xce(t,e){lW(t,e),e.add(t)}function jS(t,e,n){lW(t,e),e.set(t,n)}function lW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function US(t,e,n){return t.set(Lp(t,e),n),n}function os(t,e){return t.get(Lp(t,e))}function Lp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ace="stretchColumns",Hce=155;var Xu=new WeakMap,am=new WeakMap,Uh=new WeakMap,zS=new WeakSet;class Nce extends Ge{constructor(){super(...arguments),xce(this,zS),jS(this,Xu,new Ice(this.hot)),jS(this,am,null),jS(this,Uh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;os(am,this)!==null&&os(am,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),US(am,this,i.width)})})}))}static get PLUGIN_KEY(){return Ace}static get PLUGIN_PRIORITY(){return Hce}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(os(Xu,this).useStrategy(this.hot.getSettings().stretchH),os(Uh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lp(zS,e,kce).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lp(zS,e,Dce).call(e,...r)},10),super.enablePlugin())}updatePlugin(){os(Xu,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),os(Uh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return os(Xu,this).getStretchedWidth(e)}destroy(){os(Uh,this).disconnect(),US(Uh,this,null),US(Xu,this,null),super.destroy()}}function Dce(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function kce(t){t&&os(Xu,this).refreshStretching()}function Lce(t,e){$ce(t,e),e.add(t)}function $ce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lm(t,e,n){return(e=Fce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fce(t){var e=Vce(t,"string");return typeof e=="symbol"?e:e+""}function Vce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wce="touchScroll",Bce=200;var um=new WeakSet;class jce extends Ge{constructor(){super(...arguments),Lce(this,um),lm(this,"scrollbars",[]),lm(this,"clones",[]),lm(this,"lockedCollection",!1),lm(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Wce}static get PLUGIN_PRIORITY(){return Bce}static get SETTING_KEYS(){return!0}isEnabled(){return E0()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>YS(um,this,Uce).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>YS(um,this,zce).call(this)),this.addHook("afterMomentumScroll",()=>YS(um,this,Yce).call(this))}}function Uce(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function zce(){this.freezeOverlays=!0,I(this.clones,t=>{q(t,"hide-tween")})}function Yce(){this.freezeOverlays=!1,I(this.clones,t=>{pe(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{I(this.clones,t=>{pe(t,"show-tween")})},400),I(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Gce(t,e){qce(t,e),e.add(t)}function qce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kce(t,e,n){return(e=Xce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xce(t){var e=Zce(t,"string");return typeof e=="symbol"?e:e+""}function Zce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qce(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const km="trimRows",Jce=330;var HN=new WeakSet;class ehe extends Ge{constructor(){super(...arguments),Gce(this,HN),Kce(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return km}static get PLUGIN_PRIORITY(){return Jce}isEnabled(){return!!this.hot.getSettings()[km]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Cf),this.trimmedRowsMap.addLocalHook("init",()=>Qce(HN,this,the).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[km];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),I(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{I(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(I(e,l=>{o[l]=!1}),i=gn(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function the(){const t=this.hot.getSettings()[km];Array.isArray(t)&&this.hot.batchExecution(()=>{I(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function nhe(t,e,n){return(e=rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ihe(t,"string");return typeof e=="symbol"?e:e+""}function ihe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ci{constructor(e){nhe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function cm(t,e,n){return(e=ohe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ohe(t){var e=she(t,"string");return typeof e=="symbol"?e:e+""}function she(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wM extends Ci{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),cm(this,"stateBefore",void 0),cm(this,"range",void 0),cm(this,"type",void 0),cm(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new wM({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){I(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){qs(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function NN(t,e,n){return(e=ahe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ahe(t){var e=lhe(t,"string");return typeof e=="symbol"?e:e+""}function lhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vM extends Ci{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),NN(this,"columns",void 0),NN(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new vM({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),dM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function DN(t,e,n){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CM extends Ci{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),DN(this,"previousSortState",void 0),DN(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new CM({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function kN(t,e,n){return(e=hhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hhe(t){var e=dhe(t,"string");return typeof e=="symbol"?e:e+""}function dhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yM extends Ci{constructor(e){let{index:n,amount:r}=e;super("insert_col"),kN(this,"index",void 0),kN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new yM({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function LN(t,e,n){return(e=fhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fhe(t){var e=ghe(t,"string");return typeof e=="symbol"?e:e+""}function ghe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bM extends Ci{constructor(e){let{index:n,amount:r}=e;super("insert_row"),LN(this,"index",void 0),LN(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new bM({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function hm(t,e,n){return(e=mhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mhe(t){var e=phe(t,"string");return typeof e=="symbol"?e:e+""}function phe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SM extends Ci{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),hm(this,"changes",void 0),hm(this,"selected",void 0),hm(this,"countCols",void 0),hm(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new SM({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=jn(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=jn(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function $N(t,e,n){return(e=whe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function whe(t){var e=vhe(t,"string");return typeof e=="symbol"?e:e+""}function vhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RM extends Ci{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),$N(this,"conditionsStack",void 0),$N(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new RM({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function Che(t,e,n){return(e=yhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yhe(t){var e=bhe(t,"string");return typeof e=="symbol"?e:e+""}function bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EM extends Ci{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),Che(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new EM({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function uW(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function es(t,e,n){return(e=She(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function She(t){var e=Rhe(t,"string");return typeof e=="symbol"?e:e+""}function Rhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _M extends Ci{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),es(this,"index",void 0),es(this,"indexes",void 0),es(this,"data",void 0),es(this,"amount",void 0),es(this,"headers",void 0),es(this,"columnPositions",void 0),es(this,"rowPositions",void 0),es(this,"fixedColumnsStart",void 0),es(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,g=>{const C=[],y=l[g];fe(u,c,E=>{C.push(y[e.toPhysicalColumn(E)])}),h.push(C)}),fe(i-1,g=>{f.push(e.toPhysicalColumn(u+g))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+g)]||null)}),new _M({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:uW(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Be(this.data[c],o));const l=Be(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),I(e.getSourceDataArray(),(c,h)=>{I(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&I(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Wu(t,e,n){return(e=Ehe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ehe(t){var e=_he(t,"string");return typeof e=="symbol"?e:e+""}function _he(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TM extends Ci{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Wu(this,"index",void 0),Wu(this,"data",void 0),Wu(this,"fixedRowsBottom",void 0),Wu(this,"fixedRowsTop",void 0),Wu(this,"rowIndexesSequence",void 0),Wu(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=jn(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new TM({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:uW(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function FN(t,e,n){return(e=The(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function The(t){var e=Mhe(t,"string");return typeof e=="symbol"?e:e+""}function Mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MM extends Ci{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),FN(this,"rows",void 0),FN(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new MM({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),dM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Ihe(t,e,n){return(e=Phe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Phe(t){var e=Ohe(t,"string");return typeof e=="symbol"?e:e+""}function Ohe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IM extends Ci{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Ihe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new IM({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function xhe(t,e){[wM,vM,CM,yM,bM,SM,RM,EM,_M,TM,MM,IM].forEach(n=>n.startRegisteringEvents(t,e))}function Ahe(t,e){Hhe(t,e),e.add(t)}function Hhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GS(t,e,n){return(e=Nhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nhe(t){var e=Dhe(t,"string");return typeof e=="symbol"?e:e+""}function Dhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VN="undoRedo",khe="undoRedo",Lhe=1e3;ie.getSingleton().register("beforeUndo");ie.getSingleton().register("afterUndo");ie.getSingleton().register("beforeRedo");ie.getSingleton().register("afterRedo");const WN=new Set;var dm=new WeakSet;class $he extends Ge{static get PLUGIN_KEY(){return khe}static get PLUGIN_PRIORITY(){return Lhe}static get SETTING_KEYS(){return!0}constructor(e){super(e),Ahe(this,dm),GS(this,"doneActions",[]),GS(this,"undoneActions",[]),GS(this,"ignoreNewActions",!1),xhe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return qS(dm,e,Fhe).call(e,...r)}),this.registerShortcuts(),qS(dm,this,Vhe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),qS(dm,this,Whe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:VN};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VN)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=jn(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=jn(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Fhe(t,e){e==="loadData"&&this.clear()}function Vhe(){const t=e=>{WN.has(e)||(Je(ot`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),WN.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Whe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function Bhe(){Ye(dd),Ye(nQ),Ye(fd),Ye(HQ),Ye(WQ),Ye(xF),Ye(kJ),Ye(yee),Ye(Dw),Ye(Pte),Ye(tne),Ye(une),Ye($w),Ye(zne),Ye(Vie),Ye(Coe),Ye(Yoe),Ye(ise),Ye(pse),Ye(Mse),Ye(Lse),Ye(tae),Ye(cae),Ye(Gae),Ye(_le),Ye(Ole),Ye(nue),Ye(Bue),Ye(hce),Ye(yce),Ye(Nce),Ye(jce),Ye(ehe),Ye($he)}function jhe(){T7(),K5(),iZ(),EZ(),Bhe()}function Uhe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var KS,XS,ZS,QS,JS;jhe();Uhe(Se);Se.__GhostTable=XT;Se._getListenersCounter=kq;Se._getRegisteredMapsCounter=G4;Se.EventManager=di;const zhe=[p2,hq,A4,Z5,lq,iq,y2,rK,aq,S2,gq,nK],Yhe=[eq,mq];Se.helper={};Se.dom={};I(zhe,t=>{I(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.helper[e]=t[e])})});I(Yhe,t=>{I(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.dom[e]=t[e])})});Se.cellTypes=(KS=Se.cellTypes)!==null&&KS!==void 0?KS:{};I(Q9(),t=>{Se.cellTypes[t]=PT(t)});Se.cellTypes.registerCellType=Zr;Se.cellTypes.getCellType=PT;Se.editors=(XS=Se.editors)!==null&&XS!==void 0?XS:{};I(Oq(),t=>{Se.editors[`${Bn(t)}Editor`]=Jm(t)});Se.editors.registerEditor=mr;Se.editors.getEditor=Jm;Se.renderers=(ZS=Se.renderers)!==null&&ZS!==void 0?ZS:{};I(vK(),t=>{const e=ep(t);t==="base"&&(Se.renderers.cellDecorator=e),Se.renderers[`${Bn(t)}Renderer`]=e});Se.renderers.registerRenderer=Nr;Se.renderers.getRenderer=ep;Se.validators=(QS=Se.validators)!==null&&QS!==void 0?QS:{};I(bK(),t=>{Se.validators[`${Bn(t)}Validator`]=N0(t)});Se.validators.registerValidator=bl;Se.validators.getValidator=N0;Se.plugins=(JS=Se.plugins)!==null&&JS!==void 0?JS:{};I(H0(),t=>{Se.plugins[t]=mf(t)});Se.plugins[`${Bn(Ge.PLUGIN_KEY)}Plugin`]=Ge;Se.plugins.registerPlugin=Ye;Se.plugins.getPlugin=mf;class Ghe{diff(e,n,r={}){let i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);const o=this.castInput(e,r),s=this.castInput(n,r),a=this.removeEmpty(this.tokenize(o,r)),l=this.removeEmpty(this.tokenize(s,r));return this.diffWithOptionsObj(a,l,r,i)}diffWithOptionsObj(e,n,r,i){var o;const s=p=>{if(p=this.postProcess(p,r),i){setTimeout(function(){i(p)},0);return}else return p},a=n.length,l=e.length;let u=1,c=a+l;r.maxEditLength!=null&&(c=Math.min(c,r.maxEditLength));const h=(o=r.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,f=[{oldPos:-1,lastComponent:void 0}];let g=this.extractCommon(f[0],n,e,0,r);if(f[0].oldPos+1>=l&&g+1>=a)return s(this.buildValues(f[0].lastComponent,n,e));let C=-1/0,y=1/0;const E=()=>{for(let p=Math.max(C,-u);p<=Math.min(y,u);p+=2){let _;const P=f[p-1],D=f[p+1];P&&(f[p-1]=void 0);let M=!1;if(D){const Y=D.oldPos-p;M=D&&0<=Y&&Y<a}const x=P&&P.oldPos+1<l;if(!M&&!x){f[p]=void 0;continue}if(!x||M&&P.oldPos<D.oldPos?_=this.addToPath(D,!0,!1,0,r):_=this.addToPath(P,!1,!0,1,r),g=this.extractCommon(_,n,e,p,r),_.oldPos+1>=l&&g+1>=a)return s(this.buildValues(_.lastComponent,n,e))||!0;f[p]=_,_.oldPos+1>=l&&(y=Math.min(y,p-1)),g+1>=a&&(C=Math.max(C,p+1))}u++};if(i)(function p(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);E()||p()},0)})();else for(;u<=c&&Date.now()<=d;){const p=E();if(p)return p}}addToPath(e,n,r,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===n&&s.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:n,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:n,removed:r,previousComponent:s}}}extractCommon(e,n,r,i,o){const s=n.length,a=r.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(r[l+1],n[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,n,r){return r.comparator?r.comparator(e,n):e===n||!!r.ignoreCase&&e.toLowerCase()===n.toLowerCase()}removeEmpty(e){const n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(e[r]);return n}castInput(e,n){return e}tokenize(e,n){return Array.from(e)}join(e){return e.join("")}postProcess(e,n){return e}get useLongestToken(){return!1}buildValues(e,n,r){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(r.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=n.slice(l,l+c.count);h=h.map(function(d,f){const g=r[u+f];return g.length>d.length?g:d}),c.value=this.join(h)}else c.value=this.join(n.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class qhe extends Ghe{constructor(){super(...arguments),this.tokenize=Xhe}equals(e,n,r){return r.ignoreWhitespace?((!r.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!r.newlineIsToken||!n.includes(`
`))&&(n=n.trim())):r.ignoreNewlineAtEof&&!r.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),n.endsWith(`
`)&&(n=n.slice(0,-1))),super.equals(e,n,r)}}const Khe=new qhe;function BN(t,e,n){return Khe.diff(t,e,n)}function Xhe(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const n=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(let i=0;i<r.length;i++){const o=r[i];i%2&&!e.newlineIsToken?n[n.length-1]+=o:n.push(o)}return n}function Zhe(t,e,n,r,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;BN(n,r,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(BN(n,r,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(p){return p.map(function(_){return" "+_})}const d=[];let f=0,g=0,C=[],y=1,E=1;for(let p=0;p<c.length;p++){const _=c[p],P=_.lines||Jhe(_.value);if(_.lines=P,_.added||_.removed){if(!f){const D=c[p-1];f=y,g=E,D&&(C=l>0?h(D.lines.slice(-l)):[],f-=C.length,g-=C.length)}for(const D of P)C.push((_.added?"+":"-")+D);_.added?E+=P.length:y+=P.length}else{if(f)if(P.length<=l*2&&p<c.length-2)for(const D of h(P))C.push(D);else{const D=Math.min(P.length,l);for(const x of h(P.slice(0,D)))C.push(x);const M={oldStart:f,oldLines:y-f+D,newStart:g,newLines:E-g+D,lines:C};d.push(M),f=0,g=0,C=[]}y+=P.length,E+=P.length}}for(const p of d)for(let _=0;_<p.lines.length;_++)p.lines[_].endsWith(`
`)?p.lines[_]=p.lines[_].slice(0,-1):(p.lines.splice(_+1,0,"\\ No newline at end of file"),_++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function cW(t){if(Array.isArray(t))return t.map(cW).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let n=0;n<t.hunks.length;n++){const r=t.hunks[n];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(const i of r.lines)e.push(i)}return e.join(`
`)+`
`}function Qhe(t,e,n,r,i,o,s){{const a=Zhe(t,e,n,r,i,o);return a?cW(a):void 0}}function Jhe(t){const e=t.endsWith(`
`),n=t.split(`
`).map(r=>r+`
`);return e?n.pop():n.push(n.pop().slice(0,-1)),n}var dE;(t=>{t.contains=(e,n)=>{for(let r=0;r<e.length;r++)if(e[r]==n)return!0;return!1},t.range=(e,n)=>[...Array(Number(n)-Number(e)+1).keys()].map(r=>r+Number(e)).map(String),t.sort=e=>{let n=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(n.compare),e}})(dE||(dE={}));const Bu=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,Cc=dE;class jN{constructor(e){bi(this,"data");this.data=e}run(){const e={};return this.data.map(n=>{e[n]?e[n]++:e[n]=1}),Object.keys(e).map(n=>{e[n]==1&&delete e[n]}),Object.fromEntries(Object.entries(e).sort(([,n],[,r])=>r-n))}}class UN{constructor(e){bi(this,"data");this.data=e}run(){return[...new Set(this.data)]}}class fE{constructor(e,n,r=!0){bi(this,"data1");bi(this,"data2");bi(this,"ignoreDuplicates");r?(this.data1=[...new Set(e)],this.data2=[...new Set(n)]):(this.data1=e,this.data2=n),this.ignoreDuplicates=r}run(){const e=[...this.data1];for(let n=0;n<this.data2.length;n++)Cc.contains(e,this.data2[n])&&e.splice(e.indexOf(this.data2[n]),1);return Cc.sort(e)}}class ede{constructor(e,n){bi(this,"data1");bi(this,"data2");this.data1=e,this.data2=n}run(){let e=[],n;n=[...new Set(this.data1)];for(let r=0;r<n.length;r++)Cc.contains(this.data2,n[r])&&e.push(n[r]);return Cc.sort(e)}}class zN{constructor(e){bi(this,"data");this.data=Cc.sort(e)}run(){for(let e=0;e<this.data.length;e++){const n=Number(this.data[e]);if(isNaN(n))return["!Error!"]}return new fE(Cc.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class tde{constructor(e,n){bi(this,"data1");bi(this,"data2");this.data1=e,this.data2=n}run(){return Qhe("Data1","Data2",this.data1,this.data2)}}const nde=async(t,e)=>{Le(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(Le(e).trim()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var rde=(t,e)=>e("chkDuplicates"),ide=(t,e)=>e("rmDuplicates"),ode=(t,e)=>e("chkConsecutive"),sde=(t,e)=>e("compare"),ade=(t,e)=>e("diff"),lde=vB('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-15jzodw"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-15jzodw"><div class="row svelte-15jzodw"><div id="Table1" class="col-3 svelte-15jzodw"></div> <div id="Table2" class="col-3 pl-0 svelte-15jzodw"></div> <div class="col-2 p-0 pt-5 svelte-15jzodw"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-15jzodw">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-15jzodw">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-15jzodw"><label for="result">Result</label> <textarea class="form-control svelte-15jzodw" id="result" readonly=""></textarea></div></div></div>',1);function ude(t,e){QN(e,!0);const n=[],r=[];let i,o,s=br(""),a=br("Data1"),l=br("comm"),u=br(!0),c=br(!0),h=br(!1);const d=(O,T,k)=>{let W;try{W=JSON.parse(k)}catch{W=void 0}return new Se(O,{data:W,colHeaders:[T],colWidths(){return Math.floor(window.innerWidth/4)-50-24},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"})};TB(()=>{i=d(document.getElementById("Table1"),"Data1",localStorage.getItem("data1")||""),o=d(document.getElementById("Table2"),"Data2",localStorage.getItem("data2")||"")});const f=O=>O.getData().map(T=>T[0]),g=O=>{const T=f(i).filter($=>$!=""),k=f(o).filter($=>$!="");switch(O){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(Le(a)=="Data1"&&!T.length){Mt(s,`Data1 is empty.
Please enter something...`);return}else if(Le(a)=="Data2"&&!k.length){Mt(s,`Data2 is empty.
Please enter something...`);return}break;default:if(T.length){if(!k.length){Mt(s,`Data2 is empty.
Please enter something...`);return}}else{Mt(s,`Data1 is empty.
Please enter something...`);return}}Mt(h,!0);const W=E(),H=new Date().getTime();let N="",V;switch(O){case"chkDuplicates":let $;Le(a)=="Data1"?$=new jN(T).run():$=new jN(k).run(),Object.keys($).length?Le(u)?N=`Duplicate values found in ${Le(a)}.
`+Bu(Object.keys($).length,Object.keys($).map(z=>`${z} appears ${$[z]} times.`)):N=Object.keys($).join(`
`):N=`${Le(a)} has no duplicate value.`;break;case"rmDuplicates":Le(a)=="Data1"?V=new UN(T).run():V=new UN(k).run(),N=V.join(`
`);break;case"chkConsecutive":Le(a)=="Data1"?V=new zN(T).run():V=new zN(k).run(),V.length?V.length==1&&V[0]=="!Error!"?N=`Error!
${Le(a)} contains non-numeric value. Please check!`:N=`${Le(a)} is not consecutive.

The following numbers are missing:
${V.join(`
`)}`:N=`${Le(a)} contains consecutive numbers.`;break;case"compare":if(Le(l)=="comm")V=new ede(T,k).run(),V.length?N=`Common values found between two data.
${Bu(V.length,V)}`:N="Two data contain no common value.";else{const z=new fE(T,k,Le(c)).run(),ne=new fE(k,T,Le(c)).run();z.length+ne.length==0?N="Data1 is same as Data2.":z.length?ne.length?N=`Two files have inconsistent content.

Data1 is more than Data2
${Bu(z.length,z)}

Data2 is more than Data1
${Bu(ne.length,ne)}`:N=`Data1 completely contains Data2.

Data1 is more than Data2
${Bu(z.length,z)}`:N=`Data2 completely contains Data1.

Data2 is more than Data1
${Bu(ne.length,ne)}`}break;case"diff":N=new tde(T.join(`
`)+`
`,k.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(W),O=="rmDuplicates"||O=="chkDuplicates"&&!Le(u)?Mt(s,N,!0):Mt(s,N+`

Duration for process: ${Date.now()-H}ms`),Mt(h,!1)},C=()=>{confirm("Clear all data?")&&(i.loadData([[""]]),o.loadData([[""]]),Mt(s,""))},y=()=>{const O=i.getData();i.loadData(o.getData()),o.loadData(O)},E=()=>setInterval(()=>{const O=Le(s).split("Processing");let T=O.length>=2?O[1].length:0;T<3?T++:T-=3,Mt(s,"Processing"+".".repeat(T))},200);var p=lde();pB("beforeunload",tR,()=>{localStorage.setItem("data1",JSON.stringify(i.getData())),localStorage.setItem("data2",JSON.stringify(o.getData()))});var _=Tn(YW(p),2),P=Un(_),D=Tn(Un(P),4),M=Un(D);M.__click=[rde,g];var x=Tn(M,2),Y=Un(x),U=Un(Y),B=Tn(x,2);B.__click=[ide,g];var Z=Tn(B,2);Z.__click=[ode,g];var Q=Tn(Z,2),se=Un(Q),te=Un(se);te.value=te.__value="Data1";var le=Tn(se,2),ct=Un(le);ct.value=ct.__value="Data2";var be=Tn(Q,4);be.__click=[sde,g];var He=Tn(be,2),ft=Un(He),jt=Un(ft);jt.value=jt.__value="comm";var Ze=Tn(ft,2),m=Un(Ze);m.value=m.__value="diff";var v=Tn(He,2),w=Un(v),A=Un(w),F=Tn(v,4);F.__click=[ade,g];var j=Tn(F,6);j.__click=[nde,s];var G=Tn(j,6);G.__click=y;var K=Un(G);RB(K,()=>"Data1<=>Data2");var b=Tn(G,6);b.__click=C;var R=Tn(D,2),S=Tn(Un(R),2);uD(()=>{M.disabled=Le(h),B.disabled=Le(h),Z.disabled=Le(h),be.disabled=Le(h),A.disabled=Le(l)=="comm",F.disabled=Le(h),j.disabled=Le(h),G.disabled=Le(h),b.disabled=Le(h)}),qM(U,()=>Le(u),O=>Mt(u,O)),Of(n,[],te,()=>Le(a),O=>Mt(a,O)),Of(n,[],ct,()=>Le(a),O=>Mt(a,O)),Of(r,[],jt,()=>Le(l),O=>Mt(l,O)),Of(r,[],m,()=>Le(l),O=>Mt(l,O)),qM(A,()=>Le(c),O=>Mt(c,O)),EB(S,()=>Le(s),O=>Mt(s,O)),CB(t,p),JN()}wB(["click"]);yB(ude,{target:document.body})});export default cde();
