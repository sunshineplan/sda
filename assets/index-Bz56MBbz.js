var GM=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var $2=GM((K2,Pu)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const CE=!1;var SE=Array.isArray,KM=Array.prototype.indexOf,XM=Array.from,Fg=Object.defineProperty,xa=Object.getOwnPropertyDescriptor,ZM=Object.prototype,JM=Array.prototype,QM=Object.getPrototypeOf,Gw=Object.isExtensible;function eI(t){for(var e=0;e<t.length;e++)t[e]()}function RE(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const zt=2,EE=4,Om=8,Eo=16,ki=32,To=64,Mm=128,Lr=256,xu=512,Bt=1024,Fr=2048,Li=4096,Ss=8192,Ps=16384,Im=32768,TE=65536,Kw=1<<17,tI=1<<18,xs=1<<19,rI=1<<20,Vg=1<<21,Qu=1<<22,go=1<<23,Ha=Symbol("$state"),us=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function nI(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function iI(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function oI(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function sI(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function aI(t){throw new Error("https://svelte.dev/e/effect_orphan")}function lI(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function uI(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function cI(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function hI(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function dI(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const fI=2,Ot=Symbol();function gI(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function _E(t){return t===this.v}let mI=!1,Cr=null;function Rs(t){Cr=t}function OE(t,e=!1,r){Cr={p:Cr,c:null,e:null,s:t,x:null,l:null}}function ME(t){var e=Cr,r=e.e;if(r!==null){e.e=null;for(var n of r)$E(n)}return Cr=e.p,{}}function IE(){return!0}let uo=[];function PE(){var t=uo;uo=[],eI(t)}function vo(t){if(uo.length===0&&!Aa){var e=uo;queueMicrotask(()=>{e===uo&&PE()})}uo.push(t)}function pI(){for(;uo.length>0;)PE()}const wI=new WeakMap;function xE(t){var e=we;if(e===null)return ge.f|=go,t;if((e.f&Im)===0){if((e.f&Mm)===0)throw!e.parent&&t instanceof Error&&HE(t),t;e.b.error(t)}else Es(t,e)}function Es(t,e){for(;e!==null;){if((e.f&Mm)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t instanceof Error&&HE(t),t}function HE(t){const e=wI.get(t);e&&(Fg(t,"message",{value:e.message}),Fg(t,"stack",{value:e.stack}))}const bl=new Set;let Ze=null,mu=null,on=null,Wg=new Set,En=[],ec=null,Bg=!1,Aa=!1;class On{current=new Map;#n=new Map;#r=new Set;#d=0;#o=null;#l=[];#i=[];#t=[];#e=[];#s=[];#u=[];skipped_effects=new Set;process(e){En=[],mu=null,this.apply();for(const o of e)this.#c(o);if(this.#d===0){var r=on;this.#h();var n=this.#i,i=this.#t;this.#i=[],this.#t=[],this.#e=[],mu=this,Ze=null,on=r,Xw(n),Xw(i),mu=null,this.#o?.resolve()}else this.#a(this.#i),this.#a(this.#t),this.#a(this.#e);on=null;for(const o of this.#l)ja(o);this.#l=[]}#c(e){e.f^=Bt;for(var r=e.first;r!==null;){var n=r.f,i=(n&(ki|To))!==0,o=i&&(n&Bt)!==0,s=o||(n&Ss)!==0||this.skipped_effects.has(r);if(!s&&r.fn!==null){i?r.f^=Bt:(n&EE)!==0?this.#t.push(r):(n&Bt)===0&&((n&Qu)!==0&&r.b?.is_pending()?this.#l.push(r):oc(r)&&((r.f&Eo)!==0&&this.#e.push(r),ja(r)));var a=r.first;if(a!==null){r=a;continue}}var l=r.parent;for(r=r.next;r===null&&l!==null;)r=l.next,l=l.parent}}#a(e){for(const r of e)((r.f&Fr)!==0?this.#s:this.#u).push(r),sr(r,Bt);e.length=0}capture(e,r){this.#n.has(e)||this.#n.set(e,r),this.current.set(e,e.v),on?.set(e,e.v)}activate(){Ze=this}deactivate(){Ze=null,on=null}flush(){if(En.length>0){if(this.activate(),AE(),Ze!==null&&Ze!==this)return}else this.#d===0&&this.#h();this.deactivate();for(const e of Wg)if(Wg.delete(e),e(),Ze!==null)break}#h(){for(const e of this.#r)e();if(this.#r.clear(),bl.size>1){this.#n.clear();let e=!0;for(const r of bl){if(r===this){e=!1;continue}const n=[];for(const[o,s]of this.current){if(r.current.has(o))if(e&&s!==r.current.get(o))r.current.set(o,s);else continue;n.push(o)}if(n.length===0)continue;const i=[...r.current.keys()].filter(o=>!this.current.has(o));if(i.length>0){for(const o of n)DE(o,i);if(En.length>0){Ze=r,r.apply();for(const o of En)r.#c(o);En=[],r.deactivate()}}}Ze=null}bl.delete(this)}increment(){this.#d+=1}decrement(){this.#d-=1;for(const e of this.#s)sr(e,Fr),Ts(e);for(const e of this.#u)sr(e,Li),Ts(e);this.flush()}add_callback(e){this.#r.add(e)}settled(){return(this.#o??=RE()).promise}static ensure(){if(Ze===null){const e=Ze=new On;bl.add(Ze),Aa||On.enqueue(()=>{Ze===e&&e.flush()})}return Ze}static enqueue(e){vo(e)}apply(){}}function vI(t){var e=Aa;Aa=!0;try{for(var r;;){if(pI(),En.length===0&&(Ze?.flush(),En.length===0))return ec=null,r;AE()}}finally{Aa=e}}function AE(){var t=gs;Bg=!0;try{var e=0;for(Qw(!0);En.length>0;){var r=On.ensure();if(e++>1e3){var n,i;yI()}r.process(En),xi.clear()}}finally{Bg=!1,Qw(t),ec=null}}function yI(){try{lI()}catch(t){Es(t,ec)}}let oo=null;function Xw(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(Ps|Ss))===0&&oc(n)&&(oo=[],ja(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?qE(n):n.fn=null),oo?.length>0)){xi.clear();for(const i of oo)ja(i);oo=[]}}oo=null}}function DE(t,e){if(t.reactions!==null)for(const r of t.reactions){const n=r.f;(n&zt)!==0?DE(r,e):(n&(Qu|Eo))!==0&&NE(r,e)&&(sr(r,Fr),Ts(r))}}function NE(t,e){if(t.deps!==null){for(const r of t.deps)if(e.includes(r)||(r.f&zt)!==0&&NE(r,e))return!0}return!1}function Ts(t){for(var e=ec=t;e.parent!==null;){e=e.parent;var r=e.f;if(Bg&&e===we&&(r&Eo)!==0)return;if((r&(To|ki))!==0){if((r&Bt)===0)return;e.f^=Bt}}En.push(e)}function bI(t){let e=0,r=tc(0),n;return()=>{LI()&&(oe(r),ic(()=>(e===0&&(n=sc(()=>t(()=>Da(r)))),e+=1,()=>{vo(()=>{e-=1,e===0&&(n?.(),n=void 0,Da(r))})})))}}var CI=TE|xs|Mm;function SI(t,e,r){new RI(t,e,r)}class RI{parent;#n=!1;#r;#d=null;#o;#l;#i;#t=null;#e=null;#s=null;#u=null;#c=0;#a=0;#h=!1;#f=null;#w=()=>{this.#f&&Hu(this.#f,this.#c)};#v=bI(()=>(this.#f=tc(this.#c),()=>{this.#f=null}));constructor(e,r,n){this.#r=e,this.#o=r,this.#l=n,this.parent=we.b,this.#n=!!this.#o.pending,this.#i=BI(()=>{we.b=this;{try{this.#t=ji(()=>n(this.#r))}catch(i){this.error(i)}this.#a>0?this.#m():this.#n=!1}},CI)}#y(){try{this.#t=ji(()=>this.#l(this.#r))}catch(e){this.error(e)}this.#n=!1}#b(){const e=this.#o.pending;e&&(this.#e=ji(()=>e(this.#r)),On.enqueue(()=>{this.#t=this.#g(()=>(On.ensure(),ji(()=>this.#l(this.#r)))),this.#a>0?this.#m():(pu(this.#e,()=>{this.#e=null}),this.#n=!1)}))}is_pending(){return this.#n||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#o.pending}#g(e){var r=we,n=ge,i=Cr;In(this.#i),or(this.#i),Rs(this.#i.ctx);try{return e()}catch(o){return xE(o),null}finally{In(r),or(n),Rs(i)}}#m(){const e=this.#o.pending;this.#t!==null&&(this.#u=document.createDocumentFragment(),EI(this.#t,this.#u)),this.#e===null&&(this.#e=ji(()=>e(this.#r)))}#p(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#p(e);return}this.#a+=e,this.#a===0&&(this.#n=!1,this.#e&&pu(this.#e,()=>{this.#e=null}),this.#u&&(this.#r.before(this.#u),this.#u=null),vo(()=>{On.ensure().flush()}))}update_pending_count(e){this.#p(e),this.#c+=e,Wg.add(this.#w)}get_effect_pending(){return this.#v(),oe(this.#f)}error(e){var r=this.#o.onerror;let n=this.#o.failed;if(this.#h||!r&&!n)throw e;this.#t&&(Mn(this.#t),this.#t=null),this.#e&&(Mn(this.#e),this.#e=null),this.#s&&(Mn(this.#s),this.#s=null);var i=!1,o=!1;const s=()=>{if(i){gI();return}i=!0,o&&dI(),On.ensure(),this.#c=0,this.#s!==null&&pu(this.#s,()=>{this.#s=null}),this.#n=this.has_pending_snippet(),this.#t=this.#g(()=>(this.#h=!1,ji(()=>this.#l(this.#r)))),this.#a>0?this.#m():this.#n=!1};var a=ge;try{or(null),o=!0,r?.(e,s),o=!1}catch(l){Es(l,this.#i&&this.#i.parent)}finally{or(a)}n&&vo(()=>{this.#s=this.#g(()=>{this.#h=!0;try{return ji(()=>{n(this.#r,()=>e,()=>s)})}catch(l){return Es(l,this.#i.parent),null}finally{this.#h=!1}})})}}function EI(t,e){for(var r=t.nodes_start,n=t.nodes_end;r!==null;){var i=r===n?null:rc(r);e.append(r),r=i}}function TI(t,e,r){const n=OI;if(e.length===0){r(t.map(n));return}var i=Ze,o=we,s=_I();Promise.all(e.map(a=>MI(a))).then(a=>{s();try{r([...t.map(n),...a])}catch(l){(o.f&Ps)===0&&Es(l,o)}i?.deactivate(),$g()}).catch(a=>{Es(a,o)})}function _I(){var t=we,e=ge,r=Cr,n=Ze;return function(){In(t),or(e),Rs(r),n?.activate()}}function $g(){In(null),or(null),Rs(null)}function OI(t){var e=zt|Fr,r=ge!==null&&(ge.f&zt)!==0?ge:null;return we===null||r!==null&&(r.f&Lr)!==0?e|=Lr:we.f|=xs,{ctx:Cr,deps:null,effects:null,equals:_E,f:e,fn:t,reactions:null,rv:0,v:Ot,wv:0,parent:r??we,ac:null}}function MI(t,e){let r=we;r===null&&iI();var n=r.b,i=void 0,o=tc(Ot),s=!ge,a=new Map;return WI(()=>{var l=RE();i=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then($g)}catch(d){l.reject(d),$g()}var u=Ze,c=n.is_pending();s&&(n.update_pending_count(1),c||(u.increment(),a.get(u)?.reject(us),a.delete(u),a.set(u,l)));const h=(d,g=void 0)=>{if(c||u.activate(),g)g!==us&&(o.f|=go,Hu(o,g));else{(o.f&go)!==0&&(o.f^=go),Hu(o,d);for(const[w,v]of a){if(a.delete(w),w===u)break;v.reject(us)}}s&&(n.update_pending_count(-1),c||u.decrement())};l.promise.then(h,d=>h(null,d||"unknown"))}),Hm(()=>{for(const l of a.values())l.reject(us)}),new Promise(l=>{function u(c){function h(){c===i?l(o):u(i)}c.then(h,h)}u(i)})}function kE(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Mn(e[r])}}function II(t){for(var e=t.parent;e!==null;){if((e.f&zt)===0)return e;e=e.parent}return null}function Pm(t){var e,r=we;In(II(t));try{kE(t),e=JE(t)}finally{In(r)}return e}function LE(t){var e=Pm(t);if(t.equals(e)||(t.v=e,t.wv=XE()),!Hs)if(on!==null)on.set(t,t.v);else{var r=(Ti||(t.f&Lr)!==0)&&t.deps!==null?Li:Bt;sr(t,r)}}const xi=new Map;function tc(t,e){var r={f:0,v:t,reactions:null,equals:_E,rv:0,wv:0};return r}function nr(t,e){const r=tc(t);return zI(r),r}function ze(t,e,r=!1){ge!==null&&(!sn||(ge.f&Kw)!==0)&&IE()&&(ge.f&(zt|Eo|Qu|Kw))!==0&&!ti?.includes(t)&&hI();let n=r?Ea(e):e;return Hu(t,n)}function Hu(t,e){if(!t.equals(e)){var r=t.v;Hs?xi.set(t,e):xi.set(t,r),t.v=e;var n=On.ensure();n.capture(t,r),(t.f&zt)!==0&&((t.f&Fr)!==0&&Pm(t),sr(t,(t.f&Lr)===0?Bt:Li)),t.wv=XE(),FE(t,Fr),we!==null&&(we.f&Bt)!==0&&(we.f&(ki|To))===0&&(Ar===null?UI([t]):Ar.push(t))}return e}function Da(t){ze(t,t.v+1)}function FE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&Fr)===0;a&&sr(o,e),(s&zt)!==0?FE(o,Li):a&&((s&Eo)!==0&&oo!==null&&oo.push(o),Ts(o))}}function Ea(t){if(typeof t!="object"||t===null||Ha in t)return t;const e=QM(t);if(e!==ZM&&e!==JM)return t;var r=new Map,n=SE(t),i=nr(0),o=mo,s=a=>{if(mo===o)return a();var l=ge,u=mo;or(null),tv(o);var c=a();return or(l),tv(u),c};return n&&r.set("length",nr(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&uI();var c=r.get(l);return c===void 0?c=s(()=>{var h=nr(u.value);return r.set(l,h),h}):ze(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>nr(Ot));r.set(l,c),Da(i)}}else ze(u,Ot),Da(i);return!0},get(a,l,u){if(l===Ha)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||xa(a,l)?.writable)&&(c=s(()=>{var g=Ea(h?a[l]:Ot),w=nr(g);return w}),r.set(l,c)),c!==void 0){var d=oe(c);return d===Ot?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=oe(c))}else if(u===void 0){var h=r.get(l),d=h?.v;if(h!==void 0&&d!==Ot)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){if(l===Ha)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Ot||Reflect.has(a,l);if(u!==void 0||we!==null&&(!c||xa(a,l)?.writable)){u===void 0&&(u=s(()=>{var d=c?Ea(a[l]):Ot,g=nr(d);return g}),r.set(l,u));var h=oe(u);if(h===Ot)return!1}return c},set(a,l,u,c){var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?ze(w,Ot):g in a&&(w=s(()=>nr(Ot)),r.set(g+"",w))}if(h===void 0)(!d||xa(a,l)?.writable)&&(h=s(()=>nr(void 0)),ze(h,Ea(u)),r.set(l,h));else{d=h.v!==Ot;var v=s(()=>Ea(u));ze(h,v)}var C=Reflect.getOwnPropertyDescriptor(a,l);if(C?.set&&C.set.call(c,u),!d){if(n&&typeof l=="string"){var T=r.get("length"),b=Number(l);Number.isInteger(b)&&b>=T.v&&ze(T,b+1)}Da(i)}return!0},ownKeys(a){oe(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==Ot});for(var[u,c]of r)c.v!==Ot&&!(u in a)&&l.push(u);return l},setPrototypeOf(){cI()}})}function Zw(t){try{if(t!==null&&typeof t=="object"&&Ha in t)return t[Ha]}catch{}return t}function PI(t,e){return Object.is(Zw(t),Zw(e))}var jg,VE,WE,BE;function xI(){if(jg===void 0){jg=window,VE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;WE=xa(e,"firstChild").get,BE=xa(e,"nextSibling").get,Gw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Gw(r)&&(r.__t=void 0)}}function HI(t=""){return document.createTextNode(t)}function co(t){return WE.call(t)}function rc(t){return BE.call(t)}function Dt(t,e){return co(t)}function AI(t,e=!1){{var r=co(t);return r instanceof Comment&&r.data===""?rc(r):r}}function Ct(t,e=1,r=!1){let n=t;for(;e--;)n=rc(n);return n}let Jw=!1;function DI(){Jw||(Jw=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function nc(t){var e=ge,r=we;or(null),In(null);try{return t()}finally{or(e),In(r)}}function xm(t,e,r,n=r){t.addEventListener(e,()=>nc(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),DI()}function NI(t){we===null&&ge===null&&aI(),ge!==null&&(ge.f&Lr)!==0&&we===null&&sI(),Hs&&oI()}function kI(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function Fi(t,e,r,n=!0){var i=we;i!==null&&(i.f&Ss)!==0&&(t|=Ss);var o={ctx:Cr,deps:null,nodes_start:null,nodes_end:null,f:t|Fr,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{ja(o),o.f|=Im}catch(l){throw Mn(o),l}else e!==null&&Ts(o);if(n){var s=o;if(r&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&xs)===0&&(s=s.first),s!==null&&(s.parent=i,i!==null&&kI(s,i),ge!==null&&(ge.f&zt)!==0&&(t&To)===0)){var a=ge;(a.effects??=[]).push(s)}}return o}function LI(){return ge!==null&&!sn}function Hm(t){const e=Fi(Om,null,!1);return sr(e,Bt),e.teardown=t,e}function FI(t){NI();var e=we.f,r=!ge&&(e&ki)!==0&&(e&Im)===0;if(r){var n=Cr;(n.e??=[]).push(t)}else return $E(t)}function $E(t){return Fi(EE|rI,t,!1)}function VI(t){On.ensure();const e=Fi(To|xs,t,!0);return(r={})=>new Promise(n=>{r.outro?pu(e,()=>{Mn(e),n(void 0)}):(Mn(e),n(void 0))})}function WI(t){return Fi(Qu|xs,t,!0)}function ic(t,e=0){return Fi(Om|e,t,!0)}function jE(t,e=[],r=[]){TI(e,r,n=>{Fi(Om,()=>t(...n.map(oe)),!0)})}function BI(t,e=0){var r=Fi(Eo|e,t,!0);return r}function ji(t,e=!0){return Fi(ki|xs,t,!0,e)}function zE(t){var e=t.teardown;if(e!==null){const r=Hs,n=ge;ev(!0),or(null);try{e.call(null)}finally{ev(r),or(n)}}}function UE(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&nc(()=>{i.abort(us)});var n=r.next;(r.f&To)!==0?r.parent=null:Mn(r,e),r=n}}function $I(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&ki)===0&&Mn(e),e=r}}function Mn(t,e=!0){var r=!1;(e||(t.f&tI)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(YE(t.nodes_start,t.nodes_end),r=!0),UE(t,e&&!r),Au(t,0),sr(t,Ps);var n=t.transitions;if(n!==null)for(const o of n)o.stop();zE(t);var i=t.parent;i!==null&&i.first!==null&&qE(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function YE(t,e){for(;t!==null;){var r=t===e?null:rc(t);t.remove(),t=r}}function qE(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function pu(t,e){var r=[];GE(t,r,!0),jI(r,()=>{Mn(t),e&&e()})}function jI(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function GE(t,e,r){if((t.f&Ss)===0){if(t.f^=Ss,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&TE)!==0||(n.f&ki)!==0;GE(n,e,o?r:!1),n=i}}}let gs=!1;function Qw(t){gs=t}let Hs=!1;function ev(t){Hs=t}let ge=null,sn=!1;function or(t){ge=t}let we=null;function In(t){we=t}let ti=null;function zI(t){ge!==null&&(ti===null?ti=[t]:ti.push(t))}let Wt=null,pr=0,Ar=null;function UI(t){Ar=t}let KE=1,$a=0,mo=$a;function tv(t){mo=t}let Ti=!1;function XE(){return++KE}function oc(t){var e=t.f;if((e&Fr)!==0)return!0;if((e&Li)!==0){var r=t.deps,n=(e&Lr)!==0;if(r!==null){var i,o,s=(e&xu)!==0,a=n&&we!==null&&!Ti,l=r.length;if((s||a)&&(we===null||(we.f&Ps)===0)){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!o?.reactions?.includes(u))&&(o.reactions??=[]).push(u);s&&(u.f^=xu),a&&c!==null&&(c.f&Lr)===0&&(u.f^=Lr)}for(i=0;i<l;i++)if(o=r[i],oc(o)&&LE(o),o.wv>t.wv)return!0}(!n||we!==null&&!Ti)&&sr(t,Bt)}return!1}function ZE(t,e,r=!0){var n=t.reactions;if(n!==null&&!ti?.includes(t))for(var i=0;i<n.length;i++){var o=n[i];(o.f&zt)!==0?ZE(o,e,!1):e===o&&(r?sr(o,Fr):(o.f&Bt)!==0&&sr(o,Li),Ts(o))}}function JE(t){var e=Wt,r=pr,n=Ar,i=ge,o=Ti,s=ti,a=Cr,l=sn,u=mo,c=t.f;Wt=null,pr=0,Ar=null,Ti=(c&Lr)!==0&&(sn||!gs||ge===null),ge=(c&(ki|To))===0?t:null,ti=null,Rs(t.ctx),sn=!1,mo=++$a,t.ac!==null&&(nc(()=>{t.ac.abort(us)}),t.ac=null);try{t.f|=Vg;var h=t.fn,d=h(),g=t.deps;if(Wt!==null){var w;if(Au(t,pr),g!==null&&pr>0)for(g.length=pr+Wt.length,w=0;w<Wt.length;w++)g[pr+w]=Wt[w];else t.deps=g=Wt;if(!Ti||(c&zt)!==0&&t.reactions!==null)for(w=pr;w<g.length;w++)(g[w].reactions??=[]).push(t)}else g!==null&&pr<g.length&&(Au(t,pr),g.length=pr);if(IE()&&Ar!==null&&!sn&&g!==null&&(t.f&(zt|Li|Fr))===0)for(w=0;w<Ar.length;w++)ZE(Ar[w],t);return i!==null&&i!==t&&($a++,Ar!==null&&(n===null?n=Ar:n.push(...Ar))),(t.f&go)!==0&&(t.f^=go),d}catch(v){return xE(v)}finally{t.f^=Vg,Wt=e,pr=r,Ar=n,ge=i,Ti=o,ti=s,Rs(a),sn=l,mo=u}}function YI(t,e){let r=e.reactions;if(r!==null){var n=KM.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&zt)!==0&&(Wt===null||!Wt.includes(e))&&(sr(e,Li),(e.f&(Lr|xu))===0&&(e.f^=xu),kE(e),Au(e,0))}function Au(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)YI(t,r[n])}function ja(t){var e=t.f;if((e&Ps)===0){sr(t,Bt);var r=we,n=gs;we=t,gs=!0;try{(e&Eo)!==0?$I(t):UE(t),zE(t);var i=JE(t);t.teardown=typeof i=="function"?i:null,t.wv=KE;var o;CE&&mI&&(t.f&Fr)!==0&&t.deps}finally{gs=n,we=r}}}async function qI(){await Promise.resolve(),vI()}function oe(t){var e=t.f,r=(e&zt)!==0;if(ge!==null&&!sn){var n=we!==null&&(we.f&Ps)!==0;if(!n&&!ti?.includes(t)){var i=ge.deps;if((ge.f&Vg)!==0)t.rv<$a&&(t.rv=$a,Wt===null&&i!==null&&i[pr]===t?pr++:Wt===null?Wt=[t]:(!Ti||!Wt.includes(t))&&Wt.push(t));else{(ge.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[ge]:o.includes(ge)||o.push(ge)}}}else if(r&&t.deps===null&&t.effects===null){var s=t,a=s.parent;a!==null&&(a.f&Lr)===0&&(s.f^=Lr)}if(Hs){if(xi.has(t))return xi.get(t);if(r){s=t;var l=s.v;return((s.f&Bt)===0&&s.reactions!==null||QE(s))&&(l=Pm(s)),xi.set(s,l),l}}else if(r){if(s=t,on?.has(s))return on.get(s);oc(s)&&LE(s)}if(on?.has(t))return on.get(t);if((t.f&go)!==0)throw t.v;return t.v}function QE(t){if(t.v===Ot)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xi.has(e)||(e.f&zt)!==0&&QE(e))return!0;return!1}function sc(t){var e=sn;try{return sn=!0,t()}finally{sn=e}}const GI=-7169;function sr(t,e){t.f=t.f&GI|e}const KI=["touchstart","touchmove"];function XI(t){return KI.includes(t)}const eT=new Set,zg=new Set;function ZI(t,e,r,n={}){function i(o){if(n.capture||Ta.call(e,o),!o.cancelBubble)return nc(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?vo(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function JI(t,e,r,n,i){var o={capture:n,passive:i},s=ZI(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Hm(()=>{e.removeEventListener(t,s,o)})}function QI(t){for(var e=0;e<t.length;e++)eT.add(t[e]);for(var r of zg)r(t)}let rv=null;function Ta(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;rv=t;var s=0,a=rv===t&&t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){Fg(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=ge,h=we;or(null),In(null);try{for(var d,g=[];o!==null;){var w=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+n];if(v!=null&&(!o.disabled||t.target===o))if(SE(v)){var[C,...T]=v;C.apply(o,[t,...T])}else v.call(o,t)}catch(b){d?g.push(b):d=b}if(t.cancelBubble||w===e||w===null)break;o=w}if(d){for(let b of g)queueMicrotask(()=>{throw b});throw d}}finally{t.__root=e,delete t.currentTarget,or(c),In(h)}}}function tT(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function rT(t,e){var r=we;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function eP(t,e){var r=(e&fI)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=tT(i?t:"<!>"+t));var o=r||VE?document.importNode(n,!0):n.cloneNode(!0);{var s=co(o),a=o.lastChild;rT(s,a)}return o}}function tP(t,e){t!==null&&t.before(e)}function rP(t,e){return nP(t,e)}const Vo=new Map;function nP(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){xI();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var w=XI(g);e.addEventListener(g,Ta,{passive:w});var v=Vo.get(g);v===void 0?(document.addEventListener(g,Ta,{passive:w}),Vo.set(g,1)):Vo.set(g,v+1)}}};l(XM(eT)),zg.add(l);var u=void 0,c=VI(()=>{var h=r??e.appendChild(HI());return SI(h,{pending:()=>{}},d=>{if(o){OE({});var g=Cr;g.c=o}i&&(n.$$events=i),u=t(d,n)||{},o&&ME()}),()=>{for(var d of a){e.removeEventListener(d,Ta);var g=Vo.get(d);--g===0?(document.removeEventListener(d,Ta),Vo.delete(d)):Vo.set(d,g)}zg.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return iP.set(u,c),u}let iP=new WeakMap;function oP(t,e,r=!1,n=!1,i=!1){var o=t,s="";jE(()=>{var a=we;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(YE(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=tT(l);if((r||n)&&(u=co(u)),rT(co(u),u.lastChild),r||n)for(;co(u);)o.before(co(u));else o.before(u)}})}function sP(t,e,r=e){var n=new WeakSet;xm(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Jc(t)?Qc(o):o,r(o),Ze!==null&&n.add(Ze),await qI(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd,l=t.value.length;if(t.value=o??"",a!==null){var u=t.value.length;s===a&&a===l&&u>l?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=s,t.selectionEnd=Math.min(a,u))}}}),sc(e)==null&&t.value&&(r(Jc(t)?Qc(t.value):t.value),Ze!==null&&n.add(Ze)),ic(()=>{var i=e();if(t===document.activeElement){var o=mu??Ze;if(n.has(o))return}Jc(t)&&i===Qc(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}const Zc=new Set;function Cl(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??=[];s.push(r),xm(r,"change",()=>{var l=r.__value;o&&(l=aP(s,l,r.checked)),i(l)},()=>i(o?[]:null)),ic(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=PI(r.__value,l)}),Hm(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),Zc.has(s)||(Zc.add(s),vo(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Zc.delete(s)})),vo(()=>{})}function nv(t,e,r=e){xm(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),sc(e)==null&&r(t.checked),ic(()=>{var n=e();t.checked=!!n})}function aP(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function Jc(t){var e=t.type;return e==="number"||e==="range"}function Qc(t){return t===""?null:+t}function lP(t){Cr===null&&nI(),FI(()=>{const e=sc(t);if(typeof e=="function")return e})}const uP="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(uP);var iv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ov={},zs,sv;function it(){if(sv)return zs;sv=1;var t=function(e){return e&&e.Math===Math&&e};return zs=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof iv=="object"&&iv)||t(typeof zs=="object"&&zs)||function(){return this}()||Function("return this")(),zs}var eh={},th,av;function ct(){return av||(av=1,th=function(t){try{return!!t()}catch{return!0}}),th}var rh,lv;function $r(){if(lv)return rh;lv=1;var t=ct();return rh=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),rh}var nh,uv;function ac(){if(uv)return nh;uv=1;var t=ct();return nh=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),nh}var ih,cv;function wt(){if(cv)return ih;cv=1;var t=ac(),e=Function.prototype.call;return ih=t?e.bind(e):function(){return e.apply(e,arguments)},ih}var oh={},hv;function cP(){if(hv)return oh;hv=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return oh.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,oh}var sh,dv;function lc(){return dv||(dv=1,sh=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),sh}var ah,fv;function ot(){if(fv)return ah;fv=1;var t=ac(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return ah=t?n:function(i){return function(){return r.apply(i,arguments)}},ah}var lh,gv;function _o(){if(gv)return lh;gv=1;var t=ot(),e=t({}.toString),r=t("".slice);return lh=function(n){return r(e(n),8,-1)},lh}var uh,mv;function hP(){if(mv)return uh;mv=1;var t=ot(),e=ct(),r=_o(),n=Object,i=t("".split);return uh=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,uh}var ch,pv;function Am(){return pv||(pv=1,ch=function(t){return t==null}),ch}var hh,wv;function Qa(){if(wv)return hh;wv=1;var t=Am(),e=TypeError;return hh=function(r){if(t(r))throw new e("Can't call method on "+r);return r},hh}var dh,vv;function el(){if(vv)return dh;vv=1;var t=hP(),e=Qa();return dh=function(r){return t(e(r))},dh}var fh,yv;function ht(){if(yv)return fh;yv=1;var t=typeof document=="object"&&document.all;return fh=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},fh}var gh,bv;function jr(){if(bv)return gh;bv=1;var t=ht();return gh=function(e){return typeof e=="object"?e!==null:t(e)},gh}var mh,Cv;function As(){if(Cv)return mh;Cv=1;var t=it(),e=ht(),r=function(n){return e(n)?n:void 0};return mh=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},mh}var ph,Sv;function tl(){if(Sv)return ph;Sv=1;var t=ot();return ph=t({}.isPrototypeOf),ph}var wh,Rv;function uc(){if(Rv)return wh;Rv=1;var t=it(),e=t.navigator,r=e&&e.userAgent;return wh=r?String(r):"",wh}var vh,Ev;function dP(){if(Ev)return vh;Ev=1;var t=it(),e=uc(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),vh=a,vh}var yh,Tv;function Dm(){if(Tv)return yh;Tv=1;var t=dP(),e=ct(),r=it(),n=r.String;return yh=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),yh}var bh,_v;function nT(){if(_v)return bh;_v=1;var t=Dm();return bh=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",bh}var Ch,Ov;function Nm(){if(Ov)return Ch;Ov=1;var t=As(),e=ht(),r=tl(),n=nT(),i=Object;return Ch=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Ch}var Sh,Mv;function cc(){if(Mv)return Sh;Mv=1;var t=String;return Sh=function(e){try{return t(e)}catch{return"Object"}},Sh}var Rh,Iv;function Rr(){if(Iv)return Rh;Iv=1;var t=ht(),e=cc(),r=TypeError;return Rh=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},Rh}var Eh,Pv;function rl(){if(Pv)return Eh;Pv=1;var t=Rr(),e=Am();return Eh=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Eh}var Th,xv;function fP(){if(xv)return Th;xv=1;var t=wt(),e=ht(),r=jr(),n=TypeError;return Th=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},Th}var _h={exports:{}},Oh,Hv;function Oo(){return Hv||(Hv=1,Oh=!1),Oh}var Mh,Av;function km(){if(Av)return Mh;Av=1;var t=it(),e=Object.defineProperty;return Mh=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Mh}var Dv;function Lm(){if(Dv)return _h.exports;Dv=1;var t=Oo(),e=it(),r=km(),n="__core-js_shared__",i=_h.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),_h.exports}var Ih,Nv;function iT(){if(Nv)return Ih;Nv=1;var t=Lm();return Ih=function(e,r){return t[e]||(t[e]=r||{})},Ih}var Ph,kv;function Ds(){if(kv)return Ph;kv=1;var t=Qa(),e=Object;return Ph=function(r){return e(t(r))},Ph}var xh,Lv;function zr(){if(Lv)return xh;Lv=1;var t=ot(),e=Ds(),r=t({}.hasOwnProperty);return xh=Object.hasOwn||function(i,o){return r(e(i),o)},xh}var Hh,Fv;function oT(){if(Fv)return Hh;Fv=1;var t=ot(),e=0,r=Math.random(),n=t(1.1.toString);return Hh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Hh}var Ah,Vv;function cn(){if(Vv)return Ah;Vv=1;var t=it(),e=iT(),r=zr(),n=oT(),i=Dm(),o=nT(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Ah=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Ah}var Dh,Wv;function gP(){if(Wv)return Dh;Wv=1;var t=wt(),e=jr(),r=Nm(),n=rl(),i=fP(),o=cn(),s=TypeError,a=o("toPrimitive");return Dh=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Dh}var Nh,Bv;function sT(){if(Bv)return Nh;Bv=1;var t=gP(),e=Nm();return Nh=function(r){var n=t(r,"string");return e(n)?n:n+""},Nh}var kh,$v;function Fm(){if($v)return kh;$v=1;var t=it(),e=jr(),r=t.document,n=e(r)&&e(r.createElement);return kh=function(i){return n?r.createElement(i):{}},kh}var Lh,jv;function aT(){if(jv)return Lh;jv=1;var t=$r(),e=ct(),r=Fm();return Lh=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Lh}var zv;function lT(){if(zv)return eh;zv=1;var t=$r(),e=wt(),r=cP(),n=lc(),i=el(),o=sT(),s=zr(),a=aT(),l=Object.getOwnPropertyDescriptor;return eh.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},eh}var Fh={},Vh,Uv;function uT(){if(Uv)return Vh;Uv=1;var t=$r(),e=ct();return Vh=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Vh}var Wh,Yv;function vt(){if(Yv)return Wh;Yv=1;var t=jr(),e=String,r=TypeError;return Wh=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},Wh}var qv;function Vi(){if(qv)return Fh;qv=1;var t=$r(),e=aT(),r=uT(),n=vt(),i=sT(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Fh.f=t?r?function(d,g,w){if(n(d),g=i(g),n(w),typeof d=="function"&&g==="prototype"&&"value"in w&&c in w&&!w[c]){var v=a(d,g);v&&v[c]&&(d[g]=w.value,w={configurable:u in w?w[u]:v[u],enumerable:l in w?w[l]:v[l],writable:!1})}return s(d,g,w)}:s:function(d,g,w){if(n(d),g=i(g),n(w),e)try{return s(d,g,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(d[g]=w.value),d},Fh}var Bh,Gv;function Ns(){if(Gv)return Bh;Gv=1;var t=$r(),e=Vi(),r=lc();return Bh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},Bh}var $h={exports:{}},jh,Kv;function mP(){if(Kv)return jh;Kv=1;var t=$r(),e=zr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return jh={EXISTS:i,PROPER:o,CONFIGURABLE:s},jh}var zh,Xv;function pP(){if(Xv)return zh;Xv=1;var t=ot(),e=ht(),r=Lm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),zh=r.inspectSource,zh}var Uh,Zv;function wP(){if(Zv)return Uh;Zv=1;var t=it(),e=ht(),r=t.WeakMap;return Uh=e(r)&&/native code/.test(String(r)),Uh}var Yh,Jv;function Vm(){if(Jv)return Yh;Jv=1;var t=iT(),e=oT(),r=t("keys");return Yh=function(n){return r[n]||(r[n]=e(n))},Yh}var qh,Qv;function Wm(){return Qv||(Qv=1,qh={}),qh}var Gh,ey;function cT(){if(ey)return Gh;ey=1;var t=wP(),e=it(),r=jr(),n=Ns(),i=zr(),o=Lm(),s=Vm(),a=Wm(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,w=function(b){return g(b)?d(b):h(b,{})},v=function(b){return function(E){var y;if(!r(E)||(y=d(E)).type!==b)throw new u("Incompatible receiver, "+b+" required");return y}};if(t||o.state){var C=o.state||(o.state=new c);C.get=C.get,C.has=C.has,C.set=C.set,h=function(b,E){if(C.has(b))throw new u(l);return E.facade=b,C.set(b,E),E},d=function(b){return C.get(b)||{}},g=function(b){return C.has(b)}}else{var T=s("state");a[T]=!0,h=function(b,E){if(i(b,T))throw new u(l);return E.facade=b,n(b,T,E),E},d=function(b){return i(b,T)?b[T]:{}},g=function(b){return i(b,T)}}return Gh={set:h,get:d,has:g,enforce:w,getterFor:v},Gh}var ty;function hT(){if(ty)return $h.exports;ty=1;var t=ot(),e=ct(),r=ht(),n=zr(),i=$r(),o=mP().CONFIGURABLE,s=pP(),a=cT(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),w=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),C=String(String).split("String"),T=$h.exports=function(b,E,y){d(c(E),0,7)==="Symbol("&&(E="["+g(c(E),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),y&&y.getter&&(E="get "+E),y&&y.setter&&(E="set "+E),(!n(b,"name")||o&&b.name!==E)&&(i?h(b,"name",{value:E,configurable:!0}):b.name=E),v&&y&&n(y,"arity")&&b.length!==y.arity&&h(b,"length",{value:y.arity});try{y&&n(y,"constructor")&&y.constructor?i&&h(b,"prototype",{writable:!1}):b.prototype&&(b.prototype=void 0)}catch{}var I=l(b);return n(I,"source")||(I.source=w(C,typeof E=="string"?E:"")),b};return Function.prototype.toString=T(function(){return r(this)&&u(this).source||s(this)},"toString"),$h.exports}var Kh,ry;function Bm(){if(ry)return Kh;ry=1;var t=ht(),e=Vi(),r=hT(),n=km();return Kh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Kh}var Xh={},Zh,ny;function vP(){if(ny)return Zh;ny=1;var t=Math.ceil,e=Math.floor;return Zh=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},Zh}var Jh,iy;function nl(){if(iy)return Jh;iy=1;var t=vP();return Jh=function(e){var r=+e;return r!==r||r===0?0:t(r)},Jh}var Qh,oy;function yP(){if(oy)return Qh;oy=1;var t=nl(),e=Math.max,r=Math.min;return Qh=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},Qh}var ed,sy;function bP(){if(sy)return ed;sy=1;var t=nl(),e=Math.min;return ed=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},ed}var td,ay;function ks(){if(ay)return td;ay=1;var t=bP();return td=function(e){return t(e.length)},td}var rd,ly;function CP(){if(ly)return rd;ly=1;var t=el(),e=yP(),r=ks(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return rd={includes:n(!0),indexOf:n(!1)},rd}var nd,uy;function dT(){if(uy)return nd;uy=1;var t=ot(),e=zr(),r=el(),n=CP().indexOf,i=Wm(),o=t([].push);return nd=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},nd}var id,cy;function $m(){return cy||(cy=1,id=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),id}var hy;function SP(){if(hy)return Xh;hy=1;var t=dT(),e=$m(),r=e.concat("length","prototype");return Xh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},Xh}var od={},dy;function RP(){return dy||(dy=1,od.f=Object.getOwnPropertySymbols),od}var sd,fy;function EP(){if(fy)return sd;fy=1;var t=As(),e=ot(),r=SP(),n=RP(),i=vt(),o=e([].concat);return sd=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},sd}var ad,gy;function fT(){if(gy)return ad;gy=1;var t=zr(),e=EP(),r=lT(),n=Vi();return ad=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},ad}var ld,my;function TP(){if(my)return ld;my=1;var t=ct(),e=ht(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return ld=n,ld}var ud,py;function Fe(){if(py)return ud;py=1;var t=it(),e=lT().f,r=Ns(),n=Bm(),i=km(),o=fT(),s=TP();return ud=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,w,v,C,T;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(w in l){if(C=l[w],a.dontCallGetSet?(T=e(g,w),v=T&&T.value):v=g[w],d=s(c?w:u+(h?".":"#")+w,a.forced),!d&&v!==void 0){if(typeof C==typeof v)continue;o(C,v)}(a.sham||v&&v.sham)&&r(C,"sham",!0),n(g,w,C,a)}},ud}var cd,wy;function il(){if(wy)return cd;wy=1;var t=ac(),e=Function.prototype,r=e.apply,n=e.call;return cd=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),cd}var hd,vy;function gT(){if(vy)return hd;vy=1;var t=ot(),e=Rr();return hd=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},hd}var dd,yy;function _P(){if(yy)return dd;yy=1;var t=jr();return dd=function(e){return t(e)||e===null},dd}var fd,by;function OP(){if(by)return fd;by=1;var t=_P(),e=String,r=TypeError;return fd=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},fd}var gd,Cy;function mT(){if(Cy)return gd;Cy=1;var t=gT(),e=jr(),r=Qa(),n=OP();return gd=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),gd}var md,Sy;function MP(){if(Sy)return md;Sy=1;var t=Vi().f;return md=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},md}var pd,Ry;function IP(){if(Ry)return pd;Ry=1;var t=ht(),e=jr(),r=mT();return pd=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},pd}var wd,Ey;function PP(){if(Ey)return wd;Ey=1;var t=cn(),e=t("toStringTag"),r={};return r[e]="z",wd=String(r)==="[object z]",wd}var vd,Ty;function pT(){if(Ty)return vd;Ty=1;var t=PP(),e=ht(),r=_o(),n=cn(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return vd=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},vd}var yd,_y;function hc(){if(_y)return yd;_y=1;var t=pT(),e=String;return yd=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},yd}var bd,Oy;function xP(){if(Oy)return bd;Oy=1;var t=hc();return bd=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},bd}var Cd,My;function HP(){if(My)return Cd;My=1;var t=jr(),e=Ns();return Cd=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Cd}var Sd,Iy;function AP(){if(Iy)return Sd;Iy=1;var t=ot(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return Sd=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},Sd}var Rd,Py;function DP(){if(Py)return Rd;Py=1;var t=ct(),e=lc();return Rd=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),Rd}var Ed,xy;function NP(){if(xy)return Ed;xy=1;var t=Ns(),e=AP(),r=DP(),n=Error.captureStackTrace;return Ed=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Ed}var Td,Hy;function kP(){if(Hy)return Td;Hy=1;var t=As(),e=zr(),r=Ns(),n=tl(),i=mT(),o=fT(),s=MP(),a=IP(),l=xP(),u=HP(),c=NP(),h=$r(),d=Oo();return Td=function(g,w,v,C){var T="stackTraceLimit",b=C?2:1,E=g.split("."),y=E[E.length-1],I=t.apply(null,E);if(I){var x=I.prototype;if(!d&&e(x,"cause")&&delete x.cause,!v)return I;var P=t("Error"),A=w(function(F,W){var q=l(C?W:F,void 0),L=C?new I(F):new I;return q!==void 0&&r(L,"message",q),c(L,A,L.stack,2),this&&n(x,this)&&a(L,this,A),arguments.length>b&&u(L,arguments[b]),L});if(A.prototype=x,y!=="Error"?i?i(A,P):o(A,P,{name:!0}):h&&T in I&&(s(A,I,T),s(A,I,"prepareStackTrace")),o(A,I),!d)try{x.name!==y&&r(x,"name",y),x.constructor=A}catch{}return A}},Td}var Ay;function LP(){if(Ay)return ov;Ay=1;var t=Fe(),e=it(),r=il(),n=kP(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),ov}LP();var Dy={},_d,Ny;function wT(){if(Ny)return _d;Ny=1;var t=_o();return _d=Array.isArray||function(r){return t(r)==="Array"},_d}var Od,ky;function vT(){if(ky)return Od;ky=1;var t=$r(),e=wT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Od=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Od}var Md,Ly;function yT(){if(Ly)return Md;Ly=1;var t=TypeError,e=9007199254740991;return Md=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Md}var Fy;function FP(){if(Fy)return Dy;Fy=1;var t=Fe(),e=Ds(),r=ks(),n=vT(),i=yT(),o=ct(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var w=0;w<g;w++)h[d]=arguments[w],d++;return n(h,d),d}}),Dy}FP();var Vy={},Id,Wy;function VP(){if(Wy)return Id;Wy=1;var t=_o(),e=ot();return Id=function(r){if(t(r)==="Function")return e(r)},Id}var Pd,By;function bT(){if(By)return Pd;By=1;var t=VP(),e=Rr(),r=ac(),n=t(t.bind);return Pd=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},Pd}var xd,$y;function CT(){return $y||($y=1,xd={}),xd}var Hd,jy;function WP(){if(jy)return Hd;jy=1;var t=cn(),e=CT(),r=t("iterator"),n=Array.prototype;return Hd=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Hd}var Ad,zy;function ST(){if(zy)return Ad;zy=1;var t=pT(),e=rl(),r=Am(),n=CT(),i=cn(),o=i("iterator");return Ad=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Ad}var Dd,Uy;function BP(){if(Uy)return Dd;Uy=1;var t=wt(),e=Rr(),r=vt(),n=cc(),i=ST(),o=TypeError;return Dd=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Dd}var Nd,Yy;function Er(){if(Yy)return Nd;Yy=1;var t=wt(),e=vt(),r=rl();return Nd=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Nd}var kd,qy;function Ls(){if(qy)return kd;qy=1;var t=bT(),e=wt(),r=vt(),n=cc(),i=WP(),o=ks(),s=tl(),a=BP(),l=ST(),u=Er(),c=TypeError,h=function(g,w){this.stopped=g,this.result=w},d=h.prototype;return kd=function(g,w,v){var C=v&&v.that,T=!!(v&&v.AS_ENTRIES),b=!!(v&&v.IS_RECORD),E=!!(v&&v.IS_ITERATOR),y=!!(v&&v.INTERRUPTED),I=t(w,C),x,P,A,F,W,q,L,ae=function(te){return x&&u(x,"normal"),new h(!0,te)},K=function(te){return T?(r(te),y?I(te[0],te[1],ae):I(te[0],te[1])):y?I(te,ae):I(te)};if(b)x=g.iterator;else if(E)x=g;else{if(P=l(g),!P)throw new c(n(g)+" is not iterable");if(i(P)){for(A=0,F=o(g);F>A;A++)if(W=K(g[A]),W&&s(d,W))return W;return new h(!1)}x=a(g,P)}for(q=b?g.next:x.next;!(L=e(q,x)).done;){try{W=K(L.value)}catch(te){u(x,"throw",te)}if(typeof W=="object"&&W&&s(d,W))return W}return new h(!1)},kd}var Ld,Gy;function RT(){if(Gy)return Ld;Gy=1;var t=$r(),e=Vi(),r=lc();return Ld=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Ld}var Ky;function $P(){if(Ky)return Vy;Ky=1;var t=Fe(),e=Ls(),r=RT();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),Vy}$P();var Xy={},Fd,Zy;function Hn(){if(Zy)return Fd;Zy=1;var t=ot(),e=Set.prototype;return Fd={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Fd}var Vd,Jy;function Mo(){if(Jy)return Vd;Jy=1;var t=Hn().has;return Vd=function(e){return t(e),e},Vd}var Wd,Qy;function Io(){if(Qy)return Wd;Qy=1;var t=wt();return Wd=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},Wd}var Bd,eb;function ol(){if(eb)return Bd;eb=1;var t=ot(),e=Io(),r=Hn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return Bd=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Bd}var $d,tb;function jm(){if(tb)return $d;tb=1;var t=Hn(),e=ol(),r=t.Set,n=t.add;return $d=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},$d}var jd,rb;function sl(){if(rb)return jd;rb=1;var t=gT(),e=Hn();return jd=t(e.proto,"size","get")||function(r){return r.size},jd}var zd,nb;function Wi(){return nb||(nb=1,zd=function(t){return{iterator:t,next:t.next,done:!1}}),zd}var Ud,ib;function Po(){if(ib)return Ud;ib=1;var t=Rr(),e=vt(),r=wt(),n=nl(),i=Wi(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},Ud=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},Ud}var Yd,ob;function jP(){if(ob)return Yd;ob=1;var t=Mo(),e=Hn(),r=jm(),n=sl(),i=Po(),o=ol(),s=Io(),a=e.has,l=e.remove;return Yd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(w){d.includes(w)&&l(g,w)}):s(d.getIterator(),function(w){a(g,w)&&l(g,w)}),g},Yd}var qd,sb;function xo(){if(sb)return qd;sb=1;var t=As(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return qd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},qd}var ab;function zP(){if(ab)return Xy;ab=1;var t=Fe(),e=jP(),r=ct(),n=xo(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),Xy}zP();var lb={},Gd,ub;function UP(){if(ub)return Gd;ub=1;var t=Mo(),e=Hn(),r=sl(),n=Po(),i=ol(),o=Io(),s=e.Set,a=e.add,l=e.has;return Gd=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(w){l(h,w)&&a(g,w)}):i(h,function(w){d.includes(w)&&a(g,w)}),g},Gd}var cb;function YP(){if(cb)return lb;cb=1;var t=Fe(),e=ct(),r=UP(),n=xo(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),lb}YP();var hb={},Kd,db;function qP(){if(db)return Kd;db=1;var t=Mo(),e=Hn().has,r=sl(),n=Po(),i=ol(),o=Io(),s=Er();return Kd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},Kd}var fb;function GP(){if(fb)return hb;fb=1;var t=Fe(),e=qP(),r=xo(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),hb}GP();var gb={},Xd,mb;function KP(){if(mb)return Xd;mb=1;var t=Mo(),e=sl(),r=ol(),n=Po();return Xd=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Xd}var pb;function XP(){if(pb)return gb;pb=1;var t=Fe(),e=KP(),r=xo(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),gb}XP();var wb={},Zd,vb;function ZP(){if(vb)return Zd;vb=1;var t=Mo(),e=Hn().has,r=sl(),n=Po(),i=Io(),o=Er();return Zd=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Zd}var yb;function JP(){if(yb)return wb;yb=1;var t=Fe(),e=ZP(),r=xo(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),wb}JP();var bb={},Jd,Cb;function QP(){if(Cb)return Jd;Cb=1;var t=Mo(),e=Hn(),r=jm(),n=Po(),i=Io(),o=e.add,s=e.has,a=e.remove;return Jd=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},Jd}var Qd,Sb;function ET(){return Sb||(Sb=1,Qd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),Qd}var Rb;function ex(){if(Rb)return bb;Rb=1;var t=Fe(),e=QP(),r=ET(),n=xo(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),bb}ex();var Eb={},ef,Tb;function tx(){if(Tb)return ef;Tb=1;var t=Mo(),e=Hn().add,r=jm(),n=Po(),i=Io();return ef=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},ef}var _b;function rx(){if(_b)return Eb;_b=1;var t=Fe(),e=tx(),r=ET(),n=xo(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),Eb}rx();var Ob={},Mb={},tf,Ib;function nx(){if(Ib)return tf;Ib=1;var t=tl(),e=TypeError;return tf=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},tf}var rf,Pb;function ix(){if(Pb)return rf;Pb=1;var t=ct();return rf=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),rf}var nf,xb;function TT(){if(xb)return nf;xb=1;var t=zr(),e=ht(),r=Ds(),n=Vm(),i=ix(),o=n("IE_PROTO"),s=Object,a=s.prototype;return nf=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},nf}var of,Hb;function ox(){if(Hb)return of;Hb=1;var t=hT(),e=Vi();return of=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},of}var sf={},af,Ab;function sx(){if(Ab)return af;Ab=1;var t=dT(),e=$m();return af=Object.keys||function(n){return t(n,e)},af}var Db;function ax(){if(Db)return sf;Db=1;var t=$r(),e=uT(),r=Vi(),n=vt(),i=el(),o=sx();return sf.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},sf}var lf,Nb;function _T(){if(Nb)return lf;Nb=1;var t=As();return lf=t("document","documentElement"),lf}var uf,kb;function zm(){if(kb)return uf;kb=1;var t=vt(),e=ax(),r=$m(),n=Wm(),i=_T(),o=Fm(),s=Vm(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(b){return l+c+a+b+l+"/"+c+a},w=function(b){b.write(g("")),b.close();var E=b.parentWindow.Object;return b=null,E},v=function(){var b=o("iframe"),E="java"+c+":",y;return b.style.display="none",i.appendChild(b),b.src=String(E),y=b.contentWindow.document,y.open(),y.write(g("document.F=Object")),y.close(),y.F},C,T=function(){try{C=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&C?w(C):v():w(C);for(var b=r.length;b--;)delete T[u][r[b]];return T()};return n[h]=!0,uf=Object.create||function(E,y){var I;return E!==null?(d[u]=t(E),I=new d,d[u]=null,I[h]=E):I=T(),y===void 0?I:e.f(I,y)},uf}var cf,Lb;function OT(){if(Lb)return cf;Lb=1;var t=ct(),e=ht(),r=jr(),n=zm(),i=TT(),o=Bm(),s=cn(),a=Oo(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),cf={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},cf}var Fb;function lx(){if(Fb)return Mb;Fb=1;var t=Fe(),e=it(),r=nx(),n=vt(),i=ht(),o=TT(),s=ox(),a=RT(),l=ct(),u=zr(),c=cn(),h=OT().IteratorPrototype,d=$r(),g=Oo(),w="constructor",v="Iterator",C=c("toStringTag"),T=TypeError,b=e[v],E=g||!i(b)||b.prototype!==h||!l(function(){b({})}),y=function(){if(r(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},I=function(x,P){d?s(h,x,{configurable:!0,get:function(){return P},set:function(A){if(n(this),this===h)throw new T("You can't redefine this property");u(this,x)?this[x]=A:a(this,x,A)}}):h[x]=P};return u(h,C)||I(C,v),(E||!u(h,w)||h[w]===Object)&&I(w,y),y.prototype=h,t({global:!0,constructor:!0,forced:E},{Iterator:y}),Mb}var Vb;function ux(){return Vb||(Vb=1,lx()),Ob}ux();var Wb={},Bb={},hf,$b;function cx(){if($b)return hf;$b=1;var t=Bm();return hf=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},hf}var df,jb;function hx(){return jb||(jb=1,df=function(t,e){return{value:t,done:e}}),df}var ff,zb;function dx(){if(zb)return ff;zb=1;var t=Er();return ff=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},ff}var gf,Ub;function MT(){if(Ub)return gf;Ub=1;var t=wt(),e=zm(),r=Ns(),n=cx(),i=cn(),o=cT(),s=rl(),a=OT().IteratorPrototype,l=hx(),u=Er(),c=dx(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",w="normal",v="throw",C=o.set,T=function(y){var I=o.getterFor(y?g:d);return n(e(a),{next:function(){var P=I(this);if(y)return P.nextHandler();if(P.done)return l(void 0,!0);try{var A=P.nextHandler();return P.returnHandlerResult?A:l(A,P.done)}catch(F){throw P.done=!0,F}},return:function(){var x=I(this),P=x.iterator;if(x.done=!0,y){var A=s(P,"return");return A?t(A,P):l(void 0,!0)}if(x.inner)try{u(x.inner.iterator,w)}catch(F){return u(P,v,F)}if(x.openIters)try{c(x.openIters,w)}catch(F){return u(P,v,F)}return P&&u(P,w),l(void 0,!0)}})},b=T(!0),E=T(!1);return r(E,h,"Iterator Helper"),gf=function(y,I,x){var P=function(F,W){W?(W.iterator=F.iterator,W.next=F.next):W=F,W.type=I?g:d,W.returnHandlerResult=!!x,W.nextHandler=y,W.counter=0,W.done=!1,C(this,W)};return P.prototype=I?b:E,P},gf}var mf,Yb;function IT(){if(Yb)return mf;Yb=1;var t=vt(),e=Er();return mf=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},mf}var pf,qb;function PT(){return qb||(qb=1,pf=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),pf}var wf,Gb;function Ho(){if(Gb)return wf;Gb=1;var t=it();return wf=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},wf}var Kb;function fx(){if(Kb)return Bb;Kb=1;var t=Fe(),e=wt(),r=Rr(),n=vt(),i=Wi(),o=MT(),s=IT(),a=Oo(),l=Er(),u=PT(),c=Ho(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,w=o(function(){for(var v=this.iterator,C=this.predicate,T=this.next,b,E,y;;){if(b=n(e(T,v)),E=this.done=!!b.done,E)return;if(y=b.value,s(v,C,[y,this.counter++],!0))return y}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(C){n(this);try{r(C)}catch(T){l(this,"throw",T)}return d?e(d,this,C):new w(i(this),{predicate:C})}}),Bb}var Xb;function gx(){return Xb||(Xb=1,fx()),Wb}gx();var Zb={},Jb={},Qb;function mx(){if(Qb)return Jb;Qb=1;var t=Fe(),e=wt(),r=Ls(),n=Rr(),i=vt(),o=Wi(),s=Er(),a=Ho(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),Jb}var eC;function px(){return eC||(eC=1,mx()),Zb}px();var tC={},rC={},nC;function wx(){if(nC)return rC;nC=1;var t=Fe(),e=wt(),r=Rr(),n=vt(),i=Wi(),o=MT(),s=IT(),a=Er(),l=PT(),u=Ho(),c=Oo(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,w=o(function(){var v=this.iterator,C=n(e(this.next,v)),T=this.done=!!C.done;if(!T)return s(v,this.mapper,[C.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(C){n(this);try{r(C)}catch(T){a(this,"throw",T)}return d?e(d,this,C):new w(i(this),{mapper:C})}}),rC}var iC;function vx(){return iC||(iC=1,wx()),tC}vx();var oC={},sC={},vf,aC;function Um(){if(aC)return vf;aC=1;var t=ot();return vf=t([].slice),vf}var yf,lC;function xT(){if(lC)return yf;lC=1;var t=TypeError;return yf=function(e,r){if(e<r)throw new t("Not enough arguments");return e},yf}var bf,uC;function yx(){if(uC)return bf;uC=1;var t=uc();return bf=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),bf}var Cf,cC;function HT(){if(cC)return Cf;cC=1;var t=it(),e=uc(),r=_o(),n=function(i){return e.slice(0,i.length)===i};return Cf=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),Cf}var Sf,hC;function bx(){if(hC)return Sf;hC=1;var t=HT();return Sf=t==="NODE",Sf}var Rf,dC;function AT(){if(dC)return Rf;dC=1;var t=it(),e=il(),r=bT(),n=ht(),i=zr(),o=ct(),s=_T(),a=Um(),l=Fm(),u=xT(),c=yx(),h=bx(),d=t.setImmediate,g=t.clearImmediate,w=t.process,v=t.Dispatch,C=t.Function,T=t.MessageChannel,b=t.String,E=0,y={},I="onreadystatechange",x,P,A,F;o(function(){x=t.location});var W=function(K){if(i(y,K)){var te=y[K];delete y[K],te()}},q=function(K){return function(){W(K)}},L=function(K){W(K.data)},ae=function(K){t.postMessage(b(K),x.protocol+"//"+x.host)};return(!d||!g)&&(d=function(te){u(arguments.length,1);var dt=n(te)?te:C(te),Re=a(arguments,1);return y[++E]=function(){e(dt,void 0,Re)},P(E),E},g=function(te){delete y[te]},h?P=function(K){w.nextTick(q(K))}:v&&v.now?P=function(K){v.now(q(K))}:T&&!c?(A=new T,F=A.port2,A.port1.onmessage=L,P=r(F.postMessage,F)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&x&&x.protocol!=="file:"&&!o(ae)?(P=ae,t.addEventListener("message",L,!1)):I in l("script")?P=function(K){s.appendChild(l("script"))[I]=function(){s.removeChild(this),W(K)}}:P=function(K){setTimeout(q(K),0)}),Rf={set:d,clear:g},Rf}var fC;function Cx(){if(fC)return sC;fC=1;var t=Fe(),e=it(),r=AT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),sC}var gC={},Ef,mC;function Sx(){if(mC)return Ef;mC=1;var t=it(),e=il(),r=ht(),n=HT(),i=uc(),o=Um(),s=xT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return Ef=function(u,c){var h=c?2:1;return l?function(d,g){var w=s(arguments.length,1)>h,v=r(d)?d:a(d),C=w?o(arguments,h):[],T=w?function(){e(v,this,C)}:v;return c?u(T,g):u(T)}:u},Ef}var pC;function Rx(){if(pC)return gC;pC=1;var t=Fe(),e=it(),r=AT().set,n=Sx(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),gC}var wC;function Ex(){return wC||(wC=1,Cx(),Rx()),oC}Ex();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:DT,setPrototypeOf:vC,isFrozen:Tx,getPrototypeOf:_x,getOwnPropertyDescriptor:Ox}=Object;let{freeze:Ut,seal:Vr,create:NT}=Object,{apply:Ug,construct:Yg}=typeof Reflect<"u"&&Reflect;Ut||(Ut=function(e){return e});Vr||(Vr=function(e){return e});Ug||(Ug=function(e,r,n){return e.apply(r,n)});Yg||(Yg=function(e,r){return new e(...r)});const Sl=Yt(Array.prototype.forEach),Mx=Yt(Array.prototype.lastIndexOf),yC=Yt(Array.prototype.pop),Us=Yt(Array.prototype.push),Ix=Yt(Array.prototype.splice),wu=Yt(String.prototype.toLowerCase),Tf=Yt(String.prototype.toString),bC=Yt(String.prototype.match),Ys=Yt(String.prototype.replace),Px=Yt(String.prototype.indexOf),xx=Yt(String.prototype.trim),tn=Yt(Object.prototype.hasOwnProperty),Nt=Yt(RegExp.prototype.test),qs=Hx(TypeError);function Yt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Ug(t,e,n)}}function Hx(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Yg(t,r)}}function ce(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:wu;vC&&vC(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(Tx(e)||(e[n]=o),i=o)}t[i]=!0}return t}function Ax(t){for(let e=0;e<t.length;e++)tn(t,e)||(t[e]=null);return t}function Gn(t){const e=NT(null);for(const[r,n]of DT(t))tn(t,r)&&(Array.isArray(n)?e[r]=Ax(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Gn(n):e[r]=n);return e}function Gs(t,e){for(;t!==null;){const n=Ox(t,e);if(n){if(n.get)return Yt(n.get);if(typeof n.value=="function")return Yt(n.value)}t=_x(t)}function r(){return null}return r}const CC=Ut(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_f=Ut(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Of=Ut(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Dx=Ut(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Mf=Ut(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Nx=Ut(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),SC=Ut(["#text"]),RC=Ut(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),If=Ut(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),EC=Ut(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rl=Ut(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),kx=Vr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Lx=Vr(/<%[\w\W]*|[\w\W]*%>/gm),Fx=Vr(/\$\{[\w\W]*/gm),Vx=Vr(/^data-[\-\w.\u00B7-\uFFFF]+$/),Wx=Vr(/^aria-[\-\w]+$/),kT=Vr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Bx=Vr(/^(?:\w+script|data):/i),$x=Vr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),LT=Vr(/^html$/i),jx=Vr(/^[a-z][.\w]*(-[.\w]+)+$/i);var TC=Object.freeze({__proto__:null,ARIA_ATTR:Wx,ATTR_WHITESPACE:$x,CUSTOM_ELEMENT:jx,DATA_ATTR:Vx,DOCTYPE_NAME:LT,ERB_EXPR:Lx,IS_ALLOWED_URI:kT,IS_SCRIPT_OR_DATA:Bx,MUSTACHE_EXPR:kx,TMPLIT_EXPR:Fx});const Ks={element:1,text:3,progressingInstruction:7,comment:8,document:9},zx=function(){return typeof window>"u"?null:window},Ux=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},_C=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function FT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zx();const e=Z=>FT(Z);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Ks.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,w=l.prototype,v=Gs(w,"cloneNode"),C=Gs(w,"remove"),T=Gs(w,"nextSibling"),b=Gs(w,"childNodes"),E=Gs(w,"parentNode");if(typeof s=="function"){const Z=r.createElement("template");Z.content&&Z.content.ownerDocument&&(r=Z.content.ownerDocument)}let y,I="";const{implementation:x,createNodeIterator:P,createDocumentFragment:A,getElementsByTagName:F}=r,{importNode:W}=n;let q=_C();e.isSupported=typeof DT=="function"&&typeof E=="function"&&x&&x.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:ae,TMPLIT_EXPR:K,DATA_ATTR:te,ARIA_ATTR:dt,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:Ee,CUSTOM_ELEMENT:Ye}=TC;let{IS_ALLOWED_URI:Be}=TC,Ie=null;const fn=ce({},[...CC,..._f,...Of,...Mf,...SC]);let Te=null;const f=ce({},[...RC,...If,...EC,...Rl]);let m=Object.seal(NT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),p=null,R=null,_=!0,O=!0,H=!1,k=!0,U=!1,B=!0,M=!1,$=!1,Q=!1,ie=!1,be=!1,le=!1,de=!0,Ae=!1;const pe="user-content-";let ke=!0,Et=!1,Ht={},cr=null;const Ln=ce({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let At=null;const yt=ce({},["audio","video","img","source","image","track"]);let hr=null;const ui=ce({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gr="http://www.w3.org/1998/Math/MathML",$i="http://www.w3.org/2000/svg",_r="http://www.w3.org/1999/xhtml";let gn=_r,dr=!1,ci=null;const hi=ce({},[Gr,$i,_r],Tf);let mn=ce({},["mi","mo","mn","ms","mtext"]),di=ce({},["annotation-xml"]);const Or=ce({},["title","style","font","a","script"]);let bt=null;const vl=["application/xhtml+xml","text/html"],yl="text/html";let mt=null,Lo=null;const UM=r.createElement("form"),kw=function(S){return S instanceof RegExp||S instanceof Function},Gc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Lo&&Lo===S)){if((!S||typeof S!="object")&&(S={}),S=Gn(S),bt=vl.indexOf(S.PARSER_MEDIA_TYPE)===-1?yl:S.PARSER_MEDIA_TYPE,mt=bt==="application/xhtml+xml"?Tf:wu,Ie=tn(S,"ALLOWED_TAGS")?ce({},S.ALLOWED_TAGS,mt):fn,Te=tn(S,"ALLOWED_ATTR")?ce({},S.ALLOWED_ATTR,mt):f,ci=tn(S,"ALLOWED_NAMESPACES")?ce({},S.ALLOWED_NAMESPACES,Tf):hi,hr=tn(S,"ADD_URI_SAFE_ATTR")?ce(Gn(ui),S.ADD_URI_SAFE_ATTR,mt):ui,At=tn(S,"ADD_DATA_URI_TAGS")?ce(Gn(yt),S.ADD_DATA_URI_TAGS,mt):yt,cr=tn(S,"FORBID_CONTENTS")?ce({},S.FORBID_CONTENTS,mt):Ln,p=tn(S,"FORBID_TAGS")?ce({},S.FORBID_TAGS,mt):Gn({}),R=tn(S,"FORBID_ATTR")?ce({},S.FORBID_ATTR,mt):Gn({}),Ht=tn(S,"USE_PROFILES")?S.USE_PROFILES:!1,_=S.ALLOW_ARIA_ATTR!==!1,O=S.ALLOW_DATA_ATTR!==!1,H=S.ALLOW_UNKNOWN_PROTOCOLS||!1,k=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,U=S.SAFE_FOR_TEMPLATES||!1,B=S.SAFE_FOR_XML!==!1,M=S.WHOLE_DOCUMENT||!1,ie=S.RETURN_DOM||!1,be=S.RETURN_DOM_FRAGMENT||!1,le=S.RETURN_TRUSTED_TYPE||!1,Q=S.FORCE_BODY||!1,de=S.SANITIZE_DOM!==!1,Ae=S.SANITIZE_NAMED_PROPS||!1,ke=S.KEEP_CONTENT!==!1,Et=S.IN_PLACE||!1,Be=S.ALLOWED_URI_REGEXP||kT,gn=S.NAMESPACE||_r,mn=S.MATHML_TEXT_INTEGRATION_POINTS||mn,di=S.HTML_INTEGRATION_POINTS||di,m=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&kw(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(m.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&kw(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(m.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(m.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),U&&(O=!1),be&&(ie=!0),Ht&&(Ie=ce({},SC),Te=[],Ht.html===!0&&(ce(Ie,CC),ce(Te,RC)),Ht.svg===!0&&(ce(Ie,_f),ce(Te,If),ce(Te,Rl)),Ht.svgFilters===!0&&(ce(Ie,Of),ce(Te,If),ce(Te,Rl)),Ht.mathMl===!0&&(ce(Ie,Mf),ce(Te,EC),ce(Te,Rl))),S.ADD_TAGS&&(Ie===fn&&(Ie=Gn(Ie)),ce(Ie,S.ADD_TAGS,mt)),S.ADD_ATTR&&(Te===f&&(Te=Gn(Te)),ce(Te,S.ADD_ATTR,mt)),S.ADD_URI_SAFE_ATTR&&ce(hr,S.ADD_URI_SAFE_ATTR,mt),S.FORBID_CONTENTS&&(cr===Ln&&(cr=Gn(cr)),ce(cr,S.FORBID_CONTENTS,mt)),ke&&(Ie["#text"]=!0),M&&ce(Ie,["html","head","body"]),Ie.table&&(ce(Ie,["tbody"]),delete p.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw qs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=S.TRUSTED_TYPES_POLICY,I=y.createHTML("")}else y===void 0&&(y=Ux(g,i)),y!==null&&typeof I=="string"&&(I=y.createHTML(""));Ut&&Ut(S),Lo=S}},Lw=ce({},[..._f,...Of,...Dx]),Fw=ce({},[...Mf,...Nx]),YM=function(S){let N=E(S);(!N||!N.tagName)&&(N={namespaceURI:gn,tagName:"template"});const G=wu(S.tagName),$e=wu(N.tagName);return ci[S.namespaceURI]?S.namespaceURI===$i?N.namespaceURI===_r?G==="svg":N.namespaceURI===Gr?G==="svg"&&($e==="annotation-xml"||mn[$e]):!!Lw[G]:S.namespaceURI===Gr?N.namespaceURI===_r?G==="math":N.namespaceURI===$i?G==="math"&&di[$e]:!!Fw[G]:S.namespaceURI===_r?N.namespaceURI===$i&&!di[$e]||N.namespaceURI===Gr&&!mn[$e]?!1:!Fw[G]&&(Or[G]||!Lw[G]):!!(bt==="application/xhtml+xml"&&ci[S.namespaceURI]):!1},pn=function(S){Us(e.removed,{element:S});try{E(S).removeChild(S)}catch{C(S)}},Fo=function(S,N){try{Us(e.removed,{attribute:N.getAttributeNode(S),from:N})}catch{Us(e.removed,{attribute:null,from:N})}if(N.removeAttribute(S),S==="is")if(ie||be)try{pn(N)}catch{}else try{N.setAttribute(S,"")}catch{}},Vw=function(S){let N=null,G=null;if(Q)S="<remove></remove>"+S;else{const ft=bC(S,/^[\r\n\t ]+/);G=ft&&ft[0]}bt==="application/xhtml+xml"&&gn===_r&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const $e=y?y.createHTML(S):S;if(gn===_r)try{N=new d().parseFromString($e,bt)}catch{}if(!N||!N.documentElement){N=x.createDocument(gn,"template",null);try{N.documentElement.innerHTML=dr?I:$e}catch{}}const Tt=N.body||N.documentElement;return S&&G&&Tt.insertBefore(r.createTextNode(G),Tt.childNodes[0]||null),gn===_r?F.call(N,M?"html":"body")[0]:M?N.documentElement:Tt},Ww=function(S){return P.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Kc=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},Bw=function(S){return typeof a=="function"&&S instanceof a};function Fn(Z,S,N){Sl(Z,G=>{G.call(e,S,N,Lo)})}const $w=function(S){let N=null;if(Fn(q.beforeSanitizeElements,S,null),Kc(S))return pn(S),!0;const G=mt(S.nodeName);if(Fn(q.uponSanitizeElement,S,{tagName:G,allowedTags:Ie}),B&&S.hasChildNodes()&&!Bw(S.firstElementChild)&&Nt(/<[/\w!]/g,S.innerHTML)&&Nt(/<[/\w!]/g,S.textContent)||S.nodeType===Ks.progressingInstruction||B&&S.nodeType===Ks.comment&&Nt(/<[/\w]/g,S.data))return pn(S),!0;if(!Ie[G]||p[G]){if(!p[G]&&zw(G)&&(m.tagNameCheck instanceof RegExp&&Nt(m.tagNameCheck,G)||m.tagNameCheck instanceof Function&&m.tagNameCheck(G)))return!1;if(ke&&!cr[G]){const $e=E(S)||S.parentNode,Tt=b(S)||S.childNodes;if(Tt&&$e){const ft=Tt.length;for(let qt=ft-1;qt>=0;--qt){const Vn=v(Tt[qt],!0);Vn.__removalCount=(S.__removalCount||0)+1,$e.insertBefore(Vn,T(S))}}}return pn(S),!0}return S instanceof l&&!YM(S)||(G==="noscript"||G==="noembed"||G==="noframes")&&Nt(/<\/no(script|embed|frames)/i,S.innerHTML)?(pn(S),!0):(U&&S.nodeType===Ks.text&&(N=S.textContent,Sl([L,ae,K],$e=>{N=Ys(N,$e," ")}),S.textContent!==N&&(Us(e.removed,{element:S.cloneNode()}),S.textContent=N)),Fn(q.afterSanitizeElements,S,null),!1)},jw=function(S,N,G){if(de&&(N==="id"||N==="name")&&(G in r||G in UM))return!1;if(!(O&&!R[N]&&Nt(te,N))){if(!(_&&Nt(dt,N))){if(!Te[N]||R[N]){if(!(zw(S)&&(m.tagNameCheck instanceof RegExp&&Nt(m.tagNameCheck,S)||m.tagNameCheck instanceof Function&&m.tagNameCheck(S))&&(m.attributeNameCheck instanceof RegExp&&Nt(m.attributeNameCheck,N)||m.attributeNameCheck instanceof Function&&m.attributeNameCheck(N))||N==="is"&&m.allowCustomizedBuiltInElements&&(m.tagNameCheck instanceof RegExp&&Nt(m.tagNameCheck,G)||m.tagNameCheck instanceof Function&&m.tagNameCheck(G))))return!1}else if(!hr[N]){if(!Nt(Be,Ys(G,Ee,""))){if(!((N==="src"||N==="xlink:href"||N==="href")&&S!=="script"&&Px(G,"data:")===0&&At[S])){if(!(H&&!Nt(Re,Ys(G,Ee,"")))){if(G)return!1}}}}}}return!0},zw=function(S){return S!=="annotation-xml"&&bC(S,Ye)},Uw=function(S){Fn(q.beforeSanitizeAttributes,S,null);const{attributes:N}=S;if(!N||Kc(S))return;const G={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te,forceKeepAttr:void 0};let $e=N.length;for(;$e--;){const Tt=N[$e],{name:ft,namespaceURI:qt,value:Vn}=Tt,js=mt(ft),Xc=Vn;let _t=ft==="value"?Xc:xx(Xc);if(G.attrName=js,G.attrValue=_t,G.keepAttr=!0,G.forceKeepAttr=void 0,Fn(q.uponSanitizeAttribute,S,G),_t=G.attrValue,Ae&&(js==="id"||js==="name")&&(Fo(ft,S),_t=pe+_t),B&&Nt(/((--!?|])>)|<\/(style|title)/i,_t)){Fo(ft,S);continue}if(G.forceKeepAttr)continue;if(!G.keepAttr){Fo(ft,S);continue}if(!k&&Nt(/\/>/i,_t)){Fo(ft,S);continue}U&&Sl([L,ae,K],qw=>{_t=Ys(_t,qw," ")});const Yw=mt(S.nodeName);if(!jw(Yw,js,_t)){Fo(ft,S);continue}if(y&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!qt)switch(g.getAttributeType(Yw,js)){case"TrustedHTML":{_t=y.createHTML(_t);break}case"TrustedScriptURL":{_t=y.createScriptURL(_t);break}}if(_t!==Xc)try{qt?S.setAttributeNS(qt,ft,_t):S.setAttribute(ft,_t),Kc(S)?pn(S):yC(e.removed)}catch{Fo(ft,S)}}Fn(q.afterSanitizeAttributes,S,null)},qM=function Z(S){let N=null;const G=Ww(S);for(Fn(q.beforeSanitizeShadowDOM,S,null);N=G.nextNode();)Fn(q.uponSanitizeShadowNode,N,null),$w(N),Uw(N),N.content instanceof o&&Z(N.content);Fn(q.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(Z){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=null,G=null,$e=null,Tt=null;if(dr=!Z,dr&&(Z="<!-->"),typeof Z!="string"&&!Bw(Z))if(typeof Z.toString=="function"){if(Z=Z.toString(),typeof Z!="string")throw qs("dirty is not a string, aborting")}else throw qs("toString is not a function");if(!e.isSupported)return Z;if($||Gc(S),e.removed=[],typeof Z=="string"&&(Et=!1),Et){if(Z.nodeName){const Vn=mt(Z.nodeName);if(!Ie[Vn]||p[Vn])throw qs("root node is forbidden and cannot be sanitized in-place")}}else if(Z instanceof a)N=Vw("<!---->"),G=N.ownerDocument.importNode(Z,!0),G.nodeType===Ks.element&&G.nodeName==="BODY"||G.nodeName==="HTML"?N=G:N.appendChild(G);else{if(!ie&&!U&&!M&&Z.indexOf("<")===-1)return y&&le?y.createHTML(Z):Z;if(N=Vw(Z),!N)return ie?null:le?I:""}N&&Q&&pn(N.firstChild);const ft=Ww(Et?Z:N);for(;$e=ft.nextNode();)$w($e),Uw($e),$e.content instanceof o&&qM($e.content);if(Et)return Z;if(ie){if(be)for(Tt=A.call(N.ownerDocument);N.firstChild;)Tt.appendChild(N.firstChild);else Tt=N;return(Te.shadowroot||Te.shadowrootmode)&&(Tt=W.call(n,Tt,!0)),Tt}let qt=M?N.outerHTML:N.innerHTML;return M&&Ie["!doctype"]&&N.ownerDocument&&N.ownerDocument.doctype&&N.ownerDocument.doctype.name&&Nt(LT,N.ownerDocument.doctype.name)&&(qt="<!DOCTYPE "+N.ownerDocument.doctype.name+`>
`+qt),U&&Sl([L,ae,K],Vn=>{qt=Ys(qt,Vn," ")}),y&&le?y.createHTML(qt):qt},e.setConfig=function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Gc(Z),$=!0},e.clearConfig=function(){Lo=null,$=!1},e.isValidAttribute=function(Z,S,N){Lo||Gc({});const G=mt(Z),$e=mt(S);return jw(G,$e,N)},e.addHook=function(Z,S){typeof S=="function"&&Us(q[Z],S)},e.removeHook=function(Z,S){if(S!==void 0){const N=Mx(q[Z],S);return N===-1?void 0:Ix(q[Z],N,1)[0]}return yC(q[Z])},e.removeHooks=function(Z){q[Z]=[]},e.removeAllHooks=function(){q=_C()},e}var Yx=FT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var VT;function V(){return VT.apply(null,arguments)}function qx(t){VT=t}function ln(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function po(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ce(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ym(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ce(t,e))return!1;return!0}function Qt(t){return t===void 0}function ii(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function al(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function WT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function _i(t,e){for(var r in e)Ce(e,r)&&(t[r]=e[r]);return Ce(e,"toString")&&(t.toString=e.toString),Ce(e,"valueOf")&&(t.valueOf=e.valueOf),t}function An(t,e,r,n){return u_(t,e,r,n,!0).utc()}function Gx(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function se(t){return t._pf==null&&(t._pf=Gx()),t._pf}var qg;Array.prototype.some?qg=Array.prototype.some:qg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function qm(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=se(t),r=qg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function dc(t){var e=An(NaN);return t!=null?_i(se(e),t):se(e).userInvalidated=!0,e}var OC=V.momentProperties=[],Pf=!1;function Gm(t,e){var r,n,i,o=OC.length;if(Qt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Qt(e._i)||(t._i=e._i),Qt(e._f)||(t._f=e._f),Qt(e._l)||(t._l=e._l),Qt(e._strict)||(t._strict=e._strict),Qt(e._tzm)||(t._tzm=e._tzm),Qt(e._isUTC)||(t._isUTC=e._isUTC),Qt(e._offset)||(t._offset=e._offset),Qt(e._pf)||(t._pf=se(e)),Qt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=OC[r],i=e[n],Qt(i)||(t[n]=i);return t}function ll(t){Gm(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Pf===!1&&(Pf=!0,V.updateOffset(this),Pf=!1)}function un(t){return t instanceof ll||t!=null&&t._isAMomentObject!=null}function BT(t){V.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ur(t,e){var r=!0;return _i(function(){if(V.deprecationHandler!=null&&V.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Ce(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}BT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var MC={};function $T(t,e){V.deprecationHandler!=null&&V.deprecationHandler(t,e),MC[t]||(BT(e),MC[t]=!0)}V.suppressDeprecationWarnings=!1;V.deprecationHandler=null;function Dn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Kx(t){var e,r;for(r in t)Ce(t,r)&&(e=t[r],Dn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Gg(t,e){var r=_i({},t),n;for(n in e)Ce(e,n)&&(po(t[n])&&po(e[n])?(r[n]={},_i(r[n],t[n]),_i(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Ce(t,n)&&!Ce(e,n)&&po(t[n])&&(r[n]=_i({},r[n]));return r}function Km(t){t!=null&&this.set(t)}var Kg;Object.keys?Kg=Object.keys:Kg=function(t){var e,r=[];for(e in t)Ce(t,e)&&r.push(e);return r};var Xx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Zx(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Dn(n)?n.call(e,r):n}function Pn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var Xm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,El=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,xf={},ms={};function J(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(ms[t]=i),e&&(ms[e[0]]=function(){return Pn(i.apply(this,arguments),e[1],e[2])}),r&&(ms[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function Jx(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Qx(t){var e=t.match(Xm),r,n;for(r=0,n=e.length;r<n;r++)ms[e[r]]?e[r]=ms[e[r]]:e[r]=Jx(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Dn(e[s])?e[s].call(i,t):e[s];return o}}function vu(t,e){return t.isValid()?(e=jT(e,t.localeData()),xf[e]=xf[e]||Qx(e),xf[e](t)):t.localeData().invalidDate()}function jT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(El.lastIndex=0;r>=0&&El.test(t);)t=t.replace(El,n),El.lastIndex=0,r-=1;return t}var eH={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function tH(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(Xm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var rH="Invalid date";function nH(){return this._invalidDate}var iH="%d",oH=/\d{1,2}/;function sH(t){return this._ordinal.replace("%d",t)}var aH={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function lH(t,e,r,n){var i=this._relativeTime[r];return Dn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function uH(t,e){var r=this._relativeTime[t>0?"future":"past"];return Dn(r)?r(e):r.replace(/%s/i,e)}var IC={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Yr(t){return typeof t=="string"?IC[t]||IC[t.toLowerCase()]:void 0}function Zm(t){var e={},r,n;for(n in t)Ce(t,n)&&(r=Yr(n),r&&(e[r]=t[n]));return e}var cH={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function hH(t){var e=[],r;for(r in t)Ce(t,r)&&e.push({unit:r,priority:cH[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var zT=/\d/,Tr=/\d\d/,UT=/\d{3}/,Jm=/\d{4}/,fc=/[+-]?\d{6}/,We=/\d\d?/,YT=/\d\d\d\d?/,qT=/\d\d\d\d\d\d?/,gc=/\d{1,3}/,Qm=/\d{1,4}/,mc=/[+-]?\d{1,6}/,Fs=/\d+/,pc=/[+-]?\d+/,dH=/Z|[+-]\d\d:?\d\d/gi,wc=/Z|[+-]\d\d(?::?\d\d)?/gi,fH=/[+-]?\d+(\.\d{1,3})?/,ul=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Vs=/^[1-9]\d?/,ep=/^([1-9]\d|\d)/,Du;Du={};function z(t,e,r){Du[t]=Dn(e)?e:function(n,i){return n&&r?r:e}}function gH(t,e){return Ce(Du,t)?Du[t](e._strict,e._locale):new RegExp(mH(t))}function mH(t){return ri(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function ri(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Nr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function me(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Nr(e)),r}var Xg={};function Ne(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),ii(e)&&(n=function(o,s){s[e]=me(o)}),i=t.length,r=0;r<i;r++)Xg[t[r]]=n}function cl(t,e){Ne(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function pH(t,e,r){e!=null&&Ce(Xg,t)&&Xg[t](e,r._a,r,t)}function vc(t){return t%4===0&&t%100!==0||t%400===0}var xt=0,Qn=1,Tn=2,gt=3,an=4,ei=5,ho=6,wH=7,vH=8;J("Y",0,0,function(){var t=this.year();return t<=9999?Pn(t,4):"+"+t});J(0,["YY",2],0,function(){return this.year()%100});J(0,["YYYY",4],0,"year");J(0,["YYYYY",5],0,"year");J(0,["YYYYYY",6,!0],0,"year");z("Y",pc);z("YY",We,Tr);z("YYYY",Qm,Jm);z("YYYYY",mc,fc);z("YYYYYY",mc,fc);Ne(["YYYYY","YYYYYY"],xt);Ne("YYYY",function(t,e){e[xt]=t.length===2?V.parseTwoDigitYear(t):me(t)});Ne("YY",function(t,e){e[xt]=V.parseTwoDigitYear(t)});Ne("Y",function(t,e){e[xt]=parseInt(t,10)});function Na(t){return vc(t)?366:365}V.parseTwoDigitYear=function(t){return me(t)+(me(t)>68?1900:2e3)};var GT=Ws("FullYear",!0);function yH(){return vc(this.year())}function Ws(t,e){return function(r){return r!=null?(KT(this,t,r),V.updateOffset(this,e),this):za(this,t)}}function za(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function KT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!vc(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function bH(t){return t=Yr(t),Dn(this[t])?this[t]():this}function CH(t,e){if(typeof t=="object"){t=Zm(t);var r=hH(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Yr(t),Dn(this[t]))return this[t](e);return this}function SH(t,e){return(t%e+e)%e}var rt;Array.prototype.indexOf?rt=Array.prototype.indexOf:rt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function tp(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=SH(e,12);return t+=(e-r)/12,r===1?vc(t)?29:28:31-r%7%2}J("M",["MM",2],"Mo",function(){return this.month()+1});J("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});J("MMMM",0,0,function(t){return this.localeData().months(this,t)});z("M",We,Vs);z("MM",We,Tr);z("MMM",function(t,e){return e.monthsShortRegex(t)});z("MMMM",function(t,e){return e.monthsRegex(t)});Ne(["M","MM"],function(t,e){e[Qn]=me(t)-1});Ne(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Qn]=i:se(r).invalidMonth=t});var RH="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),XT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ZT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,EH=ul,TH=ul;function _H(t,e){return t?ln(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||ZT).test(e)?"format":"standalone"][t.month()]:ln(this._months)?this._months:this._months.standalone}function OH(t,e){return t?ln(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[ZT.test(e)?"format":"standalone"][t.month()]:ln(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function MH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=An([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=rt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=rt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=rt.call(this._shortMonthsParse,s),i!==-1?i:(i=rt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=rt.call(this._longMonthsParse,s),i!==-1?i:(i=rt.call(this._shortMonthsParse,s),i!==-1?i:null))}function IH(t,e,r){var n,i,o;if(this._monthsParseExact)return MH.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=An([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function JT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=me(e);else if(e=t.localeData().monthsParse(e),!ii(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,tp(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function QT(t){return t!=null?(JT(this,t),V.updateOffset(this,!0),this):za(this,"Month")}function PH(){return tp(this.year(),this.month())}function xH(t){return this._monthsParseExact?(Ce(this,"_monthsRegex")||e_.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ce(this,"_monthsShortRegex")||(this._monthsShortRegex=EH),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function HH(t){return this._monthsParseExact?(Ce(this,"_monthsRegex")||e_.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ce(this,"_monthsRegex")||(this._monthsRegex=TH),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function e_(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=An([2e3,i]),s=ri(this.monthsShort(o,"")),a=ri(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function AH(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function Ua(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Nu(t,e,r){var n=7+e-r,i=(7+Ua(t,0,n).getUTCDay()-e)%7;return-i+n-1}function t_(t,e,r,n,i){var o=(7+r-n)%7,s=Nu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Na(l)+a):a>Na(t)?(l=t+1,u=a-Na(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ya(t,e,r){var n=Nu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ni(s,e,r)):i>ni(t.year(),e,r)?(o=i-ni(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ni(t,e,r){var n=Nu(t,e,r),i=Nu(t+1,e,r);return(Na(t)-n+i)/7}J("w",["ww",2],"wo","week");J("W",["WW",2],"Wo","isoWeek");z("w",We,Vs);z("ww",We,Tr);z("W",We,Vs);z("WW",We,Tr);cl(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=me(t)});function DH(t){return Ya(t,this._week.dow,this._week.doy).week}var NH={dow:0,doy:6};function kH(){return this._week.dow}function LH(){return this._week.doy}function FH(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function VH(t){var e=Ya(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}J("d",0,"do","day");J("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});J("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});J("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});J("e",0,0,"weekday");J("E",0,0,"isoWeekday");z("d",We);z("e",We);z("E",We);z("dd",function(t,e){return e.weekdaysMinRegex(t)});z("ddd",function(t,e){return e.weekdaysShortRegex(t)});z("dddd",function(t,e){return e.weekdaysRegex(t)});cl(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:se(r).invalidWeekday=t});cl(["d","e","E"],function(t,e,r,n){e[n]=me(t)});function WH(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function BH(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function rp(t,e){return t.slice(e,7).concat(t.slice(0,e))}var $H="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),r_="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),jH="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),zH=ul,UH=ul,YH=ul;function qH(t,e){var r=ln(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?rp(r,this._week.dow):t?r[t.day()]:r}function GH(t){return t===!0?rp(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function KH(t){return t===!0?rp(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function XH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=An([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=rt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=rt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=rt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=rt.call(this._weekdaysParse,s),i!==-1||(i=rt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=rt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=rt.call(this._shortWeekdaysParse,s),i!==-1||(i=rt.call(this._weekdaysParse,s),i!==-1)?i:(i=rt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=rt.call(this._minWeekdaysParse,s),i!==-1||(i=rt.call(this._weekdaysParse,s),i!==-1)?i:(i=rt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function ZH(t,e,r){var n,i,o;if(this._weekdaysParseExact)return XH.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=An([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function JH(t){if(!this.isValid())return t!=null?this:NaN;var e=za(this,"Day");return t!=null?(t=WH(t,this.localeData()),this.add(t-e,"d")):e}function QH(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function eA(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=BH(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function tA(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||np.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ce(this,"_weekdaysRegex")||(this._weekdaysRegex=zH),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function rA(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||np.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ce(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=UH),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function nA(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||np.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ce(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=YH),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function np(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=An([2e3,1]).day(o),a=ri(this.weekdaysMin(s,"")),l=ri(this.weekdaysShort(s,"")),u=ri(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ip(){return this.hours()%12||12}function iA(){return this.hours()||24}J("H",["HH",2],0,"hour");J("h",["hh",2],0,ip);J("k",["kk",2],0,iA);J("hmm",0,0,function(){return""+ip.apply(this)+Pn(this.minutes(),2)});J("hmmss",0,0,function(){return""+ip.apply(this)+Pn(this.minutes(),2)+Pn(this.seconds(),2)});J("Hmm",0,0,function(){return""+this.hours()+Pn(this.minutes(),2)});J("Hmmss",0,0,function(){return""+this.hours()+Pn(this.minutes(),2)+Pn(this.seconds(),2)});function n_(t,e){J(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}n_("a",!0);n_("A",!1);function i_(t,e){return e._meridiemParse}z("a",i_);z("A",i_);z("H",We,ep);z("h",We,Vs);z("k",We,Vs);z("HH",We,Tr);z("hh",We,Tr);z("kk",We,Tr);z("hmm",YT);z("hmmss",qT);z("Hmm",YT);z("Hmmss",qT);Ne(["H","HH"],gt);Ne(["k","kk"],function(t,e,r){var n=me(t);e[gt]=n===24?0:n});Ne(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Ne(["h","hh"],function(t,e,r){e[gt]=me(t),se(r).bigHour=!0});Ne("hmm",function(t,e,r){var n=t.length-2;e[gt]=me(t.substr(0,n)),e[an]=me(t.substr(n)),se(r).bigHour=!0});Ne("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[gt]=me(t.substr(0,n)),e[an]=me(t.substr(n,2)),e[ei]=me(t.substr(i)),se(r).bigHour=!0});Ne("Hmm",function(t,e,r){var n=t.length-2;e[gt]=me(t.substr(0,n)),e[an]=me(t.substr(n))});Ne("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[gt]=me(t.substr(0,n)),e[an]=me(t.substr(n,2)),e[ei]=me(t.substr(i))});function oA(t){return(t+"").toLowerCase().charAt(0)==="p"}var sA=/[ap]\.?m?\.?/i,aA=Ws("Hours",!0);function lA(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var o_={calendar:Xx,longDateFormat:eH,invalidDate:rH,ordinal:iH,dayOfMonthOrdinalParse:oH,relativeTime:aH,months:RH,monthsShort:XT,week:NH,weekdays:$H,weekdaysMin:jH,weekdaysShort:r_,meridiemParse:sA},Ue={},Xs={},qa;function uA(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function PC(t){return t&&t.toLowerCase().replace("_","-")}function cA(t){for(var e=0,r,n,i,o;e<t.length;){for(o=PC(t[e]).split("-"),r=o.length,n=PC(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=yc(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&uA(o,n)>=r-1)break;r--}e++}return qa}function hA(t){return!!(t&&t.match("^[^/\\\\]*$"))}function yc(t){var e=null,r;if(Ue[t]===void 0&&typeof Pu<"u"&&Pu&&Pu.exports&&hA(t))try{e=qa._abbr,r=require,r("./locale/"+t),Hi(e)}catch{Ue[t]=null}return Ue[t]}function Hi(t,e){var r;return t&&(Qt(e)?r=oi(t):r=op(t,e),r?qa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),qa._abbr}function op(t,e){if(e!==null){var r,n=o_;if(e.abbr=t,Ue[t]!=null)$T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ue[t]._config;else if(e.parentLocale!=null)if(Ue[e.parentLocale]!=null)n=Ue[e.parentLocale]._config;else if(r=yc(e.parentLocale),r!=null)n=r._config;else return Xs[e.parentLocale]||(Xs[e.parentLocale]=[]),Xs[e.parentLocale].push({name:t,config:e}),null;return Ue[t]=new Km(Gg(n,e)),Xs[t]&&Xs[t].forEach(function(i){op(i.name,i.config)}),Hi(t),Ue[t]}else return delete Ue[t],null}function dA(t,e){if(e!=null){var r,n,i=o_;Ue[t]!=null&&Ue[t].parentLocale!=null?Ue[t].set(Gg(Ue[t]._config,e)):(n=yc(t),n!=null&&(i=n._config),e=Gg(i,e),n==null&&(e.abbr=t),r=new Km(e),r.parentLocale=Ue[t],Ue[t]=r),Hi(t)}else Ue[t]!=null&&(Ue[t].parentLocale!=null?(Ue[t]=Ue[t].parentLocale,t===Hi()&&Hi(t)):Ue[t]!=null&&delete Ue[t]);return Ue[t]}function oi(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return qa;if(!ln(t)){if(e=yc(t),e)return e;t=[t]}return cA(t)}function fA(){return Kg(Ue)}function sp(t){var e,r=t._a;return r&&se(t).overflow===-2&&(e=r[Qn]<0||r[Qn]>11?Qn:r[Tn]<1||r[Tn]>tp(r[xt],r[Qn])?Tn:r[gt]<0||r[gt]>24||r[gt]===24&&(r[an]!==0||r[ei]!==0||r[ho]!==0)?gt:r[an]<0||r[an]>59?an:r[ei]<0||r[ei]>59?ei:r[ho]<0||r[ho]>999?ho:-1,se(t)._overflowDayOfYear&&(e<xt||e>Tn)&&(e=Tn),se(t)._overflowWeeks&&e===-1&&(e=wH),se(t)._overflowWeekday&&e===-1&&(e=vH),se(t).overflow=e),t}var gA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pA=/Z|[+-]\d\d(?::?\d\d)?/,Tl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Hf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wA=/^\/?Date\((-?\d+)/i,vA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yA={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function s_(t){var e,r,n=t._i,i=gA.exec(n)||mA.exec(n),o,s,a,l,u=Tl.length,c=Hf.length;if(i){for(se(t).iso=!0,e=0,r=u;e<r;e++)if(Tl[e][1].exec(i[1])){s=Tl[e][0],o=Tl[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(Hf[e][1].exec(i[3])){a=(i[2]||" ")+Hf[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(pA.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),lp(t)}else t._isValid=!1}function bA(t,e,r,n,i,o){var s=[CA(t),XT.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function CA(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function SA(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function RA(t,e,r){if(t){var n=r_.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return se(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function EA(t,e,r){if(t)return yA[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function a_(t){var e=vA.exec(SA(t._i)),r;if(e){if(r=bA(e[4],e[3],e[2],e[5],e[6],e[7]),!RA(e[1],r,t))return;t._a=r,t._tzm=EA(e[8],e[9],e[10]),t._d=Ua.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),se(t).rfc2822=!0}else t._isValid=!1}function TA(t){var e=wA.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(s_(t),t._isValid===!1)delete t._isValid;else return;if(a_(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:V.createFromInputFallback(t)}V.createFromInputFallback=Ur("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ss(t,e,r){return t??e??r}function _A(t){var e=new Date(V.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ap(t){var e,r,n=[],i,o,s;if(!t._d){for(i=_A(t),t._w&&t._a[Tn]==null&&t._a[Qn]==null&&OA(t),t._dayOfYear!=null&&(s=ss(t._a[xt],i[xt]),(t._dayOfYear>Na(s)||t._dayOfYear===0)&&(se(t)._overflowDayOfYear=!0),r=Ua(s,0,t._dayOfYear),t._a[Qn]=r.getUTCMonth(),t._a[Tn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[gt]===24&&t._a[an]===0&&t._a[ei]===0&&t._a[ho]===0&&(t._nextDay=!0,t._a[gt]=0),t._d=(t._useUTC?Ua:AH).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[gt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(se(t).weekdayMismatch=!0)}}function OA(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=ss(e.GG,t._a[xt],Ya(Ve(),1,4).year),n=ss(e.W,1),i=ss(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ya(Ve(),o,s),r=ss(e.gg,t._a[xt],u.year),n=ss(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>ni(r,o,s)?se(t)._overflowWeeks=!0:l!=null?se(t)._overflowWeekday=!0:(a=t_(r,n,i,o,s),t._a[xt]=a.year,t._dayOfYear=a.dayOfYear)}V.ISO_8601=function(){};V.RFC_2822=function(){};function lp(t){if(t._f===V.ISO_8601){s_(t);return}if(t._f===V.RFC_2822){a_(t);return}t._a=[],se(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=jT(t._f,t._locale).match(Xm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(gH(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&se(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),ms[o]?(n?se(t).empty=!1:se(t).unusedTokens.push(o),pH(o,n,t)):t._strict&&!n&&se(t).unusedTokens.push(o);se(t).charsLeftOver=a-l,e.length>0&&se(t).unusedInput.push(e),t._a[gt]<=12&&se(t).bigHour===!0&&t._a[gt]>0&&(se(t).bigHour=void 0),se(t).parsedDateParts=t._a.slice(0),se(t).meridiem=t._meridiem,t._a[gt]=MA(t._locale,t._a[gt],t._meridiem),u=se(t).era,u!==null&&(t._a[xt]=t._locale.erasConvertYear(u,t._a[xt])),ap(t),sp(t)}function MA(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function IA(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){se(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Gm({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],lp(e),qm(e)&&(s=!0),o+=se(e).charsLeftOver,o+=se(e).unusedTokens.length*10,se(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));_i(t,r||e)}function PA(t){if(!t._d){var e=Zm(t._i),r=e.day===void 0?e.date:e.day;t._a=WT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),ap(t)}}function xA(t){var e=new ll(sp(l_(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function l_(t){var e=t._i,r=t._f;return t._locale=t._locale||oi(t._l),e===null||r===void 0&&e===""?dc({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),un(e)?new ll(sp(e)):(al(e)?t._d=e:ln(r)?IA(t):r?lp(t):HA(t),qm(t)||(t._d=null),t))}function HA(t){var e=t._i;Qt(e)?t._d=new Date(V.now()):al(e)?t._d=new Date(e.valueOf()):typeof e=="string"?TA(t):ln(e)?(t._a=WT(e.slice(0),function(r){return parseInt(r,10)}),ap(t)):po(e)?PA(t):ii(e)?t._d=new Date(e):V.createFromInputFallback(t)}function u_(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(po(t)&&Ym(t)||ln(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,xA(o)}function Ve(t,e,r,n){return u_(t,e,r,n,!1)}var AA=Ur("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:dc()}),DA=Ur("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:dc()});function c_(t,e){var r,n;if(e.length===1&&ln(e[0])&&(e=e[0]),!e.length)return Ve();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function NA(){var t=[].slice.call(arguments,0);return c_("isBefore",t)}function kA(){var t=[].slice.call(arguments,0);return c_("isAfter",t)}var LA=function(){return Date.now?Date.now():+new Date},Zs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function FA(t){var e,r=!1,n,i=Zs.length;for(e in t)if(Ce(t,e)&&!(rt.call(Zs,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Zs[n]]){if(r)return!1;parseFloat(t[Zs[n]])!==me(t[Zs[n]])&&(r=!0)}return!0}function VA(){return this._isValid}function WA(){return hn(NaN)}function bc(t){var e=Zm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=FA(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=oi(),this._bubble()}function yu(t){return t instanceof bc}function Zg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function BA(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)me(t[s])!==me(e[s])&&o++;return o+i}function h_(t,e){J(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Pn(~~(r/60),2)+e+Pn(~~r%60,2)})}h_("Z",":");h_("ZZ","");z("Z",wc);z("ZZ",wc);Ne(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=up(wc,t)});var $A=/([\+\-]|\d\d)/gi;function up(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match($A)||["-",0,0],o=+(i[1]*60)+me(i[2]),o===0?0:i[0]==="+"?o:-o)}function cp(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(un(t)||al(t)?t.valueOf():Ve(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),V.updateOffset(r,!1),r):Ve(t).local()}function Jg(t){return-Math.round(t._d.getTimezoneOffset())}V.updateOffset=function(){};function jA(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=up(wc,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=Jg(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?g_(this,hn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,V.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Jg(this)}function zA(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function UA(t){return this.utcOffset(0,t)}function YA(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Jg(this),"m")),this}function qA(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=up(dH,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function GA(t){return this.isValid()?(t=t?Ve(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function KA(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function XA(){if(!Qt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Gm(t,this),t=l_(t),t._a?(e=t._isUTC?An(t._a):Ve(t._a),this._isDSTShifted=this.isValid()&&BA(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ZA(){return this.isValid()?!this._isUTC:!1}function JA(){return this.isValid()?this._isUTC:!1}function d_(){return this.isValid()?this._isUTC&&this._offset===0:!1}var QA=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,e1=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function hn(t,e){var r=t,n=null,i,o,s;return yu(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:ii(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=QA.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:me(n[Tn])*i,h:me(n[gt])*i,m:me(n[an])*i,s:me(n[ei])*i,ms:me(Zg(n[ho]*1e3))*i}):(n=e1.exec(t))?(i=n[1]==="-"?-1:1,r={y:zi(n[2],i),M:zi(n[3],i),w:zi(n[4],i),d:zi(n[5],i),h:zi(n[6],i),m:zi(n[7],i),s:zi(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=t1(Ve(r.from),Ve(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new bc(r),yu(t)&&Ce(t,"_locale")&&(o._locale=t._locale),yu(t)&&Ce(t,"_isValid")&&(o._isValid=t._isValid),o}hn.fn=bc.prototype;hn.invalid=WA;function zi(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function xC(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function t1(t,e){var r;return t.isValid()&&e.isValid()?(e=cp(e,t),t.isBefore(e)?r=xC(t,e):(r=xC(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function f_(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&($T(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=hn(r,n),g_(this,i,t),this}}function g_(t,e,r,n){var i=e._milliseconds,o=Zg(e._days),s=Zg(e._months);t.isValid()&&(n=n??!0,s&&JT(t,za(t,"Month")+s*r),o&&KT(t,"Date",za(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&V.updateOffset(t,o||s))}var r1=f_(1,"add"),n1=f_(-1,"subtract");function m_(t){return typeof t=="string"||t instanceof String}function i1(t){return un(t)||al(t)||m_(t)||ii(t)||s1(t)||o1(t)||t===null||t===void 0}function o1(t){var e=po(t)&&!Ym(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Ce(t,o);return e&&r}function s1(t){var e=ln(t),r=!1;return e&&(r=t.filter(function(n){return!ii(n)&&m_(t)}).length===0),e&&r}function a1(t){var e=po(t)&&!Ym(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Ce(t,o);return e&&r}function l1(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function u1(t,e){arguments.length===1&&(arguments[0]?i1(arguments[0])?(t=arguments[0],e=void 0):a1(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ve(),n=cp(r,this).startOf("day"),i=V.calendarFormat(this,n)||"sameElse",o=e&&(Dn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Ve(r)))}function c1(){return new ll(this)}function h1(t,e){var r=un(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=Yr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function d1(t,e){var r=un(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=Yr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function f1(t,e,r,n){var i=un(t)?t:Ve(t),o=un(e)?e:Ve(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function g1(t,e){var r=un(t)?t:Ve(t),n;return this.isValid()&&r.isValid()?(e=Yr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function m1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function p1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function w1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=cp(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Yr(e),e){case"year":o=bu(this,n)/12;break;case"month":o=bu(this,n);break;case"quarter":o=bu(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Nr(o)}function bu(t,e){if(t.date()<e.date())return-bu(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}V.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";V.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function v1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function y1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?vu(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Dn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",vu(r,"Z")):vu(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function b1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function C1(t){t||(t=this.isUtc()?V.defaultFormatUtc:V.defaultFormat);var e=vu(this,t);return this.localeData().postformat(e)}function S1(t,e){return this.isValid()&&(un(t)&&t.isValid()||Ve(t).isValid())?hn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function R1(t){return this.from(Ve(),t)}function E1(t,e){return this.isValid()&&(un(t)&&t.isValid()||Ve(t).isValid())?hn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function T1(t){return this.to(Ve(),t)}function p_(t){var e;return t===void 0?this._locale._abbr:(e=oi(t),e!=null&&(this._locale=e),this)}var w_=Ur("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function v_(){return this._locale}var ku=1e3,ps=60*ku,Lu=60*ps,y_=(365*400+97)*24*Lu;function ws(t,e){return(t%e+e)%e}function b_(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-y_:new Date(t,e,r).valueOf()}function C_(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-y_:Date.UTC(t,e,r)}function _1(t){var e,r;if(t=Yr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?C_:b_,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ws(e+(this._isUTC?0:this.utcOffset()*ps),Lu);break;case"minute":e=this._d.valueOf(),e-=ws(e,ps);break;case"second":e=this._d.valueOf(),e-=ws(e,ku);break}return this._d.setTime(e),V.updateOffset(this,!0),this}function O1(t){var e,r;if(t=Yr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?C_:b_,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Lu-ws(e+(this._isUTC?0:this.utcOffset()*ps),Lu)-1;break;case"minute":e=this._d.valueOf(),e+=ps-ws(e,ps)-1;break;case"second":e=this._d.valueOf(),e+=ku-ws(e,ku)-1;break}return this._d.setTime(e),V.updateOffset(this,!0),this}function M1(){return this._d.valueOf()-(this._offset||0)*6e4}function I1(){return Math.floor(this.valueOf()/1e3)}function P1(){return new Date(this.valueOf())}function x1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function H1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function A1(){return this.isValid()?this.toISOString():null}function D1(){return qm(this)}function N1(){return _i({},se(this))}function k1(){return se(this).overflow}function L1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}J("N",0,0,"eraAbbr");J("NN",0,0,"eraAbbr");J("NNN",0,0,"eraAbbr");J("NNNN",0,0,"eraName");J("NNNNN",0,0,"eraNarrow");J("y",["y",1],"yo","eraYear");J("y",["yy",2],0,"eraYear");J("y",["yyy",3],0,"eraYear");J("y",["yyyy",4],0,"eraYear");z("N",hp);z("NN",hp);z("NNN",hp);z("NNNN",G1);z("NNNNN",K1);Ne(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?se(r).era=i:se(r).invalidEra=t});z("y",Fs);z("yy",Fs);z("yyy",Fs);z("yyyy",Fs);z("yo",X1);Ne(["y","yy","yyy","yyyy"],xt);Ne(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[xt]=r._locale.eraYearOrdinalParse(t,i):e[xt]=parseInt(t,10)});function F1(t,e){var r,n,i,o=this._eras||oi("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=V(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=V(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function V1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function W1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?V(t.since).year():V(t.since).year()+(e-t.offset)*r}function B1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function $1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function j1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function z1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-V(i[t].since).year())*r+i[t].offset;return this.year()}function U1(t){return Ce(this,"_erasNameRegex")||dp.call(this),t?this._erasNameRegex:this._erasRegex}function Y1(t){return Ce(this,"_erasAbbrRegex")||dp.call(this),t?this._erasAbbrRegex:this._erasRegex}function q1(t){return Ce(this,"_erasNarrowRegex")||dp.call(this),t?this._erasNarrowRegex:this._erasRegex}function hp(t,e){return e.erasAbbrRegex(t)}function G1(t,e){return e.erasNameRegex(t)}function K1(t,e){return e.erasNarrowRegex(t)}function X1(t,e){return e._eraYearOrdinalRegex||Fs}function dp(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=ri(u[i].name),a=ri(u[i].abbr),l=ri(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}J(0,["gg",2],0,function(){return this.weekYear()%100});J(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Cc(t,e){J(0,[t,t.length],0,e)}Cc("gggg","weekYear");Cc("ggggg","weekYear");Cc("GGGG","isoWeekYear");Cc("GGGGG","isoWeekYear");z("G",pc);z("g",pc);z("GG",We,Tr);z("gg",We,Tr);z("GGGG",Qm,Jm);z("gggg",Qm,Jm);z("GGGGG",mc,fc);z("ggggg",mc,fc);cl(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=me(t)});cl(["gg","GG"],function(t,e,r,n){e[n]=V.parseTwoDigitYear(t)});function Z1(t){return S_.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function J1(t){return S_.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Q1(){return ni(this.year(),1,4)}function eD(){return ni(this.isoWeekYear(),1,4)}function tD(){var t=this.localeData()._week;return ni(this.year(),t.dow,t.doy)}function rD(){var t=this.localeData()._week;return ni(this.weekYear(),t.dow,t.doy)}function S_(t,e,r,n,i){var o;return t==null?Ya(this,n,i).year:(o=ni(t,n,i),e>o&&(e=o),nD.call(this,t,e,r,n,i))}function nD(t,e,r,n,i){var o=t_(t,e,r,n,i),s=Ua(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}J("Q",0,"Qo","quarter");z("Q",zT);Ne("Q",function(t,e){e[Qn]=(me(t)-1)*3});function iD(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}J("D",["DD",2],"Do","date");z("D",We,Vs);z("DD",We,Tr);z("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Ne(["D","DD"],Tn);Ne("Do",function(t,e){e[Tn]=me(t.match(We)[0])});var R_=Ws("Date",!0);J("DDD",["DDDD",3],"DDDo","dayOfYear");z("DDD",gc);z("DDDD",UT);Ne(["DDD","DDDD"],function(t,e,r){r._dayOfYear=me(t)});function oD(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}J("m",["mm",2],0,"minute");z("m",We,ep);z("mm",We,Tr);Ne(["m","mm"],an);var sD=Ws("Minutes",!1);J("s",["ss",2],0,"second");z("s",We,ep);z("ss",We,Tr);Ne(["s","ss"],ei);var aD=Ws("Seconds",!1);J("S",0,0,function(){return~~(this.millisecond()/100)});J(0,["SS",2],0,function(){return~~(this.millisecond()/10)});J(0,["SSS",3],0,"millisecond");J(0,["SSSS",4],0,function(){return this.millisecond()*10});J(0,["SSSSS",5],0,function(){return this.millisecond()*100});J(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});J(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});J(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});J(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});z("S",gc,zT);z("SS",gc,Tr);z("SSS",gc,UT);var Oi,E_;for(Oi="SSSS";Oi.length<=9;Oi+="S")z(Oi,Fs);function lD(t,e){e[ho]=me(("0."+t)*1e3)}for(Oi="S";Oi.length<=9;Oi+="S")Ne(Oi,lD);E_=Ws("Milliseconds",!1);J("z",0,0,"zoneAbbr");J("zz",0,0,"zoneName");function uD(){return this._isUTC?"UTC":""}function cD(){return this._isUTC?"Coordinated Universal Time":""}var D=ll.prototype;D.add=r1;D.calendar=u1;D.clone=c1;D.diff=w1;D.endOf=O1;D.format=C1;D.from=S1;D.fromNow=R1;D.to=E1;D.toNow=T1;D.get=bH;D.invalidAt=k1;D.isAfter=h1;D.isBefore=d1;D.isBetween=f1;D.isSame=g1;D.isSameOrAfter=m1;D.isSameOrBefore=p1;D.isValid=D1;D.lang=w_;D.locale=p_;D.localeData=v_;D.max=DA;D.min=AA;D.parsingFlags=N1;D.set=CH;D.startOf=_1;D.subtract=n1;D.toArray=x1;D.toObject=H1;D.toDate=P1;D.toISOString=y1;D.inspect=b1;typeof Symbol<"u"&&Symbol.for!=null&&(D[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});D.toJSON=A1;D.toString=v1;D.unix=I1;D.valueOf=M1;D.creationData=L1;D.eraName=B1;D.eraNarrow=$1;D.eraAbbr=j1;D.eraYear=z1;D.year=GT;D.isLeapYear=yH;D.weekYear=Z1;D.isoWeekYear=J1;D.quarter=D.quarters=iD;D.month=QT;D.daysInMonth=PH;D.week=D.weeks=FH;D.isoWeek=D.isoWeeks=VH;D.weeksInYear=tD;D.weeksInWeekYear=rD;D.isoWeeksInYear=Q1;D.isoWeeksInISOWeekYear=eD;D.date=R_;D.day=D.days=JH;D.weekday=QH;D.isoWeekday=eA;D.dayOfYear=oD;D.hour=D.hours=aA;D.minute=D.minutes=sD;D.second=D.seconds=aD;D.millisecond=D.milliseconds=E_;D.utcOffset=jA;D.utc=UA;D.local=YA;D.parseZone=qA;D.hasAlignedHourOffset=GA;D.isDST=KA;D.isLocal=ZA;D.isUtcOffset=JA;D.isUtc=d_;D.isUTC=d_;D.zoneAbbr=uD;D.zoneName=cD;D.dates=Ur("dates accessor is deprecated. Use date instead.",R_);D.months=Ur("months accessor is deprecated. Use month instead",QT);D.years=Ur("years accessor is deprecated. Use year instead",GT);D.zone=Ur("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",zA);D.isDSTShifted=Ur("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",XA);function hD(t){return Ve(t*1e3)}function dD(){return Ve.apply(null,arguments).parseZone()}function T_(t){return t}var Se=Km.prototype;Se.calendar=Zx;Se.longDateFormat=tH;Se.invalidDate=nH;Se.ordinal=sH;Se.preparse=T_;Se.postformat=T_;Se.relativeTime=lH;Se.pastFuture=uH;Se.set=Kx;Se.eras=F1;Se.erasParse=V1;Se.erasConvertYear=W1;Se.erasAbbrRegex=Y1;Se.erasNameRegex=U1;Se.erasNarrowRegex=q1;Se.months=_H;Se.monthsShort=OH;Se.monthsParse=IH;Se.monthsRegex=HH;Se.monthsShortRegex=xH;Se.week=DH;Se.firstDayOfYear=LH;Se.firstDayOfWeek=kH;Se.weekdays=qH;Se.weekdaysMin=KH;Se.weekdaysShort=GH;Se.weekdaysParse=ZH;Se.weekdaysRegex=tA;Se.weekdaysShortRegex=rA;Se.weekdaysMinRegex=nA;Se.isPM=oA;Se.meridiem=lA;function Fu(t,e,r,n){var i=oi(),o=An().set(n,e);return i[r](o,t)}function __(t,e,r){if(ii(t)&&(e=t,t=void 0),t=t||"",e!=null)return Fu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Fu(t,n,r,"month");return i}function fp(t,e,r,n){typeof t=="boolean"?(ii(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,ii(e)&&(r=e,e=void 0),e=e||"");var i=oi(),o=t?i._week.dow:0,s,a=[];if(r!=null)return Fu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=Fu(e,(s+o)%7,n,"day");return a}function fD(t,e){return __(t,e,"months")}function gD(t,e){return __(t,e,"monthsShort")}function mD(t,e,r){return fp(t,e,r,"weekdays")}function pD(t,e,r){return fp(t,e,r,"weekdaysShort")}function wD(t,e,r){return fp(t,e,r,"weekdaysMin")}Hi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=me(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});V.lang=Ur("moment.lang is deprecated. Use moment.locale instead.",Hi);V.langData=Ur("moment.langData is deprecated. Use moment.localeData instead.",oi);var Wn=Math.abs;function vD(){var t=this._data;return this._milliseconds=Wn(this._milliseconds),this._days=Wn(this._days),this._months=Wn(this._months),t.milliseconds=Wn(t.milliseconds),t.seconds=Wn(t.seconds),t.minutes=Wn(t.minutes),t.hours=Wn(t.hours),t.months=Wn(t.months),t.years=Wn(t.years),this}function O_(t,e,r,n){var i=hn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function yD(t,e){return O_(this,t,e,1)}function bD(t,e){return O_(this,t,e,-1)}function HC(t){return t<0?Math.floor(t):Math.ceil(t)}function CD(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=HC(Qg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Nr(t/1e3),n.seconds=i%60,o=Nr(i/60),n.minutes=o%60,s=Nr(o/60),n.hours=s%24,e+=Nr(s/24),l=Nr(M_(e)),r+=l,e-=HC(Qg(l)),a=Nr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function M_(t){return t*4800/146097}function Qg(t){return t*146097/4800}function SD(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Yr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+M_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(Qg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function si(t){return function(){return this.as(t)}}var I_=si("ms"),RD=si("s"),ED=si("m"),TD=si("h"),_D=si("d"),OD=si("w"),MD=si("M"),ID=si("Q"),PD=si("y"),xD=I_;function HD(){return hn(this)}function AD(t){return t=Yr(t),this.isValid()?this[t+"s"]():NaN}function Ao(t){return function(){return this.isValid()?this._data[t]:NaN}}var DD=Ao("milliseconds"),ND=Ao("seconds"),kD=Ao("minutes"),LD=Ao("hours"),FD=Ao("days"),VD=Ao("months"),WD=Ao("years");function BD(){return Nr(this.days()/7)}var Kn=Math.round,cs={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function $D(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function jD(t,e,r,n){var i=hn(t).abs(),o=Kn(i.as("s")),s=Kn(i.as("m")),a=Kn(i.as("h")),l=Kn(i.as("d")),u=Kn(i.as("M")),c=Kn(i.as("w")),h=Kn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,$D.apply(null,d)}function zD(t){return t===void 0?Kn:typeof t=="function"?(Kn=t,!0):!1}function UD(t,e){return cs[t]===void 0?!1:e===void 0?cs[t]:(cs[t]=e,t==="s"&&(cs.ss=e-1),!0)}function YD(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=cs,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},cs,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=jD(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Af=Math.abs;function Wo(t){return(t>0)-(t<0)||+t}function Sc(){if(!this.isValid())return this.localeData().invalidDate();var t=Af(this._milliseconds)/1e3,e=Af(this._days),r=Af(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Nr(t/60),i=Nr(n/60),t%=60,n%=60,o=Nr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Wo(this._months)!==Wo(a)?"-":"",c=Wo(this._days)!==Wo(a)?"-":"",h=Wo(this._milliseconds)!==Wo(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var ve=bc.prototype;ve.isValid=VA;ve.abs=vD;ve.add=yD;ve.subtract=bD;ve.as=SD;ve.asMilliseconds=I_;ve.asSeconds=RD;ve.asMinutes=ED;ve.asHours=TD;ve.asDays=_D;ve.asWeeks=OD;ve.asMonths=MD;ve.asQuarters=ID;ve.asYears=PD;ve.valueOf=xD;ve._bubble=CD;ve.clone=HD;ve.get=AD;ve.milliseconds=DD;ve.seconds=ND;ve.minutes=kD;ve.hours=LD;ve.days=FD;ve.weeks=BD;ve.months=VD;ve.years=WD;ve.humanize=YD;ve.toISOString=Sc;ve.toString=Sc;ve.toJSON=Sc;ve.locale=p_;ve.localeData=v_;ve.toIsoString=Ur("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Sc);ve.lang=w_;J("X",0,0,"unix");J("x",0,0,"valueOf");z("x",pc);z("X",fH);Ne("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Ne("x",function(t,e,r){r._d=new Date(me(t))});//! moment.js
V.version="2.30.1";qx(Ve);V.fn=D;V.min=NA;V.max=kA;V.now=LA;V.utc=An;V.unix=hD;V.months=fD;V.isDate=al;V.locale=Hi;V.invalid=dc;V.duration=hn;V.isMoment=un;V.weekdays=mD;V.parseZone=dD;V.localeData=oi;V.isDuration=yu;V.monthsShort=gD;V.weekdaysMin=wD;V.defineLocale=op;V.updateLocale=dA;V.locales=fA;V.weekdaysShort=pD;V.normalizeUnits=Yr;V.relativeTimeRounding=zD;V.relativeTimeThreshold=UD;V.calendarFormat=l1;V.prototype=D;V.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var AC={},DC={},NC;function qD(){if(NC)return DC;NC=1;var t=Fe(),e=Ls(),r=Rr(),n=vt(),i=Wi(),o=Er(),s=Ho(),a=il(),l=ct(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(b){o(this,"throw",b)}var w=arguments.length<2,v=w?void 0:arguments[1];if(h)return a(h,this,w?[g]:[g,v]);var C=i(this),T=0;if(e(C,function(b){w?(w=!1,v=b):v=g(v,b,T),T++},{IS_RECORD:!0}),w)throw new u("Reduce of empty iterator with no initial value");return v}}),DC}var kC;function GD(){return kC||(kC=1,qD()),AC}GD();function KD(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function LC(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Df(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Do(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function gp(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function xn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function j(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function FC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return j(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function VC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function ar(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Do(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function mp(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function he(t){return typeof t<"u"}function $t(t){return typeof t>"u"}function yo(t){return t===null||t===""||$t(t)}function XD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const _a="length",ka=t=>parseInt(t,16),WC=t=>parseInt(t,10),Vu=(t,e,r)=>t.substr(e,r),La=t=>t.codePointAt(0)-65,em=t=>`${t}`.replace(/\-/g,""),ZD=t=>ka(Vu(em(t),ka("12"),La("F")))/(ka(Vu(em(t),La("B"),~~![][_a]))||9),JD=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let BC=!1;const $C={invalid:()=>ar`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ar`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ar`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},jC={invalid:()=>ar`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ar`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ar`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function QD(t,e){const r=!yo(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.1.1";let o,s="invalid",a="invalid";t=em(t||"");const l=eN(t);if(r||n||l)if(l){const u=V("23/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=ZD(t);o=V((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(JD()&&(s="valid",a="valid"),!BC&&s!=="valid"&&($C[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"]($C[s]({keyValidityDate:o,hotVersion:i})),BC=!0),a!=="valid"&&e&&jC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=jC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function eN(t){let e=[][_a],r=e;if(t[_a]!==La("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=La(i.shift());o;o=La(i.shift()||"A"))--o<""[_a]?r=r|(WC(`${WC(ka(n)+(ka(Vu(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Vu(t,o,o?i[_a]===1?9:8:6);return r===e}function tm(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function rm(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function Rc(t){return t[0].toUpperCase()+t.substr(1)}function P_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function tN(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function rN(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function x_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function H_(t,e){return Yx.sanitize(t,e)}const No=t=>["tabindex",t],nN=()=>["role","treegrid"],Mi=()=>["role","presentation"],iN=()=>["role","gridcell"],oN=()=>["role","gridcell button"],sN=()=>["role","rowheader"],A_=()=>["role","rowgroup"],aN=()=>["role","columnheader"],D_=()=>["role","row"],lN=()=>["role","menu"],uN=()=>["role","menuitem"],cN=()=>["role","menuitemcheckbox"],hN=()=>["scope","col"],dN=()=>["scope","row"],Wu=t=>["aria-label",t],fN=()=>["aria-hidden","true"],gN=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},mN=()=>["aria-multiselectable","true"],N_=t=>["aria-rowcount",t],Ec=t=>["aria-colcount",t],k_=t=>["aria-rowindex",t],pp=t=>["aria-colindex",t],Cu=t=>["aria-expanded",t],zC=()=>["aria-readonly","true"],UC=()=>["aria-invalid","true"],pN=t=>["aria-checked",t],L_=()=>["aria-selected","true"];var YC={},Nf,qC;function wN(){if(qC)return Nf;qC=1;var t=ot(),e=wT(),r=ht(),n=_o(),i=hc(),o=t([].push);return Nf=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,w){if(d)return d=!1,w;if(e(this))return w;for(var v=0;v<h;v++)if(l[v]===g)return w}}},Nf}var GC;function vN(){if(GC)return YC;GC=1;var t=Fe(),e=As(),r=il(),n=wt(),i=ot(),o=ct(),s=ht(),a=Nm(),l=Um(),u=wN(),c=Dm(),h=String,d=e("JSON","stringify"),g=i(/./.exec),w=i("".charAt),v=i("".charCodeAt),C=i("".replace),T=i(1.1.toString),b=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,I=!c||o(function(){var F=e("Symbol")("stringify detection");return d([F])!=="[null]"||d({a:F})!=="{}"||d(Object(F))!=="{}"}),x=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),P=function(F,W){var q=l(arguments),L=u(W);if(!(!s(L)&&(F===void 0||a(F))))return q[1]=function(ae,K){if(s(L)&&(K=n(L,this,h(ae),K)),!a(K))return K},r(d,null,q)},A=function(F,W,q){var L=w(q,W-1),ae=w(q,W+1);return g(E,F)&&!g(y,ae)||g(y,F)&&!g(E,L)?"\\u"+T(v(F,0),16):F};return d&&t({target:"JSON",stat:!0,arity:3,forced:I||x},{stringify:function(W,q,L){var ae=l(arguments),K=r(I?P:d,null,ae);return x&&typeof K=="string"?C(K,b,A):K}}),YC}vN();function Ga(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},He(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Ga(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Ga(r[0])]:e[n]=[]:e[n]=null)})),e}function yN(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Di(t,e,r){const n=Array.isArray(r);return He(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function F_(t,e){He(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),F_(t[n],e[n])):t[n]=e[n]})}function Sr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Je(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j(r,i=>{t.MIXINS.push(i.MIXIN_NAME),He(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=w=>{let v=w;return(Array.isArray(v)||nt(v))&&(v=Sr(v)),v};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function V_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function nt(t){return Object.prototype.toString.call(t)==="[object Object]"}function ai(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function He(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function nm(t,e){const r=e.split(".");let n=t;return He(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function kf(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(Wr(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function wp(t){if(!nt(t))return 0;const e=function(r){let n=0;return nt(r)?He(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function yr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Wr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Su(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=Su(t[n],e[n]):r[n]=Wr(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{Wr(r,n)||(r[n]=t[n])}),r}function im(t){return window.requestAnimationFrame(t)}function KC(t){window.cancelAnimationFrame(t)}function bN(){return"ontouchstart"in window}function CN(){return typeof window<"u"}const Dr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Bi={chrome:Dr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Dr(t=>/CriOS/.test(t)),edge:Dr(t=>/Edge/.test(t)),edgeWebKit:Dr(t=>/EdgiOS/.test(t)),firefox:Dr(t=>/Firefox/.test(t)),firefoxWebKit:Dr(t=>/FxiOS/.test(t)),mobile:Dr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Dr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},hl={mac:Dr(t=>/^Mac/.test(t)),win:Dr(t=>/^Win/.test(t)),linux:Dr(t=>/^Linux/.test(t)),ios:Dr(t=>/iPhone|iPad|iPod/i.test(t))};function SN(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(Bi,r=>{let{test:n}=r;return void n(t,e)})}function RN(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};He(hl,e=>{let{test:r}=e;return void r(t)})}CN()&&(SN(),RN());function EN(){return Bi.chrome.value}function TN(){return Bi.chromeWebKit.value}function Lf(){return Bi.firefox.value}function _N(){return Bi.firefoxWebKit.value}function vp(){return Bi.safari.value}function ON(){return Bi.edge.value}function Ii(){return Bi.mobile.value}function W_(){return hl.ios.value}function B_(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&hl.mac.value}function XC(){return hl.win.value}function ZC(){return hl.mac.value}function MN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Ru(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function IN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Ka(t){return IN(t)&&t.parent}function $_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function _l(t,e,r){const n=[];let i=t;for(;i&&(i=$_(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function PN(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function vs(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function xN(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Ui(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function j_(t){return!t||!t.length?[]:t.filter(e=>!!e)}function z_(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=j_(e),e.length>0&&t.classList.add(...e)}function xe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=z_(e,!0);r=j_(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Me(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function dl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=z_(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function U_(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)U_(e[r])}}function _s(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const HN=/(<(.*)>|&(.*);)/;function Y_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HN.test(e)?t.innerHTML=r?H_(e):e:fl(t,e)}function fl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(_s(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Xa(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Xa(n.host.impl);if(n.host)return Xa(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function AN(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function kr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function q_(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function yp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function bp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?q_(e):t.scrollTop}function G_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?yp(e):t.scrollLeft}function Bu(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function DN(t){return t.scrollHeight-t.clientHeight}function NN(t){return t.scrollWidth-t.clientWidth}function $u(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function JC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function ir(t){return t.offsetWidth}function lr(t){return t.getBoundingClientRect().height}function Fa(t){return t.clientHeight||t.innerHeight}function K_(t){return t.clientWidth||t.innerWidth}function kN(t){return t.selectionStart?t.selectionStart:0}function QC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function X_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let Ff;function LN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");vp()&&!Ii()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ff===void 0&&(Ff=LN(t)),Ff}function FN(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function VN(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Cp(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Tc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Eu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Z_(t){return Eu(t)&&t.hasAttribute("data-hot-input")===!1}function WN(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function J_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Me(t,"contenteditable",!0),r&&Me(t,...fN()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function Q_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&xe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function BN(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;J_(t,r),e(),Q_(t,r)}function wo(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Oe(t){return typeof t=="function"}function e0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function $N(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function om(t,e,r,n,i,o,s,a){return he(a)?t.call(e,r,n,i,o,s,a):he(s)?t.call(e,r,n,i,o,s):he(o)?t.call(e,r,n,i,o):he(i)?t.call(e,r,n,i):he(n)?t.call(e,r,n):he(r)?t.call(e,r):t.call(e)}const ee={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Lf()?182:174,AUDIO_MUTE:Lf()?181:173,AUDIO_UP:Lf()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},jN=[ee.ALT,ee.ARROW_DOWN,ee.ARROW_LEFT,ee.ARROW_RIGHT,ee.ARROW_UP,ee.AUDIO_DOWN,ee.AUDIO_MUTE,ee.AUDIO_UP,ee.BACKSPACE,ee.CAPS_LOCK,ee.DELETE,ee.END,ee.ENTER,ee.ESCAPE,ee.F1,ee.F2,ee.F3,ee.F4,ee.F5,ee.F6,ee.F7,ee.F8,ee.F9,ee.F10,ee.F11,ee.F12,ee.F13,ee.F14,ee.F15,ee.F16,ee.F17,ee.F18,ee.F19,ee.HOME,ee.INSERT,ee.MEDIA_NEXT,ee.MEDIA_PLAY_PAUSE,ee.MEDIA_PREV,ee.MEDIA_STOP,ee.NULL,ee.NUM_LOCK,ee.PAGE_DOWN,ee.PAGE_UP,ee.PAUSE,ee.SCROLL_LOCK,ee.SHIFT,ee.TAB];function zN(t){return jN.includes(t)}function UN(t){return[ee.CONTROL,ee.COMMAND_LEFT,ee.COMMAND_RIGHT,ee.COMMAND_FIREFOX].includes(t)}function YN(t,e){const r=e.split("|");let n=!1;return j(r,i=>{if(t===ee[i])return n=!0,!1}),n}function _c(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function so(t){return t.isImmediatePropagationEnabled===!1}function ju(t){return t.button===2}function t0(t){return t.button===0}function Br(){he(console)&&console.warn(...arguments)}function qN(t){he(console)&&console.warn(`Deprecated: ${t}`)}function GN(){he(console)&&console.error(...arguments)}const ao=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Vf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Wf=new Map([[]]);var eS={},Bf,tS;function KN(){if(tS)return Bf;tS=1;var t=ks();return Bf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},Bf}var $f,rS;function XN(){if(rS)return $f;rS=1;var t=it();return $f=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},$f}var jf,nS;function Sp(){if(nS)return jf;nS=1;var t=cn(),e=zm(),r=Vi().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),jf=function(o){i[n][o]=!0},jf}var iS;function ZN(){if(iS)return eS;iS=1;var t=Fe(),e=ot(),r=Rr(),n=el(),i=KN(),o=XN(),s=Sp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),eS}ZN();var oS={},sS={},aS;function JN(){if(aS)return sS;aS=1;var t=Fe(),e=wt(),r=Ls(),n=Rr(),i=vt(),o=Wi(),s=Er(),a=Ho(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),sS}var lS;function QN(){return lS||(lS=1,JN()),oS}QN();function ek(t,e){r0(t,e),e.add(t)}function zf(t,e,r){r0(t,e),e.set(t,r)}function r0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uS(t,e,r){return t.set(zu(t,e),r),r}function St(t,e){return t.get(zu(t,e))}function zu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tk=100;var mr=new WeakMap,as=new WeakMap,Uf=new WeakMap,Yf=new WeakSet;class cS{constructor(){ek(this,Yf),zf(this,mr,new Map),zf(this,as,new Map),zf(this,Uf,new Set),ao.forEach(e=>zu(Yf,this,hS).call(this,e))}getHooks(e){var r;return(r=St(mr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};St(mr,this).has(e)||(zu(Yf,this,hS).call(this,e),ao.push(e));const i=St(mr,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=St(Uf,this).has(e);!u&&o!==0&&(u=!0,St(Uf,this).add(e)),u&&i.length>1&&St(mr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return St(mr,this).has(e)&&St(mr,this).get(e).length>0}remove(e,r){if(!St(mr,this).has(e))return!1;const n=St(mr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=St(as,this).get(e);return i.skip=!0,o+=1,o>tk&&(St(mr,this).set(e,n.filter(s=>!s.skip)),o=0),St(as,this).set(e,o),!0}return!1}destroy(){St(mr,this).clear(),St(as,this).clear(),uS(mr,this,null),uS(as,this,null)}}function hS(t){St(mr,this).set(t,[]),St(as,this).set(t,0)}function rk(t,e,r){return(e=nk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nk(t){var e=ik(t,"string");return typeof e=="symbol"?e:e+""}function ik(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ok=ar`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class fe{constructor(){rk(this,"globalBucket",new cS)}static getSingleton(){return ak()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new cS),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.add(e,o,n)):(Vf.has(e)&&Br(x_(ok,{hookName:e,removedInVersion:Vf.get(e)})),Wf.has(e)&&Br(Wf.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?j(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=om(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=om(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ao.push(e)}deregister(e){this.isRegistered(e)&&ao.splice(ao.indexOf(e),1)}isDeprecated(e){return Wf.has(e)||Vf.has(e)}isRegistered(e){return ao.indexOf(e)>=0}getRegistered(){return ao}}const sk=new fe;function ak(){return sk}const fo=new Map;function ko(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";fo.has(t)||fo.set(t,new Map);const e=fo.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){fo.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function lk(t,e){var r;return fo==null||(r=fo.get(t.guid))===null||r===void 0?void 0:r.get(e)}const sm=new WeakMap,{register:uk,getItem:n0,hasItem:i0}=ko("editors");function ck(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function hk(t,e){let r;if(typeof t=="function")sm.get(t)||o0(null,t),r=sm.get(t);else if(typeof t=="string")r=n0(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function dS(t){if(typeof t=="function")return t;if(!i0(t))throw Error(`No registered editor found under "${t}" name`);return n0(t).getConstructor()}function o0(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new ck(e);typeof t=="string"&&uk(t,r),sm.set(e,r)}function dk(t,e,r){return(e=fk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fk(t){var e=gk(t,"string");return typeof e=="symbol"?e:e+""}function gk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ni{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;dk(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,mk(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function mk(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),_c(this)},t}function pk(t,e){wk(t,e),e.add(t)}function wk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e,r){return(e=vk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vk(t){var e=yk(t,"string");return typeof e=="symbol"?e:e+""}function yk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ol=new WeakSet;class am{constructor(e,r,n){pk(this,Ol),Yi(this,"hot",void 0),Yi(this,"tableMeta",void 0),Yi(this,"selection",void 0),Yi(this,"eventManager",void 0),Yi(this,"destroyed",!1),Yi(this,"activeEditor",void 0),Yi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Ni(e),this.hot.addHook("afterDocumentKeyDown",i=>qf(Ol,this,fS).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>qf(Ol,this,fS).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>qf(Ol,this,bk).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=hk(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function fS(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||so(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!zN(r)&&!UN(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function bk(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const gS=new WeakMap;am.getInstance=function(t,e,r){let n=gS.get(t);return n||(n=new am(t,e,r),gS.set(t,n)),n};function Ck(t,e){s0(t,e),e.add(t)}function Js(t,e,r){s0(t,e),e.set(t,r)}function s0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(t,e){return t.get(Jn(t,e))}function Qs(t,e,r){return t.set(Jn(t,e),r),r}function Jn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ys=Object.freeze({CELL:"cell",MIXED:"mixed"});var at=new WeakMap,Ml=new WeakMap,Il=new WeakMap,Pl=new WeakMap,xl=new WeakMap,Ei=new WeakSet;class Sk{constructor(e){var r=this;Ck(this,Ei),Js(this,at,void 0),Js(this,Ml,void 0),Js(this,Il,1),Js(this,Pl,null),Js(this,xl,new Map);const n=e.getSettings();Qs(at,this,e),Qs(Ml,this,n.imeFastEdit?ys.MIXED:ys.CELL),Le(at,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jn(Ei,r,Ek).call(r,...o)}),Le(at,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jn(Ei,r,mS).call(r,...o)}),Le(at,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jn(Ei,r,mS).call(r,...o)}),Le(at,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jn(Ei,r,Rk).call(r,...o)})}getFocusMode(){return Le(Ml,this)}setFocusMode(e){Object.values(ys).includes(e)?Qs(Ml,this,e):Br(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Le(Il,this)}setRefocusDelay(e){Qs(Il,this,e)}setRefocusElementGetter(e){Qs(Pl,this,e)}getRefocusElement(){var e;return typeof Le(Pl,this)=="function"?Le(Pl,this).call(this):(e=Le(at,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Le(at,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Le(at,this).runHooks("modifyFocusedElement",s.row,s.col,n);wo(a)||(a=n),a&&!((o=Le(at,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Jn(Ei,this,Rp).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Le(Il,this);if(Le(at,this).getSettings().imeFastEdit&&!((e=Le(at,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Le(at,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Le(xl,this).has(r)||Le(xl,this).set(r,e0(()=>{if(!Le(at,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Le(xl,this).get(r)()}}}function Rp(t){var e;const r=(e=Le(at,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!Le(at,this).selection.isCellVisible(r)){t(null);return}const n=Le(at,this).getCell(r.row,r.col,!0);n===null?Le(at,this).addHookOnce("afterScroll",()=>{t(Le(at,this).getCell(r.row,r.col,!0))}):t(n)}function mS(){Jn(Ei,this,Rp).call(this,t=>{const{activeElement:e}=Le(at,this).rootDocument;e&&Z_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Rk(){Jn(Ei,this,Rp).call(this,t=>{this.getFocusMode()===ys.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Ek(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?ys.MIXED:ys.CELL)}var pS={},Gf,wS;function Tk(){if(wS)return Gf;wS=1;var t=jr(),e=_o(),r=cn(),n=r("match");return Gf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Gf}var Kf,vS;function _k(){if(vS)return Kf;vS=1;var t=it(),e=ct(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return Kf={correct:n},Kf}var Xf,yS;function Ok(){if(yS)return Xf;yS=1;var t=vt();return Xf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},Xf}var Zf,bS;function Mk(){if(bS)return Zf;bS=1;var t=wt(),e=zr(),r=tl(),n=_k(),i=Ok(),o=RegExp.prototype;return Zf=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},Zf}var Jf,CS;function Ik(){if(CS)return Jf;CS=1;var t=ot(),e=Ds(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return Jf=function(l,u,c,h,d,g){var w=c+l.length,v=h.length,C=a;return d!==void 0&&(d=e(d),C=s),i(g,C,function(T,b){var E;switch(n(b,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":E=d[o(b,1,-1)];break;default:var y=+b;if(y===0)return T;if(y>v){var I=r(y/10);return I===0?T:I<=v?h[I-1]===void 0?n(b,1):h[I-1]+n(b,1):T}E=h[y-1]}return E===void 0?"":E})},Jf}var SS;function Pk(){if(SS)return pS;SS=1;var t=Fe(),e=wt(),r=ot(),n=Qa(),i=ht(),o=jr(),s=Tk(),a=hc(),l=rl(),u=Mk(),c=Ik(),h=cn(),d=Oo(),g=h("replace"),w=TypeError,v=r("".indexOf),C=r("".replace),T=r("".slice),b=Math.max;return t({target:"String",proto:!0},{replaceAll:function(y,I){var x=n(this),P,A,F,W,q,L,ae,K,te,dt,Re=0,Ee="";if(o(y)){if(P=s(y),P&&(A=a(n(u(y))),!~v(A,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(F=l(y,g),F)return e(F,y,x,I);if(d&&P)return C(a(x),y,I)}for(W=a(x),q=a(y),L=i(I),L||(I=a(I)),ae=q.length,K=b(1,ae),te=v(W,q);te!==-1;)dt=L?a(I(q,te,W)):c(q,W,te,[],void 0,I),Ee+=T(W,Re,te)+dt,Re=te+ae,te=te+K>W.length?-1:v(W,q,te+K);return Re<W.length&&(Ee+=T(W,Re)),Ee}}),pS}Pk();const a0={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},xk=new RegExp(Object.keys(a0).map(t=>`(${t})`).join("|"),"gi");function Hk(t){return(t&&t.nodeName||"")==="TABLE"}function RS(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,w=[];for(let C=0;C<s;C+=1){const T=!g&&r&&C===0;let b="";if(g)b=`<th>${t.getColHeader(C-c)}</th>`;else if(T)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const E=i[d][C],{hidden:y,rowspan:I,colspan:x}=t.getCellMeta(d-h,C-c);if(!y){const P=[];if(I&&P.push(`rowspan="${I}"`),x&&P.push(`colspan="${x}"`),yo(E))b=`<td ${P.join(" ")}></td>`;else{const A=E.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${P.join(" ")}>${A}</td>`}}}w.push(b)}const v=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function ES(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=yo(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function TS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const E=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,y=>{const I=y.match(/<td\b[^>]*?>/g)[0],x=/<p.*?>/g,P=y.substring(I.length,y.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(x,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${I}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${E}`),o=i.querySelector("table")}if(!o||!Hk(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,y)=>E+y.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,w=0;if(o.tHead){const E=Array.from(o.tHead.rows).filter(y=>{const I=y.querySelector("td")!==null;return I&&h.push(y),!I});g=E.length,d=g>0,g>1?r.nestedHeaders=Array.from(E).reduce((y,I)=>{const x=Array.from(I.cells).reduce((P,A,F)=>{if(a&&F===0)return P;const{colSpan:W,innerHTML:q}=A,L=W>1?{label:q,colspan:W}:q;return P.push(L),P},[]);return y.push(x),y},[]):d&&(r.colHeaders=Array.from(E[0].children).reduce((y,I,x)=>(a&&x===0||y.push(I.innerHTML),y),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((E,y)=>(E.push(...Array.from(y.rows)),E),[]),...c];w=v.length;const C=new Array(w);for(let E=0;E<w;E++)C[E]=new Array(u);const T=[],b=[];for(let E=0;E<w;E++){const y=v[E],I=Array.from(y.cells),x=I.length;for(let P=0;P<x;P++){const A=I[P],{nodeName:F,innerHTML:W,rowSpan:q,colSpan:L}=A,ae=C[E].findIndex(K=>K===void 0);if(F==="TD"){if(q>1||L>1){for(let Re=E;Re<E+q;Re++)if(Re<w)for(let Ee=ae;Ee<ae+L;Ee++)C[Re][Ee]=null;const te=A.getAttribute("style");te&&te.includes("mso-ignore:colspan")||T.push({col:ae,row:E,rowspan:q,colspan:L})}let K="";s&&/excel/gi.test(s.content)?K=W.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):K=W.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),C[E][ae]=K.replace(xk,te=>a0[te])}else b.push(W)}}return T.length&&(r.mergeCells=T),b.length&&(r.rowHeaders=b),C.length&&(r.data=C),r}function Ak(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Ge(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function _S(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function Dk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function De(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function bs(t){return Number.isInteger(t)&&t>=0}const lm="asc",Nk="desc",OS=new Map([[lm,[-1,1]],[Nk,[1,-1]]]),kk=t=>`The priority '${t}' is already declared in a map.`,Lk=t=>`The priority '${t}' is not a number.`;function Fk(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Oe(t)?t:kk,e=Oe(e)?e:Lk;function n(o,s){if(!Ak(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lm;const[s,a]=OS.get(o)||OS.get(lm);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const Vk=t=>`The id '${t}' is already declared in a map.`;function Oc(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Oe(t)?t:Vk;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const Wk=t=>`'${t}' value is already declared in a unique set.`;function Bk(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Oe(t)?t:Wk;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const Ep=t=>`There is already registered "${t}" plugin.`,$k=t=>`There is already registered plugin on priority "${t}".`,jk=t=>`The priority "${t}" is not a number.`,l0=Fk({errorPriorityExists:$k,errorPriorityNaN:jk}),u0=Bk({errorItemExists:Ep}),um=Oc({errorIdExists:Ep});function c0(){return[...l0.getItems(),...u0.getItems()]}function Tp(t){const e=Rc(t);return um.getItem(e)}function zk(t){return!!Tp(t)}function Hl(t,e,r){[t,e,r]=Yk(t,e,r),Tp(t)===void 0&&Uk(t,e,r)}function Uk(t,e,r){const n=Rc(t);if(um.hasItem(n))throw new Error(Ep(n));r===void 0?u0.addItem(n):l0.addItem(r,n),um.addItem(n,e)}function Yk(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:qk,getItem:Gk,hasItem:h0}=ko("renderers");function MS(t){if(typeof t=="function")return t;if(!h0(t))throw Error(`No registered renderer found under "${t}" name`);return Gk(t)}function Kk(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),qk(t,e)}const{register:Xk,getItem:Zk,hasItem:d0}=ko("validators");function Jk(t){if(typeof t=="function")return t;if(!d0(t))throw Error(`No registered validator found under "${t}" name`);return Zk(t)}function Qk(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Xk(t,e)}var IS={},PS;function eL(){if(PS)return IS;PS=1;var t=Fe(),e=Ds(),r=ks(),n=nl(),i=Sp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),IS}eL();var xS={},HS;function tL(){if(HS)return xS;HS=1;var t=Fe(),e=ot(),r=Qa(),n=nl(),i=hc(),o=ct(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),xS}tL();function ea(t,e,r){return(e=rL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rL(t){var e=nL(t,"string");return typeof e=="symbol"?e:e+""}function nL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iL{constructor(){ea(this,"count",0),ea(this,"startColumn",null),ea(this,"endColumn",null),ea(this,"startPosition",null),ea(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ta(t,e,r){return(e=oL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oL(t){var e=sL(t,"string");return typeof e=="symbol"?e:e+""}function sL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aL{constructor(){ta(this,"count",0),ta(this,"startRow",null),ta(this,"endRow",null),ta(this,"startPosition",null),ta(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ra(t,e,r){return(e=lL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lL(t){var e=uL(t,"string");return typeof e=="symbol"?e:e+""}function uL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f0{constructor(){ra(this,"count",0),ra(this,"startColumn",null),ra(this,"endColumn",null),ra(this,"startPosition",null),ra(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function na(t,e,r){return(e=cL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cL(t){var e=hL(t,"string");return typeof e=="symbol"?e:e+""}function hL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g0{constructor(){na(this,"count",0),na(this,"startRow",null),na(this,"endRow",null),na(this,"startPosition",null),na(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ia(t,e,r){return(e=dL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dL(t){var e=fL(t,"string");return typeof e=="symbol"?e:e+""}function fL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gL{constructor(){ia(this,"count",0),ia(this,"startColumn",0),ia(this,"endColumn",0),ia(this,"startPosition",0),ia(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function oa(t,e,r){return(e=mL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mL(t){var e=pL(t,"string");return typeof e=="symbol"?e:e+""}function pL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wL{constructor(){oa(this,"count",0),oa(this,"startRow",0),oa(this,"endRow",0),oa(this,"startPosition",0),oa(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function AS(t,e,r){return(e=vL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vL(t){var e=yL(t,"string");return typeof e=="symbol"?e:e+""}function yL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bL extends f0{constructor(){super(...arguments),AS(this,"columnStartOffset",0),AS(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function DS(t,e,r){return(e=CL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CL(t){var e=SL(t,"string");return typeof e=="symbol"?e:e+""}function SL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RL extends g0{constructor(){super(...arguments),DS(this,"rowStartOffset",0),DS(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function NS(t,e,r){return(e=EL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EL(t){var e=TL(t,"string");return typeof e=="symbol"?e:e+""}function TL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m0{constructor(e){NS(this,"calculationTypes",[]),NS(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Kr(t,e,r){return(e=_L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _L(t){var e=OL(t,"string");return typeof e=="symbol"?e:e+""}function OL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _p=50;class ML extends m0{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Kr(this,"viewportWidth",0),Kr(this,"scrollOffset",0),Kr(this,"zeroBasedScrollOffset",0),Kr(this,"totalColumns",0),Kr(this,"columnWidthFn",null),Kr(this,"columnWidth",0),Kr(this,"overrideFn",null),Kr(this,"inlineStartOffset",0),Kr(this,"totalCalculatedWidth",0),Kr(this,"startPositions",[]),Kr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?_p:r}}function Mr(t,e,r){return(e=IL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IL(t){var e=PL(t,"string");return typeof e=="symbol"?e:e+""}function PL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xL extends m0{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Mr(this,"viewportHeight",0),Mr(this,"scrollOffset",0),Mr(this,"zeroBasedScrollOffset",0),Mr(this,"totalRows",0),Mr(this,"rowHeightFn",null),Mr(this,"rowHeight",0),Mr(this,"overrideFn",null),Mr(this,"horizontalScrollbarHeight",0),Mr(this,"innerViewportHeight",0),Mr(this,"totalCalculatedHeight",0),Mr(this,"startPositions",[]),Mr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function HL(t,e,r){AL(t,e),e.set(t,r)}function AL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kS(t,e,r){return(e=DL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DL(t){var e=NL(t,"string");return typeof e=="symbol"?e:e+""}function NL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bo(t,e){return t.get(p0(t,e))}function LS(t,e,r){return t.set(p0(t,e),r),r}function p0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap;class bo{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;kS(this,"row",null),kS(this,"col",null),HL(this,Bn,!1),LS(Bn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Bo(Bn,this)}isSouthEastOf(e){return this.row>=e.row&&(Bo(Bn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Bo(Bn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Bo(Bn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Bo(Bn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof bo&&LS(Bn,this,e.isRtl()),this}clone(){return new bo(this.row,this.col,Bo(Bn,this))}toObject(){return{row:this.row,col:this.col}}}function kL(t,e,r){LL(t,e),e.set(t,r)}function LL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qf(t,e,r){return(e=FL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FL(t){var e=VL(t,"string");return typeof e=="symbol"?e:e+""}function VL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ir(t,e){return t.get(w0(t,e))}function WL(t,e,r){return t.set(w0(t,e),r),r}function w0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gt=new WeakMap;class gl{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Qf(this,"highlight",null),Qf(this,"from",null),Qf(this,"to",null),kL(this,Gt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),WL(Gt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ir(Gt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ir(Gt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ir(Gt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ir(Gt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ir(Gt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ir(Gt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ir(Gt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ir(Gt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof bo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Ir(Gt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Ir(Gt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new gl(this.highlight,this.from,this.to,Ir(Gt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new bo(e,r,Ir(Gt,this))}}function wn(t,e,r){BL(t,e),e.set(t,r)}function BL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y(t,e){return t.get(v0(t,e))}function fi(t,e,r){return t.set(v0(t,e),r),r}function v0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pr=new WeakMap,eg=new WeakMap,pt=new WeakMap,$o=new WeakMap,Al=new WeakMap,Xr=new WeakMap,tg=new WeakMap,sa=new WeakMap,qi=new WeakMap,vn=new WeakMap;let y0=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;wn(this,Pr,void 0),wn(this,eg,void 0),wn(this,pt,void 0),wn(this,$o,void 0),wn(this,Al,void 0),wn(this,Xr,void 0),wn(this,tg,void 0),wn(this,sa,void 0),wn(this,qi,[null,null]),wn(this,vn,[null,null]),fi(Pr,this,n),fi(eg,this,r),fi(pt,this,o),fi($o,this,s),fi(Al,this,a),fi(Xr,this,i),fi(tg,this,e),this.registerEvents()}registerEvents(){Y(Xr,this).addEventListener(Y(pt,this).holder,"contextmenu",n=>this.onContextMenu(n)),Y(Xr,this).addEventListener(Y(pt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),Y(Xr,this).addEventListener(Y(pt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{Y(Xr,this).addEventListener(Y(pt,this).holder,"touchstart",n=>this.onTouchStart(n)),Y(Xr,this).addEventListener(Y(pt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),Y(Xr,this).addEventListener(Y(pt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Y(Pr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Y(Pr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{Y(Xr,this).addEventListener(Y(pt,this).holder,"mouseup",n=>this.onMouseUp(n)),Y(Xr,this).addEventListener(Y(pt,this).holder,"mousedown",n=>this.onMouseDown(n))};Ii()?e():(bN()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(Y(sa,this)&&n){const[i,o]=[n.row,Y(sa,this).from.row],[s,a]=[n.col,Y(sa,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=Y(pt,this).TABLE,i=_l(e,["TD","TH"],n);return i?(r.coords=Y(pt,this).getCoords(i),r.TD=i):ye(e,"wtBorder")&&ye(e,"current")?(r.coords=Y($o,this).getFocusSelection().cellRange.highlight,r.TD=Y(pt,this).getCell(r.coords)):ye(e,"wtBorder")&&ye(e,"area")&&Y($o,this).getAreaSelection().cellRange&&(r.coords=Y($o,this).getAreaSelection().cellRange.to,r.TD=Y(pt,this).getCell(r.coords)),r}onMouseDown(e){const r=Y(eg,this).rootDocument.activeElement,n=$N(MN,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);ye(i,"corner")?Y(Pr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&Y(Pr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Y(vn,this)[0]=o.TD,clearTimeout(Y(qi,this)[0]),Y(qi,this)[0]=setTimeout(()=>{Y(vn,this)[0]=null},1e3))}onContextMenu(e){if(Y(Pr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!Y(Pr,this).has("onCellMouseOver"))return;const r=Y(pt,this).TABLE,n=_l(e.target,["TD","TH"],r),i=Y(Al,this)||this;n&&n!==i.lastMouseOver&&vs(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,Y(pt,this).getCoords(n),n))}onMouseOut(e){if(!Y(Pr,this).has("onCellMouseOut"))return;const r=Y(pt,this).TABLE,n=_l(e.target,["TD","TH"],r),i=_l(e.relatedTarget,["TD","TH"],r),o=Y(Al,this)||this;n&&n!==i&&vs(n,r)&&(this.callListener("onCellMouseOut",e,Y(pt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&Y(Pr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===Y(vn,this)[0]&&r.TD===Y(vn,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),Y(vn,this)[0]=null,Y(vn,this)[1]=null):r.TD===Y(vn,this)[0]&&(Y(vn,this)[1]=r.TD,clearTimeout(Y(qi,this)[1]),Y(qi,this)[1]=setTimeout(()=>{Y(vn,this)[1]=null},500)))}onTouchStart(e){fi(sa,this,Y($o,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=he(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Y(Pr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];W_()&&(TN()||_N())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=Y(Pr,this).getSettingPure(e);o&&o(r,n,i,Y(tg,this).call(this))}destroy(){clearTimeout(Y(qi,this)[0]),clearTimeout(Y(qi,this)[1]),Y(Xr,this).destroy()}};function rg(t,e,r){return(e=$L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $L(t){var e=jL(t,"string");return typeof e=="symbol"?e:e+""}function jL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zL{constructor(e,r,n){rg(this,"offset",void 0),rg(this,"total",void 0),rg(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function ng(t,e,r){return(e=UL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UL(t){var e=YL(t,"string");return typeof e=="symbol"?e:e+""}function YL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qL{constructor(e,r,n){ng(this,"offset",void 0),ng(this,"total",void 0),ng(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Dl(t,e,r){return(e=GL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GL(t){var e=KL(t,"string");return typeof e=="symbol"?e:e+""}function KL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XL{constructor(){Dl(this,"currentSize",0),Dl(this,"nextSize",0),Dl(this,"currentOffset",0),Dl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const ZL=0,FS=1,cm=2;function ig(t,e,r){return(e=JL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JL(t){var e=QL(t,"string");return typeof e=="symbol"?e:e+""}function QL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eF{constructor(){ig(this,"size",new XL),ig(this,"workingSpace",ZL),ig(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=FS,e.workingSpace=cm,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=cm,e.workingSpace=FS,this.sharedSize=e.getViewSize()}}var VS={},og,WS;function tF(){if(WS)return og;WS=1;var t=cc(),e=TypeError;return og=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},og}var BS;function rF(){if(BS)return VS;BS=1;var t=Fe(),e=Ds(),r=ks(),n=vT(),i=tF(),o=yT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var w=d;w--;){var v=w+g;w in h?h[v]=h[w]:i(h,v)}for(var C=0;C<g;C++)h[C]=arguments[C]}return n(h,d+g)}}),VS}rF();function nF(t,e,r){return(e=iF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iF(t){var e=oF(t,"string");return typeof e=="symbol"?e:e+""}function oF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $S{constructor(e,r){nF(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function sF(t,e,r){return(e=aF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aF(t){var e=lF(t,"string");return typeof e=="symbol"?e:e+""}function lF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uF{constructor(e){sF(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new $S(o,r),l=new $S(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(cm)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function jo(t,e,r){return(e=cF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cF(t){var e=hF(t,"string");return typeof e=="symbol"?e:e+""}function hF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b0{constructor(e,r){jo(this,"rootNode",void 0),jo(this,"nodesPool",void 0),jo(this,"sizeSet",new eF),jo(this,"collectedNodes",[]),jo(this,"viewDiffer",new uF(this.sizeSet)),jo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class C0 extends b0{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function jS(t,e,r){return(e=dF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dF(t){var e=fF(t,"string");return typeof e=="symbol"?e:e+""}function fF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gF{constructor(e){jS(this,"nodeType",void 0),jS(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function aa(t,e,r){return(e=mF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mF(t){var e=pF(t,"string");return typeof e=="symbol"?e:e+""}function pF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ml{constructor(e,r){aa(this,"nodesPool",null),aa(this,"nodeType",void 0),aa(this,"rootNode",void 0),aa(this,"table",null),aa(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new gF(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function zS(t,e,r){return(e=wF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wF(t){var e=vF(t,"string");return typeof e=="symbol"?e:e+""}function vF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yF extends ml{constructor(){super("TH"),zS(this,"orderViews",new WeakMap),zS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new C0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),dl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(d,[sN(),dN(),pp(h+1),No(-1)]),r[h](a,d,h)}u.end()}}}class bF extends ml{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&_s(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Me(this.rootNode,[A_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Me(s,[D_(),k_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),dl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(u,[pp(a+1+this.table.rowHeadersCount),No(-1),aN(),...a>=0?[hN()]:[oN(),Wu("Select whole grid")]]),n[r](l,u,r)}}}}let US=!1;class CF extends ml{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!US&&e>1e3&&(US=!0,Br(ar`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&X(n,"rowHeader")}}function SF(t,e,r){return(e=RF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RF(t){var e=EF(t,"string");return typeof e=="symbol"?e:e+""}function EF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zo={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let YS=!1;class TF extends ml{constructor(e){super("TR",e),SF(this,"orderView",void 0),this.orderView=new b0(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!YS&&e>1e3&&(YS=!0,Br(ar`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Me(this.rootNode,[A_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Me(o,[D_(),k_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?ye(o,zo.rowEven)||(xe(o,zo.rowOdd),X(o,zo.rowEven)):ye(o,zo.rowOdd)||(xe(o,zo.rowEven),X(o,zo.rowOdd))}this.orderView.end()}}function qS(t,e,r){return(e=_F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _F(t){var e=OF(t,"string");return typeof e=="symbol"?e:e+""}function OF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MF extends ml{constructor(){super("TD"),qS(this,"orderViews",new WeakMap),qS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new C0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),w=c.getCurrentNode();if(ye(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),dl(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,w),this.table.isAriaEnabled()){var o,s;Me(w,[...w.hasAttribute("role")?[]:[iN()],No(-1),pp(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function st(t,e,r){return(e=IF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IF(t){var e=PF(t,"string");return typeof e=="symbol"?e:e+""}function PF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xF{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};st(this,"rootNode",void 0),st(this,"rootDocument",void 0),st(this,"rowHeaders",null),st(this,"columnHeaders",null),st(this,"colGroup",null),st(this,"rows",null),st(this,"cells",null),st(this,"rowFilter",null),st(this,"columnFilter",null),st(this,"rowUtils",null),st(this,"columnUtils",null),st(this,"rowsToRender",0),st(this,"columnsToRender",0),st(this,"rowHeaderFunctions",[]),st(this,"rowHeadersCount",0),st(this,"columnHeaderFunctions",[]),st(this,"columnHeadersCount",0),st(this,"cellRenderer",void 0),st(this,"activeOverlayName",void 0),st(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class HF{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new xF(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new yF,columnHeaders:new bF(r),colGroup:new CF(n),rows:new TF(i),cells:new MF}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function sg(t,e,r){return(e=AF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AF(t){var e=DF(t,"string");return typeof e=="symbol"?e:e+""}function DF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NF{constructor(e,r){sg(this,"dataAccessObject",void 0),sg(this,"wtSettings",void 0),sg(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function GS(t,e,r){return(e=kF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kF(t){var e=LF(t,"string");return typeof e=="symbol"?e:e+""}function LF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FF{constructor(e,r){GS(this,"dataAccessObject",void 0),GS(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function yn(t,e,r){return(e=VF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VF(t){var e=WF(t,"string");return typeof e=="symbol"?e:e+""}function WF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bs{constructor(e,r,n,i,o){yn(this,"wtSettings",null),yn(this,"domBindings",void 0),yn(this,"TBODY",null),yn(this,"THEAD",null),yn(this,"COLGROUP",null),yn(this,"hasTableHeight",!0),yn(this,"hasTableWidth",!0),yn(this,"isTableVisible",!1),yn(this,"tableOffset",0),yn(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,U_(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new FF(this.dataAccessObject,this.wtSettings),this.columnUtils=new NF(this.dataAccessObject,this.wtSettings),this.tableRenderer=new HF({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ye(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Me(n,[Mi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ye(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(n,[Mi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ye(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Me(n,[No(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Me(n.parentNode,[Mi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(n,[Mi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=kr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,w!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=kr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new qL(g,o,c),this.columnFilter=new zL(w,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const C={};this.wtSettings.getSetting("beforeDraw",!0,C),v=C.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(_n)||this.is(Ai))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(_n))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(_n)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Fa(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(_n))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=$_(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=xN(n),s=r.cellIndex;Ui(Ro,r,this.wtRootElement)||Ui(Co,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Ui(Ai,r,this.wtRootElement)||Ui(_n,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Ui(Ro,r,this.wtRootElement)||Ui(So,r,this.wtRootElement)||Ui(Ai,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Fa(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?lr:Fa,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const w=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-w||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ir(this.TABLE)}getHeight(){return lr(this.TABLE)}getTotalWidth(){const e=ir(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=lr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Xa(this.TABLE)}_modifyRowHeaderWidth(e){let r=Oe(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const BF="stickyRowsBottom",Op={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ai(Op,"MIXIN_NAME",BF,{writable:!1,enumerable:!1});const $F="stickyColumnsStart",Mc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ai(Mc,"MIXIN_NAME",$F,{writable:!1,enumerable:!1});class Mp extends Bs{constructor(e,r,n,i){super(e,r,n,i,Ai)}}Je(Mp,Op);Je(Mp,Mc);const Co="top",_n="bottom",So="inline_start",Ro="top_inline_start_corner",Ai="bottom_inline_start_corner",S0=[Co,_n,So,Ro,Ai],jF=new Map([[Co,`ht_clone_${Co}`],[_n,`ht_clone_${_n}`],[So,`ht_clone_${So} ht_clone_left`],[Ro,`ht_clone_${Ro} ht_clone_top_left_corner`],[Ai,`ht_clone_${Ai} ht_clone_bottom_left_corner`]]);function zF(t,e){UF(t,e),e.add(t)}function UF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YF(t,e,r){return(e=qF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qF(t){var e=GF(t,"string");return typeof e=="symbol"?e:e+""}function GF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var la=new WeakSet;class KF{constructor(e){zF(this,la),YF(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=yr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=yr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Nl(la,this,XS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Nl(la,this,XS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Nl(la,this,KS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Nl(la,this,KS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function KS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=kr(n.wtRootElement).left;const u=Math.abs(G_(s,s));if(l>u){const c=K_(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function XS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=kr(r.wtRootElement),a=bp(o,o);if(s.top>a){const l=Fa(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function xr(t,e,r){return(e=XF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XF(t){var e=ZF(t,"string");return typeof e=="symbol"?e:e+""}function ZF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ip{get eventManager(){return new Ni(this)}constructor(e,r){xr(this,"wtTable",void 0),xr(this,"wtScroll",void 0),xr(this,"wtViewport",void 0),xr(this,"wtOverlays",void 0),xr(this,"selectionManager",void 0),xr(this,"wtEvent",void 0),xr(this,"guid",`wt_${P_()}`),xr(this,"drawInterrupted",!1),xr(this,"drawn",!1),xr(this,"activeOverlayName","master"),xr(this,"domBindings",void 0),xr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new KF(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){fl(n,e[r])}])}}createCellCoords(e,r){return new bo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new gl(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||AN(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function ZS(t,e,r){return(e=JF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JF(t){var e=QF(t,"string");return typeof e=="symbol"?e:e+""}function QF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eV extends Ip{constructor(e,r,n){super(e,r),ZS(this,"cloneSource",void 0),ZS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new y0(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function tV(t,e,r){return(e=rV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rV(t){var e=nV(t,"string");return typeof e=="symbol"?e:e+""}function nV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pl{constructor(e,r,n,i,o){tV(this,"wtSettings",null),ai(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=$u(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=$u(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Bu(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Br(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+jt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(S0.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${jF.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Me(o,[Mi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Co||u==="vertical"&&this.type===So?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Bu(e.TABLE),new eV(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class iV extends pl{constructor(e,r,n,i,o,s){super(e,r,Ai,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Mp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Tc(r),this.repositionOverlay();let n=lr(this.clone.wtTable.TABLE);const i=ir(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=jt(n)),i.style.bottom=`${o}px`}}const oV="calculatedColumns",Ic={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ai(Ic,"MIXIN_NAME",oV,{writable:!1,enumerable:!1});class Pp extends Bs{constructor(e,r,n,i){super(e,r,n,i,_n)}}Je(Pp,Op);Je(Pp,Ic);function sV(t,e,r){return(e=aV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aV(t){var e=lV(t,"string");return typeof e=="symbol"?e:e+""}function lV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uV extends pl{constructor(e,r,n,i){super(e,r,_n,n,i),sV(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Pp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=jt(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(yp(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=lr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=jt(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return bp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ye(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(xe(s,"innerBorderBottom"),o=a)}return o}}const cV="calculatedRows",xp={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ai(xp,"MIXIN_NAME",cV,{writable:!1,enumerable:!1});class Hp extends Bs{constructor(e,r,n,i){super(e,r,n,i,So)}}Je(Hp,xp);Je(Hp,Mc);const hV="localHooks",Nn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)om(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ai(Nn,"MIXIN_NAME",hV,{writable:!1,enumerable:!1});let R0=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Je(R0,Nn);const dV="active-header",E0="header",Ap="area",Uu="focus",fV="fill",gV="row",mV="column",pV="custom-selection",Dp=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var JS={},QS;function wV(){if(QS)return JS;QS=1;var t=Sp();return t("flat"),JS}wV();function vV(t,e){T0(t,e),e.add(t)}function eR(t,e,r){T0(t,e),e.set(t,r)}function T0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get(Va(t,e))}function tR(t,e,r){return t.set(Va(t,e),r),r}function Va(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qr=new WeakMap,Mt=new WeakMap,kl=new WeakSet;class yV{constructor(){vV(this,kl),eR(this,Qr,void 0),eR(this,Mt,void 0)}setActiveOverlay(e){return tR(Mt,this,e),this}setActiveSelection(e){return tR(Qr,this,e),this}scan(){const e=qe(Qr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=qe(Qr,this).getCorners(),{wtTable:s}=qe(Mt,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let w=s.getColumnHeader(h,g);const v=qe(Mt,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:qe(Qr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==h&&(w=s.getColumnHeader(v,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=qe(Qr,this).getCorners(),{wtTable:s}=qe(Mt,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let w=s.getRowHeader(h,g);const v=qe(Mt,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:qe(Qr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==h&&(w=s.getRowHeader(v,g)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=qe(Mt,this);Va(kl,this,bV).call(this,(n,i)=>{const o=r.getCell(qe(Mt,this).createCellCoords(n,i)),s=qe(Mt,this).getSetting("onAfterDrawSelection",n,i,qe(Qr,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=qe(Qr,this).getCorners(),{wtTable:i}=qe(Mt,this);Va(kl,this,rR).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(qe(Mt,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=qe(Qr,this).getCorners(),{wtTable:i}=qe(Mt,this);Va(kl,this,rR).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(qe(Mt,this).createCellCoords(o,s));e(a)}})}}function bV(t){let[e,r,n,i]=qe(Qr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=qe(Mt,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(qe(Mt,this).createCellCoords(e,r));if(!wo(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function rR(t){const{wtTable:e}=qe(Mt,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class nR{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Dp(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),_c(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ii()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};He(h,(g,w)=>{this.selectionHandles.styles.bottomHitArea[w]=g,this.selectionHandles.styles.topHitArea[w]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};He(d,(g,w)=>{this.selectionHandles.styles.bottom[w]=g,this.selectionHandles.styles.top[w]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),C=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const b=Math.min(parseInt(i+o,10),C-w-g*2),E=Math.min(parseInt(i+o-v/4,10),C-v-g*2);h[l]=`${b}px`,d[l]=`${E}px`;const y=Math.min(parseInt(n+s,10),T-w-g*2),I=Math.min(parseInt(n+s-v/4,10),T-v-g*2);h.top=`${y}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),w=s.getLastRenderedColumn();if(g<0&&w<0||h<0&&d<0){this.disappear();return}let v;if(u){if(n=Math.max(n,g),o=Math.min(o,w),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}v=s.getCell(this.wot.createCellCoords(r,n))}else if(v=s.getCell(this.wot.createCellCoords(r,n)),!wo(v)){this.disappear();return}const C=u?s.getCell(this.wot.createCellCoords(i,o)):v,T=kr(v),b=u?kr(C):T,E=kr(s.TABLE),y=T.top,I=T.left,x=this.wot.wtSettings.getSetting("rtlMode");let P=0,A=0;if(x){const Ee=ir(s.TABLE),Ye=ir(v),Be=l.innerWidth-E.left-Ee;A=I+Ye-b.left,P=l.innerWidth-I-Ye-Be-1}else A=b.left+ir(C)-I,P=I-E.left-1;if(this.isEntireColumnSelected(r,i)){const Ee=r,Ye=this.getDimensionsFromHeader("columns",n,o,Ee,E);let Be=null;Ye&&([Be,P,A]=Ye),Be&&(v=Be)}let F=y-E.top-1,W=b.top+lr(C)-y;if(this.isEntireRowSelected(n,o)){const Ee=n,Ye=this.getDimensionsFromHeader("rows",r,i,Ee,E);let Be=null;Ye&&([Be,F,W]=Ye),Be&&(v=Be)}const q=l.getComputedStyle(v);parseInt(q.borderTopWidth,10)>0&&(F+=1,W=W>0?W-1:0),parseInt(q[x?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,A=A>0?A-1:0);const L=x?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${F}px`,this.topStyle[L]=`${P}px`,this.topStyle.width=`${A+ae}px`,this.topStyle.display="block",this.startStyle.top=`${F}px`,this.startStyle[L]=`${P}px`,this.startStyle.height=`${W+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${F+W-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[L]=`${P}px`,this.bottomStyle.width=`${A+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${F}px`,this.endStyle[L]=`${P+A-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${W+ae}px`,this.endStyle.display="block";let K=this.settings.border.cornerVisible;K=typeof K=="function"?K(this.settings.layerLevel):K;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[dt,Re]=[i,o];if(te&&Array.isArray(te)&&([,,dt,Re]=te),Ii()||!K||this.isPartRange(dt,Re))this.cornerStyle.display="none";else{this.cornerStyle.top=`${F+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${P+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ee=$u(s.TABLE);const Ye=Ee===l;Ye&&(Ee=a.documentElement);const Be=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ie=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),fn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const Te=Ye?C.getBoundingClientRect().left:C.offsetLeft;let f=!1,m=0;if(x?(m=Te-parseInt(this.cornerDefaultStyle.width,10)/2,f=m<0):(m=Te+ir(C)+parseInt(this.cornerDefaultStyle.width,10)/2,f=m>=K_(Ee)),f){const p=Math.floor(P+A+this.cornerCenterPointOffset-Ie-Be);c?(this.cornerStyle[L]=`${p}px`,this.cornerStyle[x?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${p-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Ye?C.getBoundingClientRect().top:C.offsetTop)+lr(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Fa(Ee)){const p=Math.floor(F+W+this.cornerCenterPointOffset-fn-Be);c?(this.cornerStyle.top=`${p}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${p-1}px`}this.cornerStyle.display="block"}Ii()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,F,P,A,W)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return lr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ir(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const C=this.wot.getSetting("columnHeaders").length;if(w=l(r,C-i),v=l(n,C-i),!w||!v)return!1;const T=kr(w),b=kr(v);return w&&v&&(h=T[g]-o[g]-1,d=b[g]+u(v)-T[g]),[w,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?X(this[e],"hidden"):(ye(this[e],"hidden")&&xe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?X(this[e],"hidden"):xe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ii()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function CV(t,e){_0(t,e),e.add(t)}function Uo(t,e,r){_0(t,e),e.set(t,r)}function _0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ue(t,e){return t.get(Np(t,e))}function iR(t,e,r){return t.set(Np(t,e),r),r}function Np(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var It=new WeakMap,er=new WeakMap,ag=new WeakMap,Oa=new WeakMap,lg=new WeakMap,Gi=new WeakMap,oR=new WeakSet;class SV{constructor(e){CV(this,oR),Uo(this,It,void 0),Uo(this,er,void 0),Uo(this,ag,new yV),Uo(this,Oa,new WeakMap),Uo(this,lg,new WeakSet),Uo(this,Gi,new Map),iR(er,this,e)}setActiveOverlay(e){return iR(It,this,e),ue(ag,this).setActiveOverlay(ue(It,this)),ue(Oa,this).has(ue(It,this))||ue(Oa,this).set(ue(It,this),new Set),this}getFocusSelection(){return ue(er,this)!==null?ue(er,this).getFocus():null}getAreaSelection(){return ue(er,this)!==null?ue(er,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(ue(Gi,this).has(e)){const n=ue(Gi,this).get(e);if(n.has(ue(It,this)))return n.get(ue(It,this));const i=new nR(ue(It,this),e.settings);return n.set(ue(It,this),i),i}const r=new nR(ue(It,this),e.settings);return ue(Gi,this).set(e,new Map([[ue(It,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=ue(Gi,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){ue(Gi,this).get(e).forEach(r=>r.destroy()),ue(Gi,this).delete(e)}render(e){if(ue(er,this)===null)return;e&&Np(oR,this,RV).call(this);const r=Array.from(ue(er,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;ue(lg,this).has(s)||(ue(lg,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&ue(ag,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const v=n.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const d=s.getCorners();ue(It,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>ue(Oa,this).get(ue(It,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=ue(er,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Me(s,ue(er,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Me(o,[...i.get(o)])})}}function RV(){const t=ue(Oa,this).get(ue(It,this)),e=ue(It,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=ue(It,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=ue(er,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=ue(er,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=ue(er,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...ue(er,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)xe(o[a],r),dl(o[a],s)}),t.clear()}class EV extends pl{constructor(e,r,n,i){super(e,r,So,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Hp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Cp(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Tc(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,q_(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ir(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Dp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=jt(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,NN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(G_(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?xe(n,"emptyRows"):X(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ye(n,"innerBorderInlineStart");e?(X(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(xe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const TV="stickyRowsTop",kp={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ai(kp,"MIXIN_NAME",TV,{writable:!1,enumerable:!1});class Lp extends Bs{constructor(e,r,n,i){super(e,r,n,i,Ro)}}Je(Lp,kp);Je(Lp,Mc);function sR(t,e,r){return(e=_V(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _V(t){var e=OV(t,"string");return typeof e=="symbol"?e:e+""}function OV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MV extends pl{constructor(e,r,n,i,o,s){super(e,r,Ro,n,i),sR(this,"topOverlay",void 0),sR(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Lp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Cp(e,`${i}px`,`${o}px`)}else Tc(e);let r=lr(this.clone.wtTable.TABLE);const n=ir(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class Fp extends Bs{constructor(e,r,n,i){super(e,r,n,i,Co)}}Je(Fp,kp);Je(Fp,Ic);function IV(t,e,r){return(e=PV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PV(t){var e=xV(t,"string");return typeof e=="symbol"?e:e+""}function xV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HV extends pl{constructor(e,r,n,i){super(e,r,Co,n,i),IV(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Fp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Cp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Tc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(yp(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=jt(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=lr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Dp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=jt(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,DN(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return bp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?xe(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(xe(i,"innerBorderTop"),a=h)}}return a}}function Ll(t,e,r){AV(t,e),e.set(t,r)}function AV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $n(t,e,r){return(e=DV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DV(t){var e=NV(t,"string");return typeof e=="symbol"?e:e+""}function NV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ki(t,e,r){return t.set(O0(t,e),r),r}function jn(t,e){return t.get(O0(t,e))}function O0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yo=new WeakMap,Fl=new WeakMap,qo=new WeakMap,Vl=new WeakMap;class kV{constructor(e,r,n,i,o,s){$n(this,"wot",null),Ll(this,Yo,[]),$n(this,"topOverlay",null),$n(this,"bottomOverlay",null),$n(this,"inlineStartOverlay",null),$n(this,"topInlineStartCornerOverlay",null),$n(this,"bottomInlineStartCornerOverlay",null),$n(this,"browserLineHeight",void 0),$n(this,"wtSettings",null),Ll(this,Fl,!1),Ll(this,qo,0),Ll(this,Vl,null),$n(this,"resizeObserver",new ResizeObserver(c=>{im(()=>{!Array.isArray(c)||!c.length||(Ki(qo,this,jn(qo,this)+1),jn(qo,this)===300&&(Br("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),jn(Vl,this)!==null&&clearTimeout(jn(Vl,this)),Ki(Vl,this,setTimeout(()=>{Ki(qo,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=jt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Bu(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...jn(Yo,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new HV(...e),this.bottomOverlay=new uV(...e),this.inlineStartOverlay=new EV(...e),this.topInlineStartCornerOverlay=new MV(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new iV(...e,this.bottomOverlay,this.inlineStartOverlay),Ki(Yo,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Ki(Fl,this,jn(Yo,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),jn(Yo,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),jn(Yo,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!EN())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{im(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Ki(qo,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=YN(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!jn(Fl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Ki(Fl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Bu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),g=r.hider.style,w=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),C=w()?1:0,T=v()?1:0;g.width=`${h+T}px`,g.height=`${c+C}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return j(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];j(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function aR(t,e,r){return(e=LV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LV(t){var e=FV(t,"string");return typeof e=="symbol"?e:e+""}function FV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VV{constructor(e){aR(this,"settings",{}),aR(this,"defaults",Object.freeze(this.getDefaults())),He(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);fl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?He(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Vp extends Bs{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=$u(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=JC(e,"height",r),o=JC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Xa(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Je(Vp,xp);Je(Vp,Ic);class WV{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new wL:new RL],["fullyVisible",()=>new aL],["partiallyVisible",()=>new g0]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new gL:new bL],["fullyVisible",()=>new iL],["partiallyVisible",()=>new f0]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=lr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?jt():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return kr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=lr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=ir(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=jt(this.domBindings.rootDocument),new xL({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=jt(this.domBindings.rootDocument)),new ML({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible"),s=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:o,endRow:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;n=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:o,endColumn:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;n=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){He(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class BV extends Ip{constructor(e,r){super(e,new VV(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Vp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new WV(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SV(this.wtSettings.getSetting("selections")),this.wtEvent=new y0(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new kV(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];He(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),xe(this.wtTable.wtRootElement.parentNode,r),X(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!S0.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Wp{constructor(e){e instanceof Ip?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Wp(r);return()=>n},this._wot=new BV(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function lR(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function $V(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function uR(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const jV=new Map([["touchstart",lR],["touchend",uR],["mousedown",lR],["mouseover",$V],["mouseup",uR]]);function ug(t,e){jV.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:t0(t)||t.type==="touchstart",isRightClick:ju(t),...e})}const M0=new WeakMap,Bp=Symbol("rootInstance");function zV(t){M0.set(t,!0)}function UV(t){return t===Bp}function io(t){return M0.has(t)}function YV(t,e){I0(t,e),e.add(t)}function gi(t,e,r){I0(t,e),e.set(t,r)}function I0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mi(t,e,r){return(e=qV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qV(t){var e=GV(t,"string");return typeof e=="symbol"?e:e+""}function GV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function et(t,e){return t.get(Cs(t,e))}function Kt(t,e,r){return t.set(Cs(t,e),r),r}function Cs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cg=new WeakMap,Wl=new WeakMap,Bl=new WeakMap,zn=new WeakMap,Zr=new WeakMap,hg=new WeakMap,dg=new WeakMap,Go=new WeakMap,Ma=new WeakSet;class KV{constructor(e){YV(this,Ma),mi(this,"hot",void 0),mi(this,"eventManager",void 0),mi(this,"settings",void 0),mi(this,"THEAD",void 0),mi(this,"TBODY",void 0),mi(this,"_wt",void 0),mi(this,"activeWt",void 0),gi(this,cg,0),gi(this,Wl,0),mi(this,"postponedAdjustElementsSize",!1),gi(this,Bl,!1),gi(this,zn,void 0),gi(this,Zr,void 0),gi(this,hg,0),gi(this,dg,0),gi(this,Go,null),this.hot=e,this.eventManager=new Ni(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Cs(Ma,this,ZV).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),X(e,"handsontable"),Kt(Zr,this,r.createElement("TABLE")),X(et(Zr,this),"htCore"),this.hot.getSettings().tableClassName&&X(et(Zr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Me(et(Zr,this),[Mi()]),Me(e,[nN(),N_(-1),Ec(this.hot.countCols()),mN()])),this.THEAD=r.createElement("THEAD"),et(Zr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),et(Zr,this).appendChild(this.TBODY),this.hot.table=et(Zr,this),this.hot.container.insertBefore(et(Zr,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:o}=this.hot,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Kt(Bl,this,!0),this.isTextSelectionAllowed(l.target)||(QC(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Kt(Bl,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{et(Bl,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&QC(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{var u;i.isInProgress()&&t0(l)&&i.finish(),Kt(zn,this,!1);const c=Z_(n.activeElement),h=(u=n.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(n.activeElement);Eu(n.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!ju(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&ju(l)&&(i.finish(),Kt(zn,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Kt(zn,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(et(zn,this)||!r||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(d===g){const v=jt(n);if(n.elementFromPoint(c+v,h)!==g||n.elementFromPoint(c,h+v)!==g)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===r)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Ka(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Ka(a);this.eventManager.addEventListener(et(Zr,this),"selectstart",l=>{this.settings.fragmentSelection||Eu(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&X(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&xe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:et(Zr,this),isDataViewInstance:()=>io(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Kt(Wl,this,o.length),this.hot.getSettings().ariaTags&&Cs(Ma,this,P0).call(this)===this.hot.countCols()&&Cs(Ma,this,XV).call(this,et(Wl,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Kt(cg,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),w=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,v,g),this.hot.runHooks("afterRenderer",a,l,u,w,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Xa(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Kt(zn,this,!0),Kt(Go,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!so(o)&&(ug(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Kt(zn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!so(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!so(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!so(o)&&(et(zn,this)&&(!et(Go,this)||et(Go,this).x!==o.clientX||et(Go,this).y!==o.clientY)&&ug(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Kt(Go,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(so(o)||this.hot.isDestroyed)&&(ug(o,{coords:u,selection:this.hot.selection,cellRangeMapper:lk(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[w,v,C,T]=g;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,-1)):C,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Wp(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(Eu(e))return!0;const i=vs(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return et(zn,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!ye(n,"relative")){_s(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;ye(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",X(s,["relative",...o()])):(_s(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Me(a,...Mi()),Me(l,...Mi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):ye(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?Y_(e,n(r,i)):(fl(e,"Â "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Kt(hg,this,e),Kt(dg,this,r)}getLastSize(){return{width:et(hg,this),height:et(dg,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return et(cg,this)}getRowHeadersCount(){return et(Wl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function P0(){return parseInt(this.hot.rootElement.getAttribute(Ec()[0]),10)}function XV(t){const e=Cs(Ma,this,P0).call(this)+t;Me(this.hot.rootElement,...Ec(e))}function ZV(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):xe(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?X(t,"htVerticallyScrollableByWindow"):xe(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):xe(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?X(t,"htHorizontallyScrollableByWindow"):xe(t,"htHorizontallyScrollableByWindow")}var cR={},hR={},dR;function JV(){if(dR)return hR;dR=1;var t=Fe(),e=wt(),r=Ls(),n=Rr(),i=vt(),o=Wi(),s=Er(),a=Ho(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,w){if(!c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),hR}var fR;function QV(){return fR||(fR=1,JV()),cR}QV();const eW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",gR=eW.length;function tW(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%gR,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/gR,10);return r}function x0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&nt(t[0])&&(e=wp(t[0]))),e}function ua(t,e,r){return(e=rW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rW(t){var e=nW(t,"string");return typeof e=="symbol"?e:e+""}function nW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iW{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];ua(this,"hot",void 0),ua(this,"data",void 0),ua(this,"dataType","array"),ua(this,"colToProp",()=>{}),ua(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return j(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Ge(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(nt(a)||Oe(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Ge(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?kf(l,d,g):l[d]=g}})}else He(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?kf(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=yr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:kf(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?nm(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=yr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Ge(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return x0(this.data)}destroy(){this.data=null,this.hot=null}}var mR={},pR={},wR;function oW(){if(wR)return pR;wR=1;var t=Fe(),e=wt(),r=Ls(),n=Rr(),i=vt(),o=Wi(),s=Er(),a=Ho(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),pR}var vR;function sW(){return vR||(vR=1,oW()),mR}sW();function yR(t,e,r){return(e=aW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aW(t){var e=lW(t,"string");return typeof e=="symbol"?e:e+""}function lW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;yR(this,"indexedValues",[]),yR(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Oe(this.initValueOrFn)?Ge(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ge(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Je(wl,Nn);function H0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Oe(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function A0(t,e){return gp(t,(r,n)=>e.includes(n)===!1)}class Pc extends wl{insert(e,r){this.indexedValues=H0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=A0(this.indexedValues,e),super.remove(e)}}class D0 extends Pc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Do(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function N0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Yu(t,e){return gp(t,r=>e.includes(r)===!1)}function k0(t,e){return xn(t,r=>r-e.filter(n=>n<r).length)}function L0(t,e){const r=e[0],n=e.length;return xn(t,i=>i>=r?i+n:i)}function uW(t,e,r){return(e=cW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cW(t){var e=hW(t,"string");return typeof e=="symbol"?e:e+""}function hW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dW extends wl{constructor(){super(...arguments),uW(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Yu(this.orderOfIndexes,[e]),Oe(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=H0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=L0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=A0(this.indexedValues,e),this.orderOfIndexes=Yu(this.orderOfIndexes,e),this.orderOfIndexes=k0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class F0 extends Pc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Do(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class fW extends wl{constructor(){super(e=>e)}insert(e,r){const n=L0(this.indexedValues,r);this.indexedValues=N0(n,e,r),super.insert(e,r)}remove(e){const r=Yu(this.indexedValues,e);this.indexedValues=k0(r,e),super.remove(e)}}const bR=new Map([["hiding",D0],["index",wl],["linkedPhysicalIndexToValue",dW],["physicalIndexToValue",Pc],["trimming",F0]]);function gW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!bR.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(bR.get(t))(e)}function mW(t,e,r){return(e=pW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pW(t){var e=wW(t,"string");return typeof e=="symbol"?e:e+""}function wW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $p{constructor(){mW(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);he(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return $t(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Je($p,Nn);function fg(t,e,r){return(e=vW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vW(t){var e=yW(t,"string");return typeof e=="symbol"?e:e+""}function yW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CR extends $p{constructor(e,r){super(),fg(this,"mergedValuesCache",[]),fg(this,"aggregationFunction",void 0),fg(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=xn(this.get(),o=>o.getValues()),n=[],i=he(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return xn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return he(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function bW(t,e,r){CW(t,e),e.set(t,r)}function CW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SW(t,e,r){return t.set(V0(t,e),r),r}function RW(t,e){return t.get(V0(t,e))}function V0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gg=new WeakMap;class W0{constructor(){bW(this,gg,[])}subscribe(e){return this.addLocalHook("change",e),this._write(RW(gg,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){SW(gg,this,e)}}Je(W0,Nn);function SR(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ca(t,e,r){EW(t,e),e.set(t,r)}function EW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(t,e){return t.get(B0(t,e))}function $l(t,e,r){return t.set(B0(t,e),r),r}function B0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jl=new WeakMap,ha=new WeakMap,zl=new WeakMap,Ul=new WeakMap,Yl=new WeakMap;class TW{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ca(this,jl,new Set),ca(this,ha,[]),ca(this,zl,[]),ca(this,Ul,!1),ca(this,Yl,!1),$l(Yl,this,e??!1)}createObserver(){const e=new W0;return Hr(jl,this).add(e),e.addLocalHook("unsubscribe",()=>{Hr(jl,this).delete(e)}),e._writeInitialChanges(SR(Hr(ha,this),Hr(zl,this))),e}emit(e){let r=Hr(zl,this);(!Hr(Ul,this)||Hr(ha,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Hr(Yl,this)):$l(ha,this,new Array(e.length).fill(Hr(Yl,this))),Hr(Ul,this)||($l(Ul,this,!0),r=Hr(ha,this)));const n=SR(r,e);Hr(jl,this).forEach(i=>i._write(n)),$l(zl,this,e)}}function kt(t,e,r){return(e=_W(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _W(t){var e=OW(t,"string");return typeof e=="symbol"?e:e+""}function OW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hm{constructor(){kt(this,"indexesSequence",new fW),kt(this,"trimmingMapsCollection",new CR(e=>e.some(r=>r===!0),!1)),kt(this,"hidingMapsCollection",new CR(e=>e.some(r=>r===!0),!1)),kt(this,"variousMapsCollection",new $p),kt(this,"hidingChangesObservable",new TW({initialIndexValue:!1})),kt(this,"notTrimmedIndexesCache",[]),kt(this,"notHiddenIndexesCache",[]),kt(this,"isBatched",!1),kt(this,"indexesSequenceChanged",!1),kt(this,"indexesChangeSource",void 0),kt(this,"trimmedIndexesChanged",!1),kt(this,"hiddenIndexesChanged",!1),kt(this,"renderablePhysicalIndexesCache",[]),kt(this,"fromPhysicalToVisualIndexesCache",new Map),kt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,gW(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof F0?this.trimmingMapsCollection.register(e,r):r instanceof D0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return he(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return he(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return he(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return he(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=xn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Yu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(N0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=he(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=xn(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Je(hm,Nn);function MW(t,e){return He(e,(r,n)=>{$t(t[n])&&(t[n]=r)}),t}function $0(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function j0(t){he(t)&&GN(ar`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function IW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function z0(t,e){return Array.isArray(t)?t.map(r=>z0(r,e)):x_(t,e)}const{register:PW,getValues:xW}=ko("phraseFormatters");function U0(t,e){PW(t,e)}function HW(){return xW()}U0("pluralize",IW);U0("substitute",z0);const Y0="ContextMenu:items",re=Y0,jp=`${re}.noItems`,zp=`${re}.insertRowAbove`,Up=`${re}.insertRowBelow`,Yp=`${re}.insertColumnOnTheLeft`,qp=`${re}.insertColumnOnTheRight`,Gp=`${re}.removeRow`,Kp=`${re}.removeColumn`,Xp=`${re}.undo`,Zp=`${re}.redo`,qu=`${re}.readOnly`,Jp=`${re}.clearColumn`,Qp=`${re}.copy`,ew=`${re}.copyWithHeaders`,tw=`${re}.copyWithGroupHeaders`,rw=`${re}.copyHeadersOnly`,nw=`${re}.cut`,q0=`${re}.freezeColumn`,G0=`${re}.unfreezeColumn`,K0=`${re}.mergeCells`,X0=`${re}.unmergeCells`,Z0=`${re}.addComment`,J0=`${re}.editComment`,Q0=`${re}.removeComment`,eO=`${re}.readOnlyComment`,iw=`${re}.align`,ow=`${re}.align.left`,sw=`${re}.align.center`,aw=`${re}.align.right`,lw=`${re}.align.justify`,uw=`${re}.align.top`,cw=`${re}.align.middle`,hw=`${re}.align.bottom`,tO=`${re}.borders`,rO=`${re}.borders.top`,nO=`${re}.borders.right`,iO=`${re}.borders.bottom`,oO=`${re}.borders.left`,sO=`${re}.borders.remove`,aO=`${re}.nestedHeaders.insertChildRow`,lO=`${re}.nestedHeaders.detachFromParent`,uO=`${re}.hideColumn`,cO=`${re}.showColumn`,hO=`${re}.hideRow`,dO=`${re}.showRow`,ur="Filters:",Qe=`${ur}conditions`,fO=`${Qe}.none`,gO=`${Qe}.isEmpty`,mO=`${Qe}.isNotEmpty`,pO=`${Qe}.isEqualTo`,wO=`${Qe}.isNotEqualTo`,vO=`${Qe}.beginsWith`,yO=`${Qe}.endsWith`,bO=`${Qe}.contains`,CO=`${Qe}.doesNotContain`,AW=`${Qe}.byValue`,SO=`${Qe}.greaterThan`,RO=`${Qe}.greaterThanOrEqualTo`,EO=`${Qe}.lessThan`,TO=`${Qe}.lessThanOrEqualTo`,_O=`${Qe}.isBetween`,OO=`${Qe}.isNotBetween`,MO=`${Qe}.after`,IO=`${Qe}.before`,PO=`${Qe}.today`,xO=`${Qe}.tomorrow`,HO=`${Qe}.yesterday`,AO=`${ur}labels.filterByCondition`,DO=`${ur}labels.filterByValue`,NO=`${ur}labels.conjunction`,kO=`${ur}labels.disjunction`,LO=`${ur}values.blankCells`,FO=`${ur}buttons.selectAll`,VO=`${ur}buttons.clear`,WO=`${ur}buttons.ok`,BO=`${ur}buttons.cancel`,$O=`${ur}buttons.placeholder.search`,jO=`${ur}buttons.placeholder.value`,zO=`${ur}buttons.placeholder.secondValue`,kn="Pagination:",UO=`${kn}section.pagination`,YO=`${kn}.pageSize.auto`,qO=`${kn}section.pageSize`,GO=`${kn}section.counter`,KO=`${kn}section.navigation`,XO=`${kn}firstPage`,ZO=`${kn}prevPage`,JO=`${kn}nextPage`,QO=`${kn}lastPage`,dw="CheckboxRenderer:",eM=`${dw}checked`,tM=`${dw}unchecked`,rM="Loading:",nM=`${rM}title`,DW=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:eM,CHECKBOX_RENDERER_NAMESPACE:dw,CHECKBOX_UNCHECKED:tM,CONTEXTMENU_ITEMS_ADD_COMMENT:Z0,CONTEXTMENU_ITEMS_ALIGNMENT:iw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:hw,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:sw,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:lw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:ow,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:cw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:aw,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:uw,CONTEXTMENU_ITEMS_BORDERS:tO,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:iO,CONTEXTMENU_ITEMS_BORDERS_LEFT:oO,CONTEXTMENU_ITEMS_BORDERS_RIGHT:nO,CONTEXTMENU_ITEMS_BORDERS_TOP:rO,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Jp,CONTEXTMENU_ITEMS_COPY:Qp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:rw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:tw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:ew,CONTEXTMENU_ITEMS_CUT:nw,CONTEXTMENU_ITEMS_EDIT_COMMENT:J0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:q0,CONTEXTMENU_ITEMS_HIDE_COLUMN:uO,CONTEXTMENU_ITEMS_HIDE_ROW:hO,CONTEXTMENU_ITEMS_INSERT_LEFT:Yp,CONTEXTMENU_ITEMS_INSERT_RIGHT:qp,CONTEXTMENU_ITEMS_MERGE_CELLS:K0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lO,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:aO,CONTEXTMENU_ITEMS_NO_ITEMS:jp,CONTEXTMENU_ITEMS_READ_ONLY:qu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:eO,CONTEXTMENU_ITEMS_REDO:Zp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:sO,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Kp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Q0,CONTEXTMENU_ITEMS_REMOVE_ROW:Gp,CONTEXTMENU_ITEMS_ROW_ABOVE:zp,CONTEXTMENU_ITEMS_ROW_BELOW:Up,CONTEXTMENU_ITEMS_SHOW_COLUMN:cO,CONTEXTMENU_ITEMS_SHOW_ROW:dO,CONTEXTMENU_ITEMS_UNDO:Xp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:G0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:X0,CONTEXT_MENU_ITEMS_NAMESPACE:Y0,FILTERS_BUTTONS_CANCEL:BO,FILTERS_BUTTONS_CLEAR:VO,FILTERS_BUTTONS_OK:WO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:$O,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:zO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:jO,FILTERS_BUTTONS_SELECT_ALL:FO,FILTERS_CONDITIONS_AFTER:MO,FILTERS_CONDITIONS_BEFORE:IO,FILTERS_CONDITIONS_BEGINS_WITH:vO,FILTERS_CONDITIONS_BETWEEN:_O,FILTERS_CONDITIONS_BY_VALUE:AW,FILTERS_CONDITIONS_CONTAINS:bO,FILTERS_CONDITIONS_EMPTY:gO,FILTERS_CONDITIONS_ENDS_WITH:yO,FILTERS_CONDITIONS_EQUAL:pO,FILTERS_CONDITIONS_GREATER_THAN:SO,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:RO,FILTERS_CONDITIONS_LESS_THAN:EO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:TO,FILTERS_CONDITIONS_NAMESPACE:Qe,FILTERS_CONDITIONS_NONE:fO,FILTERS_CONDITIONS_NOT_BETWEEN:OO,FILTERS_CONDITIONS_NOT_CONTAIN:CO,FILTERS_CONDITIONS_NOT_EMPTY:mO,FILTERS_CONDITIONS_NOT_EQUAL:wO,FILTERS_CONDITIONS_TODAY:PO,FILTERS_CONDITIONS_TOMORROW:xO,FILTERS_CONDITIONS_YESTERDAY:HO,FILTERS_DIVS_FILTER_BY_CONDITION:AO,FILTERS_DIVS_FILTER_BY_VALUE:DO,FILTERS_LABELS_CONJUNCTION:NO,FILTERS_LABELS_DISJUNCTION:kO,FILTERS_NAMESPACE:ur,FILTERS_VALUES_BLANK_CELLS:LO,LOADING_NAMESPACE:rM,LOADING_TITLE:nM,PAGINATION_COUNTER_SECTION:GO,PAGINATION_FIRST_PAGE:XO,PAGINATION_LAST_PAGE:QO,PAGINATION_NAMESPACE:kn,PAGINATION_NAV_SECTION:KO,PAGINATION_NEXT_PAGE:JO,PAGINATION_PAGE_SIZE_AUTO:YO,PAGINATION_PAGE_SIZE_SECTION:qO,PAGINATION_PREV_PAGE:ZO,PAGINATION_SECTION:UO},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const iM={languageCode:"en-US",[jp]:"No available options",[zp]:"Insert row above",[Up]:"Insert row below",[Yp]:"Insert column left",[qp]:"Insert column right",[Gp]:["Remove row","Remove rows"],[Kp]:["Remove column","Remove columns"],[Xp]:"Undo",[Zp]:"Redo",[qu]:"Read only",[Jp]:"Clear column",[iw]:"Alignment",[ow]:"Left",[sw]:"Center",[aw]:"Right",[lw]:"Justify",[uw]:"Top",[cw]:"Middle",[hw]:"Bottom",[q0]:"Freeze column",[G0]:"Unfreeze column",[tO]:"Borders",[rO]:"Top",[nO]:"Right",[iO]:"Bottom",[oO]:"Left",[sO]:"Remove border(s)",[Z0]:"Add comment",[J0]:"Edit comment",[Q0]:"Delete comment",[eO]:"Read-only comment",[K0]:"Merge cells",[X0]:"Unmerge cells",[Qp]:"Copy",[ew]:["Copy with header","Copy with headers"],[tw]:["Copy with group header","Copy with group headers"],[rw]:["Copy header only","Copy headers only"],[nw]:"Cut",[aO]:"Insert child row",[lO]:"Detach from parent",[uO]:["Hide column","Hide columns"],[cO]:["Show column","Show columns"],[hO]:["Hide row","Hide rows"],[dO]:["Show row","Show rows"],[fO]:"None",[gO]:"Is empty",[mO]:"Is not empty",[pO]:"Is equal to",[wO]:"Is not equal to",[vO]:"Begins with",[yO]:"Ends with",[bO]:"Contains",[CO]:"Does not contain",[SO]:"Greater than",[RO]:"Greater than or equal to",[EO]:"Less than",[TO]:"Less than or equal to",[_O]:"Is between",[OO]:"Is not between",[MO]:"After",[IO]:"Before",[PO]:"Today",[xO]:"Tomorrow",[HO]:"Yesterday",[LO]:"Blank cells",[AO]:"Filter by condition",[DO]:"Filter by value",[NO]:"And",[kO]:"Or",[FO]:"Select all",[VO]:"Clear",[WO]:"OK",[BO]:"Cancel",[$O]:"Search",[jO]:"Value",[zO]:"Second value",[UO]:"Pagination",[qO]:"Page size",[YO]:"Auto",[GO]:"[start] - [end] of [total]",[KO]:"Page [currentPage] of [totalPages]",[XO]:"Go to first page",[ZO]:"Go to previous page",[JO]:"Go to next page",[QO]:"Go to last page",[eM]:"Checked",[tM]:"Unchecked",[nM]:"Loading..."},NW=DW,dm=iM.languageCode,{register:kW,getItem:oM,hasItem:LW,getValues:FW}=ko("languagesDictionaries");sM(iM);function sM(t,e){let r=t,n=e;return nt(t)&&(n=t,r=n.languageCode),VW(r,n),kW(r,Sr(n)),Sr(n)}function VW(t,e){t!==dm&&MW(e,oM(dm))}function aM(t){return fw(t)?Sr(oM(t)):null}function fw(t){return LW(t)}function WW(){return FW()}function lM(t,e,r){const n=aM(t);if(n===null)return null;const i=n[e];if($t(i))return null;const o=BW(i,r);return Array.isArray(o)?o[0]:o}function BW(t,e){return HW().reduce((r,n)=>n(r,e),t)}function $W(t){let e=$0(t);return fw(e)||(e=dm,j0(t)),e}function jW(t,e,r){return(e=zW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zW(t){var e=UW(t,"string");return typeof e=="symbol"?e:e+""}function UW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class li extends R0{constructor(e,r){super(e,null),jW(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function mg(t){let{activeHeaderClassName:e,...r}=t;return new li({className:e,...r,selectionType:dV})}function YW(t){let{areaCornerVisible:e,...r}=t;return new li({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:Ap})}function qW(t){let{...e}=t;return new li({className:"highlight",...e,selectionType:Ap})}function GW(t){let{columnClassName:e,...r}=t;return new li({className:e,...r,selectionType:mV})}function KW(t){let{cellCornerVisible:e,...r}=t;return new li({className:"current",headerAttributes:[L_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Uu})}function XW(t){let{border:e,visualCellRange:r,...n}=t;return new li({...e,...n,selectionType:pV},r)}function ZW(t){let{...e}=t;return new li({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:fV})}function RR(t){let{headerClassName:e,...r}=t;return new li({className:e,...r,selectionType:E0})}function JW(t){let{rowClassName:e,...r}=t;return new li({className:e,...r,selectionType:gV})}function QW(t,e){eB(t,e),e.add(t)}function eB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(t,e,r){return(e=tB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tB(t){var e=rB(t,"string");return typeof e=="symbol"?e:e+""}function rB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Un(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bn=new WeakSet;class nB{constructor(e){QW(this,bn),Xt(this,"options",void 0),Xt(this,"layerLevel",0),Xt(this,"focus",void 0),Xt(this,"fill",void 0),Xt(this,"layeredAreas",new Map),Xt(this,"areas",new Map),Xt(this,"rowHeaders",new Map),Xt(this,"columnHeaders",new Map),Xt(this,"activeRowHeaders",new Map),Xt(this,"activeColumnHeaders",new Map),Xt(this,"activeCornerHeaders",new Map),Xt(this,"rowHighlights",new Map),Xt(this,"columnHighlights",new Map),Xt(this,"customSelections",[]),this.options=e,this.focus=KW(e),this.fill=ZW(e)}isEnabledFor(e,r){let n=e;e===Uu&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Un(bn,this,Yn).call(this,this.layeredAreas,YW)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Un(bn,this,Yn).call(this,this.areas,qW)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Un(bn,this,Yn).call(this,this.rowHeaders,RR)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Un(bn,this,Yn).call(this,this.columnHeaders,RR)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Un(bn,this,Yn).call(this,this.activeRowHeaders,mg)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Un(bn,this,Yn).call(this,this.activeColumnHeaders,mg)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Un(bn,this,Yn).call(this,this.activeCornerHeaders,mg)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Un(bn,this,Yn).call(this,this.rowHighlights,JW)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Un(bn,this,Yn).call(this,this.columnHighlights,GW)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(XW({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),j(this.areas.values(),e=>void e.clear()),j(this.layeredAreas.values(),e=>void e.clear()),j(this.rowHeaders.values(),e=>void e.clear()),j(this.columnHeaders.values(),e=>void e.clear()),j(this.activeRowHeaders.values(),e=>void e.clear()),j(this.activeColumnHeaders.values(),e=>void e.clear()),j(this.activeCornerHeaders.values(),e=>void e.clear()),j(this.rowHighlights.values(),e=>void e.clear()),j(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Yn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function ER(t,e,r){return(e=iB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iB(t){var e=oB(t,"string");return typeof e=="symbol"?e:e+""}function oB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gw{constructor(e){ER(this,"ranges",[]),ER(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new gw(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function sB(t,e){uM(t,e),e.add(t)}function aB(t,e,r){return(e=lB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lB(t){var e=uB(t,"string");return typeof e=="symbol"?e:e+""}function uB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pg(t,e,r){uM(t,e),e.set(t,r)}function uM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ut(t,e){return t.get(_e(t,e))}function hs(t,e,r){return t.set(_e(t,e),r),r}function _e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Xn=new WeakMap,lo=new WeakMap,br=new WeakMap,Pe=new WeakSet;class mw{constructor(e,r){sB(this,Pe),pg(this,Xn,void 0),pg(this,lo,0),pg(this,br,{x:0,y:0}),aB(this,"tableApi",void 0),hs(Xn,this,e),this.tableApi=r}setActiveLayerIndex(e){hs(lo,this,e)}getCurrentSelection(){return ut(Xn,this).peekByIndex(ut(lo,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;hs(br,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=_e(Pe,this,fm).call(this);const{row:h,col:d}=_e(Pe,this,MR).call(this,o),g=this.tableApi.fixedRowsBottom(),w=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),C=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),b=this.tableApi.createCellCoords(h+i.row,d+i.col);if(b.row>=c){const I=yr(n&&w>0&&g===0),x=b.col+1,P=x>=u,A=this.tableApi.createCellCoords(b.row-c,P?x-u:x);if(this.runLocalHooks("beforeColumnWrap",I,_e(Pe,this,Ko).call(this,A),P),I.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&P&&ut(Xn,this).size()>1){_e(Pe,this,TR).call(this);const F=_e(Pe,this,ql).call(this,"forward");F!==null&&A.assign(F)}b.assign(A)}}else if(b.row<0){const I=yr(T),x=b.col-1,P=x<0,A=this.tableApi.createCellCoords(c+b.row,P?u+x:x);if(this.runLocalHooks("beforeColumnWrap",I,_e(Pe,this,Ko).call(this,A),P),T){if(this.shouldSwitchSelectionLayer()&&P&&ut(Xn,this).size()>1){_e(Pe,this,_R).call(this);const F=_e(Pe,this,ql).call(this,"backward");F!==null&&A.assign(F)}b.assign(A)}}if({width:u,height:c}=_e(Pe,this,fm).call(this),b.col>=u){const I=yr(n&&v>0),x=b.row+1,P=x>=c,A=this.tableApi.createCellCoords(P?x-c:x,b.col-u);if(this.runLocalHooks("beforeRowWrap",I,_e(Pe,this,Ko).call(this,A),P),I.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(C){if(this.shouldSwitchSelectionLayer()&&P&&ut(Xn,this).size()>1){_e(Pe,this,TR).call(this);const F=_e(Pe,this,ql).call(this,"forward");F!==null&&A.assign(F)}b.assign(A)}}else if(b.col<0){const I=yr(C),x=b.row-1,P=x<0,A=this.tableApi.createCellCoords(P?c+x:x,u+b.col);if(this.runLocalHooks("beforeRowWrap",I,_e(Pe,this,Ko).call(this,A),P),C){if(this.shouldSwitchSelectionLayer()&&P&&ut(Xn,this).size()>1){_e(Pe,this,_R).call(this);const F=_e(Pe,this,ql).call(this,"backward");F!==null&&A.assign(F)}b.assign(A)}}const{rowDir:E,colDir:y}=_e(Pe,this,OR).call(this,b);a=E,l=y,o=_e(Pe,this,Ko).call(this,b)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:ut(lo,this),visualCoords:o}}transformEnd(e,r){hs(br,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=_e(Pe,this,Tu).call(this,i.to.row,i.from.row),a=_e(Pe,this,_u).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=_e(Pe,this,MR).call(this,i.highlight),g=this.tableApi.createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),v=i.getTopEndCorner(),C=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const y=g.col-d;g.col=_e(Pe,this,_u).call(this,w.col,v.col)+y}else if(n.col>0&&a<=d&&g.col>d){const y=_e(Pe,this,_u).call(this,v.col,w.col),I=Math.max(g.col-y,1);g.col=y+I}if(n.row<0&&s>=h&&g.row<h){const y=g.row-h;g.row=_e(Pe,this,Tu).call(this,w.row,C.row)+y}else if(n.row>0&&s<=h&&g.row>h){const y=_e(Pe,this,Tu).call(this,C.row,w.row),I=Math.max(g.row-y,1);g.row=y+I}const{rowDir:T,colDir:b}=_e(Pe,this,OR).call(this,g);u=T,c=b;const E=_e(Pe,this,Ko).call(this,g);n.row===0&&n.col!==0?l.col=E.col:n.row!==0&&n.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:ut(lo,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function TR(){const t=ut(lo,this)+1;this.setActiveLayerIndex(t>=ut(Xn,this).size()?0:t),hs(br,this,this.calculateOffset())}function _R(){const t=ut(lo,this)-1;this.setActiveLayerIndex(t<0?ut(Xn,this).size()-1:t),hs(br,this,this.calculateOffset())}function OR(t){const{width:e,height:r}=_e(Pe,this,fm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function fm(){return{width:ut(br,this).x+this.countRenderableColumns(),height:ut(br,this).y+this.countRenderableRows()}}function ql(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,o,s]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=_e(Pe,this,Tu).call(this,n,i),l=_e(Pe,this,_u).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Tu(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:ut(br,this).y+r}function _u(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ut(br,this).x+r}function MR(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(ut(br,this).y+e,ut(br,this).x+r)}function Ko(t){const e=t.clone();return e.col=t.col-ut(br,this).x,e.row=t.row-ut(br,this).y,this.tableApi.renderableToVisualCoords(e)}Je(mw,Nn);class cB extends mw{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class hB extends mw{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),o=this.tableApi.countRenderableRowsInRange(0,r-1),s=e.highlight.isHeader(),a=s?Math.abs(n):0,l=s?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const xc=0,Hc=1,cM=2,pw=3,dB=[pw,cM],fB=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],wg=Symbol("root"),IR=Symbol("child");function Ac(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wg;if(e!==wg&&e!==IR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===wg;let i=xc;if(r){const o=t[0];t.length===0?i=Hc:n&&o instanceof gl?i=pw:n&&Array.isArray(o)?i=Ac(o,IR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!fB[l].includes(typeof a))&&(i=cM)}return i}function ww(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!dB.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===pw;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),$t(u)&&(u=a),$t(c)&&(c=l),!n){const w=a,v=l,C=u,T=c;a=Math.min(w,C),l=Math.min(v,T),u=Math.max(w,C),c=Math.max(v,T)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),g=e(u,c);return r(h,d,g)}}function gB(t){const e=Ac(t.getSelected());if(e===xc||e===Hc)return[];const r=ww(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return Do(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function mB(t){const e=Ac(t.getSelected());if(e===xc||e===Hc)return[];const r=ww(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return Do(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Xi(t,e,r){pB(t,e),e.set(t,r)}function pB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zi(t,e,r){return(e=wB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wB(t){var e=vB(t,"string");return typeof e=="symbol"?e:e+""}function vB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function je(t,e){return t.get(hM(t,e))}function fr(t,e,r){return t.set(hM(t,e),r),r}function hM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gr=new WeakMap,Xo=new WeakMap,Gl=new WeakMap,pi=new WeakMap,Kl=new WeakMap,da=new WeakMap,Xl=new WeakMap;class dM{constructor(e,r){var n=this;Zi(this,"settings",void 0),Zi(this,"tableProps",void 0),Zi(this,"inProgress",!1),Zi(this,"selectedRange",new gw((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Zi(this,"highlight",void 0),Xi(this,gr,void 0),Xi(this,Xo,void 0),Zi(this,"selectedByRowHeader",new Set),Zi(this,"selectedByColumnHeader",new Set),Xi(this,Gl,!1),Xi(this,pi,!1),Xi(this,Kl,"unknown"),Xi(this,da,-1),Xi(this,Xl,0),this.settings=e,this.tableProps=r,this.highlight=new nB({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[L_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),fr(gr,this,new cB(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),fr(Xo,this,new hB(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),je(gr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),je(gr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),je(gr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),je(gr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),je(gr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),je(gr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),je(gr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),je(gr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),je(Xo,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),je(Xo,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(je(Xl,this))}getActiveSelectionLayerIndex(){return je(Xl,this)}setActiveSelectionLayerIndex(e){fr(Xl,this,e)}markSource(e){fr(Kl,this,e)}markEndSource(){fr(Kl,this,"unknown")}getSelectionSource(){return je(Kl,this)}setExpectedLayers(e){fr(da,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,fr(da,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=$t(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();fr(pi,this,!1),fr(Gl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&$t(r))&&(this.selectedRange.clear(),j(this.highlight.getAreas(),l=>void l.clear()),j(this.highlight.getLayeredAreas(),l=>void l.clear()),j(this.highlight.getRowHeaders(),l=>void l.clear()),j(this.highlight.getColumnHeaders(),l=>void l.clear()),j(this.highlight.getActiveRowHeaders(),l=>void l.clear()),j(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),j(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),j(this.highlight.getRowHighlights(),l=>void l.clear()),j(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&n.col<0&&!s||o===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(n),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const l=je(da,this)===-1||this.selectedRange.size()===je(da,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(Ap,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(E0,e.highlight)){if(!e.isSingleHeader()){const C=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(C).commit(),l.add(b).commit(),d.add(C).commit(),g.add(b).commit()):(a.add(C).add(T).commit(),l.add(b).add(E).commit(),d.add(C).add(T).commit(),g.add(b).add(E).commit())}const w=!je(pi,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!je(pi,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),je(gr,this).setActiveLayerIndex(r),je(Xo,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Uu,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(fr(Gl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=je(gr,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=je(gr,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=je(Xo,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(De(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(De(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(De(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,De(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,De(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,De(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=yr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&je(Gl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(De(d.row,u,o-1),De(d.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",w,v,h),this.setRangeStartOnly(w,void 0,h),fr(pi,this,g),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",w,v,h),this.finish()}selectCells(e){var r=this;const n=Ac(e);if(n===Hc)return!1;if(n===xc)throw new Error(ar`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=ww(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),j(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,w=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=De(n.row,u,s-1),w=De(n.col,Math.min(i,o),Math.max(i,o))):(g=De(n,u,s-1),w=i);const v=this.tableProps.createCellCoords(g,w),C=l===0?0:De(v.row,u,-1),T=s-1,b=this.tableProps.createCellCoords(C,i),E=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",b,E,v),this.setRangeStartOnly(b,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",b,E,v),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=De(n.row,Math.min(e,r),Math.max(e,r)),d=De(n.col,a,o-1)):(h=e,d=De(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),w=s===0?0:De(g.col,a,-1),v=o-1,C=this.tableProps.createCellCoords(e,w),T=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",C,T,g),this.setRangeStartOnly(C,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",C,T,g),this.finish()}return c}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,fr(pi,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),fr(pi,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:je(pi,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:De(u.row,this.settings.navigableHeaders?-1/0:0,c),col:De(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:De(a.row,-1/0,c),col:De(a.col,-1/0,h)}),l.assign({row:De(l.row,-1/0,c),col:De(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(Uu,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Je(dM,Nn);const PR=/^(\r\n|\n\r|\r|\n)/,yB=/^[^\t\r\n]+/,xR=/^\t/;function bB(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(xR))t=t.replace(xR,""),r+=1,e[n][r]="";else if(t.match(PR))t=t.replace(PR,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(yB);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Gu(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function vg(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:o}=e;return Oe(o)?o.call(r,t,n,i,e):t}function CB(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:o}=e;return Oe(o)?o.call(r,t,n,i,e):t}function Ji(t,e,r){return(e=SB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SB(t){var e=RB(t,"string");return typeof e=="symbol"?e:e+""}function RB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ds{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Ji(this,"hot",void 0),Ji(this,"metaManager",void 0),Ji(this,"tableMeta",void 0),Ji(this,"dataSource",void 0),Ji(this,"duckSchema",void 0),Ji(this,"colToPropCache",void 0),Ji(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=wp(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(nt(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return x0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&He(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&he(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(he(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ga(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=Sr(this.getSchema()):(w=[],Ge(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},F_(w,this.getSchema())),d.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let w=d;g<r&&l+g<s;w++){if(typeof c!="number"||c>=l+g)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(w,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=he(this.tableMeta.columns)||he(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];LC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return KD(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];LC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Wr(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let c=i;if(!c)return null;const h=r.split(".");for(let d=0,g=h.length;d<g;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(bs(n)&&bs(u)&&(a=CB(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=yr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=yr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Wr(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,ds.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===ds.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return Gu(this.getRange(e,r,ds.DESTINATION_RENDERER))}getCopyableText(e,r){return Gu(this.getRange(e,r,ds.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:EB,getItem:TB,hasItem:fM}=ko("cellTypes");function _B(t){if(!fM(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return TB(t)}function OB(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&o0(t,r),n&&Kk(t,n),i&&Qk(t,i),EB(t,e)}function MB(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Wr(e,t)}function Dc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?_B(e.type):e.type;if(t._automaticallyAssignedMetaProps&&He(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!nt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};He(n,(o,s)=>{if(MB(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Di(t,i)}function IB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}yN(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Ou(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Zl(t){return t==null}const gM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),yo(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),yo(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),V_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function HR(t,e,r){return(e=PB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PB(t){var e=xB(t,"string");return typeof e=="symbol"?e:e+""}function xB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HB(){return class{}}class AB{constructor(e){HR(this,"metaCtor",HB()),HR(this,"meta",void 0),this.meta=this.metaCtor.prototype,Di(this.meta,gM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Di(this.meta,e),Dc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function DB(t,e,r){return(e=NB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NB(t){var e=kB(t,"string");return typeof e=="symbol"?e:e+""}function kB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LB{constructor(e){DB(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Di(this.meta,e),Dc(this.meta,e,e)}}function Jl(t,e,r){return(e=FB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FB(t){var e=VB(t,"string");return typeof e=="symbol"?e:e+""}function VB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ku{constructor(e){Jl(this,"valueFactory",void 0),Jl(this,"data",[]),Jl(this,"index",[]),Jl(this,"holes",new Set),this.valueFactory=e}obtain(e){Ou(()=>bs(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ou(()=>bs(e)||Zl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Zl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ou(()=>bs(e)||Zl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Zl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function AR(t,e,r){return(e=WB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WB(t){var e=BB(t,"string");return typeof e=="symbol"?e:e+""}function BB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $B=["data","width"];class jB{constructor(e){AR(this,"globalMeta",void 0),AR(this,"metas",new Ku(()=>this._createMeta())),this.globalMeta=e,this.metas=new Ku(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Di(n,r),Dc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return IB(this.globalMeta.getMetaConstructor(),$B).prototype}}function DR(t,e,r){return(e=zB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zB(t){var e=UB(t,"string");return typeof e=="symbol"?e:e+""}function UB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YB{constructor(e){DR(this,"columnMeta",void 0),DR(this,"metas",new Ku(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Di(i,n),Dc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)he(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Ou(()=>bs(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ku(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class mM{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new AB(e),this.tableMeta=new LB(this.globalMeta),this.columnMeta=new jB(this.globalMeta),this.cellMeta=new YB(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Je(mM,Nn);function NR(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Rc(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Oe(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new ds(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let v,C=0,T=0;for(C=0,T=d.startRows;C<T;C++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Sr(w),t.push(v);else if(i.dataType==="array")v=Sr(w[0]),t.push(v);else{v=[];for(let b=0,E=d.startCols;b<E;b++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Me(i.rootElement,[N_(-1),Ec(i.countCols()+(i.view?i.countRowHeaders():0))])}function kR(t,e,r){return(e=qB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qB(t){var e=GB(t,"string");return typeof e=="symbol"?e:e+""}function GB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KB{constructor(e){var r=this;kR(this,"metaManager",void 0),kR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Wr(e,"type")?e.type:null;let c=Oe(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function XB(t,e,r){ZB(t,e),e.set(t,r)}function ZB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yg(t,e,r){return(e=JB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JB(t){var e=QB(t,"string");return typeof e=="symbol"?e:e+""}function QB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e$(t,e){return t.get(t$(t,e))}function t$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var LR=new WeakMap;class r${constructor(e){yg(this,"metaManager",void 0),yg(this,"usageTracker",new Set),yg(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),XB(this,LR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,e$(LR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const pM="gridDefault",wM="editorManager.handlingEditor",n$={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},i$="hooksRefRegisterer",vM={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){j(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){He(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ai(vM,"MIXIN_NAME",i$,{writable:!1,enumerable:!1});function Jr(t,e,r){return(e=o$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o$(t){var e=s$(t,"string");return typeof e=="symbol"?e:e+""}function s$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const a$="base",lt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class vw{static get EDITOR_TYPE(){return a$}constructor(e){Jr(this,"hot",void 0),Jr(this,"state",lt.VIRGIN),Jr(this,"_opened",!1),Jr(this,"_fullEditMode",!1),Jr(this,"_closeCallback",null),Jr(this,"TD",null),Jr(this,"row",null),Jr(this,"col",null),Jr(this,"prop",null),Jr(this,"originalValue",null),Jr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:lt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();n=u.row,i=u.col,o=c.row,s=c.col}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==lt.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=lt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:mp(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===lt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===lt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=lt.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=lt.FINISHED,this.discardEditor(s)}):(this.state=lt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=lt.FINISHED,this.discardEditor()}discardEditor(e){this.state===lt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=lt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=lt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===lt.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=kr(r),a=ir(r),l=kr(this.hot.rootElement),u=ir(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,C=v.name,T=["master","inline_start"].includes(C)?d:0,b=["master","top","bottom"].includes(C)?g:0,E=s.top===l.top?0:1;let y=s.top-l.top-E-T,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-w-1+b:I=s.left-l.left-1-b,["top","top_inline_start_corner"].includes(C)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(C)&&(I+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const x=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),A=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),W=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(x&&P<=0||P===W)&&(y+=1),A<=0&&(I+=1);const q=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,ae=Math.abs(n.inlineStartOverlay.getScrollPosition()),K=n.topOverlay.getScrollPosition(),te=jt(this.hot.rootDocument);let dt=r.offsetTop;if(["inline_start","master"].includes(C)&&(dt+=q-K),["bottom","bottom_inline_start_corner"].includes(C)){const{wtViewport:_,wtTable:O}=n.bottomOverlay.clone;dt+=_.getWorkspaceHeight()-O.getHeight()-te}let Re=r.offsetLeft;this.hot.isRtl()?(Re>=0?Re=v.getWidth()-r.offsetLeft:Re=Math.abs(Re),Re+=L-ae-a):["top","master","bottom"].includes(C)&&(Re+=L-ae);const Ee=o.getComputedStyle(this.TD),Ye=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Be=parseInt(Ee[Ye],10)>0?0:1,Ie=parseInt(Ee.borderTopWidth,10)>0?0:1,fn=ir(r)+Be,Te=lr(r)+Ie,f=FN(c)?te:0,m=VN(h)?te:0,p=this.hot.view.maximumVisibleElementWidth(Re)-f+Be,R=Math.max(this.hot.view.maximumVisibleElementHeight(dt)-m+Ie,this.hot.stylesHandler.getDefaultRowHeight());return{top:y,start:I,height:Te,maxHeight:R,width:fn,maxWidth:p}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Je(vw,vM);const l$={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===lt.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},u$={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},c$={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},h$={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},d$={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>n.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),_c(e))}};function f$(){return[n$,l$,u$,c$,h$,d$]}const g$={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},m$={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},p$={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},w$={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},v$={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},y$={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},b$={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},C$={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},S$={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},R$={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},E$={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},T$={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},_$={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},O$={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function M$(){return[g$,m$,p$,w$,v$,y$,b$,C$,S$,R$,E$,T$,_$,O$]}const I$={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},P$={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},x$={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},H$={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},A$={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},D$={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},N$={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},k$={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},L$={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},F$={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},V$={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},W$={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},B$={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},$$={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},j$={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},z$={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function U$(){return[I$,P$,x$,H$,A$,D$,N$,k$,L$,F$,V$,W$,B$,$$,j$,z$]}const Y$={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},q$={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},G$={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},K$={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},X$={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Z$=[...f$(),...M$(),...U$(),Y$,q$,G$,K$,X$];function yM(t){const e={};return Z$.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function J$(t){const e=t.getShortcutManager().addContext("editor"),r=yM(t),n={group:wM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function Q$(t){const e=t.getShortcutManager().addContext("grid"),r=yM(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return he(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:pM};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:wM,runOnlyIf:()=>he(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function ej(t){[Q$,J$].forEach(e=>e(t))}function tj(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=FR(t),i=FR(t);return n.addEventListener("focus",()=>r?.onFocus("from_above")),i.addEventListener("focus",()=>r?.onFocus("from_below")),e.prepend(n),e.append(i),{focus(o){o==="from_above"?n.focus():i.focus()},activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function FR(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Me(r,[Wu("Focus catcher")]),r}function rj(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=tm(t),o=rm(t);return e.row=De(e.row,i.row,o.row),e.col=De(e.col,i.col,o.col),e}}function nj(t){const e=rj(t);let r;const{activate:n,deactivate:i}=tj(t,t.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const w=(d=e(r))!==null&&d!==void 0?d:tm(t),v=t.runHooks("modifyFocusOnTabNavigation","from_above",w);w&&v!==!1&&t.selectCell(w.row,w.col)}else{var g;const w=(g=e(r))!==null&&g!==void 0?g:rm(t),v=t.runHooks("modifyFocusOnTabNavigation","from_below",w);w&&v!==!1&&t.selectCell(w.row,w.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&i()}),t.addHook("afterUnlisten",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&n()}),t.addHook("afterSelection",(h,d,g,w,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var C;r=(C=t.getSelectedRangeActive())===null||C===void 0?void 0:C.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:pM,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeActive()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?tm(t):rm(t)),u(),!1;h.preventDefault()},position:"after"}])}function $s(t){wo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Nc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,v=g<=h,C=w>=d;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?n.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:v&&C?n.highlight.row:v?g:C?w:T.row}}}function ij(t){return e=>{const r=Nc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;$s(t.getCell(n?-1:0,r,!0))})}}function oj(){return()=>{}}function sj(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;$s(t.getCell(n,i,!0))})}}function aj(t){return e=>{const r=Nc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;$s(t.getCell(i,o,!0))})}}function lj(t){return e=>{const r=Nc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;$s(t.getCell(i,o,!0))})}}function uj(t){return e=>{const r=Nc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;$s(t.getCell(r,n?-1:0,!0))})}}function cj(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{$s(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function hj(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=sj(t):e.isSelectedByCorner()?s=oj():e.isSelectedByRowHeader()?s=uj(t):e.isSelectedByColumnHeader()?s=ij(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=aj(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=cj(t):e.getSelectedRange().size()>1&&(s=lj(t)),(o=s)===null||o===void 0||o(i)}}}const VR=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ql=t=>t.map(e=>{const r=e.toLowerCase();return VR.has(r)?VR.get(r):r}).sort().join("+"),dj=t=>t.split("+"),WR=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),bg=t=>{let{which:e,key:r}=t;if(WR.has(e))return WR.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},bM=Symbol("shortcut-context");function gm(t){return nt(t)&&t.__kindOf===bM}const fj=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=Oc({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:w=!0,stopPropagation:v=!1,relativeToGroup:C,position:T,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if($t(h))throw new Error("You need to define the shortcut's group.");if(Oe(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(ar`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const E={callback:c,group:h,runOnlyIf:d,captureCtrl:g,preventDefault:w,stopPropagation:v};he(C)&&(E.relativeToGroup=C,E.position=T),gm(b)&&(E.forwardToContext=b),u.forEach(y=>{const I=Ql(y);if(r.hasItem(I)){const P=r.getItem(I);let A=P.findIndex(F=>F.group===C);A!==-1?T==="before"?A-=1:A+=1:A=P.length,P.splice(A,0,E)}else r.addItem(I,[E])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{He(c,(d,g)=>{Object.prototype.hasOwnProperty.call(h,g)===!1&&(h[g]=c[g])}),n(h)})},o=u=>{const c=Ql(u);r.removeItem(c)};return{__kindOf:bM,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const c=Ql(u),h=r.getItem(c);return he(h)?h.slice():[]},hasShortcut:u=>{const c=Ql(u);return r.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{r.getItems().forEach(h=>{let[d,g]=h;const w=g.filter(v=>v.group!==u);w.length===0?o(dj(d)):(g.length=0,g.push(...w))})}}};function gj(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const mj=["meta","alt","shift","control"],fa=gj(),ga=[];let eu=0;function pj(t,e,r,n,i){const o=g=>mj.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),w&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||so(g))return;const v=bg(g);let C=[];o(v)||(C=s(g));const T=[v].concat(C);!i(g,T)&&(ZC()&&C.includes("meta")||!ZC()&&C.includes("control"))&&i(g,[v].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const w=bg(g);o(w)&&fa.press(w)}},u=g=>{if(typeof g.key=="string"){const w=bg(g);o(w)&&fa.release(w)}},c=()=>{fa.releaseAll()};return{mount:()=>{let g=t;for(eu+=1;g;)eu===1&&(g.document.documentElement.addEventListener("keydown",l),ga.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),ga.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Ka(g)},unmount:()=>{let g=t;for(eu-=1;g;){if(eu===0){for(let w=0;w<ga.length;w++){const{event:v,listener:C}=ga[w];g.document.documentElement.removeEventListener(v,C)}ga.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Ka(g)}},isPressed:g=>fa.isPressed(g),releasePressedKeys:()=>fa.releaseAll()}}const wj=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=Oc({errorIdExists:v=>`The "${v}" context name is already registered.`});let s="grid";const a=function(v){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const T=fj(v,C);return o.addItem(v,T),T},l=()=>s,u=v=>o.getItem(v),c=v=>{if(!o.hasItem(v))throw new Error(ar`You've tried to activate the "${v}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=v};let h=!1;const d=function(v,C){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=gm(T)?T:u(T);let E=!1;if(!b.hasShortcut(C))return E;const y=b.getShortcuts(C);for(let I=0;I<y.length;I++){const{callback:x,runOnlyIf:P,preventDefault:A,stopPropagation:F,captureCtrl:W,forwardToContext:q}=y[I];if(P(v)===!0){if(h=W,E=x(v,C)===!1,h=!1,A&&v.preventDefault(),F&&(_c(v),v.stopPropagation()),E)break;q&&d(v,C,q)}}return E},w=pj(e,v=>{const C=l(),T=gm(C)?C:u(C);return r(v,T.scope)},n,i,d);return w.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(w.isPressed("control")||w.isPressed("meta")),releasePressedKeys:()=>w.releasePressedKeys(),destroy:()=>w.unmount()}};function BR(t){const{classNames:e}=PN(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function vj(t,e){CM(t,e),e.add(t)}function wi(t,e,r){CM(t,e),e.set(t,r)}function CM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(t,e){return t.get(nn(t,e))}function vr(t,e,r){return t.set(nn(t,e),r),r}function nn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $R=23;var Cn=new WeakMap,Xu=new WeakMap,yw=new WeakMap,mm=new WeakMap,Si=new WeakMap,Ia=new WeakMap,Za=new WeakMap,ma=new WeakMap,Rn=new WeakSet;class yj{constructor(e){let{rootElement:r,rootDocument:n,onThemeChange:i=()=>{}}=e;vj(this,Rn),wi(this,Cn,void 0),wi(this,Xu,void 0),wi(this,yw,void 0),wi(this,mm,void 0),wi(this,Si,!0),wi(this,Ia,{}),wi(this,Za,{}),wi(this,ma,void 0),vr(Xu,this,r),vr(mm,this,n),vr(ma,this,i)}isClassicTheme(){return Xe(Si,this)}getCSSVariableValue(e){var r;if(Xe(Si,this))return null;if(Xe(Ia,this)[`--ht-${e}`])return Xe(Ia,this)[`--ht-${e}`];const n=(r=nn(Rn,this,Sj).call(this,`--ht-${e}`))!==null&&r!==void 0?r:nn(Rn,this,SM).call(this,`--ht-${e}`);if(n!==null)return Xe(Ia,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Xe(Za,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Xe(Si,this))return $R;const e=nn(Rn,this,bj).call(this);return e||$R}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){vr(Cn,this,void 0),vr(Si,this,!0),Xe(ma,this).call(this,Xe(Cn,this)),nn(Rn,this,Cg).call(this);return}if(e&&e!==Xe(Cn,this)){if(!/ht-theme-.*/.test(e)){Br(`Invalid theme name: ${e}. Please provide a valid theme name.`),vr(Cn,this,void 0),vr(Si,this,!1),Xe(ma,this).call(this,Xe(Cn,this)),nn(Rn,this,Cg).call(this);return}Xe(Cn,this)&&nn(Rn,this,Rj).call(this),vr(Cn,this,e),vr(Si,this,!1),Xe(ma,this).call(this,Xe(Cn,this)),nn(Rn,this,Cg).call(this)}}getThemeName(){return Xe(Cn,this)}}function bj(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function Cg(){this.isClassicTheme()||vr(yw,this,getComputedStyle(Xe(Xu,this)));const t=nn(Rn,this,Cj).call(this,["box-sizing","border-bottom-width"]);Xe(Za,this).td={...Xe(Za,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Cj(t){const e=Xe(mm,this),r=Xe(Xu,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function Sj(t){const e=Math.ceil(parseFloat(nn(Rn,this,SM).call(this,t)));return Number.isNaN(e)?null:e}function SM(t){const e=Xe(yw,this).getPropertyValue(t);return e===""?null:e}function Rj(){vr(Za,this,{}),vr(Ia,this,{}),vr(Si,this,!0)}function Ej(t,e){RM(t,e),e.add(t)}function jR(t,e,r){RM(t,e),e.set(t,r)}function RM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zR(t,e){return t.get(Os(t,e))}function UR(t,e,r){return t.set(Os(t,e),r),r}function Os(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pm=new WeakMap,wm=new WeakMap,Wa=new WeakSet;class Tj{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;Ej(this,Wa),jR(this,pm,void 0),jR(this,wm,void 0),UR(pm,this,r),UR(wm,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Os(Wa,this,YR).call(this,e.from,r,n);if(i===null)return null;const o=Os(Wa,this,YR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function YR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Os(Wa,this,qR).call(this,zR(pm,this),t.row,e);if(n===null)return null;const i=Os(Wa,this,qR).call(this,zR(wm,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function qR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let Zn=null,Mu=0;function _j(t){const e=t.ownerDocument;if(!Zn){Zn=e.createElement("div"),Zn.setAttribute("role","status"),Zn.setAttribute("aria-live","assertive"),Zn.setAttribute("aria-atomic","true");const r=Zn.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(Zn)}Mu+=1}function Oj(){Mu!==0&&(Mu===1&&(Zn.remove(),Zn=null),Mu-=1)}let Sg=null;const tu=new WeakSet,Rg=new Map;function EM(t,e){var r,n,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Ni(s);let l,u,c,h,d,g,w=!0;const v={...e.initialState,...e};UV(o)&&zV(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=io(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,io(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),X(this.rootElement,["ht-wrapper","handsontable"]),X(this.rootWrapperElement,"ht-root-wrapper"),X(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),X(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const C=(r=v?.layoutDirection)!==null&&r!==void 0?r:"inherit",T=["rtl","ltr"].includes(C)?C:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new yj({rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:f=>{io(this)&&(xe(this.rootWrapperElement,/ht-theme-.*/g),xe(this.rootPortalElement,/ht-theme-.*/g),f&&(X(this.rootWrapperElement,f),X(this.rootPortalElement,f),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Br(`The "${f}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=$W(v.language);const b=Object.fromEntries(Object.entries(v).filter(f=>{let[m]=f;return!(fe.getSingleton().isRegistered(m)||fe.getSingleton().isDeprecated(m))})),E=new mM(s,b,[KB,r$]),y=E.getTableMeta(),I=E.getGlobalMeta(),x=Oc();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${P_()}`,Rg.set(this.guid,this),this.columnIndexMapper=new hm,this.rowIndexMapper=new hm,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{s.runHooks("beforeCompositionStart",f)}),u=new iW(s);const P=ko(this.guid);P.register("cellRangeMapper",new Tj({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},F=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)},W=(f,m)=>{const p=m>f?1:-1,R=Math.min(f,m),_=Math.max(f,m),O=s.rowIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<R?null:O>=0?s.rowIndexMapper.getRenderableFromVisualIndex(O):O},q=(f,m)=>{const p=m>f?1:-1,R=Math.min(f,m),_=Math.max(f,m),O=s.columnIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<R?null:O>=0?s.columnIndexMapper.getRenderableFromVisualIndex(O):O};let L=new dM(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,p)=>s._createCellRange(f,m,p),visualToRenderableCoords:A,renderableToVisualCoords:F,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:q,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=L;const ae=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",ae),this.rowIndexMapper.addLocalHook("cacheUpdated",ae),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const p=yr(!1),R=this.selection.getSelectedRange(),{from:_,to:O}=R.current(),H=R.size()-1;this.runHooks("afterSelection",_.row,_.col,O.row,O.col,p,H),this.runHooks("afterSelectionByProp",_.row,s.colToProp(_.col),O.row,s.colToProp(O.col),p,H),m&&(!p.isTouched()||p.isTouched()&&!p.value)&&g.scrollTo(f);const k=L.isSelectedByRowHeader(),U=L.isSelectedByColumnHeader();k&&U?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):k?(xe(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):U?(xe(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(L.getSelectionSource())||h.closeEditor(null),L.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=yr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(f),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:p,to:R}=f[m];this.runHooks("afterSelectionEnd",p.row,p.col,R.row,R.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),R.row,s.colToProp(R.col),m),L.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectAll",...m)}).addLocalHook("afterSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectAll",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,R=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0;const O=H=>{if(H.length===0)return[];const k=[...H];return k.sort((B,M)=>{let[$]=B,[Q]=M;return $===Q?0:$>Q?1:-1}),Do(k,(B,M)=>{let[$,Q]=M;const ie=B[B.length-1],[be,le]=ie,de=be+le;if($<=de){const Ae=Math.max(Q-(de-$),0);ie[1]+=Ae}else B.push([$,Q]);return B},[k[0]])};switch(f){case"insert_row_below":case"insert_row_above":const H=s.countSourceRows();if(y.maxRows===H)return;const k=f==="insert_row_below"?"below":"above";m=m??(k==="below"?H:0);const{delta:U,startPhysicalIndex:B}=l.createRow(m,p,{source:R,mode:k});L.shiftRows(s.toVisualRow(B),U);break;case"insert_col_start":case"insert_col_end":const M=f==="insert_col_end"?"end":"start";m=m??(M==="end"?s.countSourceCols():0);const{delta:$,startPhysicalIndex:Q}=l.createCol(m,p,{source:R,mode:M});if($){if(Array.isArray(y.colHeaders)){const le=[s.toVisualColumn(Q),0];le.length+=$,Array.prototype.splice.apply(y.colHeaders,le)}L.shiftColumns(s.toVisualColumn(Q),$)}break;case"remove_row":const ie=le=>{let de=0;j(le,Ae=>{let[pe,ke]=Ae;const Et=yo(pe)?s.countRows()-1:Math.max(pe-de,0);if(Number.isInteger(pe)&&(pe=Math.max(pe-de,0)),!l.removeRow(pe,ke,R))return;if(L.isSelected()){const{row:yt}=s.getSelectedRangeActive().highlight;yt>=pe&&yt<=pe+ke-1&&h.closeEditor(!0)}const cr=s.countRows(),Ln=y.fixedRowsTop;Ln>=Et+1&&(y.fixedRowsTop-=Math.min(ke,Ln-Et));const At=y.fixedRowsBottom;if(At&&Et>=cr-At&&(y.fixedRowsBottom-=Math.min(ke,At)),cr===0)L.deselect();else if(R==="ContextMenu.removeRow"){const yt=L.getSelectedRange(),hr=yt.pop();yt.clear().set(hr.from).current().setTo(hr.to),L.refresh()}else L.shiftRows(pe,-ke);de+=ke})};Array.isArray(m)?ie(O(m)):ie([[m,p]]);break;case"remove_col":const be=le=>{let de=0;j(le,Ae=>{let[pe,ke]=Ae;const Et=yo(pe)?s.countCols()-1:Math.max(pe-de,0);let Ht=s.toPhysicalColumn(Et);if(Number.isInteger(pe)&&(pe=Math.max(pe-de,0)),!l.removeCol(pe,ke,R))return;if(L.isSelected()){const{col:yt}=s.getSelectedRangeActive().highlight;yt>=pe&&yt<=pe+ke-1&&h.closeEditor(!0)}if(s.countCols()===0)L.deselect();else if(R==="ContextMenu.removeColumn"){const yt=L.getSelectedRange(),hr=yt.pop();yt.clear().set(hr.from).current().setTo(hr.to),L.refresh()}else L.shiftColumns(pe,-ke);const At=y.fixedColumnsStart;At>=Et+1&&(y.fixedColumnsStart-=Math.min(ke,At-Et)),Array.isArray(y.colHeaders)&&(typeof Ht>"u"&&(Ht=-1),y.colHeaders.splice(Ht,ke)),de+=ke})};Array.isArray(m)?be(O(m)):be([[m,p]]);break;default:throw new Error(`There is no such action "${f}"`)}_||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,p=y.minCols,R=y.minSpareCols;if(f){const _=s.countRows();_<f&&l.createRow(_,f-_,{source:"auto"})}if(m){const _=s.countEmptyRows(!0);if(_<m){const O=m-_,H=Math.min(O,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),H,{source:"auto"})}}{let _;(p||R)&&(_=s.countEmptyCols(!0));let O=s.countCols();if(p&&!y.columns&&O<p){const H=p-O;_+=H,l.createCol(O,H,{source:"auto"})}if(R&&!y.columns&&s.dataType==="array"&&_<R){O=s.countCols();const H=R-_,k=Math.min(H,y.maxCols-O);l.createCol(O,k,{source:"auto"})}}},populateFromArray(f,m,p,R,_){let O,H,k,U;const B=[],M={},$=[],Q=f.row,ie=f.col;if(H=m.length,H===0)return!1;let be=0,le=0;switch(nt(p)&&(be=p.col-ie+1,le=p.row-Q+1),_){case"shift_down":const Ae=Df(m),pe=Ae.length,ke=Math.max(pe,be),Et=s.getData().slice(Q),Ht=Df(Et).slice(ie,ie+ke);for(k=0;k<ke;k+=1)if(k<pe){for(O=0,H=Ae[k].length;O<le-H;O+=1)Ae[k].push(Ae[k][O%H]);k<Ht.length?$.push(Ae[k].concat(Ht[k])):$.push(Ae[k].concat(new Array(Et.length).fill(null)))}else $.push(Ae[k%pe].concat(Ht[k]));s.populateFromArray(Q,ie,Df($));break;case"shift_right":const cr=m.length,Ln=Math.max(cr,le),At=s.getData().slice(Q).map(dr=>dr.slice(ie));for(O=0;O<Ln;O+=1)if(O<cr){for(k=0,U=m[O].length;k<be-U;k+=1)m[O].push(m[O][k%U]);if(O<At.length)for(let dr=0;dr<At[O].length;dr+=1)m[O].push(At[O][dr]);else m[O].push(...new Array(At[0].length).fill(null))}else m.push(m[O%H].slice(0,Ln).concat(At[O]));s.populateFromArray(Q,ie,m);break;case"overwrite":default:M.row=f.row,M.col=f.col;let yt=0,hr=0,ui=!0,Gr;const $i=function(ci){let hi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const mn=m[ci%m.length];return hi!==null?mn[hi%mn.length]:mn},_r=m.length,gn=p?p.row-f.row+1:0;for(p?H=gn:H=Math.max(_r,gn),O=0;O<H&&!(p&&M.row>p.row&&gn>_r||!y.allowInsertRow&&M.row>s.countRows()-1||M.row>=y.maxRows);O++){const dr=O-yt,ci=$i(dr).length,hi=p?p.col-f.col+1:0;if(p?U=hi:U=Math.max(ci,hi),M.col=f.col,Gr=s.getCellMeta(M.row,M.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Gr.skipRowOnPaste){yt+=1,M.row+=1,H+=1;continue}for(hr=0,k=0;k<U;k++){var de;if(p&&M.col>p.col&&hi>ci||!y.allowInsertColumn&&M.col>s.countCols()-1||M.col>=y.maxCols)break;if(Gr=s.getCellMeta(M.row,M.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Gr.skipColumnOnPaste){hr+=1,M.col+=1,U+=1;continue}if(Gr.readOnly&&R!=="UndoRedo.undo"){M.col+=1;continue}const mn=k-hr,di=!!Gr.valueSetter;let Or=$i(dr,mn),bt=(de=s.getSourceDataAtCell(M.row,M.col))!==null&&de!==void 0?de:null;if(Or!==null&&typeof Or=="object"){if(Array.isArray(Or)&&bt===null&&(bt=[]),!di&&(typeof bt!="object"||bt===null))ui=!1;else if(bt!==null){const vl=Ga(Array.isArray(bt)?bt:bt[0]||bt),yl=Ga(Array.isArray(Or)?Or:Or[0]||Or);di||V_(vl,yl)||Array.isArray(vl)&&Array.isArray(yl)?Or=Sr(Or):ui=!1}}else!di&&bt!==null&&typeof bt=="object"&&(ui=!1);ui&&B.push([M.row,M.col,Or]),ui=!0,M.col+=1}M.row+=1}s.setDataAtCell(B,null,null,R||"populateFromArray");break}}};function K(f){const m=$0(f);fw(m)?(s.runHooks("beforeLanguageChange",m),I.language=m,s.runHooks("afterLanguageChange",m)):j0(f)}function te(f,m){const p=f==="className"?s.rootElement:s.table;if(w)X(p,m);else{let R=[],_=[];I[f]&&(R=Array.isArray(I[f])?I[f]:VC(I[f])),m&&(_=Array.isArray(m)?m:VC(m));const O=FC(R,_),H=FC(_,R);O.length&&xe(p,O),H.length&&X(p,H)}I[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(Ii()||B_())&&X(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new KV(this),h=am.getInstance(s,y,L),g=hj(s),d=new Sk(s),io(this)&&(nj(s),_j(s.rootPortalElement),QD(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),w&&s.rootElement.offsetParent===null&&WN(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof w=="object"&&(s.runHooks("afterChange",w[0],w[1]),w=!1),s.runHooks("afterInit")};function dt(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Re(f,m,p){if(!f.length){p();return}const R=s.getActiveEditor(),_=new dt;let O=!0;_.onQueueEmpty=()=>{R&&O&&R.cancelChanges(),p()};for(let H=f.length-1;H>=0;H--){const[k,U,,B]=f[H],M=l.propToCol(U);let $;Number.isInteger(M)?$=s.getCellMeta(k,M):$={...Object.getPrototypeOf(y),...y},s.getCellValidator($)&&(_.addValidatorToQueue(),s.validateCell(B,$,function(Q,ie){return function(be){if(typeof be!="boolean")throw new Error("Validation error: result is not boolean");be===!1&&ie.allowInvalid===!1&&(O=!1,f.splice(Q,1),ie.valid=!0),_.removeValidatorFormQueue()}}(H,$),m))}_.checkIfQueueIsEmpty()}function Ee(f,m){for(let R=f.length-1;R>=0;R--){let _=!1;if(f[R]===null){f.splice(R,1);continue}if(!((f[R][2]===null||f[R][2]===void 0)&&(f[R][3]===null||f[R][3]===void 0))){if(y.allowInsertRow)for(;f[R][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[R][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}_||l.set(f[R][0],f[R][1],f[R][3])}}if(f.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",f,m||"edit");const R=s.getActiveEditor();R&&he(R.refreshValue)&&R.refreshValue()}else s.render()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,p){return s.view._wt.createCellRange(f,m,p)},this.validateCell=function(f,m,p,R){let _=s.getCellValidator(m);function O(H){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(H);return}const U=m.visualCol,B=m.visualRow,M=s.getCell(B,U,!0);if(M&&M.nodeName!=="TH"){const $=s.rowIndexMapper.getRenderableFromVisualIndex(B),Q=s.columnIndexMapper.getRenderableFromVisualIndex(U);s.view._wt.getSetting("cellRenderer",$,Q,M)}p(H)}XD(_)&&(_=function(H){return function(k,U){U(H.test(k))}}(_)),Oe(_)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,R),s._registerImmediate(()=>{_.call(m,f,H=>{s&&(H=s.runHooks("afterValidate",H,f,m.visualRow,m.prop,R),m.valid=H,O(H),s.runHooks("postAfterValidate",H,f,m.visualRow,m.prop,R))})})):s._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function Ye(f,m,p){return Array.isArray(f)?f:[[f,m,p]]}function Be(f,m){const p=s.runHooks("beforeChange",f,m||"edit"),R=f.filter(O=>O!==null);if(p===!1||R.length===0){var _;return(_=s.getActiveEditor())===null||_===void 0||_.cancelChanges(),[]}for(let O=R.length-1;O>=0;O--){const[H,k,,U]=R[O],B=l.propToCol(k);let M;Number.isInteger(B)?M=s.getCellMeta(H,B):M={...Object.getPrototypeOf(y),...y},R[O][3]=vg(U,M)}return R}this.setDataAtCell=function(f,m,p,R){const _=Ye(f,m,p),O=[];let H=R,k,U,B;for(k=0,U=_.length;k<U;k++){const[$,Q,ie]=_[k];if(typeof _[k]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Q!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Q>=this.countCols()?B=Q:B=l.colToProp(Q),O.push([$,B,u.getAtCell(this.toPhysicalRow($),Q),ie])}!H&&typeof f=="object"&&(H=m);const M=Be(O,H);s.runHooks("afterSetDataAtCell",M,H),Re(M,H,()=>{Ee(M,H)})},this.setDataAtRowProp=function(f,m,p,R){const _=Ye(f,m,p),O=[];let H=R,k,U;for(k=0,U=_.length;k<U;k++){const[M,$,Q]=_[k];O.push([M,$,u.getAtCell(this.toPhysicalRow(M),$),Q])}!H&&typeof f=="object"&&(H=m);const B=Be(O,R);s.runHooks("afterSetDataAtRowProp",B,H),Re(B,H,()=>{Ee(B,H)})},this.listen=function(){s&&!s.isListening()&&(Rg.forEach(f=>{s!==f&&f.unlisten()}),Sg=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Sg=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Sg===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(f),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this.populateFromArray=function(f,m,p,R,_,O,H){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const k=typeof R=="number"?s._createCellCoords(R,_):null;return c.populateFromArray(s._createCellCoords(f,m),p,k,O,H)},this.spliceCol=function(f,m,p){for(var R=arguments.length,_=new Array(R>3?R-3:0),O=3;O<R;O++)_[O-3]=arguments[O];return l.spliceCol(f,m,p,..._)},this.spliceRow=function(f,m,p){for(var R=arguments.length,_=new Array(R>3?R-3:0),O=3;O<R;O++)_[O-3]=arguments[O];return l.spliceRow(f,m,p,..._)},this.getSelected=function(){if(L.isSelected())return xn(L.getSelectedRange(),f=>{let{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedActive=function(){const f=this.getSelectedRangeActive();if(!f)return;const{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRangeActive=function(){return L.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return L.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(f){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];j(L.getSelectedRange(),p=>{if(p.isSingleHeader())return;const R=p.getTopStartCorner(),_=p.getBottomEndCorner();Ge(R.row,_.row,O=>{Ge(R.col,_.col,H=>{this.getCellMeta(O,H).readOnly||m.push([O,H,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=f();return this.resumeExecution(m),p},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const f=s.view,{width:m,height:p}=f.getLastSize(),{width:R,height:_}=s.rootElement.getBoundingClientRect(),O=R!==m||_!==p;s.runHooks("beforeRefreshDimensions",{width:m,height:p},{width:R,height:_},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===s.rootWindow)&&(f.setLastSize(R,_),f.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:m,height:p},{width:R,height:_},O))},this.updateData=function(f,m){NR(f,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),L.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:E,firstRun:w})},this.loadData=function(f,m){NR(f,p=>{l=p},()=>{E.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),L.refresh(),w&&(w=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:E,firstRun:w})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Oe(f))if(s.dataType==="array"){const p=this.countSourceCols();for(let R=0;R<p;R+=1)f(R)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(he(y.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:wp(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,p,R){return $t(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(p,R),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,p,R){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(p,R))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getCopyableSourceData=function(f,m){return u.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(w?s.loadData:s.updateData).bind(this);let R=!1,_,O;if(he(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(he(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(he(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(_ in f)if(!(_==="data"||_==="language"))if(_==="className")te("className",f.className);else if(_==="tableClassName"&&s.table)te("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(fe.getSingleton().isRegistered(_)||fe.getSingleton().isDeprecated(_)){const M=f[_];Oe(M)?(fe.getSingleton().addAsFixed(_,M,s),y[_]=M):Array.isArray(M)&&(fe.getSingleton().add(_,M,s),y[_]=M)}else!m&&Wr(f,_)&&(I[_]=f[_]);if(m)s.useTheme(y.themeName||BR(s.rootContainer));else{const M=s.getCurrentThemeName();Wr(f,"themeName")&&M!==f.themeName&&s.useTheme(f.themeName)}tu.has(s)&&s.stylesHandler.getThemeName()!==void 0&&tu.delete(s),io(s)&&!tu.has(s)&&s.stylesHandler.isClassicTheme()&&(qN("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),tu.add(s)),f.data===void 0&&y.data===void 0?p(null,"updateSettings"):f.data!==void 0?p(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!w&&f.language&&K(f.language);const H=s.countCols(),k=y.columns;if(k&&Oe(k)&&(R=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&E.clearCache(),H>0)for(_=0,O=0;_<H;_++){if(k){const M=R?k(_):k[O];M&&E.updateColumnMeta(O,M)}O+=1}he(f.cell)&&He(f.cell,M=>{s.setCellMetaObject(M.row,M.col,M)}),s.runHooks("afterCellMetaReset");let U=s.rootElement.style.height;U!==""&&(U=parseInt(s.rootElement.style.height,10)),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let B=f.height;if(typeof f.height<"u")if(Oe(B)&&(B=B()),B=s.runHooks("beforeHeightChange",B),B===null){const M=s.rootElement.getAttribute("data-initialstyle");M&&(M.indexOf("height")>-1||M.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",M):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else B!==void 0&&(s.rootElement.style.height=isNaN(B)?`${B}`:`${B}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let M=f.width;Oe(M)&&(M=M()),M=s.runHooks("beforeWidthChange",M),s.rootElement.style.width=isNaN(M)?`${M}`:`${M}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!w&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(U===""||B===""||B===void 0)&&U!==B&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedRangeActive();if(y.getValue){if(Oe(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f.highlight.row][y.getValue]}else if(f)return s.getDataAtCell(f.highlight.row,f.highlight.col);return null},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,p,R,_){c.alter(f,m,p,R,_)},this.getCell=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=m,_=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;R=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return _===null||R===null||_===void 0||R===void 0?null:s.view.getCellAtCoords(s._createCellCoords(_,R),p)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:p,col:R}=m;let _=p,O=R;return p>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(p)),R>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(R)),s._createCellCoords(_,O)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],p=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let R=0;R<p.length;R+=1)for(let _=0;_<p[R].length;_+=1)m.push(p[R][_]);return m},this.getDataAtProp=function(f){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let R=0;R<p.length;R+=1)for(let _=0;_<p[R].length;_+=1)m.push(p[R][_]);return m},this.getSourceData=function(f,m,p,R){let _;return f===void 0?_=u.getData():_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,R)),_},this.getSourceDataArray=function(f,m,p,R){let _;return f===void 0?_=u.getData(!0):_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,R),!0),_},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,p,R){const _=Ye(f,m,p),O=this.hasHook("afterSetSourceDataAtCell"),H=[],k=(B,M)=>{const $=this.toVisualRow(B),Q=this.toVisualColumn(M);return Number.isInteger(Q)?this.getCellMeta($,Q):{...Object.getPrototypeOf(y),...y}};O&&j(_,B=>{let[M,$,Q]=B;const ie=vg(Q,k(M,$));H.push([M,$,u.getAtCell(M,$),ie])}),j(_,B=>{let[M,$,Q]=B;const ie=vg(Q,k(M,$));u.setAtCell(M,$,ie)}),O&&this.runHooks("afterSetSourceDataAtCell",H,R),this.render();const U=s.getActiveEditor();U&&he(U.refreshValue)&&U.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,p,R){const _=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,p,R],[O,H]=_;let[,,k,U]=_,B=null,M=null;k===void 0&&(k=O),U===void 0&&(U=H);let $="mixed";return Ge(Math.max(Math.min(O,k),0),Math.max(O,k),Q=>{let ie=!0;return Ge(Math.max(Math.min(H,U),0),Math.max(H,U),be=>(M=this.getCellMeta(Q,be).type,B?ie=B===M:B=M,ie)),$=ie?M:"mixed",ie}),$},this.removeCellMeta=function(f,m,p){const[R,_]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=E.getCellMetaKeyValue(R,_,p);s.runHooks("beforeRemoveCellMeta",f,m,p,O)!==!1&&(E.removeCellMeta(R,_,p),s.runHooks("afterRemoveCellMeta",f,m,p,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,R=new Array(p>2?p-2:0),_=2;_<p;_++)R[_-2]=arguments[_];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(f),m),R.length>0&&j(R.reverse(),O=>{E.createRow(this.toPhysicalRow(f)),j(O,(H,k)=>this.setCellMetaObject(f,k,H))}),s.render()},this.setCellMetaObject=function(f,m,p){typeof p=="object"&&He(p,(R,_)=>{this.setCellMeta(f,m,_,R)})},this.setCellMeta=function(f,m,p,R){if(s.runHooks("beforeSetCellMeta",f,m,p,R)===!1)return;let O=f,H=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(H=this.toPhysicalColumn(m)),E.setCellMeta(O,H,p,R),s.runHooks("afterSetCellMeta",f,m,p,R)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},R=this.toPhysicalRow(f),_=this.toPhysicalColumn(m);return R===null&&(R=f),_===null&&(_=m),E.getCellMeta(R,_,{visualRow:f,visualColumn:m,...p})},this.getColumnMeta=function(f){return E.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return E.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof p=="string"?MS(p):$t(p)?MS("text"):p},this.getCellEditor=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof p=="string"?dS(p):$t(p)?dS("text"):p},this.getCellValidator=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof p=="string"?Jk(p):p},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,p){const R=new dt;f&&(R.onQueueEmpty=f);let _=s.countRows()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}R.addValidatorToQueue(),s.validateCell(s.getDataAtCell(_,O),s.getCellMeta(_,O),H=>{if(typeof H!="boolean")throw new Error("Validation error: result is not boolean");H===!1&&(R.valid=!1),R.removeValidatorFormQueue()},"validateCells"),O-=1}_-=1}R.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,p=f;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],Ge(s.countRows()-1,R=>{m.push(s.getRowHeader(R))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:Oe(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",f);if(p===void 0){const k=[],U=s.countCols();for(let B=0;B<U;B++)k.push(s.getColHeader(B));return k}let R=y.colHeaders;const _=function(k){const U=[],B=s.countCols();let M=0;for(;M<B;M++)Oe(y.columns)&&y.columns(M)&&U.push(M);return U[k]},O=s.toPhysicalColumn(p),H=_(O);return y.colHeaders===!1?R=null:y.columns&&Oe(y.columns)&&y.columns(H)&&y.columns(H).title?R=y.columns(H).title:y.columns&&y.columns[O]&&y.columns[O].title?R=y.columns[O].title:Array.isArray(y.colHeaders)&&y.colHeaders[O]!==void 0?R=y.colHeaders[O]:Oe(y.colHeaders)?R=y.colHeaders(O):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(R=tW(p)),R=s.runHooks("modifyColumnHeaderValue",R,f,m),R},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let p=s._getColWidthFromSettings(f);return p=s.runHooks("modifyColWidth",p,f,m),p===void 0&&(p=_p),p},this._getRowHeightFromSettings=function(f){const m=s.stylesHandler.getDefaultRowHeight();let p=y.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<m?m:p},this.getRowHeight=function(f,m){let p=s._getRowHeightFromSettings(f);return p=s.runHooks("modifyRowHeight",p,f,m),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return _S(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return _S(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,p,R){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return $t(f)||$t(m)?!1:this.selectCells([[f,m,p,R]],_,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const R=L.selectCells(f);return R&&p&&s.listen(),g.resume(),R},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectColumns(f,m,p)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectRows(f,m,p)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),L.selectAll(f,m,p)};const Ie=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var p;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:R,col:_,considerHiddenIndexes:O}=f??{};let H=R,k=_;if(Oe(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const $=Number.isInteger(R)&&R>=0,Q=Number.isInteger(_)&&_>=0,ie=$?Ie(this.rowIndexMapper,R):void 0,be=Q?Ie(this.columnIndexMapper,_):void 0;if(ie===null||be===null)return!1;H=$?s.rowIndexMapper.getRenderableFromVisualIndex(ie):R,k=Q?s.columnIndexMapper.getRenderableFromVisualIndex(be):_}const U=Number.isInteger(H),B=Number.isInteger(k);let M=!1;return U&&H>=0&&B&&k>=0?M=s.view.scrollViewport(s._createCellCoords(H,k),f.horizontalSnap,f.verticalSnap):U&&H>=0&&(B&&k<0||!B)?M=s.view.scrollViewportVertically(H,f.verticalSnap):B&&k>=0&&(U&&H<0||!U)&&(M=s.view.scrollViewportHorizontally(k,f.horizontalSnap)),Oe(m)&&(M?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),M},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Oe(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeActive(),p=this.scrollViewportTo(m.toObject());return p?this.view.render():Oe(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),p},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,io(this)&&Oj(),this.getShortcutManager().destroy(),P.clear(),E.clearCache(),Rg.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&_s(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),x.getItems().forEach(f=>{let[,m]=f;m.destroy()}),x.clear(),s.runHooks("afterDestroy")},!0),fe.getSingleton().destroy(s),He(s,(f,m,p)=>{Oe(f)?p[m]=fn(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function fn(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return x.getItem(Rc(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m,p){fe.getSingleton().add(f,m,s,p)},this.hasHook=function(f){return fe.getSingleton().has(f,s)||fe.getSingleton().has(f)},this.addHookOnce=function(f,m,p){fe.getSingleton().once(f,m,s,p)},this.removeHook=function(f,m){fe.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,p,R,_,O,H){return fe.getSingleton().run(s,f,m,p,R,_,O,H)},this.getTranslatedPhrase=function(f,m){return lM(y.language,f,m)},this.toHTML=()=>RS(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",RS(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!w;this.stylesHandler.useTheme(f);const p=this.stylesHandler.getThemeName();m||(s.render(),s.scrollViewportTo(0,0),BR(this.rootContainer)&&(xe(this.rootContainer,/ht-theme-.*/g),p&&X(this.rootContainer,p))),this.runHooks("afterSetTheme",p,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=f;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){j(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){j(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return h};const Te=wj({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&Te.releasePressedKeys()}),this.getShortcutManager=function(){return Te},this.getFocusManager=function(){return d},c0().forEach(f=>{const m=Tp(f);x.addItem(f,new m(this))}),ej(s),Te.setActiveContextName("grid"),fe.getSingleton().run(s,"construct")}function GR(t,e,r){t.addEventListener(e,r,!1)}function KR(t,e,r){t.removeEventListener(e,r,!1)}function ru(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Mj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=ru(s).fontSize,o.style.fontFamily=ru(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=ru(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),w=parseInt(((d=ru(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+g+w+1;n.removeChild(o);const C=s.style;C.height=`${r.minHeight}px`,r.minWidth>v?C.width=`${r.minWidth}px`:v>r.maxWidth?C.width=`${r.maxWidth}px`:C.width=`${v}px`;const T=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>T?C.height=`${r.minHeight}px`:r.maxHeight<T?(C.height=`${r.maxHeight}px`,C.overflowY="visible"):C.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(GR(s,"input",a),GR(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){KR(s,"input",a),KR(s,"keydown",l)}}}function XR(t,e){const r=kN(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}X_(e,i)}function Qi(t,e,r){return(e=Ij(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ij(t){var e=Pj(t,"string");return typeof e=="symbol"?e:e+""}function Pj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xj="ht_editor_visible",nu="ht_editor_hidden",ZR="textEditor",Hj="text";class Aj extends vw{static get EDITOR_TYPE(){return Hj}constructor(e){super(e),Qi(this,"eventManager",new Ni(this)),Qi(this,"autoResize",Mj(this.hot.rootDocument)),Qi(this,"TEXTAREA",void 0),Qi(this,"textareaStyle",void 0),Qi(this,"TEXTAREA_PARENT",void 0),Qi(this,"textareaParentStyle",void 0),Qi(this,"layerClass",void 0),this.eventManager=new Ni(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Ru(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==lt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===lt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),X_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Me(this.TEXTAREA,[["data-hot-input",""],No(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,nu),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){ON()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,nu)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ge(e.length-1,n=>{const i=e[n];if(ye(i,"handsontableEditor"))return r=!0,!1}),ye(this.TEXTAREA_PARENT,nu)&&xe(this.TEXTAREA_PARENT,nu),r?(this.layerClass=xj,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==lt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){W_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===lt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===lt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>he(this.hot.getSelected()),group:ZR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;XR(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;XR(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ZR)}}const Dj="base",Nj="htTextEllipsis";function TM(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(zC())):a&&c.push(zC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(UC())):(u.push(s.invalidCellClassName),a&&c.push(UC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(Nj),xe(e,u),X(e,l),dl(e,c),Me(e,h)}TM.RENDERER_TYPE=Dj;const kj="text";function _M(t,e,r,n,i,o,s){TM.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=mp(a),s.trimWhitespace&&(a=a.trim()),fl(e,a)}_M.RENDERER_TYPE=kj;const Lj="text",Fj={CELL_TYPE:Lj,editor:Aj,renderer:_M};OB(Fj);dn.editors={BaseEditor:vw};function dn(t,e){const r=new EM(t,e||{},Bp);return r.init(),r}dn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new EM(t,e,Bp)};dn.DefaultSettings=gM();dn.hooks=fe.getSingleton();dn.CellCoords=bo;dn.CellRange=gl;dn.packageName="handsontable";dn.buildDate="23/09/2025 14:16:56";dn.version="16.1.1";dn.languages={dictionaryKeys:NW,getLanguageDictionary:aM,getLanguagesDictionaries:WW,registerLanguageDictionary:sM,getTranslatedPhrase:lM};function Vj(t,e){OM(t,e),e.add(t)}function Zo(t,e,r){return(e=Wj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wj(t){var e=Bj(t,"string");return typeof e=="symbol"?e:e+""}function Bj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JR(t,e,r){OM(t,e),e.set(t,r)}function OM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iu(t,e,r){return t.set(bw(t,e),r),r}function Ke(t,e){return t.get(bw(t,e))}function bw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const QR=new Map([["plugin",zk],["cell-type",fM],["editor",i0],["renderer",h0],["validator",d0]]),$j=Symbol("mainSetting"),jj="base",ou=[];let eo=null;var tt=new WeakMap,to=new WeakMap,eE=new WeakSet;class kc{static get PLUGIN_KEY(){return jj}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Vj(this,eE),JR(this,tt,null),Zo(this,"eventManager",new Ni(this)),Zo(this,"pluginName",null),Zo(this,"pluginsInitializedCallbacks",[]),Zo(this,"isPluginsReady",!1),Zo(this,"enabled",!1),Zo(this,"initialized",!1),JR(this,to,{}),ai(this,"hot",e,{writable:!1}),eo=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!QR.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);QR.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");ou.push(o)}}if(eo||(eo=c0()),eo.indexOf(this.pluginName)>=0&&eo.splice(eo.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),eo.length===0){if(ou.length>0){const i=[`${ou.join(`
`)}
`,"You have to import and register them manually."].join("");throw ou.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return nt(Ke(tt,this))?Su(Ke(tt,this),r):Ke(tt,this);if((Array.isArray(Ke(tt,this))||nt(Ke(tt,this)))&&r[$j]===e){var n;return Array.isArray(Ke(tt,this))?Ke(tt,this):(n=Ke(tt,this)[e])!==null&&n!==void 0?n:r[e]}if(e.includes(".")){const i=nm(Ke(tt,this),e),o=nm(r,e);return nt(i)?Su(i,o):i!==void 0?i:o}return nt(Ke(tt,this))?Su(Ke(tt,this),r)[e]:r[e]}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){Br(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return iu(tt,this,e),Ke(tt,this)}return r&&typeof r=="object"&&typeof e=="object"?((Ke(tt,this)===null||typeof Ke(tt,this)!="object")&&iu(tt,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){Br(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}Ke(tt,this)[n]=e[n]}),Ke(tt,this)):(iu(tt,this,e),e)}addHook(e,r,n){Ke(to,this)[e]=Ke(to,this)[e]||[];const i=Ke(to,this)[e];this.hot.addHook(e,r,n),i.push(r),Ke(to,this)[e]=i}removeHooks(e){j(Ke(to,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Ke(to,this);He(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){j(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=bw(eE,this,zj).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;iu(tt,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),He(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function zj(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function ro(t,e,r){return(e=Uj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uj(t){var e=Yj(t,"string");return typeof e=="symbol"?e:e+""}function Yj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qj{constructor(e){ro(this,"hot",null),ro(this,"container",null),ro(this,"injected",!1),ro(this,"rows",[]),ro(this,"columns",[]),ro(this,"samples",null),ro(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),j(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),j(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{j(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{j(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{j(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),j(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{j(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function pa(t,e,r){return(e=Gj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gj(t){var e=Kj(t,"string");return typeof e=="symbol"?e:e+""}function Kj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cw{static get SAMPLE_COUNT(){return 3}constructor(e){pa(this,"samples",null),pa(this,"dataFactory",null),pa(this,"customSampleCount",null),pa(this,"allowDuplicates",!1),pa(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Cw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Ge(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ge(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:nt(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${mp(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function Xj(t,e){MM(t,e),e.add(t)}function Eg(t,e,r){MM(t,e),e.set(t,r)}function MM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(t,e,r){return(e=Zj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zj(t){var e=Jj(t,"string");return typeof e=="symbol"?e:e+""}function Jj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pi(t,e){return t.get(rr(t,e))}function Zu(t,e,r){return t.set(rr(t,e),r),r}function rr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}fe.getSingleton().register("modifyAutoColumnSizeSeed");const Tg="autoColumnSize",Qj=10,ez="autoColumnSize";var Sw=new WeakMap,ls=new WeakMap,Ms=new WeakMap,wr=new WeakSet;class Ba extends kc{static get PLUGIN_KEY(){return Tg}static get PLUGIN_PRIORITY(){return Qj}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Xj(this,wr),wa(this,"ghostTable",new qj(this.hot)),wa(this,"samplesGenerator",new Cw((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),wa(this,"inProgress",!1),wa(this,"measuredColumns",0),wa(this,"columnWidthsMap",new Pc),Eg(this,Sw,!1),Eg(this,ls,[]),Eg(this,Ms,[]),this.hot.columnIndexMapper.registerMap(ez,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>rr(wr,this,tE).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[Tg]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return rr(wr,e,nz).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return rr(wr,e,iz).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return rr(wr,e,sz).call(e,...i)}),this.addHook("beforeRender",()=>rr(wr,this,rz).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>rr(wr,this,oz).call(this)),super.enablePlugin()}updatePlugin(){Zu(Ms,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>rr(wr,this,tE).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Ge(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&rr(wr,this,IM).call(this,s,o)}),this.ghostTable.columns.length&&(rr(wr,this,PM).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){KC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ba.CALCULATION_STEP,i)},e,r),n=n+Ba.CALCULATION_STEP+1,n<i?o=im(s):(KC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Tg];let r=Ba.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return nt(e)&&(r=e.syncLimit,rN(r)?r=Dk(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,_p))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=Pi(ls,this).length;return(s-1<o||Pi(ls,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?Pi(ls,this).push(i):Pi(ls,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tz(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||rr(wr,this,IM).call(this,r,e))}),this.ghostTable.columns.length&&(rr(wr,this,PM).call(this),this.ghostTable.clean())}function IM(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function PM(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function rz(){this.calculateVisibleColumnsWidth(),this.inProgress||(rr(wr,this,tz).call(this,Pi(Ms,this)),Zu(Ms,this,[]))}function nz(t,e){e||this.recalculateAllColumnsWidth()}function iz(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);Pi(Ms,this).push(...e)}function tE(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function oz(){Zu(ls,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Zu(Sw,this,!0)}function sz(t){if(!Pi(Sw,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);Pi(Ms,this).push(...e)}function az(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function lz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function no(t,e){const r={};return j(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function Ri(t,e,r,n,i){j(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&uz(s,a,e,r,n,i)})})}function uz(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=az(s.className,n):a=lz(s.className,n)),o(t,e,"className",a)}function cz(t){return`<span class="selected">â</span>${t}`}function _g(t,e){let r=!1;return Array.isArray(t)&&j(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function xM(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const Rt="---------";function hz(){return{name:Rt}}const rn="alignment";function dz(){return{key:rn,name(){return this.getTranslatedPhrase(iw)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${rn}:left`,name(){return this.getTranslatedPhrase(ow)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${rn}:center`,name(){return this.getTranslatedPhrase(sw)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${rn}:right`,name(){return this.getTranslatedPhrase(aw)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${rn}:justify`,name(){return this.getTranslatedPhrase(lw)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Rt},{key:`${rn}:top`,name(){return this.getTranslatedPhrase(uw)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${rn}:middle`,name(){return this.getTranslatedPhrase(cw)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${rn}:bottom`,name(){return this.getTranslatedPhrase(hw)},callback(){const t=this.getSelectedRange(),e=no(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Ri(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Rw="clear_column";function fz(){return{key:Rw,name(){return this.getTranslatedPhrase(Jp)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const Lc="col_left";function gz(){return{key:Lc,name(){return this.getTranslatedPhrase(Yp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Fc="col_right";function mz(){return{key:Fc,name(){return this.getTranslatedPhrase(qp)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Vc="make_read_only";function pz(){return{key:Vc,checkable:!0,ariaChecked(){return _g(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(qu)},name(){let t=this.getTranslatedPhrase(qu);return _g(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=cz(t)),t},callback(){const t=this.getSelectedRange(),e=_g(t,(r,n)=>this.getCellMeta(r,n).readOnly);j(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Wc="redo";function wz(){return{key:Wc,name(){return this.getTranslatedPhrase(Zp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Bc="remove_col";function vz(){return{key:Bc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Kp,e)},callback(){this.alter("remove_col",gB(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const $c="remove_row";function yz(){return{key:$c,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Gp,e)},callback(){this.alter("remove_row",mB(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const jc="row_above";function bz(){return{key:jc,name(){return this.getTranslatedPhrase(zp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const zc="row_below";function Cz(){return{key:zc,name(){return this.getTranslatedPhrase(Up)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ja="no_items";function Sz(){return{key:Ja,name(){return this.getTranslatedPhrase(jp)},disabled:!0,isCommand:!1}}const Uc="undo";function Rz(){return{key:Uc,name(){return this.getTranslatedPhrase(Xp)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Ez=[jc,zc,Lc,Fc,Rw,$c,Bc,Uc,Wc,Vc,rn,Rt,Ja],Tz={[Rt]:hz,[Ja]:Sz,[jc]:bz,[zc]:Cz,[Lc]:gz,[Fc]:mz,[Rw]:fz,[$c]:yz,[Bc]:vz,[Uc]:Rz,[Wc]:wz,[Vc]:pz,[rn]:dz};function HM(){const t={};return He(Tz,(e,r)=>{t[r]=e()}),t}function Og(t,e,r){return(e=_z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _z(t){var e=Oz(t,"string");return typeof e=="symbol"?e:e+""}function Oz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mz{constructor(e){Og(this,"hot",void 0),Og(this,"commands",{}),Og(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Iz(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Wr(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),j(u,c=>c.apply(this.hot,n))}}function Iz(t,e){let r;return j(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function Mg(t,e,r){return(e=Pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pz(t){var e=xz(t,"string");return typeof e=="symbol"?e:e+""}function xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hz{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Mg(this,"hot",void 0),Mg(this,"predefinedItems",HM()),Mg(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,He(e,(n,i)=>{let o="";n.name===Rt?(r[Rt]=n,o=Rt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Az(e,this.defaultOrderPattern,this.predefinedItems)}}function Az(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),nt(i)?He(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),nt(o)?Di(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):j(i,(o,s)=>{let a=r[o];!a&&Ez.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),nt(o)&&Di(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function vi(t,e,r){return(e=Dz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dz(t){var e=Nz(t,"string");return typeof e=="symbol"?e:e+""}function Nz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kz{constructor(e,r){vi(this,"top",void 0),vi(this,"topRelative",void 0),vi(this,"left",void 0),vi(this,"leftRelative",void 0),vi(this,"scrollTop",void 0),vi(this,"scrollLeft",void 0),vi(this,"cellHeight",void 0),vi(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function va(t,e,r){Lz(t,e),e.set(t,r)}function Lz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ne(t,e){return t.get(AM(t,e))}function su(t,e,r){return t.set(AM(t,e),r),r}function AM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Lt=new WeakMap,Zt=new WeakMap,Jt=new WeakMap,Ig=new WeakMap,Jo=new WeakMap;class Fz{constructor(e){va(this,Lt,void 0),va(this,Zt,void 0),va(this,Jt,void 0),va(this,Ig,!1),va(this,Jo,{above:0,below:0,left:0,right:0}),su(Ig,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ne(Jo,this)[e]=r,this}setElement(e){return su(Lt,this,e),this}setParentElement(e){return su(Zt,this,e),this}updatePosition(e){su(Jt,this,new kz(e,ne(Lt,this).ownerDocument.defaultView)),ne(Ig,this)?(ne(Jt,this).fitsBelow(ne(Lt,this))?this.setPositionBelowCursor():ne(Jt,this).fitsAbove(ne(Lt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ne(Lt,this).dir==="rtl"?ne(Jt,this).fitsOnLeft(ne(Lt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ne(Jt,this).fitsOnRight(ne(Lt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ne(Jo,this).above+ne(Jt,this).top-ne(Lt,this).offsetHeight;if(ne(Zt,this)){const n=ne(Zt,this).ownerDocument.defaultView.getComputedStyle(ne(Zt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(Jt,this).top+ne(Jt,this).cellHeight-ne(Lt,this).scrollHeight+i+o}ne(Lt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ne(Jo,this).below+ne(Jt,this).top+1;if(ne(Zt,this)){const n=ne(Zt,this).ownerDocument.defaultView.getComputedStyle(ne(Zt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ne(Jt,this).top-i-o}ne(Lt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ne(Jt,this).left;if(ne(Zt,this)){const r=ne(Zt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Zt,this).querySelector(".htCore")).borderRightWidth,10);e+=ne(Jt,this).cellWidth+n}else e+=ne(Jo,this).right;ne(Lt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ne(Jo,this).left+ne(Jt,this).left-ne(Lt,this).offsetWidth;if(ne(Zt,this)){const r=ne(Zt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ne(Zt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ne(Lt,this).style.left=`${e}px`}}function Vz(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=De(e,-1,v()-1);function a(T,b){const E=v()-1;return T<0&&(T=E),T>E&&(T=0),o.has(T)?-1:(o.add(T),n(T,!1)===!1&&(T=a(b===1?++T:--T,b)),T)}function l(T){T>-1&&T<v()&&n(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<v()&&(s=T)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function g(){v()>0&&(o.clear(),s=a(++s,1))}function w(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(r(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:w,getSize:v,clear:C}}function Wz(t){return xn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function vm(t){return Wr(t,"submenu")}function ym(t){return new RegExp(Rt,"i").test(t.name)}function Iu(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function rE(t){return Wr(t,"disableSelection")}function Bz(t){return ye(t,"htSeparator")}function $z(t){return ye(t,"htSubmenu")}function jz(t){return ye(t,"htDisabled")}function zz(t){return ye(t,"htSelectionDisabled")}function Uz(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function DM(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function Yz(t,e){let r=t.slice(0);return r.reverse(),r=DM(r,e),r.reverse(),r}function qz(t){const e=[];return j(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function Gz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rt,r=t.slice(0);return r=DM(r,e),r=Yz(r,e),r=qz(r),r}function Kz(t){return t.checkable===!0}function Xz(t){return Vz({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||Bz(n)||jz(n)||zz(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Zz(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const NM="menu",nE=NM;function Jz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Zz(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:NM})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(w=>h.removeShortcutsByKeys(w))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${nE}:${u}`:nE}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Qz(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(_s(r),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Iu(a,t)&&!rE(a)&&!ym(a);Me(r,[...Kz(a)?[cN(),Wu(c),pN(h)]:[uN(),Wu(u)],...d?[No(-1)]:[],...Iu(a,t)?[gN()]:[],...vm(a)?[Cu(!1)]:[]])}r.className="",r.appendChild(l),ym(a)?X(r,"htSeparator"):typeof a.renderer=="function"?(X(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):Y_(l,u),Iu(a,t)?X(r,"htDisabled"):rE(a)?X(r,"htSelectionDisabled"):vm(a)&&X(r,"htSubmenu")}}function Pg(t,e,r){eU(t,e),e.set(t,r)}function eU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sn(t,e,r){return(e=tU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tU(t){var e=rU(t,"string");return typeof e=="symbol"?e:e+""}function rU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xg(t,e,r){return t.set(kM(t,e),r),r}function yi(t,e){return t.get(kM(t,e))}function kM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const iE=215;var Qo=new WeakMap,au=new WeakMap,lu=new WeakMap;class Yc{get tableBorderWidth(){return yi(lu,this)===void 0&&this.hotMenu&&xg(lu,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),yi(lu,this)}constructor(e,r){var n=this;Sn(this,"hot",void 0),Sn(this,"options",void 0),Sn(this,"eventManager",new Ni(this)),Sn(this,"container",void 0),Sn(this,"positioner",void 0),Sn(this,"hotMenu",null),Sn(this,"hotSubMenus",{}),Sn(this,"parentMenu",void 0),Sn(this,"menuItems",null),Sn(this,"origOutsideClickDeselects",null),Pg(this,Qo,void 0),Pg(this,au,void 0),Pg(this,lu,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:iE,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Fz(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(xe(this.options.container,/ht-theme-.*/g),X(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Ka(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return yi(Qo,this)}getKeyboardShortcutsCtrl(){return yi(au,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=e0(a=>this.openSubMenu(a),300),r=this.options.minWidth||iE;let n=!1,i=gp(this.menuItems,a=>(a.key===Ja&&(n=!0),Uz(a,this.hot)));if(i.length<1&&!n)i.push(HM()[Ja]);else if(i.length===0)return;i=Gz(i,Rt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return he(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Qz(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?yi(Qo,this).setCurrentPage(l.row):yi(Qo,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),XC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!XC()||!ju(a))&&o&&this.hasSelectedItem()&&(Ii()||B_()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),xg(Qo,this,Xz(this.hotMenu)),xg(au,this,Jz(this)),yi(au,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(yi(Qo,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Me(n,[Cu(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!$z(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Yc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Me(r,[Cu(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Me(i,[Cu(!1)])}}closeAllSubMenus(){j(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?Wz(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||ym(e)||Iu(e,this.hot)||vm(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=Do(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?lr(this.hotMenu.getCell(u,0)):0;return a+(l.name===Rt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Oe(n)&&(n=n.call(this.hot),n===null||$t(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),n&&X(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Me(this.hotMenu.rootElement,[lN(),No(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!vs(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!vs(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&vs(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Je(Yc,Nn);function nU(t,e){iU(t,e),e.add(t)}function iU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hg(t,e,r){return(e=oU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oU(t){var e=sU(t,"string");return typeof e=="symbol"?e:e+""}function sU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Pa="contextMenu",aU=70,oE=Pa;fe.getSingleton().register("afterContextMenuDefaultOptions");fe.getSingleton().register("beforeContextMenuShow");fe.getSingleton().register("afterContextMenuShow");fe.getSingleton().register("afterContextMenuHide");fe.getSingleton().register("afterContextMenuExecute");var ya=new WeakSet;class qc extends kc{constructor(){super(...arguments),nU(this,ya),Hg(this,"commandExecutor",new Mz(this.hot)),Hg(this,"itemsFactory",null),Hg(this,"menu",null)}static get PLUGIN_KEY(){return Pa}static get PLUGIN_PRIORITY(){return aU}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[jc,zc,Rt,Lc,Fc,Rt,$c,Bc,Rt,Uc,Wc,Rt,Vc,Rt,rn]}isEnabled(){return!!this.hot.getSettings()[Pa]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Pa];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Yc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>uu(ya,this,uU).call(this)),this.menu.addLocalHook("afterOpen",()=>uu(ya,this,cU).call(this)),this.menu.addLocalHook("afterClose",()=>uu(ya,this,hU).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>uu(ya,this,lU).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=xM(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:oE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oE)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),He(n,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new Hz(this.hot,qc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Pa],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),j(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lU(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ye(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(ye(o,"current")&&ye(o,"wtBorder"))))return;const s=xM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function uU(){this.hot.runHooks("beforeContextMenuShow",this)}function cU(){this.hot.runHooks("afterContextMenuShow",this)}function hU(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}qc.SEPARATOR={name:Rt};function dU(t){return{key:"copy",name(){return this.getTranslatedPhrase(Qp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function fU(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(rw,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function gU(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tw,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function mU(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ew,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function pU(t){return{key:"cut",name(){return this.getTranslatedPhrase(nw)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class wU{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class vU{constructor(){this.clipboardData=new wU}preventDefault(){}composedPath(){return[]}}function yU(t,e){LM(t,e),e.add(t)}function es(t,e,r){LM(t,e),e.set(t,r)}function LM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(fs(t,e))}function ts(t,e,r){return t.set(fs(t,e),r),r}function fs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bi=new WeakMap,Ag=new WeakMap,ba=new WeakMap,bm=new WeakMap,Cm=new WeakMap,Ca=new WeakMap,Sa=new WeakSet;class bU{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;yU(this,Sa),es(this,bi,void 0),es(this,Ag,void 0),es(this,ba,void 0),es(this,bm,void 0),es(this,Cm,void 0),es(this,Ca,void 0),ts(Ag,this,r),ts(ba,this,n),ts(bm,this,i),ts(Cm,this,o),ts(Ca,this,s)}setSelectedRange(e){ts(bi,this,e)}getCellsRange(){if(Ft(Ag,this).call(this)===0||Ft(ba,this).call(this)===0)return null;const{row:e,col:r}=Ft(bi,this).getTopStartCorner(),{row:n,col:i}=Ft(bi,this).getBottomEndCorner(),o=fs(Sa,this,CU).call(this,e,n),s=fs(Sa,this,Dg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Ft(ba,this).call(this)===0||Ft(Ca,this).call(this)===0)return null;const{col:e}=Ft(bi,this).getTopStartCorner(),{col:r}=Ft(bi,this).getBottomEndCorner(),n=fs(Sa,this,Dg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Ft(ba,this).call(this)===0||Ft(Ca,this).call(this)===0)return null;const{col:e}=Ft(bi,this).getTopStartCorner(),{col:r}=Ft(bi,this).getBottomEndCorner(),n=fs(Sa,this,Dg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Ft(Ca,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Dg(t,e){return Math.min(e,Math.max(t+Ft(Cm,this).call(this)-1,t))}function CU(t,e){return Math.min(e,Math.max(t+Ft(bm,this).call(this)-1,t))}function FM(t){const e=[],r=[];return j(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Ge(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Ge(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function SU(t,e){VM(t,e),e.add(t)}function Ci(t,e,r){VM(t,e),e.set(t,r)}function VM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ra(t,e,r){return(e=RU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RU(t){var e=EU(t,"string");return typeof e=="symbol"?e:e+""}function EU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tr(t,e){return t.get(Pt(t,e))}function en(t,e,r){return t.set(Pt(t,e),r),r}function Pt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}fe.getSingleton().register("afterCopyLimit");fe.getSingleton().register("modifyCopyableRange");fe.getSingleton().register("beforeCut");fe.getSingleton().register("afterCut");fe.getSingleton().register("beforePaste");fe.getSingleton().register("afterPaste");fe.getSingleton().register("beforeCopy");fe.getSingleton().register("afterCopy");const Ng="copyPaste",TU=80,_U=["fragmentSelection"],WM="application/ht-source-data-json-html",sE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Sm=new WeakMap,Rm=new WeakMap,Em=new WeakMap,rs=new WeakMap,cu=new WeakMap,hu=new WeakMap,ns=new WeakMap,Ju=new WeakMap,Vt=new WeakSet;class OU extends kc{constructor(){super(...arguments),SU(this,Vt),Ra(this,"columnsLimit",1/0),Ra(this,"rowsLimit",1/0),Ra(this,"pasteMode","overwrite"),Ra(this,"uiContainer",this.hot.rootDocument.body),Ci(this,Sm,!1),Ci(this,Rm,!1),Ci(this,Em,!1),Ci(this,rs,"cells-only"),Ci(this,cu,!1),Ci(this,hu,!1),Ci(this,ns,new bU({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ci(this,Ju,!1),Ra(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ng}static get SETTING_KEYS(){return[Ng,..._U]}static get PLUGIN_PRIORITY(){return TU}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Ng]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),en(Sm,this,this.getSetting("copyColumnHeaders")),en(Rm,this,this.getSetting("copyColumnGroupHeaders")),en(Em,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Pt(Vt,this,PU).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Vt,n,xU).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Pt(Vt,this,HU).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),vp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Vt,n,AU).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Vt,n,DU).call(n,...o)}),this.addHook("afterSelection",()=>Pt(Vt,this,NU).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";en(rs,this,e),en(cu,this,!0),Pt(Vt,this,aE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){en(hu,this,!0),Pt(Vt,this,aE).call(this,"cut")}getRangedCopyableData(e){return Gu(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:o}=FM(e);return j(i,s=>{const a=[];j(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=r?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);r&&nt(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new vU;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}tr(ns,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);tr(rs,this)==="column-headers-only"?r.set("headers",tr(ns,this).getMostBottomColumnHeadersRange()):(tr(rs,this)==="with-column-headers"?r.set("headers",tr(ns,this).getMostBottomColumnHeadersRange()):tr(rs,this)==="with-column-group-headers"&&r.set("headers",tr(ns,this).getAllColumnHeadersRange()),r.set("cells",tr(ns,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner();let h=a,d=l,g=a,w=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:C,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,C===!0)continue;g=T,d=l;const b=[],E=s.length%i;for(;b.length<o||d<=c;){var v;const{skipColumnOnPaste:y,visualCol:I}=this.hot.getCellMeta(T,d),x=this.hot.getSourceDataAtCell(T,d),P=b.length%o;if(d=I+1,y===!0)continue;w=I;const A=r==null||(v=r[E])===null||v===void 0?void 0:v[P];let F=e[E][P];if(r&&tN(A)){const W=JSON.parse(A);(nt(x)||x===null)&&(F=W)}b.push(F)}s.push(b)}return en(Ju,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,w]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!tr(cu,this)||this.isEditorOpened()||wo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ru(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),en(cu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Pt(Vt,this,MU).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Pt(Vt,this,lE).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),en(rs,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!tr(hu,this)||this.isEditorOpened()||wo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ru(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),en(hu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Pt(Vt,this,lE).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||wo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Ru(r,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(WM);h&&(s=TS(h,this.hot.rootDocument).data);const d=H_(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=TS(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=bB(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function aE(t){if(vp()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&BN(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function MU(t){const{rows:e}=FM(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function IU(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&J_(n)}}}function BM(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&Q_(n)}}}function lE(t,e,r){const n=Gu(e);if(t&&t.clipboardData){const i=ES(e),o=ES(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[sE,i].join("")),t.clipboardData.setData(WM,[sE,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function PU(t){t.items.push({name:"---------"},dU(this)),tr(Sm,this)&&t.items.push(mU(this)),tr(Rm,this)&&t.items.push(gU(this)),tr(Em,this)&&t.items.push(fU(this)),t.items.push(pU(this))}function xU(t,e,r,n,i){tr(Ju,this)&&(i.value=!0),en(Ju,this,!1)}function HU(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function AU(){Pt(Vt,this,BM).call(this)}function DU(){Pt(Vt,this,IU).call(this)}function NU(){Pt(Vt,this,BM).call(this)}function kU(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function LU(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function FU(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function $M(t,e,r){const n=LU(t,kU(t,e,r));return FU(n)}function VU(t,e,r){return(e=WU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WU(t){var e=BU(t,"string");return typeof e=="symbol"?e:e+""}function BU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qr{constructor(e){VU(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function du(t,e,r){return(e=$U(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $U(t){var e=jU(t,"string");return typeof e=="symbol"?e:e+""}function jU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ew extends qr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),du(this,"stateBefore",void 0),du(this,"range",void 0),du(this,"type",void 0),du(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new Ew({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){j(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){Ri(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function uE(t,e,r){return(e=zU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zU(t){var e=UU(t,"string");return typeof e=="symbol"?e:e+""}function UU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tw extends qr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),uE(this,"columns",void 0),uE(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new Tw({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),$M(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function cE(t,e,r){return(e=YU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YU(t){var e=qU(t,"string");return typeof e=="symbol"?e:e+""}function qU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _w extends qr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),cE(this,"previousSortState",void 0),cE(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new _w({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function hE(t,e,r){return(e=GU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GU(t){var e=KU(t,"string");return typeof e=="symbol"?e:e+""}function KU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ow extends qr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),hE(this,"index",void 0),hE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new Ow({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function dE(t,e,r){return(e=XU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XU(t){var e=ZU(t,"string");return typeof e=="symbol"?e:e+""}function ZU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mw extends qr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),dE(this,"index",void 0),dE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Mw({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function fu(t,e,r){return(e=JU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JU(t){var e=QU(t,"string");return typeof e=="symbol"?e:e+""}function QU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iw extends qr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),fu(this,"changes",void 0),fu(this,"selected",void 0),fu(this,"countCols",void 0),fu(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new Iw({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=Sr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,r){const n=Sr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.redo")}}function fE(t,e,r){return(e=e2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e2(t){var e=t2(t,"string");return typeof e=="symbol"?e:e+""}function t2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pw extends qr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),fE(this,"conditionsStack",void 0),fE(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new Pw({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function r2(t,e,r){return(e=n2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n2(t){var e=i2(t,"string");return typeof e=="symbol"?e:e+""}function i2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xw extends qr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),r2(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new xw({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function jM(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Ge(n,i,l=>{Ge(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function qn(t,e,r){return(e=o2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o2(t){var e=s2(t,"string");return typeof e=="symbol"?e:e+""}function s2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hw extends qr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),qn(this,"index",void 0),qn(this,"indexes",void 0),qn(this,"data",void 0),qn(this,"amount",void 0),qn(this,"headers",void 0),qn(this,"columnPositions",void 0),qn(this,"rowPositions",void 0),qn(this,"fixedColumnsStart",void 0),qn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return Ge(l.length-1,w=>{const v=[],C=l[w];Ge(u,c,T=>{v.push(C[e.toPhysicalColumn(T)])}),h.push(v)}),Ge(i-1,w=>{g.push(e.toPhysicalColumn(u+w))}),Array.isArray(e.getSettings().colHeaders)&&Ge(i-1,w=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+w)]||null)}),new Hw({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:jM(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(xn(this.data[c],o));const l=xn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),j(e.getSourceDataArray(),(c,h)=>{j(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&j(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function is(t,e,r){return(e=a2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a2(t){var e=l2(t,"string");return typeof e=="symbol"?e:e+""}function l2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aw extends qr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),is(this,"index",void 0),is(this,"data",void 0),is(this,"fixedRowsBottom",void 0),is(this,"fixedRowsTop",void 0),is(this,"rowIndexesSequence",void 0),is(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=Sr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new Aw({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:jM(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function gE(t,e,r){return(e=u2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u2(t){var e=c2(t,"string");return typeof e=="symbol"?e:e+""}function c2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dw extends qr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),gE(this,"rows",void 0),gE(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new Dw({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),$M(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function h2(t,e,r){return(e=d2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d2(t){var e=f2(t,"string");return typeof e=="symbol"?e:e+""}function f2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nw extends qr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),h2(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new Nw({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function g2(t,e){[Ew,Tw,_w,Ow,Mw,Iw,Pw,xw,Hw,Aw,Dw,Nw].forEach(r=>r.startRegisteringEvents(t,e))}function m2(t,e){p2(t,e),e.add(t)}function p2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kg(t,e,r){return(e=w2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w2(t){var e=v2(t,"string");return typeof e=="symbol"?e:e+""}function v2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const mE="undoRedo",y2="undoRedo",b2=1e3;fe.getSingleton().register("beforeUndo");fe.getSingleton().register("afterUndo");fe.getSingleton().register("beforeRedo");fe.getSingleton().register("afterRedo");const pE=new Set;var gu=new WeakSet;class C2 extends kc{static get PLUGIN_KEY(){return y2}static get PLUGIN_PRIORITY(){return b2}static get SETTING_KEYS(){return!0}constructor(e){super(e),m2(this,gu),kg(this,"doneActions",[]),kg(this,"undoneActions",[]),kg(this,"ignoreNewActions",!1),g2(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Lg(gu,e,S2).call(e,...n)}),this.registerShortcuts(),Lg(gu,this,R2).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Lg(gu,this,E2).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:mE};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mE)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=Sr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=Sr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function S2(t,e){e==="loadData"&&this.clear()}function R2(){const t=e=>{pE.has(e)||(Br(ar`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),pE.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function E2(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class T2{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=b=>{if(b=this.postProcess(b,n),i){setTimeout(function(){i(b)},0);return}else return b},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let w=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&w+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let v=-1/0,C=1/0;const T=()=>{for(let b=Math.max(v,-u);b<=Math.min(C,u);b+=2){let E;const y=g[b-1],I=g[b+1];y&&(g[b-1]=void 0);let x=!1;if(I){const A=I.oldPos-b;x=I&&0<=A&&A<a}const P=y&&y.oldPos+1<l;if(!x&&!P){g[b]=void 0;continue}if(!P||x&&y.oldPos<I.oldPos?E=this.addToPath(I,!0,!1,0,n):E=this.addToPath(y,!1,!0,1,n),w=this.extractCommon(E,r,e,b,n),E.oldPos+1>=l&&w+1>=a)return s(this.buildValues(E.lastComponent,r,e))||!0;g[b]=E,E.oldPos+1>=l&&(C=Math.min(C,b-1)),w+1>=a&&(v=Math.max(v,b+1))}u++};if(i)(function b(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);T()||b()},0)})();else for(;u<=c&&Date.now()<=d;){const b=T();if(b)return b}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const w=n[u+g];return w.length>d.length?w:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class _2 extends T2{constructor(){super(...arguments),this.tokenize=M2}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const O2=new _2;function wE(t,e,r){return O2.diff(t,e,r)}function M2(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function I2(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;wE(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(wE(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(b){return b.map(function(E){return" "+E})}const d=[];let g=0,w=0,v=[],C=1,T=1;for(let b=0;b<c.length;b++){const E=c[b],y=E.lines||x2(E.value);if(E.lines=y,E.added||E.removed){if(!g){const I=c[b-1];g=C,w=T,I&&(v=l>0?h(I.lines.slice(-l)):[],g-=v.length,w-=v.length)}for(const I of y)v.push((E.added?"+":"-")+I);E.added?T+=y.length:C+=y.length}else{if(g)if(y.length<=l*2&&b<c.length-2)for(const I of h(y))v.push(I);else{const I=Math.min(y.length,l);for(const P of h(y.slice(0,I)))v.push(P);const x={oldStart:g,oldLines:C-g+I,newStart:w,newLines:T-w+I,lines:v};d.push(x),g=0,w=0,v=[]}C+=y.length,T+=y.length}}for(const b of d)for(let E=0;E<b.lines.length;E++)b.lines[E].endsWith(`
`)?b.lines[E]=b.lines[E].slice(0,-1):(b.lines.splice(E+1,0,"\\ No newline at end of file"),E++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function zM(t){if(Array.isArray(t))return t.map(zM).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function P2(t,e,r,n,i,o,s){{const a=I2(t,e,r,n,i,o);return a?zM(a):void 0}}function x2(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var Tm;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(Tm||(Tm={}));const os=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,Is=Tm;class vE{data;constructor(e){this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class yE{data;constructor(e){this.data=e}run(){return[...new Set(this.data)]}}class _m{data1;data2;ignoreDuplicates;constructor(e,r,n=!0){n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)Is.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return Is.sort(e)}}class H2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)Is.contains(this.data2,r[n])&&e.push(r[n]);return Is.sort(e)}}class bE{data;constructor(e){this.data=Is.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new _m(Is.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class A2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){return P2("Data1","Data2",this.data1,this.data2)}}const D2=async(t,e)=>{oe(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(oe(e).trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var N2=(t,e)=>e("chkDuplicates"),k2=(t,e)=>e("rmDuplicates"),L2=(t,e)=>e("chkConsecutive"),F2=(t,e)=>e("compare"),V2=(t,e)=>e("diff"),W2=eP('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row svelte-1n46o8q"><div id="Table1" class="col-3 svelte-1n46o8q"></div> <div id="Table2" class="col-3 pl-0 svelte-1n46o8q"></div> <div class="col-2 p-0 pt-5 svelte-1n46o8q"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-1n46o8q"><label for="result">Result</label> <textarea class="form-control svelte-1n46o8q" id="result" readonly=""></textarea></div></div></div>',1);function B2(t,e){OE(e,!0);const r=[],n=[];Hl(Ba),Hl(qc),Hl(OU),Hl(C2);const i=64;let o,s,a=nr(""),l=nr("Data1"),u=nr("comm"),c=nr(!0),h=nr(!0),d=nr(!1);const g=(M,$,Q)=>{let ie;try{ie=JSON.parse(localStorage.getItem(Q)||"")}catch{ie=void 0}const be=new dn(document.getElementById(M),{data:ie,colHeaders:[$],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return be.addHook("beforePaste",()=>be.updateSettings({readOnly:!0})),be.addHook("afterPaste",le=>{be.updateSettings({readOnly:!1}),be.deselectCell();for(let de=le.length-1;de>=0;de--)if(le[de][0]!==""){be.loadData(le.slice(0,de+1));return}be.loadData([[""]])}),be};lP(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const w=M=>M.getDataAtCol(0).filter($=>$!==null),v=M=>{const $=w(o).filter(Ae=>Ae!=""),Q=w(s).filter(Ae=>Ae!="");switch(M){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(oe(l)=="Data1"&&!$.length){ze(a,`Data1 is empty.
Please enter something...`);return}else if(oe(l)=="Data2"&&!Q.length){ze(a,`Data2 is empty.
Please enter something...`);return}break;default:if($.length){if(!Q.length){ze(a,`Data2 is empty.
Please enter something...`);return}}else{ze(a,`Data1 is empty.
Please enter something...`);return}}ze(d,!0);const ie=b(),be=new Date().getTime();let le="",de;switch(M){case"chkDuplicates":let Ae;oe(l)=="Data1"?Ae=new vE($).run():Ae=new vE(Q).run(),Object.keys(Ae).length?oe(c)?le=`Duplicate values found in ${oe(l)}.
`+os(Object.keys(Ae).length,Object.keys(Ae).map(pe=>`${pe} appears ${Ae[pe]} times.`)):le=Object.keys(Ae).join(`
`):le=`${oe(l)} has no duplicate value.`;break;case"rmDuplicates":oe(l)=="Data1"?de=new yE($).run():de=new yE(Q).run(),le=de.join(`
`);break;case"chkConsecutive":oe(l)=="Data1"?de=new bE($).run():de=new bE(Q).run(),de.length?de.length==1&&de[0]=="!Error!"?le=`Error!
${oe(l)} contains non-numeric value. Please check!`:le=`${oe(l)} is not consecutive.

The following numbers are missing:
${de.join(`
`)}`:le=`${oe(l)} contains consecutive numbers.`;break;case"compare":if(oe(u)=="comm")de=new H2($,Q).run(),de.length?le=`Common values found between two data.
${os(de.length,de)}`:le="Two data contain no common value.";else{const pe=new _m($,Q,oe(h)).run(),ke=new _m(Q,$,oe(h)).run();pe.length+ke.length==0?le="Data1 is same as Data2.":pe.length?ke.length?le=`Two files have inconsistent content.

Data1 is more than Data2
${os(pe.length,pe)}

Data2 is more than Data1
${os(ke.length,ke)}`:le=`Data1 completely contains Data2.

Data1 is more than Data2
${os(pe.length,pe)}`:le=`Data2 completely contains Data1.

Data2 is more than Data1
${os(ke.length,ke)}`}break;case"diff":le=new A2($.join(`
`)+`
`,Q.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(ie),M=="rmDuplicates"||M=="chkDuplicates"&&!oe(c)?ze(a,le,!0):ze(a,le+`

Duration for process: ${Date.now()-be}ms`),ze(d,!1)},C=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),ze(a,""))},T=()=>{const M=o.getData();o.loadData(s.getData()),s.loadData(M)},b=()=>setInterval(()=>{const M=oe(a).split("Processing");let $=M.length>=2?M[1].length:0;$<3?$++:$-=3,ze(a,"Processing"+".".repeat($))},200);var E=W2();JI("beforeunload",jg,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var y=Ct(AI(E),2),I=Dt(y),x=Ct(Dt(I),4),P=Dt(x);P.__click=[N2,v];var A=Ct(P,2),F=Dt(A),W=Dt(F),q=Ct(A,2);q.__click=[k2,v];var L=Ct(q,2);L.__click=[L2,v];var ae=Ct(L,2),K=Dt(ae),te=Dt(K);te.value=te.__value="Data1";var dt=Ct(K,2),Re=Dt(dt);Re.value=Re.__value="Data2";var Ee=Ct(ae,4);Ee.__click=[F2,v];var Ye=Ct(Ee,2),Be=Dt(Ye),Ie=Dt(Be);Ie.value=Ie.__value="comm";var fn=Ct(Be,2),Te=Dt(fn);Te.value=Te.__value="diff";var f=Ct(Ye,2),m=Dt(f),p=Dt(m),R=Ct(f,4);R.__click=[V2,v];var _=Ct(R,6);_.__click=[D2,a];var O=Ct(_,6);O.__click=T;var H=Dt(O);oP(H,()=>"Data1 <=> Data2");var k=Ct(O,6);k.__click=C;var U=Ct(x,2),B=Ct(Dt(U),2);jE(()=>{P.disabled=oe(d),q.disabled=oe(d),L.disabled=oe(d),Ee.disabled=oe(d),p.disabled=oe(u)=="comm",R.disabled=oe(d),_.disabled=oe(d),O.disabled=oe(d),k.disabled=oe(d)}),nv(W,()=>oe(c),M=>ze(c,M)),Cl(r,[],te,()=>oe(l),M=>ze(l,M)),Cl(r,[],Re,()=>oe(l),M=>ze(l,M)),Cl(n,[],Ie,()=>oe(u),M=>ze(u,M)),Cl(n,[],Te,()=>oe(u),M=>ze(u,M)),nv(p,()=>oe(h),M=>ze(h,M)),sP(B,()=>oe(a),M=>ze(a,M)),tP(t,E),ME()}QI(["click"]);rP(B2,{target:document.body})});export default $2();
