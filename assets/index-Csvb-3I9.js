var zO=Object.defineProperty;var UO=(t,e,r)=>e in t?zO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var YO=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ar=(t,e,r)=>UO(t,typeof e!="symbol"?e+"":e,r);var PU=YO((LU,Kl)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const hw=!1;var PR=Array.isArray,qO=Array.prototype.indexOf,GO=Array.from,KO=Object.defineProperty,sa=Object.getOwnPropertyDescriptor,XO=Object.prototype,ZO=Array.prototype,QO=Object.getPrototypeOf,dw=Object.isExtensible;function JO(t){for(var e=0;e<t.length;e++)t[e]()}const mr=2,xR=4,Cu=8,jg=16,bi=32,os=64,zg=128,fr=256,Xl=512,pr=1024,Yn=2048,io=4096,Zl=8192,Ug=16384,HR=32768,eM=65536,fw=1<<17,tM=1<<18,AR=1<<19,ng=1<<20,DR=1<<21,aa=Symbol("$state"),NR=new class extends Error{constructor(){super(...arguments);ar(this,"name","StaleReactionError");ar(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function kR(t){return t===this.v}function rM(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function nM(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function iM(t){throw new Error("https://svelte.dev/e/effect_orphan")}function oM(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function sM(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function aM(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function lM(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let uM=!1;const cM=2,Nt=Symbol();function hM(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let gr=null;function gw(t){gr=t}function LR(t,e=!1,r){var n=gr={p:gr,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};Gg(()=>{n.d=!0})}function FR(t){const e=gr;if(e!==null){const s=e.e;if(s!==null){var r=ke,n=be;e.e=null;try{for(var i=0;i<s.length;i++){var o=s[i];wi(o.effect),wn(o.reaction),YR(o.fn)}}finally{wi(r),wn(n)}}gr=e.p,e.m=!0}return{}}function VR(){return!0}function Js(t){if(typeof t!="object"||t===null||aa in t)return t;const e=QO(t);if(e!==XO&&e!==ZO)return t;var r=new Map,n=PR(t),i=Jt(0),o=be,s=a=>{var l=be;wn(o);var u=a();return wn(l),u};return n&&r.set("length",Jt(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&sM();var c=r.get(l);return c===void 0?c=s(()=>{var h=Jt(u.value);return r.set(l,h),h}):Ve(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const d=s(()=>Jt(Nt));r.set(l,d),gc(i)}}else{if(n&&typeof l=="string"){var c=r.get("length"),h=Number(l);Number.isInteger(h)&&h<c.v&&Ve(c,h)}Ve(u,Nt),gc(i)}return!0},get(a,l,u){var g;if(l===aa)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||(g=sa(a,l))!=null&&g.writable)&&(c=s(()=>{var w=Js(h?a[l]:Nt),y=Jt(w);return y}),r.set(l,c)),c!==void 0){var d=ue(c);return d===Nt?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=ue(c))}else if(u===void 0){var h=r.get(l),d=h==null?void 0:h.v;if(h!==void 0&&d!==Nt)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){var d;if(l===aa)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Nt||Reflect.has(a,l);if(u!==void 0||ke!==null&&(!c||(d=sa(a,l))!=null&&d.writable)){u===void 0&&(u=s(()=>{var g=c?Js(a[l]):Nt,w=Jt(g);return w}),r.set(l,u));var h=ue(u);if(h===Nt)return!1}return c},set(a,l,u,c){var E;var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?Ve(w,Nt):g in a&&(w=s(()=>Jt(Nt)),r.set(g+"",w))}if(h===void 0)(!d||(E=sa(a,l))!=null&&E.writable)&&(h=s(()=>Jt(void 0)),Ve(h,Js(u)),r.set(l,h));else{d=h.v!==Nt;var y=s(()=>Js(u));Ve(h,y)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b!=null&&b.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var T=r.get("length"),v=Number(l);Number.isInteger(v)&&v>=T.v&&Ve(T,v+1)}gc(i)}return!0},ownKeys(a){ue(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==Nt});for(var[u,c]of r)c.v!==Nt&&!(u in a)&&l.push(u);return l},setPrototypeOf(){aM()}})}function gc(t,e=1){Ve(t,t.v+e)}function mw(t){try{if(t!==null&&typeof t=="object"&&aa in t)return t[aa]}catch{}return t}function dM(t,e){return Object.is(mw(t),mw(e))}function fM(t){var e=mr|Yn,r=be!==null&&(be.f&mr)!==0?be:null;return ke===null||r!==null&&(r.f&fr)!==0?e|=fr:ke.f|=AR,{ctx:gr,deps:null,effects:null,equals:kR,f:e,fn:t,reactions:null,rv:0,v:Nt,wv:0,parent:r??ke,ac:null}}function WR(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Zi(e[r])}}function gM(t){for(var e=t.parent;e!==null;){if((e.f&mr)===0)return e;e=e.parent}return null}function Yg(t){var e,r=ke;wi(gM(t));try{WR(t),e=rE(t)}finally{wi(r)}return e}function $R(t){var e=Yg(t);if(t.equals(e)||(t.v=e,t.wv=eE()),!Qi){var r=(ui||(t.f&fr)!==0)&&t.deps!==null?io:pr;vn(t,r)}}const qi=new Map;function mM(t,e){var r={f:0,v:t,reactions:null,equals:kR,rv:0,wv:0};return r}function Jt(t,e){const r=mM(t);return xM(r),r}function Ve(t,e,r=!1){be!==null&&(!gn||(be.f&fw)!==0)&&VR()&&(be.f&(mr|jg|fw))!==0&&!((ot==null?void 0:ot.reaction)===be&&ot.sources.includes(t))&&lM();let n=r?Js(e):e;return pM(t,n)}function pM(t,e){if(!t.equals(e)){var r=t.v;Qi?qi.set(t,e):qi.set(t,r),t.v=e,(t.f&mr)!==0&&((t.f&Yn)!==0&&Yg(t),vn(t,(t.f&fr)===0?pr:io)),t.wv=eE(),BR(t,Yn),ke!==null&&(ke.f&pr)!==0&&(ke.f&(bi|os))===0&&(Ir===null?HM([t]):Ir.push(t))}return e}function BR(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f;(s&Yn)===0&&(vn(o,e),(s&(pr|fr))!==0&&((s&mr)!==0?BR(o,io):Ru(o)))}}var ig,jR,zR,UR;function wM(){if(ig===void 0){ig=window,jR=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;zR=sa(e,"firstChild").get,UR=sa(e,"nextSibling").get,dw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),dw(r)&&(r.__t=void 0)}}function vM(t=""){return document.createTextNode(t)}function zi(t){return zR.call(t)}function qg(t){return UR.call(t)}function xt(t,e){return zi(t)}function yM(t,e){{var r=zi(t);return r instanceof Comment&&r.data===""?qg(r):r}}function vt(t,e=1,r=!1){let n=t;for(;e--;)n=qg(n);return n}function bM(t){ke===null&&be===null&&iM(),be!==null&&(be.f&fr)!==0&&ke===null&&nM(),Qi&&rM()}function CM(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function ss(t,e,r,n=!0){var i=ke,o={ctx:gr,deps:null,nodes_start:null,nodes_end:null,f:t|Yn,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Xg(o),o.f|=HR}catch(l){throw Zi(o),l}else e!==null&&Ru(o);var s=r&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(AR|zg))===0;if(!s&&n&&(i!==null&&CM(o,i),be!==null&&(be.f&mr)!==0)){var a=be;(a.effects??(a.effects=[])).push(o)}return o}function Gg(t){const e=ss(Cu,null,!1);return vn(e,pr),e.teardown=t,e}function SM(t){bM();var e=ke!==null&&(ke.f&bi)!==0&&gr!==null&&!gr.m;if(e){var r=gr;(r.e??(r.e=[])).push({fn:t,effect:ke,reaction:be})}else return YR(t)}function YR(t){return ss(xR|DR,t,!1)}function RM(t){const e=ss(os,t,!0);return(r={})=>new Promise(n=>{r.outro?OM(e,()=>{Zi(e),n(void 0)}):(Zi(e),n(void 0))})}function Kg(t){return ss(Cu,t,!0)}function qR(t,e=[],r=fM){const n=e.map(r);return EM(()=>t(...n.map(ue)))}function EM(t,e=0){var r=ss(Cu|jg|e,t,!0);return r}function TM(t,e=!0){return ss(Cu|bi,t,!0,e)}function GR(t){var e=t.teardown;if(e!==null){const r=Qi,n=be;pw(!0),wn(null);try{e.call(null)}finally{pw(r),wn(n)}}}function KR(t,e=!1){var i;var r=t.first;for(t.first=t.last=null;r!==null;){(i=r.ac)==null||i.abort(NR);var n=r.next;(r.f&os)!==0?r.parent=null:Zi(r,e),r=n}}function _M(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&bi)===0&&Zi(e),e=r}}function Zi(t,e=!0){var r=!1;(e||(t.f&tM)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(XR(t.nodes_start,t.nodes_end),r=!0),KR(t,e&&!r),ru(t,0),vn(t,Ug);var n=t.transitions;if(n!==null)for(const o of n)o.stop();GR(t);var i=t.parent;i!==null&&i.first!==null&&ZR(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function XR(t,e){for(;t!==null;){var r=t===e?null:qg(t);t.remove(),t=r}}function ZR(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function OM(t,e){var r=[];QR(t,r,!0),MM(r,()=>{Zi(t),e&&e()})}function MM(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function QR(t,e,r){if((t.f&Zl)===0){if(t.f^=Zl,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&eM)!==0||(n.f&bi)!==0;QR(n,e,o?r:!1),n=i}}}let Ql=[];function IM(){var t=Ql;Ql=[],JO(t)}function og(t){Ql.length===0&&queueMicrotask(IM),Ql.push(t)}function PM(t){var e=ke;if((e.f&HR)===0){if((e.f&zg)===0)throw t;e.fn(t)}else JR(t,e)}function JR(t,e){for(;e!==null;){if((e.f&zg)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t}let sg=!1,Jl=null,Gi=!1,Qi=!1;function pw(t){Qi=t}let Fl=[],be=null,gn=!1;function wn(t){be=t}let ke=null;function wi(t){ke=t}let ot=null;function xM(t){be!==null&&be.f&ng&&(ot===null?ot={reaction:be,sources:[t]}:ot.sources.push(t))}let Lt=null,ur=0,Ir=null;function HM(t){Ir=t}let eu=1,tu=0,ui=!1;function eE(){return++eu}function Su(t){var h;var e=t.f;if((e&Yn)!==0)return!0;if((e&io)!==0){var r=t.deps,n=(e&fr)!==0;if(r!==null){var i,o,s=(e&Xl)!==0,a=n&&ke!==null&&!ui,l=r.length;if(s||a){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!((h=o==null?void 0:o.reactions)!=null&&h.includes(u)))&&(o.reactions??(o.reactions=[])).push(u);s&&(u.f^=Xl),a&&c!==null&&(c.f&fr)===0&&(u.f^=fr)}for(i=0;i<l;i++)if(o=r[i],Su(o)&&$R(o),o.wv>t.wv)return!0}(!n||ke!==null&&!ui)&&vn(t,pr)}return!1}function tE(t,e,r=!0){var n=t.reactions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];(ot==null?void 0:ot.reaction)===be&&ot.sources.includes(t)||((o.f&mr)!==0?tE(o,e,!1):e===o&&(r?vn(o,Yn):(o.f&pr)!==0&&vn(o,io),Ru(o)))}}function rE(t){var g;var e=Lt,r=ur,n=Ir,i=be,o=ui,s=ot,a=gr,l=gn,u=t.f;Lt=null,ur=0,Ir=null,ui=(u&fr)!==0&&(gn||!Gi||be===null),be=(u&(bi|os))===0?t:null,ot=null,gw(t.ctx),gn=!1,++tu,t.f|=ng,t.ac!==null&&(t.ac.abort(NR),t.ac=null);try{var c=(0,t.fn)(),h=t.deps;if(Lt!==null){var d;if(ru(t,ur),h!==null&&ur>0)for(h.length=ur+Lt.length,d=0;d<Lt.length;d++)h[ur+d]=Lt[d];else t.deps=h=Lt;if(!ui||(u&mr)!==0&&t.reactions!==null)for(d=ur;d<h.length;d++)((g=h[d]).reactions??(g.reactions=[])).push(t)}else h!==null&&ur<h.length&&(ru(t,ur),h.length=ur);if(VR()&&Ir!==null&&!gn&&h!==null&&(t.f&(mr|io|Yn))===0)for(d=0;d<Ir.length;d++)tE(Ir[d],t);return i!==null&&i!==t&&(tu++,Ir!==null&&(n===null?n=Ir:n.push(...Ir))),c}catch(w){PM(w)}finally{Lt=e,ur=r,Ir=n,be=i,ui=o,ot=s,gw(a),gn=l,t.f^=ng}}function AM(t,e){let r=e.reactions;if(r!==null){var n=qO.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&mr)!==0&&(Lt===null||!Lt.includes(e))&&(vn(e,io),(e.f&(fr|Xl))===0&&(e.f^=Xl),WR(e),ru(e,0))}function ru(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)AM(t,r[n])}function Xg(t){var e=t.f;if((e&Ug)===0){vn(t,pr);var r=ke,n=Gi;ke=t,Gi=!0;try{(e&jg)!==0?_M(t):KR(t),GR(t);var i=rE(t);t.teardown=typeof i=="function"?i:null,t.wv=eu;var o;hw&&uM&&(t.f&Yn)!==0&&t.deps}finally{Gi=n,ke=r}}}function DM(){try{oM()}catch(t){if(Jl!==null)JR(t,Jl);else throw t}}function NM(){var t=Gi;try{var e=0;for(Gi=!0;Fl.length>0;){e++>1e3&&DM();var r=Fl,n=r.length;Fl=[];for(var i=0;i<n;i++){var o=LM(r[i]);kM(o)}qi.clear()}}finally{sg=!1,Gi=t,Jl=null}}function kM(t){var e=t.length;if(e!==0){for(var r=0;r<e;r++){var n=t[r];if((n.f&(Ug|Zl))===0&&Su(n)){var i=eu;if(Xg(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?ZR(n):n.fn=null),eu>i&&(n.f&DR)!==0)break}}for(;r<e;r+=1)Ru(t[r])}}function Ru(t){sg||(sg=!0,queueMicrotask(NM));for(var e=Jl=t;e.parent!==null;){e=e.parent;var r=e.f;if((r&(os|bi))!==0){if((r&pr)===0)return;e.f^=pr}}Fl.push(e)}function LM(t){for(var e=[],r=t;r!==null;){var n=r.f,i=(n&(bi|os))!==0,o=i&&(n&pr)!==0;if(!o&&(n&Zl)===0){(n&xR)!==0?e.push(r):i?r.f^=pr:Su(r)&&Xg(r);var s=r.first;if(s!==null){r=s;continue}}var a=r.parent;for(r=r.next;r===null&&a!==null;)r=a.next,a=a.parent}return e}function ue(t){var e=t.f,r=(e&mr)!==0;if(be!==null&&!gn){if((ot==null?void 0:ot.reaction)!==be||!(ot!=null&&ot.sources.includes(t))){var n=be.deps;t.rv<tu&&(t.rv=tu,Lt===null&&n!==null&&n[ur]===t?ur++:Lt===null?Lt=[t]:(!ui||!Lt.includes(t))&&Lt.push(t))}}else if(r&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&fr)===0&&(i.f^=fr)}if(r&&!Qi&&(i=t,Su(i)&&$R(i)),Qi){if(qi.has(t))return qi.get(t);if(r){i=t;var s=i.v;return((i.f&pr)!==0||nE(i))&&(s=Yg(i)),qi.set(i,s),s}}return t.v}function nE(t){if(t.v===Nt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(qi.has(e)||(e.f&mr)!==0&&nE(e))return!0;return!1}function Zg(t){var e=gn;try{return gn=!0,t()}finally{gn=e}}const FM=-7169;function vn(t,e){t.f=t.f&FM|e}const VM=["touchstart","touchmove"];function WM(t){return VM.includes(t)}let ww=!1;function $M(){ww||(ww=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function iE(t){var e=be,r=ke;wn(null),wi(null);try{return t()}finally{wn(e),wi(r)}}function Qg(t,e,r,n=r){t.addEventListener(e,()=>iE(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),$M()}const oE=new Set,ag=new Set;function BM(t,e,r,n={}){function i(o){if(n.capture||ea.call(e,o),!o.cancelBubble)return iE(()=>r==null?void 0:r.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?og(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function jM(t,e,r,n,i){var o={capture:n,passive:i},s=BM(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Gg(()=>{e.removeEventListener(t,s,o)})}function zM(t){for(var e=0;e<t.length;e++)oE.add(t[e]);for(var r of ag)r(t)}function ea(t){var v;var e=this,r=e.ownerDocument,n=t.type,i=((v=t.composedPath)==null?void 0:v.call(t))||[],o=i[0]||t.target,s=0,a=t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){KO(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=be,h=ke;wn(null),wi(null);try{for(var d,g=[];o!==null;){var w=o.assignedSlot||o.parentNode||o.host||null;try{var y=o["__"+n];if(y!=null&&(!o.disabled||t.target===o))if(PR(y)){var[b,...T]=y;b.apply(o,[t,...T])}else y.call(o,t)}catch(E){d?g.push(E):d=E}if(t.cancelBubble||w===e||w===null)break;o=w}if(d){for(let E of g)queueMicrotask(()=>{throw E});throw d}}finally{t.__root=e,delete t.currentTarget,wn(c),wi(h)}}}function sE(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function aE(t,e){var r=ke;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function UM(t,e){var r=(e&cM)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=sE(i?t:"<!>"+t));var o=r||jR?document.importNode(n,!0):n.cloneNode(!0);{var s=zi(o),a=o.lastChild;aE(s,a)}return o}}function YM(t,e){t!==null&&t.before(e)}function qM(t,e){return GM(t,e)}const yo=new Map;function GM(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){wM();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var w=WM(g);e.addEventListener(g,ea,{passive:w});var y=yo.get(g);y===void 0?(document.addEventListener(g,ea,{passive:w}),yo.set(g,1)):yo.set(g,y+1)}}};l(GO(oE)),ag.add(l);var u=void 0,c=RM(()=>{var h=r??e.appendChild(vM());return TM(()=>{if(o){LR({});var d=gr;d.c=o}i&&(n.$$events=i),u=t(h,n)||{},o&&FR()}),()=>{var w;for(var d of a){e.removeEventListener(d,ea);var g=yo.get(d);--g===0?(document.removeEventListener(d,ea),yo.delete(d)):yo.set(d,g)}ag.delete(l),h!==r&&((w=h.parentNode)==null||w.removeChild(h))}});return KM.set(u,c),u}let KM=new WeakMap;function XM(t,e,r=!1,n=!1,i=!1){var o=t,s="";qR(()=>{var a=ke;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(XR(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=sE(l);if((r||n)&&(u=zi(u)),aE(zi(u),u.lastChild),r||n)for(;zi(u);)o.before(zi(u));else o.before(u)}})}function ZM(t,e,r=e){Qg(t,"input",n=>{var i=n?t.defaultValue:t.value;if(i=pc(t)?wc(i):i,r(i),i!==(i=e())){var o=t.selectionStart,s=t.selectionEnd;t.value=i??"",s!==null&&(t.selectionStart=o,t.selectionEnd=Math.min(s,t.value.length))}}),Zg(e)==null&&t.value&&r(pc(t)?wc(t.value):t.value),Kg(()=>{var n=e();pc(t)&&n===wc(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}const mc=new Set;function Ua(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??(s[a]=[]);s.push(r),Qg(r,"change",()=>{var l=r.__value;o&&(l=QM(s,l,r.checked)),i(l)},()=>i(o?[]:null)),Kg(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=dM(r.__value,l)}),Gg(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),mc.has(s)||(mc.add(s),og(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),mc.delete(s)})),og(()=>{})}function vw(t,e,r=e){Qg(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),Zg(e)==null&&r(t.checked),Kg(()=>{var n=e();t.checked=!!n})}function QM(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function pc(t){var e=t.type;return e==="number"||e==="range"}function wc(t){return t===""?null:+t}function JM(t){gr===null&&hM(),SM(()=>{const e=Zg(t);if(typeof e=="function")return e})}const eI="5";var IR;typeof window<"u"&&((IR=window.__svelte??(window.__svelte={})).v??(IR.v=new Set)).add(eI);var yw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bw={},bs,Cw;function Je(){if(Cw)return bs;Cw=1;var t=function(e){return e&&e.Math===Math&&e};return bs=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof yw=="object"&&yw)||t(typeof bs=="object"&&bs)||function(){return this}()||Function("return this")(),bs}var vc={},yc,Sw;function st(){return Sw||(Sw=1,yc=function(t){try{return!!t()}catch{return!0}}),yc}var bc,Rw;function Nr(){if(Rw)return bc;Rw=1;var t=st();return bc=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),bc}var Cc,Ew;function Eu(){if(Ew)return Cc;Ew=1;var t=st();return Cc=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Cc}var Sc,Tw;function pt(){if(Tw)return Sc;Tw=1;var t=Eu(),e=Function.prototype.call;return Sc=t?e.bind(e):function(){return e.apply(e,arguments)},Sc}var Rc={},_w;function tI(){if(_w)return Rc;_w=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return Rc.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,Rc}var Ec,Ow;function Tu(){return Ow||(Ow=1,Ec=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Ec}var Tc,Mw;function et(){if(Mw)return Tc;Mw=1;var t=Eu(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return Tc=t?n:function(i){return function(){return r.apply(i,arguments)}},Tc}var _c,Iw;function oo(){if(Iw)return _c;Iw=1;var t=et(),e=t({}.toString),r=t("".slice);return _c=function(n){return r(e(n),8,-1)},_c}var Oc,Pw;function rI(){if(Pw)return Oc;Pw=1;var t=et(),e=st(),r=oo(),n=Object,i=t("".split);return Oc=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,Oc}var Mc,xw;function Jg(){return xw||(xw=1,Mc=function(t){return t==null}),Mc}var Ic,Hw;function Ta(){if(Hw)return Ic;Hw=1;var t=Jg(),e=TypeError;return Ic=function(r){if(t(r))throw new e("Can't call method on "+r);return r},Ic}var Pc,Aw;function _a(){if(Aw)return Pc;Aw=1;var t=rI(),e=Ta();return Pc=function(r){return t(e(r))},Pc}var xc,Dw;function at(){if(Dw)return xc;Dw=1;var t=typeof document=="object"&&document.all;return xc=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},xc}var Hc,Nw;function kr(){if(Nw)return Hc;Nw=1;var t=at();return Hc=function(e){return typeof e=="object"?e!==null:t(e)},Hc}var Ac,kw;function as(){if(kw)return Ac;kw=1;var t=Je(),e=at(),r=function(n){return e(n)?n:void 0};return Ac=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},Ac}var Dc,Lw;function Oa(){if(Lw)return Dc;Lw=1;var t=et();return Dc=t({}.isPrototypeOf),Dc}var Nc,Fw;function _u(){if(Fw)return Nc;Fw=1;var t=Je(),e=t.navigator,r=e&&e.userAgent;return Nc=r?String(r):"",Nc}var kc,Vw;function nI(){if(Vw)return kc;Vw=1;var t=Je(),e=_u(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),kc=a,kc}var Lc,Ww;function em(){if(Ww)return Lc;Ww=1;var t=nI(),e=st(),r=Je(),n=r.String;return Lc=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Lc}var Fc,$w;function lE(){if($w)return Fc;$w=1;var t=em();return Fc=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Fc}var Vc,Bw;function tm(){if(Bw)return Vc;Bw=1;var t=as(),e=at(),r=Oa(),n=lE(),i=Object;return Vc=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Vc}var Wc,jw;function Ou(){if(jw)return Wc;jw=1;var t=String;return Wc=function(e){try{return t(e)}catch{return"Object"}},Wc}var $c,zw;function vr(){if(zw)return $c;zw=1;var t=at(),e=Ou(),r=TypeError;return $c=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},$c}var Bc,Uw;function Ma(){if(Uw)return Bc;Uw=1;var t=vr(),e=Jg();return Bc=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Bc}var jc,Yw;function iI(){if(Yw)return jc;Yw=1;var t=pt(),e=at(),r=kr(),n=TypeError;return jc=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},jc}var zc={exports:{}},Uc,qw;function so(){return qw||(qw=1,Uc=!1),Uc}var Yc,Gw;function rm(){if(Gw)return Yc;Gw=1;var t=Je(),e=Object.defineProperty;return Yc=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Yc}var Kw;function nm(){if(Kw)return zc.exports;Kw=1;var t=so(),e=Je(),r=rm(),n="__core-js_shared__",i=zc.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),zc.exports}var qc,Xw;function uE(){if(Xw)return qc;Xw=1;var t=nm();return qc=function(e,r){return t[e]||(t[e]=r||{})},qc}var Gc,Zw;function ls(){if(Zw)return Gc;Zw=1;var t=Ta(),e=Object;return Gc=function(r){return e(t(r))},Gc}var Kc,Qw;function Lr(){if(Qw)return Kc;Qw=1;var t=et(),e=ls(),r=t({}.hasOwnProperty);return Kc=Object.hasOwn||function(i,o){return r(e(i),o)},Kc}var Xc,Jw;function cE(){if(Jw)return Xc;Jw=1;var t=et(),e=0,r=Math.random(),n=t(1.1.toString);return Xc=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Xc}var Zc,ev;function tn(){if(ev)return Zc;ev=1;var t=Je(),e=uE(),r=Lr(),n=cE(),i=em(),o=lE(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Zc=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Zc}var Qc,tv;function oI(){if(tv)return Qc;tv=1;var t=pt(),e=kr(),r=tm(),n=Ma(),i=iI(),o=tn(),s=TypeError,a=o("toPrimitive");return Qc=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Qc}var Jc,rv;function hE(){if(rv)return Jc;rv=1;var t=oI(),e=tm();return Jc=function(r){var n=t(r,"string");return e(n)?n:n+""},Jc}var eh,nv;function im(){if(nv)return eh;nv=1;var t=Je(),e=kr(),r=t.document,n=e(r)&&e(r.createElement);return eh=function(i){return n?r.createElement(i):{}},eh}var th,iv;function dE(){if(iv)return th;iv=1;var t=Nr(),e=st(),r=im();return th=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),th}var ov;function fE(){if(ov)return vc;ov=1;var t=Nr(),e=pt(),r=tI(),n=Tu(),i=_a(),o=hE(),s=Lr(),a=dE(),l=Object.getOwnPropertyDescriptor;return vc.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},vc}var rh={},nh,sv;function gE(){if(sv)return nh;sv=1;var t=Nr(),e=st();return nh=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),nh}var ih,av;function wt(){if(av)return ih;av=1;var t=kr(),e=String,r=TypeError;return ih=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},ih}var lv;function Ci(){if(lv)return rh;lv=1;var t=Nr(),e=dE(),r=gE(),n=wt(),i=hE(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return rh.f=t?r?function(d,g,w){if(n(d),g=i(g),n(w),typeof d=="function"&&g==="prototype"&&"value"in w&&c in w&&!w[c]){var y=a(d,g);y&&y[c]&&(d[g]=w.value,w={configurable:u in w?w[u]:y[u],enumerable:l in w?w[l]:y[l],writable:!1})}return s(d,g,w)}:s:function(d,g,w){if(n(d),g=i(g),n(w),e)try{return s(d,g,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(d[g]=w.value),d},rh}var oh,uv;function us(){if(uv)return oh;uv=1;var t=Nr(),e=Ci(),r=Tu();return oh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},oh}var sh={exports:{}},ah,cv;function sI(){if(cv)return ah;cv=1;var t=Nr(),e=Lr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return ah={EXISTS:i,PROPER:o,CONFIGURABLE:s},ah}var lh,hv;function aI(){if(hv)return lh;hv=1;var t=et(),e=at(),r=nm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),lh=r.inspectSource,lh}var uh,dv;function lI(){if(dv)return uh;dv=1;var t=Je(),e=at(),r=t.WeakMap;return uh=e(r)&&/native code/.test(String(r)),uh}var ch,fv;function om(){if(fv)return ch;fv=1;var t=uE(),e=cE(),r=t("keys");return ch=function(n){return r[n]||(r[n]=e(n))},ch}var hh,gv;function sm(){return gv||(gv=1,hh={}),hh}var dh,mv;function mE(){if(mv)return dh;mv=1;var t=lI(),e=Je(),r=kr(),n=us(),i=Lr(),o=nm(),s=om(),a=sm(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,w=function(v){return g(v)?d(v):h(v,{})},y=function(v){return function(E){var _;if(!r(E)||(_=d(E)).type!==v)throw new u("Incompatible receiver, "+v+" required");return _}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(v,E){if(b.has(v))throw new u(l);return E.facade=v,b.set(v,E),E},d=function(v){return b.get(v)||{}},g=function(v){return b.has(v)}}else{var T=s("state");a[T]=!0,h=function(v,E){if(i(v,T))throw new u(l);return E.facade=v,n(v,T,E),E},d=function(v){return i(v,T)?v[T]:{}},g=function(v){return i(v,T)}}return dh={set:h,get:d,has:g,enforce:w,getterFor:y},dh}var pv;function pE(){if(pv)return sh.exports;pv=1;var t=et(),e=st(),r=at(),n=Lr(),i=Nr(),o=sI().CONFIGURABLE,s=aI(),a=mE(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),w=t([].join),y=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),T=sh.exports=function(v,E,_){d(c(E),0,7)==="Symbol("&&(E="["+g(c(E),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),_&&_.getter&&(E="get "+E),_&&_.setter&&(E="set "+E),(!n(v,"name")||o&&v.name!==E)&&(i?h(v,"name",{value:E,configurable:!0}):v.name=E),y&&_&&n(_,"arity")&&v.length!==_.arity&&h(v,"length",{value:_.arity});try{_&&n(_,"constructor")&&_.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var M=l(v);return n(M,"source")||(M.source=w(b,typeof E=="string"?E:"")),v};return Function.prototype.toString=T(function(){return r(this)&&u(this).source||s(this)},"toString"),sh.exports}var fh,wv;function am(){if(wv)return fh;wv=1;var t=at(),e=Ci(),r=pE(),n=rm();return fh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},fh}var gh={},mh,vv;function uI(){if(vv)return mh;vv=1;var t=Math.ceil,e=Math.floor;return mh=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},mh}var ph,yv;function Ia(){if(yv)return ph;yv=1;var t=uI();return ph=function(e){var r=+e;return r!==r||r===0?0:t(r)},ph}var wh,bv;function cI(){if(bv)return wh;bv=1;var t=Ia(),e=Math.max,r=Math.min;return wh=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},wh}var vh,Cv;function hI(){if(Cv)return vh;Cv=1;var t=Ia(),e=Math.min;return vh=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},vh}var yh,Sv;function cs(){if(Sv)return yh;Sv=1;var t=hI();return yh=function(e){return t(e.length)},yh}var bh,Rv;function dI(){if(Rv)return bh;Rv=1;var t=_a(),e=cI(),r=cs(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return bh={includes:n(!0),indexOf:n(!1)},bh}var Ch,Ev;function wE(){if(Ev)return Ch;Ev=1;var t=et(),e=Lr(),r=_a(),n=dI().indexOf,i=sm(),o=t([].push);return Ch=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},Ch}var Sh,Tv;function lm(){return Tv||(Tv=1,Sh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Sh}var _v;function fI(){if(_v)return gh;_v=1;var t=wE(),e=lm(),r=e.concat("length","prototype");return gh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},gh}var Rh={},Ov;function gI(){return Ov||(Ov=1,Rh.f=Object.getOwnPropertySymbols),Rh}var Eh,Mv;function mI(){if(Mv)return Eh;Mv=1;var t=as(),e=et(),r=fI(),n=gI(),i=wt(),o=e([].concat);return Eh=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},Eh}var Th,Iv;function vE(){if(Iv)return Th;Iv=1;var t=Lr(),e=mI(),r=fE(),n=Ci();return Th=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},Th}var _h,Pv;function pI(){if(Pv)return _h;Pv=1;var t=st(),e=at(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return _h=n,_h}var Oh,xv;function Le(){if(xv)return Oh;xv=1;var t=Je(),e=fE().f,r=us(),n=am(),i=rm(),o=vE(),s=pI();return Oh=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,w,y,b,T;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(w in l){if(b=l[w],a.dontCallGetSet?(T=e(g,w),y=T&&T.value):y=g[w],d=s(c?w:u+(h?".":"#")+w,a.forced),!d&&y!==void 0){if(typeof b==typeof y)continue;o(b,y)}(a.sham||y&&y.sham)&&r(b,"sham",!0),n(g,w,b,a)}},Oh}var Mh,Hv;function Pa(){if(Hv)return Mh;Hv=1;var t=Eu(),e=Function.prototype,r=e.apply,n=e.call;return Mh=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),Mh}var Ih,Av;function yE(){if(Av)return Ih;Av=1;var t=et(),e=vr();return Ih=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},Ih}var Ph,Dv;function wI(){if(Dv)return Ph;Dv=1;var t=kr();return Ph=function(e){return t(e)||e===null},Ph}var xh,Nv;function vI(){if(Nv)return xh;Nv=1;var t=wI(),e=String,r=TypeError;return xh=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},xh}var Hh,kv;function bE(){if(kv)return Hh;kv=1;var t=yE(),e=kr(),r=Ta(),n=vI();return Hh=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),Hh}var Ah,Lv;function yI(){if(Lv)return Ah;Lv=1;var t=Ci().f;return Ah=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},Ah}var Dh,Fv;function bI(){if(Fv)return Dh;Fv=1;var t=at(),e=kr(),r=bE();return Dh=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},Dh}var Nh,Vv;function CI(){if(Vv)return Nh;Vv=1;var t=tn(),e=t("toStringTag"),r={};return r[e]="z",Nh=String(r)==="[object z]",Nh}var kh,Wv;function CE(){if(Wv)return kh;Wv=1;var t=CI(),e=at(),r=oo(),n=tn(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return kh=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},kh}var Lh,$v;function Mu(){if($v)return Lh;$v=1;var t=CE(),e=String;return Lh=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Lh}var Fh,Bv;function SI(){if(Bv)return Fh;Bv=1;var t=Mu();return Fh=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Fh}var Vh,jv;function RI(){if(jv)return Vh;jv=1;var t=kr(),e=us();return Vh=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Vh}var Wh,zv;function EI(){if(zv)return Wh;zv=1;var t=et(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return Wh=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},Wh}var $h,Uv;function TI(){if(Uv)return $h;Uv=1;var t=st(),e=Tu();return $h=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),$h}var Bh,Yv;function _I(){if(Yv)return Bh;Yv=1;var t=us(),e=EI(),r=TI(),n=Error.captureStackTrace;return Bh=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Bh}var jh,qv;function OI(){if(qv)return jh;qv=1;var t=as(),e=Lr(),r=us(),n=Oa(),i=bE(),o=vE(),s=yI(),a=bI(),l=SI(),u=RI(),c=_I(),h=Nr(),d=so();return jh=function(g,w,y,b){var T="stackTraceLimit",v=b?2:1,E=g.split("."),_=E[E.length-1],M=t.apply(null,E);if(M){var P=M.prototype;if(!d&&e(P,"cause")&&delete P.cause,!y)return M;var x=t("Error"),F=w(function(U,H){var G=l(b?H:U,void 0),J=b?new M(U):new M;return G!==void 0&&r(J,"message",G),c(J,F,J.stack,2),this&&n(P,this)&&a(J,this,F),arguments.length>v&&u(J,arguments[v]),J});if(F.prototype=P,_!=="Error"?i?i(F,x):o(F,x,{name:!0}):h&&T in M&&(s(F,M,T),s(F,M,"prepareStackTrace")),o(F,M),!d)try{P.name!==_&&r(P,"name",_),P.constructor=F}catch{}return F}},jh}var Gv;function MI(){if(Gv)return bw;Gv=1;var t=Le(),e=Je(),r=Pa(),n=OI(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),bw}MI();var Kv={},zh,Xv;function SE(){if(Xv)return zh;Xv=1;var t=oo();return zh=Array.isArray||function(r){return t(r)==="Array"},zh}var Uh,Zv;function RE(){if(Zv)return Uh;Zv=1;var t=Nr(),e=SE(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Uh=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Uh}var Yh,Qv;function EE(){if(Qv)return Yh;Qv=1;var t=TypeError,e=9007199254740991;return Yh=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Yh}var Jv;function II(){if(Jv)return Kv;Jv=1;var t=Le(),e=ls(),r=cs(),n=RE(),i=EE(),o=st(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var w=0;w<g;w++)h[d]=arguments[w],d++;return n(h,d),d}}),Kv}II();var ey={},qh,ty;function PI(){if(ty)return qh;ty=1;var t=oo(),e=et();return qh=function(r){if(t(r)==="Function")return e(r)},qh}var Gh,ry;function TE(){if(ry)return Gh;ry=1;var t=PI(),e=vr(),r=Eu(),n=t(t.bind);return Gh=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},Gh}var Kh,ny;function _E(){return ny||(ny=1,Kh={}),Kh}var Xh,iy;function xI(){if(iy)return Xh;iy=1;var t=tn(),e=_E(),r=t("iterator"),n=Array.prototype;return Xh=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Xh}var Zh,oy;function OE(){if(oy)return Zh;oy=1;var t=CE(),e=Ma(),r=Jg(),n=_E(),i=tn(),o=i("iterator");return Zh=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Zh}var Qh,sy;function HI(){if(sy)return Qh;sy=1;var t=pt(),e=vr(),r=wt(),n=Ou(),i=OE(),o=TypeError;return Qh=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Qh}var Jh,ay;function yr(){if(ay)return Jh;ay=1;var t=pt(),e=wt(),r=Ma();return Jh=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Jh}var ed,ly;function hs(){if(ly)return ed;ly=1;var t=TE(),e=pt(),r=wt(),n=Ou(),i=xI(),o=cs(),s=Oa(),a=HI(),l=OE(),u=yr(),c=TypeError,h=function(g,w){this.stopped=g,this.result=w},d=h.prototype;return ed=function(g,w,y){var b=y&&y.that,T=!!(y&&y.AS_ENTRIES),v=!!(y&&y.IS_RECORD),E=!!(y&&y.IS_ITERATOR),_=!!(y&&y.INTERRUPTED),M=t(w,b),P,x,F,U,H,G,J,ae=function(ee){return P&&u(P,"normal"),new h(!0,ee)},q=function(ee){return T?(r(ee),_?M(ee[0],ee[1],ae):M(ee[0],ee[1])):_?M(ee,ae):M(ee)};if(v)P=g.iterator;else if(E)P=g;else{if(x=l(g),!x)throw new c(n(g)+" is not iterable");if(i(x)){for(F=0,U=o(g);U>F;F++)if(H=q(g[F]),H&&s(d,H))return H;return new h(!1)}P=a(g,x)}for(G=v?g.next:P.next;!(J=e(G,P)).done;){try{H=q(J.value)}catch(ee){u(P,"throw",ee)}if(typeof H=="object"&&H&&s(d,H))return H}return new h(!1)},ed}var td,uy;function ME(){if(uy)return td;uy=1;var t=Nr(),e=Ci(),r=Tu();return td=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},td}var cy;function AI(){if(cy)return ey;cy=1;var t=Le(),e=hs(),r=ME();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),ey}AI();var hy={},rd,dy;function Rn(){if(dy)return rd;dy=1;var t=et(),e=Set.prototype;return rd={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},rd}var nd,fy;function ao(){if(fy)return nd;fy=1;var t=Rn().has;return nd=function(e){return t(e),e},nd}var id,gy;function lo(){if(gy)return id;gy=1;var t=pt();return id=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},id}var od,my;function xa(){if(my)return od;my=1;var t=et(),e=lo(),r=Rn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return od=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},od}var sd,py;function um(){if(py)return sd;py=1;var t=Rn(),e=xa(),r=t.Set,n=t.add;return sd=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},sd}var ad,wy;function Ha(){if(wy)return ad;wy=1;var t=yE(),e=Rn();return ad=t(e.proto,"size","get")||function(r){return r.size},ad}var ld,vy;function Si(){return vy||(vy=1,ld=function(t){return{iterator:t,next:t.next,done:!1}}),ld}var ud,yy;function uo(){if(yy)return ud;yy=1;var t=vr(),e=wt(),r=pt(),n=Ia(),i=Si(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},ud=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},ud}var cd,by;function DI(){if(by)return cd;by=1;var t=ao(),e=Rn(),r=um(),n=Ha(),i=uo(),o=xa(),s=lo(),a=e.has,l=e.remove;return cd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(w){d.includes(w)&&l(g,w)}):s(d.getIterator(),function(w){a(g,w)&&l(g,w)}),g},cd}var hd,Cy;function co(){if(Cy)return hd;Cy=1;var t=as(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return hd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},hd}var Sy;function NI(){if(Sy)return hy;Sy=1;var t=Le(),e=DI(),r=st(),n=co(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),hy}NI();var Ry={},dd,Ey;function kI(){if(Ey)return dd;Ey=1;var t=ao(),e=Rn(),r=Ha(),n=uo(),i=xa(),o=lo(),s=e.Set,a=e.add,l=e.has;return dd=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(w){l(h,w)&&a(g,w)}):i(h,function(w){d.includes(w)&&a(g,w)}),g},dd}var Ty;function LI(){if(Ty)return Ry;Ty=1;var t=Le(),e=st(),r=kI(),n=co(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),Ry}LI();var _y={},fd,Oy;function FI(){if(Oy)return fd;Oy=1;var t=ao(),e=Rn().has,r=Ha(),n=uo(),i=xa(),o=lo(),s=yr();return fd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},fd}var My;function VI(){if(My)return _y;My=1;var t=Le(),e=FI(),r=co(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),_y}VI();var Iy={},gd,Py;function WI(){if(Py)return gd;Py=1;var t=ao(),e=Ha(),r=xa(),n=uo();return gd=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},gd}var xy;function $I(){if(xy)return Iy;xy=1;var t=Le(),e=WI(),r=co(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),Iy}$I();var Hy={},md,Ay;function BI(){if(Ay)return md;Ay=1;var t=ao(),e=Rn().has,r=Ha(),n=uo(),i=lo(),o=yr();return md=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},md}var Dy;function jI(){if(Dy)return Hy;Dy=1;var t=Le(),e=BI(),r=co(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Hy}jI();var Ny={},pd,ky;function zI(){if(ky)return pd;ky=1;var t=ao(),e=Rn(),r=um(),n=uo(),i=lo(),o=e.add,s=e.has,a=e.remove;return pd=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},pd}var wd,Ly;function IE(){return Ly||(Ly=1,wd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),wd}var Fy;function UI(){if(Fy)return Ny;Fy=1;var t=Le(),e=zI(),r=IE(),n=co(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Ny}UI();var Vy={},vd,Wy;function YI(){if(Wy)return vd;Wy=1;var t=ao(),e=Rn().add,r=um(),n=uo(),i=lo();return vd=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},vd}var $y;function qI(){if($y)return Vy;$y=1;var t=Le(),e=YI(),r=IE(),n=co(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),Vy}qI();var By={},jy={},yd,zy;function GI(){if(zy)return yd;zy=1;var t=Oa(),e=TypeError;return yd=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},yd}var bd,Uy;function KI(){if(Uy)return bd;Uy=1;var t=st();return bd=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),bd}var Cd,Yy;function PE(){if(Yy)return Cd;Yy=1;var t=Lr(),e=at(),r=ls(),n=om(),i=KI(),o=n("IE_PROTO"),s=Object,a=s.prototype;return Cd=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},Cd}var Sd,qy;function XI(){if(qy)return Sd;qy=1;var t=pE(),e=Ci();return Sd=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},Sd}var Rd={},Ed,Gy;function ZI(){if(Gy)return Ed;Gy=1;var t=wE(),e=lm();return Ed=Object.keys||function(n){return t(n,e)},Ed}var Ky;function QI(){if(Ky)return Rd;Ky=1;var t=Nr(),e=gE(),r=Ci(),n=wt(),i=_a(),o=ZI();return Rd.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},Rd}var Td,Xy;function xE(){if(Xy)return Td;Xy=1;var t=as();return Td=t("document","documentElement"),Td}var _d,Zy;function cm(){if(Zy)return _d;Zy=1;var t=wt(),e=QI(),r=lm(),n=sm(),i=xE(),o=im(),s=om(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(v){return l+c+a+v+l+"/"+c+a},w=function(v){v.write(g("")),v.close();var E=v.parentWindow.Object;return v=null,E},y=function(){var v=o("iframe"),E="java"+c+":",_;return v.style.display="none",i.appendChild(v),v.src=String(E),_=v.contentWindow.document,_.open(),_.write(g("document.F=Object")),_.close(),_.F},b,T=function(){try{b=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&b?w(b):y():w(b);for(var v=r.length;v--;)delete T[u][r[v]];return T()};return n[h]=!0,_d=Object.create||function(E,_){var M;return E!==null?(d[u]=t(E),M=new d,d[u]=null,M[h]=E):M=T(),_===void 0?M:e.f(M,_)},_d}var Od,Qy;function HE(){if(Qy)return Od;Qy=1;var t=st(),e=at(),r=kr(),n=cm(),i=PE(),o=am(),s=tn(),a=so(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),Od={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Od}var Jy;function JI(){if(Jy)return jy;Jy=1;var t=Le(),e=Je(),r=GI(),n=wt(),i=at(),o=PE(),s=XI(),a=ME(),l=st(),u=Lr(),c=tn(),h=HE().IteratorPrototype,d=Nr(),g=so(),w="constructor",y="Iterator",b=c("toStringTag"),T=TypeError,v=e[y],E=g||!i(v)||v.prototype!==h||!l(function(){v({})}),_=function(){if(r(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},M=function(P,x){d?s(h,P,{configurable:!0,get:function(){return x},set:function(F){if(n(this),this===h)throw new T("You can't redefine this property");u(this,P)?this[P]=F:a(this,P,F)}}):h[P]=x};return u(h,b)||M(b,y),(E||!u(h,w)||h[w]===Object)&&M(w,_),_.prototype=h,t({global:!0,constructor:!0,forced:E},{Iterator:_}),jy}var eb;function eP(){return eb||(eb=1,JI()),By}eP();var tb={},rb={},Md,nb;function tP(){if(nb)return Md;nb=1;var t=am();return Md=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},Md}var Id,ib;function rP(){return ib||(ib=1,Id=function(t,e){return{value:t,done:e}}),Id}var Pd,ob;function nP(){if(ob)return Pd;ob=1;var t=yr();return Pd=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},Pd}var xd,sb;function AE(){if(sb)return xd;sb=1;var t=pt(),e=cm(),r=us(),n=tP(),i=tn(),o=mE(),s=Ma(),a=HE().IteratorPrototype,l=rP(),u=yr(),c=nP(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",w="normal",y="throw",b=o.set,T=function(_){var M=o.getterFor(_?g:d);return n(e(a),{next:function(){var x=M(this);if(_)return x.nextHandler();if(x.done)return l(void 0,!0);try{var F=x.nextHandler();return x.returnHandlerResult?F:l(F,x.done)}catch(U){throw x.done=!0,U}},return:function(){var P=M(this),x=P.iterator;if(P.done=!0,_){var F=s(x,"return");return F?t(F,x):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,w)}catch(U){return u(x,y,U)}if(P.openIters)try{c(P.openIters,w)}catch(U){return u(x,y,U)}return x&&u(x,w),l(void 0,!0)}})},v=T(!0),E=T(!1);return r(E,h,"Iterator Helper"),xd=function(_,M,P){var x=function(U,H){H?(H.iterator=U.iterator,H.next=U.next):H=U,H.type=M?g:d,H.returnHandlerResult=!!P,H.nextHandler=_,H.counter=0,H.done=!1,b(this,H)};return x.prototype=M?v:E,x},xd}var Hd,ab;function DE(){if(ab)return Hd;ab=1;var t=wt(),e=yr();return Hd=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},Hd}var Ad,lb;function NE(){return lb||(lb=1,Ad=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),Ad}var Dd,ub;function ho(){if(ub)return Dd;ub=1;var t=Je();return Dd=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},Dd}var cb;function iP(){if(cb)return rb;cb=1;var t=Le(),e=pt(),r=vr(),n=wt(),i=Si(),o=AE(),s=DE(),a=so(),l=yr(),u=NE(),c=ho(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,w=o(function(){for(var y=this.iterator,b=this.predicate,T=this.next,v,E,_;;){if(v=n(e(T,y)),E=this.done=!!v.done,E)return;if(_=v.value,s(y,b,[_,this.counter++],!0))return _}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(T){l(this,"throw",T)}return d?e(d,this,b):new w(i(this),{predicate:b})}}),rb}var hb;function oP(){return hb||(hb=1,iP()),tb}oP();var db={},fb={},gb;function sP(){if(gb)return fb;gb=1;var t=Le(),e=pt(),r=hs(),n=vr(),i=wt(),o=Si(),s=yr(),a=ho(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),fb}var mb;function aP(){return mb||(mb=1,sP()),db}aP();var pb={},wb={},vb;function lP(){if(vb)return wb;vb=1;var t=Le(),e=pt(),r=vr(),n=wt(),i=Si(),o=AE(),s=DE(),a=yr(),l=NE(),u=ho(),c=so(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,w=o(function(){var y=this.iterator,b=n(e(this.next,y)),T=this.done=!!b.done;if(!T)return s(y,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(T){a(this,"throw",T)}return d?e(d,this,b):new w(i(this),{mapper:b})}}),wb}var yb;function uP(){return yb||(yb=1,lP()),pb}uP();var bb={},Cb={},Nd,Sb;function hm(){if(Sb)return Nd;Sb=1;var t=et();return Nd=t([].slice),Nd}var kd,Rb;function kE(){if(Rb)return kd;Rb=1;var t=TypeError;return kd=function(e,r){if(e<r)throw new t("Not enough arguments");return e},kd}var Ld,Eb;function cP(){if(Eb)return Ld;Eb=1;var t=_u();return Ld=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Ld}var Fd,Tb;function LE(){if(Tb)return Fd;Tb=1;var t=Je(),e=_u(),r=oo(),n=function(i){return e.slice(0,i.length)===i};return Fd=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),Fd}var Vd,_b;function hP(){if(_b)return Vd;_b=1;var t=LE();return Vd=t==="NODE",Vd}var Wd,Ob;function FE(){if(Ob)return Wd;Ob=1;var t=Je(),e=Pa(),r=TE(),n=at(),i=Lr(),o=st(),s=xE(),a=hm(),l=im(),u=kE(),c=cP(),h=hP(),d=t.setImmediate,g=t.clearImmediate,w=t.process,y=t.Dispatch,b=t.Function,T=t.MessageChannel,v=t.String,E=0,_={},M="onreadystatechange",P,x,F,U;o(function(){P=t.location});var H=function(q){if(i(_,q)){var ee=_[q];delete _[q],ee()}},G=function(q){return function(){H(q)}},J=function(q){H(q.data)},ae=function(q){t.postMessage(v(q),P.protocol+"//"+P.host)};return(!d||!g)&&(d=function(ee){u(arguments.length,1);var lt=n(ee)?ee:b(ee),Re=a(arguments,1);return _[++E]=function(){e(lt,void 0,Re)},x(E),E},g=function(ee){delete _[ee]},h?x=function(q){w.nextTick(G(q))}:y&&y.now?x=function(q){y.now(G(q))}:T&&!c?(F=new T,U=F.port2,F.port1.onmessage=J,x=r(U.postMessage,U)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!o(ae)?(x=ae,t.addEventListener("message",J,!1)):M in l("script")?x=function(q){s.appendChild(l("script"))[M]=function(){s.removeChild(this),H(q)}}:x=function(q){setTimeout(G(q),0)}),Wd={set:d,clear:g},Wd}var Mb;function dP(){if(Mb)return Cb;Mb=1;var t=Le(),e=Je(),r=FE().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),Cb}var Ib={},$d,Pb;function fP(){if(Pb)return $d;Pb=1;var t=Je(),e=Pa(),r=at(),n=LE(),i=_u(),o=hm(),s=kE(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return $d=function(u,c){var h=c?2:1;return l?function(d,g){var w=s(arguments.length,1)>h,y=r(d)?d:a(d),b=w?o(arguments,h):[],T=w?function(){e(y,this,b)}:y;return c?u(T,g):u(T)}:u},$d}var xb;function gP(){if(xb)return Ib;xb=1;var t=Le(),e=Je(),r=FE().set,n=fP(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Ib}var Hb;function mP(){return Hb||(Hb=1,dP(),gP()),bb}mP();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:VE,setPrototypeOf:Ab,isFrozen:pP,getPrototypeOf:wP,getOwnPropertyDescriptor:vP}=Object;let{freeze:Vt,seal:Dr,create:WE}=Object,{apply:lg,construct:ug}=typeof Reflect<"u"&&Reflect;Vt||(Vt=function(e){return e});Dr||(Dr=function(e){return e});lg||(lg=function(e,r,n){return e.apply(r,n)});ug||(ug=function(e,r){return new e(...r)});const Ya=Wt(Array.prototype.forEach),yP=Wt(Array.prototype.lastIndexOf),Db=Wt(Array.prototype.pop),Cs=Wt(Array.prototype.push),bP=Wt(Array.prototype.splice),Vl=Wt(String.prototype.toLowerCase),Bd=Wt(String.prototype.toString),Nb=Wt(String.prototype.match),Ss=Wt(String.prototype.replace),CP=Wt(String.prototype.indexOf),SP=Wt(String.prototype.trim),Gr=Wt(Object.prototype.hasOwnProperty),Ht=Wt(RegExp.prototype.test),Rs=RP(TypeError);function Wt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return lg(t,e,n)}}function RP(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ug(t,r)}}function he(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vl;Ab&&Ab(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(pP(e)||(e[n]=o),i=o)}t[i]=!0}return t}function EP(t){for(let e=0;e<t.length;e++)Gr(t,e)||(t[e]=null);return t}function Vn(t){const e=WE(null);for(const[r,n]of VE(t))Gr(t,r)&&(Array.isArray(n)?e[r]=EP(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Vn(n):e[r]=n);return e}function Es(t,e){for(;t!==null;){const n=vP(t,e);if(n){if(n.get)return Wt(n.get);if(typeof n.value=="function")return Wt(n.value)}t=wP(t)}function r(){return null}return r}const kb=Vt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jd=Vt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),zd=Vt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),TP=Vt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ud=Vt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),_P=Vt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Lb=Vt(["#text"]),Fb=Vt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Yd=Vt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Vb=Vt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),qa=Vt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),OP=Dr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),MP=Dr(/<%[\w\W]*|[\w\W]*%>/gm),IP=Dr(/\$\{[\w\W]*/gm),PP=Dr(/^data-[\-\w.\u00B7-\uFFFF]+$/),xP=Dr(/^aria-[\-\w]+$/),$E=Dr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),HP=Dr(/^(?:\w+script|data):/i),AP=Dr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),BE=Dr(/^html$/i),DP=Dr(/^[a-z][.\w]*(-[.\w]+)+$/i);var Wb=Object.freeze({__proto__:null,ARIA_ATTR:xP,ATTR_WHITESPACE:AP,CUSTOM_ELEMENT:DP,DATA_ATTR:PP,DOCTYPE_NAME:BE,ERB_EXPR:MP,IS_ALLOWED_URI:$E,IS_SCRIPT_OR_DATA:HP,MUSTACHE_EXPR:OP,TMPLIT_EXPR:IP});const Ts={element:1,text:3,progressingInstruction:7,comment:8,document:9},NP=function(){return typeof window>"u"?null:window},kP=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},$b=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function jE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NP();const e=K=>jE(K);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Ts.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,w=l.prototype,y=Es(w,"cloneNode"),b=Es(w,"remove"),T=Es(w,"nextSibling"),v=Es(w,"childNodes"),E=Es(w,"parentNode");if(typeof s=="function"){const K=r.createElement("template");K.content&&K.content.ownerDocument&&(r=K.content.ownerDocument)}let _,M="";const{implementation:P,createNodeIterator:x,createDocumentFragment:F,getElementsByTagName:U}=r,{importNode:H}=n;let G=$b();e.isSupported=typeof VE=="function"&&typeof E=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:ae,TMPLIT_EXPR:q,DATA_ATTR:ee,ARIA_ATTR:lt,IS_SCRIPT_OR_DATA:Re,ATTR_WHITESPACE:ve,CUSTOM_ELEMENT:qe}=Wb;let{IS_ALLOWED_URI:Be}=Wb,Oe=null;const Cr=he({},[...kb,...jd,...zd,...Ud,...Lb]);let f=null;const m=he({},[...Fb,...Yd,...Vb,...qa]);let p=Object.seal(WE(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),C=null,R=null,O=!0,I=!0,D=!1,j=!0,V=!1,A=!0,W=!1,te=!1,oe=!1,Me=!1,ye=!1,re=!1,Ee=!0,ce=!1;const Pe="user-content-";let Ge=!0,or=!1,sr={},St=null;const Sr=he({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ft=null;const $t=he({},["audio","video","img","source","image","track"]);let On=null;const ws=he({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ei="http://www.w3.org/1998/Math/MathML",Qn="http://www.w3.org/2000/svg",ut="http://www.w3.org/1999/xhtml";let $r=ut,on=!1,Mn=null;const Rr=he({},[Ei,Qn,ut],Bd);let Pt=he({},["mi","mo","mn","ms","mtext"]),Ti=he({},["annotation-xml"]);const za=he({},["title","style","font","a","script"]);let vs=null;const VO=["application/xhtml+xml","text/html"],WO="text/html";let gt=null,wo=null;const $O=r.createElement("form"),Jp=function(S){return S instanceof RegExp||S instanceof Function},hc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wo&&wo===S)){if((!S||typeof S!="object")&&(S={}),S=Vn(S),vs=VO.indexOf(S.PARSER_MEDIA_TYPE)===-1?WO:S.PARSER_MEDIA_TYPE,gt=vs==="application/xhtml+xml"?Bd:Vl,Oe=Gr(S,"ALLOWED_TAGS")?he({},S.ALLOWED_TAGS,gt):Cr,f=Gr(S,"ALLOWED_ATTR")?he({},S.ALLOWED_ATTR,gt):m,Mn=Gr(S,"ALLOWED_NAMESPACES")?he({},S.ALLOWED_NAMESPACES,Bd):Rr,On=Gr(S,"ADD_URI_SAFE_ATTR")?he(Vn(ws),S.ADD_URI_SAFE_ATTR,gt):ws,ft=Gr(S,"ADD_DATA_URI_TAGS")?he(Vn($t),S.ADD_DATA_URI_TAGS,gt):$t,St=Gr(S,"FORBID_CONTENTS")?he({},S.FORBID_CONTENTS,gt):Sr,C=Gr(S,"FORBID_TAGS")?he({},S.FORBID_TAGS,gt):Vn({}),R=Gr(S,"FORBID_ATTR")?he({},S.FORBID_ATTR,gt):Vn({}),sr=Gr(S,"USE_PROFILES")?S.USE_PROFILES:!1,O=S.ALLOW_ARIA_ATTR!==!1,I=S.ALLOW_DATA_ATTR!==!1,D=S.ALLOW_UNKNOWN_PROTOCOLS||!1,j=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,V=S.SAFE_FOR_TEMPLATES||!1,A=S.SAFE_FOR_XML!==!1,W=S.WHOLE_DOCUMENT||!1,Me=S.RETURN_DOM||!1,ye=S.RETURN_DOM_FRAGMENT||!1,re=S.RETURN_TRUSTED_TYPE||!1,oe=S.FORCE_BODY||!1,Ee=S.SANITIZE_DOM!==!1,ce=S.SANITIZE_NAMED_PROPS||!1,Ge=S.KEEP_CONTENT!==!1,or=S.IN_PLACE||!1,Be=S.ALLOWED_URI_REGEXP||$E,$r=S.NAMESPACE||ut,Pt=S.MATHML_TEXT_INTEGRATION_POINTS||Pt,Ti=S.HTML_INTEGRATION_POINTS||Ti,p=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&Jp(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(p.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&Jp(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(p.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(p.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),V&&(I=!1),ye&&(Me=!0),sr&&(Oe=he({},Lb),f=[],sr.html===!0&&(he(Oe,kb),he(f,Fb)),sr.svg===!0&&(he(Oe,jd),he(f,Yd),he(f,qa)),sr.svgFilters===!0&&(he(Oe,zd),he(f,Yd),he(f,qa)),sr.mathMl===!0&&(he(Oe,Ud),he(f,Vb),he(f,qa))),S.ADD_TAGS&&(Oe===Cr&&(Oe=Vn(Oe)),he(Oe,S.ADD_TAGS,gt)),S.ADD_ATTR&&(f===m&&(f=Vn(f)),he(f,S.ADD_ATTR,gt)),S.ADD_URI_SAFE_ATTR&&he(On,S.ADD_URI_SAFE_ATTR,gt),S.FORBID_CONTENTS&&(St===Sr&&(St=Vn(St)),he(St,S.FORBID_CONTENTS,gt)),Ge&&(Oe["#text"]=!0),W&&he(Oe,["html","head","body"]),Oe.table&&(he(Oe,["tbody"]),delete C.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Rs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Rs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=S.TRUSTED_TYPES_POLICY,M=_.createHTML("")}else _===void 0&&(_=kP(g,i)),_!==null&&typeof M=="string"&&(M=_.createHTML(""));Vt&&Vt(S),wo=S}},ew=he({},[...jd,...zd,...TP]),tw=he({},[...Ud,..._P]),BO=function(S){let k=E(S);(!k||!k.tagName)&&(k={namespaceURI:$r,tagName:"template"});const Y=Vl(S.tagName),je=Vl(k.tagName);return Mn[S.namespaceURI]?S.namespaceURI===Qn?k.namespaceURI===ut?Y==="svg":k.namespaceURI===Ei?Y==="svg"&&(je==="annotation-xml"||Pt[je]):!!ew[Y]:S.namespaceURI===Ei?k.namespaceURI===ut?Y==="math":k.namespaceURI===Qn?Y==="math"&&Ti[je]:!!tw[Y]:S.namespaceURI===ut?k.namespaceURI===Qn&&!Ti[je]||k.namespaceURI===Ei&&!Pt[je]?!1:!tw[Y]&&(za[Y]||!ew[Y]):!!(vs==="application/xhtml+xml"&&Mn[S.namespaceURI]):!1},sn=function(S){Cs(e.removed,{element:S});try{E(S).removeChild(S)}catch{b(S)}},vo=function(S,k){try{Cs(e.removed,{attribute:k.getAttributeNode(S),from:k})}catch{Cs(e.removed,{attribute:null,from:k})}if(k.removeAttribute(S),S==="is")if(Me||ye)try{sn(k)}catch{}else try{k.setAttribute(S,"")}catch{}},rw=function(S){let k=null,Y=null;if(oe)S="<remove></remove>"+S;else{const ct=Nb(S,/^[\r\n\t ]+/);Y=ct&&ct[0]}vs==="application/xhtml+xml"&&$r===ut&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const je=_?_.createHTML(S):S;if($r===ut)try{k=new d().parseFromString(je,vs)}catch{}if(!k||!k.documentElement){k=P.createDocument($r,"template",null);try{k.documentElement.innerHTML=on?M:je}catch{}}const Rt=k.body||k.documentElement;return S&&Y&&Rt.insertBefore(r.createTextNode(Y),Rt.childNodes[0]||null),$r===ut?U.call(k,W?"html":"body")[0]:W?k.documentElement:Rt},nw=function(S){return x.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},dc=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},iw=function(S){return typeof a=="function"&&S instanceof a};function In(K,S,k){Ya(K,Y=>{Y.call(e,S,k,wo)})}const ow=function(S){let k=null;if(In(G.beforeSanitizeElements,S,null),dc(S))return sn(S),!0;const Y=gt(S.nodeName);if(In(G.uponSanitizeElement,S,{tagName:Y,allowedTags:Oe}),A&&S.hasChildNodes()&&!iw(S.firstElementChild)&&Ht(/<[/\w!]/g,S.innerHTML)&&Ht(/<[/\w!]/g,S.textContent)||S.nodeType===Ts.progressingInstruction||A&&S.nodeType===Ts.comment&&Ht(/<[/\w]/g,S.data))return sn(S),!0;if(!Oe[Y]||C[Y]){if(!C[Y]&&aw(Y)&&(p.tagNameCheck instanceof RegExp&&Ht(p.tagNameCheck,Y)||p.tagNameCheck instanceof Function&&p.tagNameCheck(Y)))return!1;if(Ge&&!St[Y]){const je=E(S)||S.parentNode,Rt=v(S)||S.childNodes;if(Rt&&je){const ct=Rt.length;for(let Bt=ct-1;Bt>=0;--Bt){const Pn=y(Rt[Bt],!0);Pn.__removalCount=(S.__removalCount||0)+1,je.insertBefore(Pn,T(S))}}}return sn(S),!0}return S instanceof l&&!BO(S)||(Y==="noscript"||Y==="noembed"||Y==="noframes")&&Ht(/<\/no(script|embed|frames)/i,S.innerHTML)?(sn(S),!0):(V&&S.nodeType===Ts.text&&(k=S.textContent,Ya([J,ae,q],je=>{k=Ss(k,je," ")}),S.textContent!==k&&(Cs(e.removed,{element:S.cloneNode()}),S.textContent=k)),In(G.afterSanitizeElements,S,null),!1)},sw=function(S,k,Y){if(Ee&&(k==="id"||k==="name")&&(Y in r||Y in $O))return!1;if(!(I&&!R[k]&&Ht(ee,k))){if(!(O&&Ht(lt,k))){if(!f[k]||R[k]){if(!(aw(S)&&(p.tagNameCheck instanceof RegExp&&Ht(p.tagNameCheck,S)||p.tagNameCheck instanceof Function&&p.tagNameCheck(S))&&(p.attributeNameCheck instanceof RegExp&&Ht(p.attributeNameCheck,k)||p.attributeNameCheck instanceof Function&&p.attributeNameCheck(k))||k==="is"&&p.allowCustomizedBuiltInElements&&(p.tagNameCheck instanceof RegExp&&Ht(p.tagNameCheck,Y)||p.tagNameCheck instanceof Function&&p.tagNameCheck(Y))))return!1}else if(!On[k]){if(!Ht(Be,Ss(Y,ve,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&S!=="script"&&CP(Y,"data:")===0&&ft[S])){if(!(D&&!Ht(Re,Ss(Y,ve,"")))){if(Y)return!1}}}}}}return!0},aw=function(S){return S!=="annotation-xml"&&Nb(S,qe)},lw=function(S){In(G.beforeSanitizeAttributes,S,null);const{attributes:k}=S;if(!k||dc(S))return;const Y={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:f,forceKeepAttr:void 0};let je=k.length;for(;je--;){const Rt=k[je],{name:ct,namespaceURI:Bt,value:Pn}=Rt,ys=gt(ct),fc=Pn;let Et=ct==="value"?fc:SP(fc);if(Y.attrName=ys,Y.attrValue=Et,Y.keepAttr=!0,Y.forceKeepAttr=void 0,In(G.uponSanitizeAttribute,S,Y),Et=Y.attrValue,ce&&(ys==="id"||ys==="name")&&(vo(ct,S),Et=Pe+Et),A&&Ht(/((--!?|])>)|<\/(style|title)/i,Et)){vo(ct,S);continue}if(Y.forceKeepAttr)continue;if(!Y.keepAttr){vo(ct,S);continue}if(!j&&Ht(/\/>/i,Et)){vo(ct,S);continue}V&&Ya([J,ae,q],cw=>{Et=Ss(Et,cw," ")});const uw=gt(S.nodeName);if(!sw(uw,ys,Et)){vo(ct,S);continue}if(_&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Bt)switch(g.getAttributeType(uw,ys)){case"TrustedHTML":{Et=_.createHTML(Et);break}case"TrustedScriptURL":{Et=_.createScriptURL(Et);break}}if(Et!==fc)try{Bt?S.setAttributeNS(Bt,ct,Et):S.setAttribute(ct,Et),dc(S)?sn(S):Db(e.removed)}catch{vo(ct,S)}}In(G.afterSanitizeAttributes,S,null)},jO=function K(S){let k=null;const Y=nw(S);for(In(G.beforeSanitizeShadowDOM,S,null);k=Y.nextNode();)In(G.uponSanitizeShadowNode,k,null),ow(k),lw(k),k.content instanceof o&&K(k.content);In(G.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(K){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,Y=null,je=null,Rt=null;if(on=!K,on&&(K="<!-->"),typeof K!="string"&&!iw(K))if(typeof K.toString=="function"){if(K=K.toString(),typeof K!="string")throw Rs("dirty is not a string, aborting")}else throw Rs("toString is not a function");if(!e.isSupported)return K;if(te||hc(S),e.removed=[],typeof K=="string"&&(or=!1),or){if(K.nodeName){const Pn=gt(K.nodeName);if(!Oe[Pn]||C[Pn])throw Rs("root node is forbidden and cannot be sanitized in-place")}}else if(K instanceof a)k=rw("<!---->"),Y=k.ownerDocument.importNode(K,!0),Y.nodeType===Ts.element&&Y.nodeName==="BODY"||Y.nodeName==="HTML"?k=Y:k.appendChild(Y);else{if(!Me&&!V&&!W&&K.indexOf("<")===-1)return _&&re?_.createHTML(K):K;if(k=rw(K),!k)return Me?null:re?M:""}k&&oe&&sn(k.firstChild);const ct=nw(or?K:k);for(;je=ct.nextNode();)ow(je),lw(je),je.content instanceof o&&jO(je.content);if(or)return K;if(Me){if(ye)for(Rt=F.call(k.ownerDocument);k.firstChild;)Rt.appendChild(k.firstChild);else Rt=k;return(f.shadowroot||f.shadowrootmode)&&(Rt=H.call(n,Rt,!0)),Rt}let Bt=W?k.outerHTML:k.innerHTML;return W&&Oe["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&Ht(BE,k.ownerDocument.doctype.name)&&(Bt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+Bt),V&&Ya([J,ae,q],Pn=>{Bt=Ss(Bt,Pn," ")}),_&&re?_.createHTML(Bt):Bt},e.setConfig=function(){let K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hc(K),te=!0},e.clearConfig=function(){wo=null,te=!1},e.isValidAttribute=function(K,S,k){wo||hc({});const Y=gt(K),je=gt(S);return sw(Y,je,k)},e.addHook=function(K,S){typeof S=="function"&&Cs(G[K],S)},e.removeHook=function(K,S){if(S!==void 0){const k=yP(G[K],S);return k===-1?void 0:bP(G[K],k,1)[0]}return Db(G[K])},e.removeHooks=function(K){G[K]=[]},e.removeAllHooks=function(){G=$b()},e}var LP=jE();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var zE;function L(){return zE.apply(null,arguments)}function FP(t){zE=t}function Jr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ki(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ce(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function dm(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ce(t,e))return!1;return!0}function Gt(t){return t===void 0}function qn(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Aa(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function UE(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function ci(t,e){for(var r in e)Ce(e,r)&&(t[r]=e[r]);return Ce(e,"toString")&&(t.toString=e.toString),Ce(e,"valueOf")&&(t.valueOf=e.valueOf),t}function En(t,e,r,n){return gT(t,e,r,n,!0).utc()}function VP(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function se(t){return t._pf==null&&(t._pf=VP()),t._pf}var cg;Array.prototype.some?cg=Array.prototype.some:cg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function fm(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=se(t),r=cg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Iu(t){var e=En(NaN);return t!=null?ci(se(e),t):se(e).userInvalidated=!0,e}var Bb=L.momentProperties=[],qd=!1;function gm(t,e){var r,n,i,o=Bb.length;if(Gt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Gt(e._i)||(t._i=e._i),Gt(e._f)||(t._f=e._f),Gt(e._l)||(t._l=e._l),Gt(e._strict)||(t._strict=e._strict),Gt(e._tzm)||(t._tzm=e._tzm),Gt(e._isUTC)||(t._isUTC=e._isUTC),Gt(e._offset)||(t._offset=e._offset),Gt(e._pf)||(t._pf=se(e)),Gt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=Bb[r],i=e[n],Gt(i)||(t[n]=i);return t}function Da(t){gm(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),qd===!1&&(qd=!0,L.updateOffset(this),qd=!1)}function en(t){return t instanceof Da||t!=null&&t._isAMomentObject!=null}function YE(t){L.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Fr(t,e){var r=!0;return ci(function(){if(L.deprecationHandler!=null&&L.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Ce(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}YE(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var jb={};function qE(t,e){L.deprecationHandler!=null&&L.deprecationHandler(t,e),jb[t]||(YE(e),jb[t]=!0)}L.suppressDeprecationWarnings=!1;L.deprecationHandler=null;function Tn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function WP(t){var e,r;for(r in t)Ce(t,r)&&(e=t[r],Tn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function hg(t,e){var r=ci({},t),n;for(n in e)Ce(e,n)&&(Ki(t[n])&&Ki(e[n])?(r[n]={},ci(r[n],t[n]),ci(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Ce(t,n)&&!Ce(e,n)&&Ki(t[n])&&(r[n]=ci({},r[n]));return r}function mm(t){t!=null&&this.set(t)}var dg;Object.keys?dg=Object.keys:dg=function(t){var e,r=[];for(e in t)Ce(t,e)&&r.push(e);return r};var $P={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function BP(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Tn(n)?n.call(e,r):n}function yn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var pm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ga=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Gd={},Go={};function Z(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(Go[t]=i),e&&(Go[e[0]]=function(){return yn(i.apply(this,arguments),e[1],e[2])}),r&&(Go[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function jP(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function zP(t){var e=t.match(pm),r,n;for(r=0,n=e.length;r<n;r++)Go[e[r]]?e[r]=Go[e[r]]:e[r]=jP(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Tn(e[s])?e[s].call(i,t):e[s];return o}}function Wl(t,e){return t.isValid()?(e=GE(e,t.localeData()),Gd[e]=Gd[e]||zP(e),Gd[e](t)):t.localeData().invalidDate()}function GE(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Ga.lastIndex=0;r>=0&&Ga.test(t);)t=t.replace(Ga,n),Ga.lastIndex=0,r-=1;return t}var UP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function YP(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(pm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var qP="Invalid date";function GP(){return this._invalidDate}var KP="%d",XP=/\d{1,2}/;function ZP(t){return this._ordinal.replace("%d",t)}var QP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function JP(t,e,r,n){var i=this._relativeTime[r];return Tn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function ex(t,e){var r=this._relativeTime[t>0?"future":"past"];return Tn(r)?r(e):r.replace(/%s/i,e)}var zb={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Vr(t){return typeof t=="string"?zb[t]||zb[t.toLowerCase()]:void 0}function wm(t){var e={},r,n;for(n in t)Ce(t,n)&&(r=Vr(n),r&&(e[r]=t[n]));return e}var tx={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function rx(t){var e=[],r;for(r in t)Ce(t,r)&&e.push({unit:r,priority:tx[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var KE=/\d/,br=/\d\d/,XE=/\d{3}/,vm=/\d{4}/,Pu=/[+-]?\d{6}/,$e=/\d\d?/,ZE=/\d\d\d\d?/,QE=/\d\d\d\d\d\d?/,xu=/\d{1,3}/,ym=/\d{1,4}/,Hu=/[+-]?\d{1,6}/,ds=/\d+/,Au=/[+-]?\d+/,nx=/Z|[+-]\d\d:?\d\d/gi,Du=/Z|[+-]\d\d(?::?\d\d)?/gi,ix=/[+-]?\d+(\.\d{1,3})?/,Na=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,fs=/^[1-9]\d?/,bm=/^([1-9]\d|\d)/,nu;nu={};function B(t,e,r){nu[t]=Tn(e)?e:function(n,i){return n&&r?r:e}}function ox(t,e){return Ce(nu,t)?nu[t](e._strict,e._locale):new RegExp(sx(t))}function sx(t){return zn(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function zn(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Hr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ge(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Hr(e)),r}var fg={};function He(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),qn(e)&&(n=function(o,s){s[e]=ge(o)}),i=t.length,r=0;r<i;r++)fg[t[r]]=n}function ka(t,e){He(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function ax(t,e,r){e!=null&&Ce(fg,t)&&fg[t](e,r._a,r,t)}function Nu(t){return t%4===0&&t%100!==0||t%400===0}var It=0,Bn=1,mn=2,dt=3,Zr=4,jn=5,Ui=6,lx=7,ux=8;Z("Y",0,0,function(){var t=this.year();return t<=9999?yn(t,4):"+"+t});Z(0,["YY",2],0,function(){return this.year()%100});Z(0,["YYYY",4],0,"year");Z(0,["YYYYY",5],0,"year");Z(0,["YYYYYY",6,!0],0,"year");B("Y",Au);B("YY",$e,br);B("YYYY",ym,vm);B("YYYYY",Hu,Pu);B("YYYYYY",Hu,Pu);He(["YYYYY","YYYYYY"],It);He("YYYY",function(t,e){e[It]=t.length===2?L.parseTwoDigitYear(t):ge(t)});He("YY",function(t,e){e[It]=L.parseTwoDigitYear(t)});He("Y",function(t,e){e[It]=parseInt(t,10)});function la(t){return Nu(t)?366:365}L.parseTwoDigitYear=function(t){return ge(t)+(ge(t)>68?1900:2e3)};var JE=gs("FullYear",!0);function cx(){return Nu(this.year())}function gs(t,e){return function(r){return r!=null?(eT(this,t,r),L.updateOffset(this,e),this):pa(this,t)}}function pa(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function eT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!Nu(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function hx(t){return t=Vr(t),Tn(this[t])?this[t]():this}function dx(t,e){if(typeof t=="object"){t=wm(t);var r=rx(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Vr(t),Tn(this[t]))return this[t](e);return this}function fx(t,e){return(t%e+e)%e}var Qe;Array.prototype.indexOf?Qe=Array.prototype.indexOf:Qe=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Cm(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=fx(e,12);return t+=(e-r)/12,r===1?Nu(t)?29:28:31-r%7%2}Z("M",["MM",2],"Mo",function(){return this.month()+1});Z("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Z("MMMM",0,0,function(t){return this.localeData().months(this,t)});B("M",$e,fs);B("MM",$e,br);B("MMM",function(t,e){return e.monthsShortRegex(t)});B("MMMM",function(t,e){return e.monthsRegex(t)});He(["M","MM"],function(t,e){e[Bn]=ge(t)-1});He(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Bn]=i:se(r).invalidMonth=t});var gx="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,mx=Na,px=Na;function wx(t,e){return t?Jr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||rT).test(e)?"format":"standalone"][t.month()]:Jr(this._months)?this._months:this._months.standalone}function vx(t,e){return t?Jr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[rT.test(e)?"format":"standalone"][t.month()]:Jr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function yx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=En([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Qe.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:(i=Qe.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Qe.call(this._longMonthsParse,s),i!==-1?i:(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:null))}function bx(t,e,r){var n,i,o;if(this._monthsParseExact)return yx.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=En([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function nT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ge(e);else if(e=t.localeData().monthsParse(e),!qn(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,Cm(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function iT(t){return t!=null?(nT(this,t),L.updateOffset(this,!0),this):pa(this,"Month")}function Cx(){return Cm(this.year(),this.month())}function Sx(t){return this._monthsParseExact?(Ce(this,"_monthsRegex")||oT.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ce(this,"_monthsShortRegex")||(this._monthsShortRegex=mx),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Rx(t){return this._monthsParseExact?(Ce(this,"_monthsRegex")||oT.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ce(this,"_monthsRegex")||(this._monthsRegex=px),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function oT(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=En([2e3,i]),s=zn(this.monthsShort(o,"")),a=zn(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Ex(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function wa(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function iu(t,e,r){var n=7+e-r,i=(7+wa(t,0,n).getUTCDay()-e)%7;return-i+n-1}function sT(t,e,r,n,i){var o=(7+r-n)%7,s=iu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=la(l)+a):a>la(t)?(l=t+1,u=a-la(t)):(l=t,u=a),{year:l,dayOfYear:u}}function va(t,e,r){var n=iu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Un(s,e,r)):i>Un(t.year(),e,r)?(o=i-Un(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Un(t,e,r){var n=iu(t,e,r),i=iu(t+1,e,r);return(la(t)-n+i)/7}Z("w",["ww",2],"wo","week");Z("W",["WW",2],"Wo","isoWeek");B("w",$e,fs);B("ww",$e,br);B("W",$e,fs);B("WW",$e,br);ka(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=ge(t)});function Tx(t){return va(t,this._week.dow,this._week.doy).week}var _x={dow:0,doy:6};function Ox(){return this._week.dow}function Mx(){return this._week.doy}function Ix(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Px(t){var e=va(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Z("d",0,"do","day");Z("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Z("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Z("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Z("e",0,0,"weekday");Z("E",0,0,"isoWeekday");B("d",$e);B("e",$e);B("E",$e);B("dd",function(t,e){return e.weekdaysMinRegex(t)});B("ddd",function(t,e){return e.weekdaysShortRegex(t)});B("dddd",function(t,e){return e.weekdaysRegex(t)});ka(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:se(r).invalidWeekday=t});ka(["d","e","E"],function(t,e,r,n){e[n]=ge(t)});function xx(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Hx(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Sm(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Ax="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),aT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Dx="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Nx=Na,kx=Na,Lx=Na;function Fx(t,e){var r=Jr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Sm(r,this._week.dow):t?r[t.day()]:r}function Vx(t){return t===!0?Sm(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Wx(t){return t===!0?Sm(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function $x(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=En([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Qe.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Qe.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Qe.call(this._weekdaysParse,s),i!==-1||(i=Qe.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Qe.call(this._shortWeekdaysParse,s),i!==-1||(i=Qe.call(this._weekdaysParse,s),i!==-1)?i:(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Qe.call(this._minWeekdaysParse,s),i!==-1||(i=Qe.call(this._weekdaysParse,s),i!==-1)?i:(i=Qe.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function Bx(t,e,r){var n,i,o;if(this._weekdaysParseExact)return $x.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=En([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function jx(t){if(!this.isValid())return t!=null?this:NaN;var e=pa(this,"Day");return t!=null?(t=xx(t,this.localeData()),this.add(t-e,"d")):e}function zx(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Ux(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Hx(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Yx(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||Rm.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ce(this,"_weekdaysRegex")||(this._weekdaysRegex=Nx),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function qx(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||Rm.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ce(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=kx),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Gx(t){return this._weekdaysParseExact?(Ce(this,"_weekdaysRegex")||Rm.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ce(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Lx),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Rm(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=En([2e3,1]).day(o),a=zn(this.weekdaysMin(s,"")),l=zn(this.weekdaysShort(s,"")),u=zn(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Em(){return this.hours()%12||12}function Kx(){return this.hours()||24}Z("H",["HH",2],0,"hour");Z("h",["hh",2],0,Em);Z("k",["kk",2],0,Kx);Z("hmm",0,0,function(){return""+Em.apply(this)+yn(this.minutes(),2)});Z("hmmss",0,0,function(){return""+Em.apply(this)+yn(this.minutes(),2)+yn(this.seconds(),2)});Z("Hmm",0,0,function(){return""+this.hours()+yn(this.minutes(),2)});Z("Hmmss",0,0,function(){return""+this.hours()+yn(this.minutes(),2)+yn(this.seconds(),2)});function lT(t,e){Z(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}lT("a",!0);lT("A",!1);function uT(t,e){return e._meridiemParse}B("a",uT);B("A",uT);B("H",$e,bm);B("h",$e,fs);B("k",$e,fs);B("HH",$e,br);B("hh",$e,br);B("kk",$e,br);B("hmm",ZE);B("hmmss",QE);B("Hmm",ZE);B("Hmmss",QE);He(["H","HH"],dt);He(["k","kk"],function(t,e,r){var n=ge(t);e[dt]=n===24?0:n});He(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});He(["h","hh"],function(t,e,r){e[dt]=ge(t),se(r).bigHour=!0});He("hmm",function(t,e,r){var n=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n)),se(r).bigHour=!0});He("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n,2)),e[jn]=ge(t.substr(i)),se(r).bigHour=!0});He("Hmm",function(t,e,r){var n=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n))});He("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n,2)),e[jn]=ge(t.substr(i))});function Xx(t){return(t+"").toLowerCase().charAt(0)==="p"}var Zx=/[ap]\.?m?\.?/i,Qx=gs("Hours",!0);function Jx(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var cT={calendar:$P,longDateFormat:UP,invalidDate:qP,ordinal:KP,dayOfMonthOrdinalParse:XP,relativeTime:QP,months:gx,monthsShort:tT,week:_x,weekdays:Ax,weekdaysMin:Dx,weekdaysShort:aT,meridiemParse:Zx},ze={},_s={},ya;function eH(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function Ub(t){return t&&t.toLowerCase().replace("_","-")}function tH(t){for(var e=0,r,n,i,o;e<t.length;){for(o=Ub(t[e]).split("-"),r=o.length,n=Ub(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=ku(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&eH(o,n)>=r-1)break;r--}e++}return ya}function rH(t){return!!(t&&t.match("^[^/\\\\]*$"))}function ku(t){var e=null,r;if(ze[t]===void 0&&typeof Kl<"u"&&Kl&&Kl.exports&&rH(t))try{e=ya._abbr,r=require,r("./locale/"+t),mi(e)}catch{ze[t]=null}return ze[t]}function mi(t,e){var r;return t&&(Gt(e)?r=Gn(t):r=Tm(t,e),r?ya=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),ya._abbr}function Tm(t,e){if(e!==null){var r,n=cT;if(e.abbr=t,ze[t]!=null)qE("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ze[t]._config;else if(e.parentLocale!=null)if(ze[e.parentLocale]!=null)n=ze[e.parentLocale]._config;else if(r=ku(e.parentLocale),r!=null)n=r._config;else return _s[e.parentLocale]||(_s[e.parentLocale]=[]),_s[e.parentLocale].push({name:t,config:e}),null;return ze[t]=new mm(hg(n,e)),_s[t]&&_s[t].forEach(function(i){Tm(i.name,i.config)}),mi(t),ze[t]}else return delete ze[t],null}function nH(t,e){if(e!=null){var r,n,i=cT;ze[t]!=null&&ze[t].parentLocale!=null?ze[t].set(hg(ze[t]._config,e)):(n=ku(t),n!=null&&(i=n._config),e=hg(i,e),n==null&&(e.abbr=t),r=new mm(e),r.parentLocale=ze[t],ze[t]=r),mi(t)}else ze[t]!=null&&(ze[t].parentLocale!=null?(ze[t]=ze[t].parentLocale,t===mi()&&mi(t)):ze[t]!=null&&delete ze[t]);return ze[t]}function Gn(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return ya;if(!Jr(t)){if(e=ku(t),e)return e;t=[t]}return tH(t)}function iH(){return dg(ze)}function _m(t){var e,r=t._a;return r&&se(t).overflow===-2&&(e=r[Bn]<0||r[Bn]>11?Bn:r[mn]<1||r[mn]>Cm(r[It],r[Bn])?mn:r[dt]<0||r[dt]>24||r[dt]===24&&(r[Zr]!==0||r[jn]!==0||r[Ui]!==0)?dt:r[Zr]<0||r[Zr]>59?Zr:r[jn]<0||r[jn]>59?jn:r[Ui]<0||r[Ui]>999?Ui:-1,se(t)._overflowDayOfYear&&(e<It||e>mn)&&(e=mn),se(t)._overflowWeeks&&e===-1&&(e=lx),se(t)._overflowWeekday&&e===-1&&(e=ux),se(t).overflow=e),t}var oH=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,sH=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,aH=/Z|[+-]\d\d(?::?\d\d)?/,Ka=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Kd=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],lH=/^\/?Date\((-?\d+)/i,uH=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,cH={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function hT(t){var e,r,n=t._i,i=oH.exec(n)||sH.exec(n),o,s,a,l,u=Ka.length,c=Kd.length;if(i){for(se(t).iso=!0,e=0,r=u;e<r;e++)if(Ka[e][1].exec(i[1])){s=Ka[e][0],o=Ka[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(Kd[e][1].exec(i[3])){a=(i[2]||" ")+Kd[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(aH.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Mm(t)}else t._isValid=!1}function hH(t,e,r,n,i,o){var s=[dH(t),tT.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function dH(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function fH(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function gH(t,e,r){if(t){var n=aT.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return se(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function mH(t,e,r){if(t)return cH[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function dT(t){var e=uH.exec(fH(t._i)),r;if(e){if(r=hH(e[4],e[3],e[2],e[5],e[6],e[7]),!gH(e[1],r,t))return;t._a=r,t._tzm=mH(e[8],e[9],e[10]),t._d=wa.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),se(t).rfc2822=!0}else t._isValid=!1}function pH(t){var e=lH.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(hT(t),t._isValid===!1)delete t._isValid;else return;if(dT(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:L.createFromInputFallback(t)}L.createFromInputFallback=Fr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function $o(t,e,r){return t??e??r}function wH(t){var e=new Date(L.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Om(t){var e,r,n=[],i,o,s;if(!t._d){for(i=wH(t),t._w&&t._a[mn]==null&&t._a[Bn]==null&&vH(t),t._dayOfYear!=null&&(s=$o(t._a[It],i[It]),(t._dayOfYear>la(s)||t._dayOfYear===0)&&(se(t)._overflowDayOfYear=!0),r=wa(s,0,t._dayOfYear),t._a[Bn]=r.getUTCMonth(),t._a[mn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[dt]===24&&t._a[Zr]===0&&t._a[jn]===0&&t._a[Ui]===0&&(t._nextDay=!0,t._a[dt]=0),t._d=(t._useUTC?wa:Ex).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[dt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(se(t).weekdayMismatch=!0)}}function vH(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=$o(e.GG,t._a[It],va(We(),1,4).year),n=$o(e.W,1),i=$o(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=va(We(),o,s),r=$o(e.gg,t._a[It],u.year),n=$o(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>Un(r,o,s)?se(t)._overflowWeeks=!0:l!=null?se(t)._overflowWeekday=!0:(a=sT(r,n,i,o,s),t._a[It]=a.year,t._dayOfYear=a.dayOfYear)}L.ISO_8601=function(){};L.RFC_2822=function(){};function Mm(t){if(t._f===L.ISO_8601){hT(t);return}if(t._f===L.RFC_2822){dT(t);return}t._a=[],se(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=GE(t._f,t._locale).match(pm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(ox(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&se(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Go[o]?(n?se(t).empty=!1:se(t).unusedTokens.push(o),ax(o,n,t)):t._strict&&!n&&se(t).unusedTokens.push(o);se(t).charsLeftOver=a-l,e.length>0&&se(t).unusedInput.push(e),t._a[dt]<=12&&se(t).bigHour===!0&&t._a[dt]>0&&(se(t).bigHour=void 0),se(t).parsedDateParts=t._a.slice(0),se(t).meridiem=t._meridiem,t._a[dt]=yH(t._locale,t._a[dt],t._meridiem),u=se(t).era,u!==null&&(t._a[It]=t._locale.erasConvertYear(u,t._a[It])),Om(t),_m(t)}function yH(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function bH(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){se(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=gm({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Mm(e),fm(e)&&(s=!0),o+=se(e).charsLeftOver,o+=se(e).unusedTokens.length*10,se(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));ci(t,r||e)}function CH(t){if(!t._d){var e=wm(t._i),r=e.day===void 0?e.date:e.day;t._a=UE([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),Om(t)}}function SH(t){var e=new Da(_m(fT(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function fT(t){var e=t._i,r=t._f;return t._locale=t._locale||Gn(t._l),e===null||r===void 0&&e===""?Iu({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),en(e)?new Da(_m(e)):(Aa(e)?t._d=e:Jr(r)?bH(t):r?Mm(t):RH(t),fm(t)||(t._d=null),t))}function RH(t){var e=t._i;Gt(e)?t._d=new Date(L.now()):Aa(e)?t._d=new Date(e.valueOf()):typeof e=="string"?pH(t):Jr(e)?(t._a=UE(e.slice(0),function(r){return parseInt(r,10)}),Om(t)):Ki(e)?CH(t):qn(e)?t._d=new Date(e):L.createFromInputFallback(t)}function gT(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ki(t)&&dm(t)||Jr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,SH(o)}function We(t,e,r,n){return gT(t,e,r,n,!1)}var EH=Fr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=We.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Iu()}),TH=Fr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=We.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Iu()});function mT(t,e){var r,n;if(e.length===1&&Jr(e[0])&&(e=e[0]),!e.length)return We();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function _H(){var t=[].slice.call(arguments,0);return mT("isBefore",t)}function OH(){var t=[].slice.call(arguments,0);return mT("isAfter",t)}var MH=function(){return Date.now?Date.now():+new Date},Os=["year","quarter","month","week","day","hour","minute","second","millisecond"];function IH(t){var e,r=!1,n,i=Os.length;for(e in t)if(Ce(t,e)&&!(Qe.call(Os,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Os[n]]){if(r)return!1;parseFloat(t[Os[n]])!==ge(t[Os[n]])&&(r=!0)}return!0}function PH(){return this._isValid}function xH(){return rn(NaN)}function Lu(t){var e=wm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=IH(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Gn(),this._bubble()}function $l(t){return t instanceof Lu}function gg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function HH(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)ge(t[s])!==ge(e[s])&&o++;return o+i}function pT(t,e){Z(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+yn(~~(r/60),2)+e+yn(~~r%60,2)})}pT("Z",":");pT("ZZ","");B("Z",Du);B("ZZ",Du);He(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=Im(Du,t)});var AH=/([\+\-]|\d\d)/gi;function Im(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(AH)||["-",0,0],o=+(i[1]*60)+ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function Pm(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(en(t)||Aa(t)?t.valueOf():We(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),L.updateOffset(r,!1),r):We(t).local()}function mg(t){return-Math.round(t._d.getTimezoneOffset())}L.updateOffset=function(){};function DH(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Im(Du,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=mg(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?yT(this,rn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,L.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:mg(this)}function NH(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function kH(t){return this.utcOffset(0,t)}function LH(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(mg(this),"m")),this}function FH(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Im(nx,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function VH(t){return this.isValid()?(t=t?We(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function WH(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function $H(){if(!Gt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return gm(t,this),t=fT(t),t._a?(e=t._isUTC?En(t._a):We(t._a),this._isDSTShifted=this.isValid()&&HH(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function BH(){return this.isValid()?!this._isUTC:!1}function jH(){return this.isValid()?this._isUTC:!1}function wT(){return this.isValid()?this._isUTC&&this._offset===0:!1}var zH=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,UH=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function rn(t,e){var r=t,n=null,i,o,s;return $l(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:qn(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=zH.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:ge(n[mn])*i,h:ge(n[dt])*i,m:ge(n[Zr])*i,s:ge(n[jn])*i,ms:ge(gg(n[Ui]*1e3))*i}):(n=UH.exec(t))?(i=n[1]==="-"?-1:1,r={y:_i(n[2],i),M:_i(n[3],i),w:_i(n[4],i),d:_i(n[5],i),h:_i(n[6],i),m:_i(n[7],i),s:_i(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=YH(We(r.from),We(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Lu(r),$l(t)&&Ce(t,"_locale")&&(o._locale=t._locale),$l(t)&&Ce(t,"_isValid")&&(o._isValid=t._isValid),o}rn.fn=Lu.prototype;rn.invalid=xH;function _i(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function Yb(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function YH(t,e){var r;return t.isValid()&&e.isValid()?(e=Pm(e,t),t.isBefore(e)?r=Yb(t,e):(r=Yb(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function vT(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(qE(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=rn(r,n),yT(this,i,t),this}}function yT(t,e,r,n){var i=e._milliseconds,o=gg(e._days),s=gg(e._months);t.isValid()&&(n=n??!0,s&&nT(t,pa(t,"Month")+s*r),o&&eT(t,"Date",pa(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&L.updateOffset(t,o||s))}var qH=vT(1,"add"),GH=vT(-1,"subtract");function bT(t){return typeof t=="string"||t instanceof String}function KH(t){return en(t)||Aa(t)||bT(t)||qn(t)||ZH(t)||XH(t)||t===null||t===void 0}function XH(t){var e=Ki(t)&&!dm(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Ce(t,o);return e&&r}function ZH(t){var e=Jr(t),r=!1;return e&&(r=t.filter(function(n){return!qn(n)&&bT(t)}).length===0),e&&r}function QH(t){var e=Ki(t)&&!dm(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Ce(t,o);return e&&r}function JH(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function e1(t,e){arguments.length===1&&(arguments[0]?KH(arguments[0])?(t=arguments[0],e=void 0):QH(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||We(),n=Pm(r,this).startOf("day"),i=L.calendarFormat(this,n)||"sameElse",o=e&&(Tn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,We(r)))}function t1(){return new Da(this)}function r1(t,e){var r=en(t)?t:We(t);return this.isValid()&&r.isValid()?(e=Vr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function n1(t,e){var r=en(t)?t:We(t);return this.isValid()&&r.isValid()?(e=Vr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function i1(t,e,r,n){var i=en(t)?t:We(t),o=en(e)?e:We(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function o1(t,e){var r=en(t)?t:We(t),n;return this.isValid()&&r.isValid()?(e=Vr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function s1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function a1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function l1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=Pm(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Vr(e),e){case"year":o=Bl(this,n)/12;break;case"month":o=Bl(this,n);break;case"quarter":o=Bl(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Hr(o)}function Bl(t,e){if(t.date()<e.date())return-Bl(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}L.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";L.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function u1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function c1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Wl(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Tn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Wl(r,"Z")):Wl(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function h1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function d1(t){t||(t=this.isUtc()?L.defaultFormatUtc:L.defaultFormat);var e=Wl(this,t);return this.localeData().postformat(e)}function f1(t,e){return this.isValid()&&(en(t)&&t.isValid()||We(t).isValid())?rn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function g1(t){return this.from(We(),t)}function m1(t,e){return this.isValid()&&(en(t)&&t.isValid()||We(t).isValid())?rn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function p1(t){return this.to(We(),t)}function CT(t){var e;return t===void 0?this._locale._abbr:(e=Gn(t),e!=null&&(this._locale=e),this)}var ST=Fr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function RT(){return this._locale}var ou=1e3,Ko=60*ou,su=60*Ko,ET=(365*400+97)*24*su;function Xo(t,e){return(t%e+e)%e}function TT(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-ET:new Date(t,e,r).valueOf()}function _T(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-ET:Date.UTC(t,e,r)}function w1(t){var e,r;if(t=Vr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?_T:TT,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Xo(e+(this._isUTC?0:this.utcOffset()*Ko),su);break;case"minute":e=this._d.valueOf(),e-=Xo(e,Ko);break;case"second":e=this._d.valueOf(),e-=Xo(e,ou);break}return this._d.setTime(e),L.updateOffset(this,!0),this}function v1(t){var e,r;if(t=Vr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?_T:TT,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=su-Xo(e+(this._isUTC?0:this.utcOffset()*Ko),su)-1;break;case"minute":e=this._d.valueOf(),e+=Ko-Xo(e,Ko)-1;break;case"second":e=this._d.valueOf(),e+=ou-Xo(e,ou)-1;break}return this._d.setTime(e),L.updateOffset(this,!0),this}function y1(){return this._d.valueOf()-(this._offset||0)*6e4}function b1(){return Math.floor(this.valueOf()/1e3)}function C1(){return new Date(this.valueOf())}function S1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function R1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function E1(){return this.isValid()?this.toISOString():null}function T1(){return fm(this)}function _1(){return ci({},se(this))}function O1(){return se(this).overflow}function M1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Z("N",0,0,"eraAbbr");Z("NN",0,0,"eraAbbr");Z("NNN",0,0,"eraAbbr");Z("NNNN",0,0,"eraName");Z("NNNNN",0,0,"eraNarrow");Z("y",["y",1],"yo","eraYear");Z("y",["yy",2],0,"eraYear");Z("y",["yyy",3],0,"eraYear");Z("y",["yyyy",4],0,"eraYear");B("N",xm);B("NN",xm);B("NNN",xm);B("NNNN",V1);B("NNNNN",W1);He(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?se(r).era=i:se(r).invalidEra=t});B("y",ds);B("yy",ds);B("yyy",ds);B("yyyy",ds);B("yo",$1);He(["y","yy","yyy","yyyy"],It);He(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[It]=r._locale.eraYearOrdinalParse(t,i):e[It]=parseInt(t,10)});function I1(t,e){var r,n,i,o=this._eras||Gn("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=L(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=L(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function P1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function x1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?L(t.since).year():L(t.since).year()+(e-t.offset)*r}function H1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function A1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function D1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function N1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-L(i[t].since).year())*r+i[t].offset;return this.year()}function k1(t){return Ce(this,"_erasNameRegex")||Hm.call(this),t?this._erasNameRegex:this._erasRegex}function L1(t){return Ce(this,"_erasAbbrRegex")||Hm.call(this),t?this._erasAbbrRegex:this._erasRegex}function F1(t){return Ce(this,"_erasNarrowRegex")||Hm.call(this),t?this._erasNarrowRegex:this._erasRegex}function xm(t,e){return e.erasAbbrRegex(t)}function V1(t,e){return e.erasNameRegex(t)}function W1(t,e){return e.erasNarrowRegex(t)}function $1(t,e){return e._eraYearOrdinalRegex||ds}function Hm(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=zn(u[i].name),a=zn(u[i].abbr),l=zn(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Z(0,["gg",2],0,function(){return this.weekYear()%100});Z(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Fu(t,e){Z(0,[t,t.length],0,e)}Fu("gggg","weekYear");Fu("ggggg","weekYear");Fu("GGGG","isoWeekYear");Fu("GGGGG","isoWeekYear");B("G",Au);B("g",Au);B("GG",$e,br);B("gg",$e,br);B("GGGG",ym,vm);B("gggg",ym,vm);B("GGGGG",Hu,Pu);B("ggggg",Hu,Pu);ka(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=ge(t)});ka(["gg","GG"],function(t,e,r,n){e[n]=L.parseTwoDigitYear(t)});function B1(t){return OT.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function j1(t){return OT.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function z1(){return Un(this.year(),1,4)}function U1(){return Un(this.isoWeekYear(),1,4)}function Y1(){var t=this.localeData()._week;return Un(this.year(),t.dow,t.doy)}function q1(){var t=this.localeData()._week;return Un(this.weekYear(),t.dow,t.doy)}function OT(t,e,r,n,i){var o;return t==null?va(this,n,i).year:(o=Un(t,n,i),e>o&&(e=o),G1.call(this,t,e,r,n,i))}function G1(t,e,r,n,i){var o=sT(t,e,r,n,i),s=wa(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Z("Q",0,"Qo","quarter");B("Q",KE);He("Q",function(t,e){e[Bn]=(ge(t)-1)*3});function K1(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Z("D",["DD",2],"Do","date");B("D",$e,fs);B("DD",$e,br);B("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});He(["D","DD"],mn);He("Do",function(t,e){e[mn]=ge(t.match($e)[0])});var MT=gs("Date",!0);Z("DDD",["DDDD",3],"DDDo","dayOfYear");B("DDD",xu);B("DDDD",XE);He(["DDD","DDDD"],function(t,e,r){r._dayOfYear=ge(t)});function X1(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Z("m",["mm",2],0,"minute");B("m",$e,bm);B("mm",$e,br);He(["m","mm"],Zr);var Z1=gs("Minutes",!1);Z("s",["ss",2],0,"second");B("s",$e,bm);B("ss",$e,br);He(["s","ss"],jn);var Q1=gs("Seconds",!1);Z("S",0,0,function(){return~~(this.millisecond()/100)});Z(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Z(0,["SSS",3],0,"millisecond");Z(0,["SSSS",4],0,function(){return this.millisecond()*10});Z(0,["SSSSS",5],0,function(){return this.millisecond()*100});Z(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Z(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Z(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Z(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});B("S",xu,KE);B("SS",xu,br);B("SSS",xu,XE);var hi,IT;for(hi="SSSS";hi.length<=9;hi+="S")B(hi,ds);function J1(t,e){e[Ui]=ge(("0."+t)*1e3)}for(hi="S";hi.length<=9;hi+="S")He(hi,J1);IT=gs("Milliseconds",!1);Z("z",0,0,"zoneAbbr");Z("zz",0,0,"zoneName");function eA(){return this._isUTC?"UTC":""}function tA(){return this._isUTC?"Coordinated Universal Time":""}var N=Da.prototype;N.add=qH;N.calendar=e1;N.clone=t1;N.diff=l1;N.endOf=v1;N.format=d1;N.from=f1;N.fromNow=g1;N.to=m1;N.toNow=p1;N.get=hx;N.invalidAt=O1;N.isAfter=r1;N.isBefore=n1;N.isBetween=i1;N.isSame=o1;N.isSameOrAfter=s1;N.isSameOrBefore=a1;N.isValid=T1;N.lang=ST;N.locale=CT;N.localeData=RT;N.max=TH;N.min=EH;N.parsingFlags=_1;N.set=dx;N.startOf=w1;N.subtract=GH;N.toArray=S1;N.toObject=R1;N.toDate=C1;N.toISOString=c1;N.inspect=h1;typeof Symbol<"u"&&Symbol.for!=null&&(N[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});N.toJSON=E1;N.toString=u1;N.unix=b1;N.valueOf=y1;N.creationData=M1;N.eraName=H1;N.eraNarrow=A1;N.eraAbbr=D1;N.eraYear=N1;N.year=JE;N.isLeapYear=cx;N.weekYear=B1;N.isoWeekYear=j1;N.quarter=N.quarters=K1;N.month=iT;N.daysInMonth=Cx;N.week=N.weeks=Ix;N.isoWeek=N.isoWeeks=Px;N.weeksInYear=Y1;N.weeksInWeekYear=q1;N.isoWeeksInYear=z1;N.isoWeeksInISOWeekYear=U1;N.date=MT;N.day=N.days=jx;N.weekday=zx;N.isoWeekday=Ux;N.dayOfYear=X1;N.hour=N.hours=Qx;N.minute=N.minutes=Z1;N.second=N.seconds=Q1;N.millisecond=N.milliseconds=IT;N.utcOffset=DH;N.utc=kH;N.local=LH;N.parseZone=FH;N.hasAlignedHourOffset=VH;N.isDST=WH;N.isLocal=BH;N.isUtcOffset=jH;N.isUtc=wT;N.isUTC=wT;N.zoneAbbr=eA;N.zoneName=tA;N.dates=Fr("dates accessor is deprecated. Use date instead.",MT);N.months=Fr("months accessor is deprecated. Use month instead",iT);N.years=Fr("years accessor is deprecated. Use year instead",JE);N.zone=Fr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",NH);N.isDSTShifted=Fr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",$H);function rA(t){return We(t*1e3)}function nA(){return We.apply(null,arguments).parseZone()}function PT(t){return t}var Se=mm.prototype;Se.calendar=BP;Se.longDateFormat=YP;Se.invalidDate=GP;Se.ordinal=ZP;Se.preparse=PT;Se.postformat=PT;Se.relativeTime=JP;Se.pastFuture=ex;Se.set=WP;Se.eras=I1;Se.erasParse=P1;Se.erasConvertYear=x1;Se.erasAbbrRegex=L1;Se.erasNameRegex=k1;Se.erasNarrowRegex=F1;Se.months=wx;Se.monthsShort=vx;Se.monthsParse=bx;Se.monthsRegex=Rx;Se.monthsShortRegex=Sx;Se.week=Tx;Se.firstDayOfYear=Mx;Se.firstDayOfWeek=Ox;Se.weekdays=Fx;Se.weekdaysMin=Wx;Se.weekdaysShort=Vx;Se.weekdaysParse=Bx;Se.weekdaysRegex=Yx;Se.weekdaysShortRegex=qx;Se.weekdaysMinRegex=Gx;Se.isPM=Xx;Se.meridiem=Jx;function au(t,e,r,n){var i=Gn(),o=En().set(n,e);return i[r](o,t)}function xT(t,e,r){if(qn(t)&&(e=t,t=void 0),t=t||"",e!=null)return au(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=au(t,n,r,"month");return i}function Am(t,e,r,n){typeof t=="boolean"?(qn(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,qn(e)&&(r=e,e=void 0),e=e||"");var i=Gn(),o=t?i._week.dow:0,s,a=[];if(r!=null)return au(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=au(e,(s+o)%7,n,"day");return a}function iA(t,e){return xT(t,e,"months")}function oA(t,e){return xT(t,e,"monthsShort")}function sA(t,e,r){return Am(t,e,r,"weekdays")}function aA(t,e,r){return Am(t,e,r,"weekdaysShort")}function lA(t,e,r){return Am(t,e,r,"weekdaysMin")}mi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});L.lang=Fr("moment.lang is deprecated. Use moment.locale instead.",mi);L.langData=Fr("moment.langData is deprecated. Use moment.localeData instead.",Gn);var xn=Math.abs;function uA(){var t=this._data;return this._milliseconds=xn(this._milliseconds),this._days=xn(this._days),this._months=xn(this._months),t.milliseconds=xn(t.milliseconds),t.seconds=xn(t.seconds),t.minutes=xn(t.minutes),t.hours=xn(t.hours),t.months=xn(t.months),t.years=xn(t.years),this}function HT(t,e,r,n){var i=rn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function cA(t,e){return HT(this,t,e,1)}function hA(t,e){return HT(this,t,e,-1)}function qb(t){return t<0?Math.floor(t):Math.ceil(t)}function dA(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=qb(pg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Hr(t/1e3),n.seconds=i%60,o=Hr(i/60),n.minutes=o%60,s=Hr(o/60),n.hours=s%24,e+=Hr(s/24),l=Hr(AT(e)),r+=l,e-=qb(pg(l)),a=Hr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function AT(t){return t*4800/146097}function pg(t){return t*146097/4800}function fA(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Vr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+AT(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(pg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Kn(t){return function(){return this.as(t)}}var DT=Kn("ms"),gA=Kn("s"),mA=Kn("m"),pA=Kn("h"),wA=Kn("d"),vA=Kn("w"),yA=Kn("M"),bA=Kn("Q"),CA=Kn("y"),SA=DT;function RA(){return rn(this)}function EA(t){return t=Vr(t),this.isValid()?this[t+"s"]():NaN}function fo(t){return function(){return this.isValid()?this._data[t]:NaN}}var TA=fo("milliseconds"),_A=fo("seconds"),OA=fo("minutes"),MA=fo("hours"),IA=fo("days"),PA=fo("months"),xA=fo("years");function HA(){return Hr(this.days()/7)}var Wn=Math.round,Uo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function AA(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function DA(t,e,r,n){var i=rn(t).abs(),o=Wn(i.as("s")),s=Wn(i.as("m")),a=Wn(i.as("h")),l=Wn(i.as("d")),u=Wn(i.as("M")),c=Wn(i.as("w")),h=Wn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,AA.apply(null,d)}function NA(t){return t===void 0?Wn:typeof t=="function"?(Wn=t,!0):!1}function kA(t,e){return Uo[t]===void 0?!1:e===void 0?Uo[t]:(Uo[t]=e,t==="s"&&(Uo.ss=e-1),!0)}function LA(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Uo,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Uo,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=DA(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Xd=Math.abs;function bo(t){return(t>0)-(t<0)||+t}function Vu(){if(!this.isValid())return this.localeData().invalidDate();var t=Xd(this._milliseconds)/1e3,e=Xd(this._days),r=Xd(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Hr(t/60),i=Hr(n/60),t%=60,n%=60,o=Hr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=bo(this._months)!==bo(a)?"-":"",c=bo(this._days)!==bo(a)?"-":"",h=bo(this._milliseconds)!==bo(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var pe=Lu.prototype;pe.isValid=PH;pe.abs=uA;pe.add=cA;pe.subtract=hA;pe.as=fA;pe.asMilliseconds=DT;pe.asSeconds=gA;pe.asMinutes=mA;pe.asHours=pA;pe.asDays=wA;pe.asWeeks=vA;pe.asMonths=yA;pe.asQuarters=bA;pe.asYears=CA;pe.valueOf=SA;pe._bubble=dA;pe.clone=RA;pe.get=EA;pe.milliseconds=TA;pe.seconds=_A;pe.minutes=OA;pe.hours=MA;pe.days=IA;pe.weeks=HA;pe.months=PA;pe.years=xA;pe.humanize=LA;pe.toISOString=Vu;pe.toString=Vu;pe.toJSON=Vu;pe.locale=CT;pe.localeData=RT;pe.toIsoString=Fr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Vu);pe.lang=ST;Z("X",0,0,"unix");Z("x",0,0,"valueOf");B("x",Au);B("X",ix);He("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});He("x",function(t,e,r){r._d=new Date(ge(t))});//! moment.js
L.version="2.30.1";FP(We);L.fn=N;L.min=_H;L.max=OH;L.now=MH;L.utc=En;L.unix=rA;L.months=iA;L.isDate=Aa;L.locale=mi;L.invalid=Iu;L.duration=rn;L.isMoment=en;L.weekdays=sA;L.parseZone=nA;L.localeData=Gn;L.isDuration=$l;L.monthsShort=oA;L.weekdaysMin=lA;L.defineLocale=Tm;L.updateLocale=nH;L.locales=iH;L.weekdaysShort=aA;L.normalizeUnits=Vr;L.relativeTimeRounding=NA;L.relativeTimeThreshold=kA;L.calendarFormat=JH;L.prototype=N;L.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function FA(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function Gb(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Zd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function go(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Dm(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function bn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function $(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function Kb(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return $(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Xb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function tr(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return go(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function Zo(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function fe(t){return typeof t<"u"}function Ft(t){return typeof t>"u"}function Ji(t){return t===null||t===""||Ft(t)}function VA(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const ta="length",ua=t=>parseInt(t,16),Zb=t=>parseInt(t,10),lu=(t,e,r)=>t.substr(e,r),ca=t=>t.codePointAt(0)-65,wg=t=>`${t}`.replace(/\-/g,""),WA=t=>ua(lu(wg(t),ua("12"),ca("F")))/(ua(lu(wg(t),ca("B"),~~![][ta]))||9),$A=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Qb=!1;const Jb={invalid:()=>tr`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return tr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>tr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},eC={invalid:()=>tr`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return tr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>tr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function BA(t,e){const r=!Ji(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.0";let o,s="invalid",a="invalid";t=wg(t||"");const l=jA(t);if(r||n||l)if(l){const u=L("09/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=WA(t);o=L((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if($A()&&(s="valid",a="valid"),!Qb&&s!=="valid"&&(Jb[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Jb[s]({keyValidityDate:o,hotVersion:i})),Qb=!0),a!=="valid"&&e&&eC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=eC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function jA(t){let e=[][ta],r=e;if(t[ta]!==ca("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=ca(i.shift());o;o=ca(i.shift()||"A"))--o<""[ta]?r=r|(Zb(`${Zb(ua(n)+(ua(lu(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=lu(t,o,o?i[ta]===1?9:8:6);return r===e}function Wu(t){return t[0].toUpperCase()+t.substr(1)}function NT(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function zA(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function UA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function kT(t,e){return LP.sanitize(t,e)}const mo=t=>["tabindex",t],YA=()=>["role","treegrid"],di=()=>["role","presentation"],qA=()=>["role","gridcell"],GA=()=>["role","gridcell button"],KA=()=>["role","rowheader"],LT=()=>["role","rowgroup"],XA=()=>["role","columnheader"],FT=()=>["role","row"],ZA=()=>["role","menu"],QA=()=>["role","menuitem"],JA=()=>["role","menuitemcheckbox"],eD=()=>["scope","col"],tD=()=>["scope","row"],uu=t=>["aria-label",t],rD=()=>["aria-hidden","true"],nD=()=>["aria-disabled","true"],iD=()=>["aria-multiselectable","true"],VT=t=>["aria-rowcount",t],$u=t=>["aria-colcount",t],WT=t=>["aria-rowindex",t],Nm=t=>["aria-colindex",t],jl=t=>["aria-expanded",t],tC=()=>["aria-readonly","true"],rC=()=>["aria-invalid","true"],oD=t=>["aria-checked",t],$T=()=>["aria-selected","true"];var nC={},Qd,iC;function sD(){if(iC)return Qd;iC=1;var t=et(),e=SE(),r=at(),n=oo(),i=Mu(),o=t([].push);return Qd=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,w){if(d)return d=!1,w;if(e(this))return w;for(var y=0;y<h;y++)if(l[y]===g)return w}}},Qd}var oC;function aD(){if(oC)return nC;oC=1;var t=Le(),e=as(),r=Pa(),n=pt(),i=et(),o=st(),s=at(),a=tm(),l=hm(),u=sD(),c=em(),h=String,d=e("JSON","stringify"),g=i(/./.exec),w=i("".charAt),y=i("".charCodeAt),b=i("".replace),T=i(1.1.toString),v=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var U=e("Symbol")("stringify detection");return d([U])!=="[null]"||d({a:U})!=="{}"||d(Object(U))!=="{}"}),P=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),x=function(U,H){var G=l(arguments),J=u(H);if(!(!s(J)&&(U===void 0||a(U))))return G[1]=function(ae,q){if(s(J)&&(q=n(J,this,h(ae),q)),!a(q))return q},r(d,null,G)},F=function(U,H,G){var J=w(G,H-1),ae=w(G,H+1);return g(E,U)&&!g(_,ae)||g(_,U)&&!g(E,J)?"\\u"+T(y(U,0),16):U};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||P},{stringify:function(H,G,J){var ae=l(arguments),q=r(M?x:d,null,ae);return P&&typeof q=="string"?b(q,v,F):q}}),nC}aD();function ba(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},_e(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=ba(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[ba(r[0])]:e[n]=[]:e[n]=null)})),e}function lD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function vi(t,e,r){const n=Array.isArray(r);return _e(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function BT(t,e){_e(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),BT(t[n],e[n])):t[n]=e[n]})}function wr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ke(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return $(r,i=>{t.MIXINS.push(i.MIXIN_NAME),_e(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=w=>{let y=w;return(Array.isArray(y)||Ct(y))&&(y=wr(y)),y};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function jT(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ct(t){return Object.prototype.toString.call(t)==="[object Object]"}function Xn(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function _e(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function uD(t,e){const r=e.split(".");let n=t;return _e(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Jd(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(Cn(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function km(t){if(!Ct(t))return 0;const e=function(r){let n=0;return Ct(r)?_e(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function dr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Cn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function vg(t){return window.requestAnimationFrame(t)}function sC(t){window.cancelAnimationFrame(t)}function cD(){return"ontouchstart"in window}function hD(){return typeof window<"u"}const Pr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Ri={chrome:Pr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Pr(t=>/CriOS/.test(t)),edge:Pr(t=>/Edge/.test(t)),edgeWebKit:Pr(t=>/EdgiOS/.test(t)),firefox:Pr(t=>/Firefox/.test(t)),firefoxWebKit:Pr(t=>/FxiOS/.test(t)),mobile:Pr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Pr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},La={mac:Pr(t=>/^Mac/.test(t)),win:Pr(t=>/^Win/.test(t)),linux:Pr(t=>/^Linux/.test(t)),ios:Pr(t=>/iPhone|iPad|iPod/i.test(t))};function dD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_e(Ri,r=>{let{test:n}=r;return void n(t,e)})}function fD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_e(La,e=>{let{test:r}=e;return void r(t)})}hD()&&(dD(),fD());function gD(){return Ri.chrome.value}function mD(){return Ri.chromeWebKit.value}function ef(){return Ri.firefox.value}function pD(){return Ri.firefoxWebKit.value}function Lm(){return Ri.safari.value}function wD(){return Ri.edge.value}function fi(){return Ri.mobile.value}function zT(){return La.ios.value}function UT(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&La.mac.value}function yg(){return La.win.value}function aC(){return La.mac.value}function vD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function zl(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function yD(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Ca(t){return yD(t)&&t.parent}function YT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Xa(t,e,r){const n=[];let i=t;for(;i&&(i=YT(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function bD(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function Qo(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function CD(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Oi(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function qT(t){return!t||!t.length?[]:t.filter(e=>!!e)}function GT(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=qT(e),e.length>0&&t.classList.add(...e)}function xe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=GT(e,!0);r=qT(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Te(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Fa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=GT(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function KT(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)KT(e[r])}}function ts(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const SD=/(<(.*)>|&(.*);)/;function XT(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;SD.test(e)?t.innerHTML=r?kT(e):e:Va(t,e)}function Va(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(ts(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Sa(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Sa(n.host.impl);if(n.host)return Sa(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function RD(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Ar(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function ZT(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Fm(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Vm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ZT(e):t.scrollTop}function QT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Fm(e):t.scrollLeft}function cu(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function ED(t){return t.scrollHeight-t.clientHeight}function TD(t){return t.scrollWidth-t.clientWidth}function hu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function lC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function er(t){return t.offsetWidth}function rr(t){return t.offsetHeight}function ha(t){return t.clientHeight||t.innerHeight}function JT(t){return t.clientWidth||t.innerWidth}function _D(t){return t.selectionStart?t.selectionStart:0}function uC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function e_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let tf;function OD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return yg()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function MD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");Lm()&&!fi()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i+OD(t)}function nr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return tf===void 0&&(tf=MD(t)),tf}function ID(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function PD(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Wm(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Bu(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Ul(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function t_(t){return Ul(t)&&t.hasAttribute("data-hot-input")===!1}function xD(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function r_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Te(t,"contenteditable",!0),r&&Te(t,...rD()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function n_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&xe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function HD(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;r_(t,r),e(),n_(t,r)}function Xi(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Ie(t){return typeof t=="function"}function i_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function AD(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function bg(t,e,r,n,i,o,s,a){return fe(a)?t.call(e,r,n,i,o,s,a):fe(s)?t.call(e,r,n,i,o,s):fe(o)?t.call(e,r,n,i,o):fe(i)?t.call(e,r,n,i):fe(n)?t.call(e,r,n):fe(r)?t.call(e,r):t.call(e)}const Q={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ef()?182:174,AUDIO_MUTE:ef()?181:173,AUDIO_UP:ef()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},DD=[Q.ALT,Q.ARROW_DOWN,Q.ARROW_LEFT,Q.ARROW_RIGHT,Q.ARROW_UP,Q.AUDIO_DOWN,Q.AUDIO_MUTE,Q.AUDIO_UP,Q.BACKSPACE,Q.CAPS_LOCK,Q.DELETE,Q.END,Q.ENTER,Q.ESCAPE,Q.F1,Q.F2,Q.F3,Q.F4,Q.F5,Q.F6,Q.F7,Q.F8,Q.F9,Q.F10,Q.F11,Q.F12,Q.F13,Q.F14,Q.F15,Q.F16,Q.F17,Q.F18,Q.F19,Q.HOME,Q.INSERT,Q.MEDIA_NEXT,Q.MEDIA_PLAY_PAUSE,Q.MEDIA_PREV,Q.MEDIA_STOP,Q.NULL,Q.NUM_LOCK,Q.PAGE_DOWN,Q.PAGE_UP,Q.PAUSE,Q.SCROLL_LOCK,Q.SHIFT,Q.TAB];function ND(t){return DD.includes(t)}function kD(t){return[Q.CONTROL,Q.COMMAND_LEFT,Q.COMMAND_RIGHT,Q.COMMAND_FIREFOX].includes(t)}function LD(t,e){const r=e.split("|");let n=!1;return $(r,i=>{if(t===Q[i])return n=!0,!1}),n}function ju(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Bi(t){return t.isImmediatePropagationEnabled===!1}function du(t){return t.button===2}function o_(t){return t.button===0}function Sn(){fe(console)&&console.warn(...arguments)}function FD(){fe(console)&&console.error(...arguments)}const ji=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],rf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),nf=new Map([[]]);var cC={},of,hC;function VD(){if(hC)return of;hC=1;var t=cs();return of=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},of}var sf,dC;function WD(){if(dC)return sf;dC=1;var t=Je();return sf=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},sf}var af,fC;function $m(){if(fC)return af;fC=1;var t=tn(),e=cm(),r=Ci().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),af=function(o){i[n][o]=!0},af}var gC;function $D(){if(gC)return cC;gC=1;var t=Le(),e=et(),r=vr(),n=_a(),i=VD(),o=WD(),s=$m(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),cC}$D();var mC={},pC={},wC;function BD(){if(wC)return pC;wC=1;var t=Le(),e=pt(),r=hs(),n=vr(),i=wt(),o=Si(),s=yr(),a=ho(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),pC}var vC;function jD(){return vC||(vC=1,BD()),mC}jD();function zD(t,e){s_(t,e),e.add(t)}function lf(t,e,r){s_(t,e),e.set(t,r)}function s_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yC(t,e,r){return t.set(fu(t,e),r),r}function yt(t,e){return t.get(fu(t,e))}function fu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const UD=100;var lr=new WeakMap,Bo=new WeakMap,uf=new WeakMap,cf=new WeakSet;class bC{constructor(){zD(this,cf),lf(this,lr,new Map),lf(this,Bo,new Map),lf(this,uf,new Set),ji.forEach(e=>fu(cf,this,CC).call(this,e))}getHooks(e){var r;return(r=yt(lr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};yt(lr,this).has(e)||(fu(cf,this,CC).call(this,e),ji.push(e));const i=yt(lr,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=yt(uf,this).has(e);!u&&o!==0&&(u=!0,yt(uf,this).add(e)),u&&i.length>1&&yt(lr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return yt(lr,this).has(e)&&yt(lr,this).get(e).length>0}remove(e,r){if(!yt(lr,this).has(e))return!1;const n=yt(lr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=yt(Bo,this).get(e);return i.skip=!0,o+=1,o>UD&&(yt(lr,this).set(e,n.filter(s=>!s.skip)),o=0),yt(Bo,this).set(e,o),!0}return!1}destroy(){yt(lr,this).clear(),yt(Bo,this).clear(),yC(lr,this,null),yC(Bo,this,null)}}function CC(t){yt(lr,this).set(t,[]),yt(Bo,this).set(t,0)}function YD(t,e,r){return(e=qD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qD(t){var e=GD(t,"string");return typeof e=="symbol"?e:e+""}function GD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const KD=tr`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class de{constructor(){YD(this,"globalBucket",new bC)}static getSingleton(){return ZD()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new bC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?$(r,o=>this.add(e,o,n)):(rf.has(e)&&Sn(UA(KD,{hookName:e,removedInVersion:rf.get(e)})),nf.has(e)&&Sn(nf.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?$(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?$(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=bg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=bg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||ji.push(e)}deregister(e){this.isRegistered(e)&&ji.splice(ji.indexOf(e),1)}isDeprecated(e){return nf.has(e)||rf.has(e)}isRegistered(e){return ji.indexOf(e)>=0}getRegistered(){return ji}}const XD=new de;function ZD(){return XD}const Yi=new Map;function po(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Yi.has(t)||Yi.set(t,new Map);const e=Yi.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Yi.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function QD(t,e){var r;return Yi==null||(r=Yi.get(t.guid))===null||r===void 0?void 0:r.get(e)}const Cg=new WeakMap,{register:JD,getItem:a_,hasItem:l_}=po("editors");function eN(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function tN(t,e){let r;if(typeof t=="function")Cg.get(t)||u_(null,t),r=Cg.get(t);else if(typeof t=="string")r=a_(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function SC(t){if(typeof t=="function")return t;if(!l_(t))throw Error(`No registered editor found under "${t}" name`);return a_(t).getConstructor()}function u_(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new eN(e);typeof t=="string"&&JD(t,r),Cg.set(e,r)}function rN(t,e,r){return(e=nN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nN(t){var e=iN(t,"string");return typeof e=="symbol"?e:e+""}function iN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;rN(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,oN(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function oN(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ju(this)},t}function sN(t,e){aN(t,e),e.add(t)}function aN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mi(t,e,r){return(e=lN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lN(t){var e=uN(t,"string");return typeof e=="symbol"?e:e+""}function uN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Za=new WeakSet;class Sg{constructor(e,r,n){sN(this,Za),Mi(this,"hot",void 0),Mi(this,"tableMeta",void 0),Mi(this,"selection",void 0),Mi(this,"eventManager",void 0),Mi(this,"destroyed",!1),Mi(this,"activeEditor",void 0),Mi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new yi(e),this.hot.addHook("afterDocumentKeyDown",i=>hf(Za,this,RC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>hf(Za,this,RC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>hf(Za,this,cN).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=tN(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function RC(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Bi(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!ND(r)&&!kD(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function cN(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const EC=new WeakMap;Sg.getInstance=function(t,e,r){let n=EC.get(t);return n||(n=new Sg(t,e,r),EC.set(t,n)),n};function hN(t,e){c_(t,e),e.add(t)}function Ms(t,e,r){c_(t,e),e.set(t,r)}function c_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function De(t,e){return t.get($n(t,e))}function Is(t,e,r){return t.set($n(t,e),r),r}function $n(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Jo=Object.freeze({CELL:"cell",MIXED:"mixed"});var nt=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,el=new WeakMap,tl=new WeakMap,li=new WeakSet;class dN{constructor(e){var r=this;hN(this,li),Ms(this,nt,void 0),Ms(this,Qa,void 0),Ms(this,Ja,1),Ms(this,el,null),Ms(this,tl,new Map);const n=e.getSettings();Is(nt,this,e),Is(Qa,this,n.imeFastEdit?Jo.MIXED:Jo.CELL),De(nt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,gN).call(r,...o)}),De(nt,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,TC).call(r,...o)}),De(nt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,TC).call(r,...o)}),De(nt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,fN).call(r,...o)})}getFocusMode(){return De(Qa,this)}setFocusMode(e){Object.values(Jo).includes(e)?Is(Qa,this,e):Sn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return De(Ja,this)}setRefocusDelay(e){Is(Ja,this,e)}setRefocusElementGetter(e){Is(el,this,e)}getRefocusElement(){var e;return typeof De(el,this)=="function"?De(el,this).call(this):(e=De(nt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=De(nt,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=De(nt,this).runHooks("modifyFocusedElement",s.row,s.col,n);Xi(a)||(a=n),a&&!((o=De(nt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):$n(li,this,Bm).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:De(Ja,this);if(De(nt,this).getSettings().imeFastEdit&&!((e=De(nt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=De(nt,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),De(tl,this).has(r)||De(tl,this).set(r,i_(()=>{if(!De(nt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),De(tl,this).get(r)()}}}function Bm(t){var e;const r=(e=De(nt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!De(nt,this).selection.isCellVisible(r)){t(null);return}const n=De(nt,this).getCell(r.row,r.col,!0);n===null?De(nt,this).addHookOnce("afterScroll",()=>{t(De(nt,this).getCell(r.row,r.col,!0))}):t(n)}function TC(){$n(li,this,Bm).call(this,t=>{const{activeElement:e}=De(nt,this).rootDocument;e&&t_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function fN(){$n(li,this,Bm).call(this,t=>{this.getFocusMode()===Jo.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function gN(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Jo.MIXED:Jo.CELL)}var _C={},df,OC;function mN(){if(OC)return df;OC=1;var t=kr(),e=oo(),r=tn(),n=r("match");return df=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},df}var ff,MC;function pN(){if(MC)return ff;MC=1;var t=Je(),e=st(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return ff={correct:n},ff}var gf,IC;function wN(){if(IC)return gf;IC=1;var t=wt();return gf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},gf}var mf,PC;function vN(){if(PC)return mf;PC=1;var t=pt(),e=Lr(),r=Oa(),n=pN(),i=wN(),o=RegExp.prototype;return mf=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},mf}var pf,xC;function yN(){if(xC)return pf;xC=1;var t=et(),e=ls(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return pf=function(l,u,c,h,d,g){var w=c+l.length,y=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(T,v){var E;switch(n(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":E=d[o(v,1,-1)];break;default:var _=+v;if(_===0)return T;if(_>y){var M=r(_/10);return M===0?T:M<=y?h[M-1]===void 0?n(v,1):h[M-1]+n(v,1):T}E=h[_-1]}return E===void 0?"":E})},pf}var HC;function bN(){if(HC)return _C;HC=1;var t=Le(),e=pt(),r=et(),n=Ta(),i=at(),o=kr(),s=mN(),a=Mu(),l=Ma(),u=vN(),c=yN(),h=tn(),d=so(),g=h("replace"),w=TypeError,y=r("".indexOf),b=r("".replace),T=r("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(_,M){var P=n(this),x,F,U,H,G,J,ae,q,ee,lt,Re=0,ve="";if(o(_)){if(x=s(_),x&&(F=a(n(u(_))),!~y(F,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(U=l(_,g),U)return e(U,_,P,M);if(d&&x)return b(a(P),_,M)}for(H=a(P),G=a(_),J=i(M),J||(M=a(M)),ae=G.length,q=v(1,ae),ee=y(H,G);ee!==-1;)lt=J?a(M(G,ee,H)):c(G,H,ee,[],void 0,M),ve+=T(H,Re,ee)+lt,Re=ee+ae,ee=ee+q>H.length?-1:y(H,G,ee+q);return Re<H.length&&(ve+=T(H,Re)),ve}}),_C}bN();var AC={},DC={},NC;function CN(){if(NC)return DC;NC=1;var t=Le(),e=hs(),r=vr(),n=wt(),i=Si(),o=yr(),s=ho(),a=Pa(),l=st(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(v){o(this,"throw",v)}var w=arguments.length<2,y=w?void 0:arguments[1];if(h)return a(h,this,w?[g]:[g,y]);var b=i(this),T=0;if(e(b,function(v){w?(w=!1,y=v):y=g(y,v,T),T++},{IS_RECORD:!0}),w)throw new u("Reduce of empty iterator with no initial value");return y}}),DC}var kC;function SN(){return kC||(kC=1,CN()),AC}SN();const h_={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},RN=new RegExp(Object.keys(h_).map(t=>`(${t})`).join("|"),"gi");function EN(t){return(t&&t.nodeName||"")==="TABLE"}function LC(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,w=[];for(let b=0;b<s;b+=1){const T=!g&&r&&b===0;let v="";if(g)v=`<th>${t.getColHeader(b-c)}</th>`;else if(T)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const E=i[d][b],{hidden:_,rowspan:M,colspan:P}=t.getCellMeta(d-h,b-c);if(!_){const x=[];if(M&&x.push(`rowspan="${M}"`),P&&x.push(`colspan="${P}"`),Ji(E))v=`<td ${x.join(" ")}></td>`;else{const F=E.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${x.join(" ")}>${F}</td>`}}}w.push(v)}const y=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function FC(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Ji(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function TN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const E=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const M=_.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,x=_.substring(M.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${E}`),o=i.querySelector("table")}if(!o||!EN(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,_)=>E+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,w=0;if(o.tHead){const E=Array.from(o.tHead.rows).filter(_=>{const M=_.querySelector("td")!==null;return M&&h.push(_),!M});g=E.length,d=g>0,g>1?r.nestedHeaders=Array.from(E).reduce((_,M)=>{const P=Array.from(M.cells).reduce((x,F,U)=>{if(a&&U===0)return x;const{colSpan:H,innerHTML:G}=F,J=H>1?{label:G,colspan:H}:G;return x.push(J),x},[]);return _.push(P),_},[]):d&&(r.colHeaders=Array.from(E[0].children).reduce((_,M,P)=>(a&&P===0||_.push(M.innerHTML),_),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce((E,_)=>(E.push(...Array.from(_.rows)),E),[]),...c];w=y.length;const b=new Array(w);for(let E=0;E<w;E++)b[E]=new Array(u);const T=[],v=[];for(let E=0;E<w;E++){const _=y[E],M=Array.from(_.cells),P=M.length;for(let x=0;x<P;x++){const F=M[x],{nodeName:U,innerHTML:H,rowSpan:G,colSpan:J}=F,ae=b[E].findIndex(q=>q===void 0);if(U==="TD"){if(G>1||J>1){for(let Re=E;Re<E+G;Re++)if(Re<w)for(let ve=ae;ve<ae+J;ve++)b[Re][ve]=null;const ee=F.getAttribute("style");ee&&ee.includes("mso-ignore:colspan")||T.push({col:ae,row:E,rowspan:G,colspan:J})}let q="";s&&/excel/gi.test(s.content)?q=H.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):q=H.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[E][ae]=q.replace(RN,ee=>h_[ee])}else v.push(H)}}return T.length&&(r.mergeCells=T),v.length&&(r.rowHeaders=v),b.length&&(r.data=b),r}function d_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function _N(t){return d_(t,[","])}function Ye(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function VC(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function ON(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ae(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const Rg="asc",MN="desc",WC=new Map([[Rg,[-1,1]],[MN,[1,-1]]]),IN=t=>`The priority '${t}' is already declared in a map.`,PN=t=>`The priority '${t}' is not a number.`;function xN(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Ie(t)?t:IN,e=Ie(e)?e:PN;function n(o,s){if(!d_(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rg;const[s,a]=WC.get(o)||WC.get(Rg);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const HN=t=>`The id '${t}' is already declared in a map.`;function zu(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ie(t)?t:HN;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const AN=t=>`'${t}' value is already declared in a unique set.`;function DN(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ie(t)?t:AN;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const jm=t=>`There is already registered "${t}" plugin.`,NN=t=>`There is already registered plugin on priority "${t}".`,kN=t=>`The priority "${t}" is not a number.`,f_=xN({errorPriorityExists:NN,errorPriorityNaN:kN}),g_=DN({errorItemExists:jm}),Eg=zu({errorIdExists:jm});function m_(){return[...f_.getItems(),...g_.getItems()]}function zm(t){const e=Wu(t);return Eg.getItem(e)}function LN(t){return!!zm(t)}function rl(t,e,r){[t,e,r]=VN(t,e,r),zm(t)===void 0&&FN(t,e,r)}function FN(t,e,r){const n=Wu(t);if(Eg.hasItem(n))throw new Error(jm(n));r===void 0?g_.addItem(n):f_.addItem(r,n),Eg.addItem(n,e)}function VN(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:WN,getItem:$N,hasItem:p_}=po("renderers");function $C(t){if(typeof t=="function")return t;if(!p_(t))throw Error(`No registered renderer found under "${t}" name`);return $N(t)}function BN(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),WN(t,e)}const{register:jN,getItem:zN,hasItem:w_}=po("validators");function UN(t){if(typeof t=="function")return t;if(!w_(t))throw Error(`No registered validator found under "${t}" name`);return zN(t)}function YN(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),jN(t,e)}var BC={},jC;function qN(){if(jC)return BC;jC=1;var t=Le(),e=ls(),r=cs(),n=Ia(),i=$m();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),BC}qN();var zC={},UC;function GN(){if(UC)return zC;UC=1;var t=Le(),e=et(),r=Ta(),n=Ia(),i=Mu(),o=st(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),zC}GN();function Ps(t,e,r){return(e=KN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KN(t){var e=XN(t,"string");return typeof e=="symbol"?e:e+""}function XN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZN{constructor(){Ps(this,"count",0),Ps(this,"startColumn",null),Ps(this,"endColumn",null),Ps(this,"startPosition",null),Ps(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function xs(t,e,r){return(e=QN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QN(t){var e=JN(t,"string");return typeof e=="symbol"?e:e+""}function JN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ek{constructor(){xs(this,"count",0),xs(this,"startRow",null),xs(this,"endRow",null),xs(this,"startPosition",null),xs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Hs(t,e,r){return(e=tk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tk(t){var e=rk(t,"string");return typeof e=="symbol"?e:e+""}function rk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v_{constructor(){Hs(this,"count",0),Hs(this,"startColumn",null),Hs(this,"endColumn",null),Hs(this,"startPosition",null),Hs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function As(t,e,r){return(e=nk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nk(t){var e=ik(t,"string");return typeof e=="symbol"?e:e+""}function ik(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y_{constructor(){As(this,"count",0),As(this,"startRow",null),As(this,"endRow",null),As(this,"startPosition",null),As(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ds(t,e,r){return(e=ok(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ok(t){var e=sk(t,"string");return typeof e=="symbol"?e:e+""}function sk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ak{constructor(){Ds(this,"count",0),Ds(this,"startColumn",0),Ds(this,"endColumn",0),Ds(this,"startPosition",0),Ds(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Ns(t,e,r){return(e=lk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lk(t){var e=uk(t,"string");return typeof e=="symbol"?e:e+""}function uk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ck{constructor(){Ns(this,"count",0),Ns(this,"startRow",0),Ns(this,"endRow",0),Ns(this,"startPosition",0),Ns(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function YC(t,e,r){return(e=hk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hk(t){var e=dk(t,"string");return typeof e=="symbol"?e:e+""}function dk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fk extends v_{constructor(){super(...arguments),YC(this,"columnStartOffset",0),YC(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function qC(t,e,r){return(e=gk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gk(t){var e=mk(t,"string");return typeof e=="symbol"?e:e+""}function mk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pk extends y_{constructor(){super(...arguments),qC(this,"rowStartOffset",0),qC(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function GC(t,e,r){return(e=wk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wk(t){var e=vk(t,"string");return typeof e=="symbol"?e:e+""}function vk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b_{constructor(e){GC(this,"calculationTypes",[]),GC(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Br(t,e,r){return(e=yk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yk(t){var e=bk(t,"string");return typeof e=="symbol"?e:e+""}function bk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Um=50;class Ck extends b_{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Br(this,"viewportWidth",0),Br(this,"scrollOffset",0),Br(this,"zeroBasedScrollOffset",0),Br(this,"totalColumns",0),Br(this,"columnWidthFn",null),Br(this,"columnWidth",0),Br(this,"overrideFn",null),Br(this,"inlineStartOffset",0),Br(this,"totalCalculatedWidth",0),Br(this,"startPositions",[]),Br(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Um:r}}function Er(t,e,r){return(e=Sk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sk(t){var e=Rk(t,"string");return typeof e=="symbol"?e:e+""}function Rk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ek extends b_{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Er(this,"viewportHeight",0),Er(this,"scrollOffset",0),Er(this,"zeroBasedScrollOffset",0),Er(this,"totalRows",0),Er(this,"rowHeightFn",null),Er(this,"rowHeight",0),Er(this,"overrideFn",null),Er(this,"horizontalScrollbarHeight",0),Er(this,"innerViewportHeight",0),Er(this,"totalCalculatedHeight",0),Er(this,"startPositions",[]),Er(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Tk(t,e,r){_k(t,e),e.set(t,r)}function _k(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KC(t,e,r){return(e=Ok(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ok(t){var e=Mk(t,"string");return typeof e=="symbol"?e:e+""}function Mk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Co(t,e){return t.get(C_(t,e))}function XC(t,e,r){return t.set(C_(t,e),r),r}function C_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hn=new WeakMap;class eo{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;KC(this,"row",null),KC(this,"col",null),Tk(this,Hn,!1),XC(Hn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Co(Hn,this)}isSouthEastOf(e){return this.row>=e.row&&(Co(Hn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Co(Hn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Co(Hn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Co(Hn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof eo&&XC(Hn,this,e.isRtl()),this}clone(){return new eo(this.row,this.col,Co(Hn,this))}toObject(){return{row:this.row,col:this.col}}}function Ik(t,e,r){Pk(t,e),e.set(t,r)}function Pk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wf(t,e,r){return(e=xk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xk(t){var e=Hk(t,"string");return typeof e=="symbol"?e:e+""}function Hk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t,e){return t.get(S_(t,e))}function Ak(t,e,r){return t.set(S_(t,e),r),r}function S_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jt=new WeakMap;class Wa{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;wf(this,"highlight",null),wf(this,"from",null),wf(this,"to",null),Ik(this,jt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),Ak(jt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Tr(jt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Tr(jt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Tr(jt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Tr(jt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Tr(jt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Tr(jt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Tr(jt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Tr(jt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof eo))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Tr(jt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Tr(jt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new Wa(this.highlight,this.from,this.to,Tr(jt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new eo(e,r,Tr(jt,this))}}function an(t,e,r){Dk(t,e),e.set(t,r)}function Dk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z(t,e){return t.get(R_(t,e))}function Jn(t,e,r){return t.set(R_(t,e),r),r}function R_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _r=new WeakMap,vf=new WeakMap,mt=new WeakMap,So=new WeakMap,nl=new WeakMap,jr=new WeakMap,yf=new WeakMap,ks=new WeakMap,Ii=new WeakMap,ln=new WeakMap;let E_=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;an(this,_r,void 0),an(this,vf,void 0),an(this,mt,void 0),an(this,So,void 0),an(this,nl,void 0),an(this,jr,void 0),an(this,yf,void 0),an(this,ks,void 0),an(this,Ii,[null,null]),an(this,ln,[null,null]),Jn(_r,this,n),Jn(vf,this,r),Jn(mt,this,o),Jn(So,this,s),Jn(nl,this,a),Jn(jr,this,i),Jn(yf,this,e),this.registerEvents()}registerEvents(){z(jr,this).addEventListener(z(mt,this).holder,"contextmenu",n=>this.onContextMenu(n)),z(jr,this).addEventListener(z(mt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),z(jr,this).addEventListener(z(mt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{z(jr,this).addEventListener(z(mt,this).holder,"touchstart",n=>this.onTouchStart(n)),z(jr,this).addEventListener(z(mt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),z(jr,this).addEventListener(z(mt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||z(_r,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,z(_r,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{z(jr,this).addEventListener(z(mt,this).holder,"mouseup",n=>this.onMouseUp(n)),z(jr,this).addEventListener(z(mt,this).holder,"mousedown",n=>this.onMouseDown(n))};fi()?e():(cD()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(z(ks,this)&&n){const[i,o]=[n.row,z(ks,this).from.row],[s,a]=[n.col,z(ks,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=z(mt,this).TABLE,i=Xa(e,["TD","TH"],n);return i?(r.coords=z(mt,this).getCoords(i),r.TD=i):we(e,"wtBorder")&&we(e,"current")?(r.coords=z(So,this).getFocusSelection().cellRange.highlight,r.TD=z(mt,this).getCell(r.coords)):we(e,"wtBorder")&&we(e,"area")&&z(So,this).getAreaSelection().cellRange&&(r.coords=z(So,this).getAreaSelection().cellRange.to,r.TD=z(mt,this).getCell(r.coords)),r}onMouseDown(e){const r=z(vf,this).rootDocument.activeElement,n=AD(vD,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);we(i,"corner")?z(_r,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&z(_r,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(z(ln,this)[0]=o.TD,clearTimeout(z(Ii,this)[0]),z(Ii,this)[0]=setTimeout(()=>{z(ln,this)[0]=null},1e3))}onContextMenu(e){if(z(_r,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!z(_r,this).has("onCellMouseOver"))return;const r=z(mt,this).TABLE,n=Xa(e.target,["TD","TH"],r),i=z(nl,this)||this;n&&n!==i.lastMouseOver&&Qo(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,z(mt,this).getCoords(n),n))}onMouseOut(e){if(!z(_r,this).has("onCellMouseOut"))return;const r=z(mt,this).TABLE,n=Xa(e.target,["TD","TH"],r),i=Xa(e.relatedTarget,["TD","TH"],r),o=z(nl,this)||this;n&&n!==i&&Qo(n,r)&&(this.callListener("onCellMouseOut",e,z(mt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&z(_r,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===z(ln,this)[0]&&r.TD===z(ln,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),z(ln,this)[0]=null,z(ln,this)[1]=null):r.TD===z(ln,this)[0]&&(z(ln,this)[1]=r.TD,clearTimeout(z(Ii,this)[1]),z(Ii,this)[1]=setTimeout(()=>{z(ln,this)[1]=null},500)))}onTouchStart(e){Jn(ks,this,z(So,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=fe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&z(_r,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];zT()&&(mD()||pD())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=z(_r,this).getSettingPure(e);o&&o(r,n,i,z(yf,this).call(this))}destroy(){clearTimeout(z(Ii,this)[0]),clearTimeout(z(Ii,this)[1]),z(jr,this).destroy()}};function bf(t,e,r){return(e=Nk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nk(t){var e=kk(t,"string");return typeof e=="symbol"?e:e+""}function kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lk{constructor(e,r,n){bf(this,"offset",void 0),bf(this,"total",void 0),bf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Cf(t,e,r){return(e=Fk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fk(t){var e=Vk(t,"string");return typeof e=="symbol"?e:e+""}function Vk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wk{constructor(e,r,n){Cf(this,"offset",void 0),Cf(this,"total",void 0),Cf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function il(t,e,r){return(e=$k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $k(t){var e=Bk(t,"string");return typeof e=="symbol"?e:e+""}function Bk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jk{constructor(){il(this,"currentSize",0),il(this,"nextSize",0),il(this,"currentOffset",0),il(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const zk=0,ZC=1,Tg=2;function Sf(t,e,r){return(e=Uk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uk(t){var e=Yk(t,"string");return typeof e=="symbol"?e:e+""}function Yk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qk{constructor(){Sf(this,"size",new jk),Sf(this,"workingSpace",zk),Sf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ZC,e.workingSpace=Tg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Tg,e.workingSpace=ZC,this.sharedSize=e.getViewSize()}}var QC={},Rf,JC;function Gk(){if(JC)return Rf;JC=1;var t=Ou(),e=TypeError;return Rf=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},Rf}var eS;function Kk(){if(eS)return QC;eS=1;var t=Le(),e=ls(),r=cs(),n=RE(),i=Gk(),o=EE(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var w=d;w--;){var y=w+g;w in h?h[y]=h[w]:i(h,y)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),QC}Kk();function Xk(t,e,r){return(e=Zk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zk(t){var e=Qk(t,"string");return typeof e=="symbol"?e:e+""}function Qk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tS{constructor(e,r){Xk(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Jk(t,e,r){return(e=eL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eL(t){var e=tL(t,"string");return typeof e=="symbol"?e:e+""}function tL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rL{constructor(e){Jk(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new tS(o,r),l=new tS(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Tg)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function Ro(t,e,r){return(e=nL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nL(t){var e=iL(t,"string");return typeof e=="symbol"?e:e+""}function iL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_{constructor(e,r){Ro(this,"rootNode",void 0),Ro(this,"nodesPool",void 0),Ro(this,"sizeSet",new qk),Ro(this,"collectedNodes",[]),Ro(this,"viewDiffer",new rL(this.sizeSet)),Ro(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class __ extends T_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function rS(t,e,r){return(e=oL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oL(t){var e=sL(t,"string");return typeof e=="symbol"?e:e+""}function sL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aL{constructor(e){rS(this,"nodeType",void 0),rS(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Ls(t,e,r){return(e=lL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lL(t){var e=uL(t,"string");return typeof e=="symbol"?e:e+""}function uL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $a{constructor(e,r){Ls(this,"nodesPool",null),Ls(this,"nodeType",void 0),Ls(this,"rootNode",void 0),Ls(this,"table",null),Ls(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new aL(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function nS(t,e,r){return(e=cL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cL(t){var e=hL(t,"string");return typeof e=="symbol"?e:e+""}function hL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dL extends $a{constructor(){super("TH"),nS(this,"orderViews",new WeakMap),nS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new __(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Fa(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(d,[KA(),tD(),Nm(h+1),mo(-1)]),r[h](a,d,h)}u.end()}}}class fL extends $a{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&ts(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Te(this.rootNode,[LT()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Te(s,[FT(),WT(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Fa(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(u,[Nm(a+1+this.table.rowHeadersCount),mo(-1),XA(),...a>=0?[eD()]:[GA(),uu("Select whole grid")]]),n[r](l,u,r)}}}}let iS=!1;class gL extends $a{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!iS&&e>1e3&&(iS=!0,Sn(tr`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&X(n,"rowHeader")}}function mL(t,e,r){return(e=pL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pL(t){var e=wL(t,"string");return typeof e=="symbol"?e:e+""}function wL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Eo={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let oS=!1;class vL extends $a{constructor(e){super("TR",e),mL(this,"orderView",void 0),this.orderView=new T_(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!oS&&e>1e3&&(oS=!0,Sn(tr`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Te(this.rootNode,[LT()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Te(o,[FT(),WT(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?we(o,Eo.rowEven)||(xe(o,Eo.rowOdd),X(o,Eo.rowEven)):we(o,Eo.rowOdd)||(xe(o,Eo.rowEven),X(o,Eo.rowOdd))}this.orderView.end()}}function sS(t,e,r){return(e=yL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yL(t){var e=bL(t,"string");return typeof e=="symbol"?e:e+""}function bL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CL extends $a{constructor(){super("TD"),sS(this,"orderViews",new WeakMap),sS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new __(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),w=c.getCurrentNode();if(we(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),Fa(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,w),this.table.isAriaEnabled()){var o,s;Te(w,[...w.hasAttribute("role")?[]:[qA()],mo(-1),Nm(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function tt(t,e,r){return(e=SL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SL(t){var e=RL(t,"string");return typeof e=="symbol"?e:e+""}function RL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EL{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tt(this,"rootNode",void 0),tt(this,"rootDocument",void 0),tt(this,"rowHeaders",null),tt(this,"columnHeaders",null),tt(this,"colGroup",null),tt(this,"rows",null),tt(this,"cells",null),tt(this,"rowFilter",null),tt(this,"columnFilter",null),tt(this,"rowUtils",null),tt(this,"columnUtils",null),tt(this,"rowsToRender",0),tt(this,"columnsToRender",0),tt(this,"rowHeaderFunctions",[]),tt(this,"rowHeadersCount",0),tt(this,"columnHeaderFunctions",[]),tt(this,"columnHeadersCount",0),tt(this,"cellRenderer",void 0),tt(this,"activeOverlayName",void 0),tt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class TL{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new EL(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new dL,columnHeaders:new fL(r),colGroup:new gL(n),rows:new vL(i),cells:new CL}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Ef(t,e,r){return(e=_L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _L(t){var e=OL(t,"string");return typeof e=="symbol"?e:e+""}function OL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ML{constructor(e,r){Ef(this,"dataAccessObject",void 0),Ef(this,"wtSettings",void 0),Ef(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function aS(t,e,r){return(e=IL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IL(t){var e=PL(t,"string");return typeof e=="symbol"?e:e+""}function PL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xL{constructor(e,r){aS(this,"dataAccessObject",void 0),aS(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function un(t,e,r){return(e=HL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HL(t){var e=AL(t,"string");return typeof e=="symbol"?e:e+""}function AL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ms{constructor(e,r,n,i,o){un(this,"wtSettings",null),un(this,"domBindings",void 0),un(this,"TBODY",null),un(this,"THEAD",null),un(this,"COLGROUP",null),un(this,"hasTableHeight",!0),un(this,"hasTableWidth",!0),un(this,"isTableVisible",!1),un(this,"tableOffset",0),un(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,KT(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new xL(this.dataAccessObject,this.wtSettings),this.columnUtils=new ML(this.dataAccessObject,this.wtSettings),this.tableRenderer=new TL({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Te(n,[di()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(n,[di()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Te(n,[mo(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Te(n.parentNode,[di()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(n,[di()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Ar(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,w!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Ar(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Wk(g,o,c),this.columnFilter=new Lk(w,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(pn)||this.is(pi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(pn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(pn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=ha(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(pn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=YT(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=CD(n),s=r.cellIndex;Oi(no,r,this.wtRootElement)||Oi(to,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Oi(pi,r,this.wtRootElement)||Oi(pn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Oi(no,r,this.wtRootElement)||Oi(ro,r,this.wtRootElement)||Oi(pi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=ha(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?rr:ha,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const w=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-w||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return er(this.TABLE)}getHeight(){return rr(this.TABLE)}getTotalWidth(){const e=er(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=rr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Sa(this.TABLE)}_modifyRowHeaderWidth(e){let r=Ie(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const DL="stickyRowsBottom",Ym={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Xn(Ym,"MIXIN_NAME",DL,{writable:!1,enumerable:!1});const NL="stickyColumnsStart",Uu={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xn(Uu,"MIXIN_NAME",NL,{writable:!1,enumerable:!1});class qm extends ms{constructor(e,r,n,i){super(e,r,n,i,pi)}}Ke(qm,Ym);Ke(qm,Uu);const to="top",pn="bottom",ro="inline_start",no="top_inline_start_corner",pi="bottom_inline_start_corner",O_=[to,pn,ro,no,pi],kL=new Map([[to,`ht_clone_${to}`],[pn,`ht_clone_${pn}`],[ro,`ht_clone_${ro} ht_clone_left`],[no,`ht_clone_${no} ht_clone_top_left_corner`],[pi,`ht_clone_${pi} ht_clone_bottom_left_corner`]]);function LL(t,e){FL(t,e),e.add(t)}function FL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VL(t,e,r){return(e=WL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WL(t){var e=$L(t,"string");return typeof e=="symbol"?e:e+""}function $L(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ol(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fs=new WeakSet;class BL{constructor(e){LL(this,Fs),VL(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=dr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=dr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return ol(Fs,this,uS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return ol(Fs,this,uS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return ol(Fs,this,lS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return ol(Fs,this,lS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function lS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Ar(n.wtRootElement).left;const u=Math.abs(QT(s,s));if(l>u){const c=JT(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function uS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Ar(r.wtRootElement),a=Vm(o,o);if(s.top>a){const l=ha(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Or(t,e,r){return(e=jL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jL(t){var e=zL(t,"string");return typeof e=="symbol"?e:e+""}function zL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gm{get eventManager(){return new yi(this)}constructor(e,r){Or(this,"wtTable",void 0),Or(this,"wtScroll",void 0),Or(this,"wtViewport",void 0),Or(this,"wtOverlays",void 0),Or(this,"selectionManager",void 0),Or(this,"wtEvent",void 0),Or(this,"guid",`wt_${NT()}`),Or(this,"drawInterrupted",!1),Or(this,"drawn",!1),Or(this,"activeOverlayName","master"),Or(this,"domBindings",void 0),Or(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new BL(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Va(n,e[r])}])}}createCellCoords(e,r){return new eo(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new Wa(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||RD(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function cS(t,e,r){return(e=UL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UL(t){var e=YL(t,"string");return typeof e=="symbol"?e:e+""}function YL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qL extends Gm{constructor(e,r,n){super(e,r),cS(this,"cloneSource",void 0),cS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new E_(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function GL(t,e,r){return(e=KL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KL(t){var e=XL(t,"string");return typeof e=="symbol"?e:e+""}function XL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ba{constructor(e,r,n,i,o){GL(this,"wtSettings",null),Xn(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=hu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=hu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=cu(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Sn(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+nr())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(O_.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${kL.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Te(o,[di()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===to||u==="vertical"&&this.type===ro?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=cu(e.TABLE),new qL(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class ZL extends Ba{constructor(e,r,n,i,o,s){super(e,r,pi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new qm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Bu(r),this.repositionOverlay();let n=rr(this.clone.wtTable.TABLE);const i=er(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=nr(n)),i.style.bottom=`${o}px`}}const QL="calculatedColumns",Yu={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xn(Yu,"MIXIN_NAME",QL,{writable:!1,enumerable:!1});class Km extends ms{constructor(e,r,n,i){super(e,r,n,i,pn)}}Ke(Km,Ym);Ke(Km,Yu);function JL(t,e,r){return(e=eF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eF(t){var e=tF(t,"string");return typeof e=="symbol"?e:e+""}function tF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rF extends Ba{constructor(e,r,n,i){super(e,r,pn,n,i),JL(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Km(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=nr(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Fm(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=nr(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=rr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=nr(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Vm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(xe(s,"innerBorderBottom"),o=a)}return o}}const nF="calculatedRows",Xm={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xn(Xm,"MIXIN_NAME",nF,{writable:!1,enumerable:!1});class Zm extends ms{constructor(e,r,n,i){super(e,r,n,i,ro)}}Ke(Zm,Xm);Ke(Zm,Uu);const iF="localHooks",_n={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)bg(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Xn(_n,"MIXIN_NAME",iF,{writable:!1,enumerable:!1});let M_=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Ke(M_,_n);const oF="active-header",I_="header",Qm="area",gu="focus",sF="fill",aF="row",lF="column",uF="custom-selection",Jm=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var hS={},dS;function cF(){if(dS)return hS;dS=1;var t=$m();return t("flat"),hS}cF();function hF(t,e){P_(t,e),e.add(t)}function fS(t,e,r){P_(t,e),e.set(t,r)}function P_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e){return t.get(da(t,e))}function gS(t,e,r){return t.set(da(t,e),r),r}function da(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,_t=new WeakMap,sl=new WeakSet;class dF{constructor(){hF(this,sl),fS(this,Yr,void 0),fS(this,_t,void 0)}setActiveOverlay(e){return gS(_t,this,e),this}setActiveSelection(e){return gS(Yr,this,e),this}scan(){const e=Ue(Yr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ue(Yr,this).getCorners(),{wtTable:s}=Ue(_t,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let w=s.getColumnHeader(h,g);const y=Ue(_t,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ue(Yr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});y!==null&&(y!==h&&(w=s.getColumnHeader(y,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ue(Yr,this).getCorners(),{wtTable:s}=Ue(_t,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let w=s.getRowHeader(h,g);const y=Ue(_t,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ue(Yr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});y!==null&&(y!==h&&(w=s.getRowHeader(y,g)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ue(_t,this);da(sl,this,fF).call(this,(n,i)=>{const o=r.getCell(Ue(_t,this).createCellCoords(n,i)),s=Ue(_t,this).getSetting("onAfterDrawSelection",n,i,Ue(Yr,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ue(Yr,this).getCorners(),{wtTable:i}=Ue(_t,this);da(sl,this,mS).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ue(_t,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ue(Yr,this).getCorners(),{wtTable:i}=Ue(_t,this);da(sl,this,mS).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ue(_t,this).createCellCoords(o,s));e(a)}})}}function fF(t){let[e,r,n,i]=Ue(Yr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ue(_t,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ue(_t,this).createCellCoords(e,r));if(!Xi(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function mS(t){const{wtTable:e}=Ue(_t,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class pS{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Jm(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ju(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),fi()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};_e(h,(g,w)=>{this.selectionHandles.styles.bottomHitArea[w]=g,this.selectionHandles.styles.topHitArea[w]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};_e(d,(g,w)=>{this.selectionHandles.styles.bottom[w]=g,this.selectionHandles.styles.top[w]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),y=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),b-w-g*2),E=Math.min(parseInt(i+o-y/4,10),b-y-g*2);h[l]=`${v}px`,d[l]=`${E}px`;const _=Math.min(parseInt(n+s,10),T-w-g*2),M=Math.min(parseInt(n+s-y/4,10),T-y-g*2);h.top=`${_}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),w=s.getLastRenderedColumn();if(g<0&&w<0||h<0&&d<0){this.disappear();return}let y;if(u){if(n=Math.max(n,g),o=Math.min(o,w),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}y=s.getCell(this.wot.createCellCoords(r,n))}else if(y=s.getCell(this.wot.createCellCoords(r,n)),!Xi(y)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(i,o)):y,T=Ar(y),v=u?Ar(b):T,E=Ar(s.TABLE),_=T.top,M=T.left,P=this.wot.wtSettings.getSetting("rtlMode");let x=0,F=0;if(P){const ve=er(s.TABLE),qe=er(y),Be=l.innerWidth-E.left-ve;F=M+qe-v.left,x=l.innerWidth-M-qe-Be-1}else F=v.left+er(b)-M,x=M-E.left-1;if(this.isEntireColumnSelected(r,i)){const ve=r,qe=this.getDimensionsFromHeader("columns",n,o,ve,E);let Be=null;qe&&([Be,x,F]=qe),Be&&(y=Be)}let U=_-E.top-1,H=v.top+rr(b)-_;if(this.isEntireRowSelected(n,o)){const ve=n,qe=this.getDimensionsFromHeader("rows",r,i,ve,E);let Be=null;qe&&([Be,U,H]=qe),Be&&(y=Be)}const G=l.getComputedStyle(y);parseInt(G.borderTopWidth,10)>0&&(U+=1,H=H>0?H-1:0),parseInt(G[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,F=F>0?F-1:0);const J=P?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${U}px`,this.topStyle[J]=`${x}px`,this.topStyle.width=`${F+ae}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[J]=`${x}px`,this.startStyle.height=`${H+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${U+H-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[J]=`${x}px`,this.bottomStyle.width=`${F+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[J]=`${x+F-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${H+ae}px`,this.endStyle.display="block";let q=this.settings.border.cornerVisible;q=typeof q=="function"?q(this.settings.layerLevel):q;const ee=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[lt,Re]=[i,o];if(ee&&Array.isArray(ee)&&([,,lt,Re]=ee),fi()||!q||this.isPartRange(lt,Re))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[J]=`${x+F+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ve=hu(s.TABLE);const qe=ve===l;qe&&(ve=a.documentElement);const Be=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Oe=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Cr=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const f=qe?b.getBoundingClientRect().left:b.offsetLeft;let m=!1,p=0;if(P?(p=f-parseInt(this.cornerDefaultStyle.width,10)/2,m=p<0):(p=f+er(b)+parseInt(this.cornerDefaultStyle.width,10)/2,m=p>=JT(ve)),m){const C=Math.floor(x+F+this.cornerCenterPointOffset-Oe-Be);c?(this.cornerStyle[J]=`${C}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[J]=`${C-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(qe?b.getBoundingClientRect().top:b.offsetTop)+rr(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=ha(ve)){const C=Math.floor(U+H+this.cornerCenterPointOffset-Cr-Be);c?(this.cornerStyle.top=`${C}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${C-1}px`}this.cornerStyle.display="block"}fi()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,U,x,F,H)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,w=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return rr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return er(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(w=l(r,b-i),y=l(n,b-i),!w||!y)return!1;const T=Ar(w),v=Ar(y);return w&&y&&(h=T[g]-o[g]-1,d=v[g]+u(y)-T[g]),[w,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?X(this[e],"hidden"):(we(this[e],"hidden")&&xe(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?X(this[e],"hidden"):xe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",fi()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function gF(t,e){x_(t,e),e.add(t)}function To(t,e,r){x_(t,e),e.set(t,r)}function x_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(ep(t,e))}function wS(t,e,r){return t.set(ep(t,e),r),r}function ep(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ot=new WeakMap,Kt=new WeakMap,Tf=new WeakMap,ra=new WeakMap,_f=new WeakMap,Pi=new WeakMap,vS=new WeakSet;class mF{constructor(e){gF(this,vS),To(this,Ot,void 0),To(this,Kt,void 0),To(this,Tf,new dF),To(this,ra,new WeakMap),To(this,_f,new WeakSet),To(this,Pi,new Map),wS(Kt,this,e)}setActiveOverlay(e){return wS(Ot,this,e),le(Tf,this).setActiveOverlay(le(Ot,this)),le(ra,this).has(le(Ot,this))||le(ra,this).set(le(Ot,this),new Set),this}getFocusSelection(){return le(Kt,this)!==null?le(Kt,this).getFocus():null}getAreaSelection(){return le(Kt,this)!==null?le(Kt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(Pi,this).has(e)){const n=le(Pi,this).get(e);if(n.has(le(Ot,this)))return n.get(le(Ot,this));const i=new pS(le(Ot,this),e.settings);return n.set(le(Ot,this),i),i}const r=new pS(le(Ot,this),e.settings);return le(Pi,this).set(e,new Map([[le(Ot,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(Pi,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(Pi,this).get(e).forEach(r=>r.destroy()),le(Pi,this).delete(e)}render(e){if(le(Kt,this)===null)return;e&&ep(vS,this,pF).call(this);const r=Array.from(le(Kt,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(_f,this).has(s)||(le(_f,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&le(Tf,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const y=n.get(w);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const d=s.getCorners();le(Ot,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(ra,this).get(le(Ot,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=le(Kt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Te(s,le(Kt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Te(o,[...i.get(o)])})}}function pF(){const t=le(ra,this).get(le(Ot,this)),e=le(Ot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(Ot,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(Kt,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(Kt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(Kt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(Kt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)xe(o[a],r),Fa(o[a],s)}),t.clear()}class wF extends Ba{constructor(e,r,n,i){super(e,r,ro,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Zm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Wm(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Bu(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,ZT(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=nr(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=er(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Jm(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=nr(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,TD(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(QT(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?xe(n,"emptyRows"):X(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(n,"innerBorderInlineStart");e?(X(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(xe(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const vF="stickyRowsTop",tp={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xn(tp,"MIXIN_NAME",vF,{writable:!1,enumerable:!1});class rp extends ms{constructor(e,r,n,i){super(e,r,n,i,no)}}Ke(rp,tp);Ke(rp,Uu);function yS(t,e,r){return(e=yF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yF(t){var e=bF(t,"string");return typeof e=="symbol"?e:e+""}function bF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CF extends Ba{constructor(e,r,n,i,o,s){super(e,r,no,n,i),yS(this,"topOverlay",void 0),yS(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new rp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Wm(e,`${i}px`,`${o}px`)}else Bu(e);let r=rr(this.clone.wtTable.TABLE);const n=er(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class np extends ms{constructor(e,r,n,i){super(e,r,n,i,to)}}Ke(np,tp);Ke(np,Yu);function SF(t,e,r){return(e=RF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RF(t){var e=EF(t,"string");return typeof e=="symbol"?e:e+""}function EF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TF extends Ba{constructor(e,r,n,i){super(e,r,to,n,i),SF(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new np(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Wm(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Bu(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Fm(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=nr(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=rr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=Jm(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=nr(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,ED(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Vm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?xe(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(xe(i,"innerBorderTop"),a=h)}}return a}}function al(t,e,r){_F(t,e),e.set(t,r)}function _F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function An(t,e,r){return(e=OF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OF(t){var e=MF(t,"string");return typeof e=="symbol"?e:e+""}function MF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xi(t,e,r){return t.set(H_(t,e),r),r}function Dn(t,e){return t.get(H_(t,e))}function H_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _o=new WeakMap,ll=new WeakMap,Oo=new WeakMap,ul=new WeakMap;class IF{constructor(e,r,n,i,o,s){An(this,"wot",null),al(this,_o,[]),An(this,"topOverlay",null),An(this,"bottomOverlay",null),An(this,"inlineStartOverlay",null),An(this,"topInlineStartCornerOverlay",null),An(this,"bottomInlineStartCornerOverlay",null),An(this,"browserLineHeight",void 0),An(this,"wtSettings",null),al(this,ll,!1),al(this,Oo,0),al(this,ul,null),An(this,"resizeObserver",new ResizeObserver(c=>{vg(()=>{!Array.isArray(c)||!c.length||(xi(Oo,this,Dn(Oo,this)+1),Dn(Oo,this)===100&&(Sn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Dn(ul,this)!==null&&clearTimeout(Dn(ul,this)),xi(ul,this,setTimeout(()=>{xi(Oo,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=nr(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:cu(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Dn(_o,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TF(...e),this.bottomOverlay=new rF(...e),this.inlineStartOverlay=new wF(...e),this.topInlineStartCornerOverlay=new CF(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new ZL(...e,this.bottomOverlay,this.inlineStartOverlay),xi(_o,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){xi(ll,this,Dn(_o,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Dn(_o,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Dn(_o,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!gD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{vg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{xi(Oo,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=LD(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Dn(ll,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),xi(ll,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=cu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=r.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),w=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),y=g()?1:0,b=w()?1:0;d.width=`${c+b}px`,d.height=`${u+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return $(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];$(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function bS(t,e,r){return(e=PF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PF(t){var e=xF(t,"string");return typeof e=="symbol"?e:e+""}function xF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HF{constructor(e){bS(this,"settings",{}),bS(this,"defaults",Object.freeze(this.getDefaults())),_e(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Va(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?_e(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class ip extends ms{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=hu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=lC(e,"height",r),o=lC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Sa(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Ke(ip,Xm);Ke(ip,Yu);class AF{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new ck:new pk],["fullyVisible",()=>new ek],["partiallyVisible",()=>new y_]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new ak:new fk],["fullyVisible",()=>new ZN],["partiallyVisible",()=>new v_]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=rr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Ar(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=rr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=er(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=nr(this.domBindings.rootDocument),new Ek({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=nr(this.domBindings.rootDocument)),new Ck({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}resetHasOversizedColumnHeadersMarked(){_e(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class DF extends Gm{constructor(e,r){super(e,new HF(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new ip(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new AF(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new mF(this.wtSettings.getSetting("selections")),this.wtEvent=new E_(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new IF(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];_e(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),xe(this.wtTable.wtRootElement.parentNode,r),X(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!O_.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class op{constructor(e){e instanceof Gm?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new op(r);return()=>n},this._wot=new DF(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function CS(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function NF(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function kF(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const LF=new Map([["touchstart",CS],["mousedown",CS],["mouseover",NF],["mouseup",kF]]);function Of(t,e){LF.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:o_(t)||t.type==="touchstart",isRightClick:du(t),...e})}const A_=new WeakMap,sp=Symbol("rootInstance");function FF(t){A_.set(t,!0)}function VF(t){return t===sp}function jo(t){return A_.has(t)}function WF(t,e){D_(t,e),e.add(t)}function ei(t,e,r){D_(t,e),e.set(t,r)}function D_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ti(t,e,r){return(e=$F(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $F(t){var e=BF(t,"string");return typeof e=="symbol"?e:e+""}function BF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ze(t,e){return t.get(es(t,e))}function zt(t,e,r){return t.set(es(t,e),r),r}function es(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mf=new WeakMap,cl=new WeakMap,hl=new WeakMap,Nn=new WeakMap,zr=new WeakMap,If=new WeakMap,Pf=new WeakMap,Mo=new WeakMap,na=new WeakSet;class jF{constructor(e){WF(this,na),ti(this,"hot",void 0),ti(this,"eventManager",void 0),ti(this,"settings",void 0),ti(this,"THEAD",void 0),ti(this,"TBODY",void 0),ti(this,"_wt",void 0),ti(this,"activeWt",void 0),ei(this,Mf,0),ei(this,cl,0),ti(this,"postponedAdjustElementsSize",!1),ei(this,hl,!1),ei(this,Nn,void 0),ei(this,zr,void 0),ei(this,If,0),ei(this,Pf,0),ei(this,Mo,null),this.hot=e,this.eventManager=new yi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),es(na,this,UF).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),X(e,"handsontable"),zt(zr,this,r.createElement("TABLE")),X(Ze(zr,this),"htCore"),this.hot.getSettings().tableClassName&&X(Ze(zr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Te(Ze(zr,this),[di()]),Te(e,[YA(),VT(-1),$u(this.hot.countCols()),iD()])),this.THEAD=r.createElement("THEAD"),Ze(zr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Ze(zr,this).appendChild(this.TBODY),this.hot.table=Ze(zr,this),this.hot.container.insertBefore(Ze(zr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,o=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{zt(hl,this,!0),this.isTextSelectionAllowed(a.target)||(uC(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{zt(hl,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Ze(hl,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&uC(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{n.isInProgress()&&o_(a)&&n.finish(),zt(Nn,this,!1);const l=t_(r.activeElement);Ul(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!du(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{n.isInProgress()&&du(a)&&(n.finish(),zt(Nn,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),zt(Nn,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Ze(Nn,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const w=nr(r);if(r.elementFromPoint(u+w,c)!==d||r.elementFromPoint(u,c+w)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Ca(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Ca(s);this.eventManager.addEventListener(Ze(zr,this),"selectstart",a=>{this.settings.fragmentSelection||Ul(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&X(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&xe(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ze(zr,this),isDataViewInstance:()=>jo(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),zt(cl,this,o.length),this.hot.getSettings().ariaTags&&es(na,this,N_).call(this)===this.hot.countCols()&&es(na,this,zF).call(this,Ze(cl,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),zt(Mf,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),w=this.hot.colToProp(d);let y=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,y,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,y,g),this.hot.runHooks("afterRenderer",a,l,u,w,y,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Sa(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,zt(Nn,this,!0),zt(Mo,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Bi(o)&&(Of(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,zt(Nn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Bi(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Bi(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Bi(o)&&(Ze(Nn,this)&&(!Ze(Mo,this)||Ze(Mo,this).x!==o.clientX||Ze(Mo,this).y!==o.clientY)&&Of(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,zt(Mo,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Bi(o)||this.hot.isDestroyed)&&(Of(o,{coords:u,selection:this.hot.selection,cellRangeMapper:QD(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[w,y,b,T]=g;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new op(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Ul(e))return!0;const r=Qo(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ze(Nn,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!we(n,"relative")){ts(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",X(s,["relative",...o()])):(ts(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Te(a,...di()),Te(l,...di())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?XT(e,n(r,i)):(Va(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){zt(If,this,e),zt(Pf,this,r)}getLastSize(){return{width:Ze(If,this),height:Ze(Pf,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ze(Mf,this)}getRowHeadersCount(){return Ze(cl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function N_(){return parseInt(this.hot.rootElement.getAttribute($u()[0]),10)}function zF(t){const e=es(na,this,N_).call(this)+t;Te(this.hot.rootElement,...$u(e))}function UF(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):xe(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):xe(t,"htHasScrollX")}var SS={},RS={},ES;function YF(){if(ES)return RS;ES=1;var t=Le(),e=pt(),r=hs(),n=vr(),i=wt(),o=Si(),s=yr(),a=ho(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,w){if(!c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),RS}var TS;function qF(){return TS||(TS=1,YF()),SS}qF();const GF="ABCDEFGHIJKLMNOPQRSTUVWXYZ",_S=GF.length;function KF(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%_S,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/_S,10);return r}function k_(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ct(t[0])&&(e=km(t[0]))),e}function Vs(t,e,r){return(e=XF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XF(t){var e=ZF(t,"string");return typeof e=="symbol"?e:e+""}function ZF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QF{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Vs(this,"hot",void 0),Vs(this,"data",void 0),Vs(this,"dataType","array"),Vs(this,"colToProp",()=>{}),Vs(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return $(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Ye(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(Ct(a)||Ie(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Ye(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?Jd(l,d,g):l[d]=g}})}else _e(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Jd(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=dr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Jd(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?uD(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=dr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Ye(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return k_(this.data)}destroy(){this.data=null,this.hot=null}}var OS={},MS={},IS;function JF(){if(IS)return MS;IS=1;var t=Le(),e=pt(),r=hs(),n=vr(),i=wt(),o=Si(),s=yr(),a=ho(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),MS}var PS;function eV(){return PS||(PS=1,JF()),OS}eV();function xS(t,e,r){return(e=tV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tV(t){var e=rV(t,"string");return typeof e=="symbol"?e:e+""}function rV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ja{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;xS(this,"indexedValues",[]),xS(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ie(this.initValueOrFn)?Ye(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ye(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ke(ja,_n);function L_(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Ie(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function F_(t,e){return Dm(t,(r,n)=>e.includes(n)===!1)}class qu extends ja{insert(e,r){this.indexedValues=L_(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=F_(this.indexedValues,e),super.remove(e)}}class V_ extends qu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return go(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function W_(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function mu(t,e){return Dm(t,r=>e.includes(r)===!1)}function $_(t,e){return bn(t,r=>r-e.filter(n=>n<r).length)}function B_(t,e){const r=e[0],n=e.length;return bn(t,i=>i>=r?i+n:i)}function nV(t,e,r){return(e=iV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iV(t){var e=oV(t,"string");return typeof e=="symbol"?e:e+""}function oV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sV extends ja{constructor(){super(...arguments),nV(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=mu(this.orderOfIndexes,[e]),Ie(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=L_(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=B_(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=F_(this.indexedValues,e),this.orderOfIndexes=mu(this.orderOfIndexes,e),this.orderOfIndexes=$_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class j_ extends qu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return go(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class aV extends ja{constructor(){super(e=>e)}insert(e,r){const n=B_(this.indexedValues,r);this.indexedValues=W_(n,e,r),super.insert(e,r)}remove(e){const r=mu(this.indexedValues,e);this.indexedValues=$_(r,e),super.remove(e)}}const HS=new Map([["hiding",V_],["index",ja],["linkedPhysicalIndexToValue",sV],["physicalIndexToValue",qu],["trimming",j_]]);function lV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!HS.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(HS.get(t))(e)}function uV(t,e,r){return(e=cV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cV(t){var e=hV(t,"string");return typeof e=="symbol"?e:e+""}function hV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ap{constructor(){uV(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);fe(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Ft(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Ke(ap,_n);function xf(t,e,r){return(e=dV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dV(t){var e=fV(t,"string");return typeof e=="symbol"?e:e+""}function fV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AS extends ap{constructor(e,r){super(),xf(this,"mergedValuesCache",[]),xf(this,"aggregationFunction",void 0),xf(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=bn(this.get(),o=>o.getValues()),n=[],i=fe(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return bn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return fe(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function gV(t,e,r){mV(t,e),e.set(t,r)}function mV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pV(t,e,r){return t.set(z_(t,e),r),r}function wV(t,e){return t.get(z_(t,e))}function z_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hf=new WeakMap;class U_{constructor(){gV(this,Hf,[])}subscribe(e){return this.addLocalHook("change",e),this._write(wV(Hf,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){pV(Hf,this,e)}}Ke(U_,_n);function DS(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Ws(t,e,r){vV(t,e),e.set(t,r)}function vV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e){return t.get(Y_(t,e))}function dl(t,e,r){return t.set(Y_(t,e),r),r}function Y_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fl=new WeakMap,$s=new WeakMap,gl=new WeakMap,ml=new WeakMap,pl=new WeakMap;class yV{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ws(this,fl,new Set),Ws(this,$s,[]),Ws(this,gl,[]),Ws(this,ml,!1),Ws(this,pl,!1),dl(pl,this,e??!1)}createObserver(){const e=new U_;return Mr(fl,this).add(e),e.addLocalHook("unsubscribe",()=>{Mr(fl,this).delete(e)}),e._writeInitialChanges(DS(Mr($s,this),Mr(gl,this))),e}emit(e){let r=Mr(gl,this);(!Mr(ml,this)||Mr($s,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Mr(pl,this)):dl($s,this,new Array(e.length).fill(Mr(pl,this))),Mr(ml,this)||(dl(ml,this,!0),r=Mr($s,this)));const n=DS(r,e);Mr(fl,this).forEach(i=>i._write(n)),dl(gl,this,e)}}function At(t,e,r){return(e=bV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bV(t){var e=CV(t,"string");return typeof e=="symbol"?e:e+""}function CV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _g{constructor(){At(this,"indexesSequence",new aV),At(this,"trimmingMapsCollection",new AS(e=>e.some(r=>r===!0),!1)),At(this,"hidingMapsCollection",new AS(e=>e.some(r=>r===!0),!1)),At(this,"variousMapsCollection",new ap),At(this,"hidingChangesObservable",new yV({initialIndexValue:!1})),At(this,"notTrimmedIndexesCache",[]),At(this,"notHiddenIndexesCache",[]),At(this,"isBatched",!1),At(this,"indexesSequenceChanged",!1),At(this,"indexesChangeSource",void 0),At(this,"trimmedIndexesChanged",!1),At(this,"hiddenIndexesChanged",!1),At(this,"renderablePhysicalIndexesCache",[]),At(this,"fromPhysicalToVisualIndexesCache",new Map),At(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,lV(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof j_?this.trimmingMapsCollection.register(e,r):r instanceof V_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return fe(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return fe(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return fe(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return fe(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=bn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=mu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(W_(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=fe(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=bn(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Ke(_g,_n);function SV(t,e){return _e(e,(r,n)=>{Ft(t[n])&&(t[n]=r)}),t}function q_(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function G_(t){fe(t)&&FD(tr`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function RV(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:EV,getValues:TV}=po("phraseFormatters");function _V(t,e){EV(t,e)}function OV(){return TV()}_V("pluralize",RV);const K_="ContextMenu:items",ne=K_,lp=`${ne}.noItems`,up=`${ne}.insertRowAbove`,cp=`${ne}.insertRowBelow`,hp=`${ne}.insertColumnOnTheLeft`,dp=`${ne}.insertColumnOnTheRight`,fp=`${ne}.removeRow`,gp=`${ne}.removeColumn`,mp=`${ne}.undo`,pp=`${ne}.redo`,pu=`${ne}.readOnly`,wp=`${ne}.clearColumn`,vp=`${ne}.copy`,yp=`${ne}.copyWithHeaders`,bp=`${ne}.copyWithGroupHeaders`,Cp=`${ne}.copyHeadersOnly`,Sp=`${ne}.cut`,X_=`${ne}.freezeColumn`,Z_=`${ne}.unfreezeColumn`,Q_=`${ne}.mergeCells`,J_=`${ne}.unmergeCells`,e0=`${ne}.addComment`,t0=`${ne}.editComment`,r0=`${ne}.removeComment`,n0=`${ne}.readOnlyComment`,Rp=`${ne}.align`,Ep=`${ne}.align.left`,Tp=`${ne}.align.center`,_p=`${ne}.align.right`,Op=`${ne}.align.justify`,Mp=`${ne}.align.top`,Ip=`${ne}.align.middle`,Pp=`${ne}.align.bottom`,i0=`${ne}.borders`,o0=`${ne}.borders.top`,s0=`${ne}.borders.right`,a0=`${ne}.borders.bottom`,l0=`${ne}.borders.left`,u0=`${ne}.borders.remove`,c0=`${ne}.nestedHeaders.insertChildRow`,h0=`${ne}.nestedHeaders.detachFromParent`,d0=`${ne}.hideColumn`,f0=`${ne}.showColumn`,g0=`${ne}.hideRow`,m0=`${ne}.showRow`,ir="Filters:",Xe=`${ir}conditions`,p0=`${Xe}.none`,w0=`${Xe}.isEmpty`,v0=`${Xe}.isNotEmpty`,y0=`${Xe}.isEqualTo`,b0=`${Xe}.isNotEqualTo`,C0=`${Xe}.beginsWith`,S0=`${Xe}.endsWith`,R0=`${Xe}.contains`,E0=`${Xe}.doesNotContain`,MV=`${Xe}.byValue`,T0=`${Xe}.greaterThan`,_0=`${Xe}.greaterThanOrEqualTo`,O0=`${Xe}.lessThan`,M0=`${Xe}.lessThanOrEqualTo`,I0=`${Xe}.isBetween`,P0=`${Xe}.isNotBetween`,x0=`${Xe}.after`,H0=`${Xe}.before`,A0=`${Xe}.today`,D0=`${Xe}.tomorrow`,N0=`${Xe}.yesterday`,k0=`${ir}labels.filterByCondition`,L0=`${ir}labels.filterByValue`,F0=`${ir}labels.conjunction`,V0=`${ir}labels.disjunction`,W0=`${ir}values.blankCells`,$0=`${ir}buttons.selectAll`,B0=`${ir}buttons.clear`,j0=`${ir}buttons.ok`,z0=`${ir}buttons.cancel`,U0=`${ir}buttons.placeholder.search`,Y0=`${ir}buttons.placeholder.value`,q0=`${ir}buttons.placeholder.secondValue`,xp="CheckboxRenderer:",G0=`${xp}checked`,K0=`${xp}unchecked`,IV=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:G0,CHECKBOX_RENDERER_NAMESPACE:xp,CHECKBOX_UNCHECKED:K0,CONTEXTMENU_ITEMS_ADD_COMMENT:e0,CONTEXTMENU_ITEMS_ALIGNMENT:Rp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Pp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Tp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Op,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Ep,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Ip,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:_p,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Mp,CONTEXTMENU_ITEMS_BORDERS:i0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:a0,CONTEXTMENU_ITEMS_BORDERS_LEFT:l0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:s0,CONTEXTMENU_ITEMS_BORDERS_TOP:o0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:wp,CONTEXTMENU_ITEMS_COPY:vp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Cp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:bp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:yp,CONTEXTMENU_ITEMS_CUT:Sp,CONTEXTMENU_ITEMS_EDIT_COMMENT:t0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:X_,CONTEXTMENU_ITEMS_HIDE_COLUMN:d0,CONTEXTMENU_ITEMS_HIDE_ROW:g0,CONTEXTMENU_ITEMS_INSERT_LEFT:hp,CONTEXTMENU_ITEMS_INSERT_RIGHT:dp,CONTEXTMENU_ITEMS_MERGE_CELLS:Q_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:h0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:c0,CONTEXTMENU_ITEMS_NO_ITEMS:lp,CONTEXTMENU_ITEMS_READ_ONLY:pu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:n0,CONTEXTMENU_ITEMS_REDO:pp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:u0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:gp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:r0,CONTEXTMENU_ITEMS_REMOVE_ROW:fp,CONTEXTMENU_ITEMS_ROW_ABOVE:up,CONTEXTMENU_ITEMS_ROW_BELOW:cp,CONTEXTMENU_ITEMS_SHOW_COLUMN:f0,CONTEXTMENU_ITEMS_SHOW_ROW:m0,CONTEXTMENU_ITEMS_UNDO:mp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Z_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:J_,CONTEXT_MENU_ITEMS_NAMESPACE:K_,FILTERS_BUTTONS_CANCEL:z0,FILTERS_BUTTONS_CLEAR:B0,FILTERS_BUTTONS_OK:j0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:U0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:q0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Y0,FILTERS_BUTTONS_SELECT_ALL:$0,FILTERS_CONDITIONS_AFTER:x0,FILTERS_CONDITIONS_BEFORE:H0,FILTERS_CONDITIONS_BEGINS_WITH:C0,FILTERS_CONDITIONS_BETWEEN:I0,FILTERS_CONDITIONS_BY_VALUE:MV,FILTERS_CONDITIONS_CONTAINS:R0,FILTERS_CONDITIONS_EMPTY:w0,FILTERS_CONDITIONS_ENDS_WITH:S0,FILTERS_CONDITIONS_EQUAL:y0,FILTERS_CONDITIONS_GREATER_THAN:T0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:_0,FILTERS_CONDITIONS_LESS_THAN:O0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:M0,FILTERS_CONDITIONS_NAMESPACE:Xe,FILTERS_CONDITIONS_NONE:p0,FILTERS_CONDITIONS_NOT_BETWEEN:P0,FILTERS_CONDITIONS_NOT_CONTAIN:E0,FILTERS_CONDITIONS_NOT_EMPTY:v0,FILTERS_CONDITIONS_NOT_EQUAL:b0,FILTERS_CONDITIONS_TODAY:A0,FILTERS_CONDITIONS_TOMORROW:D0,FILTERS_CONDITIONS_YESTERDAY:N0,FILTERS_DIVS_FILTER_BY_CONDITION:k0,FILTERS_DIVS_FILTER_BY_VALUE:L0,FILTERS_LABELS_CONJUNCTION:F0,FILTERS_LABELS_DISJUNCTION:V0,FILTERS_NAMESPACE:ir,FILTERS_VALUES_BLANK_CELLS:W0},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const X0={languageCode:"en-US",[lp]:"No available options",[up]:"Insert row above",[cp]:"Insert row below",[hp]:"Insert column left",[dp]:"Insert column right",[fp]:["Remove row","Remove rows"],[gp]:["Remove column","Remove columns"],[mp]:"Undo",[pp]:"Redo",[pu]:"Read only",[wp]:"Clear column",[Rp]:"Alignment",[Ep]:"Left",[Tp]:"Center",[_p]:"Right",[Op]:"Justify",[Mp]:"Top",[Ip]:"Middle",[Pp]:"Bottom",[X_]:"Freeze column",[Z_]:"Unfreeze column",[i0]:"Borders",[o0]:"Top",[s0]:"Right",[a0]:"Bottom",[l0]:"Left",[u0]:"Remove border(s)",[e0]:"Add comment",[t0]:"Edit comment",[r0]:"Delete comment",[n0]:"Read-only comment",[Q_]:"Merge cells",[J_]:"Unmerge cells",[vp]:"Copy",[yp]:["Copy with header","Copy with headers"],[bp]:["Copy with group header","Copy with group headers"],[Cp]:["Copy header only","Copy headers only"],[Sp]:"Cut",[c0]:"Insert child row",[h0]:"Detach from parent",[d0]:["Hide column","Hide columns"],[f0]:["Show column","Show columns"],[g0]:["Hide row","Hide rows"],[m0]:["Show row","Show rows"],[p0]:"None",[w0]:"Is empty",[v0]:"Is not empty",[y0]:"Is equal to",[b0]:"Is not equal to",[C0]:"Begins with",[S0]:"Ends with",[R0]:"Contains",[E0]:"Does not contain",[T0]:"Greater than",[_0]:"Greater than or equal to",[O0]:"Less than",[M0]:"Less than or equal to",[I0]:"Is between",[P0]:"Is not between",[x0]:"After",[H0]:"Before",[A0]:"Today",[D0]:"Tomorrow",[N0]:"Yesterday",[W0]:"Blank cells",[k0]:"Filter by condition",[L0]:"Filter by value",[F0]:"And",[V0]:"Or",[$0]:"Select all",[B0]:"Clear",[j0]:"OK",[z0]:"Cancel",[U0]:"Search",[Y0]:"Value",[q0]:"Second value",[G0]:"Checked",[K0]:"Unchecked"},PV=IV,Og=X0.languageCode,{register:xV,getItem:Z0,hasItem:HV,getValues:AV}=po("languagesDictionaries");Q0(X0);function Q0(t,e){let r=t,n=e;return Ct(t)&&(n=t,r=n.languageCode),DV(r,n),xV(r,wr(n)),wr(n)}function DV(t,e){t!==Og&&SV(e,Z0(Og))}function J0(t){return Hp(t)?wr(Z0(t)):null}function Hp(t){return HV(t)}function NV(){return AV()}function eO(t,e,r){const n=J0(t);if(n===null)return null;const i=n[e];if(Ft(i))return null;const o=kV(i,r);return Array.isArray(o)?o[0]:o}function kV(t,e){let r=t;return $(OV(),n=>{r=n(t,e)}),r}function LV(t){let e=q_(t);return Hp(e)||(e=Og,G_(t)),e}function FV(t,e,r){return(e=VV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VV(t){var e=WV(t,"string");return typeof e=="symbol"?e:e+""}function WV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zn extends M_{constructor(e,r){super(e,null),FV(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function Af(t){let{activeHeaderClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:oF})}function $V(t){let{areaCornerVisible:e,...r}=t;return new Zn({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:Qm})}function BV(t){let{...e}=t;return new Zn({className:"highlight",...e,selectionType:Qm})}function jV(t){let{columnClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:lF})}function zV(t){let{cellCornerVisible:e,...r}=t;return new Zn({className:"current",headerAttributes:[$T()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:gu})}function UV(t){let{border:e,visualCellRange:r,...n}=t;return new Zn({...e,...n,selectionType:uF},r)}function YV(t){let{...e}=t;return new Zn({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:sF})}function NS(t){let{headerClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:I_})}function qV(t){let{rowClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:aF})}function GV(t,e){KV(t,e),e.add(t)}function KV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ut(t,e,r){return(e=XV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XV(t){var e=ZV(t,"string");return typeof e=="symbol"?e:e+""}function ZV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cn=new WeakSet;class QV{constructor(e){GV(this,cn),Ut(this,"options",void 0),Ut(this,"layerLevel",0),Ut(this,"focus",void 0),Ut(this,"fill",void 0),Ut(this,"layeredAreas",new Map),Ut(this,"areas",new Map),Ut(this,"rowHeaders",new Map),Ut(this,"columnHeaders",new Map),Ut(this,"activeRowHeaders",new Map),Ut(this,"activeColumnHeaders",new Map),Ut(this,"activeCornerHeaders",new Map),Ut(this,"rowHighlights",new Map),Ut(this,"columnHighlights",new Map),Ut(this,"customSelections",[]),this.options=e,this.focus=zV(e),this.fill=YV(e)}isEnabledFor(e,r){let n=e;e===gu&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return kn(cn,this,Ln).call(this,this.layeredAreas,$V)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return kn(cn,this,Ln).call(this,this.areas,BV)}getAreas(){return[...this.areas.values()]}createRowHeader(){return kn(cn,this,Ln).call(this,this.rowHeaders,NS)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return kn(cn,this,Ln).call(this,this.columnHeaders,NS)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return kn(cn,this,Ln).call(this,this.activeRowHeaders,Af)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return kn(cn,this,Ln).call(this,this.activeColumnHeaders,Af)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return kn(cn,this,Ln).call(this,this.activeCornerHeaders,Af)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return kn(cn,this,Ln).call(this,this.rowHighlights,qV)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return kn(cn,this,Ln).call(this,this.columnHighlights,jV)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(UV({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),$(this.areas.values(),e=>void e.clear()),$(this.layeredAreas.values(),e=>void e.clear()),$(this.rowHeaders.values(),e=>void e.clear()),$(this.columnHeaders.values(),e=>void e.clear()),$(this.activeRowHeaders.values(),e=>void e.clear()),$(this.activeColumnHeaders.values(),e=>void e.clear()),$(this.activeCornerHeaders.values(),e=>void e.clear()),$(this.rowHighlights.values(),e=>void e.clear()),$(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ln(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function kS(t,e,r){return(e=JV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JV(t){var e=eW(t,"string");return typeof e=="symbol"?e:e+""}function eW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ap{constructor(e){kS(this,"ranges",[]),kS(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new Ap(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function tW(t,e){tO(t,e),e.add(t)}function Df(t,e,r){tO(t,e),e.set(t,r)}function tO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function me(t,e){return t.get(rt(t,e))}function wl(t,e,r){return t.set(rt(t,e),r),r}function rt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var vl=new WeakMap,Ne=new WeakMap,Qr=new WeakMap,ht=new WeakSet;class Mg{constructor(e,r){tW(this,ht),Df(this,vl,void 0),Df(this,Ne,void 0),Df(this,Qr,{x:0,y:0}),wl(vl,this,e),wl(Ne,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=me(Ne,this).createCellCoords(e,r);let o=me(vl,this).current().highlight;const s=me(Ne,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=rt(ht,this,rO).call(this),{row:h,col:d}=rt(ht,this,FS).call(this,o),g=me(Ne,this).fixedRowsBottom(),w=me(Ne,this).minSpareRows(),y=me(Ne,this).minSpareCols(),b=me(Ne,this).autoWrapRow(),T=me(Ne,this).autoWrapCol(),v=me(Ne,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const M=dr(n&&w>0&&g===0),P=v.col+1,x=me(Ne,this).createCellCoords(v.row-c,P>=u?P-u:P);this.runLocalHooks("beforeColumnWrap",M,rt(ht,this,Io).call(this,x),P>=u),M.value?this.runLocalHooks("insertRowRequire",me(Ne,this).countRenderableRows()):T&&v.assign(x)}else if(v.row<0){const M=dr(T),P=v.col-1,x=me(Ne,this).createCellCoords(c+v.row,P<0?u+P:P);this.runLocalHooks("beforeColumnWrap",M,rt(ht,this,Io).call(this,x),P<0),T&&v.assign(x)}if(v.col>=u){const M=dr(n&&y>0),P=v.row+1,x=me(Ne,this).createCellCoords(P>=c?P-c:P,v.col-u);this.runLocalHooks("beforeRowWrap",M,rt(ht,this,Io).call(this,x),P>=c),M.value?this.runLocalHooks("insertColRequire",me(Ne,this).countRenderableColumns()):b&&v.assign(x)}else if(v.col<0){const M=dr(b),P=v.row-1,x=me(Ne,this).createCellCoords(P<0?c+P:P,u+v.col);this.runLocalHooks("beforeRowWrap",M,rt(ht,this,Io).call(this,x),P<0),b&&v.assign(x)}const{rowDir:E,colDir:_}=rt(ht,this,LS).call(this,v);a=E,l=_,o=rt(ht,this,Io).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,r){const n=me(Ne,this).createCellCoords(e,r),i=me(vl,this).current(),o=me(Ne,this).visualToRenderableCoords(i.highlight),s=rt(ht,this,Nf).call(this,i.to.row,i.from.row),a=rt(ht,this,kf).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=rt(ht,this,FS).call(this,i.highlight),g=me(Ne,this).createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),y=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const _=g.col-d;g.col=rt(ht,this,kf).call(this,w.col,y.col)+_}else if(n.col>0&&a<=d&&g.col>d){const _=rt(ht,this,kf).call(this,y.col,w.col),M=Math.max(g.col-_,1);g.col=_+M}if(n.row<0&&s>=h&&g.row<h){const _=g.row-h;g.row=rt(ht,this,Nf).call(this,w.row,b.row)+_}else if(n.row>0&&s<=h&&g.row>h){const _=rt(ht,this,Nf).call(this,b.row,w.row),M=Math.max(g.row-_,1);g.row=_+M}const{rowDir:T,colDir:v}=rt(ht,this,LS).call(this,g);u=T,c=v;const E=rt(ht,this,Io).call(this,g);n.row===0&&n.col!==0?l.col=E.col:n.row!==0&&n.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;wl(Qr,this,{x:r,y:n})}resetOffsetSize(){wl(Qr,this,{x:0,y:0})}}function LS(t){const{width:e,height:r}=rt(ht,this,rO).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function rO(){return{width:me(Qr,this).x+me(Ne,this).countRenderableColumns(),height:me(Qr,this).y+me(Ne,this).countRenderableRows()}}function Nf(t,e){const r=me(Ne,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:me(Qr,this).y+r}function kf(t,e){const r=me(Ne,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:me(Qr,this).x+r}function FS(t){const{row:e,col:r}=me(Ne,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return me(Ne,this).createCellCoords(me(Qr,this).y+e,me(Qr,this).x+r)}function Io(t){const e=t.clone();return e.col=t.col-me(Qr,this).x,e.row=t.row-me(Qr,this).y,me(Ne,this).renderableToVisualCoords(e)}Ke(Mg,_n);const Gu=0,Ku=1,nO=2,Dp=3,rW=[Dp,nO],nW=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Lf=Symbol("root"),VS=Symbol("child");function Xu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lf;if(e!==Lf&&e!==VS)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Lf;let i=Gu;if(r){const o=t[0];t.length===0?i=Ku:n&&o instanceof Wa?i=Dp:n&&Array.isArray(o)?i=Xu(o,VS):t.length>=2&&t.length<=4&&!t.some((a,l)=>!nW[l].includes(typeof a))&&(i=nO)}return i}function Np(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!rW.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Dp;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ft(u)&&(u=a),Ft(c)&&(c=l),!n){const g=a,w=l,y=u,b=c;a=Math.min(g,y),l=Math.min(w,b),u=Math.max(g,y),c=Math.max(w,b)}const h=e(a,l),d=e(u,c);return r(h,h,d)}}function iW(t){const e=Xu(t.getSelected());if(e===Gu||e===Ku)return[];const r=Np(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;$(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;$(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return go(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function oW(t){const e=Xu(t.getSelected());if(e===Gu||e===Ku)return[];const r=Np(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;$(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;$(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return go(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Po(t,e,r){sW(t,e),e.set(t,r)}function sW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e,r){return(e=aW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aW(t){var e=lW(t,"string");return typeof e=="symbol"?e:e+""}function lW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fe(t,e){return t.get(iO(t,e))}function hn(t,e,r){return t.set(iO(t,e),r),r}function iO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tt=new WeakMap,Ai=new WeakMap,yl=new WeakMap,Bs=new WeakMap,bl=new WeakMap,js=new WeakMap;class oO{constructor(e,r){var n=this;Hi(this,"settings",void 0),Hi(this,"tableProps",void 0),Hi(this,"inProgress",!1),Hi(this,"selectedRange",new Ap((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Hi(this,"highlight",void 0),Po(this,Tt,void 0),Po(this,Ai,void 0),Hi(this,"selectedByRowHeader",new Set),Hi(this,"selectedByColumnHeader",new Set),Po(this,yl,!1),Po(this,Bs,!1),Po(this,bl,"unknown"),Po(this,js,-1),this.settings=e,this.tableProps=r,this.highlight=new QV({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[$T()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),hn(Tt,this,new Mg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),hn(Ai,this,new Mg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Fe(Tt,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Fe(Tt,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Fe(Tt,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Fe(Tt,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Fe(Tt,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Fe(Tt,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Fe(Tt,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Fe(Tt,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Fe(Ai,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Fe(Ai,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){hn(bl,this,e)}markEndSource(){hn(bl,this,"unknown")}getSelectionSource(){return Fe(bl,this)}setExpectedLayers(e){hn(js,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,hn(js,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ft(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();hn(yl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&Ft(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!o||i===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(r),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Fe(js,this)===-1||this.selectedRange.size()===Fe(js,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&($(this.highlight.getAreas(),w=>void w.clear()),$(this.highlight.getLayeredAreas(),w=>void w.clear()),$(this.highlight.getRowHeaders(),w=>void w.clear()),$(this.highlight.getColumnHeaders(),w=>void w.clear()),$(this.highlight.getActiveRowHeaders(),w=>void w.clear()),$(this.highlight.getActiveColumnHeaders(),w=>void w.clear()),$(this.highlight.getActiveCornerHeaders(),w=>void w.clear()),$(this.highlight.getRowHighlights(),w=>void w.clear()),$(this.highlight.getColumnHighlights(),w=>void w.clear())),this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(Qm,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(I_,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(v).commit(),d.add(b).commit(),g.add(v).commit()):(a.add(b).add(T).commit(),l.add(v).add(E).commit(),d.add(b).add(T).commit(),g.add(v).add(E).commit())}const w=!Fe(Bs,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!Fe(Bs,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&y&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(gu,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(hn(yl,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Fe(Tt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Tt,this).resetOffsetSize(),this.setRangeStart(Fe(Tt,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?Fe(Tt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Tt,this).resetOffsetSize(),this.setRangeEnd(Fe(Tt,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?Fe(Ai,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Fe(Ai,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Fe(Ai,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ae(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(Ae(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ae(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ae(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,Ae(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ae(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const r=dr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&Fe(yl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;hn(Bs,this,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ae(d.row,u,o-1),Ae(d.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),hn(Bs,this,!1)}selectCells(e){var r=this;const n=Xu(e);if(n===Ku)return!1;if(n===Gu)throw new Error(tr`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Np(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),$(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,w=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(g=Ae(n.row,u,s-1),w=Ae(n.col,Math.min(i,o),Math.max(i,o))):(g=Ae(n,u,s-1),w=i);const y=this.tableProps.createCellCoords(g,w),b=l===0?0:Ae(y.row,u,-1),T=s-1,v=this.tableProps.createCellCoords(b,i),E=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",v,E,y),v.row=b,E.row=T,this.setRangeStartOnly(v,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",v,E,y),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=Ae(n.row,Math.min(e,r),Math.max(e,r)),d=Ae(n.col,a,o-1)):(h=e,d=Ae(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),w=s===0?0:Ae(g.col,a,-1),y=o-1,b=this.tableProps.createCellCoords(e,w),T=this.tableProps.createCellCoords(r,y);this.runLocalHooks("beforeSelectRows",b,T,g),b.col=w,T.col=y,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",b,T,g),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:Ae(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Ae(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ae(a.row,-1/0,c),col:Ae(a.col,-1/0,h)}),l.assign({row:Ae(l.row,-1/0,c),col:Ae(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(gu,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Ke(oO,_n);const WS=/^(\r\n|\n\r|\r|\n)/,uW=/^[^\t\r\n]+/,$S=/^\t/;function cW(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match($S))t=t.replace($S,""),r+=1,e[n][r]="";else if(t.match(WS))t=t.replace(WS,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(uW);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function fa(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Di(t,e,r){return(e=hW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hW(t){var e=dW(t,"string");return typeof e=="symbol"?e:e+""}function dW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yo{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Di(this,"hot",void 0),Di(this,"metaManager",void 0),Di(this,"tableMeta",void 0),Di(this,"dataSource",void 0),Di(this,"duckSchema",void 0),Di(this,"colToPropCache",void 0),Di(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=km(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(Ct(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return k_(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&_e(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&fe(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(fe(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ba(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=wr(this.getSchema()):(w=[],Ye(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},BT(w,this.getSchema())),d.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let w=d;g<r&&l+g<s;w++){if(typeof c!="number"||c>=l+g)if(u>0)for(let y=0;y<u;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<u;y++)o[y].splice(w,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=fe(this.tableMeta.columns)||fe(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Gb(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return FA(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Gb(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Cn(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=dr(a);this.hot.runHooks("modifyData",e,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=dr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Cn(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Yo.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Yo.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return fa(this.getRange(e,r,Yo.DESTINATION_RENDERER))}getCopyableText(e,r){return fa(this.getRange(e,r,Yo.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:fW,getItem:gW,hasItem:sO}=po("cellTypes");function mW(t){if(!sO(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return gW(t)}function pW(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&u_(t,r),n&&BN(t,n),i&&YN(t,i),fW(t,e)}function wW(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Cn(e,t)}function Zu(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?mW(e.type):e.type;if(t._automaticallyAssignedMetaProps&&_e(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ct(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};_e(n,(o,s)=>{if(wW(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),vi(t,i)}function vW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}lD(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Yl(t){return Number.isInteger(t)&&t>=0}function ql(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Cl(t){return t==null}const aO=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Ji(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Ji(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),jT(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function BS(t,e,r){return(e=yW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yW(t){var e=bW(t,"string");return typeof e=="symbol"?e:e+""}function bW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CW(){return class{}}class SW{constructor(e){BS(this,"metaCtor",CW()),BS(this,"meta",void 0),this.meta=this.metaCtor.prototype,vi(this.meta,aO()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;vi(this.meta,e),Zu(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function RW(t,e,r){return(e=EW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EW(t){var e=TW(t,"string");return typeof e=="symbol"?e:e+""}function TW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _W{constructor(e){RW(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){vi(this.meta,e),Zu(this.meta,e,e)}}function Sl(t,e,r){return(e=OW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OW(t){var e=MW(t,"string");return typeof e=="symbol"?e:e+""}function MW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wu{constructor(e){Sl(this,"valueFactory",void 0),Sl(this,"data",[]),Sl(this,"index",[]),Sl(this,"holes",new Set),this.valueFactory=e}obtain(e){ql(()=>Yl(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ql(()=>Yl(e)||Cl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Cl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ql(()=>Yl(e)||Cl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Cl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function jS(t,e,r){return(e=IW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IW(t){var e=PW(t,"string");return typeof e=="symbol"?e:e+""}function PW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const xW=["data","width"];class HW{constructor(e){jS(this,"globalMeta",void 0),jS(this,"metas",new wu(()=>this._createMeta())),this.globalMeta=e,this.metas=new wu(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);vi(n,r),Zu(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return vW(this.globalMeta.getMetaConstructor(),xW).prototype}}function zS(t,e,r){return(e=AW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AW(t){var e=DW(t,"string");return typeof e=="symbol"?e:e+""}function DW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NW{constructor(e){zS(this,"columnMeta",void 0),zS(this,"metas",new wu(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);vi(i,n),Zu(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)fe(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){ql(()=>Yl(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new wu(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class lO{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new SW(e),this.tableMeta=new _W(this.globalMeta),this.columnMeta=new HW(this.globalMeta),this.cellMeta=new NW(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ke(lO,_n);function US(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Wu(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Ie(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Yo(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let y,b=0,T=0;for(b=0,T=d.startRows;b<T;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)y=wr(w),t.push(y);else if(i.dataType==="array")y=wr(w[0]),t.push(y);else{y=[];for(let v=0,E=d.startCols;v<E;v++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Te(i.rootElement,[VT(-1),$u(i.countCols()+(i.view?i.countRowHeaders():0))])}function YS(t,e,r){return(e=kW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kW(t){var e=LW(t,"string");return typeof e=="symbol"?e:e+""}function LW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FW{constructor(e){var r=this;YS(this,"metaManager",void 0),YS(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),de.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Cn(e,"type")?e.type:null;let c=Ie(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function VW(t,e,r){WW(t,e),e.set(t,r)}function WW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ff(t,e,r){return(e=$W(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $W(t){var e=BW(t,"string");return typeof e=="symbol"?e:e+""}function BW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jW(t,e){return t.get(zW(t,e))}function zW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qS=new WeakMap;class UW{constructor(e){Ff(this,"metaManager",void 0),Ff(this,"usageTracker",new Set),Ff(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),VW(this,qS,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,jW(qS,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const uO="gridDefault",cO="editorManager.handlingEditor",YW={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},qW="hooksRefRegisterer",hO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){$(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){_e(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Xn(hO,"MIXIN_NAME",qW,{writable:!1,enumerable:!1});function Ur(t,e,r){return(e=GW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GW(t){var e=KW(t,"string");return typeof e=="symbol"?e:e+""}function KW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const XW="base",it=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class kp{static get EDITOR_TYPE(){return XW}constructor(e){Ur(this,"hot",void 0),Ur(this,"state",it.VIRGIN),Ur(this,"_opened",!1),Ur(this,"_fullEditMode",!1),Ur(this,"_closeCallback",null),Ur(this,"TD",null),Ur(this,"row",null),Ur(this,"col",null),Ur(this,"prop",null),Ur(this,"originalValue",null),Ur(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:it.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==it.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=it.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Zo(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===it.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===it.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=it.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=it.FINISHED,this.discardEditor(s)}):(this.state=it.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=it.FINISHED,this.discardEditor()}discardEditor(e){this.state===it.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=it.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=it.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===it.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Ar(r),a=er(r),l=Ar(this.hot.rootElement),u=er(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:y}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=y.name,T=["master","inline_start"].includes(b)?d:0,v=["master","top","bottom"].includes(b)?g:0,E=s.top===l.top?0:1;let _=s.top-l.top-E-T,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-w-1+v:M=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(b)&&(_+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),F=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),H=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&x<=0||x===H)&&(_+=1),F<=0&&(M+=1);const G=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,ae=Math.abs(n.inlineStartOverlay.getScrollPosition()),q=n.topOverlay.getScrollPosition(),ee=nr(this.hot.rootDocument);let lt=r.offsetTop;if(["inline_start","master"].includes(b)&&(lt+=G-q),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:O,wtTable:I}=n.bottomOverlay.clone;lt+=O.getWorkspaceHeight()-I.getHeight()-ee}let Re=r.offsetLeft;this.hot.isRtl()?(Re>=0?Re=y.getWidth()-r.offsetLeft:Re=Math.abs(Re),Re+=J-ae-a):["top","master","bottom"].includes(b)&&(Re+=J-ae);const ve=o.getComputedStyle(this.TD),qe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Be=parseInt(ve[qe],10)>0?0:1,Oe=parseInt(ve.borderTopWidth,10)>0?0:1,Cr=er(r)+Be,f=rr(r)+Oe,m=ID(c)?ee:0,p=PD(h)?ee:0,C=this.hot.view.maximumVisibleElementWidth(Re)-m+Be,R=Math.max(this.hot.view.maximumVisibleElementHeight(lt)-p+Oe,this.hot.stylesHandler.getDefaultRowHeight());return{top:_,start:M,height:f,maxHeight:R,width:Cr,maxWidth:C}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Ke(kp,hO);const ZW={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===it.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},QW={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},JW={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},e$={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},t$={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),ju(e))}};function r$(){return[YW,ZW,QW,JW,e$,t$]}const n$={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},i$={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},o$={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},s$={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},a$={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},l$={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},u$={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},c$={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},h$={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},d$={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},f$={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},g$={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},m$={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},p$={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function w$(){return[n$,i$,o$,s$,a$,l$,u$,c$,h$,d$,f$,g$,m$,p$]}const v$={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},y$={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},b$={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-o.row,-o.col):r.transformStart(-o.row,-o.col),r.markEndSource()}},C$={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(o.row,o.col):r.transformStart(o.row,o.col),r.markEndSource()}},S$={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},R$={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},E$={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},T$={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},_$={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},O$={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},M$={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},I$={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},P$={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},x$={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},H$={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},A$={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function D$(){return[v$,y$,b$,C$,S$,R$,E$,T$,_$,O$,M$,I$,P$,x$,H$,A$]}const N$={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},k$={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},L$={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},F$={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},V$={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},W$=[...r$(),...w$(),...D$(),N$,k$,L$,F$,V$];function dO(t){const e={};return W$.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function $$(t){const e=t.getShortcutManager().addContext("editor"),r=dO(t),n={group:cO};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function B$(t){const e=t.getShortcutManager().addContext("grid"),r=dO(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return fe(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:uO};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:cO,runOnlyIf:()=>fe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function j$(t){[B$,$$].forEach(e=>e(t))}function z$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=GS(t),i=GS(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.before(n),r.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function GS(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Te(r,[uu("Focus catcher")]),r}function U$(t){const e=Y$(t);let r;const{activate:n,deactivate:i}=z$(t,{onFocusFromTop(){var h;const d=(h=e(r))!==null&&h!==void 0?h:Ig(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(r))!==null&&h!==void 0?h:Pg(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,d,g,w,y)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,y.value=!0),s){var b;r=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:uO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?Ig(t):Pg(t)),u(),!1;h.preventDefault()},position:"after"}])}function Ig(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Pg(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function Y$(t){return e=>{if(!e)return null;const r=Ig(t),n=Pg(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function ps(t){Xi(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Qu(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,y=g<=h,b=w>=d;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?n.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:y&&b?n.highlight.row:y?g:b?w:T.row}}}function q$(t){return e=>{const r=Qu(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;ps(t.getCell(n?-1:0,r,!0))})}}function G$(){return()=>{}}function K$(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;ps(t.getCell(r,n,!0))})}}function X$(t){return e=>{const r=Qu(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;ps(t.getCell(i,o,!0))})}}function Z$(t){return e=>{const r=Qu(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;ps(t.getCell(i,o,!0))})}}function Q$(t){return e=>{const r=Qu(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;ps(t.getCell(r,n?-1:0,!0))})}}function J$(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{ps(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function eB(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=K$(t):e.isSelectedByCorner()?s=G$():e.isSelectedByRowHeader()?s=Q$(t):e.isSelectedByColumnHeader()?s=q$(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=X$(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=J$(t):e.getSelectedRange().size()>1&&(s=Z$(t)),(o=s)===null||o===void 0||o(i)}}}const KS=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Rl=t=>t.map(e=>{const r=e.toLowerCase();return KS.has(r)?KS.get(r):r}).sort().join("+"),tB=t=>t.split("+"),XS=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Vf=t=>{let{which:e,key:r}=t;if(XS.has(e))return XS.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},fO=Symbol("shortcut-context");function gO(t){return Ct(t)&&t.__kindOf===fO}const rB=t=>{const e=zu({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:w=!1,relativeToGroup:y,position:b,forwardToContext:T}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ft(c))throw new Error("You need to define the shortcut's group.");if(Ie(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(tr`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:w};fe(y)&&(v.relativeToGroup=y,v.position=b),gO(T)&&(v.forwardToContext=T),l.forEach(E=>{const _=Rl(E);if(e.hasItem(_)){const P=e.getItem(_);let x=P.findIndex(F=>F.group===y);x!==-1?b==="before"?x-=1:x+=1:x=P.length,P.splice(x,0,v)}else e.addItem(_,[v])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{_e(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),r(c)})},i=l=>{const u=Rl(l);e.removeItem(u)};return{__kindOf:fO,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=Rl(l),c=e.getItem(u);return fe(c)?c.slice():[]},hasShortcut:l=>{const u=Rl(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(w=>w.group!==l);g.length===0?i(tB(h)):(d.length=0,d.push(...g))})}}};function nB(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const iB=["meta","alt","shift","control"],zs=nB(),Us=[];let El=0;function oB(t,e,r,n,i){const o=g=>iB.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),w&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||Bi(g))return;const y=Vf(g);let b=[];o(y)||(b=s(g));const T=[y].concat(b);!i(g,T)&&(aC()&&b.includes("meta")||!aC()&&b.includes("control"))&&i(g,[y].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const w=Vf(g);o(w)&&zs.press(w)}},u=g=>{if(typeof g.key=="string"){const w=Vf(g);o(w)&&zs.release(w)}},c=()=>{zs.releaseAll()};return{mount:()=>{let g=t;for(El+=1;g;)El===1&&(g.document.documentElement.addEventListener("keydown",l),Us.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),Us.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Ca(g)},unmount:()=>{let g=t;for(El-=1;g;){if(El===0){for(let w=0;w<Us.length;w++){const{event:y,listener:b}=Us[w];g.document.documentElement.removeEventListener(y,b)}Us.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Ca(g)}},isPressed:g=>zs.isPressed(g),releasePressedKeys:()=>zs.releaseAll()}}const sB=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=zu({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const y=rB(w);return o.addItem(w,y),y},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(tr`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let h=!1;const d=function(w,y){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const T=gO(b)?b:u(b);let v=!1;if(!T.hasShortcut(y))return v;const E=T.getShortcuts(y);for(let _=0;_<E.length;_++){const{callback:M,runOnlyIf:P,preventDefault:x,stopPropagation:F,captureCtrl:U,forwardToContext:H}=E[_];if(P(w)===!0){if(h=U,v=M(w,y)===!1,h=!1,x&&w.preventDefault(),F&&(ju(w),w.stopPropagation()),v)break;H&&d(w,y,H)}}return v},g=oB(e,r,n,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};function ZS(t){const{classNames:e}=bD(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function aB(t,e){mO(t,e),e.add(t)}function Ni(t,e,r){mO(t,e),e.set(t,r)}function mO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(Xr(t,e))}function xr(t,e,r){return t.set(Xr(t,e),r),r}function Xr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const QS=23;var ki=new WeakMap,vu=new WeakMap,Lp=new WeakMap,xg=new WeakMap,si=new WeakMap,ia=new WeakMap,Ra=new WeakMap,fn=new WeakSet;class lB{constructor(e,r){aB(this,fn),Ni(this,ki,void 0),Ni(this,vu,void 0),Ni(this,Lp,void 0),Ni(this,xg,void 0),Ni(this,si,!0),Ni(this,ia,{}),Ni(this,Ra,{}),xr(vu,this,e),xr(xg,this,r)}isClassicTheme(){return Mt(si,this)}getCSSVariableValue(e){var r;if(Mt(si,this))return null;if(Mt(ia,this)[`--ht-${e}`])return Mt(ia,this)[`--ht-${e}`];const n=(r=Xr(fn,this,hB).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Xr(fn,this,pO).call(this,`--ht-${e}`);if(n!==null)return Mt(ia,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Mt(Ra,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Mt(si,this))return QS;const e=Xr(fn,this,uB).call(this);return e||QS}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){xr(ki,this,void 0),xr(si,this,!0),Xr(fn,this,Wf).call(this);return}if(e&&e!==Mt(ki,this)){if(!/ht-theme-.*/.test(e)){Sn(`Invalid theme name: ${e}. Please provide a valid theme name.`),xr(ki,this,void 0),xr(si,this,!1),Xr(fn,this,Wf).call(this);return}Mt(ki,this)&&Xr(fn,this,dB).call(this),xr(ki,this,e),xr(si,this,!1),Xr(fn,this,Wf).call(this)}}getThemeName(){return Mt(ki,this)}}function uB(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function Wf(){this.isClassicTheme()||xr(Lp,this,getComputedStyle(Mt(vu,this)));const t=Xr(fn,this,cB).call(this,["box-sizing","border-bottom-width"]);Mt(Ra,this).td={...Mt(Ra,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function cB(t){const e=Mt(xg,this),r=Mt(vu,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function hB(t){const e=Math.ceil(parseFloat(Xr(fn,this,pO).call(this,t)));return Number.isNaN(e)?null:e}function pO(t){const e=Mt(Lp,this).getPropertyValue(t);return e===""?null:e}function dB(){xr(Ra,this,{}),xr(ia,this,{}),xr(si,this,!0)}function fB(t,e){wO(t,e),e.add(t)}function JS(t,e,r){wO(t,e),e.set(t,r)}function wO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eR(t,e){return t.get(rs(t,e))}function tR(t,e,r){return t.set(rs(t,e),r),r}function rs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hg=new WeakMap,Ag=new WeakMap,ga=new WeakSet;class gB{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;fB(this,ga),JS(this,Hg,void 0),JS(this,Ag,void 0),tR(Hg,this,r),tR(Ag,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=rs(ga,this,rR).call(this,e.from,r,n);if(i===null)return null;const o=rs(ga,this,rR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function rR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=rs(ga,this,nR).call(this,eR(Hg,this),t.row,e);if(n===null)return null;const i=rs(ga,this,nR).call(this,eR(Ag,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function nR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let $f=null;const Bf=new Map;function vO(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new yi(o);let a,l,u,c,h,d,g=!0;VF(i)&&FF(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=jo(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,jo(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),X(this.rootElement,"ht-wrapper"),X(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),X(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new lB(o.rootElement,o.rootDocument),e.language=LV(e.language);const b=Object.fromEntries(Object.entries(e).filter(f=>{let[m]=f;return!(de.getSingleton().isRegistered(m)||de.getSingleton().isDeprecated(m))})),T=new lO(o,b,[FW,UW]),v=T.getTableMeta(),E=T.getGlobalMeta(),_=zu();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),jo(this)&&BA(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${NT()}`,Bf.set(this.guid,this),this.columnIndexMapper=new _g,this.rowIndexMapper=new _g,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterRowSequenceChange",f)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{o.runHooks("beforeCompositionStart",f)}),l=new QF(o);const M=po(this.guid);M.register("cellRangeMapper",new gB({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=f=>{const{row:m,col:p}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},x=f=>{const{row:m,col:p}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},F=(f,m)=>{const p=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.rowIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>R||p===-1&&O<C?null:O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O},U=(f,m)=>{const p=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.columnIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>R||p===-1&&O<C?null:O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O};let H=new oO(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:f=>a.propToCol(f),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(f,m)=>o._createCellCoords(f,m),createCellRange:(f,m,p)=>o._createCellRange(f,m,p),visualToRenderableCoords:P,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:F,findFirstNonHiddenRenderableColumn:U,isDisabledCellSelection:(f,m)=>f<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(f,m).disableVisualSelection});this.selection=H;const G=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const p=dr(!1),C=this.selection.getSelectedRange(),{from:R,to:O}=C.current(),I=C.size()-1;this.runHooks("afterSelection",R.row,R.col,O.row,O.col,p,I),this.runHooks("afterSelectionByProp",R.row,o.colToProp(R.col),O.row,o.colToProp(O.col),p,I),m&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(f);const D=H.isSelectedByRowHeader(),j=H.isSelectedByColumnHeader();D&&j?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):D?(xe(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):j?(xe(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(H.getSelectionSource())||c.closeEditor(null),H.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=dr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(f),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:p,to:C}=f[m];this.runHooks("afterSelectionEnd",p.row,p.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),C.row,o.colToProp(C.col),m),H.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),xe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),u={alter(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;const O=I=>{if(I.length===0)return[];const D=[...I];return D.sort((V,A)=>{let[W]=V,[te]=A;return W===te?0:W>te?1:-1}),go(D,(V,A)=>{let[W,te]=A;const oe=V[V.length-1],[Me,ye]=oe,re=Me+ye;if(W<=re){const Ee=Math.max(te-(re-W),0);oe[1]+=Ee}else V.push([W,te]);return V},[D[0]])};switch(f){case"insert_row_below":case"insert_row_above":const I=o.countSourceRows();if(v.maxRows===I)return;const D=f==="insert_row_below"?"below":"above";m=m??(D==="below"?I:0);const{delta:j,startPhysicalIndex:V}=a.createRow(m,p,{source:C,mode:D});H.shiftRows(o.toVisualRow(V),j);break;case"insert_col_start":case"insert_col_end":const A=f==="insert_col_end"?"end":"start";m=m??(A==="end"?o.countSourceCols():0);const{delta:W,startPhysicalIndex:te}=a.createCol(m,p,{source:C,mode:A});if(W){if(Array.isArray(v.colHeaders)){const ye=[o.toVisualColumn(te),0];ye.length+=W,Array.prototype.splice.apply(v.colHeaders,ye)}H.shiftColumns(o.toVisualColumn(te),W)}break;case"remove_row":const oe=ye=>{let re=0;$(ye,Ee=>{let[ce,Pe]=Ee;const Ge=Ji(ce)?o.countRows()-1:Math.max(ce-re,0);if(Number.isInteger(ce)&&(ce=Math.max(ce-re,0)),!a.removeRow(ce,Pe,C))return;if(H.isSelected()){const{row:ft}=o.getSelectedRangeLast().highlight;ft>=ce&&ft<=ce+Pe-1&&c.closeEditor(!0)}const sr=o.countRows(),St=v.fixedRowsTop;St>=Ge+1&&(v.fixedRowsTop-=Math.min(Pe,St-Ge));const Sr=v.fixedRowsBottom;if(Sr&&Ge>=sr-Sr&&(v.fixedRowsBottom-=Math.min(Pe,Sr)),sr===0)H.deselect();else if(C==="ContextMenu.removeRow"){const ft=H.getSelectedRange(),$t=ft.pop();ft.clear().set($t.from).current().setTo($t.to),H.refresh()}else H.shiftRows(ce,-Pe);re+=Pe})};Array.isArray(m)?oe(O(m)):oe([[m,p]]);break;case"remove_col":const Me=ye=>{let re=0;$(ye,Ee=>{let[ce,Pe]=Ee;const Ge=Ji(ce)?o.countCols()-1:Math.max(ce-re,0);let or=o.toPhysicalColumn(Ge);if(Number.isInteger(ce)&&(ce=Math.max(ce-re,0)),!a.removeCol(ce,Pe,C))return;if(H.isSelected()){const{col:ft}=o.getSelectedRangeLast().highlight;ft>=ce&&ft<=ce+Pe-1&&c.closeEditor(!0)}if(o.countCols()===0)H.deselect();else if(C==="ContextMenu.removeColumn"){const ft=H.getSelectedRange(),$t=ft.pop();ft.clear().set($t.from).current().setTo($t.to),H.refresh()}else H.shiftColumns(ce,-Pe);const Sr=v.fixedColumnsStart;Sr>=Ge+1&&(v.fixedColumnsStart-=Math.min(Pe,Sr-Ge)),Array.isArray(v.colHeaders)&&(typeof or>"u"&&(or=-1),v.colHeaders.splice(or,Pe)),re+=Pe})};Array.isArray(m)?Me(O(m)):Me([[m,p]]);break;default:throw new Error(`There is no such action "${f}"`)}R||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const f=v.minRows,m=v.minSpareRows,p=v.minCols,C=v.minSpareCols;if(f){const R=o.countRows();R<f&&a.createRow(R,f-R,{source:"auto"})}if(m){const R=o.countEmptyRows(!0);if(R<m){const O=m-R,I=Math.min(O,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),I,{source:"auto"})}}{let R;(p||C)&&(R=o.countEmptyCols(!0));let O=o.countCols();if(p&&!v.columns&&O<p){const I=p-O;R+=I,a.createCol(O,I,{source:"auto"})}if(C&&!v.columns&&o.dataType==="array"&&R<C){O=o.countCols();const I=C-R,D=Math.min(I,v.maxCols-O);a.createCol(O,D,{source:"auto"})}}},populateFromArray(f,m,p,C,R){let O,I,D,j;const V=[],A={},W=[],te=f.row,oe=f.col;if(I=m.length,I===0)return!1;let Me=0,ye=0;switch(Ct(p)&&(Me=p.col-oe+1,ye=p.row-te+1),R){case"shift_down":const re=Zd(m),Ee=re.length,ce=Math.max(Ee,Me),Pe=o.getData().slice(te),Ge=Zd(Pe).slice(oe,oe+ce);for(D=0;D<ce;D+=1)if(D<Ee){for(O=0,I=re[D].length;O<ye-I;O+=1)re[D].push(re[D][O%I]);D<Ge.length?W.push(re[D].concat(Ge[D])):W.push(re[D].concat(new Array(Pe.length).fill(null)))}else W.push(re[D%Ee].concat(Ge[D]));o.populateFromArray(te,oe,Zd(W));break;case"shift_right":const or=m.length,sr=Math.max(or,ye),St=o.getData().slice(te).map(ut=>ut.slice(oe));for(O=0;O<sr;O+=1)if(O<or){for(D=0,j=m[O].length;D<Me-j;D+=1)m[O].push(m[O][D%j]);if(O<St.length)for(let ut=0;ut<St[O].length;ut+=1)m[O].push(St[O][ut]);else m[O].push(...new Array(St[0].length).fill(null))}else m.push(m[O%I].slice(0,sr).concat(St[O]));o.populateFromArray(te,oe,m);break;case"overwrite":default:A.row=f.row,A.col=f.col;let Sr=0,ft=0,$t=!0,On;const ws=function($r){let on=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Mn=m[$r%m.length];return on!==null?Mn[on%Mn.length]:Mn},Ei=m.length,Qn=p?p.row-f.row+1:0;for(p?I=Qn:I=Math.max(Ei,Qn),O=0;O<I&&!(p&&A.row>p.row&&Qn>Ei||!v.allowInsertRow&&A.row>o.countRows()-1||A.row>=v.maxRows);O++){const ut=O-Sr,$r=ws(ut).length,on=p?p.col-f.col+1:0;if(p?j=on:j=Math.max($r,on),A.col=f.col,On=o.getCellMeta(A.row,A.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&On.skipRowOnPaste){Sr+=1,A.row+=1,I+=1;continue}for(ft=0,D=0;D<j&&!(p&&A.col>p.col&&on>$r||!v.allowInsertColumn&&A.col>o.countCols()-1||A.col>=v.maxCols);D++){if(On=o.getCellMeta(A.row,A.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&On.skipColumnOnPaste){ft+=1,A.col+=1,j+=1;continue}if(On.readOnly&&C!=="UndoRedo.undo"){A.col+=1;continue}const Mn=D-ft;let Rr=ws(ut,Mn),Pt=o.getDataAtCell(A.row,A.col);if(Rr!==null&&typeof Rr=="object")if(Array.isArray(Rr)&&Pt===null&&(Pt=[]),Pt===null||typeof Pt!="object")$t=!1;else{const Ti=ba(Array.isArray(Pt)?Pt:Pt[0]||Pt),za=ba(Array.isArray(Rr)?Rr:Rr[0]||Rr);jT(Ti,za)||Array.isArray(Ti)&&Array.isArray(za)?Rr=wr(Rr):$t=!1}else Pt!==null&&typeof Pt=="object"&&($t=!1);$t&&V.push([A.row,A.col,Rr]),$t=!0,A.col+=1}A.row+=1}o.setDataAtCell(V,null,null,C||"populateFromArray");break}}};function J(f){const m=q_(f);Hp(m)?(o.runHooks("beforeLanguageChange",m),E.language=m,o.runHooks("afterLanguageChange",m)):G_(f)}function ae(f,m){const p=f==="className"?o.rootElement:o.table;if(g)X(p,m);else{let C=[],R=[];E[f]&&(C=Array.isArray(E[f])?E[f]:Xb(E[f])),m&&(R=Array.isArray(m)?m:Xb(m));const O=Kb(C,R),I=Kb(R,C);O.length&&xe(p,O),I.length&&X(p,I)}E[f]=m}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(fi()||UT())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new jF(this);const f=v.themeName||ZS(o.rootContainer);o.useTheme(f),c=Sg.getInstance(o,v,H),d=eB(o),h=new dN(o),jo(this)&&U$(o),o.runHooks("init"),this.render(),g&&o.rootElement.offsetParent===null&&xD(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function q(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function ee(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function lt(f,m,p){if(!f.length){p();return}const C=o.getActiveEditor(),R=new q;let O=!0;R.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),p()};for(let I=f.length-1;I>=0;I--){const[D,j]=f[I],V=a.propToCol(j);let A;Number.isInteger(V)?A=o.getCellMeta(D,V):A={...Object.getPrototypeOf(v),...v},o.getCellValidator(A)&&(R.addValidatorToQueue(),o.validateCell(f[I][3],A,function(W,te){return function(oe){if(typeof oe!="boolean")throw new Error("Validation error: result is not boolean");oe===!1&&te.allowInvalid===!1&&(O=!1,f.splice(W,1),te.valid=!0),R.removeValidatorFormQueue()}}(I,A),m))}R.checkIfQueueIsEmpty()}function Re(f,m){for(let C=f.length-1;C>=0;C--){let R=!1;if(f[C]===null){f.splice(C,1);continue}if(!((f[C][2]===null||f[C][2]===void 0)&&(f[C][3]===null||f[C][3]===void 0))){if(v.allowInsertRow)for(;f[C][0]>o.countRows()-1;){const{delta:O}=a.createRow(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(f[C][1])>o.countCols()-1;){const{delta:O}=a.createCol(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}R||a.set(f[C][0],f[C][1],f[C][3])}}if(f.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",f,m),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",f,m||"edit");const C=o.getActiveEditor();C&&fe(C.refreshValue)&&C.refreshValue()}else o.render()}this._createCellCoords=function(f,m){return o.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,p){return o.view._wt.createCellRange(f,m,p)},this.validateCell=function(f,m,p,C){let R=o.getCellValidator(m);function O(I){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(I);return}const j=m.visualCol,V=m.visualRow,A=o.getCell(V,j,!0);if(A&&A.nodeName!=="TH"){const W=o.rowIndexMapper.getRenderableFromVisualIndex(V),te=o.columnIndexMapper.getRenderableFromVisualIndex(j);o.view._wt.getSetting("cellRenderer",W,te,A)}p(I)}VA(R)&&(R=function(I){return function(D,j){j(I.test(D))}}(R)),Ie(R)?(f=o.runHooks("beforeValidate",f,m.visualRow,m.prop,C),o._registerImmediate(()=>{R.call(m,f,I=>{o&&(I=o.runHooks("afterValidate",I,f,m.visualRow,m.prop,C),m.valid=I,O(I),o.runHooks("postAfterValidate",I,f,m.visualRow,m.prop,C))})})):o._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function ve(f,m,p){return Array.isArray(f)?f:[[f,m,p]]}function qe(f,m){const p=o.runHooks("beforeChange",f,m||"edit"),C=f.filter(O=>O!==null);if(p===!1||C.length===0){var R;return(R=o.getActiveEditor())===null||R===void 0||R.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[I,D,,j]=C[O],V=a.propToCol(D);let A;Number.isInteger(V)?A=o.getCellMeta(I,V):A={...Object.getPrototypeOf(v),...v};const{type:W,checkedTemplate:te,uncheckedTemplate:oe}=A;if(W==="numeric"&&typeof j=="string"&&_N(j)&&(C[O][3]=ee(j)),W==="checkbox"){const Me=Zo(j),ye=Me===Zo(te),re=Me===Zo(oe);(ye||re)&&(C[O][3]=ye?te:oe)}}return C}this.setDataAtCell=function(f,m,p,C){const R=ve(f,m,p),O=[];let I=C,D,j,V;for(D=0,j=R.length;D<j;D++){if(typeof R[D]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[D][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[D][1]>=this.countCols()?V=R[D][1]:V=a.colToProp(R[D][1]),O.push([R[D][0],V,l.getAtCell(this.toPhysicalRow(R[D][0]),R[D][1]),R[D][2]])}!I&&typeof f=="object"&&(I=m);const A=qe(O,I);o.runHooks("afterSetDataAtCell",A,I),lt(A,I,()=>{Re(A,I)})},this.setDataAtRowProp=function(f,m,p,C){const R=ve(f,m,p),O=[];let I=C,D,j;for(D=0,j=R.length;D<j;D++)O.push([R[D][0],R[D][1],l.getAtCell(this.toPhysicalRow(R[D][0]),R[D][1]),R[D][2]]);!I&&typeof f=="object"&&(I=m);const V=qe(O,C);o.runHooks("afterSetDataAtRowProp",V,I),lt(V,I,()=>{Re(V,I)})},this.listen=function(){o&&!o.isListening()&&(Bf.forEach(f=>{o!==f&&f.unlisten()}),$f=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&($f=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return $f===o.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(f),o.view.render(),m&&H.isSelected()&&c.prepareEditor()},this.populateFromArray=function(f,m,p,C,R,O,I){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const D=typeof C=="number"?o._createCellCoords(C,R):null;return u.populateFromArray(o._createCellCoords(f,m),p,D,O,I)},this.spliceCol=function(f,m,p){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceCol(f,m,p,...R)},this.spliceRow=function(f,m,p){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceRow(f,m,p,...R)},this.getSelected=function(){if(H.isSelected())return bn(H.getSelectedRange(),f=>{let{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(H.isSelected())return Array.from(H.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!H.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];$(H.getSelectedRange(),p=>{if(p.isSingleHeader())return;const C=p.getTopStartCorner(),R=p.getBottomEndCorner();Ye(C.row,R.row,O=>{Ye(C.col,R.col,I=>{this.getCellMeta(O,I).readOnly||m.push([O,I,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=f();return this.resumeExecution(m),p},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const f=o.view,{width:m,height:p}=f.getLastSize(),{width:C,height:R}=o.rootElement.getBoundingClientRect(),O=C!==m||R!==p;o.runHooks("beforeRefreshDimensions",{width:m,height:p},{width:C,height:R},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===o.rootWindow)&&(f.setLastSize(C,R),o.render(),f.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:m,height:p},{width:C,height:R},O))},this.updateData=function(f,m){US(f,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),H.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:T,firstRun:g})},this.loadData=function(f,m){US(f,p=>{a=p},()=>{T.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),H.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:T,firstRun:g})},this.getInitialColumnCount=function(){const f=v.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Ie(f))if(o.dataType==="array"){const p=this.countSourceCols();for(let C=0;C<p;C+=1)f(C)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(fe(v.dataSchema)){const p=a.getSchema();m=Array.isArray(p)?p.length:km(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,p,C){return Ft(f)?a.getAll():a.getRange(o._createCellCoords(f,m),o._createCellCoords(p,C),a.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,p,C){return a.getCopyableText(o._createCellCoords(f,m),o._createCellCoords(p,C))},this.getCopyableData=function(f,m){return a.getCopyable(f,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(g?o.loadData:o.updateData).bind(this);let C=!1,R,O;if(fe(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(fe(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(fe(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');f.language&&J(f.language);for(R in f)if(!(R==="data"||R==="language"))if(R==="className")ae("className",f.className);else if(R==="tableClassName"&&o.table)ae("tableClassName",f.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(de.getSingleton().isRegistered(R)||de.getSingleton().isDeprecated(R)){const A=f[R];Ie(A)?(de.getSingleton().addAsFixed(R,A,o),v[R]=A):Array.isArray(A)&&(de.getSingleton().add(R,A,o),v[R]=A)}else!m&&Cn(f,R)&&(E[R]=f[R]);f.data===void 0&&v.data===void 0?p(null,"updateSettings"):f.data!==void 0?p(f.data,"updateSettings"):f.columns!==void 0&&(a.createMap(),o.initIndexMappers());const I=o.countCols(),D=v.columns;if(D&&Ie(D)&&(C=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&T.clearCache(),I>0)for(R=0,O=0;R<I;R++){if(D){const A=C?D(R):D[O];A&&T.updateColumnMeta(O,A)}O+=1}fe(f.cell)&&_e(f.cell,A=>{o.setCellMetaObject(A.row,A.col,A)}),o.runHooks("afterCellMetaReset");let j=o.rootElement.style.height;j!==""&&(j=parseInt(o.rootElement.style.height,10));let V=f.height;if(Ie(V)&&(V=V()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),V===null){const A=o.rootElement.getAttribute("data-initialstyle");A&&(A.indexOf("height")>-1||A.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",A):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else V!==void 0&&(o.rootElement.style.height=isNaN(V)?`${V}`:`${V}px`,o.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let A=f.width;Ie(A)&&(A=A()),o.rootElement.style.width=isNaN(A)?`${A}`:`${A}px`}if(!m){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const A=o.getCurrentThemeName();Cn(f,"themeName")&&A!==f.themeName&&o.useTheme(f.themeName)}o.runHooks("afterUpdateSettings",f)}u.adjustRowsAndCols(),o.view&&!g&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(j===""||V===""||V===void 0)&&j!==V&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=o.getSelectedLast();if(v.getValue){if(Ie(v.getValue))return v.getValue.call(o);if(f)return o.getData()[f[0][0]][v.getValue]}else if(f)return o.getDataAtCell(f[0],f[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,p,C,R){u.alter(f,m,p,C,R)},this.getCell=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,R=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return R===null||C===null||R===void 0||C===void 0?null:o.view.getCellAtCoords(o._createCellCoords(R,C),p)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:p,col:C}=m;let R=p,O=C;return p>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(p)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),o._createCellCoords(R,O)},this.colToProp=function(f){return a.colToProp(f)},this.propToCol=function(f){return a.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return a.get(f,a.colToProp(m))},this.getDataAtRowProp=function(f,m){return a.get(f,m)},this.getDataAtCol=function(f){const m=[],p=a.getRange(o._createCellCoords(0,f),o._createCellCoords(v.data.length-1,f),a.DESTINATION_RENDERER);for(let C=0;C<p.length;C+=1)for(let R=0;R<p[C].length;R+=1)m.push(p[C][R]);return m},this.getDataAtProp=function(f){const m=[],p=a.getRange(o._createCellCoords(0,a.propToCol(f)),o._createCellCoords(v.data.length-1,a.propToCol(f)),a.DESTINATION_RENDERER);for(let C=0;C<p.length;C+=1)for(let R=0;R<p[C].length;R+=1)m.push(p[C][R]);return m},this.getSourceData=function(f,m,p,C){let R;return f===void 0?R=l.getData():R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(p,C)),R},this.getSourceDataArray=function(f,m,p,C){let R;return f===void 0?R=l.getData(!0):R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(p,C),!0),R},this.getSourceDataAtCol=function(f){return l.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,p,C){const R=ve(f,m,p),O=this.hasHook("afterSetSourceDataAtCell"),I=[];O&&$(R,j=>{let[V,A,W]=j;I.push([V,A,l.getAtCell(V,A),W])}),$(R,j=>{let[V,A,W]=j;l.setAtCell(V,A,W)}),O&&this.runHooks("afterSetSourceDataAtCell",I,C),this.render();const D=o.getActiveEditor();D&&fe(D.refreshValue)&&D.refreshValue()},this.getSourceDataAtRow=function(f){return l.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return l.getAtCell(f,m)},this.getDataAtRow=function(f){return a.getRange(o._createCellCoords(f,0),o._createCellCoords(f,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,p,C){const R=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,p,C],[O,I]=R;let[,,D,j]=R,V=null,A=null;D===void 0&&(D=O),j===void 0&&(j=I);let W="mixed";return Ye(Math.max(Math.min(O,D),0),Math.max(O,D),te=>{let oe=!0;return Ye(Math.max(Math.min(I,j),0),Math.max(I,j),Me=>(A=this.getCellMeta(te,Me).type,V?oe=V===A:V=A,oe)),W=oe?A:"mixed",oe}),W},this.removeCellMeta=function(f,m,p){const[C,R]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=T.getCellMetaKeyValue(C,R,p);o.runHooks("beforeRemoveCellMeta",f,m,p,O)!==!1&&(T.removeCellMeta(C,R,p),o.runHooks("afterRemoveCellMeta",f,m,p,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,C=new Array(p>2?p-2:0),R=2;R<p;R++)C[R-2]=arguments[R];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&T.removeRow(this.toPhysicalRow(f),m),C.length>0&&$(C.reverse(),O=>{T.createRow(this.toPhysicalRow(f)),$(O,(I,D)=>this.setCellMetaObject(f,D,I))}),o.render()},this.setCellMetaObject=function(f,m,p){typeof p=="object"&&_e(p,(C,R)=>{this.setCellMeta(f,m,R,C)})},this.setCellMeta=function(f,m,p,C){if(o.runHooks("beforeSetCellMeta",f,m,p,C)===!1)return;let O=f,I=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(I=this.toPhysicalColumn(m)),T.setCellMeta(O,I,p,C),o.runHooks("afterSetCellMeta",f,m,p,C)},this.getCellsMeta=function(){return T.getCellsMeta()},this.getCellMeta=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(f),R=this.toPhysicalColumn(m);return C===null&&(C=f),R===null&&(R=m),T.getCellMeta(C,R,{visualRow:f,visualColumn:m,...p})},this.getColumnMeta=function(f){return T.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return T.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(f,m){const p=typeof f=="number"?o.getCellMeta(f,m).renderer:f.renderer;return typeof p=="string"?$C(p):Ft(p)?$C("text"):p},this.getCellEditor=function(f,m){const p=typeof f=="number"?o.getCellMeta(f,m).editor:f.editor;return typeof p=="string"?SC(p):Ft(p)?SC("text"):p},this.getCellValidator=function(f,m){const p=typeof f=="number"?o.getCellMeta(f,m).validator:f.validator;return typeof p=="string"?UN(p):p},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,p){const C=new q;f&&(C.onQueueEmpty=f);let R=o.countRows()-1;for(;R>=0;){if(m!==void 0&&m.indexOf(R)===-1){R-=1;continue}let O=o.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),o.validateCell(o.getDataAtCell(R,O),o.getCellMeta(R,O),I=>{if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}R-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=v.rowHeaders,p=f;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(m=[],Ye(o.countRows()-1,C=>{m.push(o.getRowHeader(C))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:Ie(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let f=0,m=o.countCols();f<m;f++)if(o.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",f);if(p===void 0){const D=[],j=o.countCols();for(let V=0;V<j;V++)D.push(o.getColHeader(V));return D}let C=v.colHeaders;const R=function(D){const j=[],V=o.countCols();let A=0;for(;A<V;A++)Ie(v.columns)&&v.columns(A)&&j.push(A);return j[D]},O=o.toPhysicalColumn(p),I=R(O);return v.colHeaders===!1?C=null:v.columns&&Ie(v.columns)&&v.columns(I)&&v.columns(I).title?C=v.columns(I).title:v.columns&&v.columns[O]&&v.columns[O].title?C=v.columns[O].title:Array.isArray(v.colHeaders)&&v.colHeaders[O]!==void 0?C=v.colHeaders[O]:Ie(v.colHeaders)?C=v.colHeaders(O):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(C=KF(p)),C=o.runHooks("modifyColumnHeaderValue",C,f,m),C},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=o.getCellMeta(0,f).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let p=o._getColWidthFromSettings(f);return p=o.runHooks("modifyColWidth",p,f,m),p===void 0&&(p=Um),p},this._getRowHeightFromSettings=function(f){const m=o.stylesHandler.getDefaultRowHeight();let p=v.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<m?m:p},this.getRowHeight=function(f,m){let p=o._getRowHeightFromSettings(f);return p=o.runHooks("modifyRowHeight",p,f,m),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const f=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return VC(o.countRows()-1,p=>{if(o.isEmptyRow(p))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return VC(o.countCols()-1,p=>{if(o.isEmptyCol(p))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return v.isEmptyRow.call(o,f)},this.isEmptyCol=function(f){return v.isEmptyCol.call(o,f)},this.selectCell=function(f,m,p,C){let R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ft(f)||Ft(m)?!1:this.selectCells([[f,m,p,C]],R,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const C=H.selectCells(f);return C&&p&&o.listen(),d.resume(),C},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return H.selectColumns(f,m,p)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return H.selectRows(f,m,p)},this.deselectCell=function(){H.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),H.selectAll(f,m,p)};const Be=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var p;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:C,col:R,considerHiddenIndexes:O}=f??{};let I=C,D=R;if(Ie(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const W=Number.isInteger(C)&&C>=0,te=Number.isInteger(R)&&R>=0,oe=W?Be(this.rowIndexMapper,C):void 0,Me=te?Be(this.columnIndexMapper,R):void 0;if(oe===null||Me===null)return!1;I=W?o.rowIndexMapper.getRenderableFromVisualIndex(oe):C,D=te?o.columnIndexMapper.getRenderableFromVisualIndex(Me):R}const j=Number.isInteger(I),V=Number.isInteger(D);let A=!1;return j&&I>=0&&V&&D>=0?A=o.view.scrollViewport(o._createCellCoords(I,D),f.horizontalSnap,f.verticalSnap):j&&I>=0&&(V&&D<0||!V)?A=o.view.scrollViewportVertically(I,f.verticalSnap):V&&D>=0&&(j&&I<0||!j)&&(A=o.view.scrollViewportHorizontally(D,f.horizontalSnap)),Ie(m)&&(A?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),A},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Ie(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast(),p=this.scrollViewportTo(m.toObject());return p?this.view.render():Ie(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),p},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),M.clear(),T.clearCache(),Bf.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&ts(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(f=>{let[,m]=f;m.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),de.getSingleton().destroy(o),_e(o,(f,m,p)=>{Ie(f)?p[m]=Oe(m):m!=="guid"&&(p[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,H=null,c=null,o=null};function Oe(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return _.getItem(Wu(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(f)},this.getInstance=function(){return o},this.addHook=function(f,m,p){de.getSingleton().add(f,m,o,p)},this.hasHook=function(f){return de.getSingleton().has(f,o)||de.getSingleton().has(f)},this.addHookOnce=function(f,m,p){de.getSingleton().once(f,m,o,p)},this.removeHook=function(f,m){de.getSingleton().remove(f,m,o)},this.runHooks=function(f,m,p,C,R,O,I){return de.getSingleton().run(o,f,m,p,C,R,O,I)},this.getTranslatedPhrase=function(f,m){return eO(v.language,f,m)},this.toHTML=()=>LC(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",LC(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!g;this.stylesHandler.useTheme(f);const p=this.stylesHandler.getThemeName();jo(this)&&(xe(this.rootWrapperElement,/ht-theme-.*/g),xe(this.rootPortalElement,/ht-theme-.*/g),p&&(X(this.rootWrapperElement,p),X(this.rootPortalElement,p),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Sn(`The "${p}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),m||(o.render(),o.scrollViewportTo(0,0),ZS(this.rootContainer)&&(xe(this.rootContainer,/ht-theme-.*/g),p&&X(this.rootContainer,p))),this.runHooks("afterSetTheme",p,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=f;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){$(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){$(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return c};const Cr=sB({handleEvent(){return o.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&Cr.releasePressedKeys()}),this.getShortcutManager=function(){return Cr},this.getFocusManager=function(){return h},m_().forEach(f=>{const m=zm(f);_.addItem(f,new m(this))}),j$(o),Cr.setActiveContextName("grid"),de.getSingleton().run(o,"construct")}function iR(t,e,r){t.addEventListener(e,r,!1)}function oR(t,e,r){t.removeEventListener(e,r,!1)}function Tl(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function mB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=Tl(s).fontSize,o.style.fontFamily=Tl(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=Tl(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),w=parseInt(((d=Tl(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),y=o.clientWidth+g+w+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>y?b.width=`${r.minWidth}px`:y>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${y}px`;const T=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>T?b.height=`${r.minHeight}px`:r.maxHeight<T?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(iR(s,"input",a),iR(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){oR(s,"input",a),oR(s,"keydown",l)}}}function sR(t,e){const r=_D(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}e_(e,i)}function Li(t,e,r){return(e=pB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pB(t){var e=wB(t,"string");return typeof e=="symbol"?e:e+""}function wB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vB="ht_editor_visible",_l="ht_editor_hidden",aR="textEditor",yB="text";class bB extends kp{static get EDITOR_TYPE(){return yB}constructor(e){super(e),Li(this,"eventManager",new yi(this)),Li(this,"autoResize",mB(this.hot.rootDocument)),Li(this,"TEXTAREA",void 0),Li(this,"textareaStyle",void 0),Li(this,"TEXTAREA_PARENT",void 0),Li(this,"textareaParentStyle",void 0),Li(this,"layerClass",void 0),this.eventManager=new yi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),zl(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==it.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===it.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),e_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Te(this.TEXTAREA,[["data-hot-input",""],mo(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,_l),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){wD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",xe(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,_l)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ye(e.length-1,n=>{const i=e[n];if(we(i,"handsontableEditor"))return r=!0,!1}),we(this.TEXTAREA_PARENT,_l)&&xe(this.TEXTAREA_PARENT,_l),r?(this.layerClass=vB,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==it.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){zT()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===it.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===it.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>fe(this.hot.getSelected()),group:aR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;sR(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;sR(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(aR)}}const CB="base",SB="htTextEllipsis";function yO(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(tC())):a&&c.push(tC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(rC())):(u.push(s.invalidCellClassName),a&&c.push(rC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(SB),xe(e,u),X(e,l),Fa(e,c),Te(e,h)}yO.RENDERER_TYPE=CB;const RB="text";function bO(t,e,r,n,i,o,s){yO.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Zo(a),s.trimWhitespace&&(a=a.trim()),Va(e,a)}bO.RENDERER_TYPE=RB;const EB="text",TB={CELL_TYPE:EB,editor:bB,renderer:bO};pW(TB);nn.editors={BaseEditor:kp};function nn(t,e){const r=new vO(t,e||{},sp);return r.init(),r}nn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new vO(t,e,sp)};nn.DefaultSettings=aO();nn.hooks=de.getSingleton();nn.CellCoords=eo;nn.CellRange=Wa;nn.packageName="handsontable";nn.buildDate="09/07/2025 09:58:41";nn.version="16.0.0";nn.languages={dictionaryKeys:PV,getLanguageDictionary:J0,getLanguagesDictionaries:NV,registerLanguageDictionary:Q0,getTranslatedPhrase:eO};function _B(t,e){CO(t,e),e.add(t)}function OB(t,e,r){CO(t,e),e.set(t,r)}function CO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e,r){return(e=MB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MB(t){var e=IB(t,"string");return typeof e=="symbol"?e:e+""}function IB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ho(t,e){return t.get(SO(t,e))}function SO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const lR=new Map([["plugin",LN],["cell-type",sO],["editor",l_],["renderer",p_],["validator",w_]]),PB=Symbol("mainSetting"),xB="base",Ol=[];let Fi=null;var Vi=new WeakMap,uR=new WeakSet;class Ju{static get PLUGIN_KEY(){return xB}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){_B(this,uR),xo(this,"eventManager",new yi(this)),xo(this,"pluginName",null),xo(this,"pluginsInitializedCallbacks",[]),xo(this,"isPluginsReady",!1),xo(this,"enabled",!1),xo(this,"initialized",!1),OB(this,Vi,{}),Xn(this,"hot",e,{writable:!1}),Fi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!lR.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);lR.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Ol.push(o)}}if(Fi||(Fi=m_()),Fi.indexOf(this.pluginName)>=0&&Fi.splice(Fi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Fi.length===0){if(Ol.length>0){const i=[`${Ol.join(`
`)}
`,"You have to import and register them manually."].join("");throw Ol.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||Ct(r))&&n[PB]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(Ct(r)){var o;return(o=r[e])!==null&&o!==void 0?o:n[e]}return n[e]}addHook(e,r,n){Ho(Vi,this)[e]=Ho(Vi,this)[e]||[];const i=Ho(Vi,this)[e];this.hot.addHook(e,r,n),i.push(r),Ho(Vi,this)[e]=i}removeHooks(e){$(Ho(Vi,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Ho(Vi,this);_e(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){$(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=SO(uR,this,HB).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),_e(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function HB(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Wi(t,e,r){return(e=AB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AB(t){var e=DB(t,"string");return typeof e=="symbol"?e:e+""}function DB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NB{constructor(e){Wi(this,"hot",null),Wi(this,"container",null),Wi(this,"injected",!1),Wi(this,"rows",[]),Wi(this,"columns",[]),Wi(this,"samples",null),Wi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),$(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),$(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{$(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{$(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{$(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),$(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{$(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function Ml(t,e,r){return(e=kB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kB(t){var e=LB(t,"string");return typeof e=="symbol"?e:e+""}function LB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fp{static get SAMPLE_COUNT(){return 3}constructor(e){Ml(this,"samples",null),Ml(this,"dataFactory",null),Ml(this,"customSampleCount",null),Ml(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Fp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Ye(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ye(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ct(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Zo(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function FB(t,e){RO(t,e),e.add(t)}function jf(t,e,r){RO(t,e),e.set(t,r)}function RO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ys(t,e,r){return(e=VB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VB(t){var e=WB(t,"string");return typeof e=="symbol"?e:e+""}function WB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gi(t,e){return t.get(Zt(t,e))}function yu(t,e,r){return t.set(Zt(t,e),r),r}function Zt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("modifyAutoColumnSizeSeed");const zf="autoColumnSize",$B=10,BB="autoColumnSize";var Vp=new WeakMap,zo=new WeakMap,ns=new WeakMap,cr=new WeakSet;class ma extends Ju{static get PLUGIN_KEY(){return zf}static get PLUGIN_PRIORITY(){return $B}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),FB(this,cr),Ys(this,"ghostTable",new NB(this.hot)),Ys(this,"samplesGenerator",new Fp((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Ys(this,"inProgress",!1),Ys(this,"measuredColumns",0),Ys(this,"columnWidthsMap",new qu),jf(this,Vp,!1),jf(this,zo,[]),jf(this,ns,[]),this.hot.columnIndexMapper.registerMap(BB,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>Zt(cr,this,cR).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[zf]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Zt(cr,e,UB).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Zt(cr,e,YB).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Zt(cr,e,GB).call(e,...i)}),this.addHook("beforeRender",()=>Zt(cr,this,zB).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>Zt(cr,this,qB).call(this)),super.enablePlugin()}updatePlugin(){yu(ns,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>Zt(cr,this,cR).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Ye(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Zt(cr,this,EO).call(this,s,o)}),this.ghostTable.columns.length&&(Zt(cr,this,TO).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){sC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+ma.CALCULATION_STEP,i)},e,r),n=n+ma.CALCULATION_STEP+1,n<i?o=vg(s):(sC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[zf];let r=ma.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Ct(e)&&(r=e.syncLimit,zA(r)?r=ON(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Um))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=gi(zo,this).length;return(s-1<o||gi(zo,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?gi(zo,this).push(i):gi(zo,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function jB(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||Zt(cr,this,EO).call(this,r,e))}),this.ghostTable.columns.length&&(Zt(cr,this,TO).call(this),this.ghostTable.clean())}function EO(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function TO(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function zB(){this.calculateVisibleColumnsWidth(),this.inProgress||(Zt(cr,this,jB).call(this,gi(ns,this)),yu(ns,this,[]))}function UB(t,e){e||this.recalculateAllColumnsWidth()}function YB(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);gi(ns,this).push(...e)}function cR(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function qB(){yu(zo,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),yu(Vp,this,!0)}function GB(t){if(!gi(Vp,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);gi(ns,this).push(...e)}function KB(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function XB(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function $i(t,e){const r={};return $(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function ai(t,e,r,n,i){$(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&ZB(s,a,e,r,n,i)})})}function ZB(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=KB(s.className,n):a=XB(s.className,n)),o(t,e,"className",a)}function QB(t){return`<span class="selected">✓</span>${t}`}function Uf(t,e){let r=!1;return Array.isArray(t)&&$(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function _O(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const bt="---------";function JB(){return{name:bt}}const Kr="alignment";function ej(){return{key:Kr,name(){return this.getTranslatedPhrase(Rp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Kr}:left`,name(){return this.getTranslatedPhrase(Ep)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:center`,name(){return this.getTranslatedPhrase(Tp)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:right`,name(){return this.getTranslatedPhrase(_p)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:justify`,name(){return this.getTranslatedPhrase(Op)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:bt},{key:`${Kr}:top`,name(){return this.getTranslatedPhrase(Mp)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:middle`,name(){return this.getTranslatedPhrase(Ip)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:bottom`,name(){return this.getTranslatedPhrase(Pp)},callback(){const t=this.getSelectedRange(),e=$i(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Wp="clear_column";function tj(){return{key:Wp,name(){return this.getTranslatedPhrase(wp)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const ec="col_left";function rj(){return{key:ec,name(){return this.getTranslatedPhrase(hp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const tc="col_right";function nj(){return{key:tc,name(){return this.getTranslatedPhrase(dp)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const rc="make_read_only";function ij(){return{key:rc,checkable:!0,ariaChecked(){return Uf(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(pu)},name(){let t=this.getTranslatedPhrase(pu);return Uf(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=QB(t)),t},callback(){const t=this.getSelectedRange(),e=Uf(t,(r,n)=>this.getCellMeta(r,n).readOnly);$(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const nc="redo";function oj(){return{key:nc,name(){return this.getTranslatedPhrase(pp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ic="remove_col";function sj(){return{key:ic,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(gp,e)},callback(){this.alter("remove_col",iW(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const oc="remove_row";function aj(){return{key:oc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(fp,e)},callback(){this.alter("remove_row",oW(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const sc="row_above";function lj(){return{key:sc,name(){return this.getTranslatedPhrase(up)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ac="row_below";function uj(){return{key:ac,name(){return this.getTranslatedPhrase(cp)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ea="no_items";function cj(){return{key:Ea,name(){return this.getTranslatedPhrase(lp)},disabled:!0,isCommand:!1}}const lc="undo";function hj(){return{key:lc,name(){return this.getTranslatedPhrase(mp)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const dj=[sc,ac,ec,tc,Wp,oc,ic,lc,nc,rc,Kr,bt,Ea],fj={[bt]:JB,[Ea]:cj,[sc]:lj,[ac]:uj,[ec]:rj,[tc]:nj,[Wp]:tj,[oc]:aj,[ic]:sj,[lc]:hj,[nc]:oj,[rc]:ij,[Kr]:ej};function OO(){const t={};return _e(fj,(e,r)=>{t[r]=e()}),t}function Yf(t,e,r){return(e=gj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gj(t){var e=mj(t,"string");return typeof e=="symbol"?e:e+""}function mj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pj{constructor(e){Yf(this,"hot",void 0),Yf(this,"commands",{}),Yf(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=wj(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Cn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),$(u,c=>c.apply(this.hot,n))}}function wj(t,e){let r;return $(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function qf(t,e,r){return(e=vj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vj(t){var e=yj(t,"string");return typeof e=="symbol"?e:e+""}function yj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bj{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;qf(this,"hot",void 0),qf(this,"predefinedItems",OO()),qf(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,_e(e,(n,i)=>{let o="";n.name===bt?(r[bt]=n,o=bt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Cj(e,this.defaultOrderPattern,this.predefinedItems)}}function Cj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ct(i)?_e(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),Ct(o)?vi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):$(i,(o,s)=>{let a=r[o];!a&&dj.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ct(o)&&vi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function ri(t,e,r){return(e=Sj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sj(t){var e=Rj(t,"string");return typeof e=="symbol"?e:e+""}function Rj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ej{constructor(e,r){ri(this,"top",void 0),ri(this,"topRelative",void 0),ri(this,"left",void 0),ri(this,"leftRelative",void 0),ri(this,"scrollTop",void 0),ri(this,"scrollLeft",void 0),ri(this,"cellHeight",void 0),ri(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function qs(t,e,r){Tj(t,e),e.set(t,r)}function Tj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e){return t.get(MO(t,e))}function Il(t,e,r){return t.set(MO(t,e),r),r}function MO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Dt=new WeakMap,Yt=new WeakMap,qt=new WeakMap,Gf=new WeakMap,Ao=new WeakMap;class _j{constructor(e){qs(this,Dt,void 0),qs(this,Yt,void 0),qs(this,qt,void 0),qs(this,Gf,!1),qs(this,Ao,{above:0,below:0,left:0,right:0}),Il(Gf,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ie(Ao,this)[e]=r,this}setElement(e){return Il(Dt,this,e),this}setParentElement(e){return Il(Yt,this,e),this}updatePosition(e){Il(qt,this,new Ej(e,ie(Dt,this).ownerDocument.defaultView)),ie(Gf,this)?(ie(qt,this).fitsBelow(ie(Dt,this))?this.setPositionBelowCursor():ie(qt,this).fitsAbove(ie(Dt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ie(Dt,this).dir==="rtl"?ie(qt,this).fitsOnLeft(ie(Dt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ie(qt,this).fitsOnRight(ie(Dt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ie(Ao,this).above+ie(qt,this).top-ie(Dt,this).offsetHeight;if(ie(Yt,this)){const n=ie(Yt,this).ownerDocument.defaultView.getComputedStyle(ie(Yt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(qt,this).top+ie(qt,this).cellHeight-ie(Dt,this).scrollHeight+i+o}ie(Dt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ie(Ao,this).below+ie(qt,this).top+1;if(ie(Yt,this)){const n=ie(Yt,this).ownerDocument.defaultView.getComputedStyle(ie(Yt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(qt,this).top-i-o-1}ie(Dt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ie(qt,this).left;if(ie(Yt,this)){const r=ie(Yt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Yt,this).querySelector(".htCore")).borderRightWidth,10);e+=ie(qt,this).cellWidth+n}else e+=ie(Ao,this).right;ie(Dt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ie(Ao,this).left+ie(qt,this).left-ie(Dt,this).offsetWidth;if(ie(Yt,this)){const r=ie(Yt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Yt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ie(Dt,this).style.left=`${e}px`}}function Oj(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=Ae(e,-1,y()-1);function a(T,v){const E=y()-1;return T<0&&(T=E),T>E&&(T=0),o.has(T)?-1:(o.add(T),n(T,!1)===!1&&(T=a(v===1?++T:--T,v)),T)}function l(T){T>-1&&T<y()&&n(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<y()&&(s=T)}function c(){return s}function h(){y()>0&&(o.clear(),s=a(0,1))}function d(){y()>0&&(o.clear(),s=a(y()-1,-1))}function g(){y()>0&&(o.clear(),s=a(++s,1))}function w(){y()>0&&(o.clear(),s=a(--s,-1))}function y(){return Math.max(r(),0)}function b(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:w,getSize:y,clear:b}}function Mj(t){return bn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Dg(t){return Cn(t,"submenu")}function Ng(t){return new RegExp(bt,"i").test(t.name)}function Gl(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function hR(t){return Cn(t,"disableSelection")}function Ij(t){return we(t,"htSeparator")}function Pj(t){return we(t,"htSubmenu")}function xj(t){return we(t,"htDisabled")}function Hj(t){return we(t,"htSelectionDisabled")}function Aj(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function IO(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function Dj(t,e){let r=t.slice(0);return r.reverse(),r=IO(r,e),r.reverse(),r}function Nj(t){const e=[];return $(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function kj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bt,r=t.slice(0);return r=IO(r,e),r=Dj(r,e),r=Nj(r),r}function Lj(t){return t.checkable===!0}function Fj(t){return Oj({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||Ij(n)||xj(n)||Hj(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Vj(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const PO="menu",dR=PO;function Wj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Vj(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:PO})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(w=>h.removeShortcutsByKeys(w))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${dR}:${u}`:dR}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function $j(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ts(r),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Gl(a,t)&&!hR(a)&&!Ng(a);Te(r,[...Lj(a)?[JA(),uu(c),oD(h)]:[QA(),uu(u)],...d?[mo(-1)]:[],...Gl(a,t)?[nD()]:[],...Dg(a)?[jl(!1)]:[]])}r.className="",r.appendChild(l),Ng(a)?X(r,"htSeparator"):typeof a.renderer=="function"?(X(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):XT(l,u),Gl(a,t)?X(r,"htDisabled"):hR(a)?X(r,"htSelectionDisabled"):Dg(a)&&X(r,"htSubmenu")}}function Kf(t,e,r){Bj(t,e),e.set(t,r)}function Bj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dn(t,e,r){return(e=jj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jj(t){var e=zj(t,"string");return typeof e=="symbol"?e:e+""}function zj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xf(t,e,r){return t.set(xO(t,e),r),r}function ni(t,e){return t.get(xO(t,e))}function xO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const fR=215;var Do=new WeakMap,Pl=new WeakMap,xl=new WeakMap;class uc{get tableBorderWidth(){return ni(xl,this)===void 0&&this.hotMenu&&Xf(xl,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ni(xl,this)}constructor(e,r){var n=this;dn(this,"hot",void 0),dn(this,"options",void 0),dn(this,"eventManager",new yi(this)),dn(this,"container",void 0),dn(this,"positioner",void 0),dn(this,"hotMenu",null),dn(this,"hotSubMenus",{}),dn(this,"parentMenu",void 0),dn(this,"menuItems",null),dn(this,"origOutsideClickDeselects",null),Kf(this,Do,void 0),Kf(this,Pl,void 0),Kf(this,xl,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:fR,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new _j(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(xe(this.options.container,/ht-theme-.*/g),X(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Ca(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ni(Do,this)}getKeyboardShortcutsCtrl(){return ni(Pl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=i_(a=>this.openSubMenu(a),300),r=this.options.minWidth||fR;let n=!1,i=Dm(this.menuItems,a=>(a.key===Ea&&(n=!0),Aj(a,this.hot)));if(i.length<1&&!n)i.push(OO()[Ea]);else if(i.length===0)return;i=kj(i,bt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return fe(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:$j(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ni(Do,this).setCurrentPage(l.row):ni(Do,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),yg()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!yg()||!du(a))&&o&&this.hasSelectedItem()&&(fi()||UT()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Xf(Do,this,Fj(this.hotMenu)),Xf(Pl,this,Wj(this)),ni(Pl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ni(Do,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Te(n,[jl(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!Pj(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new uc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Te(r,[jl(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Te(i,[jl(!1)])}}closeAllSubMenus(){$(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?Mj(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Ng(e)||Gl(e,this.hot)||Dg(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=go(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?rr(this.hotMenu.getCell(u,0)):0;return a+(l.name===bt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Ie(n)&&(n=n.call(this.hot),n===null||Ft(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),n&&X(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Te(this.hotMenu.rootElement,[ZA(),mo(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Qo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Qo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&Qo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ke(uc,_n);function Uj(t,e){Yj(t,e),e.add(t)}function Yj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zf(t,e,r){return(e=qj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qj(t){var e=Gj(t,"string");return typeof e=="symbol"?e:e+""}function Gj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oa="contextMenu",Kj=70,gR=oa;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");var Gs=new WeakSet;class cc extends Ju{constructor(){super(...arguments),Uj(this,Gs),Zf(this,"commandExecutor",new pj(this.hot)),Zf(this,"itemsFactory",null),Zf(this,"menu",null)}static get PLUGIN_KEY(){return oa}static get PLUGIN_PRIORITY(){return Kj}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[sc,ac,bt,ec,tc,bt,oc,ic,bt,lc,nc,bt,rc,bt,Kr]}isEnabled(){return!!this.hot.getSettings()[oa]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[oa];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new uc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Hl(Gs,this,Zj).call(this)),this.menu.addLocalHook("afterOpen",()=>Hl(Gs,this,Qj).call(this)),this.menu.addLocalHook("afterClose",()=>Hl(Gs,this,Jj).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Hl(Gs,this,Xj).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=_O(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:gR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gR)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;_e(n,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new bj(this.hot,cc.DEFAULT_ITEMS);const e=this.hot.getSettings()[oa],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),$(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Xj(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=_O(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Zj(){this.hot.runHooks("beforeContextMenuShow",this)}function Qj(){this.hot.runHooks("afterContextMenuShow",this)}function Jj(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}cc.SEPARATOR={name:bt};function ez(t){return{key:"copy",name(){return this.getTranslatedPhrase(vp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function tz(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?Ae(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Cp,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function rz(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?Ae(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(bp,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function nz(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?Ae(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(yp,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function iz(t){return{key:"cut",name(){return this.getTranslatedPhrase(Sp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class oz{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class sz{constructor(){this.clipboardData=new oz}preventDefault(){}composedPath(){return[]}}function az(t,e){HO(t,e),e.add(t)}function No(t,e,r){HO(t,e),e.set(t,r)}function HO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(qo(t,e))}function ko(t,e,r){return t.set(qo(t,e),r),r}function qo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ii=new WeakMap,Qf=new WeakMap,Ks=new WeakMap,kg=new WeakMap,Lg=new WeakMap,Xs=new WeakMap,Zs=new WeakSet;class lz{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;az(this,Zs),No(this,ii,void 0),No(this,Qf,void 0),No(this,Ks,void 0),No(this,kg,void 0),No(this,Lg,void 0),No(this,Xs,void 0),ko(Qf,this,r),ko(Ks,this,n),ko(kg,this,i),ko(Lg,this,o),ko(Xs,this,s)}setSelectedRange(e){ko(ii,this,e)}getCellsRange(){if(kt(Qf,this).call(this)===0||kt(Ks,this).call(this)===0)return null;const{row:e,col:r}=kt(ii,this).getTopStartCorner(),{row:n,col:i}=kt(ii,this).getBottomEndCorner(),o=qo(Zs,this,uz).call(this,e,n),s=qo(Zs,this,Jf).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(kt(Ks,this).call(this)===0||kt(Xs,this).call(this)===0)return null;const{col:e}=kt(ii,this).getTopStartCorner(),{col:r}=kt(ii,this).getBottomEndCorner(),n=qo(Zs,this,Jf).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(kt(Ks,this).call(this)===0||kt(Xs,this).call(this)===0)return null;const{col:e}=kt(ii,this).getTopStartCorner(),{col:r}=kt(ii,this).getBottomEndCorner(),n=qo(Zs,this,Jf).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-kt(Xs,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Jf(t,e){return Math.min(e,Math.max(t+kt(Lg,this).call(this)-1,t))}function uz(t,e){return Math.min(e,Math.max(t+kt(kg,this).call(this)-1,t))}function AO(t){const e=[],r=[];return $(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Ye(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Ye(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function cz(t,e){DO(t,e),e.add(t)}function oi(t,e,r){DO(t,e),e.set(t,r)}function DO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qs(t,e,r){return(e=hz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hz(t){var e=dz(t,"string");return typeof e=="symbol"?e:e+""}function dz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xt(t,e){return t.get(Qt(t,e))}function qr(t,e,r){return t.set(Qt(t,e),r),r}function Qt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const eg="copyPaste",fz=80,gz=["fragmentSelection"],mR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Fg=new WeakMap,Vg=new WeakMap,Wg=new WeakMap,Lo=new WeakMap,Al=new WeakMap,Dl=new WeakMap,Fo=new WeakMap,bu=new WeakMap,hr=new WeakSet;class mz extends Ju{constructor(){super(...arguments),cz(this,hr),Qs(this,"columnsLimit",1/0),Qs(this,"rowsLimit",1/0),Qs(this,"pasteMode","overwrite"),Qs(this,"uiContainer",this.hot.rootDocument.body),oi(this,Fg,!1),oi(this,Vg,!1),oi(this,Wg,!1),oi(this,Lo,"cells-only"),oi(this,Al,!1),oi(this,Dl,!1),oi(this,Fo,new lz({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oi(this,bu,!1),Qs(this,"copyableRanges",[])}static get PLUGIN_KEY(){return eg}static get SETTING_KEYS(){return[eg,...gz]}static get PLUGIN_PRIORITY(){return fz}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[eg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),qr(Fg,this,this.getSetting("copyColumnHeaders")),qr(Vg,this,this.getSetting("copyColumnGroupHeaders")),qr(Wg,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Qt(hr,this,vz).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qt(hr,n,yz).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Qt(hr,this,bz).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Lm()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qt(hr,n,Cz).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qt(hr,n,Sz).call(n,...o)}),this.addHook("afterSelection",()=>Qt(hr,this,Rz).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";qr(Lo,this,e),qr(Al,this,!0),Qt(hr,this,pR).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){qr(Dl,this,!0),Qt(hr,this,pR).call(this,"cut")}getRangedCopyableData(e){return fa(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=AO(e);return $(n,o=>{const s=[];$(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),r.push(s)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new sz;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Xt(Fo,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Xt(Lo,this)==="column-headers-only"?r.set("headers",Xt(Fo,this).getMostBottomColumnHeadersRange()):(Xt(Lo,this)==="with-column-headers"?r.set("headers",Xt(Fo,this).getMostBottomColumnHeadersRange()):Xt(Lo,this)==="with-column-group-headers"&&r.set("headers",Xt(Fo,this).getAllColumnHeadersRange()),r.set("cells",Xt(Fo,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,o=[],{row:s,col:a}=r.getTopStartCorner(),{row:l,col:u}=r.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<n||c<=l;){const{skipRowOnPaste:w,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,w===!0)continue;d=y,h=a;const b=[],T=o.length%n;for(;b.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:E}=this.hot.getCellMeta(s,h);if(h=E+1,v===!0)continue;g=E;const _=b.length%i;b.push(e[T][_])}o.push(b)}return qr(bu,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Xt(Al,this)||this.isEditorOpened()||Xi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!zl(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),qr(Al,this,!1);const o=this.getRangedData(this.copyableRanges),s=Qt(hr,this,pz).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=fa(o);if(e&&e.clipboardData){const u=FC(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[mR,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}qr(Lo,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Xt(Dl,this)||this.isEditorOpened()||Xi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!zl(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),qr(Dl,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=fa(o);if(e&&e.clipboardData){const l=FC(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[mR,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Xi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!zl(r,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=kT(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=TN(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=cW(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function pR(t){if(Lm()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&HD(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function pz(t){const{rows:e}=AO(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function wz(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&r_(n)}}}function NO(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&n_(n)}}}function vz(t){t.items.push({name:"---------"},ez(this)),Xt(Fg,this)&&t.items.push(nz(this)),Xt(Vg,this)&&t.items.push(rz(this)),Xt(Wg,this)&&t.items.push(tz(this)),t.items.push(iz(this))}function yz(t,e,r,n,i){Xt(bu,this)&&(i.value=!0),qr(bu,this,!1)}function bz(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Cz(){Qt(hr,this,NO).call(this)}function Sz(){Qt(hr,this,wz).call(this)}function Rz(){Qt(hr,this,NO).call(this)}function Ez(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function Tz(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function _z(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function kO(t,e,r){const n=Tz(t,Ez(t,e,r));return _z(n)}function Oz(t,e,r){return(e=Mz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mz(t){var e=Iz(t,"string");return typeof e=="symbol"?e:e+""}function Iz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wr{constructor(e){Oz(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Nl(t,e,r){return(e=Pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pz(t){var e=xz(t,"string");return typeof e=="symbol"?e:e+""}function xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $p extends Wr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),Nl(this,"stateBefore",void 0),Nl(this,"range",void 0),Nl(this,"type",void 0),Nl(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new $p({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){$(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){ai(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function wR(t,e,r){return(e=Hz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hz(t){var e=Az(t,"string");return typeof e=="symbol"?e:e+""}function Az(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bp extends Wr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),wR(this,"columns",void 0),wR(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new Bp({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),kO(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function vR(t,e,r){return(e=Dz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dz(t){var e=Nz(t,"string");return typeof e=="symbol"?e:e+""}function Nz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jp extends Wr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),vR(this,"previousSortState",void 0),vR(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new jp({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function yR(t,e,r){return(e=kz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kz(t){var e=Lz(t,"string");return typeof e=="symbol"?e:e+""}function Lz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zp extends Wr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),yR(this,"index",void 0),yR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new zp({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function bR(t,e,r){return(e=Fz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fz(t){var e=Vz(t,"string");return typeof e=="symbol"?e:e+""}function Vz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Up extends Wr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),bR(this,"index",void 0),bR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Up({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function kl(t,e,r){return(e=Wz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wz(t){var e=$z(t,"string");return typeof e=="symbol"?e:e+""}function $z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yp extends Wr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),kl(this,"changes",void 0),kl(this,"selected",void 0),kl(this,"countCols",void 0),kl(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new Yp({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=wr(this.changes);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=wr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function CR(t,e,r){return(e=Bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t){var e=jz(t,"string");return typeof e=="symbol"?e:e+""}function jz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qp extends Wr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),CR(this,"conditionsStack",void 0),CR(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new qp({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function zz(t,e,r){return(e=Uz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uz(t){var e=Yz(t,"string");return typeof e=="symbol"?e:e+""}function Yz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gp extends Wr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),zz(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new Gp({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function LO(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Ye(n,i,l=>{Ye(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Fn(t,e,r){return(e=qz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qz(t){var e=Gz(t,"string");return typeof e=="symbol"?e:e+""}function Gz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kp extends Wr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Fn(this,"index",void 0),Fn(this,"indexes",void 0),Fn(this,"data",void 0),Fn(this,"amount",void 0),Fn(this,"headers",void 0),Fn(this,"columnPositions",void 0),Fn(this,"rowPositions",void 0),Fn(this,"fixedColumnsStart",void 0),Fn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return Ye(l.length-1,w=>{const y=[],b=l[w];Ye(u,c,T=>{y.push(b[e.toPhysicalColumn(T)])}),h.push(y)}),Ye(i-1,w=>{g.push(e.toPhysicalColumn(u+w))}),Array.isArray(e.getSettings().colHeaders)&&Ye(i-1,w=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+w)]||null)}),new Kp({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:LO(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(bn(this.data[c],o));const l=bn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),$(e.getSourceDataArray(),(c,h)=>{$(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&$(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Vo(t,e,r){return(e=Kz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kz(t){var e=Xz(t,"string");return typeof e=="symbol"?e:e+""}function Xz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xp extends Wr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Vo(this,"index",void 0),Vo(this,"data",void 0),Vo(this,"fixedRowsBottom",void 0),Vo(this,"fixedRowsTop",void 0),Vo(this,"rowIndexesSequence",void 0),Vo(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=wr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new Xp({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:LO(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function SR(t,e,r){return(e=Zz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zz(t){var e=Qz(t,"string");return typeof e=="symbol"?e:e+""}function Qz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zp extends Wr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),SR(this,"rows",void 0),SR(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new Zp({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),kO(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Jz(t,e,r){return(e=eU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eU(t){var e=tU(t,"string");return typeof e=="symbol"?e:e+""}function tU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qp extends Wr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),Jz(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new Qp({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function rU(t,e){[$p,Bp,jp,zp,Up,Yp,qp,Gp,Kp,Xp,Zp,Qp].forEach(r=>r.startRegisteringEvents(t,e))}function nU(t,e){iU(t,e),e.add(t)}function iU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tg(t,e,r){return(e=oU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oU(t){var e=sU(t,"string");return typeof e=="symbol"?e:e+""}function sU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const RR="undoRedo",aU="undoRedo",lU=1e3;de.getSingleton().register("beforeUndo");de.getSingleton().register("afterUndo");de.getSingleton().register("beforeRedo");de.getSingleton().register("afterRedo");const ER=new Set;var Ll=new WeakSet;class uU extends Ju{static get PLUGIN_KEY(){return aU}static get PLUGIN_PRIORITY(){return lU}static get SETTING_KEYS(){return!0}constructor(e){super(e),nU(this,Ll),tg(this,"doneActions",[]),tg(this,"undoneActions",[]),tg(this,"ignoreNewActions",!1),rU(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return rg(Ll,e,cU).call(e,...n)}),this.registerShortcuts(),rg(Ll,this,hU).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),rg(Ll,this,dU).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:RR};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RR)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=wr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=wr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function cU(t,e){e==="loadData"&&this.clear()}function hU(){const t=e=>{ER.has(e)||(Sn(tr`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),ER.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function dU(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class fU{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=v=>{if(v=this.postProcess(v,n),i){setTimeout(function(){i(v)},0);return}else return v},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let w=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&w+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let y=-1/0,b=1/0;const T=()=>{for(let v=Math.max(y,-u);v<=Math.min(b,u);v+=2){let E;const _=g[v-1],M=g[v+1];_&&(g[v-1]=void 0);let P=!1;if(M){const F=M.oldPos-v;P=M&&0<=F&&F<a}const x=_&&_.oldPos+1<l;if(!P&&!x){g[v]=void 0;continue}if(!x||P&&_.oldPos<M.oldPos?E=this.addToPath(M,!0,!1,0,n):E=this.addToPath(_,!1,!0,1,n),w=this.extractCommon(E,r,e,v,n),E.oldPos+1>=l&&w+1>=a)return s(this.buildValues(E.lastComponent,r,e))||!0;g[v]=E,E.oldPos+1>=l&&(b=Math.min(b,v-1)),w+1>=a&&(y=Math.max(y,v+1))}u++};if(i)(function v(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);T()||v()},0)})();else for(;u<=c&&Date.now()<=d;){const v=T();if(v)return v}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const w=n[u+g];return w.length>d.length?w:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class gU extends fU{constructor(){super(...arguments),this.tokenize=pU}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const mU=new gU;function TR(t,e,r){return mU.diff(t,e,r)}function pU(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function wU(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;TR(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(TR(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(v){return v.map(function(E){return" "+E})}const d=[];let g=0,w=0,y=[],b=1,T=1;for(let v=0;v<c.length;v++){const E=c[v],_=E.lines||yU(E.value);if(E.lines=_,E.added||E.removed){if(!g){const M=c[v-1];g=b,w=T,M&&(y=l>0?h(M.lines.slice(-l)):[],g-=y.length,w-=y.length)}for(const M of _)y.push((E.added?"+":"-")+M);E.added?T+=_.length:b+=_.length}else{if(g)if(_.length<=l*2&&v<c.length-2)for(const M of h(_))y.push(M);else{const M=Math.min(_.length,l);for(const x of h(_.slice(0,M)))y.push(x);const P={oldStart:g,oldLines:b-g+M,newStart:w,newLines:T-w+M,lines:y};d.push(P),g=0,w=0,y=[]}b+=_.length,T+=_.length}}for(const v of d)for(let E=0;E<v.lines.length;E++)v.lines[E].endsWith(`
`)?v.lines[E]=v.lines[E].slice(0,-1):(v.lines.splice(E+1,0,"\\ No newline at end of file"),E++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function FO(t){if(Array.isArray(t))return t.map(FO).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function vU(t,e,r,n,i,o,s){{const a=wU(t,e,r,n,i,o);return a?FO(a):void 0}}function yU(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var $g;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})($g||($g={}));const Wo=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,is=$g;class _R{constructor(e){ar(this,"data");this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class OR{constructor(e){ar(this,"data");this.data=e}run(){return[...new Set(this.data)]}}class Bg{constructor(e,r,n=!0){ar(this,"data1");ar(this,"data2");ar(this,"ignoreDuplicates");n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)is.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return is.sort(e)}}class bU{constructor(e,r){ar(this,"data1");ar(this,"data2");this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)is.contains(this.data2,r[n])&&e.push(r[n]);return is.sort(e)}}class MR{constructor(e){ar(this,"data");this.data=is.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new Bg(is.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class CU{constructor(e,r){ar(this,"data1");ar(this,"data2");this.data1=e,this.data2=r}run(){return vU("Data1","Data2",this.data1,this.data2)}}const SU=async(t,e)=>{ue(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(ue(e).trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var RU=(t,e)=>e("chkDuplicates"),EU=(t,e)=>e("rmDuplicates"),TU=(t,e)=>e("chkConsecutive"),_U=(t,e)=>e("compare"),OU=(t,e)=>e("diff"),MU=UM('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-c3tvfg"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-c3tvfg"><div class="row svelte-c3tvfg"><div id="Table1" class="col-3 svelte-c3tvfg"></div> <div id="Table2" class="col-3 pl-0 svelte-c3tvfg"></div> <div class="col-2 p-0 pt-5 svelte-c3tvfg"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-c3tvfg">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-c3tvfg">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-c3tvfg"><label for="result">Result</label> <textarea class="form-control svelte-c3tvfg" id="result" readonly=""></textarea></div></div></div>',1);function IU(t,e){LR(e,!0);const r=[],n=[];rl(ma),rl(cc),rl(mz),rl(uU);const i=64;let o,s,a=Jt(""),l=Jt("Data1"),u=Jt("comm"),c=Jt(!0),h=Jt(!0),d=Jt(!1);const g=(W,te,oe)=>{let Me;try{Me=JSON.parse(localStorage.getItem(oe)||"")}catch{Me=void 0}const ye=new nn(document.getElementById(W),{data:Me,colHeaders:[te],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return ye.addHook("beforePaste",()=>ye.updateSettings({readOnly:!0})),ye.addHook("afterPaste",re=>{ye.updateSettings({readOnly:!1}),ye.deselectCell();for(let Ee=re.length-1;Ee>=0;Ee--)if(re[Ee][0]!==""){ye.loadData(re.slice(0,Ee+1));return}ye.loadData([[""]])}),ye};JM(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const w=W=>W.getDataAtCol(0).filter(te=>te!==null),y=W=>{const te=w(o).filter(ce=>ce!=""),oe=w(s).filter(ce=>ce!="");switch(W){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(ue(l)=="Data1"&&!te.length){Ve(a,`Data1 is empty.
Please enter something...`);return}else if(ue(l)=="Data2"&&!oe.length){Ve(a,`Data2 is empty.
Please enter something...`);return}break;default:if(te.length){if(!oe.length){Ve(a,`Data2 is empty.
Please enter something...`);return}}else{Ve(a,`Data1 is empty.
Please enter something...`);return}}Ve(d,!0);const Me=v(),ye=new Date().getTime();let re="",Ee;switch(W){case"chkDuplicates":let ce;ue(l)=="Data1"?ce=new _R(te).run():ce=new _R(oe).run(),Object.keys(ce).length?ue(c)?re=`Duplicate values found in ${ue(l)}.
`+Wo(Object.keys(ce).length,Object.keys(ce).map(Pe=>`${Pe} appears ${ce[Pe]} times.`)):re=Object.keys(ce).join(`
`):re=`${ue(l)} has no duplicate value.`;break;case"rmDuplicates":ue(l)=="Data1"?Ee=new OR(te).run():Ee=new OR(oe).run(),re=Ee.join(`
`);break;case"chkConsecutive":ue(l)=="Data1"?Ee=new MR(te).run():Ee=new MR(oe).run(),Ee.length?Ee.length==1&&Ee[0]=="!Error!"?re=`Error!
${ue(l)} contains non-numeric value. Please check!`:re=`${ue(l)} is not consecutive.

The following numbers are missing:
${Ee.join(`
`)}`:re=`${ue(l)} contains consecutive numbers.`;break;case"compare":if(ue(u)=="comm")Ee=new bU(te,oe).run(),Ee.length?re=`Common values found between two data.
${Wo(Ee.length,Ee)}`:re="Two data contain no common value.";else{const Pe=new Bg(te,oe,ue(h)).run(),Ge=new Bg(oe,te,ue(h)).run();Pe.length+Ge.length==0?re="Data1 is same as Data2.":Pe.length?Ge.length?re=`Two files have inconsistent content.

Data1 is more than Data2
${Wo(Pe.length,Pe)}

Data2 is more than Data1
${Wo(Ge.length,Ge)}`:re=`Data1 completely contains Data2.

Data1 is more than Data2
${Wo(Pe.length,Pe)}`:re=`Data2 completely contains Data1.

Data2 is more than Data1
${Wo(Ge.length,Ge)}`}break;case"diff":re=new CU(te.join(`
`)+`
`,oe.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(Me),W=="rmDuplicates"||W=="chkDuplicates"&&!ue(c)?Ve(a,re,!0):Ve(a,re+`

Duration for process: ${Date.now()-ye}ms`),Ve(d,!1)},b=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),Ve(a,""))},T=()=>{const W=o.getData();o.loadData(s.getData()),s.loadData(W)},v=()=>setInterval(()=>{const W=ue(a).split("Processing");let te=W.length>=2?W[1].length:0;te<3?te++:te-=3,Ve(a,"Processing"+".".repeat(te))},200);var E=MU();jM("beforeunload",ig,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var _=vt(yM(E),2),M=xt(_),P=vt(xt(M),4),x=xt(P);x.__click=[RU,y];var F=vt(x,2),U=xt(F),H=xt(U),G=vt(F,2);G.__click=[EU,y];var J=vt(G,2);J.__click=[TU,y];var ae=vt(J,2),q=xt(ae),ee=xt(q);ee.value=ee.__value="Data1";var lt=vt(q,2),Re=xt(lt);Re.value=Re.__value="Data2";var ve=vt(ae,4);ve.__click=[_U,y];var qe=vt(ve,2),Be=xt(qe),Oe=xt(Be);Oe.value=Oe.__value="comm";var Cr=vt(Be,2),f=xt(Cr);f.value=f.__value="diff";var m=vt(qe,2),p=xt(m),C=xt(p),R=vt(m,4);R.__click=[OU,y];var O=vt(R,6);O.__click=[SU,a];var I=vt(O,6);I.__click=T;var D=xt(I);XM(D,()=>"Data1<=>Data2");var j=vt(I,6);j.__click=b;var V=vt(P,2),A=vt(xt(V),2);qR(()=>{x.disabled=ue(d),G.disabled=ue(d),J.disabled=ue(d),ve.disabled=ue(d),C.disabled=ue(u)=="comm",R.disabled=ue(d),O.disabled=ue(d),I.disabled=ue(d),j.disabled=ue(d)}),vw(H,()=>ue(c),W=>Ve(c,W)),Ua(r,[],ee,()=>ue(l),W=>Ve(l,W)),Ua(r,[],Re,()=>ue(l),W=>Ve(l,W)),Ua(n,[],Oe,()=>ue(u),W=>Ve(u,W)),Ua(n,[],f,()=>ue(u),W=>Ve(u,W)),vw(C,()=>ue(h),W=>Ve(h,W)),ZM(A,()=>ue(a),W=>Ve(a,W)),YM(t,E),FR()}zM(["click"]);qM(IU,{target:document.body})});export default PU();
