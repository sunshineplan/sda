var xO=Object.defineProperty;var HO=(t,e,r)=>e in t?xO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var AO=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var or=(t,e,r)=>HO(t,typeof e!="symbol"?e+"":e,r);var dU=AO((yU,ql)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const ew=!1;var wR=Array.isArray,DO=Array.prototype.indexOf,NO=Array.from,kO=Object.defineProperty,na=Object.getOwnPropertyDescriptor,LO=Object.prototype,FO=Array.prototype,VO=Object.getPrototypeOf,tw=Object.isExtensible;function WO(t){for(var e=0;e<t.length;e++)t[e]()}const xr=2,vR=4,mu=8,Dg=16,yi=32,Jo=64,Ng=128,dr=256,Gl=512,Hr=1024,zn=2048,to=4096,Kl=8192,kg=16384,yR=32768,BO=65536,rw=1<<17,$O=1<<18,bR=1<<19,Kf=1<<20,ia=Symbol("$state"),CR=new class extends Error{constructor(){super(...arguments);or(this,"name","StaleReactionError");or(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function SR(t){return t===this.v}function jO(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function zO(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function UO(t){throw new Error("https://svelte.dev/e/effect_orphan")}function YO(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function qO(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function GO(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function KO(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let XO=!1;const ZO=2,sr=Symbol();function QO(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let fr=null;function nw(t){fr=t}function RR(t,e=!1,r){var n=fr={p:fr,c:null,d:!1,e:null,m:!1,s:t,x:null,l:null};Fg(()=>{n.d=!0})}function TR(t){const e=fr;if(e!==null){const s=e.e;if(s!==null){var r=ke,n=Se;e.e=null;try{for(var i=0;i<s.length;i++){var o=s[i];pi(o.effect),pn(o.reaction),AR(o.fn)}}finally{pi(r),pn(n)}}fr=e.p,e.m=!0}return{}}function ER(){return!0}function Xs(t){if(typeof t!="object"||t===null||ia in t)return t;const e=VO(t);if(e!==LO&&e!==FO)return t;var r=new Map,n=wR(t),i=Qt(0),o=Se,s=a=>{var l=Se;pn(o);var u=a();return pn(l),u};return n&&r.set("length",Qt(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&qO();var c=r.get(l);return c===void 0?c=s(()=>{var h=Qt(u.value);return r.set(l,h),h}):Ve(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const d=s(()=>Qt(sr));r.set(l,d),ac(i)}}else{if(n&&typeof l=="string"){var c=r.get("length"),h=Number(l);Number.isInteger(h)&&h<c.v&&Ve(c,h)}Ve(u,sr),ac(i)}return!0},get(a,l,u){var g;if(l===ia)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||(g=na(a,l))!=null&&g.writable)&&(c=s(()=>{var p=Xs(h?a[l]:sr),y=Qt(p);return y}),r.set(l,c)),c!==void 0){var d=ce(c);return d===sr?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=ce(c))}else if(u===void 0){var h=r.get(l),d=h==null?void 0:h.v;if(h!==void 0&&d!==sr)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){var d;if(l===ia)return!0;var u=r.get(l),c=u!==void 0&&u.v!==sr||Reflect.has(a,l);if(u!==void 0||ke!==null&&(!c||(d=na(a,l))!=null&&d.writable)){u===void 0&&(u=s(()=>{var g=c?Xs(a[l]):sr,p=Qt(g);return p}),r.set(l,u));var h=ce(u);if(h===sr)return!1}return c},set(a,l,u,c){var T;var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var p=r.get(g+"");p!==void 0?Ve(p,sr):g in a&&(p=s(()=>Qt(sr)),r.set(g+"",p))}if(h===void 0)(!d||(T=na(a,l))!=null&&T.writable)&&(h=s(()=>Qt(void 0)),Ve(h,Xs(u)),r.set(l,h));else{d=h.v!==sr;var y=s(()=>Xs(u));Ve(h,y)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b!=null&&b.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var E=r.get("length"),v=Number(l);Number.isInteger(v)&&v>=E.v&&Ve(E,v+1)}ac(i)}return!0},ownKeys(a){ce(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==sr});for(var[u,c]of r)c.v!==sr&&!(u in a)&&l.push(u);return l},setPrototypeOf(){GO()}})}function ac(t,e=1){Ve(t,t.v+e)}function iw(t){try{if(t!==null&&typeof t=="object"&&ia in t)return t[ia]}catch{}return t}function JO(t,e){return Object.is(iw(t),iw(e))}function eM(t){var e=xr|zn,r=Se!==null&&(Se.f&xr)!==0?Se:null;return ke===null||r!==null&&(r.f&dr)!==0?e|=dr:ke.f|=bR,{ctx:fr,deps:null,effects:null,equals:SR,f:e,fn:t,reactions:null,rv:0,v:null,wv:0,parent:r??ke,ac:null}}function _R(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Ki(e[r])}}function tM(t){for(var e=t.parent;e!==null;){if((e.f&xr)===0)return e;e=e.parent}return null}function OR(t){var e,r=ke;pi(tM(t));try{_R(t),e=zR(t)}finally{pi(r)}return e}function MR(t){var e=OR(t);if(t.equals(e)||(t.v=e,t.wv=$R()),!ts){var r=(ui||(t.f&dr)!==0)&&t.deps!==null?to:Hr;wn(t,r)}}const fa=new Map;function rM(t,e){var r={f:0,v:t,reactions:null,equals:SR,rv:0,wv:0};return r}function Qt(t,e){const r=rM(t);return vM(r),r}function Ve(t,e,r=!1){Se!==null&&(!fn||(Se.f&rw)!==0)&&ER()&&(Se.f&(xr|Dg|rw))!==0&&!(gt!=null&&gt[1].includes(t)&&gt[0]===Se)&&KO();let n=r?Xs(e):e;return nM(t,n)}function nM(t,e){if(!t.equals(e)){var r=t.v;ts?fa.set(t,e):fa.set(t,r),t.v=e,(t.f&xr)!==0&&((t.f&zn)!==0&&OR(t),wn(t,(t.f&dr)===0?Hr:to)),t.wv=$R(),IR(t,zn),ke!==null&&(ke.f&Hr)!==0&&(ke.f&(yi|Jo))===0&&(Or===null?yM([t]):Or.push(t))}return e}function IR(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f;(s&zn)===0&&(wn(o,e),(s&(Hr|dr))!==0&&((s&xr)!==0?IR(o,to):Bg(o)))}}var Xf,PR,xR,HR;function iM(){if(Xf===void 0){Xf=window,PR=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;xR=na(e,"firstChild").get,HR=na(e,"nextSibling").get,tw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),tw(r)&&(r.__t=void 0)}}function oM(t=""){return document.createTextNode(t)}function ji(t){return xR.call(t)}function Lg(t){return HR.call(t)}function It(t,e){return ji(t)}function sM(t,e){{var r=ji(t);return r instanceof Comment&&r.data===""?Lg(r):r}}function wt(t,e=1,r=!1){let n=t;for(;e--;)n=Lg(n);return n}function aM(t){ke===null&&Se===null&&UO(),Se!==null&&(Se.f&dr)!==0&&ke===null&&zO(),ts&&jO()}function lM(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function es(t,e,r,n=!0){var i=ke,o={ctx:fr,deps:null,nodes_start:null,nodes_end:null,f:t|zn,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Wg(o),o.f|=yR}catch(l){throw Ki(o),l}else e!==null&&Bg(o);var s=r&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(bR|Ng))===0;if(!s&&n&&(i!==null&&lM(o,i),Se!==null&&(Se.f&xr)!==0)){var a=Se;(a.effects??(a.effects=[])).push(o)}return o}function Fg(t){const e=es(mu,null,!1);return wn(e,Hr),e.teardown=t,e}function uM(t){aM();var e=ke!==null&&(ke.f&yi)!==0&&fr!==null&&!fr.m;if(e){var r=fr;(r.e??(r.e=[])).push({fn:t,effect:ke,reaction:Se})}else{var n=AR(t);return n}}function cM(t){const e=es(Jo,t,!0);return(r={})=>new Promise(n=>{r.outro?gM(e,()=>{Ki(e),n(void 0)}):(Ki(e),n(void 0))})}function AR(t){return es(vR,t,!1)}function Vg(t){return es(mu,t,!0)}function DR(t,e=[],r=eM){const n=e.map(r);return hM(()=>t(...n.map(ce)))}function hM(t,e=0){var r=es(mu|Dg|e,t,!0);return r}function dM(t,e=!0){return es(mu|yi,t,!0,e)}function NR(t){var e=t.teardown;if(e!==null){const r=ts,n=Se;ow(!0),pn(null);try{e.call(null)}finally{ow(r),pn(n)}}}function kR(t,e=!1){var i;var r=t.first;for(t.first=t.last=null;r!==null;){(i=r.ac)==null||i.abort(CR);var n=r.next;(r.f&Jo)!==0?r.parent=null:Ki(r,e),r=n}}function fM(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&yi)===0&&Ki(e),e=r}}function Ki(t,e=!0){var r=!1;(e||(t.f&$O)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(LR(t.nodes_start,t.nodes_end),r=!0),kR(t,e&&!r),Jl(t,0),wn(t,kg);var n=t.transitions;if(n!==null)for(const o of n)o.stop();NR(t);var i=t.parent;i!==null&&i.first!==null&&FR(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function LR(t,e){for(;t!==null;){var r=t===e?null:Lg(t);t.remove(),t=r}}function FR(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function gM(t,e){var r=[];VR(t,r,!0),mM(r,()=>{Ki(t),e&&e()})}function mM(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function VR(t,e,r){if((t.f&Kl)===0){if(t.f^=Kl,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&BO)!==0||(n.f&yi)!==0;VR(n,e,o?r:!1),n=i}}}let Xl=[];function pM(){var t=Xl;Xl=[],WO(t)}function Zf(t){Xl.length===0&&queueMicrotask(pM),Xl.push(t)}function wM(t){var e=ke;if((e.f&yR)===0){if((e.f&Ng)===0)throw t;e.fn(t)}else WR(t,e)}function WR(t,e){for(;e!==null;){if((e.f&Ng)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t}let Qf=!1,Zl=null,Yi=!1,ts=!1;function ow(t){ts=t}let Nl=[],Se=null,fn=!1;function pn(t){Se=t}let ke=null;function pi(t){ke=t}let gt=null;function vM(t){Se!==null&&Se.f&Kf&&(gt===null?gt=[Se,[t]]:gt[1].push(t))}let Dt=null,lr=0,Or=null;function yM(t){Or=t}let BR=1,Ql=0,ui=!1;function $R(){return++BR}function pu(t){var h;var e=t.f;if((e&zn)!==0)return!0;if((e&to)!==0){var r=t.deps,n=(e&dr)!==0;if(r!==null){var i,o,s=(e&Gl)!==0,a=n&&ke!==null&&!ui,l=r.length;if(s||a){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!((h=o==null?void 0:o.reactions)!=null&&h.includes(u)))&&(o.reactions??(o.reactions=[])).push(u);s&&(u.f^=Gl),a&&c!==null&&(c.f&dr)===0&&(u.f^=dr)}for(i=0;i<l;i++)if(o=r[i],pu(o)&&MR(o),o.wv>t.wv)return!0}(!n||ke!==null&&!ui)&&wn(t,Hr)}return!1}function jR(t,e,r=!0){var n=t.reactions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];gt!=null&&gt[1].includes(t)&&gt[0]===Se||((o.f&xr)!==0?jR(o,e,!1):e===o&&(r?wn(o,zn):(o.f&Hr)!==0&&wn(o,to),Bg(o)))}}function zR(t){var g;var e=Dt,r=lr,n=Or,i=Se,o=ui,s=gt,a=fr,l=fn,u=t.f;Dt=null,lr=0,Or=null,ui=(u&dr)!==0&&(fn||!Yi||Se===null),Se=(u&(yi|Jo))===0?t:null,gt=null,nw(t.ctx),fn=!1,Ql++,t.f|=Kf,t.ac!==null&&(t.ac.abort(CR),t.ac=null);try{var c=(0,t.fn)(),h=t.deps;if(Dt!==null){var d;if(Jl(t,lr),h!==null&&lr>0)for(h.length=lr+Dt.length,d=0;d<Dt.length;d++)h[lr+d]=Dt[d];else t.deps=h=Dt;if(!ui||(u&xr)!==0&&t.reactions!==null)for(d=lr;d<h.length;d++)((g=h[d]).reactions??(g.reactions=[])).push(t)}else h!==null&&lr<h.length&&(Jl(t,lr),h.length=lr);if(ER()&&Or!==null&&!fn&&h!==null&&(t.f&(xr|to|zn))===0)for(d=0;d<Or.length;d++)jR(Or[d],t);return i!==null&&i!==t&&(Ql++,Or!==null&&(n===null?n=Or:n.push(...Or))),c}catch(p){wM(p)}finally{Dt=e,lr=r,Or=n,Se=i,ui=o,gt=s,nw(a),fn=l,t.f^=Kf}}function bM(t,e){let r=e.reactions;if(r!==null){var n=DO.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&xr)!==0&&(Dt===null||!Dt.includes(e))&&(wn(e,to),(e.f&(dr|Gl))===0&&(e.f^=Gl),_R(e),Jl(e,0))}function Jl(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)bM(t,r[n])}function Wg(t){var e=t.f;if((e&kg)===0){wn(t,Hr);var r=ke,n=Yi;ke=t,Yi=!0;try{(e&Dg)!==0?fM(t):kR(t),NR(t);var i=zR(t);t.teardown=typeof i=="function"?i:null,t.wv=BR;var o;ew&&XO&&(t.f&zn)!==0&&t.deps}finally{Yi=n,ke=r}}}function CM(){try{YO()}catch(t){if(Zl!==null)WR(t,Zl);else throw t}}function SM(){var t=Yi;try{var e=0;for(Yi=!0;Nl.length>0;){e++>1e3&&CM();var r=Nl,n=r.length;Nl=[];for(var i=0;i<n;i++){var o=TM(r[i]);RM(o)}fa.clear()}}finally{Qf=!1,Yi=t,Zl=null}}function RM(t){var e=t.length;if(e!==0)for(var r=0;r<e;r++){var n=t[r];(n.f&(kg|Kl))===0&&pu(n)&&(Wg(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?FR(n):n.fn=null))}}function Bg(t){Qf||(Qf=!0,queueMicrotask(SM));for(var e=Zl=t;e.parent!==null;){e=e.parent;var r=e.f;if((r&(Jo|yi))!==0){if((r&Hr)===0)return;e.f^=Hr}}Nl.push(e)}function TM(t){for(var e=[],r=t;r!==null;){var n=r.f,i=(n&(yi|Jo))!==0,o=i&&(n&Hr)!==0;if(!o&&(n&Kl)===0){(n&vR)!==0?e.push(r):i?r.f^=Hr:pu(r)&&Wg(r);var s=r.first;if(s!==null){r=s;continue}}var a=r.parent;for(r=r.next;r===null&&a!==null;)r=a.next,a=a.parent}return e}function ce(t){var e=t.f,r=(e&xr)!==0;if(Se!==null&&!fn){if(!(gt!=null&&gt[1].includes(t))||gt[0]!==Se){var n=Se.deps;t.rv<Ql&&(t.rv=Ql,Dt===null&&n!==null&&n[lr]===t?lr++:Dt===null?Dt=[t]:(!ui||!Dt.includes(t))&&Dt.push(t))}}else if(r&&t.deps===null&&t.effects===null){var i=t,o=i.parent;o!==null&&(o.f&dr)===0&&(i.f^=dr)}return r&&(i=t,pu(i)&&MR(i)),ts&&fa.has(t)?fa.get(t):t.v}function $g(t){var e=fn;try{return fn=!0,t()}finally{fn=e}}const EM=-7169;function wn(t,e){t.f=t.f&EM|e}const _M=["touchstart","touchmove"];function OM(t){return _M.includes(t)}let sw=!1;function MM(){sw||(sw=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function UR(t){var e=Se,r=ke;pn(null),pi(null);try{return t()}finally{pn(e),pi(r)}}function jg(t,e,r,n=r){t.addEventListener(e,()=>UR(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),MM()}const YR=new Set,Jf=new Set;function IM(t,e,r,n={}){function i(o){if(n.capture||Zs.call(e,o),!o.cancelBubble)return UR(()=>r==null?void 0:r.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Zf(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function PM(t,e,r,n,i){var o={capture:n,passive:i},s=IM(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Fg(()=>{e.removeEventListener(t,s,o)})}function xM(t){for(var e=0;e<t.length;e++)YR.add(t[e]);for(var r of Jf)r(t)}function Zs(t){var v;var e=this,r=e.ownerDocument,n=t.type,i=((v=t.composedPath)==null?void 0:v.call(t))||[],o=i[0]||t.target,s=0,a=t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){kO(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=Se,h=ke;pn(null),pi(null);try{for(var d,g=[];o!==null;){var p=o.assignedSlot||o.parentNode||o.host||null;try{var y=o["__"+n];if(y!=null&&(!o.disabled||t.target===o))if(wR(y)){var[b,...E]=y;b.apply(o,[t,...E])}else y.call(o,t)}catch(T){d?g.push(T):d=T}if(t.cancelBubble||p===e||p===null)break;o=p}if(d){for(let T of g)queueMicrotask(()=>{throw T});throw d}}finally{t.__root=e,delete t.currentTarget,pn(c),pi(h)}}}function qR(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function GR(t,e){var r=ke;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function HM(t,e){var r=(e&ZO)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=qR(i?t:"<!>"+t));var o=r||PR?document.importNode(n,!0):n.cloneNode(!0);{var s=ji(o),a=o.lastChild;GR(s,a)}return o}}function AM(t,e){t!==null&&t.before(e)}function DM(t,e){return NM(t,e)}const po=new Map;function NM(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){iM();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var p=OM(g);e.addEventListener(g,Zs,{passive:p});var y=po.get(g);y===void 0?(document.addEventListener(g,Zs,{passive:p}),po.set(g,1)):po.set(g,y+1)}}};l(NO(YR)),Jf.add(l);var u=void 0,c=cM(()=>{var h=r??e.appendChild(oM());return dM(()=>{if(o){RR({});var d=fr;d.c=o}i&&(n.$$events=i),u=t(h,n)||{},o&&TR()}),()=>{var p;for(var d of a){e.removeEventListener(d,Zs);var g=po.get(d);--g===0?(document.removeEventListener(d,Zs),po.delete(d)):po.set(d,g)}Jf.delete(l),h!==r&&((p=h.parentNode)==null||p.removeChild(h))}});return kM.set(u,c),u}let kM=new WeakMap;function LM(t,e,r=!1,n=!1,i=!1){var o=t,s="";DR(()=>{var a=ke;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(LR(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=qR(l);if((r||n)&&(u=ji(u)),GR(ji(u),u.lastChild),r||n)for(;ji(u);)o.before(ji(u));else o.before(u)}})}function FM(t,e,r=e){jg(t,"input",n=>{var i=n?t.defaultValue:t.value;if(i=uc(t)?cc(i):i,r(i),i!==(i=e())){var o=t.selectionStart,s=t.selectionEnd;t.value=i??"",s!==null&&(t.selectionStart=o,t.selectionEnd=Math.min(s,t.value.length))}}),$g(e)==null&&t.value&&r(uc(t)?cc(t.value):t.value),Vg(()=>{var n=e();uc(t)&&n===cc(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}const lc=new Set;function $a(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??(s[a]=[]);s.push(r),jg(r,"change",()=>{var l=r.__value;o&&(l=VM(s,l,r.checked)),i(l)},()=>i(o?[]:null)),Vg(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=JO(r.__value,l)}),Fg(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),lc.has(s)||(lc.add(s),Zf(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),lc.delete(s)})),Zf(()=>{})}function aw(t,e,r=e){jg(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),$g(e)==null&&r(t.checked),Vg(()=>{var n=e();t.checked=!!n})}function VM(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function uc(t){var e=t.type;return e==="number"||e==="range"}function cc(t){return t===""?null:+t}function WM(t){fr===null&&QO(),uM(()=>{const e=$g(t);if(typeof e=="function")return e})}const BM="5";var pR;typeof window<"u"&&((pR=window.__svelte??(window.__svelte={})).v??(pR.v=new Set)).add(BM);var lw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uw={},ps,cw;function Je(){if(cw)return ps;cw=1;var t=function(e){return e&&e.Math===Math&&e};return ps=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof lw=="object"&&lw)||t(typeof ps=="object"&&ps)||function(){return this}()||Function("return this")(),ps}var hc={},dc,hw;function ot(){return hw||(hw=1,dc=function(t){try{return!!t()}catch{return!0}}),dc}var fc,dw;function Dr(){if(dw)return fc;dw=1;var t=ot();return fc=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),fc}var gc,fw;function wu(){if(fw)return gc;fw=1;var t=ot();return gc=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),gc}var mc,gw;function mt(){if(gw)return mc;gw=1;var t=wu(),e=Function.prototype.call;return mc=t?e.bind(e):function(){return e.apply(e,arguments)},mc}var pc={},mw;function $M(){if(mw)return pc;mw=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return pc.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,pc}var wc,pw;function vu(){return pw||(pw=1,wc=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),wc}var vc,ww;function et(){if(ww)return vc;ww=1;var t=wu(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return vc=t?n:function(i){return function(){return r.apply(i,arguments)}},vc}var yc,vw;function ro(){if(vw)return yc;vw=1;var t=et(),e=t({}.toString),r=t("".slice);return yc=function(n){return r(e(n),8,-1)},yc}var bc,yw;function jM(){if(yw)return bc;yw=1;var t=et(),e=ot(),r=ro(),n=Object,i=t("".split);return bc=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,bc}var Cc,bw;function zg(){return bw||(bw=1,Cc=function(t){return t==null}),Cc}var Sc,Cw;function Ra(){if(Cw)return Sc;Cw=1;var t=zg(),e=TypeError;return Sc=function(r){if(t(r))throw new e("Can't call method on "+r);return r},Sc}var Rc,Sw;function Ta(){if(Sw)return Rc;Sw=1;var t=jM(),e=Ra();return Rc=function(r){return t(e(r))},Rc}var Tc,Rw;function st(){if(Rw)return Tc;Rw=1;var t=typeof document=="object"&&document.all;return Tc=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},Tc}var Ec,Tw;function Nr(){if(Tw)return Ec;Tw=1;var t=st();return Ec=function(e){return typeof e=="object"?e!==null:t(e)},Ec}var _c,Ew;function rs(){if(Ew)return _c;Ew=1;var t=Je(),e=st(),r=function(n){return e(n)?n:void 0};return _c=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},_c}var Oc,_w;function Ea(){if(_w)return Oc;_w=1;var t=et();return Oc=t({}.isPrototypeOf),Oc}var Mc,Ow;function yu(){if(Ow)return Mc;Ow=1;var t=Je(),e=t.navigator,r=e&&e.userAgent;return Mc=r?String(r):"",Mc}var Ic,Mw;function zM(){if(Mw)return Ic;Mw=1;var t=Je(),e=yu(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Ic=a,Ic}var Pc,Iw;function Ug(){if(Iw)return Pc;Iw=1;var t=zM(),e=ot(),r=Je(),n=r.String;return Pc=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Pc}var xc,Pw;function KR(){if(Pw)return xc;Pw=1;var t=Ug();return xc=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",xc}var Hc,xw;function Yg(){if(xw)return Hc;xw=1;var t=rs(),e=st(),r=Ea(),n=KR(),i=Object;return Hc=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Hc}var Ac,Hw;function bu(){if(Hw)return Ac;Hw=1;var t=String;return Ac=function(e){try{return t(e)}catch{return"Object"}},Ac}var Dc,Aw;function mr(){if(Aw)return Dc;Aw=1;var t=st(),e=bu(),r=TypeError;return Dc=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},Dc}var Nc,Dw;function _a(){if(Dw)return Nc;Dw=1;var t=mr(),e=zg();return Nc=function(r,n){var i=r[n];return e(i)?void 0:t(i)},Nc}var kc,Nw;function UM(){if(Nw)return kc;Nw=1;var t=mt(),e=st(),r=Nr(),n=TypeError;return kc=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},kc}var Lc={exports:{}},Fc,kw;function no(){return kw||(kw=1,Fc=!1),Fc}var Vc,Lw;function qg(){if(Lw)return Vc;Lw=1;var t=Je(),e=Object.defineProperty;return Vc=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Vc}var Fw;function Gg(){if(Fw)return Lc.exports;Fw=1;var t=no(),e=Je(),r=qg(),n="__core-js_shared__",i=Lc.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Lc.exports}var Wc,Vw;function XR(){if(Vw)return Wc;Vw=1;var t=Gg();return Wc=function(e,r){return t[e]||(t[e]=r||{})},Wc}var Bc,Ww;function ns(){if(Ww)return Bc;Ww=1;var t=Ra(),e=Object;return Bc=function(r){return e(t(r))},Bc}var $c,Bw;function kr(){if(Bw)return $c;Bw=1;var t=et(),e=ns(),r=t({}.hasOwnProperty);return $c=Object.hasOwn||function(i,o){return r(e(i),o)},$c}var jc,$w;function ZR(){if($w)return jc;$w=1;var t=et(),e=0,r=Math.random(),n=t(1.1.toString);return jc=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},jc}var zc,jw;function en(){if(jw)return zc;jw=1;var t=Je(),e=XR(),r=kr(),n=ZR(),i=Ug(),o=KR(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return zc=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},zc}var Uc,zw;function YM(){if(zw)return Uc;zw=1;var t=mt(),e=Nr(),r=Yg(),n=_a(),i=UM(),o=en(),s=TypeError,a=o("toPrimitive");return Uc=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Uc}var Yc,Uw;function QR(){if(Uw)return Yc;Uw=1;var t=YM(),e=Yg();return Yc=function(r){var n=t(r,"string");return e(n)?n:n+""},Yc}var qc,Yw;function Kg(){if(Yw)return qc;Yw=1;var t=Je(),e=Nr(),r=t.document,n=e(r)&&e(r.createElement);return qc=function(i){return n?r.createElement(i):{}},qc}var Gc,qw;function JR(){if(qw)return Gc;qw=1;var t=Dr(),e=ot(),r=Kg();return Gc=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Gc}var Gw;function eT(){if(Gw)return hc;Gw=1;var t=Dr(),e=mt(),r=$M(),n=vu(),i=Ta(),o=QR(),s=kr(),a=JR(),l=Object.getOwnPropertyDescriptor;return hc.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},hc}var Kc={},Xc,Kw;function tT(){if(Kw)return Xc;Kw=1;var t=Dr(),e=ot();return Xc=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Xc}var Zc,Xw;function pt(){if(Xw)return Zc;Xw=1;var t=Nr(),e=String,r=TypeError;return Zc=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},Zc}var Zw;function bi(){if(Zw)return Kc;Zw=1;var t=Dr(),e=JR(),r=tT(),n=pt(),i=QR(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Kc.f=t?r?function(d,g,p){if(n(d),g=i(g),n(p),typeof d=="function"&&g==="prototype"&&"value"in p&&c in p&&!p[c]){var y=a(d,g);y&&y[c]&&(d[g]=p.value,p={configurable:u in p?p[u]:y[u],enumerable:l in p?p[l]:y[l],writable:!1})}return s(d,g,p)}:s:function(d,g,p){if(n(d),g=i(g),n(p),e)try{return s(d,g,p)}catch{}if("get"in p||"set"in p)throw new o("Accessors not supported");return"value"in p&&(d[g]=p.value),d},Kc}var Qc,Qw;function is(){if(Qw)return Qc;Qw=1;var t=Dr(),e=bi(),r=vu();return Qc=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},Qc}var Jc={exports:{}},eh,Jw;function qM(){if(Jw)return eh;Jw=1;var t=Dr(),e=kr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return eh={EXISTS:i,PROPER:o,CONFIGURABLE:s},eh}var th,ev;function GM(){if(ev)return th;ev=1;var t=et(),e=st(),r=Gg(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),th=r.inspectSource,th}var rh,tv;function KM(){if(tv)return rh;tv=1;var t=Je(),e=st(),r=t.WeakMap;return rh=e(r)&&/native code/.test(String(r)),rh}var nh,rv;function Xg(){if(rv)return nh;rv=1;var t=XR(),e=ZR(),r=t("keys");return nh=function(n){return r[n]||(r[n]=e(n))},nh}var ih,nv;function Zg(){return nv||(nv=1,ih={}),ih}var oh,iv;function rT(){if(iv)return oh;iv=1;var t=KM(),e=Je(),r=Nr(),n=is(),i=kr(),o=Gg(),s=Xg(),a=Zg(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,p=function(v){return g(v)?d(v):h(v,{})},y=function(v){return function(T){var _;if(!r(T)||(_=d(T)).type!==v)throw new u("Incompatible receiver, "+v+" required");return _}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(v,T){if(b.has(v))throw new u(l);return T.facade=v,b.set(v,T),T},d=function(v){return b.get(v)||{}},g=function(v){return b.has(v)}}else{var E=s("state");a[E]=!0,h=function(v,T){if(i(v,E))throw new u(l);return T.facade=v,n(v,E,T),T},d=function(v){return i(v,E)?v[E]:{}},g=function(v){return i(v,E)}}return oh={set:h,get:d,has:g,enforce:p,getterFor:y},oh}var ov;function nT(){if(ov)return Jc.exports;ov=1;var t=et(),e=ot(),r=st(),n=kr(),i=Dr(),o=qM().CONFIGURABLE,s=GM(),a=rT(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),p=t([].join),y=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),E=Jc.exports=function(v,T,_){d(c(T),0,7)==="Symbol("&&(T="["+g(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),_&&_.getter&&(T="get "+T),_&&_.setter&&(T="set "+T),(!n(v,"name")||o&&v.name!==T)&&(i?h(v,"name",{value:T,configurable:!0}):v.name=T),y&&_&&n(_,"arity")&&v.length!==_.arity&&h(v,"length",{value:_.arity});try{_&&n(_,"constructor")&&_.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var M=l(v);return n(M,"source")||(M.source=p(b,typeof T=="string"?T:"")),v};return Function.prototype.toString=E(function(){return r(this)&&u(this).source||s(this)},"toString"),Jc.exports}var sh,sv;function Qg(){if(sv)return sh;sv=1;var t=st(),e=bi(),r=nT(),n=qg();return sh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},sh}var ah={},lh,av;function XM(){if(av)return lh;av=1;var t=Math.ceil,e=Math.floor;return lh=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},lh}var uh,lv;function Oa(){if(lv)return uh;lv=1;var t=XM();return uh=function(e){var r=+e;return r!==r||r===0?0:t(r)},uh}var ch,uv;function ZM(){if(uv)return ch;uv=1;var t=Oa(),e=Math.max,r=Math.min;return ch=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},ch}var hh,cv;function QM(){if(cv)return hh;cv=1;var t=Oa(),e=Math.min;return hh=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},hh}var dh,hv;function os(){if(hv)return dh;hv=1;var t=QM();return dh=function(e){return t(e.length)},dh}var fh,dv;function JM(){if(dv)return fh;dv=1;var t=Ta(),e=ZM(),r=os(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return fh={includes:n(!0),indexOf:n(!1)},fh}var gh,fv;function iT(){if(fv)return gh;fv=1;var t=et(),e=kr(),r=Ta(),n=JM().indexOf,i=Zg(),o=t([].push);return gh=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},gh}var mh,gv;function Jg(){return gv||(gv=1,mh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),mh}var mv;function eI(){if(mv)return ah;mv=1;var t=iT(),e=Jg(),r=e.concat("length","prototype");return ah.f=Object.getOwnPropertyNames||function(i){return t(i,r)},ah}var ph={},pv;function tI(){return pv||(pv=1,ph.f=Object.getOwnPropertySymbols),ph}var wh,wv;function rI(){if(wv)return wh;wv=1;var t=rs(),e=et(),r=eI(),n=tI(),i=pt(),o=e([].concat);return wh=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},wh}var vh,vv;function oT(){if(vv)return vh;vv=1;var t=kr(),e=rI(),r=eT(),n=bi();return vh=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},vh}var yh,yv;function nI(){if(yv)return yh;yv=1;var t=ot(),e=st(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return yh=n,yh}var bh,bv;function Le(){if(bv)return bh;bv=1;var t=Je(),e=eT().f,r=is(),n=Qg(),i=qg(),o=oT(),s=nI();return bh=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,p,y,b,E;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(p in l){if(b=l[p],a.dontCallGetSet?(E=e(g,p),y=E&&E.value):y=g[p],d=s(c?p:u+(h?".":"#")+p,a.forced),!d&&y!==void 0){if(typeof b==typeof y)continue;o(b,y)}(a.sham||y&&y.sham)&&r(b,"sham",!0),n(g,p,b,a)}},bh}var Ch,Cv;function Ma(){if(Cv)return Ch;Cv=1;var t=wu(),e=Function.prototype,r=e.apply,n=e.call;return Ch=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),Ch}var Sh,Sv;function sT(){if(Sv)return Sh;Sv=1;var t=et(),e=mr();return Sh=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},Sh}var Rh,Rv;function iI(){if(Rv)return Rh;Rv=1;var t=Nr();return Rh=function(e){return t(e)||e===null},Rh}var Th,Tv;function oI(){if(Tv)return Th;Tv=1;var t=iI(),e=String,r=TypeError;return Th=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},Th}var Eh,Ev;function aT(){if(Ev)return Eh;Ev=1;var t=sT(),e=Nr(),r=Ra(),n=oI();return Eh=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),Eh}var _h,_v;function sI(){if(_v)return _h;_v=1;var t=bi().f;return _h=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},_h}var Oh,Ov;function aI(){if(Ov)return Oh;Ov=1;var t=st(),e=Nr(),r=aT();return Oh=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},Oh}var Mh,Mv;function lI(){if(Mv)return Mh;Mv=1;var t=en(),e=t("toStringTag"),r={};return r[e]="z",Mh=String(r)==="[object z]",Mh}var Ih,Iv;function lT(){if(Iv)return Ih;Iv=1;var t=lI(),e=st(),r=ro(),n=en(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Ih=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},Ih}var Ph,Pv;function Cu(){if(Pv)return Ph;Pv=1;var t=lT(),e=String;return Ph=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Ph}var xh,xv;function uI(){if(xv)return xh;xv=1;var t=Cu();return xh=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},xh}var Hh,Hv;function cI(){if(Hv)return Hh;Hv=1;var t=Nr(),e=is();return Hh=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Hh}var Ah,Av;function hI(){if(Av)return Ah;Av=1;var t=et(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return Ah=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},Ah}var Dh,Dv;function dI(){if(Dv)return Dh;Dv=1;var t=ot(),e=vu();return Dh=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),Dh}var Nh,Nv;function fI(){if(Nv)return Nh;Nv=1;var t=is(),e=hI(),r=dI(),n=Error.captureStackTrace;return Nh=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},Nh}var kh,kv;function gI(){if(kv)return kh;kv=1;var t=rs(),e=kr(),r=is(),n=Ea(),i=aT(),o=oT(),s=sI(),a=aI(),l=uI(),u=cI(),c=fI(),h=Dr(),d=no();return kh=function(g,p,y,b){var E="stackTraceLimit",v=b?2:1,T=g.split("."),_=T[T.length-1],M=t.apply(null,T);if(M){var I=M.prototype;if(!d&&e(I,"cause")&&delete I.cause,!y)return M;var H=t("Error"),V=p(function(N,j){var z=l(b?j:N,void 0),te=b?new M(N):new M;return z!==void 0&&r(te,"message",z),c(te,V,te.stack,2),this&&n(I,this)&&a(te,this,V),arguments.length>v&&u(te,arguments[v]),te});if(V.prototype=I,_!=="Error"?i?i(V,H):o(V,H,{name:!0}):h&&E in M&&(s(V,M,E),s(V,M,"prepareStackTrace")),o(V,M),!d)try{I.name!==_&&r(I,"name",_),I.constructor=V}catch{}return V}},kh}var Lv;function mI(){if(Lv)return uw;Lv=1;var t=Le(),e=Je(),r=Ma(),n=gI(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),uw}mI();var Fv={},Lh,Vv;function uT(){if(Vv)return Lh;Vv=1;var t=ro();return Lh=Array.isArray||function(r){return t(r)==="Array"},Lh}var Fh,Wv;function cT(){if(Wv)return Fh;Wv=1;var t=Dr(),e=uT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Fh=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Fh}var Vh,Bv;function hT(){if(Bv)return Vh;Bv=1;var t=TypeError,e=9007199254740991;return Vh=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Vh}var $v;function pI(){if($v)return Fv;$v=1;var t=Le(),e=ns(),r=os(),n=cT(),i=hT(),o=ot(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var p=0;p<g;p++)h[d]=arguments[p],d++;return n(h,d),d}}),Fv}pI();var jv={},Wh,zv;function wI(){if(zv)return Wh;zv=1;var t=ro(),e=et();return Wh=function(r){if(t(r)==="Function")return e(r)},Wh}var Bh,Uv;function dT(){if(Uv)return Bh;Uv=1;var t=wI(),e=mr(),r=wu(),n=t(t.bind);return Bh=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},Bh}var $h,Yv;function fT(){return Yv||(Yv=1,$h={}),$h}var jh,qv;function vI(){if(qv)return jh;qv=1;var t=en(),e=fT(),r=t("iterator"),n=Array.prototype;return jh=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},jh}var zh,Gv;function gT(){if(Gv)return zh;Gv=1;var t=lT(),e=_a(),r=zg(),n=fT(),i=en(),o=i("iterator");return zh=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},zh}var Uh,Kv;function yI(){if(Kv)return Uh;Kv=1;var t=mt(),e=mr(),r=pt(),n=bu(),i=gT(),o=TypeError;return Uh=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},Uh}var Yh,Xv;function pr(){if(Xv)return Yh;Xv=1;var t=mt(),e=pt(),r=_a();return Yh=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Yh}var qh,Zv;function ss(){if(Zv)return qh;Zv=1;var t=dT(),e=mt(),r=pt(),n=bu(),i=vI(),o=os(),s=Ea(),a=yI(),l=gT(),u=pr(),c=TypeError,h=function(g,p){this.stopped=g,this.result=p},d=h.prototype;return qh=function(g,p,y){var b=y&&y.that,E=!!(y&&y.AS_ENTRIES),v=!!(y&&y.IS_RECORD),T=!!(y&&y.IS_ITERATOR),_=!!(y&&y.INTERRUPTED),M=t(p,b),I,H,V,N,j,z,te,ue=function(Q){return I&&u(I,"normal"),new h(!0,Q)},G=function(Q){return E?(r(Q),_?M(Q[0],Q[1],ue):M(Q[0],Q[1])):_?M(Q,ue):M(Q)};if(v)I=g.iterator;else if(T)I=g;else{if(H=l(g),!H)throw new c(n(g)+" is not iterable");if(i(H)){for(V=0,N=o(g);N>V;V++)if(j=G(g[V]),j&&s(d,j))return j;return new h(!1)}I=a(g,H)}for(z=v?g.next:I.next;!(te=e(z,I)).done;){try{j=G(te.value)}catch(Q){u(I,"throw",Q)}if(typeof j=="object"&&j&&s(d,j))return j}return new h(!1)},qh}var Gh,Qv;function mT(){if(Qv)return Gh;Qv=1;var t=Dr(),e=bi(),r=vu();return Gh=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Gh}var Jv;function bI(){if(Jv)return jv;Jv=1;var t=Le(),e=ss(),r=mT();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),jv}bI();var ey={},Kh,ty;function Cn(){if(ty)return Kh;ty=1;var t=et(),e=Set.prototype;return Kh={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Kh}var Xh,ry;function io(){if(ry)return Xh;ry=1;var t=Cn().has;return Xh=function(e){return t(e),e},Xh}var Zh,ny;function oo(){if(ny)return Zh;ny=1;var t=mt();return Zh=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},Zh}var Qh,iy;function Ia(){if(iy)return Qh;iy=1;var t=et(),e=oo(),r=Cn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return Qh=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Qh}var Jh,oy;function em(){if(oy)return Jh;oy=1;var t=Cn(),e=Ia(),r=t.Set,n=t.add;return Jh=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},Jh}var ed,sy;function Pa(){if(sy)return ed;sy=1;var t=sT(),e=Cn();return ed=t(e.proto,"size","get")||function(r){return r.size},ed}var td,ay;function Ci(){return ay||(ay=1,td=function(t){return{iterator:t,next:t.next,done:!1}}),td}var rd,ly;function so(){if(ly)return rd;ly=1;var t=mr(),e=pt(),r=mt(),n=Oa(),i=Ci(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},rd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},rd}var nd,uy;function CI(){if(uy)return nd;uy=1;var t=io(),e=Cn(),r=em(),n=Pa(),i=so(),o=Ia(),s=oo(),a=e.has,l=e.remove;return nd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(p){d.includes(p)&&l(g,p)}):s(d.getIterator(),function(p){a(g,p)&&l(g,p)}),g},nd}var id,cy;function ao(){if(cy)return id;cy=1;var t=rs(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return id=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},id}var hy;function SI(){if(hy)return ey;hy=1;var t=Le(),e=CI(),r=ot(),n=ao(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),ey}SI();var dy={},od,fy;function RI(){if(fy)return od;fy=1;var t=io(),e=Cn(),r=Pa(),n=so(),i=Ia(),o=oo(),s=e.Set,a=e.add,l=e.has;return od=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(p){l(h,p)&&a(g,p)}):i(h,function(p){d.includes(p)&&a(g,p)}),g},od}var gy;function TI(){if(gy)return dy;gy=1;var t=Le(),e=ot(),r=RI(),n=ao(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),dy}TI();var my={},sd,py;function EI(){if(py)return sd;py=1;var t=io(),e=Cn().has,r=Pa(),n=so(),i=Ia(),o=oo(),s=pr();return sd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},sd}var wy;function _I(){if(wy)return my;wy=1;var t=Le(),e=EI(),r=ao(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),my}_I();var vy={},ad,yy;function OI(){if(yy)return ad;yy=1;var t=io(),e=Pa(),r=Ia(),n=so();return ad=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},ad}var by;function MI(){if(by)return vy;by=1;var t=Le(),e=OI(),r=ao(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),vy}MI();var Cy={},ld,Sy;function II(){if(Sy)return ld;Sy=1;var t=io(),e=Cn().has,r=Pa(),n=so(),i=oo(),o=pr();return ld=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},ld}var Ry;function PI(){if(Ry)return Cy;Ry=1;var t=Le(),e=II(),r=ao(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Cy}PI();var Ty={},ud,Ey;function xI(){if(Ey)return ud;Ey=1;var t=io(),e=Cn(),r=em(),n=so(),i=oo(),o=e.add,s=e.has,a=e.remove;return ud=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},ud}var cd,_y;function pT(){return _y||(_y=1,cd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),cd}var Oy;function HI(){if(Oy)return Ty;Oy=1;var t=Le(),e=xI(),r=pT(),n=ao(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Ty}HI();var My={},hd,Iy;function AI(){if(Iy)return hd;Iy=1;var t=io(),e=Cn().add,r=em(),n=so(),i=oo();return hd=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},hd}var Py;function DI(){if(Py)return My;Py=1;var t=Le(),e=AI(),r=pT(),n=ao(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),My}DI();var xy={},Hy={},dd,Ay;function NI(){if(Ay)return dd;Ay=1;var t=Ea(),e=TypeError;return dd=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},dd}var fd,Dy;function kI(){if(Dy)return fd;Dy=1;var t=ot();return fd=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),fd}var gd,Ny;function wT(){if(Ny)return gd;Ny=1;var t=kr(),e=st(),r=ns(),n=Xg(),i=kI(),o=n("IE_PROTO"),s=Object,a=s.prototype;return gd=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},gd}var md,ky;function LI(){if(ky)return md;ky=1;var t=nT(),e=bi();return md=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},md}var pd={},wd,Ly;function FI(){if(Ly)return wd;Ly=1;var t=iT(),e=Jg();return wd=Object.keys||function(n){return t(n,e)},wd}var Fy;function VI(){if(Fy)return pd;Fy=1;var t=Dr(),e=tT(),r=bi(),n=pt(),i=Ta(),o=FI();return pd.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},pd}var vd,Vy;function vT(){if(Vy)return vd;Vy=1;var t=rs();return vd=t("document","documentElement"),vd}var yd,Wy;function tm(){if(Wy)return yd;Wy=1;var t=pt(),e=VI(),r=Jg(),n=Zg(),i=vT(),o=Kg(),s=Xg(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(v){return l+c+a+v+l+"/"+c+a},p=function(v){v.write(g("")),v.close();var T=v.parentWindow.Object;return v=null,T},y=function(){var v=o("iframe"),T="java"+c+":",_;return v.style.display="none",i.appendChild(v),v.src=String(T),_=v.contentWindow.document,_.open(),_.write(g("document.F=Object")),_.close(),_.F},b,E=function(){try{b=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&b?p(b):y():p(b);for(var v=r.length;v--;)delete E[u][r[v]];return E()};return n[h]=!0,yd=Object.create||function(T,_){var M;return T!==null?(d[u]=t(T),M=new d,d[u]=null,M[h]=T):M=E(),_===void 0?M:e.f(M,_)},yd}var bd,By;function yT(){if(By)return bd;By=1;var t=ot(),e=st(),r=Nr(),n=tm(),i=wT(),o=Qg(),s=en(),a=no(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var p={};return c[l].call(p)!==p});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),bd={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},bd}var $y;function WI(){if($y)return Hy;$y=1;var t=Le(),e=Je(),r=NI(),n=pt(),i=st(),o=wT(),s=LI(),a=mT(),l=ot(),u=kr(),c=en(),h=yT().IteratorPrototype,d=Dr(),g=no(),p="constructor",y="Iterator",b=c("toStringTag"),E=TypeError,v=e[y],T=g||!i(v)||v.prototype!==h||!l(function(){v({})}),_=function(){if(r(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},M=function(I,H){d?s(h,I,{configurable:!0,get:function(){return H},set:function(V){if(n(this),this===h)throw new E("You can't redefine this property");u(this,I)?this[I]=V:a(this,I,V)}}):h[I]=H};return u(h,b)||M(b,y),(T||!u(h,p)||h[p]===Object)&&M(p,_),_.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:_}),Hy}var jy;function BI(){return jy||(jy=1,WI()),xy}BI();var zy={},Uy={},Cd,Yy;function $I(){if(Yy)return Cd;Yy=1;var t=Qg();return Cd=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},Cd}var Sd,qy;function jI(){return qy||(qy=1,Sd=function(t,e){return{value:t,done:e}}),Sd}var Rd,Gy;function zI(){if(Gy)return Rd;Gy=1;var t=pr();return Rd=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},Rd}var Td,Ky;function bT(){if(Ky)return Td;Ky=1;var t=mt(),e=tm(),r=is(),n=$I(),i=en(),o=rT(),s=_a(),a=yT().IteratorPrototype,l=jI(),u=pr(),c=zI(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",p="normal",y="throw",b=o.set,E=function(_){var M=o.getterFor(_?g:d);return n(e(a),{next:function(){var H=M(this);if(_)return H.nextHandler();if(H.done)return l(void 0,!0);try{var V=H.nextHandler();return H.returnHandlerResult?V:l(V,H.done)}catch(N){throw H.done=!0,N}},return:function(){var I=M(this),H=I.iterator;if(I.done=!0,_){var V=s(H,"return");return V?t(V,H):l(void 0,!0)}if(I.inner)try{u(I.inner.iterator,p)}catch(N){return u(H,y,N)}if(I.openIters)try{c(I.openIters,p)}catch(N){return u(H,y,N)}return H&&u(H,p),l(void 0,!0)}})},v=E(!0),T=E(!1);return r(T,h,"Iterator Helper"),Td=function(_,M,I){var H=function(N,j){j?(j.iterator=N.iterator,j.next=N.next):j=N,j.type=M?g:d,j.returnHandlerResult=!!I,j.nextHandler=_,j.counter=0,j.done=!1,b(this,j)};return H.prototype=M?v:T,H},Td}var Ed,Xy;function CT(){if(Xy)return Ed;Xy=1;var t=pt(),e=pr();return Ed=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},Ed}var _d,Zy;function ST(){return Zy||(Zy=1,_d=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),_d}var Od,Qy;function lo(){if(Qy)return Od;Qy=1;var t=Je();return Od=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},Od}var Jy;function UI(){if(Jy)return Uy;Jy=1;var t=Le(),e=mt(),r=mr(),n=pt(),i=Ci(),o=bT(),s=CT(),a=no(),l=pr(),u=ST(),c=lo(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,p=o(function(){for(var y=this.iterator,b=this.predicate,E=this.next,v,T,_;;){if(v=n(e(E,y)),T=this.done=!!v.done,T)return;if(_=v.value,s(y,b,[_,this.counter++],!0))return _}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(E){l(this,"throw",E)}return d?e(d,this,b):new p(i(this),{predicate:b})}}),Uy}var eb;function YI(){return eb||(eb=1,UI()),zy}YI();var tb={},rb={},nb;function qI(){if(nb)return rb;nb=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),rb}var ib;function GI(){return ib||(ib=1,qI()),tb}GI();var ob={},sb={},ab;function KI(){if(ab)return sb;ab=1;var t=Le(),e=mt(),r=mr(),n=pt(),i=Ci(),o=bT(),s=CT(),a=pr(),l=ST(),u=lo(),c=no(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,p=o(function(){var y=this.iterator,b=n(e(this.next,y)),E=this.done=!!b.done;if(!E)return s(y,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new p(i(this),{mapper:b})}}),sb}var lb;function XI(){return lb||(lb=1,KI()),ob}XI();var ub={},cb={},Md,hb;function rm(){if(hb)return Md;hb=1;var t=et();return Md=t([].slice),Md}var Id,db;function RT(){if(db)return Id;db=1;var t=TypeError;return Id=function(e,r){if(e<r)throw new t("Not enough arguments");return e},Id}var Pd,fb;function ZI(){if(fb)return Pd;fb=1;var t=yu();return Pd=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Pd}var xd,gb;function TT(){if(gb)return xd;gb=1;var t=Je(),e=yu(),r=ro(),n=function(i){return e.slice(0,i.length)===i};return xd=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),xd}var Hd,mb;function QI(){if(mb)return Hd;mb=1;var t=TT();return Hd=t==="NODE",Hd}var Ad,pb;function ET(){if(pb)return Ad;pb=1;var t=Je(),e=Ma(),r=dT(),n=st(),i=kr(),o=ot(),s=vT(),a=rm(),l=Kg(),u=RT(),c=ZI(),h=QI(),d=t.setImmediate,g=t.clearImmediate,p=t.process,y=t.Dispatch,b=t.Function,E=t.MessageChannel,v=t.String,T=0,_={},M="onreadystatechange",I,H,V,N;o(function(){I=t.location});var j=function(G){if(i(_,G)){var Q=_[G];delete _[G],Q()}},z=function(G){return function(){j(G)}},te=function(G){j(G.data)},ue=function(G){t.postMessage(v(G),I.protocol+"//"+I.host)};return(!d||!g)&&(d=function(Q){u(arguments.length,1);var at=n(Q)?Q:b(Q),ae=a(arguments,1);return _[++T]=function(){e(at,void 0,ae)},H(T),T},g=function(Q){delete _[Q]},h?H=function(G){p.nextTick(z(G))}:y&&y.now?H=function(G){y.now(z(G))}:E&&!c?(V=new E,N=V.port2,V.port1.onmessage=te,H=r(N.postMessage,N)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&I&&I.protocol!=="file:"&&!o(ue)?(H=ue,t.addEventListener("message",te,!1)):M in l("script")?H=function(G){s.appendChild(l("script"))[M]=function(){s.removeChild(this),j(G)}}:H=function(G){setTimeout(z(G),0)}),Ad={set:d,clear:g},Ad}var wb;function JI(){if(wb)return cb;wb=1;var t=Le(),e=Je(),r=ET().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),cb}var vb={},Dd,yb;function eP(){if(yb)return Dd;yb=1;var t=Je(),e=Ma(),r=st(),n=TT(),i=yu(),o=rm(),s=RT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return Dd=function(u,c){var h=c?2:1;return l?function(d,g){var p=s(arguments.length,1)>h,y=r(d)?d:a(d),b=p?o(arguments,h):[],E=p?function(){e(y,this,b)}:y;return c?u(E,g):u(E)}:u},Dd}var bb;function tP(){if(bb)return vb;bb=1;var t=Le(),e=Je(),r=ET().set,n=eP(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),vb}var Cb;function rP(){return Cb||(Cb=1,JI(),tP()),ub}rP();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:_T,setPrototypeOf:Sb,isFrozen:nP,getPrototypeOf:iP,getOwnPropertyDescriptor:oP}=Object;let{freeze:kt,seal:Ar,create:OT}=Object,{apply:eg,construct:tg}=typeof Reflect<"u"&&Reflect;kt||(kt=function(e){return e});Ar||(Ar=function(e){return e});eg||(eg=function(e,r,n){return e.apply(r,n)});tg||(tg=function(e,r){return new e(...r)});const ja=Lt(Array.prototype.forEach),sP=Lt(Array.prototype.lastIndexOf),Rb=Lt(Array.prototype.pop),ws=Lt(Array.prototype.push),aP=Lt(Array.prototype.splice),kl=Lt(String.prototype.toLowerCase),Nd=Lt(String.prototype.toString),Tb=Lt(String.prototype.match),vs=Lt(String.prototype.replace),lP=Lt(String.prototype.indexOf),uP=Lt(String.prototype.trim),Yr=Lt(Object.prototype.hasOwnProperty),Pt=Lt(RegExp.prototype.test),ys=cP(TypeError);function Lt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return eg(t,e,n)}}function cP(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return tg(t,r)}}function he(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kl;Sb&&Sb(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(nP(e)||(e[n]=o),i=o)}t[i]=!0}return t}function hP(t){for(let e=0;e<t.length;e++)Yr(t,e)||(t[e]=null);return t}function kn(t){const e=OT(null);for(const[r,n]of _T(t))Yr(t,r)&&(Array.isArray(n)?e[r]=hP(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=kn(n):e[r]=n);return e}function bs(t,e){for(;t!==null;){const n=oP(t,e);if(n){if(n.get)return Lt(n.get);if(typeof n.value=="function")return Lt(n.value)}t=iP(t)}function r(){return null}return r}const Eb=kt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),kd=kt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ld=kt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),dP=kt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fd=kt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),fP=kt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_b=kt(["#text"]),Ob=kt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Vd=kt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Mb=kt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),za=kt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),gP=Ar(/\{\{[\w\W]*|[\w\W]*\}\}/gm),mP=Ar(/<%[\w\W]*|[\w\W]*%>/gm),pP=Ar(/\$\{[\w\W]*/gm),wP=Ar(/^data-[\-\w.\u00B7-\uFFFF]+$/),vP=Ar(/^aria-[\-\w]+$/),MT=Ar(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yP=Ar(/^(?:\w+script|data):/i),bP=Ar(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),IT=Ar(/^html$/i),CP=Ar(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ib=Object.freeze({__proto__:null,ARIA_ATTR:vP,ATTR_WHITESPACE:bP,CUSTOM_ELEMENT:CP,DATA_ATTR:wP,DOCTYPE_NAME:IT,ERB_EXPR:mP,IS_ALLOWED_URI:MT,IS_SCRIPT_OR_DATA:yP,MUSTACHE_EXPR:gP,TMPLIT_EXPR:pP});const Cs={element:1,text:3,progressingInstruction:7,comment:8,document:9},SP=function(){return typeof window>"u"?null:window},RP=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Pb=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function PT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:SP();const e=K=>PT(K);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Cs.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,p=l.prototype,y=bs(p,"cloneNode"),b=bs(p,"remove"),E=bs(p,"nextSibling"),v=bs(p,"childNodes"),T=bs(p,"parentNode");if(typeof s=="function"){const K=r.createElement("template");K.content&&K.content.ownerDocument&&(r=K.content.ownerDocument)}let _,M="";const{implementation:I,createNodeIterator:H,createDocumentFragment:V,getElementsByTagName:N}=r,{importNode:j}=n;let z=Pb();e.isSupported=typeof _T=="function"&&typeof T=="function"&&I&&I.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:te,ERB_EXPR:ue,TMPLIT_EXPR:G,DATA_ATTR:Q,ARIA_ATTR:at,IS_SCRIPT_OR_DATA:ae,ATTR_WHITESPACE:be,CUSTOM_ELEMENT:Ge}=Ib;let{IS_ALLOWED_URI:vr}=Ib,Ee=null;const f=he({},[...Eb,...kd,...Ld,...Fd,..._b]);let m=null;const w=he({},[...Ob,...Vd,...Mb,...za]);let C=Object.seal(OT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),R=null,O=null,P=!0,A=!0,Y=!1,B=!0,x=!1,oe=!0,$=!1,ee=!1,Ce=!1,Ie=!1,de=!1,fe=!1,re=!0,_e=!1;const Ue="user-content-";let ht=!0,yr=!1,Ct={},St=null;const br=he({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Zn=null;const Qn=he({},["audio","video","img","source","image","track"]);let fo=null;const fs=he({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jn="http://www.w3.org/1998/Math/MathML",Ft="http://www.w3.org/2000/svg",Vt="http://www.w3.org/1999/xhtml";let ir=Vt,En=!1,Wt=null;const Cr=he({},[Jn,Ft,Vt],Nd);let Ri=he({},["mi","mo","mn","ms","mtext"]),Ti=he({},["annotation-xml"]);const EO=he({},["title","style","font","a","script"]);let gs=null;const _O=["application/xhtml+xml","text/html"],OO="text/html";let dt=null,go=null;const MO=r.createElement("form"),$p=function(S){return S instanceof RegExp||S instanceof Function},ic=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(go&&go===S)){if((!S||typeof S!="object")&&(S={}),S=kn(S),gs=_O.indexOf(S.PARSER_MEDIA_TYPE)===-1?OO:S.PARSER_MEDIA_TYPE,dt=gs==="application/xhtml+xml"?Nd:kl,Ee=Yr(S,"ALLOWED_TAGS")?he({},S.ALLOWED_TAGS,dt):f,m=Yr(S,"ALLOWED_ATTR")?he({},S.ALLOWED_ATTR,dt):w,Wt=Yr(S,"ALLOWED_NAMESPACES")?he({},S.ALLOWED_NAMESPACES,Nd):Cr,fo=Yr(S,"ADD_URI_SAFE_ATTR")?he(kn(fs),S.ADD_URI_SAFE_ATTR,dt):fs,Zn=Yr(S,"ADD_DATA_URI_TAGS")?he(kn(Qn),S.ADD_DATA_URI_TAGS,dt):Qn,St=Yr(S,"FORBID_CONTENTS")?he({},S.FORBID_CONTENTS,dt):br,R=Yr(S,"FORBID_TAGS")?he({},S.FORBID_TAGS,dt):kn({}),O=Yr(S,"FORBID_ATTR")?he({},S.FORBID_ATTR,dt):kn({}),Ct=Yr(S,"USE_PROFILES")?S.USE_PROFILES:!1,P=S.ALLOW_ARIA_ATTR!==!1,A=S.ALLOW_DATA_ATTR!==!1,Y=S.ALLOW_UNKNOWN_PROTOCOLS||!1,B=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,x=S.SAFE_FOR_TEMPLATES||!1,oe=S.SAFE_FOR_XML!==!1,$=S.WHOLE_DOCUMENT||!1,Ie=S.RETURN_DOM||!1,de=S.RETURN_DOM_FRAGMENT||!1,fe=S.RETURN_TRUSTED_TYPE||!1,Ce=S.FORCE_BODY||!1,re=S.SANITIZE_DOM!==!1,_e=S.SANITIZE_NAMED_PROPS||!1,ht=S.KEEP_CONTENT!==!1,yr=S.IN_PLACE||!1,vr=S.ALLOWED_URI_REGEXP||MT,ir=S.NAMESPACE||Vt,Ri=S.MATHML_TEXT_INTEGRATION_POINTS||Ri,Ti=S.HTML_INTEGRATION_POINTS||Ti,C=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&$p(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&$p(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(A=!1),de&&(Ie=!0),Ct&&(Ee=he({},_b),m=[],Ct.html===!0&&(he(Ee,Eb),he(m,Ob)),Ct.svg===!0&&(he(Ee,kd),he(m,Vd),he(m,za)),Ct.svgFilters===!0&&(he(Ee,Ld),he(m,Vd),he(m,za)),Ct.mathMl===!0&&(he(Ee,Fd),he(m,Mb),he(m,za))),S.ADD_TAGS&&(Ee===f&&(Ee=kn(Ee)),he(Ee,S.ADD_TAGS,dt)),S.ADD_ATTR&&(m===w&&(m=kn(m)),he(m,S.ADD_ATTR,dt)),S.ADD_URI_SAFE_ATTR&&he(fo,S.ADD_URI_SAFE_ATTR,dt),S.FORBID_CONTENTS&&(St===br&&(St=kn(St)),he(St,S.FORBID_CONTENTS,dt)),ht&&(Ee["#text"]=!0),$&&he(Ee,["html","head","body"]),Ee.table&&(he(Ee,["tbody"]),delete R.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw ys('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ys('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=S.TRUSTED_TYPES_POLICY,M=_.createHTML("")}else _===void 0&&(_=RP(g,i)),_!==null&&typeof M=="string"&&(M=_.createHTML(""));kt&&kt(S),go=S}},jp=he({},[...kd,...Ld,...dP]),zp=he({},[...Fd,...fP]),IO=function(S){let k=T(S);(!k||!k.tagName)&&(k={namespaceURI:ir,tagName:"template"});const q=kl(S.tagName),je=kl(k.tagName);return Wt[S.namespaceURI]?S.namespaceURI===Ft?k.namespaceURI===Vt?q==="svg":k.namespaceURI===Jn?q==="svg"&&(je==="annotation-xml"||Ri[je]):!!jp[q]:S.namespaceURI===Jn?k.namespaceURI===Vt?q==="math":k.namespaceURI===Ft?q==="math"&&Ti[je]:!!zp[q]:S.namespaceURI===Vt?k.namespaceURI===Ft&&!Ti[je]||k.namespaceURI===Jn&&!Ri[je]?!1:!zp[q]&&(EO[q]||!jp[q]):!!(gs==="application/xhtml+xml"&&Wt[S.namespaceURI]):!1},nn=function(S){ws(e.removed,{element:S});try{T(S).removeChild(S)}catch{b(S)}},mo=function(S,k){try{ws(e.removed,{attribute:k.getAttributeNode(S),from:k})}catch{ws(e.removed,{attribute:null,from:k})}if(k.removeAttribute(S),S==="is")if(Ie||de)try{nn(k)}catch{}else try{k.setAttribute(S,"")}catch{}},Up=function(S){let k=null,q=null;if(Ce)S="<remove></remove>"+S;else{const lt=Tb(S,/^[\r\n\t ]+/);q=lt&&lt[0]}gs==="application/xhtml+xml"&&ir===Vt&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const je=_?_.createHTML(S):S;if(ir===Vt)try{k=new d().parseFromString(je,gs)}catch{}if(!k||!k.documentElement){k=I.createDocument(ir,"template",null);try{k.documentElement.innerHTML=En?M:je}catch{}}const Rt=k.body||k.documentElement;return S&&q&&Rt.insertBefore(r.createTextNode(q),Rt.childNodes[0]||null),ir===Vt?N.call(k,$?"html":"body")[0]:$?k.documentElement:Rt},Yp=function(S){return H.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},oc=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},qp=function(S){return typeof a=="function"&&S instanceof a};function _n(K,S,k){ja(K,q=>{q.call(e,S,k,go)})}const Gp=function(S){let k=null;if(_n(z.beforeSanitizeElements,S,null),oc(S))return nn(S),!0;const q=dt(S.nodeName);if(_n(z.uponSanitizeElement,S,{tagName:q,allowedTags:Ee}),oe&&S.hasChildNodes()&&!qp(S.firstElementChild)&&Pt(/<[/\w!]/g,S.innerHTML)&&Pt(/<[/\w!]/g,S.textContent)||S.nodeType===Cs.progressingInstruction||oe&&S.nodeType===Cs.comment&&Pt(/<[/\w]/g,S.data))return nn(S),!0;if(!Ee[q]||R[q]){if(!R[q]&&Xp(q)&&(C.tagNameCheck instanceof RegExp&&Pt(C.tagNameCheck,q)||C.tagNameCheck instanceof Function&&C.tagNameCheck(q)))return!1;if(ht&&!St[q]){const je=T(S)||S.parentNode,Rt=v(S)||S.childNodes;if(Rt&&je){const lt=Rt.length;for(let Bt=lt-1;Bt>=0;--Bt){const On=y(Rt[Bt],!0);On.__removalCount=(S.__removalCount||0)+1,je.insertBefore(On,E(S))}}}return nn(S),!0}return S instanceof l&&!IO(S)||(q==="noscript"||q==="noembed"||q==="noframes")&&Pt(/<\/no(script|embed|frames)/i,S.innerHTML)?(nn(S),!0):(x&&S.nodeType===Cs.text&&(k=S.textContent,ja([te,ue,G],je=>{k=vs(k,je," ")}),S.textContent!==k&&(ws(e.removed,{element:S.cloneNode()}),S.textContent=k)),_n(z.afterSanitizeElements,S,null),!1)},Kp=function(S,k,q){if(re&&(k==="id"||k==="name")&&(q in r||q in MO))return!1;if(!(A&&!O[k]&&Pt(Q,k))){if(!(P&&Pt(at,k))){if(!m[k]||O[k]){if(!(Xp(S)&&(C.tagNameCheck instanceof RegExp&&Pt(C.tagNameCheck,S)||C.tagNameCheck instanceof Function&&C.tagNameCheck(S))&&(C.attributeNameCheck instanceof RegExp&&Pt(C.attributeNameCheck,k)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(k))||k==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&Pt(C.tagNameCheck,q)||C.tagNameCheck instanceof Function&&C.tagNameCheck(q))))return!1}else if(!fo[k]){if(!Pt(vr,vs(q,be,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&S!=="script"&&lP(q,"data:")===0&&Zn[S])){if(!(Y&&!Pt(ae,vs(q,be,"")))){if(q)return!1}}}}}}return!0},Xp=function(S){return S!=="annotation-xml"&&Tb(S,Ge)},Zp=function(S){_n(z.beforeSanitizeAttributes,S,null);const{attributes:k}=S;if(!k||oc(S))return;const q={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let je=k.length;for(;je--;){const Rt=k[je],{name:lt,namespaceURI:Bt,value:On}=Rt,ms=dt(lt),sc=On;let Tt=lt==="value"?sc:uP(sc);if(q.attrName=ms,q.attrValue=Tt,q.keepAttr=!0,q.forceKeepAttr=void 0,_n(z.uponSanitizeAttribute,S,q),Tt=q.attrValue,_e&&(ms==="id"||ms==="name")&&(mo(lt,S),Tt=Ue+Tt),oe&&Pt(/((--!?|])>)|<\/(style|title)/i,Tt)){mo(lt,S);continue}if(q.forceKeepAttr)continue;if(!q.keepAttr){mo(lt,S);continue}if(!B&&Pt(/\/>/i,Tt)){mo(lt,S);continue}x&&ja([te,ue,G],Jp=>{Tt=vs(Tt,Jp," ")});const Qp=dt(S.nodeName);if(!Kp(Qp,ms,Tt)){mo(lt,S);continue}if(_&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Bt)switch(g.getAttributeType(Qp,ms)){case"TrustedHTML":{Tt=_.createHTML(Tt);break}case"TrustedScriptURL":{Tt=_.createScriptURL(Tt);break}}if(Tt!==sc)try{Bt?S.setAttributeNS(Bt,lt,Tt):S.setAttribute(lt,Tt),oc(S)?nn(S):Rb(e.removed)}catch{mo(lt,S)}}_n(z.afterSanitizeAttributes,S,null)},PO=function K(S){let k=null;const q=Yp(S);for(_n(z.beforeSanitizeShadowDOM,S,null);k=q.nextNode();)_n(z.uponSanitizeShadowNode,k,null),Gp(k),Zp(k),k.content instanceof o&&K(k.content);_n(z.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(K){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,q=null,je=null,Rt=null;if(En=!K,En&&(K="<!-->"),typeof K!="string"&&!qp(K))if(typeof K.toString=="function"){if(K=K.toString(),typeof K!="string")throw ys("dirty is not a string, aborting")}else throw ys("toString is not a function");if(!e.isSupported)return K;if(ee||ic(S),e.removed=[],typeof K=="string"&&(yr=!1),yr){if(K.nodeName){const On=dt(K.nodeName);if(!Ee[On]||R[On])throw ys("root node is forbidden and cannot be sanitized in-place")}}else if(K instanceof a)k=Up("<!---->"),q=k.ownerDocument.importNode(K,!0),q.nodeType===Cs.element&&q.nodeName==="BODY"||q.nodeName==="HTML"?k=q:k.appendChild(q);else{if(!Ie&&!x&&!$&&K.indexOf("<")===-1)return _&&fe?_.createHTML(K):K;if(k=Up(K),!k)return Ie?null:fe?M:""}k&&Ce&&nn(k.firstChild);const lt=Yp(yr?K:k);for(;je=lt.nextNode();)Gp(je),Zp(je),je.content instanceof o&&PO(je.content);if(yr)return K;if(Ie){if(de)for(Rt=V.call(k.ownerDocument);k.firstChild;)Rt.appendChild(k.firstChild);else Rt=k;return(m.shadowroot||m.shadowrootmode)&&(Rt=j.call(n,Rt,!0)),Rt}let Bt=$?k.outerHTML:k.innerHTML;return $&&Ee["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&Pt(IT,k.ownerDocument.doctype.name)&&(Bt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+Bt),x&&ja([te,ue,G],On=>{Bt=vs(Bt,On," ")}),_&&fe?_.createHTML(Bt):Bt},e.setConfig=function(){let K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ic(K),ee=!0},e.clearConfig=function(){go=null,ee=!1},e.isValidAttribute=function(K,S,k){go||ic({});const q=dt(K),je=dt(S);return Kp(q,je,k)},e.addHook=function(K,S){typeof S=="function"&&ws(z[K],S)},e.removeHook=function(K,S){if(S!==void 0){const k=sP(z[K],S);return k===-1?void 0:aP(z[K],k,1)[0]}return Rb(z[K])},e.removeHooks=function(K){z[K]=[]},e.removeAllHooks=function(){z=Pb()},e}var TP=PT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var xT;function L(){return xT.apply(null,arguments)}function EP(t){xT=t}function Qr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function qi(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Re(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nm(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Re(t,e))return!1;return!0}function qt(t){return t===void 0}function Un(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function xa(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function HT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function ci(t,e){for(var r in e)Re(e,r)&&(t[r]=e[r]);return Re(e,"toString")&&(t.toString=e.toString),Re(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Sn(t,e,r,n){return tE(t,e,r,n,!0).utc()}function _P(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function se(t){return t._pf==null&&(t._pf=_P()),t._pf}var rg;Array.prototype.some?rg=Array.prototype.some:rg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function im(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=se(t),r=rg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Su(t){var e=Sn(NaN);return t!=null?ci(se(e),t):se(e).userInvalidated=!0,e}var xb=L.momentProperties=[],Wd=!1;function om(t,e){var r,n,i,o=xb.length;if(qt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),qt(e._i)||(t._i=e._i),qt(e._f)||(t._f=e._f),qt(e._l)||(t._l=e._l),qt(e._strict)||(t._strict=e._strict),qt(e._tzm)||(t._tzm=e._tzm),qt(e._isUTC)||(t._isUTC=e._isUTC),qt(e._offset)||(t._offset=e._offset),qt(e._pf)||(t._pf=se(e)),qt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=xb[r],i=e[n],qt(i)||(t[n]=i);return t}function Ha(t){om(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Wd===!1&&(Wd=!0,L.updateOffset(this),Wd=!1)}function Jr(t){return t instanceof Ha||t!=null&&t._isAMomentObject!=null}function AT(t){L.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Lr(t,e){var r=!0;return ci(function(){if(L.deprecationHandler!=null&&L.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Re(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}AT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var Hb={};function DT(t,e){L.deprecationHandler!=null&&L.deprecationHandler(t,e),Hb[t]||(AT(e),Hb[t]=!0)}L.suppressDeprecationWarnings=!1;L.deprecationHandler=null;function Rn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function OP(t){var e,r;for(r in t)Re(t,r)&&(e=t[r],Rn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ng(t,e){var r=ci({},t),n;for(n in e)Re(e,n)&&(qi(t[n])&&qi(e[n])?(r[n]={},ci(r[n],t[n]),ci(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Re(t,n)&&!Re(e,n)&&qi(t[n])&&(r[n]=ci({},r[n]));return r}function sm(t){t!=null&&this.set(t)}var ig;Object.keys?ig=Object.keys:ig=function(t){var e,r=[];for(e in t)Re(t,e)&&r.push(e);return r};var MP={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function IP(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Rn(n)?n.call(e,r):n}function vn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var am=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ua=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Bd={},jo={};function X(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(jo[t]=i),e&&(jo[e[0]]=function(){return vn(i.apply(this,arguments),e[1],e[2])}),r&&(jo[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function PP(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function xP(t){var e=t.match(am),r,n;for(r=0,n=e.length;r<n;r++)jo[e[r]]?e[r]=jo[e[r]]:e[r]=PP(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Rn(e[s])?e[s].call(i,t):e[s];return o}}function Ll(t,e){return t.isValid()?(e=NT(e,t.localeData()),Bd[e]=Bd[e]||xP(e),Bd[e](t)):t.localeData().invalidDate()}function NT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Ua.lastIndex=0;r>=0&&Ua.test(t);)t=t.replace(Ua,n),Ua.lastIndex=0,r-=1;return t}var HP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function AP(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(am).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var DP="Invalid date";function NP(){return this._invalidDate}var kP="%d",LP=/\d{1,2}/;function FP(t){return this._ordinal.replace("%d",t)}var VP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function WP(t,e,r,n){var i=this._relativeTime[r];return Rn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function BP(t,e){var r=this._relativeTime[t>0?"future":"past"];return Rn(r)?r(e):r.replace(/%s/i,e)}var Ab={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Fr(t){return typeof t=="string"?Ab[t]||Ab[t.toLowerCase()]:void 0}function lm(t){var e={},r,n;for(n in t)Re(t,n)&&(r=Fr(n),r&&(e[r]=t[n]));return e}var $P={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function jP(t){var e=[],r;for(r in t)Re(t,r)&&e.push({unit:r,priority:$P[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var kT=/\d/,wr=/\d\d/,LT=/\d{3}/,um=/\d{4}/,Ru=/[+-]?\d{6}/,$e=/\d\d?/,FT=/\d\d\d\d?/,VT=/\d\d\d\d\d\d?/,Tu=/\d{1,3}/,cm=/\d{1,4}/,Eu=/[+-]?\d{1,6}/,as=/\d+/,_u=/[+-]?\d+/,zP=/Z|[+-]\d\d:?\d\d/gi,Ou=/Z|[+-]\d\d(?::?\d\d)?/gi,UP=/[+-]?\d+(\.\d{1,3})?/,Aa=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ls=/^[1-9]\d?/,hm=/^([1-9]\d|\d)/,eu;eu={};function W(t,e,r){eu[t]=Rn(e)?e:function(n,i){return n&&r?r:e}}function YP(t,e){return Re(eu,t)?eu[t](e._strict,e._locale):new RegExp(qP(t))}function qP(t){return $n(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function $n(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ir(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function pe(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Ir(e)),r}var og={};function xe(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),Un(e)&&(n=function(o,s){s[e]=pe(o)}),i=t.length,r=0;r<i;r++)og[t[r]]=n}function Da(t,e){xe(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function GP(t,e,r){e!=null&&Re(og,t)&&og[t](e,r._a,r,t)}function Mu(t){return t%4===0&&t%100!==0||t%400===0}var Mt=0,Wn=1,gn=2,ct=3,Xr=4,Bn=5,zi=6,KP=7,XP=8;X("Y",0,0,function(){var t=this.year();return t<=9999?vn(t,4):"+"+t});X(0,["YY",2],0,function(){return this.year()%100});X(0,["YYYY",4],0,"year");X(0,["YYYYY",5],0,"year");X(0,["YYYYYY",6,!0],0,"year");W("Y",_u);W("YY",$e,wr);W("YYYY",cm,um);W("YYYYY",Eu,Ru);W("YYYYYY",Eu,Ru);xe(["YYYYY","YYYYYY"],Mt);xe("YYYY",function(t,e){e[Mt]=t.length===2?L.parseTwoDigitYear(t):pe(t)});xe("YY",function(t,e){e[Mt]=L.parseTwoDigitYear(t)});xe("Y",function(t,e){e[Mt]=parseInt(t,10)});function oa(t){return Mu(t)?366:365}L.parseTwoDigitYear=function(t){return pe(t)+(pe(t)>68?1900:2e3)};var WT=us("FullYear",!0);function ZP(){return Mu(this.year())}function us(t,e){return function(r){return r!=null?(BT(this,t,r),L.updateOffset(this,e),this):ga(this,t)}}function ga(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function BT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!Mu(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function QP(t){return t=Fr(t),Rn(this[t])?this[t]():this}function JP(t,e){if(typeof t=="object"){t=lm(t);var r=jP(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Fr(t),Rn(this[t]))return this[t](e);return this}function ex(t,e){return(t%e+e)%e}var Qe;Array.prototype.indexOf?Qe=Array.prototype.indexOf:Qe=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function dm(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=ex(e,12);return t+=(e-r)/12,r===1?Mu(t)?29:28:31-r%7%2}X("M",["MM",2],"Mo",function(){return this.month()+1});X("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});X("MMMM",0,0,function(t){return this.localeData().months(this,t)});W("M",$e,ls);W("MM",$e,wr);W("MMM",function(t,e){return e.monthsShortRegex(t)});W("MMMM",function(t,e){return e.monthsRegex(t)});xe(["M","MM"],function(t,e){e[Wn]=pe(t)-1});xe(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Wn]=i:se(r).invalidMonth=t});var tx="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),$T="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),jT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,rx=Aa,nx=Aa;function ix(t,e){return t?Qr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||jT).test(e)?"format":"standalone"][t.month()]:Qr(this._months)?this._months:this._months.standalone}function ox(t,e){return t?Qr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[jT.test(e)?"format":"standalone"][t.month()]:Qr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function sx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=Sn([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Qe.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:(i=Qe.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Qe.call(this._longMonthsParse,s),i!==-1?i:(i=Qe.call(this._shortMonthsParse,s),i!==-1?i:null))}function ax(t,e,r){var n,i,o;if(this._monthsParseExact)return sx.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Sn([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function zT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=pe(e);else if(e=t.localeData().monthsParse(e),!Un(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,dm(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function UT(t){return t!=null?(zT(this,t),L.updateOffset(this,!0),this):ga(this,"Month")}function lx(){return dm(this.year(),this.month())}function ux(t){return this._monthsParseExact?(Re(this,"_monthsRegex")||YT.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Re(this,"_monthsShortRegex")||(this._monthsShortRegex=rx),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function cx(t){return this._monthsParseExact?(Re(this,"_monthsRegex")||YT.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Re(this,"_monthsRegex")||(this._monthsRegex=nx),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function YT(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=Sn([2e3,i]),s=$n(this.monthsShort(o,"")),a=$n(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function hx(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function ma(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function tu(t,e,r){var n=7+e-r,i=(7+ma(t,0,n).getUTCDay()-e)%7;return-i+n-1}function qT(t,e,r,n,i){var o=(7+r-n)%7,s=tu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=oa(l)+a):a>oa(t)?(l=t+1,u=a-oa(t)):(l=t,u=a),{year:l,dayOfYear:u}}function pa(t,e,r){var n=tu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+jn(s,e,r)):i>jn(t.year(),e,r)?(o=i-jn(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function jn(t,e,r){var n=tu(t,e,r),i=tu(t+1,e,r);return(oa(t)-n+i)/7}X("w",["ww",2],"wo","week");X("W",["WW",2],"Wo","isoWeek");W("w",$e,ls);W("ww",$e,wr);W("W",$e,ls);W("WW",$e,wr);Da(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=pe(t)});function dx(t){return pa(t,this._week.dow,this._week.doy).week}var fx={dow:0,doy:6};function gx(){return this._week.dow}function mx(){return this._week.doy}function px(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function wx(t){var e=pa(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}X("d",0,"do","day");X("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});X("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});X("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});X("e",0,0,"weekday");X("E",0,0,"isoWeekday");W("d",$e);W("e",$e);W("E",$e);W("dd",function(t,e){return e.weekdaysMinRegex(t)});W("ddd",function(t,e){return e.weekdaysShortRegex(t)});W("dddd",function(t,e){return e.weekdaysRegex(t)});Da(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:se(r).invalidWeekday=t});Da(["d","e","E"],function(t,e,r,n){e[n]=pe(t)});function vx(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function yx(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function fm(t,e){return t.slice(e,7).concat(t.slice(0,e))}var bx="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),GT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Cx="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Sx=Aa,Rx=Aa,Tx=Aa;function Ex(t,e){var r=Qr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?fm(r,this._week.dow):t?r[t.day()]:r}function _x(t){return t===!0?fm(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Ox(t){return t===!0?fm(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Mx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=Sn([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Qe.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Qe.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Qe.call(this._weekdaysParse,s),i!==-1||(i=Qe.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Qe.call(this._shortWeekdaysParse,s),i!==-1||(i=Qe.call(this._weekdaysParse,s),i!==-1)?i:(i=Qe.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Qe.call(this._minWeekdaysParse,s),i!==-1||(i=Qe.call(this._weekdaysParse,s),i!==-1)?i:(i=Qe.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function Ix(t,e,r){var n,i,o;if(this._weekdaysParseExact)return Mx.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Sn([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function Px(t){if(!this.isValid())return t!=null?this:NaN;var e=ga(this,"Day");return t!=null?(t=vx(t,this.localeData()),this.add(t-e,"d")):e}function xx(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Hx(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=yx(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function Ax(t){return this._weekdaysParseExact?(Re(this,"_weekdaysRegex")||gm.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Re(this,"_weekdaysRegex")||(this._weekdaysRegex=Sx),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Dx(t){return this._weekdaysParseExact?(Re(this,"_weekdaysRegex")||gm.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Re(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Rx),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Nx(t){return this._weekdaysParseExact?(Re(this,"_weekdaysRegex")||gm.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Re(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Tx),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function gm(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Sn([2e3,1]).day(o),a=$n(this.weekdaysMin(s,"")),l=$n(this.weekdaysShort(s,"")),u=$n(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function mm(){return this.hours()%12||12}function kx(){return this.hours()||24}X("H",["HH",2],0,"hour");X("h",["hh",2],0,mm);X("k",["kk",2],0,kx);X("hmm",0,0,function(){return""+mm.apply(this)+vn(this.minutes(),2)});X("hmmss",0,0,function(){return""+mm.apply(this)+vn(this.minutes(),2)+vn(this.seconds(),2)});X("Hmm",0,0,function(){return""+this.hours()+vn(this.minutes(),2)});X("Hmmss",0,0,function(){return""+this.hours()+vn(this.minutes(),2)+vn(this.seconds(),2)});function KT(t,e){X(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}KT("a",!0);KT("A",!1);function XT(t,e){return e._meridiemParse}W("a",XT);W("A",XT);W("H",$e,hm);W("h",$e,ls);W("k",$e,ls);W("HH",$e,wr);W("hh",$e,wr);W("kk",$e,wr);W("hmm",FT);W("hmmss",VT);W("Hmm",FT);W("Hmmss",VT);xe(["H","HH"],ct);xe(["k","kk"],function(t,e,r){var n=pe(t);e[ct]=n===24?0:n});xe(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});xe(["h","hh"],function(t,e,r){e[ct]=pe(t),se(r).bigHour=!0});xe("hmm",function(t,e,r){var n=t.length-2;e[ct]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n)),se(r).bigHour=!0});xe("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ct]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n,2)),e[Bn]=pe(t.substr(i)),se(r).bigHour=!0});xe("Hmm",function(t,e,r){var n=t.length-2;e[ct]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n))});xe("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[ct]=pe(t.substr(0,n)),e[Xr]=pe(t.substr(n,2)),e[Bn]=pe(t.substr(i))});function Lx(t){return(t+"").toLowerCase().charAt(0)==="p"}var Fx=/[ap]\.?m?\.?/i,Vx=us("Hours",!0);function Wx(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var ZT={calendar:MP,longDateFormat:HP,invalidDate:DP,ordinal:kP,dayOfMonthOrdinalParse:LP,relativeTime:VP,months:tx,monthsShort:$T,week:fx,weekdays:bx,weekdaysMin:Cx,weekdaysShort:GT,meridiemParse:Fx},ze={},Ss={},wa;function Bx(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function Db(t){return t&&t.toLowerCase().replace("_","-")}function $x(t){for(var e=0,r,n,i,o;e<t.length;){for(o=Db(t[e]).split("-"),r=o.length,n=Db(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Iu(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&Bx(o,n)>=r-1)break;r--}e++}return wa}function jx(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Iu(t){var e=null,r;if(ze[t]===void 0&&typeof ql<"u"&&ql&&ql.exports&&jx(t))try{e=wa._abbr,r=require,r("./locale/"+t),gi(e)}catch{ze[t]=null}return ze[t]}function gi(t,e){var r;return t&&(qt(e)?r=qn(t):r=pm(t,e),r?wa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),wa._abbr}function pm(t,e){if(e!==null){var r,n=ZT;if(e.abbr=t,ze[t]!=null)DT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ze[t]._config;else if(e.parentLocale!=null)if(ze[e.parentLocale]!=null)n=ze[e.parentLocale]._config;else if(r=Iu(e.parentLocale),r!=null)n=r._config;else return Ss[e.parentLocale]||(Ss[e.parentLocale]=[]),Ss[e.parentLocale].push({name:t,config:e}),null;return ze[t]=new sm(ng(n,e)),Ss[t]&&Ss[t].forEach(function(i){pm(i.name,i.config)}),gi(t),ze[t]}else return delete ze[t],null}function zx(t,e){if(e!=null){var r,n,i=ZT;ze[t]!=null&&ze[t].parentLocale!=null?ze[t].set(ng(ze[t]._config,e)):(n=Iu(t),n!=null&&(i=n._config),e=ng(i,e),n==null&&(e.abbr=t),r=new sm(e),r.parentLocale=ze[t],ze[t]=r),gi(t)}else ze[t]!=null&&(ze[t].parentLocale!=null?(ze[t]=ze[t].parentLocale,t===gi()&&gi(t)):ze[t]!=null&&delete ze[t]);return ze[t]}function qn(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return wa;if(!Qr(t)){if(e=Iu(t),e)return e;t=[t]}return $x(t)}function Ux(){return ig(ze)}function wm(t){var e,r=t._a;return r&&se(t).overflow===-2&&(e=r[Wn]<0||r[Wn]>11?Wn:r[gn]<1||r[gn]>dm(r[Mt],r[Wn])?gn:r[ct]<0||r[ct]>24||r[ct]===24&&(r[Xr]!==0||r[Bn]!==0||r[zi]!==0)?ct:r[Xr]<0||r[Xr]>59?Xr:r[Bn]<0||r[Bn]>59?Bn:r[zi]<0||r[zi]>999?zi:-1,se(t)._overflowDayOfYear&&(e<Mt||e>gn)&&(e=gn),se(t)._overflowWeeks&&e===-1&&(e=KP),se(t)._overflowWeekday&&e===-1&&(e=XP),se(t).overflow=e),t}var Yx=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,qx=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Gx=/Z|[+-]\d\d(?::?\d\d)?/,Ya=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],$d=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Kx=/^\/?Date\((-?\d+)/i,Xx=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Zx={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function QT(t){var e,r,n=t._i,i=Yx.exec(n)||qx.exec(n),o,s,a,l,u=Ya.length,c=$d.length;if(i){for(se(t).iso=!0,e=0,r=u;e<r;e++)if(Ya[e][1].exec(i[1])){s=Ya[e][0],o=Ya[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if($d[e][1].exec(i[3])){a=(i[2]||" ")+$d[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(Gx.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),ym(t)}else t._isValid=!1}function Qx(t,e,r,n,i,o){var s=[Jx(t),$T.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Jx(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function eH(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function tH(t,e,r){if(t){var n=GT.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return se(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function rH(t,e,r){if(t)return Zx[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function JT(t){var e=Xx.exec(eH(t._i)),r;if(e){if(r=Qx(e[4],e[3],e[2],e[5],e[6],e[7]),!tH(e[1],r,t))return;t._a=r,t._tzm=rH(e[8],e[9],e[10]),t._d=ma.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),se(t).rfc2822=!0}else t._isValid=!1}function nH(t){var e=Kx.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(QT(t),t._isValid===!1)delete t._isValid;else return;if(JT(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:L.createFromInputFallback(t)}L.createFromInputFallback=Lr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Lo(t,e,r){return t??e??r}function iH(t){var e=new Date(L.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function vm(t){var e,r,n=[],i,o,s;if(!t._d){for(i=iH(t),t._w&&t._a[gn]==null&&t._a[Wn]==null&&oH(t),t._dayOfYear!=null&&(s=Lo(t._a[Mt],i[Mt]),(t._dayOfYear>oa(s)||t._dayOfYear===0)&&(se(t)._overflowDayOfYear=!0),r=ma(s,0,t._dayOfYear),t._a[Wn]=r.getUTCMonth(),t._a[gn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[ct]===24&&t._a[Xr]===0&&t._a[Bn]===0&&t._a[zi]===0&&(t._nextDay=!0,t._a[ct]=0),t._d=(t._useUTC?ma:hx).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[ct]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(se(t).weekdayMismatch=!0)}}function oH(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=Lo(e.GG,t._a[Mt],pa(Be(),1,4).year),n=Lo(e.W,1),i=Lo(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=pa(Be(),o,s),r=Lo(e.gg,t._a[Mt],u.year),n=Lo(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>jn(r,o,s)?se(t)._overflowWeeks=!0:l!=null?se(t)._overflowWeekday=!0:(a=qT(r,n,i,o,s),t._a[Mt]=a.year,t._dayOfYear=a.dayOfYear)}L.ISO_8601=function(){};L.RFC_2822=function(){};function ym(t){if(t._f===L.ISO_8601){QT(t);return}if(t._f===L.RFC_2822){JT(t);return}t._a=[],se(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=NT(t._f,t._locale).match(am)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(YP(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&se(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),jo[o]?(n?se(t).empty=!1:se(t).unusedTokens.push(o),GP(o,n,t)):t._strict&&!n&&se(t).unusedTokens.push(o);se(t).charsLeftOver=a-l,e.length>0&&se(t).unusedInput.push(e),t._a[ct]<=12&&se(t).bigHour===!0&&t._a[ct]>0&&(se(t).bigHour=void 0),se(t).parsedDateParts=t._a.slice(0),se(t).meridiem=t._meridiem,t._a[ct]=sH(t._locale,t._a[ct],t._meridiem),u=se(t).era,u!==null&&(t._a[Mt]=t._locale.erasConvertYear(u,t._a[Mt])),vm(t),wm(t)}function sH(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function aH(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){se(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=om({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],ym(e),im(e)&&(s=!0),o+=se(e).charsLeftOver,o+=se(e).unusedTokens.length*10,se(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));ci(t,r||e)}function lH(t){if(!t._d){var e=lm(t._i),r=e.day===void 0?e.date:e.day;t._a=HT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),vm(t)}}function uH(t){var e=new Ha(wm(eE(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function eE(t){var e=t._i,r=t._f;return t._locale=t._locale||qn(t._l),e===null||r===void 0&&e===""?Su({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Jr(e)?new Ha(wm(e)):(xa(e)?t._d=e:Qr(r)?aH(t):r?ym(t):cH(t),im(t)||(t._d=null),t))}function cH(t){var e=t._i;qt(e)?t._d=new Date(L.now()):xa(e)?t._d=new Date(e.valueOf()):typeof e=="string"?nH(t):Qr(e)?(t._a=HT(e.slice(0),function(r){return parseInt(r,10)}),vm(t)):qi(e)?lH(t):Un(e)?t._d=new Date(e):L.createFromInputFallback(t)}function tE(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(qi(t)&&nm(t)||Qr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,uH(o)}function Be(t,e,r,n){return tE(t,e,r,n,!1)}var hH=Lr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Be.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Su()}),dH=Lr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Be.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Su()});function rE(t,e){var r,n;if(e.length===1&&Qr(e[0])&&(e=e[0]),!e.length)return Be();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function fH(){var t=[].slice.call(arguments,0);return rE("isBefore",t)}function gH(){var t=[].slice.call(arguments,0);return rE("isAfter",t)}var mH=function(){return Date.now?Date.now():+new Date},Rs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function pH(t){var e,r=!1,n,i=Rs.length;for(e in t)if(Re(t,e)&&!(Qe.call(Rs,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Rs[n]]){if(r)return!1;parseFloat(t[Rs[n]])!==pe(t[Rs[n]])&&(r=!0)}return!0}function wH(){return this._isValid}function vH(){return tn(NaN)}function Pu(t){var e=lm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=pH(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=qn(),this._bubble()}function Fl(t){return t instanceof Pu}function sg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function yH(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)pe(t[s])!==pe(e[s])&&o++;return o+i}function nE(t,e){X(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+vn(~~(r/60),2)+e+vn(~~r%60,2)})}nE("Z",":");nE("ZZ","");W("Z",Ou);W("ZZ",Ou);xe(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=bm(Ou,t)});var bH=/([\+\-]|\d\d)/gi;function bm(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(bH)||["-",0,0],o=+(i[1]*60)+pe(i[2]),o===0?0:i[0]==="+"?o:-o)}function Cm(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Jr(t)||xa(t)?t.valueOf():Be(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),L.updateOffset(r,!1),r):Be(t).local()}function ag(t){return-Math.round(t._d.getTimezoneOffset())}L.updateOffset=function(){};function CH(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=bm(Ou,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=ag(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?sE(this,tn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,L.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:ag(this)}function SH(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function RH(t){return this.utcOffset(0,t)}function TH(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(ag(this),"m")),this}function EH(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=bm(zP,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function _H(t){return this.isValid()?(t=t?Be(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function OH(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function MH(){if(!qt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return om(t,this),t=eE(t),t._a?(e=t._isUTC?Sn(t._a):Be(t._a),this._isDSTShifted=this.isValid()&&yH(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function IH(){return this.isValid()?!this._isUTC:!1}function PH(){return this.isValid()?this._isUTC:!1}function iE(){return this.isValid()?this._isUTC&&this._offset===0:!1}var xH=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,HH=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function tn(t,e){var r=t,n=null,i,o,s;return Fl(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Un(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=xH.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:pe(n[gn])*i,h:pe(n[ct])*i,m:pe(n[Xr])*i,s:pe(n[Bn])*i,ms:pe(sg(n[zi]*1e3))*i}):(n=HH.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ei(n[2],i),M:Ei(n[3],i),w:Ei(n[4],i),d:Ei(n[5],i),h:Ei(n[6],i),m:Ei(n[7],i),s:Ei(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=AH(Be(r.from),Be(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Pu(r),Fl(t)&&Re(t,"_locale")&&(o._locale=t._locale),Fl(t)&&Re(t,"_isValid")&&(o._isValid=t._isValid),o}tn.fn=Pu.prototype;tn.invalid=vH;function Ei(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function Nb(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function AH(t,e){var r;return t.isValid()&&e.isValid()?(e=Cm(e,t),t.isBefore(e)?r=Nb(t,e):(r=Nb(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function oE(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(DT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=tn(r,n),sE(this,i,t),this}}function sE(t,e,r,n){var i=e._milliseconds,o=sg(e._days),s=sg(e._months);t.isValid()&&(n=n??!0,s&&zT(t,ga(t,"Month")+s*r),o&&BT(t,"Date",ga(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&L.updateOffset(t,o||s))}var DH=oE(1,"add"),NH=oE(-1,"subtract");function aE(t){return typeof t=="string"||t instanceof String}function kH(t){return Jr(t)||xa(t)||aE(t)||Un(t)||FH(t)||LH(t)||t===null||t===void 0}function LH(t){var e=qi(t)&&!nm(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Re(t,o);return e&&r}function FH(t){var e=Qr(t),r=!1;return e&&(r=t.filter(function(n){return!Un(n)&&aE(t)}).length===0),e&&r}function VH(t){var e=qi(t)&&!nm(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Re(t,o);return e&&r}function WH(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function BH(t,e){arguments.length===1&&(arguments[0]?kH(arguments[0])?(t=arguments[0],e=void 0):VH(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Be(),n=Cm(r,this).startOf("day"),i=L.calendarFormat(this,n)||"sameElse",o=e&&(Rn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Be(r)))}function $H(){return new Ha(this)}function jH(t,e){var r=Jr(t)?t:Be(t);return this.isValid()&&r.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function zH(t,e){var r=Jr(t)?t:Be(t);return this.isValid()&&r.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function UH(t,e,r,n){var i=Jr(t)?t:Be(t),o=Jr(e)?e:Be(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function YH(t,e){var r=Jr(t)?t:Be(t),n;return this.isValid()&&r.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function qH(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function GH(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function KH(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=Cm(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Fr(e),e){case"year":o=Vl(this,n)/12;break;case"month":o=Vl(this,n);break;case"quarter":o=Vl(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Ir(o)}function Vl(t,e){if(t.date()<e.date())return-Vl(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}L.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";L.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function XH(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ZH(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Ll(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Rn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ll(r,"Z")):Ll(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function QH(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function JH(t){t||(t=this.isUtc()?L.defaultFormatUtc:L.defaultFormat);var e=Ll(this,t);return this.localeData().postformat(e)}function e1(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Be(t).isValid())?tn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function t1(t){return this.from(Be(),t)}function r1(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Be(t).isValid())?tn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function n1(t){return this.to(Be(),t)}function lE(t){var e;return t===void 0?this._locale._abbr:(e=qn(t),e!=null&&(this._locale=e),this)}var uE=Lr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function cE(){return this._locale}var ru=1e3,zo=60*ru,nu=60*zo,hE=(365*400+97)*24*nu;function Uo(t,e){return(t%e+e)%e}function dE(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-hE:new Date(t,e,r).valueOf()}function fE(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-hE:Date.UTC(t,e,r)}function i1(t){var e,r;if(t=Fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?fE:dE,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Uo(e+(this._isUTC?0:this.utcOffset()*zo),nu);break;case"minute":e=this._d.valueOf(),e-=Uo(e,zo);break;case"second":e=this._d.valueOf(),e-=Uo(e,ru);break}return this._d.setTime(e),L.updateOffset(this,!0),this}function o1(t){var e,r;if(t=Fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?fE:dE,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=nu-Uo(e+(this._isUTC?0:this.utcOffset()*zo),nu)-1;break;case"minute":e=this._d.valueOf(),e+=zo-Uo(e,zo)-1;break;case"second":e=this._d.valueOf(),e+=ru-Uo(e,ru)-1;break}return this._d.setTime(e),L.updateOffset(this,!0),this}function s1(){return this._d.valueOf()-(this._offset||0)*6e4}function a1(){return Math.floor(this.valueOf()/1e3)}function l1(){return new Date(this.valueOf())}function u1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function c1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function h1(){return this.isValid()?this.toISOString():null}function d1(){return im(this)}function f1(){return ci({},se(this))}function g1(){return se(this).overflow}function m1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}X("N",0,0,"eraAbbr");X("NN",0,0,"eraAbbr");X("NNN",0,0,"eraAbbr");X("NNNN",0,0,"eraName");X("NNNNN",0,0,"eraNarrow");X("y",["y",1],"yo","eraYear");X("y",["yy",2],0,"eraYear");X("y",["yyy",3],0,"eraYear");X("y",["yyyy",4],0,"eraYear");W("N",Sm);W("NN",Sm);W("NNN",Sm);W("NNNN",_1);W("NNNNN",O1);xe(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?se(r).era=i:se(r).invalidEra=t});W("y",as);W("yy",as);W("yyy",as);W("yyyy",as);W("yo",M1);xe(["y","yy","yyy","yyyy"],Mt);xe(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Mt]=r._locale.eraYearOrdinalParse(t,i):e[Mt]=parseInt(t,10)});function p1(t,e){var r,n,i,o=this._eras||qn("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=L(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=L(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function w1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function v1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?L(t.since).year():L(t.since).year()+(e-t.offset)*r}function y1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function b1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function C1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function S1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-L(i[t].since).year())*r+i[t].offset;return this.year()}function R1(t){return Re(this,"_erasNameRegex")||Rm.call(this),t?this._erasNameRegex:this._erasRegex}function T1(t){return Re(this,"_erasAbbrRegex")||Rm.call(this),t?this._erasAbbrRegex:this._erasRegex}function E1(t){return Re(this,"_erasNarrowRegex")||Rm.call(this),t?this._erasNarrowRegex:this._erasRegex}function Sm(t,e){return e.erasAbbrRegex(t)}function _1(t,e){return e.erasNameRegex(t)}function O1(t,e){return e.erasNarrowRegex(t)}function M1(t,e){return e._eraYearOrdinalRegex||as}function Rm(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=$n(u[i].name),a=$n(u[i].abbr),l=$n(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}X(0,["gg",2],0,function(){return this.weekYear()%100});X(0,["GG",2],0,function(){return this.isoWeekYear()%100});function xu(t,e){X(0,[t,t.length],0,e)}xu("gggg","weekYear");xu("ggggg","weekYear");xu("GGGG","isoWeekYear");xu("GGGGG","isoWeekYear");W("G",_u);W("g",_u);W("GG",$e,wr);W("gg",$e,wr);W("GGGG",cm,um);W("gggg",cm,um);W("GGGGG",Eu,Ru);W("ggggg",Eu,Ru);Da(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=pe(t)});Da(["gg","GG"],function(t,e,r,n){e[n]=L.parseTwoDigitYear(t)});function I1(t){return gE.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function P1(t){return gE.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function x1(){return jn(this.year(),1,4)}function H1(){return jn(this.isoWeekYear(),1,4)}function A1(){var t=this.localeData()._week;return jn(this.year(),t.dow,t.doy)}function D1(){var t=this.localeData()._week;return jn(this.weekYear(),t.dow,t.doy)}function gE(t,e,r,n,i){var o;return t==null?pa(this,n,i).year:(o=jn(t,n,i),e>o&&(e=o),N1.call(this,t,e,r,n,i))}function N1(t,e,r,n,i){var o=qT(t,e,r,n,i),s=ma(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}X("Q",0,"Qo","quarter");W("Q",kT);xe("Q",function(t,e){e[Wn]=(pe(t)-1)*3});function k1(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}X("D",["DD",2],"Do","date");W("D",$e,ls);W("DD",$e,wr);W("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});xe(["D","DD"],gn);xe("Do",function(t,e){e[gn]=pe(t.match($e)[0])});var mE=us("Date",!0);X("DDD",["DDDD",3],"DDDo","dayOfYear");W("DDD",Tu);W("DDDD",LT);xe(["DDD","DDDD"],function(t,e,r){r._dayOfYear=pe(t)});function L1(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}X("m",["mm",2],0,"minute");W("m",$e,hm);W("mm",$e,wr);xe(["m","mm"],Xr);var F1=us("Minutes",!1);X("s",["ss",2],0,"second");W("s",$e,hm);W("ss",$e,wr);xe(["s","ss"],Bn);var V1=us("Seconds",!1);X("S",0,0,function(){return~~(this.millisecond()/100)});X(0,["SS",2],0,function(){return~~(this.millisecond()/10)});X(0,["SSS",3],0,"millisecond");X(0,["SSSS",4],0,function(){return this.millisecond()*10});X(0,["SSSSS",5],0,function(){return this.millisecond()*100});X(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});X(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});X(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});X(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});W("S",Tu,kT);W("SS",Tu,wr);W("SSS",Tu,LT);var hi,pE;for(hi="SSSS";hi.length<=9;hi+="S")W(hi,as);function W1(t,e){e[zi]=pe(("0."+t)*1e3)}for(hi="S";hi.length<=9;hi+="S")xe(hi,W1);pE=us("Milliseconds",!1);X("z",0,0,"zoneAbbr");X("zz",0,0,"zoneName");function B1(){return this._isUTC?"UTC":""}function $1(){return this._isUTC?"Coordinated Universal Time":""}var D=Ha.prototype;D.add=DH;D.calendar=BH;D.clone=$H;D.diff=KH;D.endOf=o1;D.format=JH;D.from=e1;D.fromNow=t1;D.to=r1;D.toNow=n1;D.get=QP;D.invalidAt=g1;D.isAfter=jH;D.isBefore=zH;D.isBetween=UH;D.isSame=YH;D.isSameOrAfter=qH;D.isSameOrBefore=GH;D.isValid=d1;D.lang=uE;D.locale=lE;D.localeData=cE;D.max=dH;D.min=hH;D.parsingFlags=f1;D.set=JP;D.startOf=i1;D.subtract=NH;D.toArray=u1;D.toObject=c1;D.toDate=l1;D.toISOString=ZH;D.inspect=QH;typeof Symbol<"u"&&Symbol.for!=null&&(D[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});D.toJSON=h1;D.toString=XH;D.unix=a1;D.valueOf=s1;D.creationData=m1;D.eraName=y1;D.eraNarrow=b1;D.eraAbbr=C1;D.eraYear=S1;D.year=WT;D.isLeapYear=ZP;D.weekYear=I1;D.isoWeekYear=P1;D.quarter=D.quarters=k1;D.month=UT;D.daysInMonth=lx;D.week=D.weeks=px;D.isoWeek=D.isoWeeks=wx;D.weeksInYear=A1;D.weeksInWeekYear=D1;D.isoWeeksInYear=x1;D.isoWeeksInISOWeekYear=H1;D.date=mE;D.day=D.days=Px;D.weekday=xx;D.isoWeekday=Hx;D.dayOfYear=L1;D.hour=D.hours=Vx;D.minute=D.minutes=F1;D.second=D.seconds=V1;D.millisecond=D.milliseconds=pE;D.utcOffset=CH;D.utc=RH;D.local=TH;D.parseZone=EH;D.hasAlignedHourOffset=_H;D.isDST=OH;D.isLocal=IH;D.isUtcOffset=PH;D.isUtc=iE;D.isUTC=iE;D.zoneAbbr=B1;D.zoneName=$1;D.dates=Lr("dates accessor is deprecated. Use date instead.",mE);D.months=Lr("months accessor is deprecated. Use month instead",UT);D.years=Lr("years accessor is deprecated. Use year instead",WT);D.zone=Lr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",SH);D.isDSTShifted=Lr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",MH);function j1(t){return Be(t*1e3)}function z1(){return Be.apply(null,arguments).parseZone()}function wE(t){return t}var Te=sm.prototype;Te.calendar=IP;Te.longDateFormat=AP;Te.invalidDate=NP;Te.ordinal=FP;Te.preparse=wE;Te.postformat=wE;Te.relativeTime=WP;Te.pastFuture=BP;Te.set=OP;Te.eras=p1;Te.erasParse=w1;Te.erasConvertYear=v1;Te.erasAbbrRegex=T1;Te.erasNameRegex=R1;Te.erasNarrowRegex=E1;Te.months=ix;Te.monthsShort=ox;Te.monthsParse=ax;Te.monthsRegex=cx;Te.monthsShortRegex=ux;Te.week=dx;Te.firstDayOfYear=mx;Te.firstDayOfWeek=gx;Te.weekdays=Ex;Te.weekdaysMin=Ox;Te.weekdaysShort=_x;Te.weekdaysParse=Ix;Te.weekdaysRegex=Ax;Te.weekdaysShortRegex=Dx;Te.weekdaysMinRegex=Nx;Te.isPM=Lx;Te.meridiem=Wx;function iu(t,e,r,n){var i=qn(),o=Sn().set(n,e);return i[r](o,t)}function vE(t,e,r){if(Un(t)&&(e=t,t=void 0),t=t||"",e!=null)return iu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=iu(t,n,r,"month");return i}function Tm(t,e,r,n){typeof t=="boolean"?(Un(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Un(e)&&(r=e,e=void 0),e=e||"");var i=qn(),o=t?i._week.dow:0,s,a=[];if(r!=null)return iu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=iu(e,(s+o)%7,n,"day");return a}function U1(t,e){return vE(t,e,"months")}function Y1(t,e){return vE(t,e,"monthsShort")}function q1(t,e,r){return Tm(t,e,r,"weekdays")}function G1(t,e,r){return Tm(t,e,r,"weekdaysShort")}function K1(t,e,r){return Tm(t,e,r,"weekdaysMin")}gi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=pe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});L.lang=Lr("moment.lang is deprecated. Use moment.locale instead.",gi);L.langData=Lr("moment.langData is deprecated. Use moment.localeData instead.",qn);var Mn=Math.abs;function X1(){var t=this._data;return this._milliseconds=Mn(this._milliseconds),this._days=Mn(this._days),this._months=Mn(this._months),t.milliseconds=Mn(t.milliseconds),t.seconds=Mn(t.seconds),t.minutes=Mn(t.minutes),t.hours=Mn(t.hours),t.months=Mn(t.months),t.years=Mn(t.years),this}function yE(t,e,r,n){var i=tn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function Z1(t,e){return yE(this,t,e,1)}function Q1(t,e){return yE(this,t,e,-1)}function kb(t){return t<0?Math.floor(t):Math.ceil(t)}function J1(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=kb(lg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Ir(t/1e3),n.seconds=i%60,o=Ir(i/60),n.minutes=o%60,s=Ir(o/60),n.hours=s%24,e+=Ir(s/24),l=Ir(bE(e)),r+=l,e-=kb(lg(l)),a=Ir(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function bE(t){return t*4800/146097}function lg(t){return t*146097/4800}function eA(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Fr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+bE(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(lg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Gn(t){return function(){return this.as(t)}}var CE=Gn("ms"),tA=Gn("s"),rA=Gn("m"),nA=Gn("h"),iA=Gn("d"),oA=Gn("w"),sA=Gn("M"),aA=Gn("Q"),lA=Gn("y"),uA=CE;function cA(){return tn(this)}function hA(t){return t=Fr(t),this.isValid()?this[t+"s"]():NaN}function uo(t){return function(){return this.isValid()?this._data[t]:NaN}}var dA=uo("milliseconds"),fA=uo("seconds"),gA=uo("minutes"),mA=uo("hours"),pA=uo("days"),wA=uo("months"),vA=uo("years");function yA(){return Ir(this.days()/7)}var Ln=Math.round,Wo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function bA(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function CA(t,e,r,n){var i=tn(t).abs(),o=Ln(i.as("s")),s=Ln(i.as("m")),a=Ln(i.as("h")),l=Ln(i.as("d")),u=Ln(i.as("M")),c=Ln(i.as("w")),h=Ln(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,bA.apply(null,d)}function SA(t){return t===void 0?Ln:typeof t=="function"?(Ln=t,!0):!1}function RA(t,e){return Wo[t]===void 0?!1:e===void 0?Wo[t]:(Wo[t]=e,t==="s"&&(Wo.ss=e-1),!0)}function TA(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Wo,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Wo,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=CA(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var jd=Math.abs;function wo(t){return(t>0)-(t<0)||+t}function Hu(){if(!this.isValid())return this.localeData().invalidDate();var t=jd(this._milliseconds)/1e3,e=jd(this._days),r=jd(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Ir(t/60),i=Ir(n/60),t%=60,n%=60,o=Ir(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=wo(this._months)!==wo(a)?"-":"",c=wo(this._days)!==wo(a)?"-":"",h=wo(this._milliseconds)!==wo(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var ye=Pu.prototype;ye.isValid=wH;ye.abs=X1;ye.add=Z1;ye.subtract=Q1;ye.as=eA;ye.asMilliseconds=CE;ye.asSeconds=tA;ye.asMinutes=rA;ye.asHours=nA;ye.asDays=iA;ye.asWeeks=oA;ye.asMonths=sA;ye.asQuarters=aA;ye.asYears=lA;ye.valueOf=uA;ye._bubble=J1;ye.clone=cA;ye.get=hA;ye.milliseconds=dA;ye.seconds=fA;ye.minutes=gA;ye.hours=mA;ye.days=pA;ye.weeks=yA;ye.months=wA;ye.years=vA;ye.humanize=TA;ye.toISOString=Hu;ye.toString=Hu;ye.toJSON=Hu;ye.locale=lE;ye.localeData=cE;ye.toIsoString=Lr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Hu);ye.lang=uE;X("X",0,0,"unix");X("x",0,0,"valueOf");W("x",_u);W("X",UP);xe("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});xe("x",function(t,e,r){r._d=new Date(pe(t))});//! moment.js
L.version="2.30.1";EP(Be);L.fn=D;L.min=fH;L.max=gH;L.now=mH;L.utc=Sn;L.unix=j1;L.months=U1;L.isDate=xa;L.locale=gi;L.invalid=Su;L.duration=tn;L.isMoment=Jr;L.weekdays=q1;L.parseZone=z1;L.localeData=qn;L.isDuration=Fl;L.monthsShort=Y1;L.weekdaysMin=K1;L.defineLocale=pm;L.updateLocale=zx;L.locales=Ux;L.weekdaysShort=G1;L.normalizeUnits=Fr;L.relativeTimeRounding=SA;L.relativeTimeThreshold=RA;L.calendarFormat=WH;L.prototype=D;L.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function EA(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function Lb(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function zd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function co(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Em(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function yn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function F(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function Fb(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return F(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Vb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function er(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return co(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function Yo(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function me(t){return typeof t<"u"}function Nt(t){return typeof t>"u"}function Xi(t){return t===null||t===""||Nt(t)}function _A(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Qs="length",sa=t=>parseInt(t,16),Wb=t=>parseInt(t,10),ou=(t,e,r)=>t.substr(e,r),aa=t=>t.codePointAt(0)-65,ug=t=>`${t}`.replace(/\-/g,""),OA=t=>sa(ou(ug(t),sa("12"),aa("F")))/(sa(ou(ug(t),aa("B"),~~![][Qs]))||9),MA=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Bb=!1;const $b={invalid:()=>er`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return er`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>er`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},jb={invalid:()=>er`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return er`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>er`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function IA(t,e){const r=!Xi(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="15.3.0";let o,s="invalid",a="invalid";t=ug(t||"");const l=PA(t);if(r||n||l)if(l){const u=L("29/04/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=OA(t);o=L((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(MA()&&(s="valid",a="valid"),!Bb&&s!=="valid"&&($b[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"]($b[s]({keyValidityDate:o,hotVersion:i})),Bb=!0),a!=="valid"&&e.parentNode&&jb[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=jb[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function PA(t){let e=[][Qs],r=e;if(t[Qs]!==aa("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=aa(i.shift());o;o=aa(i.shift()||"A"))--o<""[Qs]?r=r|(Wb(`${Wb(sa(n)+(sa(ou(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=ou(t,o,o?i[Qs]===1?9:8:6);return r===e}function Au(t){return t[0].toUpperCase()+t.substr(1)}function SE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function xA(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function HA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function RE(t,e){return TP.sanitize(t,e)}const ho=t=>["tabindex",t],AA=()=>["role","treegrid"],di=()=>["role","presentation"],DA=()=>["role","gridcell"],NA=()=>["role","rowheader"],TE=()=>["role","rowgroup"],kA=()=>["role","columnheader"],cg=()=>["role","row"],LA=()=>["role","menu"],FA=()=>["role","menuitem"],VA=()=>["role","menuitemcheckbox"],WA=()=>["scope","col"],BA=()=>["scope","row"],hg=t=>["aria-label",t],$A=()=>["aria-hidden","true"],jA=()=>["aria-disabled","true"],zA=()=>["aria-multiselectable","true"],EE=t=>["aria-rowcount",t],Du=t=>["aria-colcount",t],_E=t=>["aria-rowindex",t],_m=t=>["aria-colindex",t],Wl=t=>["aria-expanded",t],zb=()=>["aria-readonly","true"],Ub=()=>["aria-invalid","true"],UA=t=>["aria-checked",t],OE=()=>["aria-selected","true"];function YA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Bl(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function qA(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function va(t){return qA(t)&&t.parent}function ME(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function qa(t,e,r){const n=[];let i=t;for(;i&&(i=ME(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function GA(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function qo(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function KA(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function _i(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function IE(t){return!t||!t.length?[]:t.filter(e=>!!e)}function PE(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function we(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function J(t,e){typeof e=="string"&&(e=e.split(" ")),e=IE(e),e.length>0&&t.classList.add(...e)}function Ne(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=PE(e,!0);r=IE(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Oe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Na(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=PE(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function xE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)xE(e[r])}}function Xo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const XA=/(<(.*)>|&(.*);)/;function HE(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;XA.test(e)?t.innerHTML=r?RE(e):e:ka(t,e)}function ka(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Xo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ya(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ya(n.host.impl);if(n.host)return ya(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function ZA(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Pr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function AE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Om(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Mm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?AE(e):t.scrollTop}function DE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Om(e):t.scrollLeft}function su(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function QA(t){return t.scrollHeight-t.clientHeight}function JA(t){return t.scrollWidth-t.clientWidth}function au(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function Yb(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Jt(t){return t.offsetWidth}function tr(t){return t.offsetHeight}function la(t){return t.clientHeight||t.innerHeight}function NE(t){return t.clientWidth||t.innerWidth}function eD(t){return t.selectionStart?t.selectionStart:0}function qb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function kE(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let Ud;function tD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function rr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ud===void 0&&(Ud=tD(t)),Ud}function rD(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function nD(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Im(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Nu(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function $l(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function LE(t){return $l(t)&&t.hasAttribute("data-hot-input")===!1}function iD(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function FE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Oe(t,"contenteditable",!0),r&&Oe(t,...$A()),e&&J(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function VE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Ne(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function oD(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;FE(t,r),e(),VE(t,r)}function Gi(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Pe(t){return typeof t=="function"}function WE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function sD(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function dg(t,e,r,n,i,o,s,a){return me(a)?t.call(e,r,n,i,o,s,a):me(s)?t.call(e,r,n,i,o,s):me(o)?t.call(e,r,n,i,o):me(i)?t.call(e,r,n,i):me(n)?t.call(e,r,n):me(r)?t.call(e,r):t.call(e)}var Gb={},Yd,Kb;function aD(){if(Kb)return Yd;Kb=1;var t=et(),e=uT(),r=st(),n=ro(),i=Cu(),o=t([].push);return Yd=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,p){if(d)return d=!1,p;if(e(this))return p;for(var y=0;y<h;y++)if(l[y]===g)return p}}},Yd}var Xb;function lD(){if(Xb)return Gb;Xb=1;var t=Le(),e=rs(),r=Ma(),n=mt(),i=et(),o=ot(),s=st(),a=Yg(),l=rm(),u=aD(),c=Ug(),h=String,d=e("JSON","stringify"),g=i(/./.exec),p=i("".charAt),y=i("".charCodeAt),b=i("".replace),E=i(1.1.toString),v=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var N=e("Symbol")("stringify detection");return d([N])!=="[null]"||d({a:N})!=="{}"||d(Object(N))!=="{}"}),I=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),H=function(N,j){var z=l(arguments),te=u(j);if(!(!s(te)&&(N===void 0||a(N))))return z[1]=function(ue,G){if(s(te)&&(G=n(te,this,h(ue),G)),!a(G))return G},r(d,null,z)},V=function(N,j,z){var te=p(z,j-1),ue=p(z,j+1);return g(T,N)&&!g(_,ue)||g(_,N)&&!g(T,te)?"\\u"+E(y(N,0),16):N};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||I},{stringify:function(j,z,te){var ue=l(arguments),G=r(M?H:d,null,ue);return I&&typeof G=="string"?b(G,v,V):G}}),Gb}lD();function ba(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Me(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=ba(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[ba(r[0])]:e[n]=[]:e[n]=null)})),e}function uD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function wi(t,e,r){const n=Array.isArray(r);return Me(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function BE(t,e){Me(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),BE(t[n],e[n])):t[n]=e[n]})}function gr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ke(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return F(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Me(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=p=>{let y=p;return(Array.isArray(y)||bt(y))&&(y=gr(y)),y};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function $E(t,e){return JSON.stringify(t)===JSON.stringify(e)}function bt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Kn(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Me(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function cD(t,e){const r=e.split(".");let n=t;return Me(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function qd(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(bn(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function Pm(t){if(!bt(t))return 0;const e=function(r){let n=0;return bt(r)?Me(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function bn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fg(t){return window.requestAnimationFrame(t)}function Zb(t){window.cancelAnimationFrame(t)}function hD(){return"ontouchstart"in window}function dD(){return typeof window<"u"}const Mr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Si={chrome:Mr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Mr(t=>/CriOS/.test(t)),edge:Mr(t=>/Edge/.test(t)),edgeWebKit:Mr(t=>/EdgiOS/.test(t)),firefox:Mr(t=>/Firefox/.test(t)),firefoxWebKit:Mr(t=>/FxiOS/.test(t)),mobile:Mr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Mr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},La={mac:Mr(t=>/^Mac/.test(t)),win:Mr(t=>/^Win/.test(t)),linux:Mr(t=>/^Linux/.test(t)),ios:Mr(t=>/iPhone|iPad|iPod/i.test(t))};function fD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(Si,r=>{let{test:n}=r;return void n(t,e)})}function gD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Me(La,e=>{let{test:r}=e;return void r(t)})}dD()&&(fD(),gD());function mD(){return Si.chrome.value}function pD(){return Si.chromeWebKit.value}function Gd(){return Si.firefox.value}function wD(){return Si.firefoxWebKit.value}function jE(){return Si.safari.value}function vD(){return Si.edge.value}function Ui(){return Si.mobile.value}function zE(){return La.ios.value}function UE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&La.mac.value}function Qb(){return La.win.value}function Jb(){return La.mac.value}const Z={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Gd()?182:174,AUDIO_MUTE:Gd()?181:173,AUDIO_UP:Gd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},yD=[Z.ALT,Z.ARROW_DOWN,Z.ARROW_LEFT,Z.ARROW_RIGHT,Z.ARROW_UP,Z.AUDIO_DOWN,Z.AUDIO_MUTE,Z.AUDIO_UP,Z.BACKSPACE,Z.CAPS_LOCK,Z.DELETE,Z.END,Z.ENTER,Z.ESCAPE,Z.F1,Z.F2,Z.F3,Z.F4,Z.F5,Z.F6,Z.F7,Z.F8,Z.F9,Z.F10,Z.F11,Z.F12,Z.F13,Z.F14,Z.F15,Z.F16,Z.F17,Z.F18,Z.F19,Z.HOME,Z.INSERT,Z.MEDIA_NEXT,Z.MEDIA_PLAY_PAUSE,Z.MEDIA_PREV,Z.MEDIA_STOP,Z.NULL,Z.NUM_LOCK,Z.PAGE_DOWN,Z.PAGE_UP,Z.PAUSE,Z.SCROLL_LOCK,Z.SHIFT,Z.TAB];function bD(t){return yD.includes(t)}function CD(t){return[Z.CONTROL,Z.COMMAND_LEFT,Z.COMMAND_RIGHT,Z.COMMAND_FIREFOX].includes(t)}function SD(t,e){const r=e.split("|");let n=!1;return F(r,i=>{if(t===Z[i])return n=!0,!1}),n}function ku(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Bi(t){return t.isImmediatePropagationEnabled===!1}function lu(t){return t.button===2}function YE(t){return t.button===0}function Yn(){me(console)&&console.warn(...arguments)}function RD(){me(console)&&console.error(...arguments)}const $i=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Kd=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Xd=new Map([[]]);var eC={},Zd,tC;function TD(){if(tC)return Zd;tC=1;var t=os();return Zd=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},Zd}var Qd,rC;function ED(){if(rC)return Qd;rC=1;var t=Je();return Qd=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},Qd}var Jd,nC;function xm(){if(nC)return Jd;nC=1;var t=en(),e=tm(),r=bi().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),Jd=function(o){i[n][o]=!0},Jd}var iC;function _D(){if(iC)return eC;iC=1;var t=Le(),e=et(),r=mr(),n=Ta(),i=TD(),o=ED(),s=xm(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),eC}_D();var oC={},sC={},aC;function OD(){if(aC)return sC;aC=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,p){if(c(g,d++))return p(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),sC}var lC;function MD(){return lC||(lC=1,OD()),oC}MD();function ID(t,e){qE(t,e),e.add(t)}function ef(t,e,r){qE(t,e),e.set(t,r)}function qE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uC(t,e,r){return t.set(uu(t,e),r),r}function vt(t,e){return t.get(uu(t,e))}function uu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PD=100;var ar=new WeakMap,Fo=new WeakMap,tf=new WeakMap,rf=new WeakSet;class cC{constructor(){ID(this,rf),ef(this,ar,new Map),ef(this,Fo,new Map),ef(this,tf,new Set),$i.forEach(e=>uu(rf,this,hC).call(this,e))}getHooks(e){var r;return(r=vt(ar,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};vt(ar,this).has(e)||(uu(rf,this,hC).call(this,e),$i.push(e));const i=vt(ar,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=vt(tf,this).has(e);!u&&o!==0&&(u=!0,vt(tf,this).add(e)),u&&i.length>1&&vt(ar,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return vt(ar,this).has(e)&&vt(ar,this).get(e).length>0}remove(e,r){if(!vt(ar,this).has(e))return!1;const n=vt(ar,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=vt(Fo,this).get(e);return i.skip=!0,o+=1,o>PD&&(vt(ar,this).set(e,n.filter(s=>!s.skip)),o=0),vt(Fo,this).set(e,o),!0}return!1}destroy(){vt(ar,this).clear(),vt(Fo,this).clear(),uC(ar,this,null),uC(Fo,this,null)}}function hC(t){vt(ar,this).set(t,[]),vt(Fo,this).set(t,0)}function xD(t,e,r){return(e=HD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HD(t){var e=AD(t,"string");return typeof e=="symbol"?e:e+""}function AD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DD=er`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ge{constructor(){xD(this,"globalBucket",new cC)}static getSingleton(){return kD()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new cC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?F(r,o=>this.add(e,o,n)):(Kd.has(e)&&Yn(HA(DD,{hookName:e,removedInVersion:Kd.get(e)})),Xd.has(e)&&Yn(Xd.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?F(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?F(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=dg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=dg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||$i.push(e)}deregister(e){this.isRegistered(e)&&$i.splice($i.indexOf(e),1)}isDeprecated(e){return Xd.has(e)||Kd.has(e)}isRegistered(e){return $i.indexOf(e)>=0}getRegistered(){return $i}}const ND=new ge;function kD(){return ND}const nf=new Map;function cs(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";nf.has(t)||nf.set(t,new Map);const e=nf.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s}}const gg=new WeakMap,{register:LD,getItem:GE,hasItem:KE}=cs("editors");function FD(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},ge.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function VD(t,e){let r;if(typeof t=="function")gg.get(t)||XE(null,t),r=gg.get(t);else if(typeof t=="string")r=GE(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function dC(t){if(typeof t=="function")return t;if(!KE(t))throw Error(`No registered editor found under "${t}" name`);return GE(t).getConstructor()}function XE(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new FD(e);typeof t=="string"&&LD(t,r),gg.set(e,r)}function WD(t,e,r){return(e=BD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BD(t){var e=$D(t,"string");return typeof e=="symbol"?e:e+""}function $D(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;WD(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,jD(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function jD(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ku(this)},t}function zD(t,e){UD(t,e),e.add(t)}function UD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oi(t,e,r){return(e=YD(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YD(t){var e=qD(t,"string");return typeof e=="symbol"?e:e+""}function qD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function of(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ga=new WeakSet;class mg{constructor(e,r,n){zD(this,Ga),Oi(this,"hot",void 0),Oi(this,"tableMeta",void 0),Oi(this,"selection",void 0),Oi(this,"eventManager",void 0),Oi(this,"destroyed",!1),Oi(this,"activeEditor",void 0),Oi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new vi(e),this.hot.addHook("afterDocumentKeyDown",i=>of(Ga,this,fC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>of(Ga,this,fC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>of(Ga,this,GD).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=VD(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function fC(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Bi(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!bD(r)&&!CD(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function GD(t,e){e.isCell()&&this.openEditor(null,t,!0)}const gC=new WeakMap;mg.getInstance=function(t,e,r){let n=gC.get(t);return n||(n=new mg(t,e,r),gC.set(t,n)),n};function KD(t,e){ZE(t,e),e.add(t)}function Ts(t,e,r){ZE(t,e),e.set(t,r)}function ZE(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ae(t,e){return t.get(Fn(t,e))}function Es(t,e,r){return t.set(Fn(t,e),r),r}function Fn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Go=Object.freeze({CELL:"cell",MIXED:"mixed"});var nt=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,Za=new WeakMap,Qa=new WeakMap,li=new WeakSet;class XD{constructor(e){var r=this;KD(this,li),Ts(this,nt,void 0),Ts(this,Ka,void 0),Ts(this,Xa,1),Ts(this,Za,null),Ts(this,Qa,new Map);const n=e.getSettings();Es(nt,this,e),Es(Ka,this,n.imeFastEdit?Go.MIXED:Go.CELL),Ae(nt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,QD).call(r,...o)}),Ae(nt,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,mC).call(r,...o)}),Ae(nt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,mC).call(r,...o)}),Ae(nt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Fn(li,r,ZD).call(r,...o)})}getFocusMode(){return Ae(Ka,this)}setFocusMode(e){Object.values(Go).includes(e)?Es(Ka,this,e):Yn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ae(Xa,this)}setRefocusDelay(e){Es(Xa,this,e)}setRefocusElementGetter(e){Es(Za,this,e)}getRefocusElement(){var e;return typeof Ae(Za,this)=="function"?Ae(Za,this).call(this):(e=Ae(nt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Ae(nt,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ae(nt,this).runHooks("modifyFocusedElement",s.row,s.col,n);Gi(a)||(a=n),a&&!((o=Ae(nt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Fn(li,this,Hm).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ae(Xa,this);if(Ae(nt,this).getSettings().imeFastEdit&&!((e=Ae(nt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Ae(nt,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Ae(Qa,this).has(r)||Ae(Qa,this).set(r,WE(()=>{if(!Ae(nt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Ae(Qa,this).get(r)()}}}function Hm(t){var e;const r=(e=Ae(nt,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!Ae(nt,this).selection.isCellVisible(r)){t(null);return}const n=Ae(nt,this).getCell(r.row,r.col,!0);n===null?Ae(nt,this).addHookOnce("afterScroll",()=>{t(Ae(nt,this).getCell(r.row,r.col,!0))}):t(n)}function mC(){Fn(li,this,Hm).call(this,t=>{const{activeElement:e}=Ae(nt,this).rootDocument;e&&LE(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function ZD(){Fn(li,this,Hm).call(this,t=>{this.getFocusMode()===Go.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function QD(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Go.MIXED:Go.CELL)}var pC={},sf,wC;function JD(){if(wC)return sf;wC=1;var t=Nr(),e=ro(),r=en(),n=r("match");return sf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},sf}var af,vC;function eN(){if(vC)return af;vC=1;var t=Je(),e=ot(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return af={correct:n},af}var lf,yC;function tN(){if(yC)return lf;yC=1;var t=pt();return lf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},lf}var uf,bC;function rN(){if(bC)return uf;bC=1;var t=mt(),e=kr(),r=Ea(),n=eN(),i=tN(),o=RegExp.prototype;return uf=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},uf}var cf,CC;function nN(){if(CC)return cf;CC=1;var t=et(),e=ns(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return cf=function(l,u,c,h,d,g){var p=c+l.length,y=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(E,v){var T;switch(n(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,p);case"<":T=d[o(v,1,-1)];break;default:var _=+v;if(_===0)return E;if(_>y){var M=r(_/10);return M===0?E:M<=y?h[M-1]===void 0?n(v,1):h[M-1]+n(v,1):E}T=h[_-1]}return T===void 0?"":T})},cf}var SC;function iN(){if(SC)return pC;SC=1;var t=Le(),e=mt(),r=et(),n=Ra(),i=st(),o=Nr(),s=JD(),a=Cu(),l=_a(),u=rN(),c=nN(),h=en(),d=no(),g=h("replace"),p=TypeError,y=r("".indexOf),b=r("".replace),E=r("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(_,M){var I=n(this),H,V,N,j,z,te,ue,G,Q,at,ae=0,be="";if(o(_)){if(H=s(_),H&&(V=a(n(u(_))),!~y(V,"g")))throw new p("`.replaceAll` does not allow non-global regexes");if(N=l(_,g),N)return e(N,_,I,M);if(d&&H)return b(a(I),_,M)}for(j=a(I),z=a(_),te=i(M),te||(M=a(M)),ue=z.length,G=v(1,ue),Q=y(j,z);Q!==-1;)at=te?a(M(z,Q,j)):c(z,j,Q,[],void 0,M),be+=E(j,ae,Q)+at,ae=Q+ue,Q=Q+G>j.length?-1:y(j,z,Q+G);return ae<j.length&&(be+=E(j,ae)),be}}),pC}iN();var RC={},TC={},EC;function oN(){if(EC)return TC;EC=1;var t=Le(),e=ss(),r=mr(),n=pt(),i=Ci(),o=pr(),s=lo(),a=Ma(),l=ot(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(v){o(this,"throw",v)}var p=arguments.length<2,y=p?void 0:arguments[1];if(h)return a(h,this,p?[g]:[g,y]);var b=i(this),E=0;if(e(b,function(v){p?(p=!1,y=v):y=g(y,v,E),E++},{IS_RECORD:!0}),p)throw new u("Reduce of empty iterator with no initial value");return y}}),TC}var _C;function sN(){return _C||(_C=1,oN()),RC}sN();const QE={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},aN=new RegExp(Object.keys(QE).map(t=>`(${t})`).join("|"),"gi");function lN(t){return(t&&t.nodeName||"")==="TABLE"}function OC(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,p=[];for(let b=0;b<s;b+=1){const E=!g&&r&&b===0;let v="";if(g)v=`<th>${t.getColHeader(b-c)}</th>`;else if(E)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][b],{hidden:_,rowspan:M,colspan:I}=t.getCellMeta(d-h,b-c);if(!_){const H=[];if(M&&H.push(`rowspan="${M}"`),I&&H.push(`colspan="${I}"`),Xi(T))v=`<td ${H.join(" ")}></td>`;else{const V=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${H.join(" ")}>${V}</td>`}}}p.push(v)}const y=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function MC(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Xi(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function uN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const M=_.match(/<td\b[^>]*?>/g)[0],I=/<p.*?>/g,H=_.substring(M.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(I,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${H}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!lN(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,_)=>T+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,p=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(_=>{const M=_.querySelector("td")!==null;return M&&h.push(_),!M});g=T.length,d=g>0,g>1?r.nestedHeaders=Array.from(T).reduce((_,M)=>{const I=Array.from(M.cells).reduce((H,V,N)=>{if(a&&N===0)return H;const{colSpan:j,innerHTML:z}=V,te=j>1?{label:z,colspan:j}:z;return H.push(te),H},[]);return _.push(I),_},[]):d&&(r.colHeaders=Array.from(T[0].children).reduce((_,M,I)=>(a&&I===0||_.push(M.innerHTML),_),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce((T,_)=>(T.push(...Array.from(_.rows)),T),[]),...c];p=y.length;const b=new Array(p);for(let T=0;T<p;T++)b[T]=new Array(u);const E=[],v=[];for(let T=0;T<p;T++){const _=y[T],M=Array.from(_.cells),I=M.length;for(let H=0;H<I;H++){const V=M[H],{nodeName:N,innerHTML:j,rowSpan:z,colSpan:te}=V,ue=b[T].findIndex(G=>G===void 0);if(N==="TD"){if(z>1||te>1){for(let ae=T;ae<T+z;ae++)if(ae<p)for(let be=ue;be<ue+te;be++)b[ae][be]=null;const Q=V.getAttribute("style");Q&&Q.includes("mso-ignore:colspan")||E.push({col:ue,row:T,rowspan:z,colspan:te})}let G="";s&&/excel/gi.test(s.content)?G=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):G=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[T][ue]=G.replace(aN,Q=>QE[Q])}else v.push(j)}}return E.length&&(r.mergeCells=E),v.length&&(r.rowHeaders=v),b.length&&(r.data=b),r}function JE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function cN(t){return JE(t,[","])}function qe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function IC(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function hN(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function He(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const pg="asc",dN="desc",PC=new Map([[pg,[-1,1]],[dN,[1,-1]]]),fN=t=>`The priority '${t}' is already declared in a map.`,gN=t=>`The priority '${t}' is not a number.`;function mN(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Pe(t)?t:fN,e=Pe(e)?e:gN;function n(o,s){if(!JE(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pg;const[s,a]=PC.get(o)||PC.get(pg);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const pN=t=>`The id '${t}' is already declared in a map.`;function Lu(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Pe(t)?t:pN;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const wN=t=>`'${t}' value is already declared in a unique set.`;function vN(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Pe(t)?t:wN;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const Am=t=>`There is already registered "${t}" plugin.`,yN=t=>`There is already registered plugin on priority "${t}".`,bN=t=>`The priority "${t}" is not a number.`,e_=mN({errorPriorityExists:yN,errorPriorityNaN:bN}),t_=vN({errorItemExists:Am}),wg=Lu({errorIdExists:Am});function r_(){return[...e_.getItems(),...t_.getItems()]}function Dm(t){const e=Au(t);return wg.getItem(e)}function CN(t){return!!Dm(t)}function Ja(t,e,r){[t,e,r]=RN(t,e,r),Dm(t)===void 0&&SN(t,e,r)}function SN(t,e,r){const n=Au(t);if(wg.hasItem(n))throw new Error(Am(n));r===void 0?t_.addItem(n):e_.addItem(r,n),wg.addItem(n,e)}function RN(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:TN,getItem:EN,hasItem:n_}=cs("renderers");function xC(t){if(typeof t=="function")return t;if(!n_(t))throw Error(`No registered renderer found under "${t}" name`);return EN(t)}function _N(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),TN(t,e)}const{register:ON,getItem:MN,hasItem:i_}=cs("validators");function IN(t){if(typeof t=="function")return t;if(!i_(t))throw Error(`No registered validator found under "${t}" name`);return MN(t)}function PN(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),ON(t,e)}var HC={},AC;function xN(){if(AC)return HC;AC=1;var t=Le(),e=ns(),r=os(),n=Oa(),i=xm();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),HC}xN();var DC={},NC;function HN(){if(NC)return DC;NC=1;var t=Le(),e=et(),r=Ra(),n=Oa(),i=Cu(),o=ot(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),DC}HN();function _s(t,e,r){return(e=AN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AN(t){var e=DN(t,"string");return typeof e=="symbol"?e:e+""}function DN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NN{constructor(){_s(this,"count",0),_s(this,"startColumn",null),_s(this,"endColumn",null),_s(this,"startPosition",null),_s(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=i&&(this.startColumn-=1),p>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Os(t,e,r){return(e=kN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kN(t){var e=LN(t,"string");return typeof e=="symbol"?e:e+""}function LN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FN{constructor(){Os(this,"count",0),Os(this,"startRow",null),Os(this,"endRow",null),Os(this,"startPosition",null),Os(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ms(t,e,r){return(e=VN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VN(t){var e=WN(t,"string");return typeof e=="symbol"?e:e+""}function WN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o_{constructor(){Ms(this,"count",0),Ms(this,"startColumn",null),Ms(this,"endColumn",null),Ms(this,"startPosition",null),Ms(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Is(t,e,r){return(e=BN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BN(t){var e=$N(t,"string");return typeof e=="symbol"?e:e+""}function $N(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s_{constructor(){Is(this,"count",0),Is(this,"startRow",null),Is(this,"endRow",null),Is(this,"startPosition",null),Is(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ps(t,e,r){return(e=jN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jN(t){var e=zN(t,"string");return typeof e=="symbol"?e:e+""}function zN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UN{constructor(){Ps(this,"count",0),Ps(this,"startColumn",0),Ps(this,"endColumn",0),Ps(this,"startPosition",0),Ps(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function xs(t,e,r){return(e=YN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YN(t){var e=qN(t,"string");return typeof e=="symbol"?e:e+""}function qN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GN{constructor(){xs(this,"count",0),xs(this,"startRow",0),xs(this,"endRow",0),xs(this,"startPosition",0),xs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function kC(t,e,r){return(e=KN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KN(t){var e=XN(t,"string");return typeof e=="symbol"?e:e+""}function XN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZN extends o_{constructor(){super(...arguments),kC(this,"columnStartOffset",0),kC(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function LC(t,e,r){return(e=QN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QN(t){var e=JN(t,"string");return typeof e=="symbol"?e:e+""}function JN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ek extends s_{constructor(){super(...arguments),LC(this,"rowStartOffset",0),LC(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function FC(t,e,r){return(e=tk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tk(t){var e=rk(t,"string");return typeof e=="symbol"?e:e+""}function rk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a_{constructor(e){FC(this,"calculationTypes",[]),FC(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Wr(t,e,r){return(e=nk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nk(t){var e=ik(t,"string");return typeof e=="symbol"?e:e+""}function ik(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nm=50;class ok extends a_{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Wr(this,"viewportWidth",0),Wr(this,"scrollOffset",0),Wr(this,"zeroBasedScrollOffset",0),Wr(this,"totalColumns",0),Wr(this,"columnWidthFn",null),Wr(this,"columnWidth",0),Wr(this,"overrideFn",null),Wr(this,"inlineStartOffset",0),Wr(this,"totalCalculatedWidth",0),Wr(this,"startPositions",[]),Wr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Nm:r}}function Sr(t,e,r){return(e=sk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sk(t){var e=ak(t,"string");return typeof e=="symbol"?e:e+""}function ak(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lk extends a_{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Sr(this,"viewportHeight",0),Sr(this,"scrollOffset",0),Sr(this,"zeroBasedScrollOffset",0),Sr(this,"totalRows",0),Sr(this,"rowHeightFn",null),Sr(this,"rowHeight",0),Sr(this,"overrideFn",null),Sr(this,"horizontalScrollbarHeight",0),Sr(this,"innerViewportHeight",0),Sr(this,"totalCalculatedHeight",0),Sr(this,"startPositions",[]),Sr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function uk(t,e,r){ck(t,e),e.set(t,r)}function ck(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VC(t,e,r){return(e=hk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hk(t){var e=dk(t,"string");return typeof e=="symbol"?e:e+""}function dk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vo(t,e){return t.get(l_(t,e))}function WC(t,e,r){return t.set(l_(t,e),r),r}function l_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var In=new WeakMap;class Zi{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;VC(this,"row",null),VC(this,"col",null),uk(this,In,!1),WC(In,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return vo(In,this)}isSouthEastOf(e){return this.row>=e.row&&(vo(In,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(vo(In,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(vo(In,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(vo(In,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Zi&&WC(In,this,e.isRtl()),this}clone(){return new Zi(this.row,this.col,vo(In,this))}toObject(){return{row:this.row,col:this.col}}}function fk(t,e,r){gk(t,e),e.set(t,r)}function gk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hf(t,e,r){return(e=mk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mk(t){var e=pk(t,"string");return typeof e=="symbol"?e:e+""}function pk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rr(t,e){return t.get(u_(t,e))}function wk(t,e,r){return t.set(u_(t,e),r),r}function u_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $t=new WeakMap;class Fa{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;hf(this,"highlight",null),hf(this,"from",null),hf(this,"to",null),fk(this,$t,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),wk($t,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Rr($t,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Rr($t,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Rr($t,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Rr($t,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Rr($t,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Rr($t,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Rr($t,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Rr($t,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Zi))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Rr($t,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Rr($t,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new Fa(this.highlight,this.from,this.to,Rr($t,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Zi(e,r,Rr($t,this))}}function on(t,e,r){vk(t,e),e.set(t,r)}function vk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U(t,e){return t.get(c_(t,e))}function ei(t,e,r){return t.set(c_(t,e),r),r}function c_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tr=new WeakMap,df=new WeakMap,ft=new WeakMap,yo=new WeakMap,el=new WeakMap,Br=new WeakMap,ff=new WeakMap,Hs=new WeakMap,Mi=new WeakMap,sn=new WeakMap;let h_=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;on(this,Tr,void 0),on(this,df,void 0),on(this,ft,void 0),on(this,yo,void 0),on(this,el,void 0),on(this,Br,void 0),on(this,ff,void 0),on(this,Hs,void 0),on(this,Mi,[null,null]),on(this,sn,[null,null]),ei(Tr,this,n),ei(df,this,r),ei(ft,this,o),ei(yo,this,s),ei(el,this,a),ei(Br,this,i),ei(ff,this,e),this.registerEvents()}registerEvents(){U(Br,this).addEventListener(U(ft,this).holder,"contextmenu",n=>this.onContextMenu(n)),U(Br,this).addEventListener(U(ft,this).TABLE,"mouseover",n=>this.onMouseOver(n)),U(Br,this).addEventListener(U(ft,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{U(Br,this).addEventListener(U(ft,this).holder,"touchstart",n=>this.onTouchStart(n)),U(Br,this).addEventListener(U(ft,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),U(Br,this).addEventListener(U(ft,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||U(Tr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,U(Tr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{U(Br,this).addEventListener(U(ft,this).holder,"mouseup",n=>this.onMouseUp(n)),U(Br,this).addEventListener(U(ft,this).holder,"mousedown",n=>this.onMouseDown(n))};Ui()?e():(hD()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(U(Hs,this)&&n){const[i,o]=[n.row,U(Hs,this).from.row],[s,a]=[n.col,U(Hs,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=U(ft,this).TABLE,i=qa(e,["TD","TH"],n);return i?(r.coords=U(ft,this).getCoords(i),r.TD=i):we(e,"wtBorder")&&we(e,"current")?(r.coords=U(yo,this).getFocusSelection().cellRange.highlight,r.TD=U(ft,this).getCell(r.coords)):we(e,"wtBorder")&&we(e,"area")&&U(yo,this).getAreaSelection().cellRange&&(r.coords=U(yo,this).getAreaSelection().cellRange.to,r.TD=U(ft,this).getCell(r.coords)),r}onMouseDown(e){const r=U(df,this).rootDocument.activeElement,n=sD(YA,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);we(i,"corner")?U(Tr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&U(Tr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(U(sn,this)[0]=o.TD,clearTimeout(U(Mi,this)[0]),U(Mi,this)[0]=setTimeout(()=>{U(sn,this)[0]=null},1e3))}onContextMenu(e){if(U(Tr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!U(Tr,this).has("onCellMouseOver"))return;const r=U(ft,this).TABLE,n=qa(e.target,["TD","TH"],r),i=U(el,this)||this;n&&n!==i.lastMouseOver&&qo(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,U(ft,this).getCoords(n),n))}onMouseOut(e){if(!U(Tr,this).has("onCellMouseOut"))return;const r=U(ft,this).TABLE,n=qa(e.target,["TD","TH"],r),i=qa(e.relatedTarget,["TD","TH"],r),o=U(el,this)||this;n&&n!==i&&qo(n,r)&&(this.callListener("onCellMouseOut",e,U(ft,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&U(Tr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===U(sn,this)[0]&&r.TD===U(sn,this)[1]?(we(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),U(sn,this)[0]=null,U(sn,this)[1]=null):r.TD===U(sn,this)[0]&&(U(sn,this)[1]=r.TD,clearTimeout(U(Mi,this)[1]),U(Mi,this)[1]=setTimeout(()=>{U(sn,this)[1]=null},500)))}onTouchStart(e){ei(Hs,this,U(yo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=me(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&U(Tr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];zE()&&(pD()||wD())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=U(Tr,this).getSettingPure(e);o&&o(r,n,i,U(ff,this).call(this))}destroy(){clearTimeout(U(Mi,this)[0]),clearTimeout(U(Mi,this)[1]),U(Br,this).destroy()}};function gf(t,e,r){return(e=yk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yk(t){var e=bk(t,"string");return typeof e=="symbol"?e:e+""}function bk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ck{constructor(e,r,n){gf(this,"offset",void 0),gf(this,"total",void 0),gf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function mf(t,e,r){return(e=Sk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sk(t){var e=Rk(t,"string");return typeof e=="symbol"?e:e+""}function Rk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tk{constructor(e,r,n){mf(this,"offset",void 0),mf(this,"total",void 0),mf(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function tl(t,e,r){return(e=Ek(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ek(t){var e=_k(t,"string");return typeof e=="symbol"?e:e+""}function _k(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ok{constructor(){tl(this,"currentSize",0),tl(this,"nextSize",0),tl(this,"currentOffset",0),tl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Mk=0,BC=1,vg=2;function pf(t,e,r){return(e=Ik(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ik(t){var e=Pk(t,"string");return typeof e=="symbol"?e:e+""}function Pk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xk{constructor(){pf(this,"size",new Ok),pf(this,"workingSpace",Mk),pf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=BC,e.workingSpace=vg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=vg,e.workingSpace=BC,this.sharedSize=e.getViewSize()}}var $C={},wf,jC;function Hk(){if(jC)return wf;jC=1;var t=bu(),e=TypeError;return wf=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},wf}var zC;function Ak(){if(zC)return $C;zC=1;var t=Le(),e=ns(),r=os(),n=cT(),i=Hk(),o=hT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var p=d;p--;){var y=p+g;p in h?h[y]=h[p]:i(h,y)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),$C}Ak();function Dk(t,e,r){return(e=Nk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nk(t){var e=kk(t,"string");return typeof e=="symbol"?e:e+""}function kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UC{constructor(e,r){Dk(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Lk(t,e,r){return(e=Fk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fk(t){var e=Vk(t,"string");return typeof e=="symbol"?e:e+""}function Vk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wk{constructor(e){Lk(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new UC(o,r),l=new UC(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(vg)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function bo(t,e,r){return(e=Bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bk(t){var e=$k(t,"string");return typeof e=="symbol"?e:e+""}function $k(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d_{constructor(e,r){bo(this,"rootNode",void 0),bo(this,"nodesPool",void 0),bo(this,"sizeSet",new xk),bo(this,"collectedNodes",[]),bo(this,"viewDiffer",new Wk(this.sizeSet)),bo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class f_ extends d_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function YC(t,e,r){return(e=jk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jk(t){var e=zk(t,"string");return typeof e=="symbol"?e:e+""}function zk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uk{constructor(e){YC(this,"nodeType",void 0),YC(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function As(t,e,r){return(e=Yk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yk(t){var e=qk(t,"string");return typeof e=="symbol"?e:e+""}function qk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Va{constructor(e,r){As(this,"nodesPool",null),As(this,"nodeType",void 0),As(this,"rootNode",void 0),As(this,"table",null),As(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Uk(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function qC(t,e,r){return(e=Gk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gk(t){var e=Kk(t,"string");return typeof e=="symbol"?e:e+""}function Kk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xk extends Va{constructor(){super("TH"),qC(this,"orderViews",new WeakMap),qC(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new f_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Na(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Oe(d,[NA(),BA(),_m(h+1),ho(-1)]),r[h](a,d,h)}u.end()}}}class Zk extends Va{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Xo(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Oe(this.rootNode,[TE()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Oe(s,[cg(),_E(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Na(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Oe(u,[_m(a+1+this.table.rowHeadersCount),ho(-1),kA(),...a>=0?[WA()]:[cg()]]),n[r](l,u,r)}}}}let GC=!1;class Qk extends Va{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!GC&&e>1e3&&(GC=!0,Yn(er`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&J(n,"rowHeader")}}function Jk(t,e,r){return(e=eL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eL(t){var e=tL(t,"string");return typeof e=="symbol"?e:e+""}function tL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Co={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let KC=!1;class rL extends Va{constructor(e){super("TR",e),Jk(this,"orderView",void 0),this.orderView=new d_(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!KC&&e>1e3&&(KC=!0,Yn(er`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Oe(this.rootNode,[TE()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Oe(o,[cg(),_E(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?we(o,Co.rowEven)||(Ne(o,Co.rowOdd),J(o,Co.rowEven)):we(o,Co.rowOdd)||(Ne(o,Co.rowEven),J(o,Co.rowOdd))}this.orderView.end()}}function XC(t,e,r){return(e=nL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nL(t){var e=iL(t,"string");return typeof e=="symbol"?e:e+""}function iL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oL extends Va{constructor(){super("TD"),XC(this,"orderViews",new WeakMap),XC(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new f_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),p=c.getCurrentNode();if(we(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),Na(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,p),this.table.isAriaEnabled()){var o,s;Oe(p,[...p.hasAttribute("role")?[]:[DA()],ho(-1),_m(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function tt(t,e,r){return(e=sL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sL(t){var e=aL(t,"string");return typeof e=="symbol"?e:e+""}function aL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lL{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tt(this,"rootNode",void 0),tt(this,"rootDocument",void 0),tt(this,"rowHeaders",null),tt(this,"columnHeaders",null),tt(this,"colGroup",null),tt(this,"rows",null),tt(this,"cells",null),tt(this,"rowFilter",null),tt(this,"columnFilter",null),tt(this,"rowUtils",null),tt(this,"columnUtils",null),tt(this,"rowsToRender",0),tt(this,"columnsToRender",0),tt(this,"rowHeaderFunctions",[]),tt(this,"rowHeadersCount",0),tt(this,"columnHeaderFunctions",[]),tt(this,"columnHeadersCount",0),tt(this,"cellRenderer",void 0),tt(this,"activeOverlayName",void 0),tt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class uL{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new lL(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Xk,columnHeaders:new Zk(r),colGroup:new Qk(n),rows:new rL(i),cells:new oL}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function vf(t,e,r){return(e=cL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cL(t){var e=hL(t,"string");return typeof e=="symbol"?e:e+""}function hL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dL{constructor(e,r){vf(this,"dataAccessObject",void 0),vf(this,"wtSettings",void 0),vf(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function ZC(t,e,r){return(e=fL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fL(t){var e=gL(t,"string");return typeof e=="symbol"?e:e+""}function gL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mL{constructor(e,r){ZC(this,"dataAccessObject",void 0),ZC(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function an(t,e,r){return(e=pL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pL(t){var e=wL(t,"string");return typeof e=="symbol"?e:e+""}function wL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hs{constructor(e,r,n,i,o){an(this,"wtSettings",null),an(this,"domBindings",void 0),an(this,"TBODY",null),an(this,"THEAD",null),an(this,"COLGROUP",null),an(this,"hasTableHeight",!0),an(this,"hasTableWidth",!0),an(this,"isTableVisible",!1),an(this,"tableOffset",0),an(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,xE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new mL(this.dataAccessObject,this.wtSettings),this.columnUtils=new dL(this.dataAccessObject,this.wtSettings),this.tableRenderer=new uL({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Oe(n,[di()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Oe(n,[di()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!we(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",Oe(n,[ho(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Oe(n.parentNode,[di()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Oe(n,[di()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Pr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Pr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),p=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Tk(g,o,c),this.columnFilter=new Ck(p,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(mn)||this.is(mi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(mn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(mn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=la(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(mn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=ME(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=KA(n),s=r.cellIndex;_i(eo,r,this.wtRootElement)||_i(Qi,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):_i(mi,r,this.wtRootElement)||_i(mn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),_i(eo,r,this.wtRootElement)||_i(Ji,r,this.wtRootElement)||_i(mi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=la(this.TBODY)-1,i=this.wot.stylesHandler.areCellsBorderBox(),o=i?tr:la,s=i?0:1,a=i?1:0;let l,u,c,h,d;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),l=this.getRowHeight(c),h=this.getTrForRow(c),d=h.querySelector("th");const g=c===0?a:0;d?u=o(d):u=o(h)-s,(!l&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<u-g||l<u)&&(i||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Jt(this.TABLE)}getHeight(){return tr(this.TABLE)}getTotalWidth(){const e=Jt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=tr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ya(this.TABLE)}_modifyRowHeaderWidth(e){let r=Pe(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const vL="stickyRowsBottom",km={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Kn(km,"MIXIN_NAME",vL,{writable:!1,enumerable:!1});const yL="stickyColumnsStart",Fu={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Kn(Fu,"MIXIN_NAME",yL,{writable:!1,enumerable:!1});class Lm extends hs{constructor(e,r,n,i){super(e,r,n,i,mi)}}Ke(Lm,km);Ke(Lm,Fu);const Qi="top",mn="bottom",Ji="inline_start",eo="top_inline_start_corner",mi="bottom_inline_start_corner",g_=[Qi,mn,Ji,eo,mi],bL=new Map([[Qi,`ht_clone_${Qi}`],[mn,`ht_clone_${mn}`],[Ji,`ht_clone_${Ji} ht_clone_left`],[eo,`ht_clone_${eo} ht_clone_top_left_corner`],[mi,`ht_clone_${mi} ht_clone_bottom_left_corner`]]);function CL(t,e){SL(t,e),e.add(t)}function SL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function RL(t,e,r){return(e=TL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TL(t){var e=EL(t,"string");return typeof e=="symbol"?e:e+""}function EL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ds=new WeakSet;class _L{constructor(e){CL(this,Ds),RL(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=hr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=hr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return rl(Ds,this,JC).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return rl(Ds,this,JC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return rl(Ds,this,QC).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return rl(Ds,this,QC).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function QC(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Pr(n.wtRootElement).left;const u=Math.abs(DE(s,s));if(l>u){const c=NE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function JC(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Pr(r.wtRootElement),a=Mm(o,o);if(s.top>a){const l=la(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Er(t,e,r){return(e=OL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OL(t){var e=ML(t,"string");return typeof e=="symbol"?e:e+""}function ML(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fm{get eventManager(){return new vi(this)}constructor(e,r){Er(this,"wtTable",void 0),Er(this,"wtScroll",void 0),Er(this,"wtViewport",void 0),Er(this,"wtOverlays",void 0),Er(this,"selectionManager",void 0),Er(this,"wtEvent",void 0),Er(this,"guid",`wt_${SE()}`),Er(this,"drawInterrupted",!1),Er(this,"drawn",!1),Er(this,"activeOverlayName","master"),Er(this,"domBindings",void 0),Er(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new _L(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){ka(n,e[r])}])}}createCellCoords(e,r){return new Zi(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new Fa(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||ZA(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function eS(t,e,r){return(e=IL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IL(t){var e=PL(t,"string");return typeof e=="symbol"?e:e+""}function PL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xL extends Fm{constructor(e,r,n){super(e,r),eS(this,"cloneSource",void 0),eS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new h_(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function HL(t,e,r){return(e=AL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AL(t){var e=DL(t,"string");return typeof e=="symbol"?e:e+""}function DL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wa{constructor(e,r,n,i,o){HL(this,"wtSettings",null),Kn(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=au(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=au(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=su(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Yn(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+rr())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(g_.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${bL.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Oe(o,[di()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Qi||u==="vertical"&&this.type===Ji?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=su(e.TABLE),new xL(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class NL extends Wa{constructor(e,r,n,i,o,s){super(e,r,mi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Lm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Nu(r),this.repositionOverlay();let n=tr(this.clone.wtTable.TABLE);const i=Jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=rr(n)),i.style.bottom=`${o}px`}}const kL="calculatedColumns",Vu={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Kn(Vu,"MIXIN_NAME",kL,{writable:!1,enumerable:!1});class Vm extends hs{constructor(e,r,n,i){super(e,r,n,i,mn)}}Ke(Vm,km);Ke(Vm,Vu);function LL(t,e,r){return(e=FL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FL(t){var e=VL(t,"string");return typeof e=="symbol"?e:e+""}function VL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WL extends Wa{constructor(e,r,n,i){super(e,r,mn,n,i),LL(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Vm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=rr(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Om(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,stylesHandler:i}=this.wot,o=i.getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=rr(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=rr(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Mm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=we(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderBottom"),o=!a):(Ne(s,"innerBorderBottom"),o=a)}return o}}const BL="calculatedRows",Wm={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Kn(Wm,"MIXIN_NAME",BL,{writable:!1,enumerable:!1});class Bm extends hs{constructor(e,r,n,i){super(e,r,n,i,Ji)}}Ke(Bm,Wm);Ke(Bm,Fu);const $L="localHooks",Tn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)dg(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Kn(Tn,"MIXIN_NAME",$L,{writable:!1,enumerable:!1});let m_=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Ke(m_,Tn);const jL="active-header",p_="header",$m="area",ua="focus",zL="fill",UL="row",YL="column",qL="custom-selection",jm=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var tS={},rS;function GL(){if(rS)return tS;rS=1;var t=xm();return t("flat"),tS}GL();function KL(t,e){w_(t,e),e.add(t)}function nS(t,e,r){w_(t,e),e.set(t,r)}function w_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(ca(t,e))}function iS(t,e,r){return t.set(ca(t,e),r),r}function ca(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zr=new WeakMap,_t=new WeakMap,nl=new WeakSet;class XL{constructor(){KL(this,nl),nS(this,zr,void 0),nS(this,_t,void 0)}setActiveOverlay(e){return iS(_t,this,e),this}setActiveSelection(e){return iS(zr,this,e),this}scan(){const e=Ye(zr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ye(zr,this).getCorners(),{wtTable:s}=Ye(_t,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let p=s.getColumnHeader(h,g);const y=Ye(_t,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ye(zr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});y!==null&&(y!==h&&(p=s.getColumnHeader(y,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ye(zr,this).getCorners(),{wtTable:s}=Ye(_t,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let p=s.getRowHeader(h,g);const y=Ye(_t,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ye(zr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});y!==null&&(y!==h&&(p=s.getRowHeader(y,g)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ye(_t,this);ca(nl,this,ZL).call(this,(n,i)=>{const o=r.getCell(Ye(_t,this).createCellCoords(n,i)),s=Ye(_t,this).getSetting("onAfterDrawSelection",n,i,Ye(zr,this).settings.layerLevel);typeof s=="string"&&J(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ye(zr,this).getCorners(),{wtTable:i}=Ye(_t,this);ca(nl,this,oS).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ye(_t,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ye(zr,this).getCorners(),{wtTable:i}=Ye(_t,this);ca(nl,this,oS).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ye(_t,this).createCellCoords(o,s));e(a)}})}}function ZL(t){let[e,r,n,i]=Ye(zr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ye(_t,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ye(_t,this).createCellCoords(e,r));if(!Gi(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function oS(t){const{wtTable:e}=Ye(_t,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class sS{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=jm(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ku(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ui()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:r}=this.wot,n=r.getCSSVariableValue("cell-mobile-handle-size"),i=r.getCSSVariableValue("cell-mobile-handle-border-radius"),o=r.getCSSVariableValue("cell-mobile-handle-background-color"),s=r.getCSSVariableValue("cell-mobile-handle-border-width"),a=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const l=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const c={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Me(c,(d,g)=>{this.selectionHandles.styles.bottomHitArea[g]=d,this.selectionHandles.styles.topHitArea[g]=d});const h=r.isClassicTheme()?{position:"absolute",height:`${l}px`,width:`${l}px`,"border-radius":`${parseInt(l/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${i}px`,background:`${o}`,border:`${s}px solid ${a}`};Me(h,(d,g)=>{this.selectionHandles.styles.bottom[g]=d,this.selectionHandles.styles.top[g]=d}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),y=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(n-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(n-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),b-p-g*2),T=Math.min(parseInt(i+o-y/4,10),b-y-g*2);h[l]=`${v}px`,d[l]=`${T}px`;const _=Math.min(parseInt(n+s,10),E-p-g*2),M=Math.min(parseInt(n+s-y/4,10),E-y-g*2);h.top=`${_}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=s.getFirstRenderedRow(),h=s.getLastRenderedRow(),d=s.getFirstRenderedColumn(),g=s.getLastRenderedColumn();if(d<0&&g<0||c<0&&h<0){this.disappear();return}let p;if(u){if(n=Math.max(n,d),o=Math.min(o,g),r=Math.max(r,c),i=Math.min(i,h),o<n||i<r){this.disappear();return}p=s.getCell(this.wot.createCellCoords(r,n))}else if(p=s.getCell(this.wot.createCellCoords(r,n)),!Gi(p)){this.disappear();return}const y=u?s.getCell(this.wot.createCellCoords(i,o)):p,b=Pr(p),E=u?Pr(y):b,v=Pr(s.TABLE),T=b.top,_=b.left,M=this.wot.wtSettings.getSetting("rtlMode");let I=0,H=0;if(M){const ae=Jt(s.TABLE),be=Jt(p),Ge=l.innerWidth-v.left-ae;H=_+be-E.left,I=l.innerWidth-_-be-Ge-1}else H=E.left+Jt(y)-_,I=_-v.left-1;if(this.isEntireColumnSelected(r,i)){const ae=r,be=this.getDimensionsFromHeader("columns",n,o,ae,v);let Ge=null;be&&([Ge,I,H]=be),Ge&&(p=Ge)}let V=T-v.top-1,N=E.top+tr(y)-T;if(this.isEntireRowSelected(n,o)){const ae=n,be=this.getDimensionsFromHeader("rows",r,i,ae,v);let Ge=null;be&&([Ge,V,N]=be),Ge&&(p=Ge)}const j=l.getComputedStyle(p);parseInt(j.borderTopWidth,10)>0&&(V+=1,N=N>0?N-1:0),parseInt(j[M?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,H=H>0?H-1:0);const z=M?"right":"left";this.topStyle.top=`${V}px`,this.topStyle[z]=`${I}px`,this.topStyle.width=`${H}px`,this.topStyle.display="block",this.startStyle.top=`${V}px`,this.startStyle[z]=`${I}px`,this.startStyle.height=`${N}px`,this.startStyle.display="block";const te=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${V+N-te}px`,this.bottomStyle[z]=`${I}px`,this.bottomStyle.width=`${H}px`,this.bottomStyle.display="block",this.endStyle.top=`${V}px`,this.endStyle[z]=`${I+H-te}px`,this.endStyle.height=`${N+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const G=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[Q,at]=[i,o];if(G&&Array.isArray(G)&&([,,Q,at]=G),Ui()||!ue||this.isPartRange(Q,at))this.cornerStyle.display="none";else{this.cornerStyle.top=`${V+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[z]=`${I+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ae=au(s.TABLE);const be=ae===l;be&&(ae=a.documentElement);const Ge=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,vr=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Ee=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const f=be?y.getBoundingClientRect().left:y.offsetLeft;let m=!1,w=0;M?(w=f-parseInt(this.cornerDefaultStyle.width,10)/2,m=w<0):(w=f+Jt(y)+parseInt(this.cornerDefaultStyle.width,10)/2,m=w>=NE(ae)),m&&(this.cornerStyle[z]=`${Math.floor(I+H+this.cornerCenterPointOffset-vr-Ge)}px`,this.cornerStyle[M?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){const w=(be?y.getBoundingClientRect().top:y.offsetTop)+tr(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=la(ae),C=this.wot.stylesHandler.isClassicTheme();if(w){const R=Math.floor(V+N+this.cornerCenterPointOffset-Ee-Ge);C?(this.cornerStyle.top=`${R}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${R-1}px`}}this.cornerStyle.display="block"}Ui()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,V,I,H,N)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,p=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return tr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return Jt(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(p=l(r,b-i),y=l(n,b-i),!p||!y)return!1;const E=Pr(p),v=Pr(y);return p&&y&&(h=E[g]-o[g]-1,d=v[g]+u(y)-E[g]),[p,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?J(this[e],"hidden"):(we(this[e],"hidden")&&Ne(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?J(this[e],"hidden"):Ne(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ui()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function QL(t,e){v_(t,e),e.add(t)}function So(t,e,r){v_(t,e),e.set(t,r)}function v_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(zm(t,e))}function aS(t,e,r){return t.set(zm(t,e),r),r}function zm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ot=new WeakMap,Gt=new WeakMap,yf=new WeakMap,Js=new WeakMap,bf=new WeakMap,Ii=new WeakMap,lS=new WeakSet;class JL{constructor(e){QL(this,lS),So(this,Ot,void 0),So(this,Gt,void 0),So(this,yf,new XL),So(this,Js,new WeakMap),So(this,bf,new WeakSet),So(this,Ii,new Map),aS(Gt,this,e)}setActiveOverlay(e){return aS(Ot,this,e),le(yf,this).setActiveOverlay(le(Ot,this)),le(Js,this).has(le(Ot,this))||le(Js,this).set(le(Ot,this),new Set),this}getFocusSelection(){return le(Gt,this)!==null?le(Gt,this).getFocus():null}getAreaSelection(){return le(Gt,this)!==null?le(Gt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(Ii,this).has(e)){const n=le(Ii,this).get(e);if(n.has(le(Ot,this)))return n.get(le(Ot,this));const i=new sS(le(Ot,this),e.settings);return n.set(le(Ot,this),i),i}const r=new sS(le(Ot,this),e.settings);return le(Ii,this).set(e,new Map([[le(Ot,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(Ii,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(Ii,this).get(e).forEach(r=>r.destroy()),le(Ii,this).delete(e)}render(e){if(le(Gt,this)===null)return;e&&zm(lS,this,eF).call(this);const r=Array.from(le(Gt,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(bf,this).has(s)||(le(bf,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&le(yf,this).setActiveSelection(s).scan().forEach(p=>{if(n.has(p)){const y=n.get(p);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else n.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();le(Ot,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(Js,this).get(le(Ot,this)).add(u)),J(s,l),s.nodeName==="TD"&&Array.isArray((a=le(Gt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Oe(s,le(Gt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Oe(o,[...i.get(o)])})}}function eF(){const t=le(Js,this).get(le(Ot,this)),e=le(Ot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(Ot,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(Gt,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(Gt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(Gt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(Gt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Ne(o[a],r),Na(o[a],s)}),t.clear()}class tF extends Wa{constructor(e,r,n,i){super(e,r,Ji,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Bm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Im(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Nu(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,AE(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=rr(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=Jt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=jm(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!we(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=rr(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,JA(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(DE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?Ne(n,"emptyRows"):J(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)J(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=we(n,"innerBorderInlineStart");e?(J(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Ne(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const rF="stickyRowsTop",Um={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Kn(Um,"MIXIN_NAME",rF,{writable:!1,enumerable:!1});class Ym extends hs{constructor(e,r,n,i){super(e,r,n,i,eo)}}Ke(Ym,Um);Ke(Ym,Fu);function uS(t,e,r){return(e=nF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nF(t){var e=iF(t,"string");return typeof e=="symbol"?e:e+""}function iF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oF extends Wa{constructor(e,r,n,i,o,s){super(e,r,eo,n,i),uS(this,"topOverlay",void 0),uS(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Ym(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Im(e,`${i}px`,`${o}px`)}else Nu(e);let r=tr(this.clone.wtTable.TABLE);const n=Jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class qm extends hs{constructor(e,r,n,i){super(e,r,n,i,Qi)}}Ke(qm,Um);Ke(qm,Vu);function sF(t,e,r){return(e=aF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aF(t){var e=lF(t,"string");return typeof e=="symbol"?e:e+""}function lF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uF extends Wa{constructor(e,r,n,i){super(e,r,Qi,n,i),sF(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new qm(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Im(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Nu(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Om(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wot.stylesHandler.getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=rr(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=tr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=jm(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!we(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=rr(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,QA(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Mm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?Ne(i,"emptyColumns"):J(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=we(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(J(i,"innerBorderTop"),a=!h):(Ne(i,"innerBorderTop"),a=h)}}return a}}function il(t,e,r){cF(t,e),e.set(t,r)}function cF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e,r){return(e=hF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hF(t){var e=dF(t,"string");return typeof e=="symbol"?e:e+""}function dF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pi(t,e,r){return t.set(y_(t,e),r),r}function xn(t,e){return t.get(y_(t,e))}function y_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ro=new WeakMap,ol=new WeakMap,To=new WeakMap,sl=new WeakMap;class fF{constructor(e,r,n,i,o,s){Pn(this,"wot",null),il(this,Ro,[]),Pn(this,"topOverlay",null),Pn(this,"bottomOverlay",null),Pn(this,"inlineStartOverlay",null),Pn(this,"topInlineStartCornerOverlay",null),Pn(this,"bottomInlineStartCornerOverlay",null),Pn(this,"browserLineHeight",void 0),Pn(this,"wtSettings",null),il(this,ol,!1),il(this,To,0),il(this,sl,null),Pn(this,"resizeObserver",new ResizeObserver(c=>{fg(()=>{!Array.isArray(c)||!c.length||(Pi(To,this,xn(To,this)+1),xn(To,this)===100&&(Yn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),xn(sl,this)!==null&&clearTimeout(xn(sl,this)),Pi(sl,this,setTimeout(()=>{Pi(To,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=rr(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:su(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...xn(Ro,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new uF(...e),this.bottomOverlay=new WL(...e),this.inlineStartOverlay=new tF(...e),this.topInlineStartCornerOverlay=new oF(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new NL(...e,this.bottomOverlay,this.inlineStartOverlay),Pi(Ro,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Pi(ol,this,xn(Ro,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),xn(Ro,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),xn(Ro,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!mD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{fg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Pi(To,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=SD(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!xn(ol,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Pi(ol,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=su(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=r.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),p=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),y=g()?1:0,b=p()?1:0;d.width=`${c+b}px`,d.height=`${u+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return F(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];F(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function cS(t,e,r){return(e=gF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gF(t){var e=mF(t,"string");return typeof e=="symbol"?e:e+""}function mF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pF{constructor(e){cS(this,"settings",{}),cS(this,"defaults",Object.freeze(this.getDefaults())),Me(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);ka(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?Me(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Gm extends hs{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=au(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=Yb(e,"height",r),o=Yb(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ya(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Ke(Gm,Wm);Ke(Gm,Vu);class wF{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new GN:new ek],["fullyVisible",()=>new FN],["partiallyVisible",()=>new s_]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new UN:new ZN],["fullyVisible",()=>new NN],["partiallyVisible",()=>new o_]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=tr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Pr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=tr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=Jt(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=rr(this.domBindings.rootDocument),new lk({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=rr(this.domBindings.rootDocument)),new ok({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}resetHasOversizedColumnHeadersMarked(){Me(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}function vF(t,e){b_(t,e),e.add(t)}function xi(t,e,r){b_(t,e),e.set(t,r)}function b_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function We(t,e){return t.get(Kr(t,e))}function Gr(t,e,r){return t.set(Kr(t,e),r),r}function Kr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const hS=23;var hn=new WeakMap,Vn=new WeakMap,Km=new WeakMap,yg=new WeakMap,si=new WeakMap,ea=new WeakMap,Ca=new WeakMap,dn=new WeakSet;class yF{constructor(e){vF(this,dn),xi(this,hn,void 0),xi(this,Vn,void 0),xi(this,Km,void 0),xi(this,yg,void 0),xi(this,si,!0),xi(this,ea,{}),xi(this,Ca,{}),Gr(Vn,this,e.rootTable.parentElement.parentElement),Gr(yg,this,e.rootDocument)}isClassicTheme(){return We(si,this)}getCSSVariableValue(e){var r;if(We(si,this))return null;if(We(ea,this)[`--ht-${e}`])return We(ea,this)[`--ht-${e}`];const n=(r=Kr(dn,this,RF).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Kr(dn,this,C_).call(this,`--ht-${e}`);if(n!==null)return We(ea,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=We(Ca,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(We(si,this))return hS;const e=Kr(dn,this,bF).call(this);return!e&&we(We(Vn,this),"ht-wrapper")?(Yn(`The "${We(hn,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),Gr(si,this,!0),this.useTheme(),hS):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Kr(dn,this,dS).call(this),Gr(si,this,!0),Gr(hn,this,e||void 0);return}e&&e!==We(hn,this)&&(We(hn,this)&&Kr(dn,this,TF).call(this),Gr(hn,this,e),Gr(si,this,!1),Kr(dn,this,CF).call(this),Kr(dn,this,dS).call(this))}getThemeName(){return We(hn,this)}removeClassNames(){we(We(Vn,this),We(hn,this))&&Ne(We(Vn,this),We(hn,this))}}function bF(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function CF(){Ne(We(Vn,this),/ht-theme-.*/g),J(We(Vn,this),We(hn,this))}function dS(){this.isClassicTheme()||Gr(Km,this,getComputedStyle(We(Vn,this)));const t=Kr(dn,this,SF).call(this,["box-sizing","border-bottom-width"]);We(Ca,this).td={...We(Ca,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function SF(t){const e=We(yg,this),r=We(Vn,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function RF(t){const e=Math.ceil(parseFloat(Kr(dn,this,C_).call(this,t)));return Number.isNaN(e)?null:e}function C_(t){const e=We(Km,this).getPropertyValue(t);return e===""?null:e}function TF(){Gr(Ca,this,{}),Gr(ea,this,{}),Gr(si,this,!0)}class EF extends Fm{constructor(e,r){super(e,new pF(r)),this.stylesHandler=new yF(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Gm(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new wF(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new JL(this.wtSettings.getSetting("selections")),this.wtEvent=new h_(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new fF(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Me(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),Ne(this.wtTable.wtRootElement.parentNode,r),J(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!g_.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Xm{constructor(e){e instanceof Fm?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Xm(r);return()=>n},this._wot=new EF(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function fS(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function _F(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const OF=new Map([["mousedown",fS],["mouseover",_F],["touchstart",fS]]);function gS(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:o}=e;OF.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:YE(t)||t.type==="touchstart",isRightClick:lu(t)})}const S_=new WeakMap,Zm=Symbol("rootInstance");function MF(t){S_.set(t,!0)}function IF(t){return t===Zm}function jl(t){return S_.has(t)}function PF(t,e){R_(t,e),e.add(t)}function ti(t,e,r){R_(t,e),e.set(t,r)}function R_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e,r){return(e=xF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xF(t){var e=HF(t,"string");return typeof e=="symbol"?e:e+""}function HF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ze(t,e){return t.get(Ko(t,e))}function jt(t,e,r){return t.set(Ko(t,e),r),r}function Ko(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cf=new WeakMap,al=new WeakMap,ll=new WeakMap,Hn=new WeakMap,$r=new WeakMap,Sf=new WeakMap,Rf=new WeakMap,Eo=new WeakMap,ta=new WeakSet;class AF{constructor(e){PF(this,ta),ri(this,"hot",void 0),ri(this,"eventManager",void 0),ri(this,"settings",void 0),ri(this,"THEAD",void 0),ri(this,"TBODY",void 0),ri(this,"_wt",void 0),ri(this,"activeWt",void 0),ti(this,Cf,0),ti(this,al,0),ri(this,"postponedAdjustElementsSize",!1),ti(this,ll,!1),ti(this,Hn,void 0),ti(this,$r,void 0),ti(this,Sf,0),ti(this,Rf,0),ti(this,Eo,null),this.hot=e,this.eventManager=new vi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Ko(ta,this,NF).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),J(e,"handsontable"),jt($r,this,r.createElement("TABLE")),J(Ze($r,this),"htCore"),this.hot.getSettings().tableClassName&&J(Ze($r,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Oe(Ze($r,this),[di()]),Oe(e,[AA(),EE(-1),Du(this.hot.countCols()),zA()])),this.THEAD=r.createElement("THEAD"),Ze($r,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Ze($r,this).appendChild(this.TBODY),this.hot.table=Ze($r,this),this.hot.container.insertBefore(Ze($r,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,o=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{jt(ll,this,!0),this.isTextSelectionAllowed(a.target)||(qb(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{jt(ll,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Ze(ll,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&qb(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{n.isInProgress()&&YE(a)&&n.finish(),jt(Hn,this,!1);const l=LE(r.activeElement);$l(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!lu(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{n.isInProgress()&&lu(a)&&(n.finish(),jt(Hn,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),jt(Hn,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Ze(Hn,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const p=rr(r);if(r.elementFromPoint(u+p,c)!==d||r.elementFromPoint(u,c+p)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=va(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=va(s);this.eventManager.addEventListener(Ze($r,this),"selectstart",a=>{this.settings.fragmentSelection||$l(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&J(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Ne(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ze($r,this),isDataViewInstance:()=>jl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),jt(al,this,o.length),this.hot.getSettings().ariaTags&&Ko(ta,this,T_).call(this)===this.hot.countCols()&&Ko(ta,this,DF).call(this,Ze(al,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),jt(Cf,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let y=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,y,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,y,g),this.hot.runHooks("afterRenderer",a,l,u,p,y,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ya(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,jt(Hn,this,!0),jt(Eo,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Bi(o)&&(gS(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,jt(Hn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Bi(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Bi(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Bi(o)&&(Ze(Hn,this)&&(!Ze(Eo,this)||Ze(Eo,this).x!==o.clientX||Ze(Eo,this).y!==o.clientY)&&gS(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,jt(Eo,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Bi(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[p,y,b,E]=g;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Xm(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if($l(e))return!0;const r=qo(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ze(Hn,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!we(n,"relative")){Xo(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;we(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",J(s,["relative",...o()])):(Xo(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Oe(a,...di()),Oe(l,...di())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(we(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):we(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?HE(e,n(r,i)):(ka(e," "),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){jt(Sf,this,e),jt(Rf,this,r)}getLastSize(){return{width:Ze(Sf,this),height:Ze(Rf,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ze(Cf,this)}getRowHeadersCount(){return Ze(al,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function T_(){return parseInt(this.hot.rootElement.getAttribute(Du()[0]),10)}function DF(t){const e=Ko(ta,this,T_).call(this)+t;Oe(this.hot.rootElement,...Du(e))}function NF(){const t=this.hot.rootElement;this.hasVerticalScroll()?J(t,"htHasScrollY"):Ne(t,"htHasScrollY"),this.hasHorizontalScroll()?J(t,"htHasScrollX"):Ne(t,"htHasScrollX")}var mS={},pS={},wS;function kF(){if(wS)return pS;wS=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,p){if(!c(g,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),pS}var vS;function LF(){return vS||(vS=1,kF()),mS}LF();const FF="ABCDEFGHIJKLMNOPQRSTUVWXYZ",yS=FF.length;function VF(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%yS,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/yS,10);return r}function E_(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&bt(t[0])&&(e=Pm(t[0]))),e}function Ns(t,e,r){return(e=WF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WF(t){var e=BF(t,"string");return typeof e=="symbol"?e:e+""}function BF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $F{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Ns(this,"hot",void 0),Ns(this,"data",void 0),Ns(this,"dataType","array"),Ns(this,"colToProp",()=>{}),Ns(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return F(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):qe(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(bt(a)||Pe(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;qe(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?qd(l,d,g):l[d]=g}})}else Me(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?qd(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=hr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:qd(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?cD(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=hr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return qe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return E_(this.data)}destroy(){this.data=null,this.hot=null}}var bS={},CS={},SS;function jF(){if(SS)return CS;SS=1;var t=Le(),e=mt(),r=ss(),n=mr(),i=pt(),o=Ci(),s=pr(),a=lo(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,p){if(c(g,d++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),CS}var RS;function zF(){return RS||(RS=1,jF()),bS}zF();function TS(t,e,r){return(e=UF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UF(t){var e=YF(t,"string");return typeof e=="symbol"?e:e+""}function YF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ba{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;TS(this,"indexedValues",[]),TS(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Pe(this.initValueOrFn)?qe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):qe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Ke(Ba,Tn);function __(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Pe(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function O_(t,e){return Em(t,(r,n)=>e.includes(n)===!1)}class Wu extends Ba{insert(e,r){this.indexedValues=__(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=O_(this.indexedValues,e),super.remove(e)}}class M_ extends Wu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return co(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function I_(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function cu(t,e){return Em(t,r=>e.includes(r)===!1)}function P_(t,e){return yn(t,r=>r-e.filter(n=>n<r).length)}function x_(t,e){const r=e[0],n=e.length;return yn(t,i=>i>=r?i+n:i)}function qF(t,e,r){return(e=GF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GF(t){var e=KF(t,"string");return typeof e=="symbol"?e:e+""}function KF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XF extends Ba{constructor(){super(...arguments),qF(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=cu(this.orderOfIndexes,[e]),Pe(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=__(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=x_(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=O_(this.indexedValues,e),this.orderOfIndexes=cu(this.orderOfIndexes,e),this.orderOfIndexes=P_(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class H_ extends Wu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return co(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class ZF extends Ba{constructor(){super(e=>e)}insert(e,r){const n=x_(this.indexedValues,r);this.indexedValues=I_(n,e,r),super.insert(e,r)}remove(e){const r=cu(this.indexedValues,e);this.indexedValues=P_(r,e),super.remove(e)}}const ES=new Map([["hiding",M_],["index",Ba],["linkedPhysicalIndexToValue",XF],["physicalIndexToValue",Wu],["trimming",H_]]);function QF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!ES.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(ES.get(t))(e)}function JF(t,e,r){return(e=eV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eV(t){var e=tV(t,"string");return typeof e=="symbol"?e:e+""}function tV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qm{constructor(){JF(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);me(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Nt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Ke(Qm,Tn);function Tf(t,e,r){return(e=rV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rV(t){var e=nV(t,"string");return typeof e=="symbol"?e:e+""}function nV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _S extends Qm{constructor(e,r){super(),Tf(this,"mergedValuesCache",[]),Tf(this,"aggregationFunction",void 0),Tf(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=yn(this.get(),o=>o.getValues()),n=[],i=me(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return yn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return me(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function iV(t,e,r){oV(t,e),e.set(t,r)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sV(t,e,r){return t.set(A_(t,e),r),r}function aV(t,e){return t.get(A_(t,e))}function A_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ef=new WeakMap;class D_{constructor(){iV(this,Ef,[])}subscribe(e){return this.addLocalHook("change",e),this._write(aV(Ef,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){sV(Ef,this,e)}}Ke(D_,Tn);function OS(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ks(t,e,r){lV(t,e),e.set(t,r)}function lV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e){return t.get(N_(t,e))}function ul(t,e,r){return t.set(N_(t,e),r),r}function N_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cl=new WeakMap,Ls=new WeakMap,hl=new WeakMap,dl=new WeakMap,fl=new WeakMap;class uV{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ks(this,cl,new Set),ks(this,Ls,[]),ks(this,hl,[]),ks(this,dl,!1),ks(this,fl,!1),ul(fl,this,e??!1)}createObserver(){const e=new D_;return _r(cl,this).add(e),e.addLocalHook("unsubscribe",()=>{_r(cl,this).delete(e)}),e._writeInitialChanges(OS(_r(Ls,this),_r(hl,this))),e}emit(e){let r=_r(hl,this);(!_r(dl,this)||_r(Ls,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(_r(fl,this)):ul(Ls,this,new Array(e.length).fill(_r(fl,this))),_r(dl,this)||(ul(dl,this,!0),r=_r(Ls,this)));const n=OS(r,e);_r(cl,this).forEach(i=>i._write(n)),ul(hl,this,e)}}function xt(t,e,r){return(e=cV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cV(t){var e=hV(t,"string");return typeof e=="symbol"?e:e+""}function hV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bg{constructor(){xt(this,"indexesSequence",new ZF),xt(this,"trimmingMapsCollection",new _S(e=>e.some(r=>r===!0),!1)),xt(this,"hidingMapsCollection",new _S(e=>e.some(r=>r===!0),!1)),xt(this,"variousMapsCollection",new Qm),xt(this,"hidingChangesObservable",new uV({initialIndexValue:!1})),xt(this,"notTrimmedIndexesCache",[]),xt(this,"notHiddenIndexesCache",[]),xt(this,"isBatched",!1),xt(this,"indexesSequenceChanged",!1),xt(this,"indexesChangeSource",void 0),xt(this,"trimmedIndexesChanged",!1),xt(this,"hiddenIndexesChanged",!1),xt(this,"renderablePhysicalIndexesCache",[]),xt(this,"fromPhysicalToVisualIndexesCache",new Map),xt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,QF(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof H_?this.trimmingMapsCollection.register(e,r):r instanceof M_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return me(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return me(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return me(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return me(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=yn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=cu(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(I_(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=me(n)?n:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=yn(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Ke(bg,Tn);function dV(t,e){return Me(e,(r,n)=>{Nt(t[n])&&(t[n]=r)}),t}function k_(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function L_(t){me(t)&&RD(er`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function fV(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:gV,getValues:mV}=cs("phraseFormatters");function pV(t,e){gV(t,e)}function wV(){return mV()}pV("pluralize",fV);const F_="ContextMenu:items",ne=F_,Jm=`${ne}.noItems`,ep=`${ne}.insertRowAbove`,tp=`${ne}.insertRowBelow`,rp=`${ne}.insertColumnOnTheLeft`,np=`${ne}.insertColumnOnTheRight`,ip=`${ne}.removeRow`,op=`${ne}.removeColumn`,sp=`${ne}.undo`,ap=`${ne}.redo`,hu=`${ne}.readOnly`,lp=`${ne}.clearColumn`,up=`${ne}.copy`,cp=`${ne}.copyWithHeaders`,hp=`${ne}.copyWithGroupHeaders`,dp=`${ne}.copyHeadersOnly`,fp=`${ne}.cut`,V_=`${ne}.freezeColumn`,W_=`${ne}.unfreezeColumn`,B_=`${ne}.mergeCells`,$_=`${ne}.unmergeCells`,j_=`${ne}.addComment`,z_=`${ne}.editComment`,U_=`${ne}.removeComment`,Y_=`${ne}.readOnlyComment`,gp=`${ne}.align`,mp=`${ne}.align.left`,pp=`${ne}.align.center`,wp=`${ne}.align.right`,vp=`${ne}.align.justify`,yp=`${ne}.align.top`,bp=`${ne}.align.middle`,Cp=`${ne}.align.bottom`,q_=`${ne}.borders`,G_=`${ne}.borders.top`,K_=`${ne}.borders.right`,X_=`${ne}.borders.bottom`,Z_=`${ne}.borders.left`,Q_=`${ne}.borders.remove`,J_=`${ne}.nestedHeaders.insertChildRow`,e0=`${ne}.nestedHeaders.detachFromParent`,t0=`${ne}.hideColumn`,r0=`${ne}.showColumn`,n0=`${ne}.hideRow`,i0=`${ne}.showRow`,nr="Filters:",Xe=`${nr}conditions`,o0=`${Xe}.none`,s0=`${Xe}.isEmpty`,a0=`${Xe}.isNotEmpty`,l0=`${Xe}.isEqualTo`,u0=`${Xe}.isNotEqualTo`,c0=`${Xe}.beginsWith`,h0=`${Xe}.endsWith`,d0=`${Xe}.contains`,f0=`${Xe}.doesNotContain`,vV=`${Xe}.byValue`,g0=`${Xe}.greaterThan`,m0=`${Xe}.greaterThanOrEqualTo`,p0=`${Xe}.lessThan`,w0=`${Xe}.lessThanOrEqualTo`,v0=`${Xe}.isBetween`,y0=`${Xe}.isNotBetween`,b0=`${Xe}.after`,C0=`${Xe}.before`,S0=`${Xe}.today`,R0=`${Xe}.tomorrow`,T0=`${Xe}.yesterday`,E0=`${nr}labels.filterByCondition`,_0=`${nr}labels.filterByValue`,O0=`${nr}labels.conjunction`,M0=`${nr}labels.disjunction`,I0=`${nr}values.blankCells`,P0=`${nr}buttons.selectAll`,x0=`${nr}buttons.clear`,H0=`${nr}buttons.ok`,A0=`${nr}buttons.cancel`,D0=`${nr}buttons.placeholder.search`,N0=`${nr}buttons.placeholder.value`,k0=`${nr}buttons.placeholder.secondValue`,Sp="CheckboxRenderer:",L0=`${Sp}checked`,F0=`${Sp}unchecked`,yV=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:L0,CHECKBOX_RENDERER_NAMESPACE:Sp,CHECKBOX_UNCHECKED:F0,CONTEXTMENU_ITEMS_ADD_COMMENT:j_,CONTEXTMENU_ITEMS_ALIGNMENT:gp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Cp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:pp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:vp,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:mp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:bp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:wp,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:yp,CONTEXTMENU_ITEMS_BORDERS:q_,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:X_,CONTEXTMENU_ITEMS_BORDERS_LEFT:Z_,CONTEXTMENU_ITEMS_BORDERS_RIGHT:K_,CONTEXTMENU_ITEMS_BORDERS_TOP:G_,CONTEXTMENU_ITEMS_CLEAR_COLUMN:lp,CONTEXTMENU_ITEMS_COPY:up,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:dp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:hp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:cp,CONTEXTMENU_ITEMS_CUT:fp,CONTEXTMENU_ITEMS_EDIT_COMMENT:z_,CONTEXTMENU_ITEMS_FREEZE_COLUMN:V_,CONTEXTMENU_ITEMS_HIDE_COLUMN:t0,CONTEXTMENU_ITEMS_HIDE_ROW:n0,CONTEXTMENU_ITEMS_INSERT_LEFT:rp,CONTEXTMENU_ITEMS_INSERT_RIGHT:np,CONTEXTMENU_ITEMS_MERGE_CELLS:B_,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:e0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:J_,CONTEXTMENU_ITEMS_NO_ITEMS:Jm,CONTEXTMENU_ITEMS_READ_ONLY:hu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Y_,CONTEXTMENU_ITEMS_REDO:ap,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Q_,CONTEXTMENU_ITEMS_REMOVE_COLUMN:op,CONTEXTMENU_ITEMS_REMOVE_COMMENT:U_,CONTEXTMENU_ITEMS_REMOVE_ROW:ip,CONTEXTMENU_ITEMS_ROW_ABOVE:ep,CONTEXTMENU_ITEMS_ROW_BELOW:tp,CONTEXTMENU_ITEMS_SHOW_COLUMN:r0,CONTEXTMENU_ITEMS_SHOW_ROW:i0,CONTEXTMENU_ITEMS_UNDO:sp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:W_,CONTEXTMENU_ITEMS_UNMERGE_CELLS:$_,CONTEXT_MENU_ITEMS_NAMESPACE:F_,FILTERS_BUTTONS_CANCEL:A0,FILTERS_BUTTONS_CLEAR:x0,FILTERS_BUTTONS_OK:H0,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:D0,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:k0,FILTERS_BUTTONS_PLACEHOLDER_VALUE:N0,FILTERS_BUTTONS_SELECT_ALL:P0,FILTERS_CONDITIONS_AFTER:b0,FILTERS_CONDITIONS_BEFORE:C0,FILTERS_CONDITIONS_BEGINS_WITH:c0,FILTERS_CONDITIONS_BETWEEN:v0,FILTERS_CONDITIONS_BY_VALUE:vV,FILTERS_CONDITIONS_CONTAINS:d0,FILTERS_CONDITIONS_EMPTY:s0,FILTERS_CONDITIONS_ENDS_WITH:h0,FILTERS_CONDITIONS_EQUAL:l0,FILTERS_CONDITIONS_GREATER_THAN:g0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:m0,FILTERS_CONDITIONS_LESS_THAN:p0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:w0,FILTERS_CONDITIONS_NAMESPACE:Xe,FILTERS_CONDITIONS_NONE:o0,FILTERS_CONDITIONS_NOT_BETWEEN:y0,FILTERS_CONDITIONS_NOT_CONTAIN:f0,FILTERS_CONDITIONS_NOT_EMPTY:a0,FILTERS_CONDITIONS_NOT_EQUAL:u0,FILTERS_CONDITIONS_TODAY:S0,FILTERS_CONDITIONS_TOMORROW:R0,FILTERS_CONDITIONS_YESTERDAY:T0,FILTERS_DIVS_FILTER_BY_CONDITION:E0,FILTERS_DIVS_FILTER_BY_VALUE:_0,FILTERS_LABELS_CONJUNCTION:O0,FILTERS_LABELS_DISJUNCTION:M0,FILTERS_NAMESPACE:nr,FILTERS_VALUES_BLANK_CELLS:I0},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const V0={languageCode:"en-US",[Jm]:"No available options",[ep]:"Insert row above",[tp]:"Insert row below",[rp]:"Insert column left",[np]:"Insert column right",[ip]:["Remove row","Remove rows"],[op]:["Remove column","Remove columns"],[sp]:"Undo",[ap]:"Redo",[hu]:"Read only",[lp]:"Clear column",[gp]:"Alignment",[mp]:"Left",[pp]:"Center",[wp]:"Right",[vp]:"Justify",[yp]:"Top",[bp]:"Middle",[Cp]:"Bottom",[V_]:"Freeze column",[W_]:"Unfreeze column",[q_]:"Borders",[G_]:"Top",[K_]:"Right",[X_]:"Bottom",[Z_]:"Left",[Q_]:"Remove border(s)",[j_]:"Add comment",[z_]:"Edit comment",[U_]:"Delete comment",[Y_]:"Read-only comment",[B_]:"Merge cells",[$_]:"Unmerge cells",[up]:"Copy",[cp]:["Copy with header","Copy with headers"],[hp]:["Copy with group header","Copy with group headers"],[dp]:["Copy header only","Copy headers only"],[fp]:"Cut",[J_]:"Insert child row",[e0]:"Detach from parent",[t0]:["Hide column","Hide columns"],[r0]:["Show column","Show columns"],[n0]:["Hide row","Hide rows"],[i0]:["Show row","Show rows"],[o0]:"None",[s0]:"Is empty",[a0]:"Is not empty",[l0]:"Is equal to",[u0]:"Is not equal to",[c0]:"Begins with",[h0]:"Ends with",[d0]:"Contains",[f0]:"Does not contain",[g0]:"Greater than",[m0]:"Greater than or equal to",[p0]:"Less than",[w0]:"Less than or equal to",[v0]:"Is between",[y0]:"Is not between",[b0]:"After",[C0]:"Before",[S0]:"Today",[R0]:"Tomorrow",[T0]:"Yesterday",[I0]:"Blank cells",[E0]:"Filter by condition",[_0]:"Filter by value",[O0]:"And",[M0]:"Or",[P0]:"Select all",[x0]:"Clear",[H0]:"OK",[A0]:"Cancel",[D0]:"Search",[N0]:"Value",[k0]:"Second value",[L0]:"Checked",[F0]:"Unchecked"},bV=yV,Cg=V0.languageCode,{register:CV,getItem:W0,hasItem:SV,getValues:RV}=cs("languagesDictionaries");B0(V0);function B0(t,e){let r=t,n=e;return bt(t)&&(n=t,r=n.languageCode),TV(r,n),CV(r,gr(n)),gr(n)}function TV(t,e){t!==Cg&&dV(e,W0(Cg))}function $0(t){return Rp(t)?gr(W0(t)):null}function Rp(t){return SV(t)}function EV(){return RV()}function j0(t,e,r){const n=$0(t);if(n===null)return null;const i=n[e];if(Nt(i))return null;const o=_V(i,r);return Array.isArray(o)?o[0]:o}function _V(t,e){let r=t;return F(wV(),n=>{r=n(t,e)}),r}function OV(t){let e=k_(t);return Rp(e)||(e=Cg,L_(t)),e}function MV(t,e,r){return(e=IV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IV(t){var e=PV(t,"string");return typeof e=="symbol"?e:e+""}function PV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xn extends m_{constructor(e,r){super(e,null),MV(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function _f(t){let{activeHeaderClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:jL})}function xV(t){let{areaCornerVisible:e,...r}=t;return new Xn({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:$m})}function HV(t){let{...e}=t;return new Xn({className:"highlight",...e,selectionType:$m})}function AV(t){let{columnClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:YL})}function DV(t){let{cellCornerVisible:e,...r}=t;return new Xn({className:"current",headerAttributes:[OE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:ua})}function NV(t){let{border:e,visualCellRange:r,...n}=t;return new Xn({...e,...n,selectionType:qL},r)}function kV(t){let{...e}=t;return new Xn({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:zL})}function MS(t){let{headerClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:p_})}function LV(t){let{rowClassName:e,...r}=t;return new Xn({className:e,...r,selectionType:UL})}function FV(t,e){VV(t,e),e.add(t)}function VV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zt(t,e,r){return(e=WV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WV(t){var e=BV(t,"string");return typeof e=="symbol"?e:e+""}function BV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function An(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ln=new WeakSet;class $V{constructor(e){FV(this,ln),zt(this,"options",void 0),zt(this,"layerLevel",0),zt(this,"focus",void 0),zt(this,"fill",void 0),zt(this,"layeredAreas",new Map),zt(this,"areas",new Map),zt(this,"rowHeaders",new Map),zt(this,"columnHeaders",new Map),zt(this,"activeRowHeaders",new Map),zt(this,"activeColumnHeaders",new Map),zt(this,"activeCornerHeaders",new Map),zt(this,"rowHighlights",new Map),zt(this,"columnHighlights",new Map),zt(this,"customSelections",[]),this.options=e,this.focus=DV(e),this.fill=kV(e)}isEnabledFor(e,r){let n=e;e===ua&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return An(ln,this,Dn).call(this,this.layeredAreas,xV)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return An(ln,this,Dn).call(this,this.areas,HV)}getAreas(){return[...this.areas.values()]}createRowHeader(){return An(ln,this,Dn).call(this,this.rowHeaders,MS)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return An(ln,this,Dn).call(this,this.columnHeaders,MS)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return An(ln,this,Dn).call(this,this.activeRowHeaders,_f)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return An(ln,this,Dn).call(this,this.activeColumnHeaders,_f)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return An(ln,this,Dn).call(this,this.activeCornerHeaders,_f)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return An(ln,this,Dn).call(this,this.rowHighlights,LV)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return An(ln,this,Dn).call(this,this.columnHighlights,AV)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(NV({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),F(this.areas.values(),e=>void e.clear()),F(this.layeredAreas.values(),e=>void e.clear()),F(this.rowHeaders.values(),e=>void e.clear()),F(this.columnHeaders.values(),e=>void e.clear()),F(this.activeRowHeaders.values(),e=>void e.clear()),F(this.activeColumnHeaders.values(),e=>void e.clear()),F(this.activeCornerHeaders.values(),e=>void e.clear()),F(this.rowHighlights.values(),e=>void e.clear()),F(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Dn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function IS(t,e,r){return(e=jV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jV(t){var e=zV(t,"string");return typeof e=="symbol"?e:e+""}function zV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UV{constructor(e){IS(this,"ranges",[]),IS(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function YV(t,e){z0(t,e),e.add(t)}function Of(t,e,r){z0(t,e),e.set(t,r)}function z0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ve(t,e){return t.get(rt(t,e))}function gl(t,e,r){return t.set(rt(t,e),r),r}function rt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ml=new WeakMap,De=new WeakMap,Zr=new WeakMap,ut=new WeakSet;class Sg{constructor(e,r){YV(this,ut),Of(this,ml,void 0),Of(this,De,void 0),Of(this,Zr,{x:0,y:0}),gl(ml,this,e),gl(De,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=ve(De,this).createCellCoords(e,r);let o=ve(ml,this).current().highlight;const s=ve(De,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=rt(ut,this,U0).call(this),{row:h,col:d}=rt(ut,this,xS).call(this,o),g=ve(De,this).fixedRowsBottom(),p=ve(De,this).minSpareRows(),y=ve(De,this).minSpareCols(),b=ve(De,this).autoWrapRow(),E=ve(De,this).autoWrapCol(),v=ve(De,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const M=hr(n&&p>0&&g===0),I=v.col+1,H=ve(De,this).createCellCoords(v.row-c,I>=u?I-u:I);this.runLocalHooks("beforeColumnWrap",M,rt(ut,this,_o).call(this,H),I>=u),M.value?this.runLocalHooks("insertRowRequire",ve(De,this).countRenderableRows()):E&&v.assign(H)}else if(v.row<0){const M=hr(E),I=v.col-1,H=ve(De,this).createCellCoords(c+v.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",M,rt(ut,this,_o).call(this,H),I<0),E&&v.assign(H)}if(v.col>=u){const M=hr(n&&y>0),I=v.row+1,H=ve(De,this).createCellCoords(I>=c?I-c:I,v.col-u);this.runLocalHooks("beforeRowWrap",M,rt(ut,this,_o).call(this,H),I>=c),M.value?this.runLocalHooks("insertColRequire",ve(De,this).countRenderableColumns()):b&&v.assign(H)}else if(v.col<0){const M=hr(b),I=v.row-1,H=ve(De,this).createCellCoords(I<0?c+I:I,u+v.col);this.runLocalHooks("beforeRowWrap",M,rt(ut,this,_o).call(this,H),I<0),b&&v.assign(H)}const{rowDir:T,colDir:_}=rt(ut,this,PS).call(this,v);a=T,l=_,o=rt(ut,this,_o).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,r){const n=ve(De,this).createCellCoords(e,r),i=ve(ml,this).current(),o=ve(De,this).visualToRenderableCoords(i.highlight),s=rt(ut,this,Mf).call(this,i.to.row,i.from.row),a=rt(ut,this,If).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=rt(ut,this,xS).call(this,i.highlight),g=ve(De,this).createCellCoords(s+n.row,a+n.col),p=i.getTopStartCorner(),y=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const _=g.col-d;g.col=rt(ut,this,If).call(this,p.col,y.col)+_}else if(n.col>0&&a<=d&&g.col>d){const _=rt(ut,this,If).call(this,y.col,p.col),M=Math.max(g.col-_,1);g.col=_+M}if(n.row<0&&s>=h&&g.row<h){const _=g.row-h;g.row=rt(ut,this,Mf).call(this,p.row,b.row)+_}else if(n.row>0&&s<=h&&g.row>h){const _=rt(ut,this,Mf).call(this,b.row,p.row),M=Math.max(g.row-_,1);g.row=_+M}const{rowDir:E,colDir:v}=rt(ut,this,PS).call(this,g);u=E,c=v;const T=rt(ut,this,_o).call(this,g);n.row===0&&n.col!==0?l.col=T.col:n.row!==0&&n.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;gl(Zr,this,{x:r,y:n})}resetOffsetSize(){gl(Zr,this,{x:0,y:0})}}function PS(t){const{width:e,height:r}=rt(ut,this,U0).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function U0(){return{width:ve(Zr,this).x+ve(De,this).countRenderableColumns(),height:ve(Zr,this).y+ve(De,this).countRenderableRows()}}function Mf(t,e){const r=ve(De,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:ve(Zr,this).y+r}function If(t,e){const r=ve(De,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ve(Zr,this).x+r}function xS(t){const{row:e,col:r}=ve(De,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return ve(De,this).createCellCoords(ve(Zr,this).y+e,ve(Zr,this).x+r)}function _o(t){const e=t.clone();return e.col=t.col-ve(Zr,this).x,e.row=t.row-ve(Zr,this).y,ve(De,this).renderableToVisualCoords(e)}Ke(Sg,Tn);const Bu=0,$u=1,Y0=2,Tp=3,qV=[Tp,Y0],GV=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Pf=Symbol("root"),HS=Symbol("child");function ju(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pf;if(e!==Pf&&e!==HS)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Pf;let i=Bu;if(r){const o=t[0];t.length===0?i=$u:n&&o instanceof Fa?i=Tp:n&&Array.isArray(o)?i=ju(o,HS):t.length>=2&&t.length<=4&&!t.some((a,l)=>!GV[l].includes(typeof a))&&(i=Y0)}return i}function Ep(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qV.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Tp;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Nt(u)&&(u=a),Nt(c)&&(c=l),!n){const g=a,p=l,y=u,b=c;a=Math.min(g,y),l=Math.min(p,b),u=Math.max(g,y),c=Math.max(p,b)}const h=e(a,l),d=e(u,c);return r(h,h,d)}}function KV(t){const e=ju(t.getSelected());if(e===Bu||e===$u)return[];const r=Ep(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;F(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;F(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return co(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function XV(t){const e=ju(t.getSelected());if(e===Bu||e===$u)return[];const r=Ep(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;F(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;F(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return co(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Oo(t,e,r){ZV(t,e),e.set(t,r)}function ZV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hi(t,e,r){return(e=QV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QV(t){var e=JV(t,"string");return typeof e=="symbol"?e:e+""}function JV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fe(t,e){return t.get(q0(t,e))}function un(t,e,r){return t.set(q0(t,e),r),r}function q0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Et=new WeakMap,Ai=new WeakMap,pl=new WeakMap,Fs=new WeakMap,wl=new WeakMap,Vs=new WeakMap;class G0{constructor(e,r){var n=this;Hi(this,"settings",void 0),Hi(this,"tableProps",void 0),Hi(this,"inProgress",!1),Hi(this,"selectedRange",new UV((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Hi(this,"highlight",void 0),Oo(this,Et,void 0),Oo(this,Ai,void 0),Hi(this,"selectedByRowHeader",new Set),Hi(this,"selectedByColumnHeader",new Set),Oo(this,pl,!1),Oo(this,Fs,!1),Oo(this,wl,"unknown"),Oo(this,Vs,-1),this.settings=e,this.tableProps=r,this.highlight=new $V({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[OE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),un(Et,this,new Sg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),un(Ai,this,new Sg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Fe(Et,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Fe(Et,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Fe(Et,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Fe(Et,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Fe(Et,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Fe(Et,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Fe(Et,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Fe(Et,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Fe(Ai,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Fe(Ai,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){un(wl,this,e)}markEndSource(){un(wl,this,"unknown")}getSelectionSource(){return Fe(wl,this)}setExpectedLayers(e){un(Vs,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,un(Vs,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Nt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();un(pl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&Nt(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!o||i===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(r),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Fe(Vs,this)===-1||this.selectedRange.size()===Fe(Vs,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(F(this.highlight.getAreas(),p=>void p.clear()),F(this.highlight.getLayeredAreas(),p=>void p.clear()),F(this.highlight.getRowHeaders(),p=>void p.clear()),F(this.highlight.getColumnHeaders(),p=>void p.clear()),F(this.highlight.getActiveRowHeaders(),p=>void p.clear()),F(this.highlight.getActiveColumnHeaders(),p=>void p.clear()),F(this.highlight.getActiveCornerHeaders(),p=>void p.clear()),F(this.highlight.getRowHighlights(),p=>void p.clear()),F(this.highlight.getColumnHighlights(),p=>void p.clear())),this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor($m,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const p=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(p_,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(v).commit(),d.add(b).commit(),g.add(v).commit()):(a.add(b).add(E).commit(),l.add(v).add(T).commit(),d.add(b).add(E).commit(),g.add(v).add(T).commit())}const p=!Fe(Fs,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!Fe(Fs,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&y&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(ua,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(un(pl,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Fe(Et,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Et,this).resetOffsetSize(),this.setRangeStart(Fe(Et,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?Fe(Et,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Et,this).resetOffsetSize(),this.setRangeEnd(Fe(Et,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?Fe(Ai,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Fe(Ai,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Fe(Ai,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(He(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(He(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(He(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,He(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,He(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,He(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=hr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Fe(pl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;un(Fs,this,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(He(d.row,u,o-1),He(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),un(Fs,this,!1)}selectCells(e){var r=this;const n=ju(e);if(n===$u)return!1;if(n===Bu)throw new Error(er`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Ep(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),F(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,p=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(g=He(n.row,u,s-1),p=He(n.col,Math.min(i,o),Math.max(i,o))):(g=He(n,u,s-1),p=i);const y=this.tableProps.createCellCoords(g,p),b=l===0?0:He(y.row,u,-1),E=s-1,v=this.tableProps.createCellCoords(b,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",v,T,y),v.row=b,T.row=E,this.setRangeStartOnly(v,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",v,T,y),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=He(n.row,Math.min(e,r),Math.max(e,r)),d=He(n.col,a,o-1)):(h=e,d=He(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),p=s===0?0:He(g.col,a,-1),y=o-1,b=this.tableProps.createCellCoords(e,p),E=this.tableProps.createCellCoords(r,y);this.runLocalHooks("beforeSelectRows",b,E,g),b.col=p,E.col=y,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",b,E,g),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:o,highlight:s}=n;this.clear(),s.assign({row:He(s.row,-1/0,e-1),col:He(s.col,-1/0,r-1)}),i.assign({row:He(i.row,-1/0,e-1),col:He(i.col,-1/0,r-1)}),o.assign({row:He(o.row,0,e-1),col:He(o.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.isEnabledFor(ua,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(ua,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Ke(G0,Tn);const AS=/^(\r\n|\n\r|\r|\n)/,eW=/^[^\t\r\n]+/,DS=/^\t/;function tW(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(DS))t=t.replace(DS,""),r+=1,e[n][r]="";else if(t.match(AS))t=t.replace(AS,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(eW);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function ha(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Di(t,e,r){return(e=rW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rW(t){var e=nW(t,"string");return typeof e=="symbol"?e:e+""}function nW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bo{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Di(this,"hot",void 0),Di(this,"metaManager",void 0),Di(this,"tableMeta",void 0),Di(this,"dataSource",void 0),Di(this,"duckSchema",void 0),Di(this,"colToPropCache",void 0),Di(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=Pm(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(bt(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return E_(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Me(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&me(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(me(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ba(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=gr(this.getSchema()):(p=[],qe(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},BE(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,p=c;i==="end"&&(p=Math.min(p+1,a));const y=p;for(;g<r&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let E=0;E<h;E+=1)typeof o[E]>"u"&&(o[E]=[]),o[E].push(null);else o.push([null]);else for(let E=0;E<h;E++)o[E].splice(p,0,null);g+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(y,r));const b=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",b,g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:y}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=me(this.tableMeta.columns)||me(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Lb(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return EA(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Lb(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&bn(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=hr(a);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=hr(o);this.hot.runHooks("modifyData",i,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&bn(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Bo.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Bo.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return ha(this.getRange(e,r,Bo.DESTINATION_RENDERER))}getCopyableText(e,r){return ha(this.getRange(e,r,Bo.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:iW,getItem:oW,hasItem:K0}=cs("cellTypes");function sW(t){if(!K0(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return oW(t)}function aW(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&XE(t,r),n&&_N(t,n),i&&PN(t,i),iW(t,e)}function lW(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!bn(e,t)}function zu(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?sW(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Me(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!bt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Me(n,(o,s)=>{if(lW(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),wi(t,i)}function uW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}uD(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function zl(t){return Number.isInteger(t)&&t>=0}function Ul(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function vl(t){return t==null}const X0=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Xi(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Xi(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),$E(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function NS(t,e,r){return(e=cW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cW(t){var e=hW(t,"string");return typeof e=="symbol"?e:e+""}function hW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dW(){return class{}}class fW{constructor(e){NS(this,"metaCtor",dW()),NS(this,"meta",void 0),this.meta=this.metaCtor.prototype,wi(this.meta,X0()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;wi(this.meta,e),zu(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function gW(t,e,r){return(e=mW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mW(t){var e=pW(t,"string");return typeof e=="symbol"?e:e+""}function pW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wW{constructor(e){gW(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){wi(this.meta,e),zu(this.meta,e,e)}}function yl(t,e,r){return(e=vW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vW(t){var e=yW(t,"string");return typeof e=="symbol"?e:e+""}function yW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class du{constructor(e){yl(this,"valueFactory",void 0),yl(this,"data",[]),yl(this,"index",[]),yl(this,"holes",new Set),this.valueFactory=e}obtain(e){Ul(()=>zl(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ul(()=>zl(e)||vl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=vl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ul(()=>zl(e)||vl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(vl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function kS(t,e,r){return(e=bW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bW(t){var e=CW(t,"string");return typeof e=="symbol"?e:e+""}function CW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const SW=["data","width"];class RW{constructor(e){kS(this,"globalMeta",void 0),kS(this,"metas",new du(()=>this._createMeta())),this.globalMeta=e,this.metas=new du(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);wi(n,r),zu(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return uW(this.globalMeta.getMetaConstructor(),SW).prototype}}function LS(t,e,r){return(e=TW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TW(t){var e=EW(t,"string");return typeof e=="symbol"?e:e+""}function EW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _W{constructor(e){LS(this,"columnMeta",void 0),LS(this,"metas",new du(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);wi(i,n),zu(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)me(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Ul(()=>zl(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new du(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class Z0{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new fW(e),this.tableMeta=new wW(this.globalMeta),this.columnMeta=new RW(this.globalMeta),this.cellMeta=new _W(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Ke(Z0,Tn);function FS(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Au(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Pe(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Bo(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let y,b=0,E=0;for(b=0,E=d.startRows;b<E;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)y=gr(p),t.push(y);else if(i.dataType==="array")y=gr(p[0]),t.push(y);else{y=[];for(let v=0,T=d.startCols;v<T;v++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Oe(i.rootElement,[EE(-1),Du(i.countCols()+(i.view?i.countRowHeaders():0))])}function VS(t,e,r){return(e=OW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OW(t){var e=MW(t,"string");return typeof e=="symbol"?e:e+""}function MW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IW{constructor(e){var r=this;VS(this,"metaManager",void 0),VS(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),ge.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=bn(e,"type")?e.type:null;let c=Pe(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function PW(t,e,r){xW(t,e),e.set(t,r)}function xW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xf(t,e,r){return(e=HW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HW(t){var e=AW(t,"string");return typeof e=="symbol"?e:e+""}function AW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DW(t,e){return t.get(NW(t,e))}function NW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var WS=new WeakMap;class kW{constructor(e){xf(this,"metaManager",void 0),xf(this,"usageTracker",new Set),xf(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),PW(this,WS,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,DW(WS,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const Q0="gridDefault",J0="editorManager.handlingEditor",LW={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},FW="hooksRefRegisterer",eO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){F(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Me(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Kn(eO,"MIXIN_NAME",FW,{writable:!1,enumerable:!1});function jr(t,e,r){return(e=VW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VW(t){var e=WW(t,"string");return typeof e=="symbol"?e:e+""}function WW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BW="base",it=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class _p{static get EDITOR_TYPE(){return BW}constructor(e){jr(this,"hot",void 0),jr(this,"state",it.VIRGIN),jr(this,"_opened",!1),jr(this,"_fullEditMode",!1),jr(this,"_closeCallback",null),jr(this,"TD",null),jr(this,"row",null),jr(this,"col",null),jr(this,"prop",null),jr(this,"originalValue",null),jr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:it.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==it.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=it.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:Yo(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===it.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===it.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=it.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=it.FINISHED,this.discardEditor(s)}):(this.state=it.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=it.FINISHED,this.discardEditor()}discardEditor(e){this.state===it.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=it.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=it.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===it.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Pr(r),a=Jt(r),l=Pr(this.hot.rootElement),u=Jt(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:y}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=y.name,E=["master","inline_start"].includes(b)?d:0,v=["master","top","bottom"].includes(b)?g:0,T=s.top===l.top?0:1;let _=s.top-l.top-T-E,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-p-1+v:M=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(b)&&(_+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const I=this.hot.hasColHeaders(),H=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),V=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),j=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(I&&H<=0||H===j)&&(_+=1),V<=0&&(M+=1);const z=i.rowsRenderCalculator.startPosition,te=i.columnsRenderCalculator.startPosition,ue=Math.abs(n.inlineStartOverlay.getScrollPosition()),G=n.topOverlay.getScrollPosition(),Q=rr(this.hot.rootDocument);let at=r.offsetTop;if(["inline_start","master"].includes(b)&&(at+=z-G),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:P,wtTable:A}=n.bottomOverlay.clone;at+=P.getWorkspaceHeight()-A.getHeight()-Q}let ae=r.offsetLeft;this.hot.isRtl()?(ae>=0?ae=y.getWidth()-r.offsetLeft:ae=Math.abs(ae),ae+=te-ue-a):["top","master","bottom"].includes(b)&&(ae+=te-ue);const be=o.getComputedStyle(this.TD),Ge=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",vr=parseInt(be[Ge],10)>0?0:1,Ee=parseInt(be.borderTopWidth,10)>0?0:1,f=Jt(r)+vr,m=tr(r)+Ee,w=rD(c)?Q:0,C=nD(h)?Q:0,R=this.hot.view.maximumVisibleElementWidth(ae)-w+vr,O=Math.max(this.hot.view.maximumVisibleElementHeight(at)-C+Ee,this.hot.view.getDefaultRowHeight());return{top:_,start:M,height:m,maxHeight:O,width:f,maxWidth:R}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Ke(_p,eO);const $W={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===it.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},jW={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},zW={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},UW={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},YW={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),ku(e))}};function qW(){return[LW,$W,jW,zW,UW,YW]}const GW={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},KW={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},XW={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},ZW={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},QW={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},JW={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},eB={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},tB={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},rB={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},nB={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},iB={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},oB={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},sB={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},aB={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function lB(){return[GW,KW,XW,ZW,QW,JW,eB,tB,rB,nB,iB,oB,sB,aB]}const uB={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},cB={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},hB={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-o.row,-o.col):r.transformStart(-o.row,-o.col),r.markEndSource()}},dB={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(o.row,o.col):r.transformStart(o.row,o.col),r.markEndSource()}},fB={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},gB={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},mB={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},pB={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},wB={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},vB={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},yB={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},bB={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},CB={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},SB={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},RB={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},TB={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function EB(){return[uB,cB,hB,dB,fB,gB,mB,pB,wB,vB,yB,bB,CB,SB,RB,TB]}const _B={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},OB={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},MB={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},IB={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},PB={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},xB=[...qW(),...lB(),...EB(),_B,OB,MB,IB,PB];function tO(t){const e={};return xB.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function HB(t){const e=t.getShortcutManager().addContext("editor"),r=tO(t),n={group:J0};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function AB(t){const e=t.getShortcutManager().addContext("grid"),r=tO(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return me(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Q0};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:J0,runOnlyIf:()=>me(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function DB(t){[AB,HB].forEach(e=>e(t))}function NB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=BS(t),i=BS(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function BS(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Oe(r,[hg("Focus catcher")]),r}function kB(t){const e=LB(t);let r;const{activate:n,deactivate:i}=NB(t,{onFocusFromTop(){var h;const d=(h=e(r))!==null&&h!==void 0?h:Rg(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(r))!==null&&h!==void 0?h:Tg(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,d,g,p,y)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,y.value=!0),s){var b;r=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Q0,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?Rg(t):Tg(t)),u(),!1;h.preventDefault()},position:"after"}])}function Rg(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function Tg(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function LB(t){return e=>{if(!e)return null;const r=Rg(t),n=Tg(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function ds(t){Gi(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Uu(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,p=n.getBottomEndCorner().row,y=g<=h,b=p>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?n.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:y&&b?n.highlight.row:y?g:b?p:E.row}}}function FB(t){return e=>{const r=Uu(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;ds(t.getCell(n?-1:0,r,!0))})}}function VB(){return()=>{}}function WB(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;ds(t.getCell(r,n,!0))})}}function BB(t){return e=>{const r=Uu(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;ds(t.getCell(i,o,!0))})}}function $B(t){return e=>{const r=Uu(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;ds(t.getCell(i,o,!0))})}}function jB(t){return e=>{const r=Uu(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;ds(t.getCell(r,n?-1:0,!0))})}}function zB(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{ds(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function UB(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=WB(t):e.isSelectedByCorner()?s=VB():e.isSelectedByRowHeader()?s=jB(t):e.isSelectedByColumnHeader()?s=FB(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=BB(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=zB(t):e.getSelectedRange().size()>1&&(s=$B(t)),(o=s)===null||o===void 0||o(i)}}}const $S=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),bl=t=>t.map(e=>{const r=e.toLowerCase();return $S.has(r)?$S.get(r):r}).sort().join("+"),YB=t=>t.split("+"),jS=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Hf=t=>{let{which:e,key:r}=t;if(jS.has(e))return jS.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},rO=Symbol("shortcut-context");function nO(t){return bt(t)&&t.__kindOf===rO}const qB=t=>{const e=Lu({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:y,position:b,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Nt(c))throw new Error("You need to define the shortcut's group.");if(Pe(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(er`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:p};me(y)&&(v.relativeToGroup=y,v.position=b),nO(E)&&(v.forwardToContext=E),l.forEach(T=>{const _=bl(T);if(e.hasItem(_)){const I=e.getItem(_);let H=I.findIndex(V=>V.group===y);H!==-1?b==="before"?H-=1:H+=1:H=I.length,I.splice(H,0,v)}else e.addItem(_,[v])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Me(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),r(c)})},i=l=>{const u=bl(l);e.removeItem(u)};return{__kindOf:rO,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=bl(l),c=e.getItem(u);return me(c)?c.slice():[]},hasShortcut:l=>{const u=bl(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(p=>p.group!==l);g.length===0?i(YB(h)):(d.length=0,d.push(...g))})}}};function GB(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const KB=["meta","alt","shift","control"],Ws=GB(),Bs=[];let Cl=0;function XB(t,e,r,n,i){const o=g=>KB.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),p&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||Bi(g))return;const y=Hf(g);let b=[];o(y)||(b=s(g));const E=[y].concat(b);!i(g,E)&&(Jb()&&b.includes("meta")||!Jb()&&b.includes("control"))&&i(g,[y].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const p=Hf(g);o(p)&&Ws.press(p)}},u=g=>{if(typeof g.key=="string"){const p=Hf(g);o(p)&&Ws.release(p)}},c=()=>{Ws.releaseAll()};return{mount:()=>{let g=t;for(Cl+=1;g;)Cl===1&&(g.document.documentElement.addEventListener("keydown",l),Bs.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),Bs.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=va(g)},unmount:()=>{let g=t;for(Cl-=1;g;){if(Cl===0){for(let p=0;p<Bs.length;p++){const{event:y,listener:b}=Bs[p];g.document.documentElement.removeEventListener(y,b)}Bs.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=va(g)}},isPressed:g=>Ws.isPressed(g),releasePressedKeys:()=>Ws.releaseAll()}}const ZB=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=Lu({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const y=qB(p);return o.addItem(p,y),y},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(er`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,y){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=nO(b)?b:u(b);let v=!1;if(!E.hasShortcut(y))return v;const T=E.getShortcuts(y);for(let _=0;_<T.length;_++){const{callback:M,runOnlyIf:I,preventDefault:H,stopPropagation:V,captureCtrl:N,forwardToContext:j}=T[_];if(I(p)===!0){if(h=N,v=M(p,y)===!1,h=!1,H&&p.preventDefault(),V&&(ku(p),p.stopPropagation()),v)break;j&&d(p,y,j)}}return v},g=XB(e,r,n,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};function zS(t){const{classNames:e}=GA(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let Af=null;const Df=new Map;function iO(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new vi(o);let a,l,u,c,h,d,g=!0;IF(i)&&MF(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},e.language=OV(e.language);const b=Object.fromEntries(Object.entries(e).filter(f=>{let[m]=f;return!(ge.getSingleton().isRegistered(m)||ge.getSingleton().isDeprecated(m))})),E=new Z0(o,b,[IW,kW]),v=E.getTableMeta(),T=E.getGlobalMeta(),_=Lu();this.container=this.rootDocument.createElement("div"),t.insertBefore(this.container,t.firstChild),jl(this)&&(IA(e.licenseKey,t),J(t,"ht-wrapper")),this.guid=`ht_${SE()}`,Df.set(this.guid,this),this.columnIndexMapper=new bg,this.rowIndexMapper=new bg,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterRowSequenceChange",f)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{o.runHooks("beforeCompositionStart",f)}),l=new $F(o),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const M=f=>{const{row:m,col:w}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?o.columnIndexMapper.getRenderableFromVisualIndex(w):w)},I=f=>{const{row:m,col:w}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?o.columnIndexMapper.getVisualFromRenderableIndex(w):w)},H=(f,m)=>{const w=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.rowIndexMapper.getNearestNotHiddenIndex(f,w);return O===null||w===1&&O>R||w===-1&&O<C?null:O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O},V=(f,m)=>{const w=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.columnIndexMapper.getNearestNotHiddenIndex(f,w);return O===null||w===1&&O>R||w===-1&&O<C?null:O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O};let N=new G0(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:f=>a.propToCol(f),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(f,m)=>o._createCellCoords(f,m),createCellRange:(f,m,w)=>o._createCellRange(f,m,w),visualToRenderableCoords:M,renderableToVisualCoords:I,findFirstNonHiddenRenderableRow:H,findFirstNonHiddenRenderableColumn:V,isDisabledCellSelection:(f,m)=>f<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(f,m).disableVisualSelection});this.selection=N;const j=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",j),this.rowIndexMapper.addLocalHook("cacheUpdated",j),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const w=hr(!1),C=this.selection.getSelectedRange(),{from:R,to:O}=C.current(),P=C.size()-1;this.runHooks("afterSelection",R.row,R.col,O.row,O.col,w,P),this.runHooks("afterSelectionByProp",R.row,o.colToProp(R.col),O.row,o.colToProp(O.col),w,P),m&&(!w.isTouched()||w.isTouched()&&!w.value)&&d.scrollTo(f);const A=N.isSelectedByRowHeader(),Y=N.isSelectedByColumnHeader();A&&Y?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):A?(Ne(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):Y?(Ne(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]),N.getSelectionSource()!=="shift"&&c.closeEditor(null),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=hr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(f),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:w,to:C}=f[m];this.runHooks("afterSelectionEnd",w.row,w.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",w.row,o.colToProp(w.col),C.row,o.colToProp(C.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return n.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),u={alter(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;const O=P=>{if(P.length===0)return[];const A=[...P];return A.sort((B,x)=>{let[oe]=B,[$]=x;return oe===$?0:oe>$?1:-1}),co(A,(B,x)=>{let[oe,$]=x;const ee=B[B.length-1],[Ce,Ie]=ee,de=Ce+Ie;if(oe<=de){const fe=Math.max($-(de-oe),0);ee[1]+=fe}else B.push([oe,$]);return B},[A[0]])};switch(f){case"insert_row_below":case"insert_row_above":const P=o.countSourceRows();if(v.maxRows===P)return;const A=f==="insert_row_below"?"below":"above";m=m??(A==="below"?P:0);const{delta:Y,startPhysicalIndex:B}=a.createRow(m,w,{source:C,mode:A});N.shiftRows(o.toVisualRow(B),Y);break;case"insert_col_start":case"insert_col_end":const x=f==="insert_col_end"?"end":"start";m=m??(x==="end"?o.countSourceCols():0);const{delta:oe,startPhysicalIndex:$}=a.createCol(m,w,{source:C,mode:x});if(oe){if(Array.isArray(v.colHeaders)){const Ie=[o.toVisualColumn($),0];Ie.length+=oe,Array.prototype.splice.apply(v.colHeaders,Ie)}N.shiftColumns(o.toVisualColumn($),oe)}break;case"remove_row":const ee=Ie=>{let de=0;F(Ie,fe=>{let[re,_e]=fe;const Ue=Xi(re)?o.countRows()-1:Math.max(re-de,0);if(Number.isInteger(re)&&(re=Math.max(re-de,0)),!a.removeRow(re,_e,C))return;if(N.isSelected()){const{row:br}=o.getSelectedRangeLast().highlight;br>=re&&br<=re+_e-1&&c.closeEditor(!0)}const yr=o.countRows(),Ct=v.fixedRowsTop;Ct>=Ue+1&&(v.fixedRowsTop-=Math.min(_e,Ct-Ue));const St=v.fixedRowsBottom;St&&Ue>=yr-St&&(v.fixedRowsBottom-=Math.min(_e,St)),yr===0?N.deselect():C==="ContextMenu.removeRow"?N.refresh():N.shiftRows(re,-_e),de+=_e})};Array.isArray(m)?ee(O(m)):ee([[m,w]]);break;case"remove_col":const Ce=Ie=>{let de=0;F(Ie,fe=>{let[re,_e]=fe;const Ue=Xi(re)?o.countCols()-1:Math.max(re-de,0);let ht=o.toPhysicalColumn(Ue);if(Number.isInteger(re)&&(re=Math.max(re-de,0)),!a.removeCol(re,_e,C))return;if(N.isSelected()){const{col:br}=o.getSelectedRangeLast().highlight;br>=re&&br<=re+_e-1&&c.closeEditor(!0)}o.countCols()===0?N.deselect():C==="ContextMenu.removeColumn"?N.refresh():N.shiftColumns(re,-_e);const St=v.fixedColumnsStart;St>=Ue+1&&(v.fixedColumnsStart-=Math.min(_e,St-Ue)),Array.isArray(v.colHeaders)&&(typeof ht>"u"&&(ht=-1),v.colHeaders.splice(ht,_e)),de+=_e})};Array.isArray(m)?Ce(O(m)):Ce([[m,w]]);break;default:throw new Error(`There is no such action "${f}"`)}R||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const f=v.minRows,m=v.minSpareRows,w=v.minCols,C=v.minSpareCols;if(f){const R=o.countRows();R<f&&a.createRow(R,f-R,{source:"auto"})}if(m){const R=o.countEmptyRows(!0);if(R<m){const O=m-R,P=Math.min(O,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),P,{source:"auto"})}}{let R;(w||C)&&(R=o.countEmptyCols(!0));let O=o.countCols();if(w&&!v.columns&&O<w){const P=w-O;R+=P,a.createCol(O,P,{source:"auto"})}if(C&&!v.columns&&o.dataType==="array"&&R<C){O=o.countCols();const P=C-R,A=Math.min(P,v.maxCols-O);a.createCol(O,A,{source:"auto"})}}},populateFromArray(f,m,w,C,R){let O,P,A,Y;const B=[],x={},oe=[],$=f.row,ee=f.col;if(P=m.length,P===0)return!1;let Ce=0,Ie=0;switch(bt(w)&&(Ce=w.col-ee+1,Ie=w.row-$+1),R){case"shift_down":const de=zd(m),fe=de.length,re=Math.max(fe,Ce),_e=o.getData().slice($),Ue=zd(_e).slice(ee,ee+re);for(A=0;A<re;A+=1)if(A<fe){for(O=0,P=de[A].length;O<Ie-P;O+=1)de[A].push(de[A][O%P]);A<Ue.length?oe.push(de[A].concat(Ue[A])):oe.push(de[A].concat(new Array(_e.length).fill(null)))}else oe.push(de[A%fe].concat(Ue[A]));o.populateFromArray($,ee,zd(oe));break;case"shift_right":const ht=m.length,yr=Math.max(ht,Ie),Ct=o.getData().slice($).map(Ft=>Ft.slice(ee));for(O=0;O<yr;O+=1)if(O<ht){for(A=0,Y=m[O].length;A<Ce-Y;A+=1)m[O].push(m[O][A%Y]);if(O<Ct.length)for(let Ft=0;Ft<Ct[O].length;Ft+=1)m[O].push(Ct[O][Ft]);else m[O].push(...new Array(Ct[0].length).fill(null))}else m.push(m[O%P].slice(0,yr).concat(Ct[O]));o.populateFromArray($,ee,m);break;case"overwrite":default:x.row=f.row,x.col=f.col;let St=0,br=0,Zn=!0,Qn;const fo=function(Vt){let ir=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const En=m[Vt%m.length];return ir!==null?En[ir%En.length]:En},fs=m.length,Jn=w?w.row-f.row+1:0;for(w?P=Jn:P=Math.max(fs,Jn),O=0;O<P&&!(w&&x.row>w.row&&Jn>fs||!v.allowInsertRow&&x.row>o.countRows()-1||x.row>=v.maxRows);O++){const Ft=O-St,Vt=fo(Ft).length,ir=w?w.col-f.col+1:0;if(w?Y=ir:Y=Math.max(Vt,ir),x.col=f.col,Qn=o.getCellMeta(x.row,x.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Qn.skipRowOnPaste){St+=1,x.row+=1,P+=1;continue}for(br=0,A=0;A<Y&&!(w&&x.col>w.col&&ir>Vt||!v.allowInsertColumn&&x.col>o.countCols()-1||x.col>=v.maxCols);A++){if(Qn=o.getCellMeta(x.row,x.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Qn.skipColumnOnPaste){br+=1,x.col+=1,Y+=1;continue}if(Qn.readOnly&&C!=="UndoRedo.undo"){x.col+=1;continue}const En=A-br;let Wt=fo(Ft,En),Cr=o.getDataAtCell(x.row,x.col);if(Wt!==null&&typeof Wt=="object")if(Array.isArray(Wt)&&Cr===null&&(Cr=[]),Cr===null||typeof Cr!="object")Zn=!1;else{const Ri=ba(Array.isArray(Cr)?Cr:Cr[0]||Cr),Ti=ba(Array.isArray(Wt)?Wt:Wt[0]||Wt);$E(Ri,Ti)||Array.isArray(Ri)&&Array.isArray(Ti)?Wt=gr(Wt):Zn=!1}else Cr!==null&&typeof Cr=="object"&&(Zn=!1);Zn&&B.push([x.row,x.col,Wt]),Zn=!0,x.col+=1}x.row+=1}o.setDataAtCell(B,null,null,C||"populateFromArray");break}}};function z(f){const m=k_(f);Rp(m)?(o.runHooks("beforeLanguageChange",m),T.language=m,o.runHooks("afterLanguageChange",m)):L_(f)}function te(f,m){const w=f==="className"?o.rootElement:o.table;if(g)J(w,m);else{let C=[],R=[];T[f]&&(C=Array.isArray(T[f])?T[f]:Vb(T[f])),m&&(R=Array.isArray(m)?m:Vb(m));const O=Fb(C,R),P=Fb(R,C);O.length&&Ne(w,O),P.length&&J(w,P)}T[f]=m}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(Ui()||UE())&&J(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new AF(this);const f=v.themeName||zS(o.rootElement);o.useTheme(f),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),c=mg.getInstance(o,v,N),d=UB(o),h=new XD(o),jl(this)&&kB(o),o.runHooks("init"),this.render(),g&&o.rootElement.offsetParent===null&&iD(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function ue(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function G(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function Q(f,m,w){if(!f.length){w();return}const C=o.getActiveEditor(),R=new ue;let O=!0;R.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),w()};for(let P=f.length-1;P>=0;P--){const[A,Y]=f[P],B=a.propToCol(Y);let x;Number.isInteger(B)?x=o.getCellMeta(A,B):x={...Object.getPrototypeOf(v),...v},o.getCellValidator(x)&&(R.addValidatorToQueue(),o.validateCell(f[P][3],x,function(oe,$){return function(ee){if(typeof ee!="boolean")throw new Error("Validation error: result is not boolean");ee===!1&&$.allowInvalid===!1&&(O=!1,f.splice(oe,1),$.valid=!0),R.removeValidatorFormQueue()}}(P,x),m))}R.checkIfQueueIsEmpty()}function at(f,m){for(let C=f.length-1;C>=0;C--){let R=!1;if(f[C]===null){f.splice(C,1);continue}if(!((f[C][2]===null||f[C][2]===void 0)&&(f[C][3]===null||f[C][3]===void 0))){if(v.allowInsertRow)for(;f[C][0]>o.countRows()-1;){const{delta:O}=a.createRow(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(f[C][1])>o.countCols()-1;){const{delta:O}=a.createCol(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}R||a.set(f[C][0],f[C][1],f[C][3])}}if(f.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",f,m),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",f,m||"edit");const C=o.getActiveEditor();C&&me(C.refreshValue)&&C.refreshValue()}else o.render()}this._createCellCoords=function(f,m){return o.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,w){return o.view._wt.createCellRange(f,m,w)},this.validateCell=function(f,m,w,C){let R=o.getCellValidator(m);function O(P){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(P);return}const Y=m.visualCol,B=m.visualRow,x=o.getCell(B,Y,!0);if(x&&x.nodeName!=="TH"){const oe=o.rowIndexMapper.getRenderableFromVisualIndex(B),$=o.columnIndexMapper.getRenderableFromVisualIndex(Y);o.view._wt.getSetting("cellRenderer",oe,$,x)}w(P)}_A(R)&&(R=function(P){return function(A,Y){Y(P.test(A))}}(R)),Pe(R)?(f=o.runHooks("beforeValidate",f,m.visualRow,m.prop,C),o._registerImmediate(()=>{R.call(m,f,P=>{o&&(P=o.runHooks("afterValidate",P,f,m.visualRow,m.prop,C),m.valid=P,O(P),o.runHooks("postAfterValidate",P,f,m.visualRow,m.prop,C))})})):o._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function ae(f,m,w){return Array.isArray(f)?f:[[f,m,w]]}function be(f,m){const w=o.runHooks("beforeChange",f,m||"edit"),C=f.filter(O=>O!==null);if(w===!1||C.length===0){var R;return(R=o.getActiveEditor())===null||R===void 0||R.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[P,A,,Y]=C[O],B=a.propToCol(A);let x;Number.isInteger(B)?x=o.getCellMeta(P,B):x={...Object.getPrototypeOf(v),...v};const{type:oe,checkedTemplate:$,uncheckedTemplate:ee}=x;if(oe==="numeric"&&typeof Y=="string"&&cN(Y)&&(C[O][3]=G(Y)),oe==="checkbox"){const Ce=Yo(Y),Ie=Ce===Yo($),de=Ce===Yo(ee);(Ie||de)&&(C[O][3]=Ie?$:ee)}}return C}this.setDataAtCell=function(f,m,w,C){const R=ae(f,m,w),O=[];let P=C,A,Y,B;for(A=0,Y=R.length;A<Y;A++){if(typeof R[A]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[A][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[A][1]>=this.countCols()?B=R[A][1]:B=a.colToProp(R[A][1]),O.push([R[A][0],B,l.getAtCell(this.toPhysicalRow(R[A][0]),R[A][1]),R[A][2]])}!P&&typeof f=="object"&&(P=m);const x=be(O,P);o.runHooks("afterSetDataAtCell",x,P),Q(x,P,()=>{at(x,P)})},this.setDataAtRowProp=function(f,m,w,C){const R=ae(f,m,w),O=[];let P=C,A,Y;for(A=0,Y=R.length;A<Y;A++)O.push([R[A][0],R[A][1],l.getAtCell(this.toPhysicalRow(R[A][0]),R[A][1]),R[A][2]]);!P&&typeof f=="object"&&(P=m);const B=be(O,C);o.runHooks("afterSetDataAtRowProp",B,P),Q(B,P,()=>{at(B,P)})},this.listen=function(){o&&!o.isListening()&&(Df.forEach(f=>{o!==f&&f.unlisten()}),Af=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Af=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Af===o.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(f),o.view.render(),m&&N.isSelected()&&c.prepareEditor()},this.populateFromArray=function(f,m,w,C,R,O,P){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const A=typeof C=="number"?o._createCellCoords(C,R):null;return u.populateFromArray(o._createCellCoords(f,m),w,A,O,P)},this.spliceCol=function(f,m,w){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceCol(f,m,w,...R)},this.spliceRow=function(f,m,w){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceRow(f,m,w,...R)},this.getSelected=function(){if(N.isSelected())return yn(N.getSelectedRange(),f=>{let{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(N.isSelected())return Array.from(N.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!N.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];F(N.getSelectedRange(),w=>{if(w.isSingleHeader())return;const C=w.getTopStartCorner(),R=w.getBottomEndCorner();qe(C.row,R.row,O=>{qe(C.col,R.col,P=>{this.getCellMeta(O,P).readOnly||m.push([O,P,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=f();return this.resumeExecution(m),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const f=o.view,{width:m,height:w}=f.getLastSize(),{width:C,height:R}=o.rootElement.getBoundingClientRect(),O=C!==m||R!==w;o.runHooks("beforeRefreshDimensions",{width:m,height:w},{width:C,height:R},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===o.rootWindow)&&(f.setLastSize(C,R),o.render(),f.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:m,height:w},{width:C,height:R},O))},this.updateData=function(f,m){FS(f,w=>{a=w},w=>{a=w,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),N.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:E,firstRun:g})},this.loadData=function(f,m){FS(f,w=>{a=w},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),N.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:E,firstRun:g})},this.getInitialColumnCount=function(){const f=v.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Pe(f))if(o.dataType==="array"){const w=this.countSourceCols();for(let C=0;C<w;C+=1)f(C)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(me(v.dataSchema)){const w=a.getSchema();m=Array.isArray(w)?w.length:Pm(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,w,C){return Nt(f)?a.getAll():a.getRange(o._createCellCoords(f,m),o._createCellCoords(w,C),a.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,w,C){return a.getCopyableText(o._createCellCoords(f,m),o._createCellCoords(w,C))},this.getCopyableData=function(f,m){return a.getCopyable(f,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?o.loadData:o.updateData).bind(this);let C=!1,R,O;if(me(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(me(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(me(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');f.language&&z(f.language);for(R in f)if(!(R==="data"||R==="language"))if(R==="className")te("className",f.className);else if(R==="tableClassName"&&o.table)te("tableClassName",f.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ge.getSingleton().isRegistered(R)||ge.getSingleton().isDeprecated(R)){const x=f[R];Pe(x)?(ge.getSingleton().addAsFixed(R,x,o),v[R]=x):Array.isArray(x)&&(ge.getSingleton().add(R,x,o),v[R]=x)}else!m&&bn(f,R)&&(T[R]=f[R]);f.data===void 0&&v.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(a.createMap(),o.initIndexMappers());const P=o.countCols(),A=v.columns;if(A&&Pe(A)&&(C=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&E.clearCache(),P>0)for(R=0,O=0;R<P;R++){if(A){const x=C?A(R):A[O];x&&E.updateColumnMeta(O,x)}O+=1}me(f.cell)&&Me(f.cell,x=>{o.setCellMetaObject(x.row,x.col,x)}),o.runHooks("afterCellMetaReset");let Y=o.rootElement.style.height;Y!==""&&(Y=parseInt(o.rootElement.style.height,10));let B=f.height;if(Pe(B)&&(B=B()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),B===null){const x=o.rootElement.getAttribute("data-initialstyle");x&&(x.indexOf("height")>-1||x.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",x):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else B!==void 0&&(o.rootElement.style.height=isNaN(B)?`${B}`:`${B}px`,o.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let x=f.width;Pe(x)&&(x=x()),o.rootElement.style.width=isNaN(x)?`${x}`:`${x}px`}if(!m){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const x=o.getCurrentThemeName(),oe=bn(f,"themeName");x&&oe&&x!==f.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(x));const $=oe&&f.themeName||zS(o.rootElement);o.useTheme($),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",f)}u.adjustRowsAndCols(),o.view&&!g&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(Y===""||B===""||B===void 0)&&Y!==B&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=o.getSelectedLast();if(v.getValue){if(Pe(v.getValue))return v.getValue.call(o);if(f)return o.getData()[f[0][0]][v.getValue]}else if(f)return o.getDataAtCell(f[0],f[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,w,C,R){u.alter(f,m,w,C,R)},this.getCell=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,R=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return R===null||C===null||R===void 0||C===void 0?null:o.view.getCellAtCoords(o._createCellCoords(R,C),w)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:w,col:C}=m;let R=w,O=C;return w>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(w)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),o._createCellCoords(R,O)},this.colToProp=function(f){return a.colToProp(f)},this.propToCol=function(f){return a.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return a.get(f,a.colToProp(m))},this.getDataAtRowProp=function(f,m){return a.get(f,m)},this.getDataAtCol=function(f){const m=[],w=a.getRange(o._createCellCoords(0,f),o._createCellCoords(v.data.length-1,f),a.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let R=0;R<w[C].length;R+=1)m.push(w[C][R]);return m},this.getDataAtProp=function(f){const m=[],w=a.getRange(o._createCellCoords(0,a.propToCol(f)),o._createCellCoords(v.data.length-1,a.propToCol(f)),a.DESTINATION_RENDERER);for(let C=0;C<w.length;C+=1)for(let R=0;R<w[C].length;R+=1)m.push(w[C][R]);return m},this.getSourceData=function(f,m,w,C){let R;return f===void 0?R=l.getData():R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(w,C)),R},this.getSourceDataArray=function(f,m,w,C){let R;return f===void 0?R=l.getData(!0):R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(w,C),!0),R},this.getSourceDataAtCol=function(f){return l.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,w,C){const R=ae(f,m,w),O=this.hasHook("afterSetSourceDataAtCell"),P=[];O&&F(R,Y=>{let[B,x,oe]=Y;P.push([B,x,l.getAtCell(B,x),oe])}),F(R,Y=>{let[B,x,oe]=Y;l.setAtCell(B,x,oe)}),O&&this.runHooks("afterSetSourceDataAtCell",P,C),this.render();const A=o.getActiveEditor();A&&me(A.refreshValue)&&A.refreshValue()},this.getSourceDataAtRow=function(f){return l.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return l.getAtCell(f,m)},this.getDataAtRow=function(f){return a.getRange(o._createCellCoords(f,0),o._createCellCoords(f,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,w,C){const R=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,w,C],[O,P]=R;let[,,A,Y]=R,B=null,x=null;A===void 0&&(A=O),Y===void 0&&(Y=P);let oe="mixed";return qe(Math.max(Math.min(O,A),0),Math.max(O,A),$=>{let ee=!0;return qe(Math.max(Math.min(P,Y),0),Math.max(P,Y),Ce=>(x=this.getCellMeta($,Ce).type,B?ee=B===x:B=x,ee)),oe=ee?x:"mixed",ee}),oe},this.removeCellMeta=function(f,m,w){const[C,R]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=E.getCellMetaKeyValue(C,R,w);o.runHooks("beforeRemoveCellMeta",f,m,w,O)!==!1&&(E.removeCellMeta(C,R,w),o.runHooks("afterRemoveCellMeta",f,m,w,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,C=new Array(w>2?w-2:0),R=2;R<w;R++)C[R-2]=arguments[R];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(f),m),C.length>0&&F(C.reverse(),O=>{E.createRow(this.toPhysicalRow(f)),F(O,(P,A)=>this.setCellMetaObject(f,A,P))}),o.render()},this.setCellMetaObject=function(f,m,w){typeof w=="object"&&Me(w,(C,R)=>{this.setCellMeta(f,m,R,C)})},this.setCellMeta=function(f,m,w,C){if(o.runHooks("beforeSetCellMeta",f,m,w,C)===!1)return;let O=f,P=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(P=this.toPhysicalColumn(m)),E.setCellMeta(O,P,w,C),o.runHooks("afterSetCellMeta",f,m,w,C)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(f),R=this.toPhysicalColumn(m);return C===null&&(C=f),R===null&&(R=m),E.getCellMeta(C,R,{visualRow:f,visualColumn:m,...w})},this.getColumnMeta=function(f){return E.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return E.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(f,m){const w=typeof f=="number"?o.getCellMeta(f,m).renderer:f.renderer;return typeof w=="string"?xC(w):Nt(w)?xC("text"):w},this.getCellEditor=function(f,m){const w=typeof f=="number"?o.getCellMeta(f,m).editor:f.editor;return typeof w=="string"?dC(w):Nt(w)?dC("text"):w},this.getCellValidator=function(f,m){const w=typeof f=="number"?o.getCellMeta(f,m).validator:f.validator;return typeof w=="string"?IN(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,w){const C=new ue;f&&(C.onQueueEmpty=f);let R=o.countRows()-1;for(;R>=0;){if(m!==void 0&&m.indexOf(R)===-1){R-=1;continue}let O=o.countCols()-1;for(;O>=0;){if(w!==void 0&&w.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),o.validateCell(o.getDataAtCell(R,O),o.getCellMeta(R,O),P=>{if(typeof P!="boolean")throw new Error("Validation error: result is not boolean");P===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}R-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=v.rowHeaders,w=f;return w!==void 0&&(w=o.runHooks("modifyRowHeader",w)),w===void 0?(m=[],qe(o.countRows()-1,C=>{m.push(o.getRowHeader(C))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Pe(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let f=0,m=o.countCols();f<m;f++)if(o.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=o.runHooks("modifyColHeader",f);if(w===void 0){const A=[],Y=o.countCols();for(let B=0;B<Y;B++)A.push(o.getColHeader(B));return A}let C=v.colHeaders;const R=function(A){const Y=[],B=o.countCols();let x=0;for(;x<B;x++)Pe(v.columns)&&v.columns(x)&&Y.push(x);return Y[A]},O=o.toPhysicalColumn(w),P=R(O);return v.colHeaders===!1?C=null:v.columns&&Pe(v.columns)&&v.columns(P)&&v.columns(P).title?C=v.columns(P).title:v.columns&&v.columns[O]&&v.columns[O].title?C=v.columns[O].title:Array.isArray(v.colHeaders)&&v.colHeaders[O]!==void 0?C=v.colHeaders[O]:Pe(v.colHeaders)?C=v.colHeaders(O):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(C=VF(w)),C=o.runHooks("modifyColumnHeaderValue",C,f,m),C},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=o.getCellMeta(0,f).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let w=o._getColWidthFromSettings(f);return w=o.runHooks("modifyColWidth",w,f,m),w===void 0&&(w=Nm),w},this._getRowHeightFromSettings=function(f){const m=this.view.getDefaultRowHeight();let w=v.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[f];break;case"function":w=w(f);break}typeof w=="string"&&(w=parseInt(w,10))}return w!=null&&w<m?m:w},this.getRowHeight=function(f,m){let w=o._getRowHeightFromSettings(f);return w=o.runHooks("modifyRowHeight",w,f,m),w},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const f=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return IC(o.countRows()-1,w=>{if(o.isEmptyRow(w))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return IC(o.countCols()-1,w=>{if(o.isEmptyCol(w))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return v.isEmptyRow.call(o,f)},this.isEmptyCol=function(f){return v.isEmptyCol.call(o,f)},this.selectCell=function(f,m,w,C){let R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Nt(f)||Nt(m)?!1:this.selectCells([[f,m,w,C]],R,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const C=N.selectCells(f);return C&&w&&o.listen(),d.resume(),C},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return N.selectColumns(f,m,w)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return N.selectRows(f,m,w)},this.deselectCell=function(){N.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),N.selectAll(f,m,w)};const Ge=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:C,col:R,considerHiddenIndexes:O}=f??{};let P=C,A=R;if(Pe(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const oe=Number.isInteger(C)&&C>=0,$=Number.isInteger(R)&&R>=0,ee=oe?Ge(this.rowIndexMapper,C):void 0,Ce=$?Ge(this.columnIndexMapper,R):void 0;if(ee===null||Ce===null)return!1;P=oe?o.rowIndexMapper.getRenderableFromVisualIndex(ee):C,A=$?o.columnIndexMapper.getRenderableFromVisualIndex(Ce):R}const Y=Number.isInteger(P),B=Number.isInteger(A);let x=!1;return Y&&P>=0&&B&&A>=0?x=o.view.scrollViewport(o._createCellCoords(P,A),f.horizontalSnap,f.verticalSnap):Y&&P>=0&&(B&&A<0||!B)?x=o.view.scrollViewportVertically(P,f.verticalSnap):B&&A>=0&&(Y&&P<0||!Y)&&(x=o.view.scrollViewportHorizontally(A,f.horizontalSnap)),Pe(m)&&(x?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),x},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Pe(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast(),w=this.scrollViewportTo(m.toObject());return w?this.view.render():Pe(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),w},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),E.clearCache(),Df.delete(this.guid),jl(o)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}Xo(o.rootElement),s.destroy(),c&&c.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(f=>{let[,m]=f;m.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(o),Me(o,(f,m,w)=>{Pe(f)?w[m]=vr(m):m!=="guid"&&(w[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,N=null,c=null,o=null};function vr(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return _.getItem(Au(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(f)},this.getInstance=function(){return o},this.addHook=function(f,m,w){ge.getSingleton().add(f,m,o,w)},this.hasHook=function(f){return ge.getSingleton().has(f,o)||ge.getSingleton().has(f)},this.addHookOnce=function(f,m,w){ge.getSingleton().once(f,m,o,w)},this.removeHook=function(f,m){ge.getSingleton().remove(f,m,o)},this.runHooks=function(f,m,w,C,R,O,P){return ge.getSingleton().run(o,f,m,w,C,R,O,P)},this.getTranslatedPhrase=function(f,m){return j0(v.language,f,m)},this.toHTML=()=>OC(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",OC(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{this.view.getStylesHandler().useTheme(f),this.runHooks("afterSetTheme",f,!!g)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){F(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){F(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return c};const Ee=ZB({handleEvent(){return o.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&Ee.releasePressedKeys()}),this.getShortcutManager=function(){return Ee},this.getFocusManager=function(){return h},r_().forEach(f=>{const m=Dm(f);_.addItem(f,new m(this))}),DB(o),Ee.setActiveContextName("grid"),ge.getSingleton().run(o,"construct")}function US(t,e,r){t.addEventListener(e,r,!1)}function YS(t,e,r){t.removeEventListener(e,r,!1)}function Sl(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function QB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=Sl(s).fontSize,o.style.fontFamily=Sl(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=Sl(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((d=Sl(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),y=o.clientWidth+g+p+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>y?b.width=`${r.minWidth}px`:y>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${y}px`;const E=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>E?b.height=`${r.minHeight}px`:r.maxHeight<E?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(US(s,"input",a),US(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){YS(s,"input",a),YS(s,"keydown",l)}}}function qS(t,e){const r=eD(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}kE(e,i)}function Ni(t,e,r){return(e=JB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JB(t){var e=e$(t,"string");return typeof e=="symbol"?e:e+""}function e$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t$="ht_editor_visible",Rl="ht_editor_hidden",GS="textEditor",r$="text";class n$ extends _p{static get EDITOR_TYPE(){return r$}constructor(e){super(e),Ni(this,"eventManager",new vi(this)),Ni(this,"autoResize",QB(this.hot.rootDocument)),Ni(this,"TEXTAREA",void 0),Ni(this,"textareaStyle",void 0),Ni(this,"TEXTAREA_PARENT",void 0),Ni(this,"textareaParentStyle",void 0),Ni(this,"layerClass",void 0),this.eventManager=new vi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Bl(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==it.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===it.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),kE(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Oe(this.TEXTAREA,[["data-hot-input",""],ho(-1)]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),we(this.TEXTAREA_PARENT,this.layerClass)&&Ne(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Rl),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){vD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ne(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Rl)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;qe(e.length-1,n=>{const i=e[n];if(we(i,"handsontableEditor"))return r=!0,!1}),we(this.TEXTAREA_PARENT,Rl)&&Ne(this.TEXTAREA_PARENT,Rl),r?(this.layerClass=t$,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==it.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){zE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===it.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===it.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>me(this.hot.getSelected()),group:GS},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;qS(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;qS(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(GS)}}const i$="base";function oO(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&J(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(zb())):a&&c.push(zb()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(Ub())):(u.push(s.invalidCellClassName),a&&c.push(Ub()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Ne(e,u),J(e,l),Na(e,c),Oe(e,h)}oO.RENDERER_TYPE=i$;const o$="text";function sO(t,e,r,n,i,o,s){oO.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Yo(a),s.trimWhitespace&&(a=a.trim()),ka(e,a)}sO.RENDERER_TYPE=o$;const s$="text",a$={CELL_TYPE:s$,editor:n$,renderer:sO};aW(a$);rn.editors={BaseEditor:_p};function rn(t,e){const r=new iO(t,e||{},Zm);return r.init(),r}rn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new iO(t,e,Zm)};rn.DefaultSettings=X0();rn.hooks=ge.getSingleton();rn.CellCoords=Zi;rn.CellRange=Fa;rn.packageName="handsontable";rn.buildDate="24/04/2025 10:59:00";rn.version="15.3.0";rn.languages={dictionaryKeys:bV,getLanguageDictionary:$0,getLanguagesDictionaries:EV,registerLanguageDictionary:B0,getTranslatedPhrase:j0};function l$(t,e){aO(t,e),e.add(t)}function u$(t,e,r){aO(t,e),e.set(t,r)}function aO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mo(t,e,r){return(e=c$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c$(t){var e=h$(t,"string");return typeof e=="symbol"?e:e+""}function h$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Io(t,e){return t.get(lO(t,e))}function lO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const KS=new Map([["plugin",CN],["cell-type",K0],["editor",KE],["renderer",n_],["validator",i_]]),d$=Symbol("mainSetting"),f$="base",Tl=[];let ki=null;var Li=new WeakMap,XS=new WeakSet;class Yu{static get PLUGIN_KEY(){return f$}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){l$(this,XS),Mo(this,"eventManager",new vi(this)),Mo(this,"pluginName",null),Mo(this,"pluginsInitializedCallbacks",[]),Mo(this,"isPluginsReady",!1),Mo(this,"enabled",!1),Mo(this,"initialized",!1),u$(this,Li,{}),Kn(this,"hot",e,{writable:!1}),ki=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!KS.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);KS.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Tl.push(o)}}if(ki||(ki=r_()),ki.indexOf(this.pluginName)>=0&&ki.splice(ki.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ki.length===0){if(Tl.length>0){const i=[`${Tl.join(`
`)}
`,"You have to import and register them manually."].join("");throw Tl.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||bt(r))&&n[d$]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(bt(r)){var o;return(o=r[e])!==null&&o!==void 0?o:n[e]}return n[e]}addHook(e,r,n){Io(Li,this)[e]=Io(Li,this)[e]||[];const i=Io(Li,this)[e];this.hot.addHook(e,r,n),i.push(r),Io(Li,this)[e]=i}removeHooks(e){F(Io(Li,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Io(Li,this);Me(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){F(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=lO(XS,this,g$).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Me(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function g$(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Fi(t,e,r){return(e=m$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m$(t){var e=p$(t,"string");return typeof e=="symbol"?e:e+""}function p$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w${constructor(e){Fi(this,"hot",null),Fi(this,"container",null),Fi(this,"injected",!1),Fi(this,"rows",[]),Fi(this,"columns",[]),Fi(this,"samples",null),Fi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&J(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),F(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),F(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{F(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{F(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{F(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),F(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{F(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),J(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return J(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function El(t,e,r){return(e=v$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v$(t){var e=y$(t,"string");return typeof e=="symbol"?e:e+""}function y$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Op{static get SAMPLE_COUNT(){return 3}constructor(e){El(this,"samples",null),El(this,"dataFactory",null),El(this,"customSampleCount",null),El(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Op.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return qe(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return qe(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:bt(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Yo(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function b$(t,e){uO(t,e),e.add(t)}function Nf(t,e,r){uO(t,e),e.set(t,r)}function uO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(t,e,r){return(e=C$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C$(t){var e=S$(t,"string");return typeof e=="symbol"?e:e+""}function S$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fi(t,e){return t.get(Xt(t,e))}function fu(t,e,r){return t.set(Xt(t,e),r),r}function Xt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("modifyAutoColumnSizeSeed");const kf="autoColumnSize",R$=10,T$="autoColumnSize";var Mp=new WeakMap,Vo=new WeakMap,Zo=new WeakMap,ur=new WeakSet;class da extends Yu{static get PLUGIN_KEY(){return kf}static get PLUGIN_PRIORITY(){return R$}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),b$(this,ur),$s(this,"ghostTable",new w$(this.hot)),$s(this,"samplesGenerator",new Op((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),$s(this,"inProgress",!1),$s(this,"measuredColumns",0),$s(this,"columnWidthsMap",new Wu),Nf(this,Mp,!1),Nf(this,Vo,[]),Nf(this,Zo,[]),this.hot.columnIndexMapper.registerMap(T$,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>Xt(ur,this,ZS).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[kf]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xt(ur,e,O$).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xt(ur,e,M$).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Xt(ur,e,P$).call(e,...i)}),this.addHook("beforeRender",()=>Xt(ur,this,_$).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>Xt(ur,this,I$).call(this)),super.enablePlugin()}updatePlugin(){fu(Zo,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>Xt(ur,this,ZS).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;qe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Xt(ur,this,cO).call(this,s,o)}),this.ghostTable.columns.length&&(Xt(ur,this,hO).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){Zb(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+da.CALCULATION_STEP,i)},e,r),n=n+da.CALCULATION_STEP+1,n<i?o=fg(s):(Zb(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[kf];let r=da.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return bt(e)&&(r=e.syncLimit,xA(r)?r=hN(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Nm))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=fi(Vo,this).length;return(s-1<o||fi(Vo,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?fi(Vo,this).push(i):fi(Vo,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function E$(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||Xt(ur,this,cO).call(this,r,e))}),this.ghostTable.columns.length&&(Xt(ur,this,hO).call(this),this.ghostTable.clean())}function cO(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function hO(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function _$(){this.calculateVisibleColumnsWidth(),this.inProgress||(Xt(ur,this,E$).call(this,fi(Zo,this)),fu(Zo,this,[]))}function O$(t,e){e||this.recalculateAllColumnsWidth()}function M$(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);fi(Zo,this).push(...e)}function ZS(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function I$(){fu(Vo,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),fu(Mp,this,!0)}function P$(t){if(!fi(Mp,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);fi(Zo,this).push(...e)}function x$(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function H$(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Vi(t,e){const r={};return F(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function ai(t,e,r,n,i){F(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&A$(s,a,e,r,n,i)})})}function A$(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=x$(s.className,n):a=H$(s.className,n)),o(t,e,"className",a)}function D$(t){return`<span class="selected">✓</span>${t}`}function Lf(t,e){let r=!1;return Array.isArray(t)&&F(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function dO(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const yt="---------";function N$(){return{name:yt}}const qr="alignment";function k$(){return{key:qr,name(){return this.getTranslatedPhrase(gp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${qr}:left`,name(){return this.getTranslatedPhrase(mp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:center`,name(){return this.getTranslatedPhrase(pp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:right`,name(){return this.getTranslatedPhrase(wp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:justify`,name(){return this.getTranslatedPhrase(vp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:yt},{key:`${qr}:top`,name(){return this.getTranslatedPhrase(yp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:middle`,name(){return this.getTranslatedPhrase(bp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${qr}:bottom`,name(){return this.getTranslatedPhrase(Cp)},callback(){const t=this.getSelectedRange(),e=Vi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Ip="clear_column";function L$(){return{key:Ip,name(){return this.getTranslatedPhrase(lp)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const qu="col_left";function F$(){return{key:qu,name(){return this.getTranslatedPhrase(rp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Gu="col_right";function V$(){return{key:Gu,name(){return this.getTranslatedPhrase(np)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Ku="make_read_only";function W$(){return{key:Ku,checkable:!0,ariaChecked(){return Lf(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(hu)},name(){let t=this.getTranslatedPhrase(hu);return Lf(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=D$(t)),t},callback(){const t=this.getSelectedRange(),e=Lf(t,(r,n)=>this.getCellMeta(r,n).readOnly);F(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Xu="redo";function B$(){return{key:Xu,name(){return this.getTranslatedPhrase(ap)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Zu="remove_col";function $$(){return{key:Zu,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(op,e)},callback(){this.alter("remove_col",KV(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Qu="remove_row";function j$(){return{key:Qu,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(ip,e)},callback(){this.alter("remove_row",XV(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Ju="row_above";function z$(){return{key:Ju,name(){return this.getTranslatedPhrase(ep)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const ec="row_below";function U$(){return{key:ec,name(){return this.getTranslatedPhrase(tp)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Sa="no_items";function Y$(){return{key:Sa,name(){return this.getTranslatedPhrase(Jm)},disabled:!0,isCommand:!1}}const tc="undo";function q$(){return{key:tc,name(){return this.getTranslatedPhrase(sp)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const G$=[Ju,ec,qu,Gu,Ip,Qu,Zu,tc,Xu,Ku,qr,yt,Sa],K$={[yt]:N$,[Sa]:Y$,[Ju]:z$,[ec]:U$,[qu]:F$,[Gu]:V$,[Ip]:L$,[Qu]:j$,[Zu]:$$,[tc]:q$,[Xu]:B$,[Ku]:W$,[qr]:k$};function fO(){const t={};return Me(K$,(e,r)=>{t[r]=e()}),t}function Ff(t,e,r){return(e=X$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X$(t){var e=Z$(t,"string");return typeof e=="symbol"?e:e+""}function Z$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q${constructor(e){Ff(this,"hot",void 0),Ff(this,"commands",{}),Ff(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=J$(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||bn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),F(u,c=>c.apply(this.hot,n))}}function J$(t,e){let r;return F(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function Vf(t,e,r){return(e=ej(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ej(t){var e=tj(t,"string");return typeof e=="symbol"?e:e+""}function tj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rj{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Vf(this,"hot",void 0),Vf(this,"predefinedItems",fO()),Vf(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Me(e,(n,i)=>{let o="";n.name===yt?(r[yt]=n,o=yt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nj(e,this.defaultOrderPattern,this.predefinedItems)}}function nj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),bt(i)?Me(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),bt(o)?wi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):F(i,(o,s)=>{let a=r[o];!a&&G$.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),bt(o)&&wi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function ni(t,e,r){return(e=ij(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ij(t){var e=oj(t,"string");return typeof e=="symbol"?e:e+""}function oj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sj{constructor(e,r){ni(this,"top",void 0),ni(this,"topRelative",void 0),ni(this,"left",void 0),ni(this,"leftRelative",void 0),ni(this,"scrollTop",void 0),ni(this,"scrollLeft",void 0),ni(this,"cellHeight",void 0),ni(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function js(t,e,r){aj(t,e),e.set(t,r)}function aj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e){return t.get(gO(t,e))}function _l(t,e,r){return t.set(gO(t,e),r),r}function gO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ht=new WeakMap,Ut=new WeakMap,Yt=new WeakMap,Wf=new WeakMap,Po=new WeakMap;class lj{constructor(e){js(this,Ht,void 0),js(this,Ut,void 0),js(this,Yt,void 0),js(this,Wf,!1),js(this,Po,{above:0,below:0,left:0,right:0}),_l(Wf,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ie(Po,this)[e]=r,this}setElement(e){return _l(Ht,this,e),this}setParentElement(e){return _l(Ut,this,e),this}updatePosition(e){_l(Yt,this,new sj(e,ie(Ht,this).ownerDocument.defaultView)),ie(Wf,this)?(ie(Yt,this).fitsBelow(ie(Ht,this))?this.setPositionBelowCursor():ie(Yt,this).fitsAbove(ie(Ht,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ie(Ht,this).dir==="rtl"?ie(Yt,this).fitsOnLeft(ie(Ht,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ie(Yt,this).fitsOnRight(ie(Ht,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ie(Po,this).above+ie(Yt,this).top-ie(Ht,this).offsetHeight;if(ie(Ut,this)){const n=ie(Ut,this).ownerDocument.defaultView.getComputedStyle(ie(Ut,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Yt,this).top+ie(Yt,this).cellHeight-ie(Ht,this).scrollHeight+i+o}ie(Ht,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ie(Po,this).below+ie(Yt,this).top+1;if(ie(Ut,this)){const n=ie(Ut,this).ownerDocument.defaultView.getComputedStyle(ie(Ut,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Yt,this).top-i-o-1}ie(Ht,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ie(Yt,this).left;if(ie(Ut,this)){const r=ie(Ut,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Ut,this).querySelector(".htCore")).borderRightWidth,10);e+=ie(Yt,this).cellWidth+n}else e+=ie(Po,this).right;ie(Ht,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ie(Po,this).left+ie(Yt,this).left-ie(Ht,this).offsetWidth;if(ie(Ut,this)){const r=ie(Ut,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Ut,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ie(Ht,this).style.left=`${e}px`}}function uj(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=He(e,-1,p()-1);function a(b,E){const v=p()-1;return b<0&&(b=v),b>v&&(b=0),o.has(b)?-1:(o.add(b),n(b,!1)===!1&&(b=a(E===1?++b:--b,E)),b)}function l(b){b>-1&&b<p()&&n(b,!0)!==!1&&(s=b)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function d(){p()>0&&(o.clear(),s=a(++s,1))}function g(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(r(),0)}function y(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:g,getSize:p,clear:y}}function cj(t){return yn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Eg(t){return bn(t,"submenu")}function _g(t){return new RegExp(yt,"i").test(t.name)}function Yl(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function QS(t){return bn(t,"disableSelection")}function hj(t){return we(t,"htSeparator")}function dj(t){return we(t,"htSubmenu")}function fj(t){return we(t,"htDisabled")}function gj(t){return we(t,"htSelectionDisabled")}function mj(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function mO(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function pj(t,e){let r=t.slice(0);return r.reverse(),r=mO(r,e),r.reverse(),r}function wj(t){const e=[];return F(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function vj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yt,r=t.slice(0);return r=mO(r,e),r=pj(r,e),r=wj(r),r}function yj(t){return t.checkable===!0}function bj(t){return uj({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||hj(n)||fj(n)||gj(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Cj(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const pO="menu",JS=pO;function Sj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Cj(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:pO})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(p=>h.removeShortcutsByKeys(p))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${JS}:${u}`:JS}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Rj(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Xo(r),J(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Yl(a,t)&&!QS(a)&&!_g(a);Oe(r,[...yj(a)?[VA(),hg(c),UA(h)]:[FA(),hg(u)],...d?[ho(-1)]:[],...Yl(a,t)?[jA()]:[],...Eg(a)?[Wl(!1)]:[]])}r.className="",r.appendChild(l),_g(a)?J(r,"htSeparator"):typeof a.renderer=="function"?(J(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):HE(l,u),Yl(a,t)?J(r,"htDisabled"):QS(a)?J(r,"htSelectionDisabled"):Eg(a)&&J(r,"htSubmenu")}}function Bf(t,e,r){Tj(t,e),e.set(t,r)}function Tj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cn(t,e,r){return(e=Ej(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ej(t){var e=_j(t,"string");return typeof e=="symbol"?e:e+""}function _j(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $f(t,e,r){return t.set(wO(t,e),r),r}function Wi(t,e){return t.get(wO(t,e))}function wO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const eR=215;var zs=new WeakMap,Ol=new WeakMap,Ml=new WeakMap;class rc{get tableBorderWidth(){return Wi(Ml,this)===void 0&&this.hotMenu&&$f(Ml,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Wi(Ml,this)}constructor(e,r){var n=this;cn(this,"hot",void 0),cn(this,"options",void 0),cn(this,"eventManager",new vi(this)),cn(this,"container",void 0),cn(this,"positioner",void 0),cn(this,"hotMenu",null),cn(this,"hotSubMenus",{}),cn(this,"parentMenu",void 0),cn(this,"menuItems",null),cn(this,"origOutsideClickDeselects",null),Bf(this,zs,void 0),Bf(this,Ol,void 0),Bf(this,Ml,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:eR,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new lj(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{if(!o){var s;(s=this.hotMenu)===null||s===void 0||s.useTheme(i)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=va(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Wi(zs,this)}getKeyboardShortcutsCtrl(){return Wi(Ol,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=WE(a=>this.openSubMenu(a),300),r=this.options.minWidth||eR;let n=!1,i=Em(this.menuItems,a=>(a.key===Sa&&(n=!0),mj(a,this.hot)));if(i.length<1&&!n)i.push(fO()[Sa]);else if(i.length===0)return;i=vj(i,yt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return me(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Rj(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{Wi(zs,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Qb()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Qb()||!lu(a))&&o&&this.hasSelectedItem()&&(Ui()||UE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),$f(zs,this,bj(this.hotMenu)),$f(Ol,this,Sj(this)),Wi(Ol,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Wi(zs,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Oe(n,[Wl(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!dj(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new rc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Oe(r,[Wl(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Oe(i,[Wl(!1)])}}closeAllSubMenus(){F(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?cj(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||_g(e)||Yl(e,this.hot)||Eg(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:r}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=r.hider.style,o=r.holder.style,s=parseInt(i.width,10),a=co(n,(l,u,c)=>{const d=this.hotMenu.getCell(c,0)?tr(this.hotMenu.getCell(c,0)):0;return l+(u.name===yt?1:d)},0);e.isClassicTheme()?(o.width=`${s+3}px`,o.height=`${a+3}px`):(o.width=`${s}px`,o.height=`${a}px`),i.height=o.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Pe(n)&&(n=n.call(this.hot),n===null||Nt(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),J(i,`htMenu handsontable ${this.options.className}`),n&&J(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Oe(this.hotMenu.rootElement,[LA(),ho(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!qo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!qo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&we(e.target,"htCore")&&qo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Ke(rc,Tn);function Oj(t,e){Mj(t,e),e.add(t)}function Mj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jf(t,e,r){return(e=Ij(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ij(t){var e=Pj(t,"string");return typeof e=="symbol"?e:e+""}function Pj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Il(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ra="contextMenu",xj=70,tR=ra;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var Us=new WeakSet;class nc extends Yu{constructor(){super(...arguments),Oj(this,Us),jf(this,"commandExecutor",new Q$(this.hot)),jf(this,"itemsFactory",null),jf(this,"menu",null)}static get PLUGIN_KEY(){return ra}static get PLUGIN_PRIORITY(){return xj}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ju,ec,yt,qu,Gu,yt,Qu,Zu,yt,tc,Xu,yt,Ku,yt,qr]}isEnabled(){return!!this.hot.getSettings()[ra]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[ra];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new rc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Il(Us,this,Aj).call(this)),this.menu.addLocalHook("afterOpen",()=>Il(Us,this,Dj).call(this)),this.menu.addLocalHook("afterClose",()=>Il(Us,this,Nj).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Il(Us,this,Hj).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=dO(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:tR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tR)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Me(n,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new rj(this.hot,nc.DEFAULT_ITEMS);const e=this.hot.getSettings()[ra],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),F(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Hj(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),we(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(we(o,"current")&&we(o,"wtBorder"))))return;const s=dO(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Aj(){this.hot.runHooks("beforeContextMenuShow",this)}function Dj(){this.hot.runHooks("afterContextMenuShow",this)}function Nj(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}nc.SEPARATOR={name:yt};function kj(t){return{key:"copy",name(){return this.getTranslatedPhrase(up)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Lj(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(dp,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Fj(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(hp,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Vj(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?He(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(cp,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Wj(t){return{key:"cut",name(){return this.getTranslatedPhrase(fp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class Bj{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class $j{constructor(){this.clipboardData=new Bj}preventDefault(){}composedPath(){return[]}}function jj(t,e){vO(t,e),e.add(t)}function xo(t,e,r){vO(t,e),e.set(t,r)}function vO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get($o(t,e))}function Ho(t,e,r){return t.set($o(t,e),r),r}function $o(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ii=new WeakMap,zf=new WeakMap,Ys=new WeakMap,Og=new WeakMap,Mg=new WeakMap,qs=new WeakMap,Gs=new WeakSet;class zj{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;jj(this,Gs),xo(this,ii,void 0),xo(this,zf,void 0),xo(this,Ys,void 0),xo(this,Og,void 0),xo(this,Mg,void 0),xo(this,qs,void 0),Ho(zf,this,r),Ho(Ys,this,n),Ho(Og,this,i),Ho(Mg,this,o),Ho(qs,this,s)}setSelectedRange(e){Ho(ii,this,e)}getCellsRange(){if(At(zf,this).call(this)===0||At(Ys,this).call(this)===0)return null;const{row:e,col:r}=At(ii,this).getTopStartCorner(),{row:n,col:i}=At(ii,this).getBottomEndCorner(),o=$o(Gs,this,Uj).call(this,e,n),s=$o(Gs,this,Uf).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(At(Ys,this).call(this)===0||At(qs,this).call(this)===0)return null;const{col:e}=At(ii,this).getTopStartCorner(),{col:r}=At(ii,this).getBottomEndCorner(),n=$o(Gs,this,Uf).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(At(Ys,this).call(this)===0||At(qs,this).call(this)===0)return null;const{col:e}=At(ii,this).getTopStartCorner(),{col:r}=At(ii,this).getBottomEndCorner(),n=$o(Gs,this,Uf).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-At(qs,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Uf(t,e){return Math.min(e,Math.max(t+At(Mg,this).call(this)-1,t))}function Uj(t,e){return Math.min(e,Math.max(t+At(Og,this).call(this)-1,t))}function yO(t){const e=[],r=[];return F(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);qe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);qe(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function Yj(t,e){bO(t,e),e.add(t)}function oi(t,e,r){bO(t,e),e.set(t,r)}function bO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(t,e,r){return(e=qj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qj(t){var e=Gj(t,"string");return typeof e=="symbol"?e:e+""}function Gj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kt(t,e){return t.get(Zt(t,e))}function Ur(t,e,r){return t.set(Zt(t,e),r),r}function Zt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");const Yf="copyPaste",Kj=80,Xj=["fragmentSelection"],rR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Ig=new WeakMap,Pg=new WeakMap,xg=new WeakMap,Ao=new WeakMap,Pl=new WeakMap,xl=new WeakMap,Do=new WeakMap,gu=new WeakMap,cr=new WeakSet;class Zj extends Yu{constructor(){super(...arguments),Yj(this,cr),Ks(this,"columnsLimit",1/0),Ks(this,"rowsLimit",1/0),Ks(this,"pasteMode","overwrite"),Ks(this,"uiContainer",this.hot.rootDocument.body),oi(this,Ig,!1),oi(this,Pg,!1),oi(this,xg,!1),oi(this,Ao,"cells-only"),oi(this,Pl,!1),oi(this,xl,!1),oi(this,Do,new zj({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oi(this,gu,!1),Ks(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Yf}static get SETTING_KEYS(){return[Yf,...Xj]}static get PLUGIN_PRIORITY(){return Kj}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Yf]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Ur(Ig,this,this.getSetting("copyColumnHeaders")),Ur(Pg,this,this.getSetting("copyColumnGroupHeaders")),Ur(xg,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Zt(cr,this,ez).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zt(cr,n,tz).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Zt(cr,this,rz).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),jE()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zt(cr,n,nz).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Zt(cr,n,iz).call(n,...o)}),this.addHook("afterSelection",()=>Zt(cr,this,oz).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ur(Ao,this,e),Ur(Pl,this,!0),Zt(cr,this,nR).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ur(xl,this,!0),Zt(cr,this,nR).call(this,"cut")}getRangedCopyableData(e){return ha(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=yO(e);return F(n,o=>{const s=[];F(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),r.push(s)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new $j;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Kt(Do,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Kt(Ao,this)==="column-headers-only"?r.set("headers",Kt(Do,this).getMostBottomColumnHeadersRange()):(Kt(Ao,this)==="with-column-headers"?r.set("headers",Kt(Do,this).getMostBottomColumnHeadersRange()):Kt(Ao,this)==="with-column-group-headers"&&r.set("headers",Kt(Do,this).getAllColumnHeadersRange()),r.set("cells",Kt(Do,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,o=[],{row:s,col:a}=r.getTopStartCorner(),{row:l,col:u}=r.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<n||c<=l;){const{skipRowOnPaste:p,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,p===!0)continue;d=y,h=a;const b=[],E=o.length%n;for(;b.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,v===!0)continue;g=T;const _=b.length%i;b.push(e[E][_])}o.push(b)}return Ur(gu,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Kt(Pl,this)||this.isEditorOpened()||Gi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Bl(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ur(Pl,this,!1);const o=this.getRangedData(this.copyableRanges),s=Zt(cr,this,Qj).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=ha(o);if(e&&e.clipboardData){const u=MC(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[rR,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}Ur(Ao,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Kt(xl,this)||this.isEditorOpened()||Gi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Bl(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ur(xl,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=ha(o);if(e&&e.clipboardData){const l=MC(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[rR,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r==null?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Gi(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Bl(r,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=RE(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=uN(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=tW(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function nR(t){if(jE()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&oD(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Qj(t){const{rows:e}=yO(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function Jj(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&FE(n)}}}function CO(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&VE(n)}}}function ez(t){t.items.push({name:"---------"},kj(this)),Kt(Ig,this)&&t.items.push(Vj(this)),Kt(Pg,this)&&t.items.push(Fj(this)),Kt(xg,this)&&t.items.push(Lj(this)),t.items.push(Wj(this))}function tz(t,e,r,n,i){Kt(gu,this)&&(i.value=!0),Ur(gu,this,!1)}function rz(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function nz(){Zt(cr,this,CO).call(this)}function iz(){Zt(cr,this,Jj).call(this)}function oz(){Zt(cr,this,CO).call(this)}function sz(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function az(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function lz(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function SO(t,e,r){const n=az(t,sz(t,e,r));return lz(n)}function uz(t,e,r){return(e=cz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cz(t){var e=hz(t,"string");return typeof e=="symbol"?e:e+""}function hz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vr{constructor(e){uz(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Hl(t,e,r){return(e=dz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dz(t){var e=fz(t,"string");return typeof e=="symbol"?e:e+""}function fz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pp extends Vr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),Hl(this,"stateBefore",void 0),Hl(this,"range",void 0),Hl(this,"type",void 0),Hl(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new Pp({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){F(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){ai(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function iR(t,e,r){return(e=gz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gz(t){var e=mz(t,"string");return typeof e=="symbol"?e:e+""}function mz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xp extends Vr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),iR(this,"columns",void 0),iR(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new xp({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),SO(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function oR(t,e,r){return(e=pz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pz(t){var e=wz(t,"string");return typeof e=="symbol"?e:e+""}function wz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hp extends Vr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),oR(this,"previousSortState",void 0),oR(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new Hp({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function sR(t,e,r){return(e=vz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vz(t){var e=yz(t,"string");return typeof e=="symbol"?e:e+""}function yz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ap extends Vr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),sR(this,"index",void 0),sR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new Ap({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function aR(t,e,r){return(e=bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bz(t){var e=Cz(t,"string");return typeof e=="symbol"?e:e+""}function Cz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dp extends Vr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),aR(this,"index",void 0),aR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Dp({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Al(t,e,r){return(e=Sz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sz(t){var e=Rz(t,"string");return typeof e=="symbol"?e:e+""}function Rz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Np extends Vr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),Al(this,"changes",void 0),Al(this,"selected",void 0),Al(this,"countCols",void 0),Al(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new Np({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=gr(this.changes);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=gr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function lR(t,e,r){return(e=Tz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tz(t){var e=Ez(t,"string");return typeof e=="symbol"?e:e+""}function Ez(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kp extends Vr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),lR(this,"conditionsStack",void 0),lR(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new kp({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function _z(t,e,r){return(e=Oz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oz(t){var e=Mz(t,"string");return typeof e=="symbol"?e:e+""}function Mz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lp extends Vr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),_z(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new Lp({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function RO(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return qe(n,i,l=>{qe(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Nn(t,e,r){return(e=Iz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iz(t){var e=Pz(t,"string");return typeof e=="symbol"?e:e+""}function Pz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fp extends Vr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Nn(this,"index",void 0),Nn(this,"indexes",void 0),Nn(this,"data",void 0),Nn(this,"amount",void 0),Nn(this,"headers",void 0),Nn(this,"columnPositions",void 0),Nn(this,"rowPositions",void 0),Nn(this,"fixedColumnsStart",void 0),Nn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return qe(l.length-1,p=>{const y=[],b=l[p];qe(u,c,E=>{y.push(b[e.toPhysicalColumn(E)])}),h.push(y)}),qe(i-1,p=>{g.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&qe(i-1,p=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)}),new Fp({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:RO(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(yn(this.data[c],o));const l=yn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),F(e.getSourceDataArray(),(c,h)=>{F(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&F(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function No(t,e,r){return(e=xz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xz(t){var e=Hz(t,"string");return typeof e=="symbol"?e:e+""}function Hz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vp extends Vr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),No(this,"index",void 0),No(this,"data",void 0),No(this,"fixedRowsBottom",void 0),No(this,"fixedRowsTop",void 0),No(this,"rowIndexesSequence",void 0),No(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=gr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new Vp({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:RO(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function uR(t,e,r){return(e=Az(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Az(t){var e=Dz(t,"string");return typeof e=="symbol"?e:e+""}function Dz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wp extends Vr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),uR(this,"rows",void 0),uR(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new Wp({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),SO(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Nz(t,e,r){return(e=kz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kz(t){var e=Lz(t,"string");return typeof e=="symbol"?e:e+""}function Lz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bp extends Vr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),Nz(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new Bp({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function Fz(t,e){[Pp,xp,Hp,Ap,Dp,Np,kp,Lp,Fp,Vp,Wp,Bp].forEach(r=>r.startRegisteringEvents(t,e))}function Vz(t,e){Wz(t,e),e.add(t)}function Wz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qf(t,e,r){return(e=Bz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bz(t){var e=$z(t,"string");return typeof e=="symbol"?e:e+""}function $z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cR="undoRedo",jz="undoRedo",zz=1e3;ge.getSingleton().register("beforeUndo");ge.getSingleton().register("afterUndo");ge.getSingleton().register("beforeRedo");ge.getSingleton().register("afterRedo");const hR=new Set;var Dl=new WeakSet;class Uz extends Yu{static get PLUGIN_KEY(){return jz}static get PLUGIN_PRIORITY(){return zz}static get SETTING_KEYS(){return!0}constructor(e){super(e),Vz(this,Dl),qf(this,"doneActions",[]),qf(this,"undoneActions",[]),qf(this,"ignoreNewActions",!1),Fz(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Gf(Dl,e,Yz).call(e,...n)}),this.registerShortcuts(),Gf(Dl,this,qz).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Gf(Dl,this,Gz).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:cR};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cR)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=gr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=gr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Yz(t,e){e==="loadData"&&this.clear()}function qz(){const t=e=>{hR.has(e)||(Yn(er`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),hR.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Gz(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class Kz{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=v=>{if(v=this.postProcess(v,n),i){setTimeout(function(){i(v)},0);return}else return v},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let p=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&p+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let y=-1/0,b=1/0;const E=()=>{for(let v=Math.max(y,-u);v<=Math.min(b,u);v+=2){let T;const _=g[v-1],M=g[v+1];_&&(g[v-1]=void 0);let I=!1;if(M){const V=M.oldPos-v;I=M&&0<=V&&V<a}const H=_&&_.oldPos+1<l;if(!I&&!H){g[v]=void 0;continue}if(!H||I&&_.oldPos<M.oldPos?T=this.addToPath(M,!0,!1,0,n):T=this.addToPath(_,!1,!0,1,n),p=this.extractCommon(T,r,e,v,n),T.oldPos+1>=l&&p+1>=a)return s(this.buildValues(T.lastComponent,r,e))||!0;g[v]=T,T.oldPos+1>=l&&(b=Math.min(b,v-1)),p+1>=a&&(y=Math.max(y,v+1))}u++};if(i)(function v(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);E()||v()},0)})();else for(;u<=c&&Date.now()<=d;){const v=E();if(v)return v}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const p=n[u+g];return p.length>d.length?p:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class Xz extends Kz{constructor(){super(...arguments),this.tokenize=Qz}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const Zz=new Xz;function dR(t,e,r){return Zz.diff(t,e,r)}function Qz(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function Jz(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;dR(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(dR(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(v){return v.map(function(T){return" "+T})}const d=[];let g=0,p=0,y=[],b=1,E=1;for(let v=0;v<c.length;v++){const T=c[v],_=T.lines||tU(T.value);if(T.lines=_,T.added||T.removed){if(!g){const M=c[v-1];g=b,p=E,M&&(y=l>0?h(M.lines.slice(-l)):[],g-=y.length,p-=y.length)}for(const M of _)y.push((T.added?"+":"-")+M);T.added?E+=_.length:b+=_.length}else{if(g)if(_.length<=l*2&&v<c.length-2)for(const M of h(_))y.push(M);else{const M=Math.min(_.length,l);for(const H of h(_.slice(0,M)))y.push(H);const I={oldStart:g,oldLines:b-g+M,newStart:p,newLines:E-p+M,lines:y};d.push(I),g=0,p=0,y=[]}b+=_.length,E+=_.length}}for(const v of d)for(let T=0;T<v.lines.length;T++)v.lines[T].endsWith(`
`)?v.lines[T]=v.lines[T].slice(0,-1):(v.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function TO(t){if(Array.isArray(t))return t.map(TO).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function eU(t,e,r,n,i,o,s){{const a=Jz(t,e,r,n,i,o);return a?TO(a):void 0}}function tU(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var Hg;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(Hg||(Hg={}));const ko=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,Qo=Hg;class fR{constructor(e){or(this,"data");this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class gR{constructor(e){or(this,"data");this.data=e}run(){return[...new Set(this.data)]}}class Ag{constructor(e,r,n=!0){or(this,"data1");or(this,"data2");or(this,"ignoreDuplicates");n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)Qo.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return Qo.sort(e)}}class rU{constructor(e,r){or(this,"data1");or(this,"data2");this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)Qo.contains(this.data2,r[n])&&e.push(r[n]);return Qo.sort(e)}}class mR{constructor(e){or(this,"data");this.data=Qo.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new Ag(Qo.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class nU{constructor(e,r){or(this,"data1");or(this,"data2");this.data1=e,this.data2=r}run(){return eU("Data1","Data2",this.data1,this.data2)}}const iU=async(t,e)=>{ce(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(ce(e).trim()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var oU=(t,e)=>e("chkDuplicates"),sU=(t,e)=>e("rmDuplicates"),aU=(t,e)=>e("chkConsecutive"),lU=(t,e)=>e("compare"),uU=(t,e)=>e("diff"),cU=HM('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-15jzodw"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-15jzodw"><div class="row svelte-15jzodw"><div id="Table1" class="col-3 svelte-15jzodw"></div> <div id="Table2" class="col-3 pl-0 svelte-15jzodw"></div> <div class="col-2 p-0 pt-5 svelte-15jzodw"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-15jzodw">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-15jzodw">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-15jzodw"><label for="result">Result</label> <textarea class="form-control svelte-15jzodw" id="result" readonly=""></textarea></div></div></div>',1);function hU(t,e){RR(e,!0);const r=[],n=[];Ja(da),Ja(nc),Ja(Zj),Ja(Uz);const i=64;let o,s,a=Qt(""),l=Qt("Data1"),u=Qt("comm"),c=Qt(!0),h=Qt(!0),d=Qt(!1);const g=($,ee,Ce)=>{let Ie;try{Ie=JSON.parse(localStorage.getItem(Ce)||"")}catch{Ie=void 0}const de=new rn(document.getElementById($),{data:Ie,colHeaders:[ee],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return de.addHook("beforePaste",()=>de.updateSettings({readOnly:!0})),de.addHook("afterPaste",fe=>{de.updateSettings({readOnly:!1}),de.deselectCell();for(let re=fe.length-1;re>=0;re--)if(fe[re][0]!==""){de.loadData(fe.slice(0,re+1));return}de.loadData([[""]])}),de};WM(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const p=$=>$.getDataAtCol(0).filter(ee=>ee!==null),y=$=>{const ee=p(o).filter(_e=>_e!=""),Ce=p(s).filter(_e=>_e!="");switch($){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(ce(l)=="Data1"&&!ee.length){Ve(a,`Data1 is empty.
Please enter something...`);return}else if(ce(l)=="Data2"&&!Ce.length){Ve(a,`Data2 is empty.
Please enter something...`);return}break;default:if(ee.length){if(!Ce.length){Ve(a,`Data2 is empty.
Please enter something...`);return}}else{Ve(a,`Data1 is empty.
Please enter something...`);return}}Ve(d,!0);const Ie=v(),de=new Date().getTime();let fe="",re;switch($){case"chkDuplicates":let _e;ce(l)=="Data1"?_e=new fR(ee).run():_e=new fR(Ce).run(),Object.keys(_e).length?ce(c)?fe=`Duplicate values found in ${ce(l)}.
`+ko(Object.keys(_e).length,Object.keys(_e).map(Ue=>`${Ue} appears ${_e[Ue]} times.`)):fe=Object.keys(_e).join(`
`):fe=`${ce(l)} has no duplicate value.`;break;case"rmDuplicates":ce(l)=="Data1"?re=new gR(ee).run():re=new gR(Ce).run(),fe=re.join(`
`);break;case"chkConsecutive":ce(l)=="Data1"?re=new mR(ee).run():re=new mR(Ce).run(),re.length?re.length==1&&re[0]=="!Error!"?fe=`Error!
${ce(l)} contains non-numeric value. Please check!`:fe=`${ce(l)} is not consecutive.

The following numbers are missing:
${re.join(`
`)}`:fe=`${ce(l)} contains consecutive numbers.`;break;case"compare":if(ce(u)=="comm")re=new rU(ee,Ce).run(),re.length?fe=`Common values found between two data.
${ko(re.length,re)}`:fe="Two data contain no common value.";else{const Ue=new Ag(ee,Ce,ce(h)).run(),ht=new Ag(Ce,ee,ce(h)).run();Ue.length+ht.length==0?fe="Data1 is same as Data2.":Ue.length?ht.length?fe=`Two files have inconsistent content.

Data1 is more than Data2
${ko(Ue.length,Ue)}

Data2 is more than Data1
${ko(ht.length,ht)}`:fe=`Data1 completely contains Data2.

Data1 is more than Data2
${ko(Ue.length,Ue)}`:fe=`Data2 completely contains Data1.

Data2 is more than Data1
${ko(ht.length,ht)}`}break;case"diff":fe=new nU(ee.join(`
`)+`
`,Ce.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(Ie),$=="rmDuplicates"||$=="chkDuplicates"&&!ce(c)?Ve(a,fe,!0):Ve(a,fe+`

Duration for process: ${Date.now()-de}ms`),Ve(d,!1)},b=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),Ve(a,""))},E=()=>{const $=o.getData();o.loadData(s.getData()),s.loadData($)},v=()=>setInterval(()=>{const $=ce(a).split("Processing");let ee=$.length>=2?$[1].length:0;ee<3?ee++:ee-=3,Ve(a,"Processing"+".".repeat(ee))},200);var T=cU();PM("beforeunload",Xf,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var _=wt(sM(T),2),M=It(_),I=wt(It(M),4),H=It(I);H.__click=[oU,y];var V=wt(H,2),N=It(V),j=It(N),z=wt(V,2);z.__click=[sU,y];var te=wt(z,2);te.__click=[aU,y];var ue=wt(te,2),G=It(ue),Q=It(G);Q.value=Q.__value="Data1";var at=wt(G,2),ae=It(at);ae.value=ae.__value="Data2";var be=wt(ue,4);be.__click=[lU,y];var Ge=wt(be,2),vr=It(Ge),Ee=It(vr);Ee.value=Ee.__value="comm";var f=wt(vr,2),m=It(f);m.value=m.__value="diff";var w=wt(Ge,2),C=It(w),R=It(C),O=wt(w,4);O.__click=[uU,y];var P=wt(O,6);P.__click=[iU,a];var A=wt(P,6);A.__click=E;var Y=It(A);LM(Y,()=>"Data1<=>Data2");var B=wt(A,6);B.__click=b;var x=wt(I,2),oe=wt(It(x),2);DR(()=>{H.disabled=ce(d),z.disabled=ce(d),te.disabled=ce(d),be.disabled=ce(d),R.disabled=ce(u)=="comm",O.disabled=ce(d),P.disabled=ce(d),A.disabled=ce(d),B.disabled=ce(d)}),aw(j,()=>ce(c),$=>Ve(c,$)),$a(r,[],Q,()=>ce(l),$=>Ve(l,$)),$a(r,[],ae,()=>ce(l),$=>Ve(l,$)),$a(n,[],Ee,()=>ce(u),$=>Ve(u,$)),$a(n,[],m,()=>ce(u),$=>Ve(u,$)),aw(R,()=>ce(h),$=>Ve(h,$)),FM(oe,()=>ce(a),$=>Ve(a,$)),AM(t,T),TR()}xM(["click"]);DM(hU,{target:document.body})});export default dU();
