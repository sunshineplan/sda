var KM=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var F2=KM((U2,xu)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const RE=!1;var XM=Array.isArray,ZM=Array.prototype.indexOf,JM=Array.from,QM=Object.defineProperty,xa=Object.getOwnPropertyDescriptor,eI=Object.prototype,tI=Array.prototype,rI=Object.getPrototypeOf,Xw=Object.isExtensible;function nI(t){for(var e=0;e<t.length;e++)t[e]()}function EE(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const Ht=2,TE=4,Im=8,si=16,Bi=32,_o=64,rc=128,jt=1024,Cr=2048,ai=4096,Di=8192,Ni=16384,Pm=32768,Hu=65536,Zw=1<<17,iI=1<<18,xs=1<<19,oI=1<<20,Vr=256,Au=512,Du=32768,Wg=1<<21,xm=1<<22,wo=1<<23,Ha=Symbol("$state"),cs=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function sI(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function aI(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function lI(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function uI(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function cI(t){throw new Error("https://svelte.dev/e/effect_orphan")}function hI(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function dI(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function fI(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function gI(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function mI(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const pI=2,Ot=Symbol();function wI(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function _E(t){return t===this.v}let vI=!1,Sr=null;function Rs(t){Sr=t}function OE(t,e=!1,r){Sr={p:Sr,i:!1,c:null,e:null,s:t,x:null,l:null}}function ME(t){var e=Sr,r=e.e;if(r!==null){e.e=null;for(var n of r)jE(n)}return e.i=!0,Sr=e.p,{}}function IE(){return!0}let fo=[];function PE(){var t=fo;fo=[],nI(t)}function Es(t){if(fo.length===0&&!Aa){var e=fo;queueMicrotask(()=>{e===fo&&PE()})}fo.push(t)}function yI(){for(;fo.length>0;)PE()}function xE(t){var e=we;if(e===null)return ge.f|=wo,t;if((e.f&Pm)===0){if((e.f&rc)===0)throw t;e.b.error(t)}else Ts(t,e)}function Ts(t,e){for(;e!==null;){if((e.f&rc)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t}const Cl=new Set;let Ke=null,pu=null,sn=null,Bg=new Set,En=[],nc=null,$g=!1,Aa=!1;class On{committed=!1;current=new Map;previous=new Map;#r=new Set;#n=new Set;#c=0;#o=0;#l=null;#s=[];#i=[];skipped_effects=new Set;is_fork=!1;process(e){En=[],pu=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const n of e)this.#e(n,r);this.is_fork||this.#a(),this.#o>0||this.is_fork?(this.#t(r.effects),this.#t(r.render_effects),this.#t(r.block_effects)):(pu=this,Ke=null,Jw(r.render_effects),Jw(r.effects),pu=null),sn=null}#e(e,r){e.f^=jt;for(var n=e.first;n!==null;){var i=n.f,o=(i&(Bi|_o))!==0,s=o&&(i&jt)!==0,a=s||(i&Di)!==0||this.skipped_effects.has(n);if((n.f&rc)!==0&&n.b?.is_pending()&&(r={parent:r,effect:n,effects:[],render_effects:[],block_effects:[]}),!a&&n.fn!==null){o?n.f^=jt:(i&TE)!==0?r.effects.push(n):Qa(n)&&((n.f&si)!==0&&r.block_effects.push(n),ja(n));var l=n.first;if(l!==null){n=l;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)u===r.effect&&(this.#t(r.effects),this.#t(r.render_effects),this.#t(r.block_effects),r=r.parent),n=u.next,u=u.parent}}#t(e){for(const r of e)((r.f&Cr)!==0?this.#s:this.#i).push(r),zt(r,jt)}capture(e,r){this.previous.has(e)||this.previous.set(e,r),this.current.set(e,e.v),sn?.set(e,e.v)}activate(){Ke=this}deactivate(){Ke=null,sn=null}flush(){if(this.activate(),En.length>0){if(HE(),Ke!==null&&Ke!==this)return}else this.#c===0&&this.process([]);this.deactivate();for(const e of Bg)if(Bg.delete(e),e(),Ke!==null)break}discard(){for(const e of this.#n)e(this);this.#n.clear()}#a(){if(this.#o===0){for(const e of this.#r)e();this.#r.clear()}this.#c===0&&this.#u()}#u(){if(Cl.size>1){this.previous.clear();var e=sn,r=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of Cl){if(i===this){r=!1;continue}const o=[];for(const[a,l]of this.current){if(i.current.has(a))if(r&&l!==i.current.get(a))i.current.set(a,l);else continue;o.push(a)}if(o.length===0)continue;const s=[...i.current.keys()].filter(a=>!this.current.has(a));if(s.length>0){const a=new Set,l=new Map;for(const u of o)AE(u,s,a,l);if(En.length>0){Ke=i,i.apply();for(const u of En)i.#e(u,n);En=[],i.deactivate()}}}Ke=null,sn=e}this.committed=!0,Cl.delete(this),this.#l?.resolve()}increment(e){this.#c+=1,e&&(this.#o+=1)}decrement(e){this.#c-=1,e&&(this.#o-=1),this.revive()}revive(){for(const e of this.#s)zt(e,Cr),_s(e);for(const e of this.#i)zt(e,ai),_s(e);this.#s=[],this.#i=[],this.flush()}oncommit(e){this.#r.add(e)}ondiscard(e){this.#n.add(e)}settled(){return(this.#l??=EE()).promise}static ensure(){if(Ke===null){const e=Ke=new On;Cl.add(Ke),Aa||On.enqueue(()=>{Ke===e&&e.flush()})}return Ke}static enqueue(e){Es(e)}apply(){}}function bI(t){var e=Aa;Aa=!0;try{for(var r;;){if(yI(),En.length===0&&(Ke?.flush(),En.length===0))return nc=null,r;HE()}}finally{Aa=e}}function HE(){var t=ms;$g=!0;try{var e=0;for(tv(!0);En.length>0;){var r=On.ensure();if(e++>1e3){var n,i;CI()}r.process(En),ki.clear()}}finally{$g=!1,tv(t),nc=null}}function CI(){try{hI()}catch(t){Ts(t,nc)}}let Kn=null;function Jw(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(Ni|Di))===0&&Qa(n)&&(Kn=new Set,ja(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?GE(n):n.fn=null),Kn?.size>0)){ki.clear();for(const i of Kn){if((i.f&(Ni|Di))!==0)continue;const o=[i];let s=i.parent;for(;s!==null;)Kn.has(s)&&(Kn.delete(s),o.push(s)),s=s.parent;for(let a=o.length-1;a>=0;a--){const l=o[a];(l.f&(Ni|Di))===0&&ja(l)}}Kn.clear()}}Kn=null}}function AE(t,e,r,n){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const i of t.reactions){const o=i.f;(o&Ht)!==0?AE(i,e,r,n):(o&(xm|si))!==0&&(o&Cr)===0&&DE(i,e,n)&&(zt(i,Cr),_s(i))}}function DE(t,e,r){const n=r.get(t);if(n!==void 0)return n;if(t.deps!==null)for(const i of t.deps){if(e.includes(i))return!0;if((i.f&Ht)!==0&&DE(i,e,r))return r.set(i,!0),!0}return r.set(t,!1),!1}function _s(t){for(var e=nc=t;e.parent!==null;){e=e.parent;var r=e.f;if($g&&e===we&&(r&si)!==0)return;if((r&(_o|Bi))!==0){if((r&jt)===0)return;e.f^=jt}}En.push(e)}function SI(t){let e=0,r=ic(0),n;return()=>{FI()&&(se(r),ac(()=>(e===0&&(n=lc(()=>t(()=>Da(r)))),e+=1,()=>{Es(()=>{e-=1,e===0&&(n?.(),n=void 0,Da(r))})})))}}var RI=Hu|xs|rc;function EI(t,e,r){new TI(t,e,r)}class TI{parent;#r=!1;#n;#c=null;#o;#l;#s;#i=null;#e=null;#t=null;#a=null;#u=null;#f=0;#h=0;#g=!1;#d=null;#y=()=>{this.#d&&Nu(this.#d,this.#f)};#b=SI(()=>(this.#d=ic(this.#f),()=>{this.#d=null}));constructor(e,r,n){this.#n=e,this.#o=r,this.#l=n,this.parent=we.b,this.#r=!!this.#o.pending,this.#s=$I(()=>{we.b=this;{var i=this.#w();try{this.#i=qi(()=>n(i))}catch(o){this.error(o)}this.#h>0?this.#p():this.#r=!1}return()=>{this.#u?.remove()}},RI)}#C(){try{this.#i=qi(()=>this.#l(this.#n))}catch(e){this.error(e)}this.#r=!1}#S(){const e=this.#o.pending;e&&(this.#e=qi(()=>e(this.#n)),On.enqueue(()=>{var r=this.#w();this.#i=this.#m(()=>(On.ensure(),qi(()=>this.#l(r)))),this.#h>0?this.#p():(wu(this.#e,()=>{this.#e=null}),this.#r=!1)}))}#w(){var e=this.#n;return this.#r&&(this.#u=$E(),this.#n.before(this.#u),e=this.#u),e}is_pending(){return this.#r||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#o.pending}#m(e){var r=we,n=ge,i=Sr;In(this.#s),sr(this.#s),Rs(this.#s.ctx);try{return e()}catch(o){return xE(o),null}finally{In(r),sr(n),Rs(i)}}#p(){const e=this.#o.pending;this.#i!==null&&(this.#a=document.createDocumentFragment(),this.#a.append(this.#u),UI(this.#i,this.#a)),this.#e===null&&(this.#e=qi(()=>e(this.#n)))}#v(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#v(e);return}this.#h+=e,this.#h===0&&(this.#r=!1,this.#e&&wu(this.#e,()=>{this.#e=null}),this.#a&&(this.#n.before(this.#a),this.#a=null))}update_pending_count(e){this.#v(e),this.#f+=e,Bg.add(this.#y)}get_effect_pending(){return this.#b(),se(this.#d)}error(e){var r=this.#o.onerror;let n=this.#o.failed;if(this.#g||!r&&!n)throw e;this.#i&&(Mn(this.#i),this.#i=null),this.#e&&(Mn(this.#e),this.#e=null),this.#t&&(Mn(this.#t),this.#t=null);var i=!1,o=!1;const s=()=>{if(i){wI();return}i=!0,o&&mI(),On.ensure(),this.#f=0,this.#t!==null&&wu(this.#t,()=>{this.#t=null}),this.#r=this.has_pending_snippet(),this.#i=this.#m(()=>(this.#g=!1,qi(()=>this.#l(this.#n)))),this.#h>0?this.#p():this.#r=!1};var a=ge;try{sr(null),o=!0,r?.(e,s),o=!1}catch(l){Ts(l,this.#s&&this.#s.parent)}finally{sr(a)}n&&Es(()=>{this.#t=this.#m(()=>{On.ensure(),this.#g=!0;try{return qi(()=>{n(this.#n,()=>e,()=>s)})}catch(l){return Ts(l,this.#s.parent),null}finally{this.#g=!1}})})}}function _I(t,e,r){const n=MI;if(e.length===0){r(t.map(n));return}var i=Ke,o=we,s=OI();Promise.all(e.map(a=>II(a))).then(a=>{s();try{r([...t.map(n),...a])}catch(l){(o.f&Ni)===0&&Ts(l,o)}i?.deactivate(),jg()}).catch(a=>{Ts(a,o)})}function OI(){var t=we,e=ge,r=Sr,n=Ke;return function(o=!0){In(t),sr(e),Rs(r),o&&n?.activate()}}function jg(){In(null),sr(null),Rs(null)}function MI(t){var e=Ht|Cr,r=ge!==null&&(ge.f&Ht)!==0?ge:null;return we===null||r!==null&&(r.f&Vr)!==0?e|=Vr:we.f|=xs,{ctx:Sr,deps:null,effects:null,equals:_E,f:e,fn:t,reactions:null,rv:0,v:Ot,wv:0,parent:r??we,ac:null}}function II(t,e){let r=we;r===null&&aI();var n=r.b,i=void 0,o=ic(Ot),s=!ge,a=new Map;return BI(()=>{var l=EE();i=l.promise;try{Promise.resolve(t()).then(l.resolve,l.reject).then(()=>{u===Ke&&u.committed&&u.deactivate(),jg()})}catch(d){l.reject(d),jg()}var u=Ke;if(s){var c=!n.is_pending();n.update_pending_count(1),u.increment(c),a.get(u)?.reject(cs),a.delete(u),a.set(u,l)}const h=(d,g=void 0)=>{if(u.activate(),g)g!==cs&&(o.f|=wo,Nu(o,g));else{(o.f&wo)!==0&&(o.f^=wo),Nu(o,d);for(const[w,v]of a){if(a.delete(w),w===u)break;v.reject(cs)}}s&&(n.update_pending_count(-1),u.decrement(c))};l.promise.then(h,d=>h(null,d||"unknown"))}),Dm(()=>{for(const l of a.values())l.reject(cs)}),new Promise(l=>{function u(c){function h(){c===i?l(o):u(i)}c.then(h,h)}u(i)})}function NE(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)Mn(e[r])}}function PI(t){for(var e=t.parent;e!==null;){if((e.f&Ht)===0)return e;e=e.parent}return null}function Hm(t){var e,r=we;In(PI(t));try{t.f&=~Du,NE(t),e=QE(t)}finally{In(r)}return e}function kE(t){var e=Hm(t);if(t.equals(e)||(t.v=e,t.wv=ZE()),!Hs)if(sn!==null)sn.set(t,t.v);else{var r=(Mi||(t.f&Vr)!==0)&&t.deps!==null?ai:jt;zt(t,r)}}let zg=new Set;const ki=new Map;let LE=!1;function ic(t,e){var r={f:0,v:t,reactions:null,equals:_E,rv:0,wv:0};return r}function ir(t,e){const r=ic(t);return YI(r),r}function Ue(t,e,r=!1){ge!==null&&(!an||(ge.f&Zw)!==0)&&IE()&&(ge.f&(Ht|si|xm|Zw))!==0&&!ri?.includes(t)&&gI();let n=r?Ea(e):e;return Nu(t,n)}function Nu(t,e){if(!t.equals(e)){var r=t.v;Hs?ki.set(t,e):ki.set(t,r),t.v=e;var n=On.ensure();n.capture(t,r),(t.f&Ht)!==0&&((t.f&Cr)!==0&&Hm(t),zt(t,(t.f&Vr)===0?jt:ai)),t.wv=ZE(),FE(t,Cr),we!==null&&(we.f&jt)!==0&&(we.f&(Bi|_o))===0&&(Nr===null?qI([t]):Nr.push(t)),!n.is_fork&&zg.size>0&&!LE&&xI()}return e}function xI(){LE=!1;const t=Array.from(zg);for(const e of t)(e.f&jt)!==0&&zt(e,ai),Qa(e)&&ja(e);zg.clear()}function Da(t){Ue(t,t.v+1)}function FE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&Cr)===0;a&&zt(o,e),(s&Ht)!==0?(s&Du)===0&&(o.f|=Du,FE(o,ai)):a&&((s&si)!==0&&Kn!==null&&Kn.add(o),_s(o))}}function Ea(t){if(typeof t!="object"||t===null||Ha in t)return t;const e=rI(t);if(e!==eI&&e!==tI)return t;var r=new Map,n=XM(t),i=ir(0),o=vo,s=a=>{if(vo===o)return a();var l=ge,u=vo;sr(null),nv(o);var c=a();return sr(l),nv(u),c};return n&&r.set("length",ir(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&dI();var c=r.get(l);return c===void 0?c=s(()=>{var h=ir(u.value);return r.set(l,h),h}):Ue(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>ir(Ot));r.set(l,c),Da(i)}}else Ue(u,Ot),Da(i);return!0},get(a,l,u){if(l===Ha)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||xa(a,l)?.writable)&&(c=s(()=>{var g=Ea(h?a[l]:Ot),w=ir(g);return w}),r.set(l,c)),c!==void 0){var d=se(c);return d===Ot?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=se(c))}else if(u===void 0){var h=r.get(l),d=h?.v;if(h!==void 0&&d!==Ot)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){if(l===Ha)return!0;var u=r.get(l),c=u!==void 0&&u.v!==Ot||Reflect.has(a,l);if(u!==void 0||we!==null&&(!c||xa(a,l)?.writable)){u===void 0&&(u=s(()=>{var d=c?Ea(a[l]):Ot,g=ir(d);return g}),r.set(l,u));var h=se(u);if(h===Ot)return!1}return c},set(a,l,u,c){var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?Ue(w,Ot):g in a&&(w=s(()=>ir(Ot)),r.set(g+"",w))}if(h===void 0)(!d||xa(a,l)?.writable)&&(h=s(()=>ir(void 0)),Ue(h,Ea(u)),r.set(l,h));else{d=h.v!==Ot;var v=s(()=>Ea(u));Ue(h,v)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b?.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var T=r.get("length"),C=Number(l);Number.isInteger(C)&&C>=T.v&&Ue(T,C+1)}Da(i)}return!0},ownKeys(a){se(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==Ot});for(var[u,c]of r)c.v!==Ot&&!(u in a)&&l.push(u);return l},setPrototypeOf(){fI()}})}function Qw(t){try{if(t!==null&&typeof t=="object"&&Ha in t)return t[Ha]}catch{}return t}function HI(t,e){return Object.is(Qw(t),Qw(e))}var Ug,VE,WE,BE;function AI(){if(Ug===void 0){Ug=window,VE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;WE=xa(e,"firstChild").get,BE=xa(e,"nextSibling").get,Xw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Xw(r)&&(r.__t=void 0)}}function $E(t=""){return document.createTextNode(t)}function go(t){return WE.call(t)}function oc(t){return BE.call(t)}function Nt(t,e){return go(t)}function DI(t,e=!1){{var r=go(t);return r instanceof Comment&&r.data===""?oc(r):r}}function St(t,e=1,r=!1){let n=t;for(;e--;)n=oc(n);return n}let ev=!1;function NI(){ev||(ev=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function sc(t){var e=ge,r=we;sr(null),In(null);try{return t()}finally{sr(e),In(r)}}function Am(t,e,r,n=r){t.addEventListener(e,()=>sc(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),NI()}function kI(t){we===null&&ge===null&&cI(),ge!==null&&(ge.f&Vr)!==0&&we===null&&uI(),Hs&&lI()}function LI(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function $i(t,e,r,n=!0){var i=we;i!==null&&(i.f&Di)!==0&&(t|=Di);var o={ctx:Sr,deps:null,nodes_start:null,nodes_end:null,f:t|Cr,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{ja(o),o.f|=Pm}catch(l){throw Mn(o),l}else e!==null&&_s(o);if(n){var s=o;if(r&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&xs)===0&&(s=s.first,(t&si)!==0&&(t&Hu)!==0&&s!==null&&(s.f|=Hu)),s!==null&&(s.parent=i,i!==null&&LI(s,i),ge!==null&&(ge.f&Ht)!==0&&(t&_o)===0)){var a=ge;(a.effects??=[]).push(s)}}return o}function FI(){return ge!==null&&!an}function Dm(t){const e=$i(Im,null,!1);return zt(e,jt),e.teardown=t,e}function VI(t){kI();var e=we.f,r=!ge&&(e&Bi)!==0&&(e&Pm)===0;if(r){var n=Sr;(n.e??=[]).push(t)}else return jE(t)}function jE(t){return $i(TE|oI,t,!1)}function WI(t){On.ensure();const e=$i(_o|xs,t,!0);return(r={})=>new Promise(n=>{r.outro?wu(e,()=>{Mn(e),n(void 0)}):(Mn(e),n(void 0))})}function BI(t){return $i(xm|xs,t,!0)}function ac(t,e=0){return $i(Im|e,t,!0)}function zE(t,e=[],r=[]){_I(e,r,n=>{$i(Im,()=>t(...n.map(se)),!0)})}function $I(t,e=0){var r=$i(si|e,t,!0);return r}function qi(t,e=!0){return $i(Bi|xs,t,!0,e)}function UE(t){var e=t.teardown;if(e!==null){const r=Hs,n=ge;rv(!0),sr(null);try{e.call(null)}finally{rv(r),sr(n)}}}function YE(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&sc(()=>{i.abort(cs)});var n=r.next;(r.f&_o)!==0?r.parent=null:Mn(r,e),r=n}}function jI(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Bi)===0&&Mn(e),e=r}}function Mn(t,e=!0){var r=!1;(e||(t.f&iI)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(qE(t.nodes_start,t.nodes_end),r=!0),YE(t,e&&!r),ku(t,0),zt(t,Ni);var n=t.transitions;if(n!==null)for(const o of n)o.stop();UE(t);var i=t.parent;i!==null&&i.first!==null&&GE(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function qE(t,e){for(;t!==null;){var r=t===e?null:oc(t);t.remove(),t=r}}function GE(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function wu(t,e,r=!0){var n=[];KE(t,n,!0),zI(n,()=>{r&&Mn(t),e&&e()})}function zI(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function KE(t,e,r){if((t.f&Di)===0){if(t.f^=Di,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&Hu)!==0||(n.f&Bi)!==0&&(t.f&si)!==0;KE(n,e,o?r:!1),n=i}}}function UI(t,e){for(var r=t.nodes_start,n=t.nodes_end;r!==null;){var i=r===n?null:oc(r);e.append(r),r=i}}let ms=!1;function tv(t){ms=t}let Hs=!1;function rv(t){Hs=t}let ge=null,an=!1;function sr(t){ge=t}let we=null;function In(t){we=t}let ri=null;function YI(t){ge!==null&&(ri===null?ri=[t]:ri.push(t))}let Bt=null,pr=0,Nr=null;function qI(t){Nr=t}let XE=1,$a=0,vo=$a;function nv(t){vo=t}let Mi=!1;function ZE(){return++XE}function Qa(t){var e=t.f;if((e&Cr)!==0)return!0;if((e&ai)!==0){var r=t.deps,n=(e&Vr)!==0;if(e&Ht&&(t.f&=~Du),r!==null){var i,o,s=(e&Au)!==0,a=n&&we!==null&&!Mi,l=r.length;if((s||a)&&(we===null||(we.f&Ni)===0)){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!o?.reactions?.includes(u))&&(o.reactions??=[]).push(u);s&&(u.f^=Au),a&&c!==null&&(c.f&Vr)===0&&(u.f^=Vr)}for(i=0;i<l;i++)if(o=r[i],Qa(o)&&kE(o),o.wv>t.wv)return!0}(!n||we!==null&&!Mi)&&zt(t,jt)}return!1}function JE(t,e,r=!0){var n=t.reactions;if(n!==null&&!ri?.includes(t))for(var i=0;i<n.length;i++){var o=n[i];(o.f&Ht)!==0?JE(o,e,!1):e===o&&(r?zt(o,Cr):(o.f&jt)!==0&&zt(o,ai),_s(o))}}function QE(t){var e=Bt,r=pr,n=Nr,i=ge,o=Mi,s=ri,a=Sr,l=an,u=vo,c=t.f;Bt=null,pr=0,Nr=null,Mi=(c&Vr)!==0&&(an||!ms||ge===null),ge=(c&(Bi|_o))===0?t:null,ri=null,Rs(t.ctx),an=!1,vo=++$a,t.ac!==null&&(sc(()=>{t.ac.abort(cs)}),t.ac=null);try{t.f|=Wg;var h=t.fn,d=h(),g=t.deps;if(Bt!==null){var w;if(ku(t,pr),g!==null&&pr>0)for(g.length=pr+Bt.length,w=0;w<Bt.length;w++)g[pr+w]=Bt[w];else t.deps=g=Bt;if(!Mi||(c&Ht)!==0&&t.reactions!==null)for(w=pr;w<g.length;w++)(g[w].reactions??=[]).push(t)}else g!==null&&pr<g.length&&(ku(t,pr),g.length=pr);if(IE()&&Nr!==null&&!an&&g!==null&&(t.f&(Ht|ai|Cr))===0)for(w=0;w<Nr.length;w++)JE(Nr[w],t);return i!==null&&i!==t&&($a++,Nr!==null&&(n===null?n=Nr:n.push(...Nr))),(t.f&wo)!==0&&(t.f^=wo),d}catch(v){return xE(v)}finally{t.f^=Wg,Bt=e,pr=r,Nr=n,ge=i,Mi=o,ri=s,Rs(a),an=l,vo=u}}function GI(t,e){let r=e.reactions;if(r!==null){var n=ZM.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&Ht)!==0&&(Bt===null||!Bt.includes(e))&&(zt(e,ai),(e.f&(Vr|Au))===0&&(e.f^=Au),NE(e),ku(e,0))}function ku(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)GI(t,r[n])}function ja(t){var e=t.f;if((e&Ni)===0){zt(t,jt);var r=we,n=ms;we=t,ms=!0;try{(e&si)!==0?jI(t):YE(t),UE(t);var i=QE(t);t.teardown=typeof i=="function"?i:null,t.wv=XE;var o;RE&&vI&&(t.f&Cr)!==0&&t.deps}finally{ms=n,we=r}}}async function KI(){await Promise.resolve(),bI()}function se(t){var e=t.f,r=(e&Ht)!==0;if(ge!==null&&!an){var n=we!==null&&(we.f&Ni)!==0;if(!n&&!ri?.includes(t)){var i=ge.deps;if((ge.f&Wg)!==0)t.rv<$a&&(t.rv=$a,Bt===null&&i!==null&&i[pr]===t?pr++:Bt===null?Bt=[t]:(!Mi||!Bt.includes(t))&&Bt.push(t));else{(ge.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[ge]:o.includes(ge)||o.push(ge)}}}else if(r&&t.deps===null&&t.effects===null){var s=t,a=s.parent;a!==null&&(a.f&Vr)===0&&(s.f^=Vr)}if(Hs){if(ki.has(t))return ki.get(t);if(r){s=t;var l=s.v;return((s.f&jt)===0&&s.reactions!==null||eT(s))&&(l=Hm(s)),ki.set(s,l),l}}else if(r){if(s=t,sn?.has(s))return sn.get(s);Qa(s)&&kE(s)}if(sn?.has(t))return sn.get(t);if((t.f&wo)!==0)throw t.v;return t.v}function eT(t){if(t.v===Ot)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ki.has(e)||(e.f&Ht)!==0&&eT(e))return!0;return!1}function lc(t){var e=an;try{return an=!0,t()}finally{an=e}}const XI=-7169;function zt(t,e){t.f=t.f&XI|e}const ZI=["touchstart","touchmove"];function JI(t){return ZI.includes(t)}const tT=new Set,Yg=new Set;function QI(t,e,r,n={}){function i(o){if(n.capture||Ta.call(e,o),!o.cancelBubble)return sc(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?Es(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function eP(t,e,r,n,i){var o={capture:n,passive:i},s=QI(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Dm(()=>{e.removeEventListener(t,s,o)})}function tP(t){for(var e=0;e<t.length;e++)tT.add(t[e]);for(var r of Yg)r(t)}let iv=null;function Ta(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;iv=t;var s=0,a=iv===t&&t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){QM(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=ge,h=we;sr(null),In(null);try{for(var d,g=[];o!==null;){var w=o.assignedSlot||o.parentNode||o.host||null;try{var v=o["__"+n];v!=null&&(!o.disabled||t.target===o)&&v.call(o,t)}catch(b){d?g.push(b):d=b}if(t.cancelBubble||w===e||w===null)break;o=w}if(d){for(let b of g)queueMicrotask(()=>{throw b});throw d}}finally{t.__root=e,delete t.currentTarget,sr(c),In(h)}}}function rT(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function nT(t,e){var r=we;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function rP(t,e){var r=(e&pI)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=rT(i?t:"<!>"+t));var o=r||VE?document.importNode(n,!0):n.cloneNode(!0);{var s=go(o),a=o.lastChild;nT(s,a)}return o}}function nP(t,e){t!==null&&t.before(e)}function iP(t,e){return oP(t,e)}const Wo=new Map;function oP(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){AI();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var w=JI(g);e.addEventListener(g,Ta,{passive:w});var v=Wo.get(g);v===void 0?(document.addEventListener(g,Ta,{passive:w}),Wo.set(g,1)):Wo.set(g,v+1)}}};l(JM(tT)),Yg.add(l);var u=void 0,c=WI(()=>{var h=r??e.appendChild($E());return EI(h,{pending:()=>{}},d=>{if(o){OE({});var g=Sr;g.c=o}i&&(n.$$events=i),u=t(d,n)||{},o&&ME()}),()=>{for(var d of a){e.removeEventListener(d,Ta);var g=Wo.get(d);--g===0?(document.removeEventListener(d,Ta),Wo.delete(d)):Wo.set(d,g)}Yg.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return sP.set(u,c),u}let sP=new WeakMap;function aP(t,e,r=!1,n=!1,i=!1){var o=t,s="";zE(()=>{var a=we;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(qE(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=rT(l);if((r||n)&&(u=go(u)),nT(go(u),u.lastChild),r||n)for(;go(u);)o.before(go(u));else o.before(u)}})}function lP(t,e,r=e){var n=new WeakSet;Am(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=eh(t)?th(o):o,r(o),Ke!==null&&n.add(Ke),await KI(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd,l=t.value.length;if(t.value=o??"",a!==null){var u=t.value.length;s===a&&a===l&&u>l?(t.selectionStart=u,t.selectionEnd=u):(t.selectionStart=s,t.selectionEnd=Math.min(a,u))}}}),lc(e)==null&&t.value&&(r(eh(t)?th(t.value):t.value),Ke!==null&&n.add(Ke)),ac(()=>{var i=e();if(t===document.activeElement){var o=pu??Ke;if(n.has(o))return}eh(t)&&i===th(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}const Qc=new Set;function Sl(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??=[];s.push(r),Am(r,"change",()=>{var l=r.__value;o&&(l=uP(s,l,r.checked)),i(l)},()=>i(o?[]:null)),ac(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=HI(r.__value,l)}),Dm(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),Qc.has(s)||(Qc.add(s),Es(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Qc.delete(s)})),Es(()=>{})}function ov(t,e,r=e){Am(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),lc(e)==null&&r(t.checked),ac(()=>{var n=e();t.checked=!!n})}function uP(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function eh(t){var e=t.type;return e==="number"||e==="range"}function th(t){return t===""?null:+t}function cP(t){Sr===null&&sI(),VI(()=>{const e=lc(t);if(typeof e=="function")return e})}const hP="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(hP);var sv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},av={},zs,lv;function st(){if(lv)return zs;lv=1;var t=function(e){return e&&e.Math===Math&&e};return zs=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof sv=="object"&&sv)||t(typeof zs=="object"&&zs)||function(){return this}()||Function("return this")(),zs}var rh={},nh,uv;function dt(){return uv||(uv=1,nh=function(t){try{return!!t()}catch{return!0}}),nh}var ih,cv;function jr(){if(cv)return ih;cv=1;var t=dt();return ih=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ih}var oh,hv;function uc(){if(hv)return oh;hv=1;var t=dt();return oh=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),oh}var sh,dv;function vt(){if(dv)return sh;dv=1;var t=uc(),e=Function.prototype.call;return sh=t?e.bind(e):function(){return e.apply(e,arguments)},sh}var ah={},fv;function dP(){if(fv)return ah;fv=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return ah.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,ah}var lh,gv;function cc(){return gv||(gv=1,lh=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),lh}var uh,mv;function at(){if(mv)return uh;mv=1;var t=uc(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return uh=t?n:function(i){return function(){return r.apply(i,arguments)}},uh}var ch,pv;function Oo(){if(pv)return ch;pv=1;var t=at(),e=t({}.toString),r=t("".slice);return ch=function(n){return r(e(n),8,-1)},ch}var hh,wv;function fP(){if(wv)return hh;wv=1;var t=at(),e=dt(),r=Oo(),n=Object,i=t("".split);return hh=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,hh}var dh,vv;function Nm(){return vv||(vv=1,dh=function(t){return t==null}),dh}var fh,yv;function el(){if(yv)return fh;yv=1;var t=Nm(),e=TypeError;return fh=function(r){if(t(r))throw new e("Can't call method on "+r);return r},fh}var gh,bv;function tl(){if(bv)return gh;bv=1;var t=fP(),e=el();return gh=function(r){return t(e(r))},gh}var mh,Cv;function ft(){if(Cv)return mh;Cv=1;var t=typeof document=="object"&&document.all;return mh=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},mh}var ph,Sv;function zr(){if(Sv)return ph;Sv=1;var t=ft();return ph=function(e){return typeof e=="object"?e!==null:t(e)},ph}var wh,Rv;function As(){if(Rv)return wh;Rv=1;var t=st(),e=ft(),r=function(n){return e(n)?n:void 0};return wh=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},wh}var vh,Ev;function rl(){if(Ev)return vh;Ev=1;var t=at();return vh=t({}.isPrototypeOf),vh}var yh,Tv;function hc(){if(Tv)return yh;Tv=1;var t=st(),e=t.navigator,r=e&&e.userAgent;return yh=r?String(r):"",yh}var bh,_v;function gP(){if(_v)return bh;_v=1;var t=st(),e=hc(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),bh=a,bh}var Ch,Ov;function km(){if(Ov)return Ch;Ov=1;var t=gP(),e=dt(),r=st(),n=r.String;return Ch=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Ch}var Sh,Mv;function iT(){if(Mv)return Sh;Mv=1;var t=km();return Sh=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Sh}var Rh,Iv;function Lm(){if(Iv)return Rh;Iv=1;var t=As(),e=ft(),r=rl(),n=iT(),i=Object;return Rh=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Rh}var Eh,Pv;function dc(){if(Pv)return Eh;Pv=1;var t=String;return Eh=function(e){try{return t(e)}catch{return"Object"}},Eh}var Th,xv;function Er(){if(xv)return Th;xv=1;var t=ft(),e=dc(),r=TypeError;return Th=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},Th}var _h,Hv;function nl(){if(Hv)return _h;Hv=1;var t=Er(),e=Nm();return _h=function(r,n){var i=r[n];return e(i)?void 0:t(i)},_h}var Oh,Av;function mP(){if(Av)return Oh;Av=1;var t=vt(),e=ft(),r=zr(),n=TypeError;return Oh=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},Oh}var Mh={exports:{}},Ih,Dv;function Mo(){return Dv||(Dv=1,Ih=!1),Ih}var Ph,Nv;function Fm(){if(Nv)return Ph;Nv=1;var t=st(),e=Object.defineProperty;return Ph=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},Ph}var kv;function Vm(){if(kv)return Mh.exports;kv=1;var t=Mo(),e=st(),r=Fm(),n="__core-js_shared__",i=Mh.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Mh.exports}var xh,Lv;function oT(){if(Lv)return xh;Lv=1;var t=Vm();return xh=function(e,r){return t[e]||(t[e]=r||{})},xh}var Hh,Fv;function Ds(){if(Fv)return Hh;Fv=1;var t=el(),e=Object;return Hh=function(r){return e(t(r))},Hh}var Ah,Vv;function Ur(){if(Vv)return Ah;Vv=1;var t=at(),e=Ds(),r=t({}.hasOwnProperty);return Ah=Object.hasOwn||function(i,o){return r(e(i),o)},Ah}var Dh,Wv;function sT(){if(Wv)return Dh;Wv=1;var t=at(),e=0,r=Math.random(),n=t(1.1.toString);return Dh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},Dh}var Nh,Bv;function hn(){if(Bv)return Nh;Bv=1;var t=st(),e=oT(),r=Ur(),n=sT(),i=km(),o=iT(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return Nh=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},Nh}var kh,$v;function pP(){if($v)return kh;$v=1;var t=vt(),e=zr(),r=Lm(),n=nl(),i=mP(),o=hn(),s=TypeError,a=o("toPrimitive");return kh=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},kh}var Lh,jv;function aT(){if(jv)return Lh;jv=1;var t=pP(),e=Lm();return Lh=function(r){var n=t(r,"string");return e(n)?n:n+""},Lh}var Fh,zv;function Wm(){if(zv)return Fh;zv=1;var t=st(),e=zr(),r=t.document,n=e(r)&&e(r.createElement);return Fh=function(i){return n?r.createElement(i):{}},Fh}var Vh,Uv;function lT(){if(Uv)return Vh;Uv=1;var t=jr(),e=dt(),r=Wm();return Vh=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),Vh}var Yv;function uT(){if(Yv)return rh;Yv=1;var t=jr(),e=vt(),r=dP(),n=cc(),i=tl(),o=aT(),s=Ur(),a=lT(),l=Object.getOwnPropertyDescriptor;return rh.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},rh}var Wh={},Bh,qv;function cT(){if(qv)return Bh;qv=1;var t=jr(),e=dt();return Bh=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Bh}var $h,Gv;function yt(){if(Gv)return $h;Gv=1;var t=zr(),e=String,r=TypeError;return $h=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},$h}var Kv;function ji(){if(Kv)return Wh;Kv=1;var t=jr(),e=lT(),r=cT(),n=yt(),i=aT(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Wh.f=t?r?function(d,g,w){if(n(d),g=i(g),n(w),typeof d=="function"&&g==="prototype"&&"value"in w&&c in w&&!w[c]){var v=a(d,g);v&&v[c]&&(d[g]=w.value,w={configurable:u in w?w[u]:v[u],enumerable:l in w?w[l]:v[l],writable:!1})}return s(d,g,w)}:s:function(d,g,w){if(n(d),g=i(g),n(w),e)try{return s(d,g,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(d[g]=w.value),d},Wh}var jh,Xv;function Ns(){if(Xv)return jh;Xv=1;var t=jr(),e=ji(),r=cc();return jh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},jh}var zh={exports:{}},Uh,Zv;function wP(){if(Zv)return Uh;Zv=1;var t=jr(),e=Ur(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return Uh={EXISTS:i,PROPER:o,CONFIGURABLE:s},Uh}var Yh,Jv;function vP(){if(Jv)return Yh;Jv=1;var t=at(),e=ft(),r=Vm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Yh=r.inspectSource,Yh}var qh,Qv;function yP(){if(Qv)return qh;Qv=1;var t=st(),e=ft(),r=t.WeakMap;return qh=e(r)&&/native code/.test(String(r)),qh}var Gh,ey;function Bm(){if(ey)return Gh;ey=1;var t=oT(),e=sT(),r=t("keys");return Gh=function(n){return r[n]||(r[n]=e(n))},Gh}var Kh,ty;function $m(){return ty||(ty=1,Kh={}),Kh}var Xh,ry;function hT(){if(ry)return Xh;ry=1;var t=yP(),e=st(),r=zr(),n=Ns(),i=Ur(),o=Vm(),s=Bm(),a=$m(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,w=function(C){return g(C)?d(C):h(C,{})},v=function(C){return function(E){var y;if(!r(E)||(y=d(E)).type!==C)throw new u("Incompatible receiver, "+C+" required");return y}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(C,E){if(b.has(C))throw new u(l);return E.facade=C,b.set(C,E),E},d=function(C){return b.get(C)||{}},g=function(C){return b.has(C)}}else{var T=s("state");a[T]=!0,h=function(C,E){if(i(C,T))throw new u(l);return E.facade=C,n(C,T,E),E},d=function(C){return i(C,T)?C[T]:{}},g=function(C){return i(C,T)}}return Xh={set:h,get:d,has:g,enforce:w,getterFor:v},Xh}var ny;function dT(){if(ny)return zh.exports;ny=1;var t=at(),e=dt(),r=ft(),n=Ur(),i=jr(),o=wP().CONFIGURABLE,s=vP(),a=hT(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),w=t([].join),v=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),T=zh.exports=function(C,E,y){d(c(E),0,7)==="Symbol("&&(E="["+g(c(E),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),y&&y.getter&&(E="get "+E),y&&y.setter&&(E="set "+E),(!n(C,"name")||o&&C.name!==E)&&(i?h(C,"name",{value:E,configurable:!0}):C.name=E),v&&y&&n(y,"arity")&&C.length!==y.arity&&h(C,"length",{value:y.arity});try{y&&n(y,"constructor")&&y.constructor?i&&h(C,"prototype",{writable:!1}):C.prototype&&(C.prototype=void 0)}catch{}var M=l(C);return n(M,"source")||(M.source=w(b,typeof E=="string"?E:"")),C};return Function.prototype.toString=T(function(){return r(this)&&u(this).source||s(this)},"toString"),zh.exports}var Zh,iy;function jm(){if(iy)return Zh;iy=1;var t=ft(),e=ji(),r=dT(),n=Fm();return Zh=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Zh}var Jh={},Qh,oy;function bP(){if(oy)return Qh;oy=1;var t=Math.ceil,e=Math.floor;return Qh=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},Qh}var ed,sy;function il(){if(sy)return ed;sy=1;var t=bP();return ed=function(e){var r=+e;return r!==r||r===0?0:t(r)},ed}var td,ay;function CP(){if(ay)return td;ay=1;var t=il(),e=Math.max,r=Math.min;return td=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},td}var rd,ly;function SP(){if(ly)return rd;ly=1;var t=il(),e=Math.min;return rd=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},rd}var nd,uy;function ks(){if(uy)return nd;uy=1;var t=SP();return nd=function(e){return t(e.length)},nd}var id,cy;function RP(){if(cy)return id;cy=1;var t=tl(),e=CP(),r=ks(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return id={includes:n(!0),indexOf:n(!1)},id}var od,hy;function fT(){if(hy)return od;hy=1;var t=at(),e=Ur(),r=tl(),n=RP().indexOf,i=$m(),o=t([].push);return od=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},od}var sd,dy;function zm(){return dy||(dy=1,sd=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),sd}var fy;function EP(){if(fy)return Jh;fy=1;var t=fT(),e=zm(),r=e.concat("length","prototype");return Jh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},Jh}var ad={},gy;function TP(){return gy||(gy=1,ad.f=Object.getOwnPropertySymbols),ad}var ld,my;function _P(){if(my)return ld;my=1;var t=As(),e=at(),r=EP(),n=TP(),i=yt(),o=e([].concat);return ld=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},ld}var ud,py;function gT(){if(py)return ud;py=1;var t=Ur(),e=_P(),r=uT(),n=ji();return ud=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},ud}var cd,wy;function OP(){if(wy)return cd;wy=1;var t=dt(),e=ft(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return cd=n,cd}var hd,vy;function Fe(){if(vy)return hd;vy=1;var t=st(),e=uT().f,r=Ns(),n=jm(),i=Fm(),o=gT(),s=OP();return hd=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,w,v,b,T;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(w in l){if(b=l[w],a.dontCallGetSet?(T=e(g,w),v=T&&T.value):v=g[w],d=s(c?w:u+(h?".":"#")+w,a.forced),!d&&v!==void 0){if(typeof b==typeof v)continue;o(b,v)}(a.sham||v&&v.sham)&&r(b,"sham",!0),n(g,w,b,a)}},hd}var dd,yy;function ol(){if(yy)return dd;yy=1;var t=uc(),e=Function.prototype,r=e.apply,n=e.call;return dd=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),dd}var fd,by;function mT(){if(by)return fd;by=1;var t=at(),e=Er();return fd=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},fd}var gd,Cy;function MP(){if(Cy)return gd;Cy=1;var t=zr();return gd=function(e){return t(e)||e===null},gd}var md,Sy;function IP(){if(Sy)return md;Sy=1;var t=MP(),e=String,r=TypeError;return md=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},md}var pd,Ry;function pT(){if(Ry)return pd;Ry=1;var t=mT(),e=zr(),r=el(),n=IP();return pd=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),pd}var wd,Ey;function PP(){if(Ey)return wd;Ey=1;var t=ji().f;return wd=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},wd}var vd,Ty;function xP(){if(Ty)return vd;Ty=1;var t=ft(),e=zr(),r=pT();return vd=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},vd}var yd,_y;function HP(){if(_y)return yd;_y=1;var t=hn(),e=t("toStringTag"),r={};return r[e]="z",yd=String(r)==="[object z]",yd}var bd,Oy;function wT(){if(Oy)return bd;Oy=1;var t=HP(),e=ft(),r=Oo(),n=hn(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return bd=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},bd}var Cd,My;function fc(){if(My)return Cd;My=1;var t=wT(),e=String;return Cd=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Cd}var Sd,Iy;function AP(){if(Iy)return Sd;Iy=1;var t=fc();return Sd=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Sd}var Rd,Py;function DP(){if(Py)return Rd;Py=1;var t=zr(),e=Ns();return Rd=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Rd}var Ed,xy;function NP(){if(xy)return Ed;xy=1;var t=at(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return Ed=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},Ed}var Td,Hy;function kP(){if(Hy)return Td;Hy=1;var t=dt(),e=cc();return Td=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),Td}var _d,Ay;function LP(){if(Ay)return _d;Ay=1;var t=Ns(),e=NP(),r=kP(),n=Error.captureStackTrace;return _d=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},_d}var Od,Dy;function FP(){if(Dy)return Od;Dy=1;var t=As(),e=Ur(),r=Ns(),n=rl(),i=pT(),o=gT(),s=PP(),a=xP(),l=AP(),u=DP(),c=LP(),h=jr(),d=Mo();return Od=function(g,w,v,b){var T="stackTraceLimit",C=b?2:1,E=g.split("."),y=E[E.length-1],M=t.apply(null,E);if(M){var H=M.prototype;if(!d&&e(H,"cause")&&delete H.cause,!v)return M;var P=t("Error"),A=w(function(F,B){var K=l(b?B:F,void 0),L=b?new M(F):new M;return K!==void 0&&r(L,"message",K),c(L,A,L.stack,2),this&&n(H,this)&&a(L,this,A),arguments.length>C&&u(L,arguments[C]),L});if(A.prototype=H,y!=="Error"?i?i(A,P):o(A,P,{name:!0}):h&&T in M&&(s(A,M,T),s(A,M,"prepareStackTrace")),o(A,M),!d)try{H.name!==y&&r(H,"name",y),H.constructor=A}catch{}return A}},Od}var Ny;function VP(){if(Ny)return av;Ny=1;var t=Fe(),e=st(),r=ol(),n=FP(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),av}VP();var ky={},Md,Ly;function vT(){if(Ly)return Md;Ly=1;var t=Oo();return Md=Array.isArray||function(r){return t(r)==="Array"},Md}var Id,Fy;function yT(){if(Fy)return Id;Fy=1;var t=jr(),e=vT(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Id=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Id}var Pd,Vy;function bT(){if(Vy)return Pd;Vy=1;var t=TypeError,e=9007199254740991;return Pd=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Pd}var Wy;function WP(){if(Wy)return ky;Wy=1;var t=Fe(),e=Ds(),r=ks(),n=yT(),i=bT(),o=dt(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var w=0;w<g;w++)h[d]=arguments[w],d++;return n(h,d),d}}),ky}WP();var By={},xd,$y;function BP(){if($y)return xd;$y=1;var t=Oo(),e=at();return xd=function(r){if(t(r)==="Function")return e(r)},xd}var Hd,jy;function CT(){if(jy)return Hd;jy=1;var t=BP(),e=Er(),r=uc(),n=t(t.bind);return Hd=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},Hd}var Ad,zy;function ST(){return zy||(zy=1,Ad={}),Ad}var Dd,Uy;function $P(){if(Uy)return Dd;Uy=1;var t=hn(),e=ST(),r=t("iterator"),n=Array.prototype;return Dd=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Dd}var Nd,Yy;function RT(){if(Yy)return Nd;Yy=1;var t=wT(),e=nl(),r=Nm(),n=ST(),i=hn(),o=i("iterator");return Nd=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},Nd}var kd,qy;function jP(){if(qy)return kd;qy=1;var t=vt(),e=Er(),r=yt(),n=dc(),i=RT(),o=TypeError;return kd=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},kd}var Ld,Gy;function Tr(){if(Gy)return Ld;Gy=1;var t=vt(),e=yt(),r=nl();return Ld=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},Ld}var Fd,Ky;function Ls(){if(Ky)return Fd;Ky=1;var t=CT(),e=vt(),r=yt(),n=dc(),i=$P(),o=ks(),s=rl(),a=jP(),l=RT(),u=Tr(),c=TypeError,h=function(g,w){this.stopped=g,this.result=w},d=h.prototype;return Fd=function(g,w,v){var b=v&&v.that,T=!!(v&&v.AS_ENTRIES),C=!!(v&&v.IS_RECORD),E=!!(v&&v.IS_ITERATOR),y=!!(v&&v.INTERRUPTED),M=t(w,b),H,P,A,F,B,K,L,oe=function(te){return H&&u(H,"normal"),new h(!0,te)},X=function(te){return T?(r(te),y?M(te[0],te[1],oe):M(te[0],te[1])):y?M(te,oe):M(te)};if(C)H=g.iterator;else if(E)H=g;else{if(P=l(g),!P)throw new c(n(g)+" is not iterable");if(i(P)){for(A=0,F=o(g);F>A;A++)if(B=X(g[A]),B&&s(d,B))return B;return new h(!1)}H=a(g,P)}for(K=C?g.next:H.next;!(L=e(K,H)).done;){try{B=X(L.value)}catch(te){u(H,"throw",te)}if(typeof B=="object"&&B&&s(d,B))return B}return new h(!1)},Fd}var Vd,Xy;function ET(){if(Xy)return Vd;Xy=1;var t=jr(),e=ji(),r=cc();return Vd=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},Vd}var Zy;function zP(){if(Zy)return By;Zy=1;var t=Fe(),e=Ls(),r=ET();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),By}zP();var Jy={},Wd,Qy;function Hn(){if(Qy)return Wd;Qy=1;var t=at(),e=Set.prototype;return Wd={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Wd}var Bd,eb;function Io(){if(eb)return Bd;eb=1;var t=Hn().has;return Bd=function(e){return t(e),e},Bd}var $d,tb;function Po(){if(tb)return $d;tb=1;var t=vt();return $d=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},$d}var jd,rb;function sl(){if(rb)return jd;rb=1;var t=at(),e=Po(),r=Hn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return jd=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},jd}var zd,nb;function Um(){if(nb)return zd;nb=1;var t=Hn(),e=sl(),r=t.Set,n=t.add;return zd=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},zd}var Ud,ib;function al(){if(ib)return Ud;ib=1;var t=mT(),e=Hn();return Ud=t(e.proto,"size","get")||function(r){return r.size},Ud}var Yd,ob;function zi(){return ob||(ob=1,Yd=function(t){return{iterator:t,next:t.next,done:!1}}),Yd}var qd,sb;function xo(){if(sb)return qd;sb=1;var t=Er(),e=yt(),r=vt(),n=il(),i=zi(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},qd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},qd}var Gd,ab;function UP(){if(ab)return Gd;ab=1;var t=Io(),e=Hn(),r=Um(),n=al(),i=xo(),o=sl(),s=Po(),a=e.has,l=e.remove;return Gd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(w){d.includes(w)&&l(g,w)}):s(d.getIterator(),function(w){a(g,w)&&l(g,w)}),g},Gd}var Kd,lb;function Ho(){if(lb)return Kd;lb=1;var t=As(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Kd=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Kd}var ub;function YP(){if(ub)return Jy;ub=1;var t=Fe(),e=UP(),r=dt(),n=Ho(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),Jy}YP();var cb={},Xd,hb;function qP(){if(hb)return Xd;hb=1;var t=Io(),e=Hn(),r=al(),n=xo(),i=sl(),o=Po(),s=e.Set,a=e.add,l=e.has;return Xd=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(w){l(h,w)&&a(g,w)}):i(h,function(w){d.includes(w)&&a(g,w)}),g},Xd}var db;function GP(){if(db)return cb;db=1;var t=Fe(),e=dt(),r=qP(),n=Ho(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),cb}GP();var fb={},Zd,gb;function KP(){if(gb)return Zd;gb=1;var t=Io(),e=Hn().has,r=al(),n=xo(),i=sl(),o=Po(),s=Tr();return Zd=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},Zd}var mb;function XP(){if(mb)return fb;mb=1;var t=Fe(),e=KP(),r=Ho(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),fb}XP();var pb={},Jd,wb;function ZP(){if(wb)return Jd;wb=1;var t=Io(),e=al(),r=sl(),n=xo();return Jd=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Jd}var vb;function JP(){if(vb)return pb;vb=1;var t=Fe(),e=ZP(),r=Ho(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),pb}JP();var yb={},Qd,bb;function QP(){if(bb)return Qd;bb=1;var t=Io(),e=Hn().has,r=al(),n=xo(),i=Po(),o=Tr();return Qd=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Qd}var Cb;function ex(){if(Cb)return yb;Cb=1;var t=Fe(),e=QP(),r=Ho(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),yb}ex();var Sb={},ef,Rb;function tx(){if(Rb)return ef;Rb=1;var t=Io(),e=Hn(),r=Um(),n=xo(),i=Po(),o=e.add,s=e.has,a=e.remove;return ef=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},ef}var tf,Eb;function TT(){return Eb||(Eb=1,tf=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),tf}var Tb;function rx(){if(Tb)return Sb;Tb=1;var t=Fe(),e=tx(),r=TT(),n=Ho(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Sb}rx();var _b={},rf,Ob;function nx(){if(Ob)return rf;Ob=1;var t=Io(),e=Hn().add,r=Um(),n=xo(),i=Po();return rf=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},rf}var Mb;function ix(){if(Mb)return _b;Mb=1;var t=Fe(),e=nx(),r=TT(),n=Ho(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),_b}ix();var Ib={},Pb={},nf,xb;function ox(){if(xb)return nf;xb=1;var t=rl(),e=TypeError;return nf=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},nf}var of,Hb;function sx(){if(Hb)return of;Hb=1;var t=dt();return of=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),of}var sf,Ab;function _T(){if(Ab)return sf;Ab=1;var t=Ur(),e=ft(),r=Ds(),n=Bm(),i=sx(),o=n("IE_PROTO"),s=Object,a=s.prototype;return sf=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},sf}var af,Db;function ax(){if(Db)return af;Db=1;var t=dT(),e=ji();return af=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},af}var lf={},uf,Nb;function lx(){if(Nb)return uf;Nb=1;var t=fT(),e=zm();return uf=Object.keys||function(n){return t(n,e)},uf}var kb;function ux(){if(kb)return lf;kb=1;var t=jr(),e=cT(),r=ji(),n=yt(),i=tl(),o=lx();return lf.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},lf}var cf,Lb;function OT(){if(Lb)return cf;Lb=1;var t=As();return cf=t("document","documentElement"),cf}var hf,Fb;function Ym(){if(Fb)return hf;Fb=1;var t=yt(),e=ux(),r=zm(),n=$m(),i=OT(),o=Wm(),s=Bm(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(C){return l+c+a+C+l+"/"+c+a},w=function(C){C.write(g("")),C.close();var E=C.parentWindow.Object;return C=null,E},v=function(){var C=o("iframe"),E="java"+c+":",y;return C.style.display="none",i.appendChild(C),C.src=String(E),y=C.contentWindow.document,y.open(),y.write(g("document.F=Object")),y.close(),y.F},b,T=function(){try{b=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&b?w(b):v():w(b);for(var C=r.length;C--;)delete T[u][r[C]];return T()};return n[h]=!0,hf=Object.create||function(E,y){var M;return E!==null?(d[u]=t(E),M=new d,d[u]=null,M[h]=E):M=T(),y===void 0?M:e.f(M,y)},hf}var df,Vb;function MT(){if(Vb)return df;Vb=1;var t=dt(),e=ft(),r=zr(),n=Ym(),i=_T(),o=jm(),s=hn(),a=Mo(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),df={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},df}var Wb;function cx(){if(Wb)return Pb;Wb=1;var t=Fe(),e=st(),r=ox(),n=yt(),i=ft(),o=_T(),s=ax(),a=ET(),l=dt(),u=Ur(),c=hn(),h=MT().IteratorPrototype,d=jr(),g=Mo(),w="constructor",v="Iterator",b=c("toStringTag"),T=TypeError,C=e[v],E=g||!i(C)||C.prototype!==h||!l(function(){C({})}),y=function(){if(r(this,h),o(this)===h)throw new T("Abstract class Iterator not directly constructable")},M=function(H,P){d?s(h,H,{configurable:!0,get:function(){return P},set:function(A){if(n(this),this===h)throw new T("You can't redefine this property");u(this,H)?this[H]=A:a(this,H,A)}}):h[H]=P};return u(h,b)||M(b,v),(E||!u(h,w)||h[w]===Object)&&M(w,y),y.prototype=h,t({global:!0,constructor:!0,forced:E},{Iterator:y}),Pb}var Bb;function hx(){return Bb||(Bb=1,cx()),Ib}hx();var $b={},jb={},ff,zb;function dx(){if(zb)return ff;zb=1;var t=jm();return ff=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},ff}var gf,Ub;function fx(){return Ub||(Ub=1,gf=function(t,e){return{value:t,done:e}}),gf}var mf,Yb;function gx(){if(Yb)return mf;Yb=1;var t=Tr();return mf=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},mf}var pf,qb;function IT(){if(qb)return pf;qb=1;var t=vt(),e=Ym(),r=Ns(),n=dx(),i=hn(),o=hT(),s=nl(),a=MT().IteratorPrototype,l=fx(),u=Tr(),c=gx(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",w="normal",v="throw",b=o.set,T=function(y){var M=o.getterFor(y?g:d);return n(e(a),{next:function(){var P=M(this);if(y)return P.nextHandler();if(P.done)return l(void 0,!0);try{var A=P.nextHandler();return P.returnHandlerResult?A:l(A,P.done)}catch(F){throw P.done=!0,F}},return:function(){var H=M(this),P=H.iterator;if(H.done=!0,y){var A=s(P,"return");return A?t(A,P):l(void 0,!0)}if(H.inner)try{u(H.inner.iterator,w)}catch(F){return u(P,v,F)}if(H.openIters)try{c(H.openIters,w)}catch(F){return u(P,v,F)}return P&&u(P,w),l(void 0,!0)}})},C=T(!0),E=T(!1);return r(E,h,"Iterator Helper"),pf=function(y,M,H){var P=function(F,B){B?(B.iterator=F.iterator,B.next=F.next):B=F,B.type=M?g:d,B.returnHandlerResult=!!H,B.nextHandler=y,B.counter=0,B.done=!1,b(this,B)};return P.prototype=M?C:E,P},pf}var wf,Gb;function PT(){if(Gb)return wf;Gb=1;var t=yt(),e=Tr();return wf=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},wf}var vf,Kb;function xT(){return Kb||(Kb=1,vf=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),vf}var yf,Xb;function Ao(){if(Xb)return yf;Xb=1;var t=st();return yf=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},yf}var Zb;function mx(){if(Zb)return jb;Zb=1;var t=Fe(),e=vt(),r=Er(),n=yt(),i=zi(),o=IT(),s=PT(),a=Mo(),l=Tr(),u=xT(),c=Ao(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,w=o(function(){for(var v=this.iterator,b=this.predicate,T=this.next,C,E,y;;){if(C=n(e(T,v)),E=this.done=!!C.done,E)return;if(y=C.value,s(v,b,[y,this.counter++],!0))return y}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(T){l(this,"throw",T)}return d?e(d,this,b):new w(i(this),{predicate:b})}}),jb}var Jb;function px(){return Jb||(Jb=1,mx()),$b}px();var Qb={},eC={},tC;function wx(){if(tC)return eC;tC=1;var t=Fe(),e=vt(),r=Ls(),n=Er(),i=yt(),o=zi(),s=Tr(),a=Ao(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),eC}var rC;function vx(){return rC||(rC=1,wx()),Qb}vx();var nC={},iC={},oC;function yx(){if(oC)return iC;oC=1;var t=Fe(),e=vt(),r=Er(),n=yt(),i=zi(),o=IT(),s=PT(),a=Tr(),l=xT(),u=Ao(),c=Mo(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,w=o(function(){var v=this.iterator,b=n(e(this.next,v)),T=this.done=!!b.done;if(!T)return s(v,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(T){a(this,"throw",T)}return d?e(d,this,b):new w(i(this),{mapper:b})}}),iC}var sC;function bx(){return sC||(sC=1,yx()),nC}bx();var aC={},lC={},bf,uC;function qm(){if(uC)return bf;uC=1;var t=at();return bf=t([].slice),bf}var Cf,cC;function HT(){if(cC)return Cf;cC=1;var t=TypeError;return Cf=function(e,r){if(e<r)throw new t("Not enough arguments");return e},Cf}var Sf,hC;function Cx(){if(hC)return Sf;hC=1;var t=hc();return Sf=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Sf}var Rf,dC;function AT(){if(dC)return Rf;dC=1;var t=st(),e=hc(),r=Oo(),n=function(i){return e.slice(0,i.length)===i};return Rf=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),Rf}var Ef,fC;function Sx(){if(fC)return Ef;fC=1;var t=AT();return Ef=t==="NODE",Ef}var Tf,gC;function DT(){if(gC)return Tf;gC=1;var t=st(),e=ol(),r=CT(),n=ft(),i=Ur(),o=dt(),s=OT(),a=qm(),l=Wm(),u=HT(),c=Cx(),h=Sx(),d=t.setImmediate,g=t.clearImmediate,w=t.process,v=t.Dispatch,b=t.Function,T=t.MessageChannel,C=t.String,E=0,y={},M="onreadystatechange",H,P,A,F;o(function(){H=t.location});var B=function(X){if(i(y,X)){var te=y[X];delete y[X],te()}},K=function(X){return function(){B(X)}},L=function(X){B(X.data)},oe=function(X){t.postMessage(C(X),H.protocol+"//"+H.host)};return(!d||!g)&&(d=function(te){u(arguments.length,1);var tt=n(te)?te:b(te),Pe=a(arguments,1);return y[++E]=function(){e(tt,void 0,Pe)},P(E),E},g=function(te){delete y[te]},h?P=function(X){w.nextTick(K(X))}:v&&v.now?P=function(X){v.now(K(X))}:T&&!c?(A=new T,F=A.port2,A.port1.onmessage=L,P=r(F.postMessage,F)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&H&&H.protocol!=="file:"&&!o(oe)?(P=oe,t.addEventListener("message",L,!1)):M in l("script")?P=function(X){s.appendChild(l("script"))[M]=function(){s.removeChild(this),B(X)}}:P=function(X){setTimeout(K(X),0)}),Tf={set:d,clear:g},Tf}var mC;function Rx(){if(mC)return lC;mC=1;var t=Fe(),e=st(),r=DT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),lC}var pC={},_f,wC;function Ex(){if(wC)return _f;wC=1;var t=st(),e=ol(),r=ft(),n=AT(),i=hc(),o=qm(),s=HT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return _f=function(u,c){var h=c?2:1;return l?function(d,g){var w=s(arguments.length,1)>h,v=r(d)?d:a(d),b=w?o(arguments,h):[],T=w?function(){e(v,this,b)}:v;return c?u(T,g):u(T)}:u},_f}var vC;function Tx(){if(vC)return pC;vC=1;var t=Fe(),e=st(),r=DT().set,n=Ex(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),pC}var yC;function _x(){return yC||(yC=1,Rx(),Tx()),aC}_x();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:NT,setPrototypeOf:bC,isFrozen:Ox,getPrototypeOf:Mx,getOwnPropertyDescriptor:Ix}=Object;let{freeze:Yt,seal:Wr,create:kT}=Object,{apply:qg,construct:Gg}=typeof Reflect<"u"&&Reflect;Yt||(Yt=function(e){return e});Wr||(Wr=function(e){return e});qg||(qg=function(e,r,n){return e.apply(r,n)});Gg||(Gg=function(e,r){return new e(...r)});const Rl=qt(Array.prototype.forEach),Px=qt(Array.prototype.lastIndexOf),CC=qt(Array.prototype.pop),Us=qt(Array.prototype.push),xx=qt(Array.prototype.splice),vu=qt(String.prototype.toLowerCase),Of=qt(String.prototype.toString),SC=qt(String.prototype.match),Ys=qt(String.prototype.replace),Hx=qt(String.prototype.indexOf),Ax=qt(String.prototype.trim),rn=qt(Object.prototype.hasOwnProperty),kt=qt(RegExp.prototype.test),qs=Dx(TypeError);function qt(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return qg(t,e,n)}}function Dx(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Gg(t,r)}}function he(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vu;bC&&bC(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&(Ox(e)||(e[n]=o),i=o)}t[i]=!0}return t}function Nx(t){for(let e=0;e<t.length;e++)rn(t,e)||(t[e]=null);return t}function Gn(t){const e=kT(null);for(const[r,n]of NT(t))rn(t,r)&&(Array.isArray(n)?e[r]=Nx(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Gn(n):e[r]=n);return e}function Gs(t,e){for(;t!==null;){const n=Ix(t,e);if(n){if(n.get)return qt(n.get);if(typeof n.value=="function")return qt(n.value)}t=Mx(t)}function r(){return null}return r}const RC=Yt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Mf=Yt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),If=Yt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),kx=Yt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Pf=Yt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Lx=Yt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),EC=Yt(["#text"]),TC=Yt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),xf=Yt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_C=Yt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),El=Yt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Fx=Wr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Vx=Wr(/<%[\w\W]*|[\w\W]*%>/gm),Wx=Wr(/\$\{[\w\W]*/gm),Bx=Wr(/^data-[\-\w.\u00B7-\uFFFF]+$/),$x=Wr(/^aria-[\-\w]+$/),LT=Wr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),jx=Wr(/^(?:\w+script|data):/i),zx=Wr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),FT=Wr(/^html$/i),Ux=Wr(/^[a-z][.\w]*(-[.\w]+)+$/i);var OC=Object.freeze({__proto__:null,ARIA_ATTR:$x,ATTR_WHITESPACE:zx,CUSTOM_ELEMENT:Ux,DATA_ATTR:Bx,DOCTYPE_NAME:FT,ERB_EXPR:Vx,IS_ALLOWED_URI:LT,IS_SCRIPT_OR_DATA:jx,MUSTACHE_EXPR:Fx,TMPLIT_EXPR:Wx});const Ks={element:1,text:3,progressingInstruction:7,comment:8,document:9},Yx=function(){return typeof window>"u"?null:window},qx=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},MC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function VT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yx();const e=J=>VT(J);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Ks.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,w=l.prototype,v=Gs(w,"cloneNode"),b=Gs(w,"remove"),T=Gs(w,"nextSibling"),C=Gs(w,"childNodes"),E=Gs(w,"parentNode");if(typeof s=="function"){const J=r.createElement("template");J.content&&J.content.ownerDocument&&(r=J.content.ownerDocument)}let y,M="";const{implementation:H,createNodeIterator:P,createDocumentFragment:A,getElementsByTagName:F}=r,{importNode:B}=n;let K=MC();e.isSupported=typeof NT=="function"&&typeof E=="function"&&H&&H.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:L,ERB_EXPR:oe,TMPLIT_EXPR:X,DATA_ATTR:te,ARIA_ATTR:tt,IS_SCRIPT_OR_DATA:Pe,ATTR_WHITESPACE:Se,CUSTOM_ELEMENT:Be}=OC;let{IS_ALLOWED_URI:$e}=OC,xe=null;const Or=he({},[...RC,...Mf,...If,...Pf,...EC]);let He=null;const f=he({},[...TC,...xf,..._C,...El]);let m=Object.seal(kT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),p=null,R=null,_=!0,O=!0,x=!1,k=!0,U=!1,$=!0,I=!1,V=!1,Y=!1,re=!1,ke=!1,Ae=!1,ue=!0,pe=!1;const ce="user-content-";let _e=!0,qe=!1,At={},cr=null;const Ln=he({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Dt=null;const bt=he({},["audio","video","img","source","image","track"]);let hr=null;const di=he({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Kr="http://www.w3.org/1998/Math/MathML",Yi="http://www.w3.org/2000/svg",Mr="http://www.w3.org/1999/xhtml";let gn=Mr,dr=!1,fi=null;const gi=he({},[Kr,Yi,Mr],Of);let mn=he({},["mi","mo","mn","ms","mtext"]),mi=he({},["annotation-xml"]);const Ir=he({},["title","style","font","a","script"]);let Ct=null;const yl=["application/xhtml+xml","text/html"],bl="text/html";let pt=null,Fo=null;const YM=r.createElement("form"),Fw=function(S){return S instanceof RegExp||S instanceof Function},Xc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Fo&&Fo===S)){if((!S||typeof S!="object")&&(S={}),S=Gn(S),Ct=yl.indexOf(S.PARSER_MEDIA_TYPE)===-1?bl:S.PARSER_MEDIA_TYPE,pt=Ct==="application/xhtml+xml"?Of:vu,xe=rn(S,"ALLOWED_TAGS")?he({},S.ALLOWED_TAGS,pt):Or,He=rn(S,"ALLOWED_ATTR")?he({},S.ALLOWED_ATTR,pt):f,fi=rn(S,"ALLOWED_NAMESPACES")?he({},S.ALLOWED_NAMESPACES,Of):gi,hr=rn(S,"ADD_URI_SAFE_ATTR")?he(Gn(di),S.ADD_URI_SAFE_ATTR,pt):di,Dt=rn(S,"ADD_DATA_URI_TAGS")?he(Gn(bt),S.ADD_DATA_URI_TAGS,pt):bt,cr=rn(S,"FORBID_CONTENTS")?he({},S.FORBID_CONTENTS,pt):Ln,p=rn(S,"FORBID_TAGS")?he({},S.FORBID_TAGS,pt):Gn({}),R=rn(S,"FORBID_ATTR")?he({},S.FORBID_ATTR,pt):Gn({}),At=rn(S,"USE_PROFILES")?S.USE_PROFILES:!1,_=S.ALLOW_ARIA_ATTR!==!1,O=S.ALLOW_DATA_ATTR!==!1,x=S.ALLOW_UNKNOWN_PROTOCOLS||!1,k=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,U=S.SAFE_FOR_TEMPLATES||!1,$=S.SAFE_FOR_XML!==!1,I=S.WHOLE_DOCUMENT||!1,re=S.RETURN_DOM||!1,ke=S.RETURN_DOM_FRAGMENT||!1,Ae=S.RETURN_TRUSTED_TYPE||!1,Y=S.FORCE_BODY||!1,ue=S.SANITIZE_DOM!==!1,pe=S.SANITIZE_NAMED_PROPS||!1,_e=S.KEEP_CONTENT!==!1,qe=S.IN_PLACE||!1,$e=S.ALLOWED_URI_REGEXP||LT,gn=S.NAMESPACE||Mr,mn=S.MATHML_TEXT_INTEGRATION_POINTS||mn,mi=S.HTML_INTEGRATION_POINTS||mi,m=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&Fw(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(m.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&Fw(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(m.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(m.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),U&&(O=!1),ke&&(re=!0),At&&(xe=he({},EC),He=[],At.html===!0&&(he(xe,RC),he(He,TC)),At.svg===!0&&(he(xe,Mf),he(He,xf),he(He,El)),At.svgFilters===!0&&(he(xe,If),he(He,xf),he(He,El)),At.mathMl===!0&&(he(xe,Pf),he(He,_C),he(He,El))),S.ADD_TAGS&&(xe===Or&&(xe=Gn(xe)),he(xe,S.ADD_TAGS,pt)),S.ADD_ATTR&&(He===f&&(He=Gn(He)),he(He,S.ADD_ATTR,pt)),S.ADD_URI_SAFE_ATTR&&he(hr,S.ADD_URI_SAFE_ATTR,pt),S.FORBID_CONTENTS&&(cr===Ln&&(cr=Gn(cr)),he(cr,S.FORBID_CONTENTS,pt)),_e&&(xe["#text"]=!0),I&&he(xe,["html","head","body"]),xe.table&&(he(xe,["tbody"]),delete p.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw qs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');y=S.TRUSTED_TYPES_POLICY,M=y.createHTML("")}else y===void 0&&(y=qx(g,i)),y!==null&&typeof M=="string"&&(M=y.createHTML(""));Yt&&Yt(S),Fo=S}},Vw=he({},[...Mf,...If,...kx]),Ww=he({},[...Pf,...Lx]),qM=function(S){let N=E(S);(!N||!N.tagName)&&(N={namespaceURI:gn,tagName:"template"});const G=vu(S.tagName),je=vu(N.tagName);return fi[S.namespaceURI]?S.namespaceURI===Yi?N.namespaceURI===Mr?G==="svg":N.namespaceURI===Kr?G==="svg"&&(je==="annotation-xml"||mn[je]):!!Vw[G]:S.namespaceURI===Kr?N.namespaceURI===Mr?G==="math":N.namespaceURI===Yi?G==="math"&&mi[je]:!!Ww[G]:S.namespaceURI===Mr?N.namespaceURI===Yi&&!mi[je]||N.namespaceURI===Kr&&!mn[je]?!1:!Ww[G]&&(Ir[G]||!Vw[G]):!!(Ct==="application/xhtml+xml"&&fi[S.namespaceURI]):!1},pn=function(S){Us(e.removed,{element:S});try{E(S).removeChild(S)}catch{b(S)}},Vo=function(S,N){try{Us(e.removed,{attribute:N.getAttributeNode(S),from:N})}catch{Us(e.removed,{attribute:null,from:N})}if(N.removeAttribute(S),S==="is")if(re||ke)try{pn(N)}catch{}else try{N.setAttribute(S,"")}catch{}},Bw=function(S){let N=null,G=null;if(Y)S="<remove></remove>"+S;else{const gt=SC(S,/^[\r\n\t ]+/);G=gt&&gt[0]}Ct==="application/xhtml+xml"&&gn===Mr&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const je=y?y.createHTML(S):S;if(gn===Mr)try{N=new d().parseFromString(je,Ct)}catch{}if(!N||!N.documentElement){N=H.createDocument(gn,"template",null);try{N.documentElement.innerHTML=dr?M:je}catch{}}const Tt=N.body||N.documentElement;return S&&G&&Tt.insertBefore(r.createTextNode(G),Tt.childNodes[0]||null),gn===Mr?F.call(N,I?"html":"body")[0]:I?N.documentElement:Tt},$w=function(S){return P.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Zc=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},jw=function(S){return typeof a=="function"&&S instanceof a};function Fn(J,S,N){Rl(J,G=>{G.call(e,S,N,Fo)})}const zw=function(S){let N=null;if(Fn(K.beforeSanitizeElements,S,null),Zc(S))return pn(S),!0;const G=pt(S.nodeName);if(Fn(K.uponSanitizeElement,S,{tagName:G,allowedTags:xe}),$&&S.hasChildNodes()&&!jw(S.firstElementChild)&&kt(/<[/\w!]/g,S.innerHTML)&&kt(/<[/\w!]/g,S.textContent)||S.nodeType===Ks.progressingInstruction||$&&S.nodeType===Ks.comment&&kt(/<[/\w]/g,S.data))return pn(S),!0;if(!xe[G]||p[G]){if(!p[G]&&Yw(G)&&(m.tagNameCheck instanceof RegExp&&kt(m.tagNameCheck,G)||m.tagNameCheck instanceof Function&&m.tagNameCheck(G)))return!1;if(_e&&!cr[G]){const je=E(S)||S.parentNode,Tt=C(S)||S.childNodes;if(Tt&&je){const gt=Tt.length;for(let Gt=gt-1;Gt>=0;--Gt){const Vn=v(Tt[Gt],!0);Vn.__removalCount=(S.__removalCount||0)+1,je.insertBefore(Vn,T(S))}}}return pn(S),!0}return S instanceof l&&!qM(S)||(G==="noscript"||G==="noembed"||G==="noframes")&&kt(/<\/no(script|embed|frames)/i,S.innerHTML)?(pn(S),!0):(U&&S.nodeType===Ks.text&&(N=S.textContent,Rl([L,oe,X],je=>{N=Ys(N,je," ")}),S.textContent!==N&&(Us(e.removed,{element:S.cloneNode()}),S.textContent=N)),Fn(K.afterSanitizeElements,S,null),!1)},Uw=function(S,N,G){if(ue&&(N==="id"||N==="name")&&(G in r||G in YM))return!1;if(!(O&&!R[N]&&kt(te,N))){if(!(_&&kt(tt,N))){if(!He[N]||R[N]){if(!(Yw(S)&&(m.tagNameCheck instanceof RegExp&&kt(m.tagNameCheck,S)||m.tagNameCheck instanceof Function&&m.tagNameCheck(S))&&(m.attributeNameCheck instanceof RegExp&&kt(m.attributeNameCheck,N)||m.attributeNameCheck instanceof Function&&m.attributeNameCheck(N))||N==="is"&&m.allowCustomizedBuiltInElements&&(m.tagNameCheck instanceof RegExp&&kt(m.tagNameCheck,G)||m.tagNameCheck instanceof Function&&m.tagNameCheck(G))))return!1}else if(!hr[N]){if(!kt($e,Ys(G,Se,""))){if(!((N==="src"||N==="xlink:href"||N==="href")&&S!=="script"&&Hx(G,"data:")===0&&Dt[S])){if(!(x&&!kt(Pe,Ys(G,Se,"")))){if(G)return!1}}}}}}return!0},Yw=function(S){return S!=="annotation-xml"&&SC(S,Be)},qw=function(S){Fn(K.beforeSanitizeAttributes,S,null);const{attributes:N}=S;if(!N||Zc(S))return;const G={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:He,forceKeepAttr:void 0};let je=N.length;for(;je--;){const Tt=N[je],{name:gt,namespaceURI:Gt,value:Vn}=Tt,js=pt(gt),Jc=Vn;let _t=gt==="value"?Jc:Ax(Jc);if(G.attrName=js,G.attrValue=_t,G.keepAttr=!0,G.forceKeepAttr=void 0,Fn(K.uponSanitizeAttribute,S,G),_t=G.attrValue,pe&&(js==="id"||js==="name")&&(Vo(gt,S),_t=ce+_t),$&&kt(/((--!?|])>)|<\/(style|title)/i,_t)){Vo(gt,S);continue}if(G.forceKeepAttr)continue;if(!G.keepAttr){Vo(gt,S);continue}if(!k&&kt(/\/>/i,_t)){Vo(gt,S);continue}U&&Rl([L,oe,X],Kw=>{_t=Ys(_t,Kw," ")});const Gw=pt(S.nodeName);if(!Uw(Gw,js,_t)){Vo(gt,S);continue}if(y&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!Gt)switch(g.getAttributeType(Gw,js)){case"TrustedHTML":{_t=y.createHTML(_t);break}case"TrustedScriptURL":{_t=y.createScriptURL(_t);break}}if(_t!==Jc)try{Gt?S.setAttributeNS(Gt,gt,_t):S.setAttribute(gt,_t),Zc(S)?pn(S):CC(e.removed)}catch{Vo(gt,S)}}Fn(K.afterSanitizeAttributes,S,null)},GM=function J(S){let N=null;const G=$w(S);for(Fn(K.beforeSanitizeShadowDOM,S,null);N=G.nextNode();)Fn(K.uponSanitizeShadowNode,N,null),zw(N),qw(N),N.content instanceof o&&J(N.content);Fn(K.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(J){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},N=null,G=null,je=null,Tt=null;if(dr=!J,dr&&(J="<!-->"),typeof J!="string"&&!jw(J))if(typeof J.toString=="function"){if(J=J.toString(),typeof J!="string")throw qs("dirty is not a string, aborting")}else throw qs("toString is not a function");if(!e.isSupported)return J;if(V||Xc(S),e.removed=[],typeof J=="string"&&(qe=!1),qe){if(J.nodeName){const Vn=pt(J.nodeName);if(!xe[Vn]||p[Vn])throw qs("root node is forbidden and cannot be sanitized in-place")}}else if(J instanceof a)N=Bw("<!---->"),G=N.ownerDocument.importNode(J,!0),G.nodeType===Ks.element&&G.nodeName==="BODY"||G.nodeName==="HTML"?N=G:N.appendChild(G);else{if(!re&&!U&&!I&&J.indexOf("<")===-1)return y&&Ae?y.createHTML(J):J;if(N=Bw(J),!N)return re?null:Ae?M:""}N&&Y&&pn(N.firstChild);const gt=$w(qe?J:N);for(;je=gt.nextNode();)zw(je),qw(je),je.content instanceof o&&GM(je.content);if(qe)return J;if(re){if(ke)for(Tt=A.call(N.ownerDocument);N.firstChild;)Tt.appendChild(N.firstChild);else Tt=N;return(He.shadowroot||He.shadowrootmode)&&(Tt=B.call(n,Tt,!0)),Tt}let Gt=I?N.outerHTML:N.innerHTML;return I&&xe["!doctype"]&&N.ownerDocument&&N.ownerDocument.doctype&&N.ownerDocument.doctype.name&&kt(FT,N.ownerDocument.doctype.name)&&(Gt="<!DOCTYPE "+N.ownerDocument.doctype.name+`>
`+Gt),U&&Rl([L,oe,X],Vn=>{Gt=Ys(Gt,Vn," ")}),y&&Ae?y.createHTML(Gt):Gt},e.setConfig=function(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xc(J),V=!0},e.clearConfig=function(){Fo=null,V=!1},e.isValidAttribute=function(J,S,N){Fo||Xc({});const G=pt(J),je=pt(S);return Uw(G,je,N)},e.addHook=function(J,S){typeof S=="function"&&Us(K[J],S)},e.removeHook=function(J,S){if(S!==void 0){const N=Px(K[J],S);return N===-1?void 0:xx(K[J],N,1)[0]}return CC(K[J])},e.removeHooks=function(J){K[J]=[]},e.removeAllHooks=function(){K=MC()},e}var Gx=VT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var WT;function W(){return WT.apply(null,arguments)}function Kx(t){WT=t}function un(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function yo(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gm(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(be(t,e))return!1;return!0}function er(t){return t===void 0}function oi(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function ll(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function BT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Ii(t,e){for(var r in e)be(e,r)&&(t[r]=e[r]);return be(e,"toString")&&(t.toString=e.toString),be(e,"valueOf")&&(t.valueOf=e.valueOf),t}function An(t,e,r,n){return c_(t,e,r,n,!0).utc()}function Xx(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ae(t){return t._pf==null&&(t._pf=Xx()),t._pf}var Kg;Array.prototype.some?Kg=Array.prototype.some:Kg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function Km(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=ae(t),r=Kg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function gc(t){var e=An(NaN);return t!=null?Ii(ae(e),t):ae(e).userInvalidated=!0,e}var IC=W.momentProperties=[],Hf=!1;function Xm(t,e){var r,n,i,o=IC.length;if(er(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),er(e._i)||(t._i=e._i),er(e._f)||(t._f=e._f),er(e._l)||(t._l=e._l),er(e._strict)||(t._strict=e._strict),er(e._tzm)||(t._tzm=e._tzm),er(e._isUTC)||(t._isUTC=e._isUTC),er(e._offset)||(t._offset=e._offset),er(e._pf)||(t._pf=ae(e)),er(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=IC[r],i=e[n],er(i)||(t[n]=i);return t}function ul(t){Xm(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Hf===!1&&(Hf=!0,W.updateOffset(this),Hf=!1)}function cn(t){return t instanceof ul||t!=null&&t._isAMomentObject!=null}function $T(t){W.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Yr(t,e){var r=!0;return Ii(function(){if(W.deprecationHandler!=null&&W.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])be(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}$T(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var PC={};function jT(t,e){W.deprecationHandler!=null&&W.deprecationHandler(t,e),PC[t]||($T(e),PC[t]=!0)}W.suppressDeprecationWarnings=!1;W.deprecationHandler=null;function Dn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Zx(t){var e,r;for(r in t)be(t,r)&&(e=t[r],Dn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Xg(t,e){var r=Ii({},t),n;for(n in e)be(e,n)&&(yo(t[n])&&yo(e[n])?(r[n]={},Ii(r[n],t[n]),Ii(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)be(t,n)&&!be(e,n)&&yo(t[n])&&(r[n]=Ii({},r[n]));return r}function Zm(t){t!=null&&this.set(t)}var Zg;Object.keys?Zg=Object.keys:Zg=function(t){var e,r=[];for(e in t)be(t,e)&&r.push(e);return r};var Jx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Qx(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Dn(n)?n.call(e,r):n}function Pn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var Jm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Tl=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Af={},ps={};function Q(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(ps[t]=i),e&&(ps[e[0]]=function(){return Pn(i.apply(this,arguments),e[1],e[2])}),r&&(ps[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function eH(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function tH(t){var e=t.match(Jm),r,n;for(r=0,n=e.length;r<n;r++)ps[e[r]]?e[r]=ps[e[r]]:e[r]=eH(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Dn(e[s])?e[s].call(i,t):e[s];return o}}function yu(t,e){return t.isValid()?(e=zT(e,t.localeData()),Af[e]=Af[e]||tH(e),Af[e](t)):t.localeData().invalidDate()}function zT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(Tl.lastIndex=0;r>=0&&Tl.test(t);)t=t.replace(Tl,n),Tl.lastIndex=0,r-=1;return t}var rH={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function nH(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(Jm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var iH="Invalid date";function oH(){return this._invalidDate}var sH="%d",aH=/\d{1,2}/;function lH(t){return this._ordinal.replace("%d",t)}var uH={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function cH(t,e,r,n){var i=this._relativeTime[r];return Dn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function hH(t,e){var r=this._relativeTime[t>0?"future":"past"];return Dn(r)?r(e):r.replace(/%s/i,e)}var xC={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function qr(t){return typeof t=="string"?xC[t]||xC[t.toLowerCase()]:void 0}function Qm(t){var e={},r,n;for(n in t)be(t,n)&&(r=qr(n),r&&(e[r]=t[n]));return e}var dH={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function fH(t){var e=[],r;for(r in t)be(t,r)&&e.push({unit:r,priority:dH[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var UT=/\d/,_r=/\d\d/,YT=/\d{3}/,ep=/\d{4}/,mc=/[+-]?\d{6}/,We=/\d\d?/,qT=/\d\d\d\d?/,GT=/\d\d\d\d\d\d?/,pc=/\d{1,3}/,tp=/\d{1,4}/,wc=/[+-]?\d{1,6}/,Fs=/\d+/,vc=/[+-]?\d+/,gH=/Z|[+-]\d\d:?\d\d/gi,yc=/Z|[+-]\d\d(?::?\d\d)?/gi,mH=/[+-]?\d+(\.\d{1,3})?/,cl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Vs=/^[1-9]\d?/,rp=/^([1-9]\d|\d)/,Lu;Lu={};function z(t,e,r){Lu[t]=Dn(e)?e:function(n,i){return n&&r?r:e}}function pH(t,e){return be(Lu,t)?Lu[t](e._strict,e._locale):new RegExp(wH(t))}function wH(t){return ni(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function ni(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Lr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function me(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Lr(e)),r}var Jg={};function Ne(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),oi(e)&&(n=function(o,s){s[e]=me(o)}),i=t.length,r=0;r<i;r++)Jg[t[r]]=n}function hl(t,e){Ne(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function vH(t,e,r){e!=null&&be(Jg,t)&&Jg[t](e,r._a,r,t)}function bc(t){return t%4===0&&t%100!==0||t%400===0}var xt=0,ei=1,Tn=2,mt=3,ln=4,ti=5,mo=6,yH=7,bH=8;Q("Y",0,0,function(){var t=this.year();return t<=9999?Pn(t,4):"+"+t});Q(0,["YY",2],0,function(){return this.year()%100});Q(0,["YYYY",4],0,"year");Q(0,["YYYYY",5],0,"year");Q(0,["YYYYYY",6,!0],0,"year");z("Y",vc);z("YY",We,_r);z("YYYY",tp,ep);z("YYYYY",wc,mc);z("YYYYYY",wc,mc);Ne(["YYYYY","YYYYYY"],xt);Ne("YYYY",function(t,e){e[xt]=t.length===2?W.parseTwoDigitYear(t):me(t)});Ne("YY",function(t,e){e[xt]=W.parseTwoDigitYear(t)});Ne("Y",function(t,e){e[xt]=parseInt(t,10)});function Na(t){return bc(t)?366:365}W.parseTwoDigitYear=function(t){return me(t)+(me(t)>68?1900:2e3)};var KT=Ws("FullYear",!0);function CH(){return bc(this.year())}function Ws(t,e){return function(r){return r!=null?(XT(this,t,r),W.updateOffset(this,e),this):za(this,t)}}function za(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function XT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!bc(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function SH(t){return t=qr(t),Dn(this[t])?this[t]():this}function RH(t,e){if(typeof t=="object"){t=Qm(t);var r=fH(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=qr(t),Dn(this[t]))return this[t](e);return this}function EH(t,e){return(t%e+e)%e}var it;Array.prototype.indexOf?it=Array.prototype.indexOf:it=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function np(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=EH(e,12);return t+=(e-r)/12,r===1?bc(t)?29:28:31-r%7%2}Q("M",["MM",2],"Mo",function(){return this.month()+1});Q("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Q("MMMM",0,0,function(t){return this.localeData().months(this,t)});z("M",We,Vs);z("MM",We,_r);z("MMM",function(t,e){return e.monthsShortRegex(t)});z("MMMM",function(t,e){return e.monthsRegex(t)});Ne(["M","MM"],function(t,e){e[ei]=me(t)-1});Ne(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[ei]=i:ae(r).invalidMonth=t});var TH="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ZT="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),JT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,_H=cl,OH=cl;function MH(t,e){return t?un(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||JT).test(e)?"format":"standalone"][t.month()]:un(this._months)?this._months:this._months.standalone}function IH(t,e){return t?un(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[JT.test(e)?"format":"standalone"][t.month()]:un(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function PH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=An([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=it.call(this._shortMonthsParse,s),i!==-1?i:null):(i=it.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=it.call(this._shortMonthsParse,s),i!==-1?i:(i=it.call(this._longMonthsParse,s),i!==-1?i:null)):(i=it.call(this._longMonthsParse,s),i!==-1?i:(i=it.call(this._shortMonthsParse,s),i!==-1?i:null))}function xH(t,e,r){var n,i,o;if(this._monthsParseExact)return PH.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=An([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function QT(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=me(e);else if(e=t.localeData().monthsParse(e),!oi(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,np(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function e_(t){return t!=null?(QT(this,t),W.updateOffset(this,!0),this):za(this,"Month")}function HH(){return np(this.year(),this.month())}function AH(t){return this._monthsParseExact?(be(this,"_monthsRegex")||t_.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(be(this,"_monthsShortRegex")||(this._monthsShortRegex=_H),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function DH(t){return this._monthsParseExact?(be(this,"_monthsRegex")||t_.call(this),t?this._monthsStrictRegex:this._monthsRegex):(be(this,"_monthsRegex")||(this._monthsRegex=OH),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function t_(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=An([2e3,i]),s=ni(this.monthsShort(o,"")),a=ni(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function NH(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function Ua(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Fu(t,e,r){var n=7+e-r,i=(7+Ua(t,0,n).getUTCDay()-e)%7;return-i+n-1}function r_(t,e,r,n,i){var o=(7+r-n)%7,s=Fu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Na(l)+a):a>Na(t)?(l=t+1,u=a-Na(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ya(t,e,r){var n=Fu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+ii(s,e,r)):i>ii(t.year(),e,r)?(o=i-ii(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function ii(t,e,r){var n=Fu(t,e,r),i=Fu(t+1,e,r);return(Na(t)-n+i)/7}Q("w",["ww",2],"wo","week");Q("W",["WW",2],"Wo","isoWeek");z("w",We,Vs);z("ww",We,_r);z("W",We,Vs);z("WW",We,_r);hl(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=me(t)});function kH(t){return Ya(t,this._week.dow,this._week.doy).week}var LH={dow:0,doy:6};function FH(){return this._week.dow}function VH(){return this._week.doy}function WH(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function BH(t){var e=Ya(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Q("d",0,"do","day");Q("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Q("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Q("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Q("e",0,0,"weekday");Q("E",0,0,"isoWeekday");z("d",We);z("e",We);z("E",We);z("dd",function(t,e){return e.weekdaysMinRegex(t)});z("ddd",function(t,e){return e.weekdaysShortRegex(t)});z("dddd",function(t,e){return e.weekdaysRegex(t)});hl(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:ae(r).invalidWeekday=t});hl(["d","e","E"],function(t,e,r,n){e[n]=me(t)});function $H(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function jH(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function ip(t,e){return t.slice(e,7).concat(t.slice(0,e))}var zH="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),n_="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),UH="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),YH=cl,qH=cl,GH=cl;function KH(t,e){var r=un(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?ip(r,this._week.dow):t?r[t.day()]:r}function XH(t){return t===!0?ip(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function ZH(t){return t===!0?ip(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function JH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=An([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=it.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=it.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=it.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=it.call(this._weekdaysParse,s),i!==-1||(i=it.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=it.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=it.call(this._shortWeekdaysParse,s),i!==-1||(i=it.call(this._weekdaysParse,s),i!==-1)?i:(i=it.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=it.call(this._minWeekdaysParse,s),i!==-1||(i=it.call(this._weekdaysParse,s),i!==-1)?i:(i=it.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function QH(t,e,r){var n,i,o;if(this._weekdaysParseExact)return JH.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=An([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function eA(t){if(!this.isValid())return t!=null?this:NaN;var e=za(this,"Day");return t!=null?(t=$H(t,this.localeData()),this.add(t-e,"d")):e}function tA(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function rA(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=jH(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function nA(t){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||op.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(be(this,"_weekdaysRegex")||(this._weekdaysRegex=YH),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function iA(t){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||op.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(be(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=qH),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function oA(t){return this._weekdaysParseExact?(be(this,"_weekdaysRegex")||op.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(be(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=GH),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function op(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=An([2e3,1]).day(o),a=ni(this.weekdaysMin(s,"")),l=ni(this.weekdaysShort(s,"")),u=ni(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function sp(){return this.hours()%12||12}function sA(){return this.hours()||24}Q("H",["HH",2],0,"hour");Q("h",["hh",2],0,sp);Q("k",["kk",2],0,sA);Q("hmm",0,0,function(){return""+sp.apply(this)+Pn(this.minutes(),2)});Q("hmmss",0,0,function(){return""+sp.apply(this)+Pn(this.minutes(),2)+Pn(this.seconds(),2)});Q("Hmm",0,0,function(){return""+this.hours()+Pn(this.minutes(),2)});Q("Hmmss",0,0,function(){return""+this.hours()+Pn(this.minutes(),2)+Pn(this.seconds(),2)});function i_(t,e){Q(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}i_("a",!0);i_("A",!1);function o_(t,e){return e._meridiemParse}z("a",o_);z("A",o_);z("H",We,rp);z("h",We,Vs);z("k",We,Vs);z("HH",We,_r);z("hh",We,_r);z("kk",We,_r);z("hmm",qT);z("hmmss",GT);z("Hmm",qT);z("Hmmss",GT);Ne(["H","HH"],mt);Ne(["k","kk"],function(t,e,r){var n=me(t);e[mt]=n===24?0:n});Ne(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Ne(["h","hh"],function(t,e,r){e[mt]=me(t),ae(r).bigHour=!0});Ne("hmm",function(t,e,r){var n=t.length-2;e[mt]=me(t.substr(0,n)),e[ln]=me(t.substr(n)),ae(r).bigHour=!0});Ne("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[mt]=me(t.substr(0,n)),e[ln]=me(t.substr(n,2)),e[ti]=me(t.substr(i)),ae(r).bigHour=!0});Ne("Hmm",function(t,e,r){var n=t.length-2;e[mt]=me(t.substr(0,n)),e[ln]=me(t.substr(n))});Ne("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[mt]=me(t.substr(0,n)),e[ln]=me(t.substr(n,2)),e[ti]=me(t.substr(i))});function aA(t){return(t+"").toLowerCase().charAt(0)==="p"}var lA=/[ap]\.?m?\.?/i,uA=Ws("Hours",!0);function cA(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var s_={calendar:Jx,longDateFormat:rH,invalidDate:iH,ordinal:sH,dayOfMonthOrdinalParse:aH,relativeTime:uH,months:TH,monthsShort:ZT,week:LH,weekdays:zH,weekdaysMin:UH,weekdaysShort:n_,meridiemParse:lA},Ye={},Xs={},qa;function hA(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function HC(t){return t&&t.toLowerCase().replace("_","-")}function dA(t){for(var e=0,r,n,i,o;e<t.length;){for(o=HC(t[e]).split("-"),r=o.length,n=HC(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Cc(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&hA(o,n)>=r-1)break;r--}e++}return qa}function fA(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Cc(t){var e=null,r;if(Ye[t]===void 0&&typeof xu<"u"&&xu&&xu.exports&&fA(t))try{e=qa._abbr,r=require,r("./locale/"+t),Li(e)}catch{Ye[t]=null}return Ye[t]}function Li(t,e){var r;return t&&(er(e)?r=li(t):r=ap(t,e),r?qa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),qa._abbr}function ap(t,e){if(e!==null){var r,n=s_;if(e.abbr=t,Ye[t]!=null)jT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ye[t]._config;else if(e.parentLocale!=null)if(Ye[e.parentLocale]!=null)n=Ye[e.parentLocale]._config;else if(r=Cc(e.parentLocale),r!=null)n=r._config;else return Xs[e.parentLocale]||(Xs[e.parentLocale]=[]),Xs[e.parentLocale].push({name:t,config:e}),null;return Ye[t]=new Zm(Xg(n,e)),Xs[t]&&Xs[t].forEach(function(i){ap(i.name,i.config)}),Li(t),Ye[t]}else return delete Ye[t],null}function gA(t,e){if(e!=null){var r,n,i=s_;Ye[t]!=null&&Ye[t].parentLocale!=null?Ye[t].set(Xg(Ye[t]._config,e)):(n=Cc(t),n!=null&&(i=n._config),e=Xg(i,e),n==null&&(e.abbr=t),r=new Zm(e),r.parentLocale=Ye[t],Ye[t]=r),Li(t)}else Ye[t]!=null&&(Ye[t].parentLocale!=null?(Ye[t]=Ye[t].parentLocale,t===Li()&&Li(t)):Ye[t]!=null&&delete Ye[t]);return Ye[t]}function li(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return qa;if(!un(t)){if(e=Cc(t),e)return e;t=[t]}return dA(t)}function mA(){return Zg(Ye)}function lp(t){var e,r=t._a;return r&&ae(t).overflow===-2&&(e=r[ei]<0||r[ei]>11?ei:r[Tn]<1||r[Tn]>np(r[xt],r[ei])?Tn:r[mt]<0||r[mt]>24||r[mt]===24&&(r[ln]!==0||r[ti]!==0||r[mo]!==0)?mt:r[ln]<0||r[ln]>59?ln:r[ti]<0||r[ti]>59?ti:r[mo]<0||r[mo]>999?mo:-1,ae(t)._overflowDayOfYear&&(e<xt||e>Tn)&&(e=Tn),ae(t)._overflowWeeks&&e===-1&&(e=yH),ae(t)._overflowWeekday&&e===-1&&(e=bH),ae(t).overflow=e),t}var pA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vA=/Z|[+-]\d\d(?::?\d\d)?/,_l=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Df=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],yA=/^\/?Date\((-?\d+)/i,bA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,CA={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function a_(t){var e,r,n=t._i,i=pA.exec(n)||wA.exec(n),o,s,a,l,u=_l.length,c=Df.length;if(i){for(ae(t).iso=!0,e=0,r=u;e<r;e++)if(_l[e][1].exec(i[1])){s=_l[e][0],o=_l[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(Df[e][1].exec(i[3])){a=(i[2]||" ")+Df[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(vA.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),cp(t)}else t._isValid=!1}function SA(t,e,r,n,i,o){var s=[RA(t),ZT.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function RA(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function EA(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function TA(t,e,r){if(t){var n=n_.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return ae(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function _A(t,e,r){if(t)return CA[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function l_(t){var e=bA.exec(EA(t._i)),r;if(e){if(r=SA(e[4],e[3],e[2],e[5],e[6],e[7]),!TA(e[1],r,t))return;t._a=r,t._tzm=_A(e[8],e[9],e[10]),t._d=Ua.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ae(t).rfc2822=!0}else t._isValid=!1}function OA(t){var e=yA.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(a_(t),t._isValid===!1)delete t._isValid;else return;if(l_(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:W.createFromInputFallback(t)}W.createFromInputFallback=Yr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function as(t,e,r){return t??e??r}function MA(t){var e=new Date(W.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function up(t){var e,r,n=[],i,o,s;if(!t._d){for(i=MA(t),t._w&&t._a[Tn]==null&&t._a[ei]==null&&IA(t),t._dayOfYear!=null&&(s=as(t._a[xt],i[xt]),(t._dayOfYear>Na(s)||t._dayOfYear===0)&&(ae(t)._overflowDayOfYear=!0),r=Ua(s,0,t._dayOfYear),t._a[ei]=r.getUTCMonth(),t._a[Tn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[mt]===24&&t._a[ln]===0&&t._a[ti]===0&&t._a[mo]===0&&(t._nextDay=!0,t._a[mt]=0),t._d=(t._useUTC?Ua:NH).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[mt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ae(t).weekdayMismatch=!0)}}function IA(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=as(e.GG,t._a[xt],Ya(Ve(),1,4).year),n=as(e.W,1),i=as(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ya(Ve(),o,s),r=as(e.gg,t._a[xt],u.year),n=as(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>ii(r,o,s)?ae(t)._overflowWeeks=!0:l!=null?ae(t)._overflowWeekday=!0:(a=r_(r,n,i,o,s),t._a[xt]=a.year,t._dayOfYear=a.dayOfYear)}W.ISO_8601=function(){};W.RFC_2822=function(){};function cp(t){if(t._f===W.ISO_8601){a_(t);return}if(t._f===W.RFC_2822){l_(t);return}t._a=[],ae(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=zT(t._f,t._locale).match(Jm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(pH(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&ae(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),ps[o]?(n?ae(t).empty=!1:ae(t).unusedTokens.push(o),vH(o,n,t)):t._strict&&!n&&ae(t).unusedTokens.push(o);ae(t).charsLeftOver=a-l,e.length>0&&ae(t).unusedInput.push(e),t._a[mt]<=12&&ae(t).bigHour===!0&&t._a[mt]>0&&(ae(t).bigHour=void 0),ae(t).parsedDateParts=t._a.slice(0),ae(t).meridiem=t._meridiem,t._a[mt]=PA(t._locale,t._a[mt],t._meridiem),u=ae(t).era,u!==null&&(t._a[xt]=t._locale.erasConvertYear(u,t._a[xt])),up(t),lp(t)}function PA(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function xA(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){ae(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Xm({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],cp(e),Km(e)&&(s=!0),o+=ae(e).charsLeftOver,o+=ae(e).unusedTokens.length*10,ae(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));Ii(t,r||e)}function HA(t){if(!t._d){var e=Qm(t._i),r=e.day===void 0?e.date:e.day;t._a=BT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),up(t)}}function AA(t){var e=new ul(lp(u_(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function u_(t){var e=t._i,r=t._f;return t._locale=t._locale||li(t._l),e===null||r===void 0&&e===""?gc({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),cn(e)?new ul(lp(e)):(ll(e)?t._d=e:un(r)?xA(t):r?cp(t):DA(t),Km(t)||(t._d=null),t))}function DA(t){var e=t._i;er(e)?t._d=new Date(W.now()):ll(e)?t._d=new Date(e.valueOf()):typeof e=="string"?OA(t):un(e)?(t._a=BT(e.slice(0),function(r){return parseInt(r,10)}),up(t)):yo(e)?HA(t):oi(e)?t._d=new Date(e):W.createFromInputFallback(t)}function c_(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(yo(t)&&Gm(t)||un(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,AA(o)}function Ve(t,e,r,n){return c_(t,e,r,n,!1)}var NA=Yr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:gc()}),kA=Yr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:gc()});function h_(t,e){var r,n;if(e.length===1&&un(e[0])&&(e=e[0]),!e.length)return Ve();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function LA(){var t=[].slice.call(arguments,0);return h_("isBefore",t)}function FA(){var t=[].slice.call(arguments,0);return h_("isAfter",t)}var VA=function(){return Date.now?Date.now():+new Date},Zs=["year","quarter","month","week","day","hour","minute","second","millisecond"];function WA(t){var e,r=!1,n,i=Zs.length;for(e in t)if(be(t,e)&&!(it.call(Zs,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Zs[n]]){if(r)return!1;parseFloat(t[Zs[n]])!==me(t[Zs[n]])&&(r=!0)}return!0}function BA(){return this._isValid}function $A(){return dn(NaN)}function Sc(t){var e=Qm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=WA(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=li(),this._bubble()}function bu(t){return t instanceof Sc}function Qg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function jA(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)me(t[s])!==me(e[s])&&o++;return o+i}function d_(t,e){Q(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Pn(~~(r/60),2)+e+Pn(~~r%60,2)})}d_("Z",":");d_("ZZ","");z("Z",yc);z("ZZ",yc);Ne(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=hp(yc,t)});var zA=/([\+\-]|\d\d)/gi;function hp(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(zA)||["-",0,0],o=+(i[1]*60)+me(i[2]),o===0?0:i[0]==="+"?o:-o)}function dp(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(cn(t)||ll(t)?t.valueOf():Ve(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),W.updateOffset(r,!1),r):Ve(t).local()}function em(t){return-Math.round(t._d.getTimezoneOffset())}W.updateOffset=function(){};function UA(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=hp(yc,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=em(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?m_(this,dn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,W.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:em(this)}function YA(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function qA(t){return this.utcOffset(0,t)}function GA(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(em(this),"m")),this}function KA(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=hp(gH,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function XA(t){return this.isValid()?(t=t?Ve(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function ZA(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function JA(){if(!er(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Xm(t,this),t=u_(t),t._a?(e=t._isUTC?An(t._a):Ve(t._a),this._isDSTShifted=this.isValid()&&jA(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function QA(){return this.isValid()?!this._isUTC:!1}function e1(){return this.isValid()?this._isUTC:!1}function f_(){return this.isValid()?this._isUTC&&this._offset===0:!1}var t1=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,r1=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function dn(t,e){var r=t,n=null,i,o,s;return bu(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:oi(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=t1.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:me(n[Tn])*i,h:me(n[mt])*i,m:me(n[ln])*i,s:me(n[ti])*i,ms:me(Qg(n[mo]*1e3))*i}):(n=r1.exec(t))?(i=n[1]==="-"?-1:1,r={y:Gi(n[2],i),M:Gi(n[3],i),w:Gi(n[4],i),d:Gi(n[5],i),h:Gi(n[6],i),m:Gi(n[7],i),s:Gi(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=n1(Ve(r.from),Ve(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Sc(r),bu(t)&&be(t,"_locale")&&(o._locale=t._locale),bu(t)&&be(t,"_isValid")&&(o._isValid=t._isValid),o}dn.fn=Sc.prototype;dn.invalid=$A;function Gi(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function AC(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function n1(t,e){var r;return t.isValid()&&e.isValid()?(e=dp(e,t),t.isBefore(e)?r=AC(t,e):(r=AC(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function g_(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(jT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=dn(r,n),m_(this,i,t),this}}function m_(t,e,r,n){var i=e._milliseconds,o=Qg(e._days),s=Qg(e._months);t.isValid()&&(n=n??!0,s&&QT(t,za(t,"Month")+s*r),o&&XT(t,"Date",za(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&W.updateOffset(t,o||s))}var i1=g_(1,"add"),o1=g_(-1,"subtract");function p_(t){return typeof t=="string"||t instanceof String}function s1(t){return cn(t)||ll(t)||p_(t)||oi(t)||l1(t)||a1(t)||t===null||t===void 0}function a1(t){var e=yo(t)&&!Gm(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||be(t,o);return e&&r}function l1(t){var e=un(t),r=!1;return e&&(r=t.filter(function(n){return!oi(n)&&p_(t)}).length===0),e&&r}function u1(t){var e=yo(t)&&!Gm(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||be(t,o);return e&&r}function c1(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function h1(t,e){arguments.length===1&&(arguments[0]?s1(arguments[0])?(t=arguments[0],e=void 0):u1(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ve(),n=dp(r,this).startOf("day"),i=W.calendarFormat(this,n)||"sameElse",o=e&&(Dn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Ve(r)))}function d1(){return new ul(this)}function f1(t,e){var r=cn(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=qr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function g1(t,e){var r=cn(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=qr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function m1(t,e,r,n){var i=cn(t)?t:Ve(t),o=cn(e)?e:Ve(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function p1(t,e){var r=cn(t)?t:Ve(t),n;return this.isValid()&&r.isValid()?(e=qr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function w1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function v1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function y1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=dp(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=qr(e),e){case"year":o=Cu(this,n)/12;break;case"month":o=Cu(this,n);break;case"quarter":o=Cu(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Lr(o)}function Cu(t,e){if(t.date()<e.date())return-Cu(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}W.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";W.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function b1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function C1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?yu(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Dn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",yu(r,"Z")):yu(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function S1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function R1(t){t||(t=this.isUtc()?W.defaultFormatUtc:W.defaultFormat);var e=yu(this,t);return this.localeData().postformat(e)}function E1(t,e){return this.isValid()&&(cn(t)&&t.isValid()||Ve(t).isValid())?dn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function T1(t){return this.from(Ve(),t)}function _1(t,e){return this.isValid()&&(cn(t)&&t.isValid()||Ve(t).isValid())?dn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function O1(t){return this.to(Ve(),t)}function w_(t){var e;return t===void 0?this._locale._abbr:(e=li(t),e!=null&&(this._locale=e),this)}var v_=Yr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function y_(){return this._locale}var Vu=1e3,ws=60*Vu,Wu=60*ws,b_=(365*400+97)*24*Wu;function vs(t,e){return(t%e+e)%e}function C_(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-b_:new Date(t,e,r).valueOf()}function S_(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-b_:Date.UTC(t,e,r)}function M1(t){var e,r;if(t=qr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?S_:C_,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=vs(e+(this._isUTC?0:this.utcOffset()*ws),Wu);break;case"minute":e=this._d.valueOf(),e-=vs(e,ws);break;case"second":e=this._d.valueOf(),e-=vs(e,Vu);break}return this._d.setTime(e),W.updateOffset(this,!0),this}function I1(t){var e,r;if(t=qr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?S_:C_,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Wu-vs(e+(this._isUTC?0:this.utcOffset()*ws),Wu)-1;break;case"minute":e=this._d.valueOf(),e+=ws-vs(e,ws)-1;break;case"second":e=this._d.valueOf(),e+=Vu-vs(e,Vu)-1;break}return this._d.setTime(e),W.updateOffset(this,!0),this}function P1(){return this._d.valueOf()-(this._offset||0)*6e4}function x1(){return Math.floor(this.valueOf()/1e3)}function H1(){return new Date(this.valueOf())}function A1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function D1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function N1(){return this.isValid()?this.toISOString():null}function k1(){return Km(this)}function L1(){return Ii({},ae(this))}function F1(){return ae(this).overflow}function V1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Q("N",0,0,"eraAbbr");Q("NN",0,0,"eraAbbr");Q("NNN",0,0,"eraAbbr");Q("NNNN",0,0,"eraName");Q("NNNNN",0,0,"eraNarrow");Q("y",["y",1],"yo","eraYear");Q("y",["yy",2],0,"eraYear");Q("y",["yyy",3],0,"eraYear");Q("y",["yyyy",4],0,"eraYear");z("N",fp);z("NN",fp);z("NNN",fp);z("NNNN",X1);z("NNNNN",Z1);Ne(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?ae(r).era=i:ae(r).invalidEra=t});z("y",Fs);z("yy",Fs);z("yyy",Fs);z("yyyy",Fs);z("yo",J1);Ne(["y","yy","yyy","yyyy"],xt);Ne(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[xt]=r._locale.eraYearOrdinalParse(t,i):e[xt]=parseInt(t,10)});function W1(t,e){var r,n,i,o=this._eras||li("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=W(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=W(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function B1(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function $1(t,e){var r=t.since<=t.until?1:-1;return e===void 0?W(t.since).year():W(t.since).year()+(e-t.offset)*r}function j1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function z1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function U1(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function Y1(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-W(i[t].since).year())*r+i[t].offset;return this.year()}function q1(t){return be(this,"_erasNameRegex")||gp.call(this),t?this._erasNameRegex:this._erasRegex}function G1(t){return be(this,"_erasAbbrRegex")||gp.call(this),t?this._erasAbbrRegex:this._erasRegex}function K1(t){return be(this,"_erasNarrowRegex")||gp.call(this),t?this._erasNarrowRegex:this._erasRegex}function fp(t,e){return e.erasAbbrRegex(t)}function X1(t,e){return e.erasNameRegex(t)}function Z1(t,e){return e.erasNarrowRegex(t)}function J1(t,e){return e._eraYearOrdinalRegex||Fs}function gp(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=ni(u[i].name),a=ni(u[i].abbr),l=ni(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Q(0,["gg",2],0,function(){return this.weekYear()%100});Q(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Rc(t,e){Q(0,[t,t.length],0,e)}Rc("gggg","weekYear");Rc("ggggg","weekYear");Rc("GGGG","isoWeekYear");Rc("GGGGG","isoWeekYear");z("G",vc);z("g",vc);z("GG",We,_r);z("gg",We,_r);z("GGGG",tp,ep);z("gggg",tp,ep);z("GGGGG",wc,mc);z("ggggg",wc,mc);hl(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=me(t)});hl(["gg","GG"],function(t,e,r,n){e[n]=W.parseTwoDigitYear(t)});function Q1(t){return R_.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function eD(t){return R_.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function tD(){return ii(this.year(),1,4)}function rD(){return ii(this.isoWeekYear(),1,4)}function nD(){var t=this.localeData()._week;return ii(this.year(),t.dow,t.doy)}function iD(){var t=this.localeData()._week;return ii(this.weekYear(),t.dow,t.doy)}function R_(t,e,r,n,i){var o;return t==null?Ya(this,n,i).year:(o=ii(t,n,i),e>o&&(e=o),oD.call(this,t,e,r,n,i))}function oD(t,e,r,n,i){var o=r_(t,e,r,n,i),s=Ua(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Q("Q",0,"Qo","quarter");z("Q",UT);Ne("Q",function(t,e){e[ei]=(me(t)-1)*3});function sD(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Q("D",["DD",2],"Do","date");z("D",We,Vs);z("DD",We,_r);z("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Ne(["D","DD"],Tn);Ne("Do",function(t,e){e[Tn]=me(t.match(We)[0])});var E_=Ws("Date",!0);Q("DDD",["DDDD",3],"DDDo","dayOfYear");z("DDD",pc);z("DDDD",YT);Ne(["DDD","DDDD"],function(t,e,r){r._dayOfYear=me(t)});function aD(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Q("m",["mm",2],0,"minute");z("m",We,rp);z("mm",We,_r);Ne(["m","mm"],ln);var lD=Ws("Minutes",!1);Q("s",["ss",2],0,"second");z("s",We,rp);z("ss",We,_r);Ne(["s","ss"],ti);var uD=Ws("Seconds",!1);Q("S",0,0,function(){return~~(this.millisecond()/100)});Q(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Q(0,["SSS",3],0,"millisecond");Q(0,["SSSS",4],0,function(){return this.millisecond()*10});Q(0,["SSSSS",5],0,function(){return this.millisecond()*100});Q(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Q(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Q(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Q(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});z("S",pc,UT);z("SS",pc,_r);z("SSS",pc,YT);var Pi,T_;for(Pi="SSSS";Pi.length<=9;Pi+="S")z(Pi,Fs);function cD(t,e){e[mo]=me(("0."+t)*1e3)}for(Pi="S";Pi.length<=9;Pi+="S")Ne(Pi,cD);T_=Ws("Milliseconds",!1);Q("z",0,0,"zoneAbbr");Q("zz",0,0,"zoneName");function hD(){return this._isUTC?"UTC":""}function dD(){return this._isUTC?"Coordinated Universal Time":""}var D=ul.prototype;D.add=i1;D.calendar=h1;D.clone=d1;D.diff=y1;D.endOf=I1;D.format=R1;D.from=E1;D.fromNow=T1;D.to=_1;D.toNow=O1;D.get=SH;D.invalidAt=F1;D.isAfter=f1;D.isBefore=g1;D.isBetween=m1;D.isSame=p1;D.isSameOrAfter=w1;D.isSameOrBefore=v1;D.isValid=k1;D.lang=v_;D.locale=w_;D.localeData=y_;D.max=kA;D.min=NA;D.parsingFlags=L1;D.set=RH;D.startOf=M1;D.subtract=o1;D.toArray=A1;D.toObject=D1;D.toDate=H1;D.toISOString=C1;D.inspect=S1;typeof Symbol<"u"&&Symbol.for!=null&&(D[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});D.toJSON=N1;D.toString=b1;D.unix=x1;D.valueOf=P1;D.creationData=V1;D.eraName=j1;D.eraNarrow=z1;D.eraAbbr=U1;D.eraYear=Y1;D.year=KT;D.isLeapYear=CH;D.weekYear=Q1;D.isoWeekYear=eD;D.quarter=D.quarters=sD;D.month=e_;D.daysInMonth=HH;D.week=D.weeks=WH;D.isoWeek=D.isoWeeks=BH;D.weeksInYear=nD;D.weeksInWeekYear=iD;D.isoWeeksInYear=tD;D.isoWeeksInISOWeekYear=rD;D.date=E_;D.day=D.days=eA;D.weekday=tA;D.isoWeekday=rA;D.dayOfYear=aD;D.hour=D.hours=uA;D.minute=D.minutes=lD;D.second=D.seconds=uD;D.millisecond=D.milliseconds=T_;D.utcOffset=UA;D.utc=qA;D.local=GA;D.parseZone=KA;D.hasAlignedHourOffset=XA;D.isDST=ZA;D.isLocal=QA;D.isUtcOffset=e1;D.isUtc=f_;D.isUTC=f_;D.zoneAbbr=hD;D.zoneName=dD;D.dates=Yr("dates accessor is deprecated. Use date instead.",E_);D.months=Yr("months accessor is deprecated. Use month instead",e_);D.years=Yr("years accessor is deprecated. Use year instead",KT);D.zone=Yr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",YA);D.isDSTShifted=Yr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",JA);function fD(t){return Ve(t*1e3)}function gD(){return Ve.apply(null,arguments).parseZone()}function __(t){return t}var Ce=Zm.prototype;Ce.calendar=Qx;Ce.longDateFormat=nH;Ce.invalidDate=oH;Ce.ordinal=lH;Ce.preparse=__;Ce.postformat=__;Ce.relativeTime=cH;Ce.pastFuture=hH;Ce.set=Zx;Ce.eras=W1;Ce.erasParse=B1;Ce.erasConvertYear=$1;Ce.erasAbbrRegex=G1;Ce.erasNameRegex=q1;Ce.erasNarrowRegex=K1;Ce.months=MH;Ce.monthsShort=IH;Ce.monthsParse=xH;Ce.monthsRegex=DH;Ce.monthsShortRegex=AH;Ce.week=kH;Ce.firstDayOfYear=VH;Ce.firstDayOfWeek=FH;Ce.weekdays=KH;Ce.weekdaysMin=ZH;Ce.weekdaysShort=XH;Ce.weekdaysParse=QH;Ce.weekdaysRegex=nA;Ce.weekdaysShortRegex=iA;Ce.weekdaysMinRegex=oA;Ce.isPM=aA;Ce.meridiem=cA;function Bu(t,e,r,n){var i=li(),o=An().set(n,e);return i[r](o,t)}function O_(t,e,r){if(oi(t)&&(e=t,t=void 0),t=t||"",e!=null)return Bu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=Bu(t,n,r,"month");return i}function mp(t,e,r,n){typeof t=="boolean"?(oi(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,oi(e)&&(r=e,e=void 0),e=e||"");var i=li(),o=t?i._week.dow:0,s,a=[];if(r!=null)return Bu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=Bu(e,(s+o)%7,n,"day");return a}function mD(t,e){return O_(t,e,"months")}function pD(t,e){return O_(t,e,"monthsShort")}function wD(t,e,r){return mp(t,e,r,"weekdays")}function vD(t,e,r){return mp(t,e,r,"weekdaysShort")}function yD(t,e,r){return mp(t,e,r,"weekdaysMin")}Li("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=me(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});W.lang=Yr("moment.lang is deprecated. Use moment.locale instead.",Li);W.langData=Yr("moment.langData is deprecated. Use moment.localeData instead.",li);var Wn=Math.abs;function bD(){var t=this._data;return this._milliseconds=Wn(this._milliseconds),this._days=Wn(this._days),this._months=Wn(this._months),t.milliseconds=Wn(t.milliseconds),t.seconds=Wn(t.seconds),t.minutes=Wn(t.minutes),t.hours=Wn(t.hours),t.months=Wn(t.months),t.years=Wn(t.years),this}function M_(t,e,r,n){var i=dn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function CD(t,e){return M_(this,t,e,1)}function SD(t,e){return M_(this,t,e,-1)}function DC(t){return t<0?Math.floor(t):Math.ceil(t)}function RD(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=DC(tm(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Lr(t/1e3),n.seconds=i%60,o=Lr(i/60),n.minutes=o%60,s=Lr(o/60),n.hours=s%24,e+=Lr(s/24),l=Lr(I_(e)),r+=l,e-=DC(tm(l)),a=Lr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function I_(t){return t*4800/146097}function tm(t){return t*146097/4800}function ED(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=qr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+I_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(tm(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function ui(t){return function(){return this.as(t)}}var P_=ui("ms"),TD=ui("s"),_D=ui("m"),OD=ui("h"),MD=ui("d"),ID=ui("w"),PD=ui("M"),xD=ui("Q"),HD=ui("y"),AD=P_;function DD(){return dn(this)}function ND(t){return t=qr(t),this.isValid()?this[t+"s"]():NaN}function Do(t){return function(){return this.isValid()?this._data[t]:NaN}}var kD=Do("milliseconds"),LD=Do("seconds"),FD=Do("minutes"),VD=Do("hours"),WD=Do("days"),BD=Do("months"),$D=Do("years");function jD(){return Lr(this.days()/7)}var Xn=Math.round,hs={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function zD(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function UD(t,e,r,n){var i=dn(t).abs(),o=Xn(i.as("s")),s=Xn(i.as("m")),a=Xn(i.as("h")),l=Xn(i.as("d")),u=Xn(i.as("M")),c=Xn(i.as("w")),h=Xn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,zD.apply(null,d)}function YD(t){return t===void 0?Xn:typeof t=="function"?(Xn=t,!0):!1}function qD(t,e){return hs[t]===void 0?!1:e===void 0?hs[t]:(hs[t]=e,t==="s"&&(hs.ss=e-1),!0)}function GD(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=hs,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},hs,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=UD(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Nf=Math.abs;function Bo(t){return(t>0)-(t<0)||+t}function Ec(){if(!this.isValid())return this.localeData().invalidDate();var t=Nf(this._milliseconds)/1e3,e=Nf(this._days),r=Nf(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Lr(t/60),i=Lr(n/60),t%=60,n%=60,o=Lr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Bo(this._months)!==Bo(a)?"-":"",c=Bo(this._days)!==Bo(a)?"-":"",h=Bo(this._milliseconds)!==Bo(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var ve=Sc.prototype;ve.isValid=BA;ve.abs=bD;ve.add=CD;ve.subtract=SD;ve.as=ED;ve.asMilliseconds=P_;ve.asSeconds=TD;ve.asMinutes=_D;ve.asHours=OD;ve.asDays=MD;ve.asWeeks=ID;ve.asMonths=PD;ve.asQuarters=xD;ve.asYears=HD;ve.valueOf=AD;ve._bubble=RD;ve.clone=DD;ve.get=ND;ve.milliseconds=kD;ve.seconds=LD;ve.minutes=FD;ve.hours=VD;ve.days=WD;ve.weeks=jD;ve.months=BD;ve.years=$D;ve.humanize=GD;ve.toISOString=Ec;ve.toString=Ec;ve.toJSON=Ec;ve.locale=w_;ve.localeData=y_;ve.toIsoString=Yr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ec);ve.lang=v_;Q("X",0,0,"unix");Q("x",0,0,"valueOf");z("x",vc);z("X",mH);Ne("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Ne("x",function(t,e,r){r._d=new Date(me(t))});//! moment.js
W.version="2.30.1";Kx(Ve);W.fn=D;W.min=LA;W.max=FA;W.now=VA;W.utc=An;W.unix=fD;W.months=mD;W.isDate=ll;W.locale=Li;W.invalid=gc;W.duration=dn;W.isMoment=cn;W.weekdays=wD;W.parseZone=gD;W.localeData=li;W.isDuration=bu;W.monthsShort=pD;W.weekdaysMin=yD;W.defineLocale=ap;W.updateLocale=gA;W.locales=mA;W.weekdaysShort=vD;W.normalizeUnits=qr;W.relativeTimeRounding=YD;W.relativeTimeThreshold=qD;W.calendarFormat=c1;W.prototype=D;W.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var NC={},kC={},LC;function KD(){if(LC)return kC;LC=1;var t=Fe(),e=Ls(),r=Er(),n=yt(),i=zi(),o=Tr(),s=Ao(),a=ol(),l=dt(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(C){o(this,"throw",C)}var w=arguments.length<2,v=w?void 0:arguments[1];if(h)return a(h,this,w?[g]:[g,v]);var b=i(this),T=0;if(e(b,function(C){w?(w=!1,v=C):v=g(v,C,T),T++},{IS_RECORD:!0}),w)throw new u("Reduce of empty iterator with no initial value");return v}}),kC}var FC;function XD(){return FC||(FC=1,KD()),NC}XD();function ZD(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function VC(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function kf(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function No(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function pp(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function xn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function j(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function WC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return j(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function BC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function ar(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return No(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function wp(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function de(t){return typeof t<"u"}function $t(t){return typeof t>"u"}function Co(t){return t===null||t===""||$t(t)}function JD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const _a="length",ka=t=>parseInt(t,16),$C=t=>parseInt(t,10),$u=(t,e,r)=>t.substr(e,r),La=t=>t.codePointAt(0)-65,rm=t=>`${t}`.replace(/\-/g,""),QD=t=>ka($u(rm(t),ka("12"),La("F")))/(ka($u(rm(t),La("B"),~~![][_a]))||9),eN=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let jC=!1;const zC={invalid:()=>ar`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ar`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ar`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},UC={invalid:()=>ar`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return ar`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ar`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function tN(t,e){const r=!Co(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.1.1";let o,s="invalid",a="invalid";t=rm(t||"");const l=rN(t);if(r||n||l)if(l){const u=W("23/09/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=QD(t);o=W((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(eN()&&(s="valid",a="valid"),!jC&&s!=="valid"&&(zC[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](zC[s]({keyValidityDate:o,hotVersion:i})),jC=!0),a!=="valid"&&e&&UC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=UC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function rN(t){let e=[][_a],r=e;if(t[_a]!==La("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=La(i.shift());o;o=La(i.shift()||"A"))--o<""[_a]?r=r|($C(`${$C(ka(n)+(ka($u(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=$u(t,o,o?i[_a]===1?9:8:6);return r===e}function nm(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function im(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function Tc(t){return t[0].toUpperCase()+t.substr(1)}function x_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function nN(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function iN(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function H_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function A_(t,e){return Gx.sanitize(t,e)}const ko=t=>["tabindex",t],oN=()=>["role","treegrid"],xi=()=>["role","presentation"],sN=()=>["role","gridcell"],aN=()=>["role","gridcell button"],lN=()=>["role","rowheader"],D_=()=>["role","rowgroup"],uN=()=>["role","columnheader"],N_=()=>["role","row"],cN=()=>["role","menu"],hN=()=>["role","menuitem"],dN=()=>["role","menuitemcheckbox"],fN=()=>["scope","col"],gN=()=>["scope","row"],ju=t=>["aria-label",t],mN=()=>["aria-hidden","true"],pN=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},wN=()=>["aria-multiselectable","true"],k_=t=>["aria-rowcount",t],_c=t=>["aria-colcount",t],L_=t=>["aria-rowindex",t],vp=t=>["aria-colindex",t],Su=t=>["aria-expanded",t],YC=()=>["aria-readonly","true"],qC=()=>["aria-invalid","true"],vN=t=>["aria-checked",t],F_=()=>["aria-selected","true"];var GC={},Lf,KC;function yN(){if(KC)return Lf;KC=1;var t=at(),e=vT(),r=ft(),n=Oo(),i=fc(),o=t([].push);return Lf=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,w){if(d)return d=!1,w;if(e(this))return w;for(var v=0;v<h;v++)if(l[v]===g)return w}}},Lf}var XC;function bN(){if(XC)return GC;XC=1;var t=Fe(),e=As(),r=ol(),n=vt(),i=at(),o=dt(),s=ft(),a=Lm(),l=qm(),u=yN(),c=km(),h=String,d=e("JSON","stringify"),g=i(/./.exec),w=i("".charAt),v=i("".charCodeAt),b=i("".replace),T=i(1.1.toString),C=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var F=e("Symbol")("stringify detection");return d([F])!=="[null]"||d({a:F})!=="{}"||d(Object(F))!=="{}"}),H=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),P=function(F,B){var K=l(arguments),L=u(B);if(!(!s(L)&&(F===void 0||a(F))))return K[1]=function(oe,X){if(s(L)&&(X=n(L,this,h(oe),X)),!a(X))return X},r(d,null,K)},A=function(F,B,K){var L=w(K,B-1),oe=w(K,B+1);return g(E,F)&&!g(y,oe)||g(y,F)&&!g(E,L)?"\\u"+T(v(F,0),16):F};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||H},{stringify:function(B,K,L){var oe=l(arguments),X=r(M?P:d,null,oe);return H&&typeof X=="string"?b(X,C,A):X}}),GC}bN();function Ga(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ie(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Ga(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Ga(r[0])]:e[n]=[]:e[n]=null)})),e}function CN(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Vi(t,e,r){const n=Array.isArray(r);return Ie(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function V_(t,e){Ie(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),V_(t[n],e[n])):t[n]=e[n]})}function Rr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Qe(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Ie(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=w=>{let v=w;return(Array.isArray(v)||ot(v))&&(v=Rr(v)),v};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function W_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ot(t){return Object.prototype.toString.call(t)==="[object Object]"}function ci(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Ie(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function om(t,e){const r=e.split(".");let n=t;return Ie(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Ff(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(Br(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function yp(t){if(!ot(t))return 0;const e=function(r){let n=0;return ot(r)?Ie(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function yr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Br(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ru(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const r={};return Object.keys(e).forEach(n=>{typeof e[n]=="object"&&e[n]!==null&&!Array.isArray(e[n])?r[n]=Ru(t[n],e[n]):r[n]=Br(t,n)&&t[n]!==void 0?t[n]:e[n]}),Object.keys(t).forEach(n=>{Br(r,n)||(r[n]=t[n])}),r}function sm(t){return window.requestAnimationFrame(t)}function ZC(t){window.cancelAnimationFrame(t)}function SN(){return"ontouchstart"in window}function RN(){return typeof window<"u"}const kr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Ui={chrome:kr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:kr(t=>/CriOS/.test(t)),edge:kr(t=>/Edge/.test(t)),edgeWebKit:kr(t=>/EdgiOS/.test(t)),firefox:kr(t=>/Firefox/.test(t)),firefoxWebKit:kr(t=>/FxiOS/.test(t)),mobile:kr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:kr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},dl={mac:kr(t=>/^Mac/.test(t)),win:kr(t=>/^Win/.test(t)),linux:kr(t=>/^Linux/.test(t)),ios:kr(t=>/iPhone|iPad|iPod/i.test(t))};function EN(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ie(Ui,r=>{let{test:n}=r;return void n(t,e)})}function TN(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ie(dl,e=>{let{test:r}=e;return void r(t)})}RN()&&(EN(),TN());function _N(){return Ui.chrome.value}function ON(){return Ui.chromeWebKit.value}function Vf(){return Ui.firefox.value}function MN(){return Ui.firefoxWebKit.value}function bp(){return Ui.safari.value}function IN(){return Ui.edge.value}function Hi(){return Ui.mobile.value}function B_(){return dl.ios.value}function $_(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&dl.mac.value}function JC(){return dl.win.value}function QC(){return dl.mac.value}function PN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Eu(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function xN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Ka(t){return xN(t)&&t.parent}function j_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Ol(t,e,r){const n=[];let i=t;for(;i&&(i=j_(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function HN(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function ys(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function AN(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Ki(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function z_(t){return!t||!t.length?[]:t.filter(e=>!!e)}function U_(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Z(t,e){typeof e=="string"&&(e=e.split(" ")),e=z_(e),e.length>0&&t.classList.add(...e)}function Me(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=U_(e,!0);r=z_(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Te(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function fl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=U_(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Y_(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)Y_(e[r])}}function Os(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const DN=/(<(.*)>|&(.*);)/;function q_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;DN.test(e)?t.innerHTML=r?A_(e):e:gl(t,e)}function gl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Os(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Xa(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Xa(n.host.impl);if(n.host)return Xa(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function NN(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function Fr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function G_(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Cp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Sp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?G_(e):t.scrollTop}function K_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Cp(e):t.scrollLeft}function zu(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function kN(t){return t.scrollHeight-t.clientHeight}function LN(t){return t.scrollWidth-t.clientWidth}function Uu(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function eS(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function or(t){return t.offsetWidth}function lr(t){return t.getBoundingClientRect().height}function Fa(t){return t.clientHeight||t.innerHeight}function X_(t){return t.clientWidth||t.innerWidth}function FN(t){return t.selectionStart?t.selectionStart:0}function tS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Z_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let Wf;function VN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");bp()&&!Hi()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.getBoundingClientRect().width;r.style.overflow="scroll";let i=e.getBoundingClientRect().width;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),parseFloat((n-i).toFixed(3))}function Ut(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Wf===void 0&&(Wf=VN(t)),Wf}function WN(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function BN(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Rp(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Oc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Tu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function J_(t){return Tu(t)&&t.hasAttribute("data-hot-input")===!1}function $N(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Q_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Te(t,"contenteditable",!0),r&&Te(t,...mN()),e&&Z(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function e0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Me(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function jN(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Q_(t,r),e(),e0(t,r)}function bo(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Ee(t){return typeof t=="function"}function t0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function zN(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function am(t,e,r,n,i,o,s,a){return de(a)?t.call(e,r,n,i,o,s,a):de(s)?t.call(e,r,n,i,o,s):de(o)?t.call(e,r,n,i,o):de(i)?t.call(e,r,n,i):de(n)?t.call(e,r,n):de(r)?t.call(e,r):t.call(e)}const ee={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Vf()?182:174,AUDIO_MUTE:Vf()?181:173,AUDIO_UP:Vf()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},UN=[ee.ALT,ee.ARROW_DOWN,ee.ARROW_LEFT,ee.ARROW_RIGHT,ee.ARROW_UP,ee.AUDIO_DOWN,ee.AUDIO_MUTE,ee.AUDIO_UP,ee.BACKSPACE,ee.CAPS_LOCK,ee.DELETE,ee.END,ee.ENTER,ee.ESCAPE,ee.F1,ee.F2,ee.F3,ee.F4,ee.F5,ee.F6,ee.F7,ee.F8,ee.F9,ee.F10,ee.F11,ee.F12,ee.F13,ee.F14,ee.F15,ee.F16,ee.F17,ee.F18,ee.F19,ee.HOME,ee.INSERT,ee.MEDIA_NEXT,ee.MEDIA_PLAY_PAUSE,ee.MEDIA_PREV,ee.MEDIA_STOP,ee.NULL,ee.NUM_LOCK,ee.PAGE_DOWN,ee.PAGE_UP,ee.PAUSE,ee.SCROLL_LOCK,ee.SHIFT,ee.TAB];function YN(t){return UN.includes(t)}function qN(t){return[ee.CONTROL,ee.COMMAND_LEFT,ee.COMMAND_RIGHT,ee.COMMAND_FIREFOX].includes(t)}function GN(t,e){const r=e.split("|");let n=!1;return j(r,i=>{if(t===ee[i])return n=!0,!1}),n}function Mc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function uo(t){return t.isImmediatePropagationEnabled===!1}function Yu(t){return t.button===2}function r0(t){return t.button===0}function $r(){de(console)&&console.warn(...arguments)}function KN(t){de(console)&&console.warn(`Deprecated: ${t}`)}function XN(){de(console)&&console.error(...arguments)}const co=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Bf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),$f=new Map([[]]);var rS={},jf,nS;function ZN(){if(nS)return jf;nS=1;var t=ks();return jf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},jf}var zf,iS;function JN(){if(iS)return zf;iS=1;var t=st();return zf=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},zf}var Uf,oS;function Ep(){if(oS)return Uf;oS=1;var t=hn(),e=Ym(),r=ji().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),Uf=function(o){i[n][o]=!0},Uf}var sS;function QN(){if(sS)return rS;sS=1;var t=Fe(),e=at(),r=Er(),n=tl(),i=ZN(),o=JN(),s=Ep(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),rS}QN();var aS={},lS={},uS;function ek(){if(uS)return lS;uS=1;var t=Fe(),e=vt(),r=Ls(),n=Er(),i=yt(),o=zi(),s=Tr(),a=Ao(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),lS}var cS;function tk(){return cS||(cS=1,ek()),aS}tk();function rk(t,e){n0(t,e),e.add(t)}function Yf(t,e,r){n0(t,e),e.set(t,r)}function n0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hS(t,e,r){return t.set(qu(t,e),r),r}function Rt(t,e){return t.get(qu(t,e))}function qu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const nk=100;var mr=new WeakMap,ls=new WeakMap,qf=new WeakMap,Gf=new WeakSet;class dS{constructor(){rk(this,Gf),Yf(this,mr,new Map),Yf(this,ls,new Map),Yf(this,qf,new Set),co.forEach(e=>qu(Gf,this,fS).call(this,e))}getHooks(e){var r;return(r=Rt(mr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Rt(mr,this).has(e)||(qu(Gf,this,fS).call(this,e),co.push(e));const i=Rt(mr,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Rt(qf,this).has(e);!u&&o!==0&&(u=!0,Rt(qf,this).add(e)),u&&i.length>1&&Rt(mr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Rt(mr,this).has(e)&&Rt(mr,this).get(e).length>0}remove(e,r){if(!Rt(mr,this).has(e))return!1;const n=Rt(mr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=Rt(ls,this).get(e);return i.skip=!0,o+=1,o>nk&&(Rt(mr,this).set(e,n.filter(s=>!s.skip)),o=0),Rt(ls,this).set(e,o),!0}return!1}destroy(){Rt(mr,this).clear(),Rt(ls,this).clear(),hS(mr,this,null),hS(ls,this,null)}}function fS(t){Rt(mr,this).set(t,[]),Rt(ls,this).set(t,0)}function ik(t,e,r){return(e=ok(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ok(t){var e=sk(t,"string");return typeof e=="symbol"?e:e+""}function sk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ak=ar`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class fe{constructor(){ik(this,"globalBucket",new dS)}static getSingleton(){return uk()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new dS),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.add(e,o,n)):(Bf.has(e)&&$r(H_(ak,{hookName:e,removedInVersion:Bf.get(e)})),$f.has(e)&&$r($f.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?j(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?j(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=am(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=am(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||co.push(e)}deregister(e){this.isRegistered(e)&&co.splice(co.indexOf(e),1)}isDeprecated(e){return $f.has(e)||Bf.has(e)}isRegistered(e){return co.indexOf(e)>=0}getRegistered(){return co}}const lk=new fe;function uk(){return lk}const po=new Map;function Lo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";po.has(t)||po.set(t,new Map);const e=po.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){po.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function ck(t,e){var r;return po==null||(r=po.get(t.guid))===null||r===void 0?void 0:r.get(e)}const lm=new WeakMap,{register:hk,getItem:i0,hasItem:o0}=Lo("editors");function dk(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function fk(t,e){let r;if(typeof t=="function")lm.get(t)||s0(null,t),r=lm.get(t);else if(typeof t=="string")r=i0(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function gS(t){if(typeof t=="function")return t;if(!o0(t))throw Error(`No registered editor found under "${t}" name`);return i0(t).getConstructor()}function s0(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new dk(e);typeof t=="string"&&hk(t,r),lm.set(e,r)}function gk(t,e,r){return(e=mk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mk(t){var e=pk(t,"string");return typeof e=="symbol"?e:e+""}function pk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;gk(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,wk(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function wk(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Mc(this)},t}function vk(t,e){yk(t,e),e.add(t)}function yk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xi(t,e,r){return(e=bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bk(t){var e=Ck(t,"string");return typeof e=="symbol"?e:e+""}function Ck(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ml=new WeakSet;class um{constructor(e,r,n){vk(this,Ml),Xi(this,"hot",void 0),Xi(this,"tableMeta",void 0),Xi(this,"selection",void 0),Xi(this,"eventManager",void 0),Xi(this,"destroyed",!1),Xi(this,"activeEditor",void 0),Xi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Wi(e),this.hot.addHook("afterDocumentKeyDown",i=>Kf(Ml,this,mS).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Kf(Ml,this,mS).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Kf(Ml,this,Sk).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=fk(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function mS(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||uo(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!YN(r)&&!qN(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function Sk(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const pS=new WeakMap;um.getInstance=function(t,e,r){let n=pS.get(t);return n||(n=new um(t,e,r),pS.set(t,n)),n};function Rk(t,e){a0(t,e),e.add(t)}function Js(t,e,r){a0(t,e),e.set(t,r)}function a0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Le(t,e){return t.get(Qn(t,e))}function Qs(t,e,r){return t.set(Qn(t,e),r),r}function Qn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bs=Object.freeze({CELL:"cell",MIXED:"mixed"});var ut=new WeakMap,Il=new WeakMap,Pl=new WeakMap,xl=new WeakMap,Hl=new WeakMap,Oi=new WeakSet;class Ek{constructor(e){var r=this;Rk(this,Oi),Js(this,ut,void 0),Js(this,Il,void 0),Js(this,Pl,1),Js(this,xl,null),Js(this,Hl,new Map);const n=e.getSettings();Qs(ut,this,e),Qs(Il,this,n.imeFastEdit?bs.MIXED:bs.CELL),Le(ut,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qn(Oi,r,_k).call(r,...o)}),Le(ut,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qn(Oi,r,wS).call(r,...o)}),Le(ut,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qn(Oi,r,wS).call(r,...o)}),Le(ut,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Qn(Oi,r,Tk).call(r,...o)})}getFocusMode(){return Le(Il,this)}setFocusMode(e){Object.values(bs).includes(e)?Qs(Il,this,e):$r(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Le(Pl,this)}setRefocusDelay(e){Qs(Pl,this,e)}setRefocusElementGetter(e){Qs(xl,this,e)}getRefocusElement(){var e;return typeof Le(xl,this)=="function"?Le(xl,this).call(this):(e=Le(ut,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Le(ut,this).getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Le(ut,this).runHooks("modifyFocusedElement",s.row,s.col,n);bo(a)||(a=n),a&&!((o=Le(ut,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Qn(Oi,this,Tp).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Le(Pl,this);if(Le(ut,this).getSettings().imeFastEdit&&!((e=Le(ut,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Le(ut,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Le(Hl,this).has(r)||Le(Hl,this).set(r,t0(()=>{if(!Le(ut,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Le(Hl,this).get(r)()}}}function Tp(t){var e;const r=(e=Le(ut,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!r||!Le(ut,this).selection.isCellVisible(r)){t(null);return}const n=Le(ut,this).getCell(r.row,r.col,!0);n===null?Le(ut,this).addHookOnce("afterScroll",()=>{t(Le(ut,this).getCell(r.row,r.col,!0))}):t(n)}function wS(){Qn(Oi,this,Tp).call(this,t=>{const{activeElement:e}=Le(ut,this).rootDocument;e&&J_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Tk(){Qn(Oi,this,Tp).call(this,t=>{this.getFocusMode()===bs.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _k(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?bs.MIXED:bs.CELL)}var vS={},Xf,yS;function Ok(){if(yS)return Xf;yS=1;var t=zr(),e=Oo(),r=hn(),n=r("match");return Xf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Xf}var Zf,bS;function Mk(){if(bS)return Zf;bS=1;var t=st(),e=dt(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return Zf={correct:n},Zf}var Jf,CS;function Ik(){if(CS)return Jf;CS=1;var t=yt();return Jf=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},Jf}var Qf,SS;function Pk(){if(SS)return Qf;SS=1;var t=vt(),e=Ur(),r=rl(),n=Mk(),i=Ik(),o=RegExp.prototype;return Qf=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},Qf}var eg,RS;function xk(){if(RS)return eg;RS=1;var t=at(),e=Ds(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return eg=function(l,u,c,h,d,g){var w=c+l.length,v=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(T,C){var E;switch(n(C,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":E=d[o(C,1,-1)];break;default:var y=+C;if(y===0)return T;if(y>v){var M=r(y/10);return M===0?T:M<=v?h[M-1]===void 0?n(C,1):h[M-1]+n(C,1):T}E=h[y-1]}return E===void 0?"":E})},eg}var ES;function Hk(){if(ES)return vS;ES=1;var t=Fe(),e=vt(),r=at(),n=el(),i=ft(),o=zr(),s=Ok(),a=fc(),l=nl(),u=Pk(),c=xk(),h=hn(),d=Mo(),g=h("replace"),w=TypeError,v=r("".indexOf),b=r("".replace),T=r("".slice),C=Math.max;return t({target:"String",proto:!0},{replaceAll:function(y,M){var H=n(this),P,A,F,B,K,L,oe,X,te,tt,Pe=0,Se="";if(o(y)){if(P=s(y),P&&(A=a(n(u(y))),!~v(A,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(F=l(y,g),F)return e(F,y,H,M);if(d&&P)return b(a(H),y,M)}for(B=a(H),K=a(y),L=i(M),L||(M=a(M)),oe=K.length,X=C(1,oe),te=v(B,K);te!==-1;)tt=L?a(M(K,te,B)):c(K,B,te,[],void 0,M),Se+=T(B,Pe,te)+tt,Pe=te+oe,te=te+X>B.length?-1:v(B,K,te+X);return Pe<B.length&&(Se+=T(B,Pe)),Se}}),vS}Hk();const l0={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Ak=new RegExp(Object.keys(l0).map(t=>`(${t})`).join("|"),"gi");function Dk(t){return(t&&t.nodeName||"")==="TABLE"}function TS(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,w=[];for(let b=0;b<s;b+=1){const T=!g&&r&&b===0;let C="";if(g)C=`<th>${t.getColHeader(b-c)}</th>`;else if(T)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const E=i[d][b],{hidden:y,rowspan:M,colspan:H}=t.getCellMeta(d-h,b-c);if(!y){const P=[];if(M&&P.push(`rowspan="${M}"`),H&&P.push(`colspan="${H}"`),Co(E))C=`<td ${P.join(" ")}></td>`;else{const A=E.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${P.join(" ")}>${A}</td>`}}}w.push(C)}const v=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function _S(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Co(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function OS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const E=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,y=>{const M=y.match(/<td\b[^>]*?>/g)[0],H=/<p.*?>/g,P=y.substring(M.length,y.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(H,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${P}</td>`});i.insertAdjacentHTML("afterbegin",`${E}`),o=i.querySelector("table")}if(!o||!Dk(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((E,y)=>E+y.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,w=0;if(o.tHead){const E=Array.from(o.tHead.rows).filter(y=>{const M=y.querySelector("td")!==null;return M&&h.push(y),!M});g=E.length,d=g>0,g>1?r.nestedHeaders=Array.from(E).reduce((y,M)=>{const H=Array.from(M.cells).reduce((P,A,F)=>{if(a&&F===0)return P;const{colSpan:B,innerHTML:K}=A,L=B>1?{label:K,colspan:B}:K;return P.push(L),P},[]);return y.push(H),y},[]):d&&(r.colHeaders=Array.from(E[0].children).reduce((y,M,H)=>(a&&H===0||y.push(M.innerHTML),y),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((E,y)=>(E.push(...Array.from(y.rows)),E),[]),...c];w=v.length;const b=new Array(w);for(let E=0;E<w;E++)b[E]=new Array(u);const T=[],C=[];for(let E=0;E<w;E++){const y=v[E],M=Array.from(y.cells),H=M.length;for(let P=0;P<H;P++){const A=M[P],{nodeName:F,innerHTML:B,rowSpan:K,colSpan:L}=A,oe=b[E].findIndex(X=>X===void 0);if(F==="TD"){if(K>1||L>1){for(let Pe=E;Pe<E+K;Pe++)if(Pe<w)for(let Se=oe;Se<oe+L;Se++)b[Pe][Se]=null;const te=A.getAttribute("style");te&&te.includes("mso-ignore:colspan")||T.push({col:oe,row:E,rowspan:K,colspan:L})}let X="";s&&/excel/gi.test(s.content)?X=B.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):X=B.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[E][oe]=X.replace(Ak,te=>l0[te])}else C.push(B)}}return T.length&&(r.mergeCells=T),C.length&&(r.rowHeaders=C),b.length&&(r.data=b),r}function Nk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Xe(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function MS(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function kk(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function De(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}function Cs(t){return Number.isInteger(t)&&t>=0}const cm="asc",Lk="desc",IS=new Map([[cm,[-1,1]],[Lk,[1,-1]]]),Fk=t=>`The priority '${t}' is already declared in a map.`,Vk=t=>`The priority '${t}' is not a number.`;function Wk(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Ee(t)?t:Fk,e=Ee(e)?e:Vk;function n(o,s){if(!Nk(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cm;const[s,a]=IS.get(o)||IS.get(cm);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const Bk=t=>`The id '${t}' is already declared in a map.`;function Ic(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ee(t)?t:Bk;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const $k=t=>`'${t}' value is already declared in a unique set.`;function jk(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ee(t)?t:$k;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const _p=t=>`There is already registered "${t}" plugin.`,zk=t=>`There is already registered plugin on priority "${t}".`,Uk=t=>`The priority "${t}" is not a number.`,u0=Wk({errorPriorityExists:zk,errorPriorityNaN:Uk}),c0=jk({errorItemExists:_p}),hm=Ic({errorIdExists:_p});function h0(){return[...u0.getItems(),...c0.getItems()]}function Op(t){const e=Tc(t);return hm.getItem(e)}function Yk(t){return!!Op(t)}function Al(t,e,r){[t,e,r]=Gk(t,e,r),Op(t)===void 0&&qk(t,e,r)}function qk(t,e,r){const n=Tc(t);if(hm.hasItem(n))throw new Error(_p(n));r===void 0?c0.addItem(n):u0.addItem(r,n),hm.addItem(n,e)}function Gk(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:Kk,getItem:Xk,hasItem:d0}=Lo("renderers");function PS(t){if(typeof t=="function")return t;if(!d0(t))throw Error(`No registered renderer found under "${t}" name`);return Xk(t)}function Zk(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Kk(t,e)}const{register:Jk,getItem:Qk,hasItem:f0}=Lo("validators");function eL(t){if(typeof t=="function")return t;if(!f0(t))throw Error(`No registered validator found under "${t}" name`);return Qk(t)}function tL(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Jk(t,e)}var xS={},HS;function rL(){if(HS)return xS;HS=1;var t=Fe(),e=Ds(),r=ks(),n=il(),i=Ep();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),xS}rL();var AS={},DS;function nL(){if(DS)return AS;DS=1;var t=Fe(),e=at(),r=el(),n=il(),i=fc(),o=dt(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),AS}nL();function ea(t,e,r){return(e=iL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iL(t){var e=oL(t,"string");return typeof e=="symbol"?e:e+""}function oL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sL{constructor(){ea(this,"count",0),ea(this,"startColumn",null),ea(this,"endColumn",null),ea(this,"startPosition",null),ea(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ta(t,e,r){return(e=aL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aL(t){var e=lL(t,"string");return typeof e=="symbol"?e:e+""}function lL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uL{constructor(){ta(this,"count",0),ta(this,"startRow",null),ta(this,"endRow",null),ta(this,"startPosition",null),ta(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ra(t,e,r){return(e=cL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cL(t){var e=hL(t,"string");return typeof e=="symbol"?e:e+""}function hL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g0{constructor(){ra(this,"count",0),ra(this,"startColumn",null),ra(this,"endColumn",null),ra(this,"startPosition",null),ra(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function na(t,e,r){return(e=dL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dL(t){var e=fL(t,"string");return typeof e=="symbol"?e:e+""}function fL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m0{constructor(){na(this,"count",0),na(this,"startRow",null),na(this,"endRow",null),na(this,"startPosition",null),na(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ia(t,e,r){return(e=gL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gL(t){var e=mL(t,"string");return typeof e=="symbol"?e:e+""}function mL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pL{constructor(){ia(this,"count",0),ia(this,"startColumn",0),ia(this,"endColumn",0),ia(this,"startPosition",0),ia(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function oa(t,e,r){return(e=wL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wL(t){var e=vL(t,"string");return typeof e=="symbol"?e:e+""}function vL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yL{constructor(){oa(this,"count",0),oa(this,"startRow",0),oa(this,"endRow",0),oa(this,"startPosition",0),oa(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function NS(t,e,r){return(e=bL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bL(t){var e=CL(t,"string");return typeof e=="symbol"?e:e+""}function CL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SL extends g0{constructor(){super(...arguments),NS(this,"columnStartOffset",0),NS(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function kS(t,e,r){return(e=RL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RL(t){var e=EL(t,"string");return typeof e=="symbol"?e:e+""}function EL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TL extends m0{constructor(){super(...arguments),kS(this,"rowStartOffset",0),kS(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function LS(t,e,r){return(e=_L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _L(t){var e=OL(t,"string");return typeof e=="symbol"?e:e+""}function OL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p0{constructor(e){LS(this,"calculationTypes",[]),LS(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Xr(t,e,r){return(e=ML(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ML(t){var e=IL(t,"string");return typeof e=="symbol"?e:e+""}function IL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mp=50;class PL extends p0{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Xr(this,"viewportWidth",0),Xr(this,"scrollOffset",0),Xr(this,"zeroBasedScrollOffset",0),Xr(this,"totalColumns",0),Xr(this,"columnWidthFn",null),Xr(this,"columnWidth",0),Xr(this,"overrideFn",null),Xr(this,"inlineStartOffset",0),Xr(this,"totalCalculatedWidth",0),Xr(this,"startPositions",[]),Xr(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Mp:r}}function Pr(t,e,r){return(e=xL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xL(t){var e=HL(t,"string");return typeof e=="symbol"?e:e+""}function HL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AL extends p0{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Pr(this,"viewportHeight",0),Pr(this,"scrollOffset",0),Pr(this,"zeroBasedScrollOffset",0),Pr(this,"totalRows",0),Pr(this,"rowHeightFn",null),Pr(this,"rowHeight",0),Pr(this,"overrideFn",null),Pr(this,"horizontalScrollbarHeight",0),Pr(this,"innerViewportHeight",0),Pr(this,"totalCalculatedHeight",0),Pr(this,"startPositions",[]),Pr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function DL(t,e,r){NL(t,e),e.set(t,r)}function NL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FS(t,e,r){return(e=kL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kL(t){var e=LL(t,"string");return typeof e=="symbol"?e:e+""}function LL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $o(t,e){return t.get(w0(t,e))}function VS(t,e,r){return t.set(w0(t,e),r),r}function w0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap;class So{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;FS(this,"row",null),FS(this,"col",null),DL(this,Bn,!1),VS(Bn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return $o(Bn,this)}isSouthEastOf(e){return this.row>=e.row&&($o(Bn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&($o(Bn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&($o(Bn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&($o(Bn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof So&&VS(Bn,this,e.isRtl()),this}clone(){return new So(this.row,this.col,$o(Bn,this))}toObject(){return{row:this.row,col:this.col}}}function FL(t,e,r){VL(t,e),e.set(t,r)}function VL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tg(t,e,r){return(e=WL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WL(t){var e=BL(t,"string");return typeof e=="symbol"?e:e+""}function BL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xr(t,e){return t.get(v0(t,e))}function $L(t,e,r){return t.set(v0(t,e),r),r}function v0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Kt=new WeakMap;class ml{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;tg(this,"highlight",null),tg(this,"from",null),tg(this,"to",null),FL(this,Kt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),$L(Kt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return xr(Kt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return xr(Kt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return xr(Kt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return xr(Kt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return xr(Kt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return xr(Kt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return xr(Kt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return xr(Kt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof So))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(xr(Kt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(xr(Kt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new ml(this.highlight,this.from,this.to,xr(Kt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new So(e,r,xr(Kt,this))}}function wn(t,e,r){jL(t,e),e.set(t,r)}function jL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q(t,e){return t.get(y0(t,e))}function pi(t,e,r){return t.set(y0(t,e),r),r}function y0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hr=new WeakMap,rg=new WeakMap,wt=new WeakMap,jo=new WeakMap,Dl=new WeakMap,Zr=new WeakMap,ng=new WeakMap,sa=new WeakMap,Zi=new WeakMap,vn=new WeakMap;let b0=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;wn(this,Hr,void 0),wn(this,rg,void 0),wn(this,wt,void 0),wn(this,jo,void 0),wn(this,Dl,void 0),wn(this,Zr,void 0),wn(this,ng,void 0),wn(this,sa,void 0),wn(this,Zi,[null,null]),wn(this,vn,[null,null]),pi(Hr,this,n),pi(rg,this,r),pi(wt,this,o),pi(jo,this,s),pi(Dl,this,a),pi(Zr,this,i),pi(ng,this,e),this.registerEvents()}registerEvents(){q(Zr,this).addEventListener(q(wt,this).holder,"contextmenu",n=>this.onContextMenu(n)),q(Zr,this).addEventListener(q(wt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),q(Zr,this).addEventListener(q(wt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{q(Zr,this).addEventListener(q(wt,this).holder,"touchstart",n=>this.onTouchStart(n)),q(Zr,this).addEventListener(q(wt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),q(Zr,this).addEventListener(q(wt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||q(Hr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,q(Hr,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{q(Zr,this).addEventListener(q(wt,this).holder,"mouseup",n=>this.onMouseUp(n)),q(Zr,this).addEventListener(q(wt,this).holder,"mousedown",n=>this.onMouseDown(n))};Hi()?e():(SN()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(q(sa,this)&&n){const[i,o]=[n.row,q(sa,this).from.row],[s,a]=[n.col,q(sa,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=q(wt,this).TABLE,i=Ol(e,["TD","TH"],n);return i?(r.coords=q(wt,this).getCoords(i),r.TD=i):ye(e,"wtBorder")&&ye(e,"current")?(r.coords=q(jo,this).getFocusSelection().cellRange.highlight,r.TD=q(wt,this).getCell(r.coords)):ye(e,"wtBorder")&&ye(e,"area")&&q(jo,this).getAreaSelection().cellRange&&(r.coords=q(jo,this).getAreaSelection().cellRange.to,r.TD=q(wt,this).getCell(r.coords)),r}onMouseDown(e){const r=q(rg,this).rootDocument.activeElement,n=zN(PN,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);ye(i,"corner")?q(Hr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&q(Hr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(q(vn,this)[0]=o.TD,clearTimeout(q(Zi,this)[0]),q(Zi,this)[0]=setTimeout(()=>{q(vn,this)[0]=null},1e3))}onContextMenu(e){if(q(Hr,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!q(Hr,this).has("onCellMouseOver"))return;const r=q(wt,this).TABLE,n=Ol(e.target,["TD","TH"],r),i=q(Dl,this)||this;n&&n!==i.lastMouseOver&&ys(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,q(wt,this).getCoords(n),n))}onMouseOut(e){if(!q(Hr,this).has("onCellMouseOut"))return;const r=q(wt,this).TABLE,n=Ol(e.target,["TD","TH"],r),i=Ol(e.relatedTarget,["TD","TH"],r),o=q(Dl,this)||this;n&&n!==i&&ys(n,r)&&(this.callListener("onCellMouseOut",e,q(wt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&q(Hr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===q(vn,this)[0]&&r.TD===q(vn,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),q(vn,this)[0]=null,q(vn,this)[1]=null):r.TD===q(vn,this)[0]&&(q(vn,this)[1]=r.TD,clearTimeout(q(Zi,this)[1]),q(Zi,this)[1]=setTimeout(()=>{q(vn,this)[1]=null},500)))}onTouchStart(e){pi(sa,this,q(jo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=de(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&q(Hr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];B_()&&(ON()||MN())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=q(Hr,this).getSettingPure(e);o&&o(r,n,i,q(ng,this).call(this))}destroy(){clearTimeout(q(Zi,this)[0]),clearTimeout(q(Zi,this)[1]),q(Zr,this).destroy()}};function ig(t,e,r){return(e=zL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zL(t){var e=UL(t,"string");return typeof e=="symbol"?e:e+""}function UL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YL{constructor(e,r,n){ig(this,"offset",void 0),ig(this,"total",void 0),ig(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function og(t,e,r){return(e=qL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qL(t){var e=GL(t,"string");return typeof e=="symbol"?e:e+""}function GL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KL{constructor(e,r,n){og(this,"offset",void 0),og(this,"total",void 0),og(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Nl(t,e,r){return(e=XL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XL(t){var e=ZL(t,"string");return typeof e=="symbol"?e:e+""}function ZL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JL{constructor(){Nl(this,"currentSize",0),Nl(this,"nextSize",0),Nl(this,"currentOffset",0),Nl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const QL=0,WS=1,dm=2;function sg(t,e,r){return(e=eF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eF(t){var e=tF(t,"string");return typeof e=="symbol"?e:e+""}function tF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rF{constructor(){sg(this,"size",new JL),sg(this,"workingSpace",QL),sg(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=WS,e.workingSpace=dm,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=dm,e.workingSpace=WS,this.sharedSize=e.getViewSize()}}var BS={},ag,$S;function nF(){if($S)return ag;$S=1;var t=dc(),e=TypeError;return ag=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},ag}var jS;function iF(){if(jS)return BS;jS=1;var t=Fe(),e=Ds(),r=ks(),n=yT(),i=nF(),o=bT(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var w=d;w--;){var v=w+g;w in h?h[v]=h[w]:i(h,v)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),BS}iF();function oF(t,e,r){return(e=sF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sF(t){var e=aF(t,"string");return typeof e=="symbol"?e:e+""}function aF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zS{constructor(e,r){oF(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function lF(t,e,r){return(e=uF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uF(t){var e=cF(t,"string");return typeof e=="symbol"?e:e+""}function cF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hF{constructor(e){lF(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new zS(o,r),l=new zS(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(dm)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function zo(t,e,r){return(e=dF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dF(t){var e=fF(t,"string");return typeof e=="symbol"?e:e+""}function fF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C0{constructor(e,r){zo(this,"rootNode",void 0),zo(this,"nodesPool",void 0),zo(this,"sizeSet",new rF),zo(this,"collectedNodes",[]),zo(this,"viewDiffer",new hF(this.sizeSet)),zo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class S0 extends C0{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function US(t,e,r){return(e=gF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gF(t){var e=mF(t,"string");return typeof e=="symbol"?e:e+""}function mF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pF{constructor(e){US(this,"nodeType",void 0),US(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function aa(t,e,r){return(e=wF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wF(t){var e=vF(t,"string");return typeof e=="symbol"?e:e+""}function vF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pl{constructor(e,r){aa(this,"nodesPool",null),aa(this,"nodeType",void 0),aa(this,"rootNode",void 0),aa(this,"table",null),aa(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new pF(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function YS(t,e,r){return(e=yF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yF(t){var e=bF(t,"string");return typeof e=="symbol"?e:e+""}function bF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CF extends pl{constructor(){super("TH"),YS(this,"orderViews",new WeakMap),YS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new S0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),fl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(d,[lN(),gN(),vp(h+1),ko(-1)]),r[h](a,d,h)}u.end()}}}class SF extends pl{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Os(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Te(this.rootNode,[D_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Te(s,[N_(),L_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),fl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(u,[vp(a+1+this.table.rowHeadersCount),ko(-1),uN(),...a>=0?[fN()]:[aN(),ju("Select whole grid")]]),n[r](l,u,r)}}}}let qS=!1;class RF extends pl{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!qS&&e>1e3&&(qS=!0,$r(ar`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&Z(n,"rowHeader")}}function EF(t,e,r){return(e=TF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TF(t){var e=_F(t,"string");return typeof e=="symbol"?e:e+""}function _F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Uo={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let GS=!1;class OF extends pl{constructor(e){super("TR",e),EF(this,"orderView",void 0),this.orderView=new C0(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!GS&&e>1e3&&(GS=!0,$r(ar`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Te(this.rootNode,[D_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;Te(o,[N_(),L_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?ye(o,Uo.rowEven)||(Me(o,Uo.rowOdd),Z(o,Uo.rowEven)):ye(o,Uo.rowOdd)||(Me(o,Uo.rowEven),Z(o,Uo.rowOdd))}this.orderView.end()}}function KS(t,e,r){return(e=MF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MF(t){var e=IF(t,"string");return typeof e=="symbol"?e:e+""}function IF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PF extends pl{constructor(){super("TD"),KS(this,"orderViews",new WeakMap),KS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new S0(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),w=c.getCurrentNode();if(ye(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),fl(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,w),this.table.isAriaEnabled()){var o,s;Te(w,[...w.hasAttribute("role")?[]:[sN()],ko(-1),vp(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function lt(t,e,r){return(e=xF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xF(t){var e=HF(t,"string");return typeof e=="symbol"?e:e+""}function HF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AF{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};lt(this,"rootNode",void 0),lt(this,"rootDocument",void 0),lt(this,"rowHeaders",null),lt(this,"columnHeaders",null),lt(this,"colGroup",null),lt(this,"rows",null),lt(this,"cells",null),lt(this,"rowFilter",null),lt(this,"columnFilter",null),lt(this,"rowUtils",null),lt(this,"columnUtils",null),lt(this,"rowsToRender",0),lt(this,"columnsToRender",0),lt(this,"rowHeaderFunctions",[]),lt(this,"rowHeadersCount",0),lt(this,"columnHeaderFunctions",[]),lt(this,"columnHeadersCount",0),lt(this,"cellRenderer",void 0),lt(this,"activeOverlayName",void 0),lt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class DF{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new AF(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new CF,columnHeaders:new SF(r),colGroup:new RF(n),rows:new OF(i),cells:new PF}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function lg(t,e,r){return(e=NF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NF(t){var e=kF(t,"string");return typeof e=="symbol"?e:e+""}function kF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LF{constructor(e,r){lg(this,"dataAccessObject",void 0),lg(this,"wtSettings",void 0),lg(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function XS(t,e,r){return(e=FF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FF(t){var e=VF(t,"string");return typeof e=="symbol"?e:e+""}function VF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WF{constructor(e,r){XS(this,"dataAccessObject",void 0),XS(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function yn(t,e,r){return(e=BF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BF(t){var e=$F(t,"string");return typeof e=="symbol"?e:e+""}function $F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bs{constructor(e,r,n,i,o){yn(this,"wtSettings",null),yn(this,"domBindings",void 0),yn(this,"TBODY",null),yn(this,"THEAD",null),yn(this,"COLGROUP",null),yn(this,"hasTableHeight",!0),yn(this,"hasTableWidth",!0),yn(this,"isTableVisible",!1),yn(this,"tableOffset",0),yn(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Y_(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new WF(this.dataAccessObject,this.wtSettings),this.columnUtils=new LF(this.dataAccessObject,this.wtSettings),this.tableRenderer=new DF({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ye(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Te(n,[xi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ye(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(n,[xi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ye(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&Te(n,[ko(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Te(n.parentNode,[xi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(n,[xi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Fr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,w!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Fr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new KL(g,o,c),this.columnFilter=new YL(w,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),v=b.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(_n)||this.is(Fi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(_n))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(_n)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Fa(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(_n))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=j_(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=AN(n),s=r.cellIndex;Ki(To,r,this.wtRootElement)||Ki(Ro,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Ki(Fi,r,this.wtRootElement)||Ki(_n,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Ki(To,r,this.wtRootElement)||Ki(Eo,r,this.wtRootElement)||Ki(Fi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Fa(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?lr:Fa,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const w=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-w||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return or(this.TABLE)}getHeight(){return lr(this.TABLE)}getTotalWidth(){const e=or(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=lr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Xa(this.TABLE)}_modifyRowHeaderWidth(e){let r=Ee(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const jF="stickyRowsBottom",Ip={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ci(Ip,"MIXIN_NAME",jF,{writable:!1,enumerable:!1});const zF="stickyColumnsStart",Pc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ci(Pc,"MIXIN_NAME",zF,{writable:!1,enumerable:!1});class Pp extends Bs{constructor(e,r,n,i){super(e,r,n,i,Fi)}}Qe(Pp,Ip);Qe(Pp,Pc);const Ro="top",_n="bottom",Eo="inline_start",To="top_inline_start_corner",Fi="bottom_inline_start_corner",R0=[Ro,_n,Eo,To,Fi],UF=new Map([[Ro,`ht_clone_${Ro}`],[_n,`ht_clone_${_n}`],[Eo,`ht_clone_${Eo} ht_clone_left`],[To,`ht_clone_${To} ht_clone_top_left_corner`],[Fi,`ht_clone_${Fi} ht_clone_bottom_left_corner`]]);function YF(t,e){qF(t,e),e.add(t)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GF(t,e,r){return(e=KF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KF(t){var e=XF(t,"string");return typeof e=="symbol"?e:e+""}function XF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var la=new WeakSet;class ZF{constructor(e){YF(this,la),GF(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=yr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=yr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return kl(la,this,JS).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return kl(la,this,JS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return kl(la,this,ZS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return kl(la,this,ZS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function ZS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Fr(n.wtRootElement).left;const u=Math.abs(K_(s,s));if(l>u){const c=X_(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function JS(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Fr(r.wtRootElement),a=Sp(o,o);if(s.top>a){const l=Fa(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Ar(t,e,r){return(e=JF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JF(t){var e=QF(t,"string");return typeof e=="symbol"?e:e+""}function QF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xp{get eventManager(){return new Wi(this)}constructor(e,r){Ar(this,"wtTable",void 0),Ar(this,"wtScroll",void 0),Ar(this,"wtViewport",void 0),Ar(this,"wtOverlays",void 0),Ar(this,"selectionManager",void 0),Ar(this,"wtEvent",void 0),Ar(this,"guid",`wt_${x_()}`),Ar(this,"drawInterrupted",!1),Ar(this,"drawn",!1),Ar(this,"activeOverlayName","master"),Ar(this,"domBindings",void 0),Ar(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new ZF(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){gl(n,e[r])}])}}createCellCoords(e,r){return new So(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new ml(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||NN(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function QS(t,e,r){return(e=eV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eV(t){var e=tV(t,"string");return typeof e=="symbol"?e:e+""}function tV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rV extends xp{constructor(e,r,n){super(e,r),QS(this,"cloneSource",void 0),QS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new b0(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function nV(t,e,r){return(e=iV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iV(t){var e=oV(t,"string");return typeof e=="symbol"?e:e+""}function oV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wl{constructor(e,r,n,i,o){nV(this,"wtSettings",null),ci(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Uu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Uu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=zu(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){$r(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Ut())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(R0.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${UF.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&Te(o,[xi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ro||u==="vertical"&&this.type===Eo?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=zu(e.TABLE),new rV(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class sV extends wl{constructor(e,r,n,i,o,s){super(e,r,Fi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Pp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else Oc(r),this.repositionOverlay();let n=lr(this.clone.wtTable.TABLE);const i=or(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=Ut(n)),i.style.bottom=`${o}px`}}const aV="calculatedColumns",xc={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ci(xc,"MIXIN_NAME",aV,{writable:!1,enumerable:!1});class Hp extends Bs{constructor(e,r,n,i){super(e,r,n,i,_n)}}Qe(Hp,Ip);Qe(Hp,xc);function lV(t,e,r){return(e=uV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uV(t){var e=cV(t,"string");return typeof e=="symbol"?e:e+""}function cV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hV extends wl{constructor(e,r,n,i){super(e,r,_n,n,i),lV(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Hp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=Ut(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Cp(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=lr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=Ut(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Sp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ye(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Z(s,"innerBorderBottom"),o=!a):(Me(s,"innerBorderBottom"),o=a)}return o}}const dV="calculatedRows",Ap={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ci(Ap,"MIXIN_NAME",dV,{writable:!1,enumerable:!1});class Dp extends Bs{constructor(e,r,n,i){super(e,r,n,i,Eo)}}Qe(Dp,Ap);Qe(Dp,Pc);const fV="localHooks",Nn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const r=this._localHooks[t].indexOf(e);r>-1&&this._localHooks[t].splice(r,1)}return this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)am(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};ci(Nn,"MIXIN_NAME",fV,{writable:!1,enumerable:!1});let E0=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Qe(E0,Nn);const gV="active-header",T0="header",Np="area",Gu="focus",mV="fill",pV="row",wV="column",vV="custom-selection",kp=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var eR={},tR;function yV(){if(tR)return eR;tR=1;var t=Ep();return t("flat"),eR}yV();function bV(t,e){_0(t,e),e.add(t)}function rR(t,e,r){_0(t,e),e.set(t,r)}function _0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ge(t,e){return t.get(Va(t,e))}function nR(t,e,r){return t.set(Va(t,e),r),r}function Va(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var en=new WeakMap,Mt=new WeakMap,Ll=new WeakSet;class CV{constructor(){bV(this,Ll),rR(this,en,void 0),rR(this,Mt,void 0)}setActiveOverlay(e){return nR(Mt,this,e),this}setActiveSelection(e){return nR(en,this,e),this}scan(){const e=Ge(en,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ge(en,this).getCorners(),{wtTable:s}=Ge(Mt,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let w=s.getColumnHeader(h,g);const v=Ge(Mt,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ge(en,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});v!==null&&(v!==h&&(w=s.getColumnHeader(v,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ge(en,this).getCorners(),{wtTable:s}=Ge(Mt,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let w=s.getRowHeader(h,g);const v=Ge(Mt,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ge(en,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});v!==null&&(v!==h&&(w=s.getRowHeader(v,g)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ge(Mt,this);Va(Ll,this,SV).call(this,(n,i)=>{const o=r.getCell(Ge(Mt,this).createCellCoords(n,i)),s=Ge(Mt,this).getSetting("onAfterDrawSelection",n,i,Ge(en,this).settings.layerLevel);typeof s=="string"&&Z(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ge(en,this).getCorners(),{wtTable:i}=Ge(Mt,this);Va(Ll,this,iR).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ge(Mt,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ge(en,this).getCorners(),{wtTable:i}=Ge(Mt,this);Va(Ll,this,iR).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ge(Mt,this).createCellCoords(o,s));e(a)}})}}function SV(t){let[e,r,n,i]=Ge(en,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ge(Mt,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ge(Mt,this).createCellCoords(e,r));if(!bo(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function iR(t){const{wtTable:e}=Ge(Mt,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class oR{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=kp(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Mc(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Hi()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Ie(h,(g,w)=>{this.selectionHandles.styles.bottomHitArea[w]=g,this.selectionHandles.styles.topHitArea[w]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Ie(d,(g,w)=>{this.selectionHandles.styles.bottom[w]=g,this.selectionHandles.styles.top[w]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),b-w-g*2),E=Math.min(parseInt(i+o-v/4,10),b-v-g*2);h[l]=`${C}px`,d[l]=`${E}px`;const y=Math.min(parseInt(n+s,10),T-w-g*2),M=Math.min(parseInt(n+s-v/4,10),T-v-g*2);h.top=`${y}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),w=s.getLastRenderedColumn();if(g<0&&w<0||h<0&&d<0){this.disappear();return}let v;if(u){if(n=Math.max(n,g),o=Math.min(o,w),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}v=s.getCell(this.wot.createCellCoords(r,n))}else if(v=s.getCell(this.wot.createCellCoords(r,n)),!bo(v)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(i,o)):v,T=Fr(v),C=u?Fr(b):T,E=Fr(s.TABLE),y=T.top,M=T.left,H=this.wot.wtSettings.getSetting("rtlMode");let P=0,A=0;if(H){const Se=or(s.TABLE),Be=or(v),$e=l.innerWidth-E.left-Se;A=M+Be-C.left,P=l.innerWidth-M-Be-$e-1}else A=C.left+or(b)-M,P=M-E.left-1;if(this.isEntireColumnSelected(r,i)){const Se=r,Be=this.getDimensionsFromHeader("columns",n,o,Se,E);let $e=null;Be&&([$e,P,A]=Be),$e&&(v=$e)}let F=y-E.top-1,B=C.top+lr(b)-y;if(this.isEntireRowSelected(n,o)){const Se=n,Be=this.getDimensionsFromHeader("rows",r,i,Se,E);let $e=null;Be&&([$e,F,B]=Be),$e&&(v=$e)}const K=l.getComputedStyle(v);parseInt(K.borderTopWidth,10)>0&&(F+=1,B=B>0?B-1:0),parseInt(K[H?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,A=A>0?A-1:0);const L=H?"right":"left",oe=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${F}px`,this.topStyle[L]=`${P}px`,this.topStyle.width=`${A+oe}px`,this.topStyle.display="block",this.startStyle.top=`${F}px`,this.startStyle[L]=`${P}px`,this.startStyle.height=`${B+oe}px`,this.startStyle.display="block",this.bottomStyle.top=`${F+B-parseInt(this.bottomStyle.height,10)+oe}px`,this.bottomStyle[L]=`${P}px`,this.bottomStyle.width=`${A+oe}px`,this.bottomStyle.display="block",this.endStyle.top=`${F}px`,this.endStyle[L]=`${P+A-parseInt(this.endStyle.width,10)+oe}px`,this.endStyle.height=`${B+oe}px`,this.endStyle.display="block";let X=this.settings.border.cornerVisible;X=typeof X=="function"?X(this.settings.layerLevel):X;const te=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[tt,Pe]=[i,o];if(te&&Array.isArray(te)&&([,,tt,Pe]=te),Hi()||!X||this.isPartRange(tt,Pe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${F+B+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[L]=`${P+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Se=Uu(s.TABLE);const Be=Se===l;Be&&(Se=a.documentElement);const $e=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,xe=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),Or=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const He=Be?b.getBoundingClientRect().left:b.offsetLeft;let f=!1,m=0;if(H?(m=He-parseInt(this.cornerDefaultStyle.width,10)/2,f=m<0):(m=He+or(b)+parseInt(this.cornerDefaultStyle.width,10)/2,f=m>=X_(Se)),f){const p=Math.floor(P+A+this.cornerCenterPointOffset-xe-$e);c?(this.cornerStyle[L]=`${p}px`,this.cornerStyle[H?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[L]=`${p-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Be?b.getBoundingClientRect().top:b.offsetTop)+lr(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=Fa(Se)){const p=Math.floor(F+B+this.cornerCenterPointOffset-Or-$e);c?(this.cornerStyle.top=`${p}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${p-1}px`}this.cornerStyle.display="block"}Hi()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,F,P,A,B)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return lr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return or(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(w=l(r,b-i),v=l(n,b-i),!w||!v)return!1;const T=Fr(w),C=Fr(v);return w&&v&&(h=T[g]-o[g]-1,d=C[g]+u(v)-T[g]),[w,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Z(this[e],"hidden"):(ye(this[e],"hidden")&&Me(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Z(this[e],"hidden"):Me(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Hi()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function RV(t,e){O0(t,e),e.add(t)}function Yo(t,e,r){O0(t,e),e.set(t,r)}function O0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(Lp(t,e))}function sR(t,e,r){return t.set(Lp(t,e),r),r}function Lp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var It=new WeakMap,tr=new WeakMap,ug=new WeakMap,Oa=new WeakMap,cg=new WeakMap,Ji=new WeakMap,aR=new WeakSet;class EV{constructor(e){RV(this,aR),Yo(this,It,void 0),Yo(this,tr,void 0),Yo(this,ug,new CV),Yo(this,Oa,new WeakMap),Yo(this,cg,new WeakSet),Yo(this,Ji,new Map),sR(tr,this,e)}setActiveOverlay(e){return sR(It,this,e),le(ug,this).setActiveOverlay(le(It,this)),le(Oa,this).has(le(It,this))||le(Oa,this).set(le(It,this),new Set),this}getFocusSelection(){return le(tr,this)!==null?le(tr,this).getFocus():null}getAreaSelection(){return le(tr,this)!==null?le(tr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(Ji,this).has(e)){const n=le(Ji,this).get(e);if(n.has(le(It,this)))return n.get(le(It,this));const i=new oR(le(It,this),e.settings);return n.set(le(It,this),i),i}const r=new oR(le(It,this),e.settings);return le(Ji,this).set(e,new Map([[le(It,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(Ji,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(Ji,this).get(e).forEach(r=>r.destroy()),le(Ji,this).delete(e)}render(e){if(le(tr,this)===null)return;e&&Lp(aR,this,TV).call(this);const r=Array.from(le(tr,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(cg,this).has(s)||(le(cg,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&le(ug,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const v=n.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const d=s.getCorners();le(It,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(Oa,this).get(le(It,this)).add(u)),Z(s,l),s.nodeName==="TD"&&Array.isArray((a=le(tr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Te(s,le(tr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Te(o,[...i.get(o)])})}}function TV(){const t=le(Oa,this).get(le(It,this)),e=le(It,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(It,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(tr,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(tr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(tr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(tr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Me(o[a],r),fl(o[a],s)}),t.clear()}class _V extends wl{constructor(e,r,n,i){super(e,r,Eo,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Dp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Rp(n,`${o}px`,"0px")):(o=this.getScrollPosition(),Oc(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,G_(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=or(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=kp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=Ut(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,LN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(K_(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?Me(n,"emptyRows"):Z(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Z(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ye(n,"innerBorderInlineStart");e?(Z(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(Me(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const OV="stickyRowsTop",Fp={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ci(Fp,"MIXIN_NAME",OV,{writable:!1,enumerable:!1});class Vp extends Bs{constructor(e,r,n,i){super(e,r,n,i,To)}}Qe(Vp,Fp);Qe(Vp,Pc);function lR(t,e,r){return(e=MV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MV(t){var e=IV(t,"string");return typeof e=="symbol"?e:e+""}function IV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PV extends wl{constructor(e,r,n,i,o,s){super(e,r,To,n,i),lR(this,"topOverlay",void 0),lR(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Vp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Rp(e,`${i}px`,`${o}px`)}else Oc(e);let r=lr(this.clone.wtTable.TABLE);const n=or(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class Wp extends Bs{constructor(e,r,n,i){super(e,r,n,i,Ro)}}Qe(Wp,Fp);Qe(Wp,xc);function xV(t,e,r){return(e=HV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HV(t){var e=AV(t,"string");return typeof e=="symbol"?e:e+""}function AV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DV extends wl{constructor(e,r,n,i){super(e,r,Ro,n,i),xV(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Wp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Rp(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Oc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Cp(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=Ut(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=lr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=kp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=Ut(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,kN(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Sp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?Me(i,"emptyColumns"):Z(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Z(i,"innerBorderTop"),a=!h):(Me(i,"innerBorderTop"),a=h)}}return a}}function Fl(t,e,r){NV(t,e),e.set(t,r)}function NV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $n(t,e,r){return(e=kV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kV(t){var e=LV(t,"string");return typeof e=="symbol"?e:e+""}function LV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qi(t,e,r){return t.set(M0(t,e),r),r}function jn(t,e){return t.get(M0(t,e))}function M0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qo=new WeakMap,Vl=new WeakMap,Go=new WeakMap,Wl=new WeakMap;class FV{constructor(e,r,n,i,o,s){$n(this,"wot",null),Fl(this,qo,[]),$n(this,"topOverlay",null),$n(this,"bottomOverlay",null),$n(this,"inlineStartOverlay",null),$n(this,"topInlineStartCornerOverlay",null),$n(this,"bottomInlineStartCornerOverlay",null),$n(this,"browserLineHeight",void 0),$n(this,"wtSettings",null),Fl(this,Vl,!1),Fl(this,Go,0),Fl(this,Wl,null),$n(this,"resizeObserver",new ResizeObserver(c=>{sm(()=>{!Array.isArray(c)||!c.length||(Qi(Go,this,jn(Go,this)+1),jn(Go,this)===300&&($r("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),jn(Wl,this)!==null&&clearTimeout(jn(Wl,this)),Qi(Wl,this,setTimeout(()=>{Qi(Go,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Ut(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:zu(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...jn(qo,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new DV(...e),this.bottomOverlay=new hV(...e),this.inlineStartOverlay=new _V(...e),this.topInlineStartCornerOverlay=new PV(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new sV(...e,this.bottomOverlay,this.inlineStartOverlay),Qi(qo,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Qi(Vl,this,jn(qo,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),jn(qo,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),jn(qo,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!_N())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{sm(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Qi(Go,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){if(e.ctrlKey)return;const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=GN(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!jn(Vl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Qi(Vl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=zu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),g=r.hider.style,w=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),v=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,h-r.holder.clientWidth),b=w()?1:0,T=v()?1:0;g.width=`${h+T}px`,g.height=`${c+b}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return j(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];j(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function uR(t,e,r){return(e=VV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VV(t){var e=WV(t,"string");return typeof e=="symbol"?e:e+""}function WV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BV{constructor(e){uR(this,"settings",{}),uR(this,"defaults",Object.freeze(this.getDefaults())),Ie(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);gl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Ie(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Bp extends Bs{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Uu(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=eS(e,"height",r),o=eS(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Xa(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Qe(Bp,Ap);Qe(Bp,xc);class $V{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new yL:new TL],["fullyVisible",()=>new uL],["partiallyVisible",()=>new m0]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new pL:new SL],["fullyVisible",()=>new sL],["partiallyVisible",()=>new g0]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=lr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const i=this.domBindings.rootDocument.documentElement;return i.scrollWidth>i.clientWidth}const{hider:e}=this.wtTable,r=e.offsetWidth,n=this.hasVerticalScroll()?Ut():0;return r>this.getWorkspaceWidth()-n}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return Fr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=lr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=or(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=Ut(this.domBindings.rootDocument),new AL({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=Ut(this.domBindings.rootDocument)),new PL({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible"),s=n.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,r){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:i}=e;const{startRow:o,endRow:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;n=o,i=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e,r){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:i}=e;const{startColumn:o,endColumn:s}=r;if(n===null&&i===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;n=o,i=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(n=Math.max(0,n-Math.min(u,d)),i=Math.min(h,i+Math.min(c,d))):d==="auto"&&(n=Math.max(0,n-Math.ceil(u/2)),i=Math.min(h,i+Math.ceil(c/2))),n<a||n===a&&n>0?!1:!(i>l||i===l&&i<h)}resetHasOversizedColumnHeadersMarked(){Ie(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class jV extends xp{constructor(e,r){super(e,new BV(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Bp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new $V(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new EV(this.wtSettings.getSetting("selections")),this.wtEvent=new b0(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new FV(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Ie(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),Me(this.wtTable.wtRootElement.parentNode,r),Z(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!R0.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class $p{constructor(e){e instanceof xp?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new $p(r);return()=>n},this._wot=new jV(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function cR(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function zV(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function hR(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const UV=new Map([["touchstart",cR],["touchend",hR],["mousedown",cR],["mouseover",zV],["mouseup",hR]]);function hg(t,e){UV.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:r0(t)||t.type==="touchstart",isRightClick:Yu(t),...e})}const I0=new WeakMap,jp=Symbol("rootInstance");function YV(t){I0.set(t,!0)}function qV(t){return t===jp}function lo(t){return I0.has(t)}function GV(t,e){P0(t,e),e.add(t)}function wi(t,e,r){P0(t,e),e.set(t,r)}function P0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vi(t,e,r){return(e=KV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KV(t){var e=XV(t,"string");return typeof e=="symbol"?e:e+""}function XV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rt(t,e){return t.get(Ss(t,e))}function Xt(t,e,r){return t.set(Ss(t,e),r),r}function Ss(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dg=new WeakMap,Bl=new WeakMap,$l=new WeakMap,zn=new WeakMap,Jr=new WeakMap,fg=new WeakMap,gg=new WeakMap,Ko=new WeakMap,Ma=new WeakSet;class ZV{constructor(e){GV(this,Ma),vi(this,"hot",void 0),vi(this,"eventManager",void 0),vi(this,"settings",void 0),vi(this,"THEAD",void 0),vi(this,"TBODY",void 0),vi(this,"_wt",void 0),vi(this,"activeWt",void 0),wi(this,dg,0),wi(this,Bl,0),vi(this,"postponedAdjustElementsSize",!1),wi(this,$l,!1),wi(this,zn,void 0),wi(this,Jr,void 0),wi(this,fg,0),wi(this,gg,0),wi(this,Ko,null),this.hot=e,this.eventManager=new Wi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),Ss(Ma,this,QV).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Z(e,"handsontable"),Xt(Jr,this,r.createElement("TABLE")),Z(rt(Jr,this),"htCore"),this.hot.getSettings().tableClassName&&Z(rt(Jr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Te(rt(Jr,this),[xi()]),Te(e,[oN(),k_(-1),_c(this.hot.countCols()),wN()])),this.THEAD=r.createElement("THEAD"),rt(Jr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),rt(Jr,this).appendChild(this.TBODY),this.hot.table=rt(Jr,this),this.hot.container.insertBefore(rt(Jr,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:r,rootDocument:n,selection:i,rootWindow:o}=this.hot,s=n.documentElement;this.eventManager.addEventListener(r,"mousedown",l=>{Xt($l,this,!0),this.isTextSelectionAllowed(l.target)||(tS(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(r,"mouseup",()=>{Xt($l,this,!1)}),this.eventManager.addEventListener(r,"mousemove",l=>{rt($l,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&tS(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{var u;i.isInProgress()&&r0(l)&&i.finish(),Xt(zn,this,!1);const c=J_(n.activeElement),h=(u=n.querySelector(".ht-dialog"))===null||u===void 0?void 0:u.contains(n.activeElement);Tu(n.activeElement)&&!c||h||(c||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!(e??r).contains(l.target)&&!Yu(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{i.isInProgress()&&Yu(l)&&(i.finish(),Xt(zn,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),Xt(zn,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(rt(zn,this)||!r||!this.hot.view)return;const{holder:g}=this._wt.wtTable;if(d===g){const v=Ut(n);if(n.elementFromPoint(c+v,h)!==g||n.elementFromPoint(c,h+v)!==g)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===r)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Ka(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Ka(a);this.eventManager.addEventListener(rt(Jr,this),"selectstart",l=>{this.settings.fragmentSelection||Tu(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Z(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Me(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:rt(Jr,this),isDataViewInstance:()=>lo(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Xt(Bl,this,o.length),this.hot.getSettings().ariaTags&&Ss(Ma,this,x0).call(this)===this.hot.countCols()&&Ss(Ma,this,JV).call(this,rt(Bl,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Xt(dg,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),w=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,v,g),this.hot.runHooks("afterRenderer",a,l,u,w,v,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Xa(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Xt(zn,this,!0),Xt(Ko,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!uo(o)&&(hg(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Xt(zn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!uo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!uo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!uo(o)&&(rt(zn,this)&&(!rt(Ko,this)||rt(Ko,this).x!==o.clientX||rt(Ko,this).y!==o.clientY)&&hg(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Xt(Ko,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(uo(o)||this.hot.isDestroyed)&&(hg(o,{coords:u,selection:this.hot.selection,cellRangeMapper:ck(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[w,v,b,T]=g;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,T>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new $p(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var r,n;if(Tu(e))return!0;const i=ys(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&i)return!0;const o=(r=(n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingleCell())!==null&&r!==void 0?r:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&i||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return rt(zn,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!ye(n,"relative")){Os(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;ye(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",Z(s,["relative",...o()])):(Os(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Te(a,...xi()),Te(l,...xi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):ye(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?q_(e,n(r,i)):(gl(e,"Â "),Z(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Xt(fg,this,e),Xt(gg,this,r)}getLastSize(){return{width:rt(fg,this),height:rt(gg,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return rt(dg,this)}getRowHeadersCount(){return rt(Bl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function x0(){return parseInt(this.hot.rootElement.getAttribute(_c()[0]),10)}function JV(t){const e=Ss(Ma,this,x0).call(this)+t;Te(this.hot.rootElement,..._c(e))}function QV(){const t=this.hot.rootElement;this.hasVerticalScroll()?Z(t,"htHasScrollY"):Me(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?Z(t,"htVerticallyScrollableByWindow"):Me(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?Z(t,"htHasScrollX"):Me(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?Z(t,"htHorizontallyScrollableByWindow"):Me(t,"htHorizontallyScrollableByWindow")}var dR={},fR={},gR;function eW(){if(gR)return fR;gR=1;var t=Fe(),e=vt(),r=Ls(),n=Er(),i=yt(),o=zi(),s=Tr(),a=Ao(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,w){if(!c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),fR}var mR;function tW(){return mR||(mR=1,eW()),dR}tW();const rW="ABCDEFGHIJKLMNOPQRSTUVWXYZ",pR=rW.length;function nW(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%pR,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/pR,10);return r}function H0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ot(t[0])&&(e=yp(t[0]))),e}function ua(t,e,r){return(e=iW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iW(t){var e=oW(t,"string");return typeof e=="symbol"?e:e+""}function oW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sW{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];ua(this,"hot",void 0),ua(this,"data",void 0),ua(this,"dataType","array"),ua(this,"colToProp",()=>{}),ua(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return j(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Xe(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(ot(a)||Ee(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Xe(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?Ff(l,d,g):l[d]=g}})}else Ie(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Ff(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=yr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:Ff(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?om(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=yr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Xe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}getCopyable(e,r){const n=this.propToCol(r);return this.hot.getCellMeta(e,n).copyable?this.getAtCell(this.hot.toPhysicalRow(e),n):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return H0(this.data)}destroy(){this.data=null,this.hot=null}}var wR={},vR={},yR;function aW(){if(yR)return vR;yR=1;var t=Fe(),e=vt(),r=Ls(),n=Er(),i=yt(),o=zi(),s=Tr(),a=Ao(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),vR}var bR;function lW(){return bR||(bR=1,aW()),wR}lW();function CR(t,e,r){return(e=uW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uW(t){var e=cW(t,"string");return typeof e=="symbol"?e:e+""}function cW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;CR(this,"indexedValues",[]),CR(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ee(this.initValueOrFn)?Xe(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Xe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Qe(vl,Nn);function A0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Ee(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function D0(t,e){return pp(t,(r,n)=>e.includes(n)===!1)}class Hc extends vl{insert(e,r){this.indexedValues=A0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=D0(this.indexedValues,e),super.remove(e)}}class N0 extends Hc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return No(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function k0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Ku(t,e){return pp(t,r=>e.includes(r)===!1)}function L0(t,e){return xn(t,r=>r-e.filter(n=>n<r).length)}function F0(t,e){const r=e[0],n=e.length;return xn(t,i=>i>=r?i+n:i)}function hW(t,e,r){return(e=dW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dW(t){var e=fW(t,"string");return typeof e=="symbol"?e:e+""}function fW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gW extends vl{constructor(){super(...arguments),hW(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ku(this.orderOfIndexes,[e]),Ee(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=A0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=F0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=D0(this.indexedValues,e),this.orderOfIndexes=Ku(this.orderOfIndexes,e),this.orderOfIndexes=L0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class V0 extends Hc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return No(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class mW extends vl{constructor(){super(e=>e)}insert(e,r){const n=F0(this.indexedValues,r);this.indexedValues=k0(n,e,r),super.insert(e,r)}remove(e){const r=Ku(this.indexedValues,e);this.indexedValues=L0(r,e),super.remove(e)}}const SR=new Map([["hiding",N0],["index",vl],["linkedPhysicalIndexToValue",gW],["physicalIndexToValue",Hc],["trimming",V0]]);function pW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!SR.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(SR.get(t))(e)}function wW(t,e,r){return(e=vW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vW(t){var e=yW(t,"string");return typeof e=="symbol"?e:e+""}function yW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zp{constructor(){wW(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);de(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return $t(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Qe(zp,Nn);function mg(t,e,r){return(e=bW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bW(t){var e=CW(t,"string");return typeof e=="symbol"?e:e+""}function CW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RR extends zp{constructor(e,r){super(),mg(this,"mergedValuesCache",[]),mg(this,"aggregationFunction",void 0),mg(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=xn(this.get(),o=>o.getValues()),n=[],i=de(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return xn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return de(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function SW(t,e,r){RW(t,e),e.set(t,r)}function RW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EW(t,e,r){return t.set(W0(t,e),r),r}function TW(t,e){return t.get(W0(t,e))}function W0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pg=new WeakMap;class B0{constructor(){SW(this,pg,[])}subscribe(e){return this.addLocalHook("change",e),this._write(TW(pg,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){EW(pg,this,e)}}Qe(B0,Nn);function ER(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ca(t,e,r){_W(t,e),e.set(t,r)}function _W(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dr(t,e){return t.get($0(t,e))}function jl(t,e,r){return t.set($0(t,e),r),r}function $0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zl=new WeakMap,ha=new WeakMap,Ul=new WeakMap,Yl=new WeakMap,ql=new WeakMap;class OW{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ca(this,zl,new Set),ca(this,ha,[]),ca(this,Ul,[]),ca(this,Yl,!1),ca(this,ql,!1),jl(ql,this,e??!1)}createObserver(){const e=new B0;return Dr(zl,this).add(e),e.addLocalHook("unsubscribe",()=>{Dr(zl,this).delete(e)}),e._writeInitialChanges(ER(Dr(ha,this),Dr(Ul,this))),e}emit(e){let r=Dr(Ul,this);(!Dr(Yl,this)||Dr(ha,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Dr(ql,this)):jl(ha,this,new Array(e.length).fill(Dr(ql,this))),Dr(Yl,this)||(jl(Yl,this,!0),r=Dr(ha,this)));const n=ER(r,e);Dr(zl,this).forEach(i=>i._write(n)),jl(Ul,this,e)}}function Lt(t,e,r){return(e=MW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MW(t){var e=IW(t,"string");return typeof e=="symbol"?e:e+""}function IW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fm{constructor(){Lt(this,"indexesSequence",new mW),Lt(this,"trimmingMapsCollection",new RR(e=>e.some(r=>r===!0),!1)),Lt(this,"hidingMapsCollection",new RR(e=>e.some(r=>r===!0),!1)),Lt(this,"variousMapsCollection",new zp),Lt(this,"hidingChangesObservable",new OW({initialIndexValue:!1})),Lt(this,"notTrimmedIndexesCache",[]),Lt(this,"notHiddenIndexesCache",[]),Lt(this,"isBatched",!1),Lt(this,"indexesSequenceChanged",!1),Lt(this,"indexesChangeSource",void 0),Lt(this,"trimmedIndexesChanged",!1),Lt(this,"hiddenIndexesChanged",!1),Lt(this,"renderablePhysicalIndexesCache",[]),Lt(this,"fromPhysicalToVisualIndexesCache",new Map),Lt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,pW(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof V0?this.trimmingMapsCollection.register(e,r):r instanceof N0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return de(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return de(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return de(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return de(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=xn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ku(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(k0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=de(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=xn(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Qe(fm,Nn);function PW(t,e){return Ie(e,(r,n)=>{$t(t[n])&&(t[n]=r)}),t}function j0(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function z0(t){de(t)&&XN(ar`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function xW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function U0(t,e){return Array.isArray(t)?t.map(r=>U0(r,e)):H_(t,e)}const{register:HW,getValues:AW}=Lo("phraseFormatters");function Y0(t,e){HW(t,e)}function DW(){return AW()}Y0("pluralize",xW);Y0("substitute",U0);const q0="ContextMenu:items",ne=q0,Up=`${ne}.noItems`,Yp=`${ne}.insertRowAbove`,qp=`${ne}.insertRowBelow`,Gp=`${ne}.insertColumnOnTheLeft`,Kp=`${ne}.insertColumnOnTheRight`,Xp=`${ne}.removeRow`,Zp=`${ne}.removeColumn`,Jp=`${ne}.undo`,Qp=`${ne}.redo`,Xu=`${ne}.readOnly`,ew=`${ne}.clearColumn`,tw=`${ne}.copy`,rw=`${ne}.copyWithHeaders`,nw=`${ne}.copyWithGroupHeaders`,iw=`${ne}.copyHeadersOnly`,ow=`${ne}.cut`,G0=`${ne}.freezeColumn`,K0=`${ne}.unfreezeColumn`,X0=`${ne}.mergeCells`,Z0=`${ne}.unmergeCells`,J0=`${ne}.addComment`,Q0=`${ne}.editComment`,eO=`${ne}.removeComment`,tO=`${ne}.readOnlyComment`,sw=`${ne}.align`,aw=`${ne}.align.left`,lw=`${ne}.align.center`,uw=`${ne}.align.right`,cw=`${ne}.align.justify`,hw=`${ne}.align.top`,dw=`${ne}.align.middle`,fw=`${ne}.align.bottom`,rO=`${ne}.borders`,nO=`${ne}.borders.top`,iO=`${ne}.borders.right`,oO=`${ne}.borders.bottom`,sO=`${ne}.borders.left`,aO=`${ne}.borders.remove`,lO=`${ne}.nestedHeaders.insertChildRow`,uO=`${ne}.nestedHeaders.detachFromParent`,cO=`${ne}.hideColumn`,hO=`${ne}.showColumn`,dO=`${ne}.hideRow`,fO=`${ne}.showRow`,ur="Filters:",et=`${ur}conditions`,gO=`${et}.none`,mO=`${et}.isEmpty`,pO=`${et}.isNotEmpty`,wO=`${et}.isEqualTo`,vO=`${et}.isNotEqualTo`,yO=`${et}.beginsWith`,bO=`${et}.endsWith`,CO=`${et}.contains`,SO=`${et}.doesNotContain`,NW=`${et}.byValue`,RO=`${et}.greaterThan`,EO=`${et}.greaterThanOrEqualTo`,TO=`${et}.lessThan`,_O=`${et}.lessThanOrEqualTo`,OO=`${et}.isBetween`,MO=`${et}.isNotBetween`,IO=`${et}.after`,PO=`${et}.before`,xO=`${et}.today`,HO=`${et}.tomorrow`,AO=`${et}.yesterday`,DO=`${ur}labels.filterByCondition`,NO=`${ur}labels.filterByValue`,kO=`${ur}labels.conjunction`,LO=`${ur}labels.disjunction`,FO=`${ur}values.blankCells`,VO=`${ur}buttons.selectAll`,WO=`${ur}buttons.clear`,BO=`${ur}buttons.ok`,$O=`${ur}buttons.cancel`,jO=`${ur}buttons.placeholder.search`,zO=`${ur}buttons.placeholder.value`,UO=`${ur}buttons.placeholder.secondValue`,kn="Pagination:",YO=`${kn}section.pagination`,qO=`${kn}.pageSize.auto`,GO=`${kn}section.pageSize`,KO=`${kn}section.counter`,XO=`${kn}section.navigation`,ZO=`${kn}firstPage`,JO=`${kn}prevPage`,QO=`${kn}nextPage`,eM=`${kn}lastPage`,gw="CheckboxRenderer:",tM=`${gw}checked`,rM=`${gw}unchecked`,nM="Loading:",iM=`${nM}title`,kW=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:tM,CHECKBOX_RENDERER_NAMESPACE:gw,CHECKBOX_UNCHECKED:rM,CONTEXTMENU_ITEMS_ADD_COMMENT:J0,CONTEXTMENU_ITEMS_ALIGNMENT:sw,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:fw,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:lw,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:cw,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:aw,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:dw,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:uw,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:hw,CONTEXTMENU_ITEMS_BORDERS:rO,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:oO,CONTEXTMENU_ITEMS_BORDERS_LEFT:sO,CONTEXTMENU_ITEMS_BORDERS_RIGHT:iO,CONTEXTMENU_ITEMS_BORDERS_TOP:nO,CONTEXTMENU_ITEMS_CLEAR_COLUMN:ew,CONTEXTMENU_ITEMS_COPY:tw,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:iw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:nw,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:rw,CONTEXTMENU_ITEMS_CUT:ow,CONTEXTMENU_ITEMS_EDIT_COMMENT:Q0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:G0,CONTEXTMENU_ITEMS_HIDE_COLUMN:cO,CONTEXTMENU_ITEMS_HIDE_ROW:dO,CONTEXTMENU_ITEMS_INSERT_LEFT:Gp,CONTEXTMENU_ITEMS_INSERT_RIGHT:Kp,CONTEXTMENU_ITEMS_MERGE_CELLS:X0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:uO,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:lO,CONTEXTMENU_ITEMS_NO_ITEMS:Up,CONTEXTMENU_ITEMS_READ_ONLY:Xu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:tO,CONTEXTMENU_ITEMS_REDO:Qp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:aO,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Zp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:eO,CONTEXTMENU_ITEMS_REMOVE_ROW:Xp,CONTEXTMENU_ITEMS_ROW_ABOVE:Yp,CONTEXTMENU_ITEMS_ROW_BELOW:qp,CONTEXTMENU_ITEMS_SHOW_COLUMN:hO,CONTEXTMENU_ITEMS_SHOW_ROW:fO,CONTEXTMENU_ITEMS_UNDO:Jp,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:K0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Z0,CONTEXT_MENU_ITEMS_NAMESPACE:q0,FILTERS_BUTTONS_CANCEL:$O,FILTERS_BUTTONS_CLEAR:WO,FILTERS_BUTTONS_OK:BO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:jO,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:UO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:zO,FILTERS_BUTTONS_SELECT_ALL:VO,FILTERS_CONDITIONS_AFTER:IO,FILTERS_CONDITIONS_BEFORE:PO,FILTERS_CONDITIONS_BEGINS_WITH:yO,FILTERS_CONDITIONS_BETWEEN:OO,FILTERS_CONDITIONS_BY_VALUE:NW,FILTERS_CONDITIONS_CONTAINS:CO,FILTERS_CONDITIONS_EMPTY:mO,FILTERS_CONDITIONS_ENDS_WITH:bO,FILTERS_CONDITIONS_EQUAL:wO,FILTERS_CONDITIONS_GREATER_THAN:RO,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:EO,FILTERS_CONDITIONS_LESS_THAN:TO,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:_O,FILTERS_CONDITIONS_NAMESPACE:et,FILTERS_CONDITIONS_NONE:gO,FILTERS_CONDITIONS_NOT_BETWEEN:MO,FILTERS_CONDITIONS_NOT_CONTAIN:SO,FILTERS_CONDITIONS_NOT_EMPTY:pO,FILTERS_CONDITIONS_NOT_EQUAL:vO,FILTERS_CONDITIONS_TODAY:xO,FILTERS_CONDITIONS_TOMORROW:HO,FILTERS_CONDITIONS_YESTERDAY:AO,FILTERS_DIVS_FILTER_BY_CONDITION:DO,FILTERS_DIVS_FILTER_BY_VALUE:NO,FILTERS_LABELS_CONJUNCTION:kO,FILTERS_LABELS_DISJUNCTION:LO,FILTERS_NAMESPACE:ur,FILTERS_VALUES_BLANK_CELLS:FO,LOADING_NAMESPACE:nM,LOADING_TITLE:iM,PAGINATION_COUNTER_SECTION:KO,PAGINATION_FIRST_PAGE:ZO,PAGINATION_LAST_PAGE:eM,PAGINATION_NAMESPACE:kn,PAGINATION_NAV_SECTION:XO,PAGINATION_NEXT_PAGE:QO,PAGINATION_PAGE_SIZE_AUTO:qO,PAGINATION_PAGE_SIZE_SECTION:GO,PAGINATION_PREV_PAGE:JO,PAGINATION_SECTION:YO},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const oM={languageCode:"en-US",[Up]:"No available options",[Yp]:"Insert row above",[qp]:"Insert row below",[Gp]:"Insert column left",[Kp]:"Insert column right",[Xp]:["Remove row","Remove rows"],[Zp]:["Remove column","Remove columns"],[Jp]:"Undo",[Qp]:"Redo",[Xu]:"Read only",[ew]:"Clear column",[sw]:"Alignment",[aw]:"Left",[lw]:"Center",[uw]:"Right",[cw]:"Justify",[hw]:"Top",[dw]:"Middle",[fw]:"Bottom",[G0]:"Freeze column",[K0]:"Unfreeze column",[rO]:"Borders",[nO]:"Top",[iO]:"Right",[oO]:"Bottom",[sO]:"Left",[aO]:"Remove border(s)",[J0]:"Add comment",[Q0]:"Edit comment",[eO]:"Delete comment",[tO]:"Read-only comment",[X0]:"Merge cells",[Z0]:"Unmerge cells",[tw]:"Copy",[rw]:["Copy with header","Copy with headers"],[nw]:["Copy with group header","Copy with group headers"],[iw]:["Copy header only","Copy headers only"],[ow]:"Cut",[lO]:"Insert child row",[uO]:"Detach from parent",[cO]:["Hide column","Hide columns"],[hO]:["Show column","Show columns"],[dO]:["Hide row","Hide rows"],[fO]:["Show row","Show rows"],[gO]:"None",[mO]:"Is empty",[pO]:"Is not empty",[wO]:"Is equal to",[vO]:"Is not equal to",[yO]:"Begins with",[bO]:"Ends with",[CO]:"Contains",[SO]:"Does not contain",[RO]:"Greater than",[EO]:"Greater than or equal to",[TO]:"Less than",[_O]:"Less than or equal to",[OO]:"Is between",[MO]:"Is not between",[IO]:"After",[PO]:"Before",[xO]:"Today",[HO]:"Tomorrow",[AO]:"Yesterday",[FO]:"Blank cells",[DO]:"Filter by condition",[NO]:"Filter by value",[kO]:"And",[LO]:"Or",[VO]:"Select all",[WO]:"Clear",[BO]:"OK",[$O]:"Cancel",[jO]:"Search",[zO]:"Value",[UO]:"Second value",[YO]:"Pagination",[GO]:"Page size",[qO]:"Auto",[KO]:"[start] - [end] of [total]",[XO]:"Page [currentPage] of [totalPages]",[ZO]:"Go to first page",[JO]:"Go to previous page",[QO]:"Go to next page",[eM]:"Go to last page",[tM]:"Checked",[rM]:"Unchecked",[iM]:"Loading..."},LW=kW,gm=oM.languageCode,{register:FW,getItem:sM,hasItem:VW,getValues:WW}=Lo("languagesDictionaries");aM(oM);function aM(t,e){let r=t,n=e;return ot(t)&&(n=t,r=n.languageCode),BW(r,n),FW(r,Rr(n)),Rr(n)}function BW(t,e){t!==gm&&PW(e,sM(gm))}function lM(t){return mw(t)?Rr(sM(t)):null}function mw(t){return VW(t)}function $W(){return WW()}function uM(t,e,r){const n=lM(t);if(n===null)return null;const i=n[e];if($t(i))return null;const o=jW(i,r);return Array.isArray(o)?o[0]:o}function jW(t,e){return DW().reduce((r,n)=>n(r,e),t)}function zW(t){let e=j0(t);return mw(e)||(e=gm,z0(t)),e}function UW(t,e,r){return(e=YW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YW(t){var e=qW(t,"string");return typeof e=="symbol"?e:e+""}function qW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hi extends E0{constructor(e,r){super(e,null),UW(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function wg(t){let{activeHeaderClassName:e,...r}=t;return new hi({className:e,...r,selectionType:gV})}function GW(t){let{areaCornerVisible:e,...r}=t;return new hi({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:Np})}function KW(t){let{...e}=t;return new hi({className:"highlight",...e,selectionType:Np})}function XW(t){let{columnClassName:e,...r}=t;return new hi({className:e,...r,selectionType:wV})}function ZW(t){let{cellCornerVisible:e,...r}=t;return new hi({className:"current",headerAttributes:[F_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Gu})}function JW(t){let{border:e,visualCellRange:r,...n}=t;return new hi({...e,...n,selectionType:vV},r)}function QW(t){let{...e}=t;return new hi({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:mV})}function TR(t){let{headerClassName:e,...r}=t;return new hi({className:e,...r,selectionType:T0})}function eB(t){let{rowClassName:e,...r}=t;return new hi({className:e,...r,selectionType:pV})}function tB(t,e){rB(t,e),e.add(t)}function rB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e,r){return(e=nB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nB(t){var e=iB(t,"string");return typeof e=="symbol"?e:e+""}function iB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Un(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bn=new WeakSet;class oB{constructor(e){tB(this,bn),Zt(this,"options",void 0),Zt(this,"layerLevel",0),Zt(this,"focus",void 0),Zt(this,"fill",void 0),Zt(this,"layeredAreas",new Map),Zt(this,"areas",new Map),Zt(this,"rowHeaders",new Map),Zt(this,"columnHeaders",new Map),Zt(this,"activeRowHeaders",new Map),Zt(this,"activeColumnHeaders",new Map),Zt(this,"activeCornerHeaders",new Map),Zt(this,"rowHighlights",new Map),Zt(this,"columnHighlights",new Map),Zt(this,"customSelections",[]),this.options=e,this.focus=ZW(e),this.fill=QW(e)}isEnabledFor(e,r){let n=e;e===Gu&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Un(bn,this,Yn).call(this,this.layeredAreas,GW)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Un(bn,this,Yn).call(this,this.areas,KW)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Un(bn,this,Yn).call(this,this.rowHeaders,TR)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Un(bn,this,Yn).call(this,this.columnHeaders,TR)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Un(bn,this,Yn).call(this,this.activeRowHeaders,wg)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Un(bn,this,Yn).call(this,this.activeColumnHeaders,wg)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Un(bn,this,Yn).call(this,this.activeCornerHeaders,wg)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Un(bn,this,Yn).call(this,this.rowHighlights,eB)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Un(bn,this,Yn).call(this,this.columnHighlights,XW)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(JW({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),j(this.areas.values(),e=>void e.clear()),j(this.layeredAreas.values(),e=>void e.clear()),j(this.rowHeaders.values(),e=>void e.clear()),j(this.columnHeaders.values(),e=>void e.clear()),j(this.activeRowHeaders.values(),e=>void e.clear()),j(this.activeColumnHeaders.values(),e=>void e.clear()),j(this.activeCornerHeaders.values(),e=>void e.clear()),j(this.rowHighlights.values(),e=>void e.clear()),j(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Yn(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function _R(t,e,r){return(e=sB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sB(t){var e=aB(t,"string");return typeof e=="symbol"?e:e+""}function aB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pw{constructor(e){_R(this,"ranges",[]),_R(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new pw(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function lB(t,e){cM(t,e),e.add(t)}function uB(t,e,r){return(e=cB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cB(t){var e=hB(t,"string");return typeof e=="symbol"?e:e+""}function hB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vg(t,e,r){cM(t,e),e.set(t,r)}function cM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ht(t,e){return t.get(Re(t,e))}function ds(t,e,r){return t.set(Re(t,e),r),r}function Re(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Zn=new WeakMap,ho=new WeakMap,br=new WeakMap,Oe=new WeakSet;class ww{constructor(e,r){lB(this,Oe),vg(this,Zn,void 0),vg(this,ho,0),vg(this,br,{x:0,y:0}),uB(this,"tableApi",void 0),ds(Zn,this,e),this.tableApi=r}setActiveLayerIndex(e){ds(ho,this,e)}getCurrentSelection(){return ht(Zn,this).peekByIndex(ht(ho,this))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ds(br,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,r);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:u,height:c}=Re(Oe,this,mm).call(this);const{row:h,col:d}=Re(Oe,this,PR).call(this,o),g=this.tableApi.fixedRowsBottom(),w=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),b=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),C=this.tableApi.createCellCoords(h+i.row,d+i.col);if(C.row>=c){const M=yr(n&&w>0&&g===0),H=C.col+1,P=H>=u,A=this.tableApi.createCellCoords(C.row-c,P?H-u:H);if(this.runLocalHooks("beforeColumnWrap",M,Re(Oe,this,Xo).call(this,A),P),M.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&P&&ht(Zn,this).size()>1){Re(Oe,this,OR).call(this);const F=Re(Oe,this,Gl).call(this,"forward");F!==null&&A.assign(F)}C.assign(A)}}else if(C.row<0){const M=yr(T),H=C.col-1,P=H<0,A=this.tableApi.createCellCoords(c+C.row,P?u+H:H);if(this.runLocalHooks("beforeColumnWrap",M,Re(Oe,this,Xo).call(this,A),P),T){if(this.shouldSwitchSelectionLayer()&&P&&ht(Zn,this).size()>1){Re(Oe,this,MR).call(this);const F=Re(Oe,this,Gl).call(this,"backward");F!==null&&A.assign(F)}C.assign(A)}}if({width:u,height:c}=Re(Oe,this,mm).call(this),C.col>=u){const M=yr(n&&v>0),H=C.row+1,P=H>=c,A=this.tableApi.createCellCoords(P?H-c:H,C.col-u);if(this.runLocalHooks("beforeRowWrap",M,Re(Oe,this,Xo).call(this,A),P),M.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(b){if(this.shouldSwitchSelectionLayer()&&P&&ht(Zn,this).size()>1){Re(Oe,this,OR).call(this);const F=Re(Oe,this,Gl).call(this,"forward");F!==null&&A.assign(F)}C.assign(A)}}else if(C.col<0){const M=yr(b),H=C.row-1,P=H<0,A=this.tableApi.createCellCoords(P?c+H:H,u+C.col);if(this.runLocalHooks("beforeRowWrap",M,Re(Oe,this,Xo).call(this,A),P),b){if(this.shouldSwitchSelectionLayer()&&P&&ht(Zn,this).size()>1){Re(Oe,this,MR).call(this);const F=Re(Oe,this,Gl).call(this,"backward");F!==null&&A.assign(F)}C.assign(A)}}const{rowDir:E,colDir:y}=Re(Oe,this,IR).call(this,C);a=E,l=y,o=Re(Oe,this,Xo).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:ht(ho,this),visualCoords:o}}transformEnd(e,r){ds(br,this,this.calculateOffset());const n=this.tableApi.createCellCoords(e,r),i=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(i.highlight),s=Re(Oe,this,_u).call(this,i.to.row,i.from.row),a=Re(Oe,this,Ou).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=Re(Oe,this,PR).call(this,i.highlight),g=this.tableApi.createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),v=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const y=g.col-d;g.col=Re(Oe,this,Ou).call(this,w.col,v.col)+y}else if(n.col>0&&a<=d&&g.col>d){const y=Re(Oe,this,Ou).call(this,v.col,w.col),M=Math.max(g.col-y,1);g.col=y+M}if(n.row<0&&s>=h&&g.row<h){const y=g.row-h;g.row=Re(Oe,this,_u).call(this,w.row,b.row)+y}else if(n.row>0&&s<=h&&g.row>h){const y=Re(Oe,this,_u).call(this,b.row,w.row),M=Math.max(g.row-y,1);g.row=y+M}const{rowDir:T,colDir:C}=Re(Oe,this,IR).call(this,g);u=T,c=C;const E=Re(Oe,this,Xo).call(this,g);n.row===0&&n.col!==0?l.col=E.col:n.row!==0&&n.col===0?l.row=E.row:(l.row=E.row,l.col=E.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:ht(ho,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function OR(){const t=ht(ho,this)+1;this.setActiveLayerIndex(t>=ht(Zn,this).size()?0:t),ds(br,this,this.calculateOffset())}function MR(){const t=ht(ho,this)-1;this.setActiveLayerIndex(t<0?ht(Zn,this).size()-1:t),ds(br,this,this.calculateOffset())}function IR(t){const{width:e,height:r}=Re(Oe,this,mm).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function mm(){return{width:ht(br,this).x+this.countRenderableColumns(),height:ht(br,this).y+this.countRenderableRows()}}function Gl(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),r=this.getCurrentSelection().getBottomEndCorner(),[n,i,o,s]=t==="forward"?[e.row,r.row,e.col,r.col]:[r.row,e.row,r.col,e.col],a=Re(Oe,this,_u).call(this,n,i),l=Re(Oe,this,Ou).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function _u(t,e){const r=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return r===null?null:ht(br,this).y+r}function Ou(t,e){const r=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return r===null?null:ht(br,this).x+r}function PR(t){const{row:e,col:r}=this.tableApi.visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(ht(br,this).y+e,ht(br,this).x+r)}function Xo(t){const e=t.clone();return e.col=t.col-ht(br,this).x,e.row=t.row-ht(br,this).y,this.tableApi.renderableToVisualCoords(e)}Qe(ww,Nn);class dB extends ww{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class fB extends ww{calculateOffset(){const e=this.getCurrentSelection(),{row:r,col:n}=e.getOuterTopStartCorner(),i=this.tableApi.countRenderableColumnsInRange(0,n-1),o=this.tableApi.countRenderableRowsInRange(0,r-1),s=e.highlight.isHeader(),a=s?Math.abs(n):0,l=s?Math.abs(r):0;return{x:n<0?a:-i,y:r<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const Ac=0,Dc=1,hM=2,vw=3,gB=[vw,hM],mB=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],yg=Symbol("root"),xR=Symbol("child");function Nc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yg;if(e!==yg&&e!==xR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===yg;let i=Ac;if(r){const o=t[0];t.length===0?i=Dc:n&&o instanceof ml?i=vw:n&&Array.isArray(o)?i=Nc(o,xR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!mB[l].includes(typeof a))&&(i=hM)}return i}function yw(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!gB.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===vw;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),$t(u)&&(u=a),$t(c)&&(c=l),!n){const w=a,v=l,b=u,T=c;a=Math.min(w,b),l=Math.min(v,T),u=Math.max(w,b),c=Math.max(v,T)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),g=e(u,c);return r(h,d,g)}}function pB(t){const e=Nc(t.getSelected());if(e===Ac||e===Dc)return[];const r=yw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return No(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function wB(t){const e=Nc(t.getSelected());if(e===Ac||e===Dc)return[];const r=yw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;j(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;j(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return No(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function eo(t,e,r){vB(t,e),e.set(t,r)}function vB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function to(t,e,r){return(e=yB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yB(t){var e=bB(t,"string");return typeof e=="symbol"?e:e+""}function bB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ze(t,e){return t.get(dM(t,e))}function fr(t,e,r){return t.set(dM(t,e),r),r}function dM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gr=new WeakMap,Zo=new WeakMap,Kl=new WeakMap,yi=new WeakMap,Xl=new WeakMap,da=new WeakMap,Zl=new WeakMap;class fM{constructor(e,r){var n=this;to(this,"settings",void 0),to(this,"tableProps",void 0),to(this,"inProgress",!1),to(this,"selectedRange",new pw((i,o,s)=>this.tableProps.createCellRange(i,o,s))),to(this,"highlight",void 0),eo(this,gr,void 0),eo(this,Zo,void 0),to(this,"selectedByRowHeader",new Set),to(this,"selectedByColumnHeader",new Set),eo(this,Kl,!1),eo(this,yi,!1),eo(this,Xl,"unknown"),eo(this,da,-1),eo(this,Zl,0),this.settings=e,this.tableProps=r,this.highlight=new oB({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[F_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),fr(gr,this,new dB(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),fr(Zo,this,new fB(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),ze(gr,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),ze(gr,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),ze(gr,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),ze(gr,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),ze(gr,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),ze(gr,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),ze(gr,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),ze(gr,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),ze(Zo,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),ze(Zo,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(ze(Zl,this))}getActiveSelectionLayerIndex(){return ze(Zl,this)}setActiveSelectionLayerIndex(e){fr(Zl,this,e)}markSource(e){fr(Xl,this,e)}markEndSource(){fr(Xl,this,"unknown")}getSelectionSource(){return ze(Xl,this)}setExpectedLayers(e){fr(da,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,fr(da,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=$t(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();fr(yi,this,!1),fr(Kl,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&$t(r))&&(this.selectedRange.clear(),j(this.highlight.getAreas(),l=>void l.clear()),j(this.highlight.getLayeredAreas(),l=>void l.clear()),j(this.highlight.getRowHeaders(),l=>void l.clear()),j(this.highlight.getColumnHeaders(),l=>void l.clear()),j(this.highlight.getActiveRowHeaders(),l=>void l.clear()),j(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),j(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),j(this.highlight.getRowHighlights(),l=>void l.clear()),j(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r);const n=e.clone(),i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((i>0||o>0)&&(i===0&&n.col<0&&!s||o===0&&n.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(n),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}i>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,r),this.applyAndCommit(this.getActiveSelectedRange(),r);const l=ze(da,this)===-1||this.selectedRange.size()===ze(da,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(Np,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.peekByIndex(r-1);this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(T0,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),T=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),E=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(C).commit(),d.add(b).commit(),g.add(C).commit()):(a.add(b).add(T).commit(),l.add(C).add(E).commit(),d.add(b).add(T).commit(),g.add(C).add(E).commit())}const w=!ze(yi,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),v=!ze(yi,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(r),ze(gr,this).setActiveLayerIndex(r),ze(Zo,this).setActiveLayerIndex(r);const n=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Gu,n.highlight)&&i.add(n.highlight).commit().syncWith(n),this.inProgress||(fr(Kl,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:i}=ze(gr,this).transformStart(e,r,n);this.setRangeStart(i)}transformEnd(e,r){const{visualCoords:n,selectionLayer:i}=ze(gr,this).transformEnd(e,r);this.setRangeEnd(n,i)}transformFocus(e,r){const{selectionLayer:n,visualCoords:i}=ze(Zo,this).transformStart(e,r);this.setRangeFocus(i.normalize(),n)}shiftRows(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(De(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(De(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(De(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,De(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,De(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,De(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const r=yr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&ze(Kl,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(De(d.row,u,o-1),De(d.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",w,v,h),this.setRangeStartOnly(w,void 0,h),fr(yi,this,g),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",w,v,h),this.finish()}selectCells(e){var r=this;const n=Nc(e);if(n===Dc)return!1;if(n===Ac)throw new Error(ar`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=yw(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),j(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,w=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=De(n.row,u,s-1),w=De(n.col,Math.min(i,o),Math.max(i,o))):(g=De(n,u,s-1),w=i);const v=this.tableProps.createCellCoords(g,w),b=l===0?0:De(v.row,u,-1),T=s-1,C=this.tableProps.createCellCoords(b,i),E=this.tableProps.createCellCoords(T,o);this.runLocalHooks("beforeSelectColumns",C,E,v),this.setRangeStartOnly(C,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectColumns",C,E,v),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=De(n.row,Math.min(e,r),Math.max(e,r)),d=De(n.col,a,o-1)):(h=e,d=De(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),w=s===0?0:De(g.col,a,-1),v=o-1,b=this.tableProps.createCellCoords(e,w),T=this.tableProps.createCellCoords(r,v);this.runLocalHooks("beforeSelectRows",b,T,g),this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",b,T,g),this.finish()}return c}importSelection(e){let{ranges:r,activeRange:n,activeSelectionLayer:i,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;r.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,fr(yi,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),r.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(n.highlight,i),fr(yi,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:ze(yi,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:De(u.row,this.settings.navigableHeaders?-1/0:0,c),col:De(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:De(a.row,-1/0,c),col:De(a.col,-1/0,h)}),l.assign({row:De(l.row,-1/0,c),col:De(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.getActiveSelectedRange();this.highlight.isEnabledFor(Gu,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Qe(fM,Nn);const HR=/^(\r\n|\n\r|\r|\n)/,CB=/^[^\t\r\n]+/,AR=/^\t/;function SB(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(AR))t=t.replace(AR,""),r+=1,e[n][r]="";else if(t.match(HR))t=t.replace(HR,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(CB);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Zu(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function bg(t,e){const{instance:r,visualRow:n,visualCol:i,valueSetter:o}=e;return Ee(o)?o.call(r,t,n,i,e):t}function RB(t,e){const{instance:r,visualRow:n,visualCol:i,valueGetter:o}=e;return Ee(o)?o.call(r,t,n,i,e):t}function ro(t,e,r){return(e=EB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EB(t){var e=TB(t,"string");return typeof e=="symbol"?e:e+""}function TB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fs{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){ro(this,"hot",void 0),ro(this,"metaManager",void 0),ro(this,"tableMeta",void 0),ro(this,"dataSource",void 0),ro(this,"duckSchema",void 0),ro(this,"colToPropCache",void 0),ro(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=yp(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(ot(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return H0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ie(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&de(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(de(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ga(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=Rr(this.getSchema()):(w=[],Xe(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},V_(w,this.getSchema())),d.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let w=d;g<r&&l+g<s;w++){if(typeof c!="number"||c>=l+g)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(w,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=de(this.tableMeta.columns)||de(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];VC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return ZD(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];VC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Br(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let c=i;if(!c)return null;const h=r.split(".");for(let d=0,g=h.length;d<g;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));const l=this.propToCol(r),u=this.hot.toPhysicalColumn(l);if(Cs(n)&&Cs(u)&&(a=RB(a,this.metaManager.getCellMeta(n,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=yr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=yr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Br(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,fs.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===fs.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return Zu(this.getRange(e,r,fs.DESTINATION_RENDERER))}getCopyableText(e,r){return Zu(this.getRange(e,r,fs.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:_B,getItem:OB,hasItem:gM}=Lo("cellTypes");function MB(t){if(!gM(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return OB(t)}function IB(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&s0(t,r),n&&Zk(t,n),i&&tL(t,i),_B(t,e)}function PB(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Br(e,t)}function kc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?MB(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ie(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!ot(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ie(n,(o,s)=>{if(PB(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Vi(t,i)}function xB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}CN(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function Mu(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Jl(t){return t==null}const mM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Co(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Co(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),W_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function DR(t,e,r){return(e=HB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HB(t){var e=AB(t,"string");return typeof e=="symbol"?e:e+""}function AB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DB(){return class{}}class NB{constructor(e){DR(this,"metaCtor",DB()),DR(this,"meta",void 0),this.meta=this.metaCtor.prototype,Vi(this.meta,mM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Vi(this.meta,e),kc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function kB(t,e,r){return(e=LB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LB(t){var e=FB(t,"string");return typeof e=="symbol"?e:e+""}function FB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VB{constructor(e){kB(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Vi(this.meta,e),kc(this.meta,e,e)}}function Ql(t,e,r){return(e=WB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WB(t){var e=BB(t,"string");return typeof e=="symbol"?e:e+""}function BB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ju{constructor(e){Ql(this,"valueFactory",void 0),Ql(this,"data",[]),Ql(this,"index",[]),Ql(this,"holes",new Set),this.valueFactory=e}obtain(e){Mu(()=>Cs(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Mu(()=>Cs(e)||Jl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Jl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Mu(()=>Cs(e)||Jl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Jl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function NR(t,e,r){return(e=$B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $B(t){var e=jB(t,"string");return typeof e=="symbol"?e:e+""}function jB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zB=["data","width"];class UB{constructor(e){NR(this,"globalMeta",void 0),NR(this,"metas",new Ju(()=>this._createMeta())),this.globalMeta=e,this.metas=new Ju(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Vi(n,r),kc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return xB(this.globalMeta.getMetaConstructor(),zB).prototype}}function kR(t,e,r){return(e=YB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YB(t){var e=qB(t,"string");return typeof e=="symbol"?e:e+""}function qB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GB{constructor(e){kR(this,"columnMeta",void 0),kR(this,"metas",new Ju(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Vi(i,n),kc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)de(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){Mu(()=>Cs(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ju(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class pM{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new NB(e),this.tableMeta=new VB(this.globalMeta),this.columnMeta=new UB(this.globalMeta),this.cellMeta=new GB(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Qe(pM,Nn);function LR(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Tc(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Ee(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new fs(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let v,b=0,T=0;for(b=0,T=d.startRows;b<T;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Rr(w),t.push(v);else if(i.dataType==="array")v=Rr(w[0]),t.push(v);else{v=[];for(let C=0,E=d.startCols;C<E;C++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.view.adjustElementsSize(),i.render()),i.getSettings().ariaTags&&Te(i.rootElement,[k_(-1),_c(i.countCols()+(i.view?i.countRowHeaders():0))])}function FR(t,e,r){return(e=KB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KB(t){var e=XB(t,"string");return typeof e=="symbol"?e:e+""}function XB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZB{constructor(e){var r=this;FR(this,"metaManager",void 0),FR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Br(e,"type")?e.type:null;let c=Ee(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function JB(t,e,r){QB(t,e),e.set(t,r)}function QB(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cg(t,e,r){return(e=e$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e$(t){var e=t$(t,"string");return typeof e=="symbol"?e:e+""}function t$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r$(t,e){return t.get(n$(t,e))}function n$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var VR=new WeakMap;class i${constructor(e){Cg(this,"metaManager",void 0),Cg(this,"usageTracker",new Set),Cg(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),JB(this,VR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,r$(VR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const wM="gridDefault",vM="editorManager.handlingEditor",o$={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},s$="hooksRefRegisterer",yM={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){j(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ie(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ci(yM,"MIXIN_NAME",s$,{writable:!1,enumerable:!1});function Qr(t,e,r){return(e=a$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a$(t){var e=l$(t,"string");return typeof e=="symbol"?e:e+""}function l$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u$="base",ct=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class bw{static get EDITOR_TYPE(){return u$}constructor(e){Qr(this,"hot",void 0),Qr(this,"state",ct.VIRGIN),Qr(this,"_opened",!1),Qr(this,"_fullEditMode",!1),Qr(this,"_closeCallback",null),Qr(this,"TD",null),Qr(this,"row",null),Qr(this,"col",null),Qr(this,"prop",null),Qr(this,"originalValue",null),Qr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:ct.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();n=u.row,i=u.col,o=c.row,s=c.col}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==ct.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=ct.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:wp(l);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===ct.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===ct.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=ct.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=ct.FINISHED,this.discardEditor(s)}):(this.state=ct.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=ct.FINISHED,this.discardEditor()}discardEditor(e){this.state===ct.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=ct.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ct.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===ct.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Fr(r),a=or(r),l=Fr(this.hot.rootElement),u=or(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=v.name,T=["master","inline_start"].includes(b)?d:0,C=["master","top","bottom"].includes(b)?g:0,E=s.top===l.top?0:1;let y=s.top-l.top-E-T,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-w-1+C:M=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(b)&&(y+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const H=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),A=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),B=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(H&&P<=0||P===B)&&(y+=1),A<=0&&(M+=1);const K=i.rowsRenderCalculator.startPosition,L=i.columnsRenderCalculator.startPosition,oe=Math.abs(n.inlineStartOverlay.getScrollPosition()),X=n.topOverlay.getScrollPosition(),te=Ut(this.hot.rootDocument);let tt=r.offsetTop;if(["inline_start","master"].includes(b)&&(tt+=K-X),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:_,wtTable:O}=n.bottomOverlay.clone;tt+=_.getWorkspaceHeight()-O.getHeight()-te}let Pe=r.offsetLeft;this.hot.isRtl()?(Pe>=0?Pe=v.getWidth()-r.offsetLeft:Pe=Math.abs(Pe),Pe+=L-oe-a):["top","master","bottom"].includes(b)&&(Pe+=L-oe);const Se=o.getComputedStyle(this.TD),Be=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",$e=parseInt(Se[Be],10)>0?0:1,xe=parseInt(Se.borderTopWidth,10)>0?0:1,Or=or(r)+$e,He=lr(r)+xe,f=WN(c)?te:0,m=BN(h)?te:0,p=this.hot.view.maximumVisibleElementWidth(Pe)-f+$e,R=Math.max(this.hot.view.maximumVisibleElementHeight(tt)-m+xe,this.hot.stylesHandler.getDefaultRowHeight());return{top:y,start:M,height:He,maxHeight:R,width:Or,maxWidth:p}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Qe(bw,yM);const c$={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===ct.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},h$={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},d$={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},f$={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeActive();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},g$={name:"editorOpen",callback(t,e,r){const{selection:n}=t,i=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>n.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;r.includes("shift")?n.transformFocus(-u.row,-u.col):n.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Mc(e))}};function m$(){return[o$,c$,h$,d$,f$,g$]}const p$={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},w$={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},v$={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},y$={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},b$={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},C$={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},S$={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},R$={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},E$={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},T$={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},_$={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeActive(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},O$={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},M$={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},I$={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeActive(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function P$(){return[p$,w$,v$,y$,b$,C$,S$,R$,E$,T$,_$,O$,M$,I$]}const x$={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},H$={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},A$={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},D$={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),(i.some(a=>r.isMultiple(a))||i.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},N$={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},k$={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},L$={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},F$={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},V$={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},W$={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeActive().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},B$={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeActive().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},$$={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeActive().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},j$={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeActive().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},z$={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},U$={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Y$={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function q$(){return[x$,H$,A$,D$,N$,k$,L$,F$,V$,W$,B$,$$,j$,z$,U$,Y$]}const G$={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},K$={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},X$={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Z$={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},J$={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Q$=[...m$(),...P$(),...q$(),G$,K$,X$,Z$,J$];function bM(t){const e={};return Q$.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function ej(t){const e=t.getShortcutManager().addContext("editor"),r=bM(t),n={group:vM};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function tj(t){const e=t.getShortcutManager().addContext("grid"),r=bM(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return de(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:wM};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:vM,runOnlyIf:()=>de(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeActive())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function rj(t){[tj,ej].forEach(e=>e(t))}function nj(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=WR(t),i=WR(t);return n.addEventListener("focus",()=>r?.onFocus("from_above")),i.addEventListener("focus",()=>r?.onFocus("from_below")),e.prepend(n),e.append(i),{focus(o){o==="from_above"?n.focus():i.focus()},activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function WR(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Te(r,[ju("Focus catcher")]),r}function ij(t){return e=>{if(!e)return null;const{rowIndexMapper:r,columnIndexMapper:n}=t;if(r.isHidden(e.row)||n.isHidden(e.col))return null;const i=nm(t),o=im(t);return e.row=De(e.row,i.row,o.row),e.col=De(e.col,i.col,o.col),e}}function oj(t){const e=ij(t);let r;const{activate:n,deactivate:i}=nj(t,t.rootGridElement,{onFocus(h){if(h==="from_above"){var d;const w=(d=e(r))!==null&&d!==void 0?d:nm(t),v=t.runHooks("modifyFocusOnTabNavigation","from_above",w);w&&v!==!1&&t.selectCell(w.row,w.col)}else{var g;const w=(g=e(r))!==null&&g!==void 0?g:im(t),v=t.runHooks("modifyFocusOnTabNavigation","from_below",w);w&&v!==!1&&t.selectCell(w.row,w.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&i()}),t.addHook("afterUnlisten",()=>{const h=t.getShortcutManager().getActiveContextName(),d=t.getShortcutManager().getContext(h);d?.scope==="table"&&n()}),t.addHook("afterSelection",(h,d,g,w,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var b;r=(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:wM,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeActive()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?nm(t):im(t)),u(),!1;h.preventDefault()},position:"after"}])}function $s(t){bo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Lc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeActive(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,v=g<=h,b=w>=d;return{getComputedColumnTarget(T){return i==="mouse"||i==="keyboard"?T.col:u&&c?n.highlight.col:u?a:c?l:T.col},getComputedRowTarget(T){return i==="mouse"||i==="keyboard"?T.row:v&&b?n.highlight.row:v?g:b?w:T.row}}}function sj(t){return e=>{const r=Lc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;$s(t.getCell(n?-1:0,r,!0))})}}function aj(){return()=>{}}function lj(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const r=t.getSelectedRangeActive();if(!r)return;const{row:n,col:i}=r.highlight;$s(t.getCell(n,i,!0))})}}function uj(t){return e=>{const r=Lc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;$s(t.getCell(i,o,!0))})}}function cj(t){return e=>{const r=Lc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;$s(t.getCell(i,o,!0))})}}function hj(t){return e=>{const r=Lc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;$s(t.getCell(r,n?-1:0,!0))})}}function dj(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{$s(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function fj(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=lj(t):e.isSelectedByCorner()?s=aj():e.isSelectedByRowHeader()?s=hj(t):e.isSelectedByColumnHeader()?s=sj(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=uj(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=dj(t):e.getSelectedRange().size()>1&&(s=cj(t)),(o=s)===null||o===void 0||o(i)}}}const BR=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),eu=t=>t.map(e=>{const r=e.toLowerCase();return BR.has(r)?BR.get(r):r}).sort().join("+"),gj=t=>t.split("+"),$R=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Sg=t=>{let{which:e,key:r}=t;if($R.has(e))return $R.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},CM=Symbol("shortcut-context");function pm(t){return ot(t)&&t.__kindOf===CM}const mj=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const r=Ic({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:g=!1,preventDefault:w=!0,stopPropagation:v=!1,relativeToGroup:b,position:T,forwardToContext:C}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if($t(h))throw new Error("You need to define the shortcut's group.");if(Ee(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(ar`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const E={callback:c,group:h,runOnlyIf:d,captureCtrl:g,preventDefault:w,stopPropagation:v};de(b)&&(E.relativeToGroup=b,E.position=T),pm(C)&&(E.forwardToContext=C),u.forEach(y=>{const M=eu(y);if(r.hasItem(M)){const P=r.getItem(M);let A=P.findIndex(F=>F.group===b);A!==-1?T==="before"?A-=1:A+=1:A=P.length,P.splice(A,0,E)}else r.addItem(M,[E])})},i=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{Ie(c,(d,g)=>{Object.prototype.hasOwnProperty.call(h,g)===!1&&(h[g]=c[g])}),n(h)})},o=u=>{const c=eu(u);r.removeItem(c)};return{__kindOf:CM,scope:e,addShortcut:n,addShortcuts:i,getShortcuts:u=>{const c=eu(u),h=r.getItem(c);return de(h)?h.slice():[]},hasShortcut:u=>{const c=eu(u);return r.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{r.getItems().forEach(h=>{let[d,g]=h;const w=g.filter(v=>v.group!==u);w.length===0?o(gj(d)):(g.length=0,g.push(...w))})}}};function pj(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const wj=["meta","alt","shift","control"],fa=pj(),ga=[];let tu=0;function vj(t,e,r,n,i){const o=g=>wj.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return g.altKey&&v.push("alt"),w&&(g.ctrlKey||g.metaKey)?v.push("control/meta"):(g.ctrlKey&&v.push("control"),g.metaKey&&v.push("meta")),g.shiftKey&&v.push("shift"),v},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||uo(g))return;const v=Sg(g);let b=[];o(v)||(b=s(g));const T=[v].concat(b);!i(g,T)&&(QC()&&b.includes("meta")||!QC()&&b.includes("control"))&&i(g,[v].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const w=Sg(g);o(w)&&fa.press(w)}},u=g=>{if(typeof g.key=="string"){const w=Sg(g);o(w)&&fa.release(w)}},c=()=>{fa.releaseAll()};return{mount:()=>{let g=t;for(tu+=1;g;)tu===1&&(g.document.documentElement.addEventListener("keydown",l),ga.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),ga.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Ka(g)},unmount:()=>{let g=t;for(tu-=1;g;){if(tu===0){for(let w=0;w<ga.length;w++){const{event:v,listener:b}=ga[w];g.document.documentElement.removeEventListener(v,b)}ga.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Ka(g)}},isPressed:g=>fa.isPressed(g),releasePressedKeys:()=>fa.releaseAll()}}const yj=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=Ic({errorIdExists:v=>`The "${v}" context name is already registered.`});let s="grid";const a=function(v){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const T=mj(v,b);return o.addItem(v,T),T},l=()=>s,u=v=>o.getItem(v),c=v=>{if(!o.hasItem(v))throw new Error(ar`You've tried to activate the "${v}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=v};let h=!1;const d=function(v,b){let T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const C=pm(T)?T:u(T);let E=!1;if(!C.hasShortcut(b))return E;const y=C.getShortcuts(b);for(let M=0;M<y.length;M++){const{callback:H,runOnlyIf:P,preventDefault:A,stopPropagation:F,captureCtrl:B,forwardToContext:K}=y[M];if(P(v)===!0){if(h=B,E=H(v,b)===!1,h=!1,A&&v.preventDefault(),F&&(Mc(v),v.stopPropagation()),E)break;K&&d(v,b,K)}}return E},w=vj(e,v=>{const b=l(),T=pm(b)?b:u(b);return r(v,T.scope)},n,i,d);return w.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(w.isPressed("control")||w.isPressed("meta")),releasePressedKeys:()=>w.releasePressedKeys(),destroy:()=>w.unmount()}};function jR(t){const{classNames:e}=HN(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function bj(t,e){SM(t,e),e.add(t)}function bi(t,e,r){SM(t,e),e.set(t,r)}function SM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){return t.get(on(t,e))}function vr(t,e,r){return t.set(on(t,e),r),r}function on(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const zR=23;var Cn=new WeakMap,Qu=new WeakMap,Cw=new WeakMap,wm=new WeakMap,Ti=new WeakMap,Ia=new WeakMap,Za=new WeakMap,ma=new WeakMap,Rn=new WeakSet;class Cj{constructor(e){let{rootElement:r,rootDocument:n,onThemeChange:i=()=>{}}=e;bj(this,Rn),bi(this,Cn,void 0),bi(this,Qu,void 0),bi(this,Cw,void 0),bi(this,wm,void 0),bi(this,Ti,!0),bi(this,Ia,{}),bi(this,Za,{}),bi(this,ma,void 0),vr(Qu,this,r),vr(wm,this,n),vr(ma,this,i)}isClassicTheme(){return Je(Ti,this)}getCSSVariableValue(e){var r;if(Je(Ti,this))return null;if(Je(Ia,this)[`--ht-${e}`])return Je(Ia,this)[`--ht-${e}`];const n=(r=on(Rn,this,Ej).call(this,`--ht-${e}`))!==null&&r!==void 0?r:on(Rn,this,RM).call(this,`--ht-${e}`);if(n!==null)return Je(Ia,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=Je(Za,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(Je(Ti,this))return zR;const e=on(Rn,this,Sj).call(this);return e||zR}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){vr(Cn,this,void 0),vr(Ti,this,!0),Je(ma,this).call(this,Je(Cn,this)),on(Rn,this,Rg).call(this);return}if(e&&e!==Je(Cn,this)){if(!/ht-theme-.*/.test(e)){$r(`Invalid theme name: ${e}. Please provide a valid theme name.`),vr(Cn,this,void 0),vr(Ti,this,!1),Je(ma,this).call(this,Je(Cn,this)),on(Rn,this,Rg).call(this);return}Je(Cn,this)&&on(Rn,this,Tj).call(this),vr(Cn,this,e),vr(Ti,this,!1),Je(ma,this).call(this,Je(Cn,this)),on(Rn,this,Rg).call(this)}}getThemeName(){return Je(Cn,this)}}function Sj(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function Rg(){this.isClassicTheme()||vr(Cw,this,getComputedStyle(Je(Qu,this)));const t=on(Rn,this,Rj).call(this,["box-sizing","border-bottom-width"]);Je(Za,this).td={...Je(Za,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Rj(t){const e=Je(wm,this),r=Je(Qu,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function Ej(t){const e=Math.ceil(parseFloat(on(Rn,this,RM).call(this,t)));return Number.isNaN(e)?null:e}function RM(t){const e=Je(Cw,this).getPropertyValue(t);return e===""?null:e}function Tj(){vr(Za,this,{}),vr(Ia,this,{}),vr(Ti,this,!0)}function _j(t,e){EM(t,e),e.add(t)}function UR(t,e,r){EM(t,e),e.set(t,r)}function EM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YR(t,e){return t.get(Ms(t,e))}function qR(t,e,r){return t.set(Ms(t,e),r),r}function Ms(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var vm=new WeakMap,ym=new WeakMap,Wa=new WeakSet;class Oj{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;_j(this,Wa),UR(this,vm,void 0),UR(this,ym,void 0),qR(vm,this,r),qR(ym,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Ms(Wa,this,GR).call(this,e.from,r,n);if(i===null)return null;const o=Ms(Wa,this,GR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function GR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Ms(Wa,this,KR).call(this,YR(vm,this),t.row,e);if(n===null)return null;const i=Ms(Wa,this,KR).call(this,YR(ym,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function KR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let Jn=null,Iu=0;function Mj(t){const e=t.ownerDocument;if(!Jn){Jn=e.createElement("div"),Jn.setAttribute("role","status"),Jn.setAttribute("aria-live","assertive"),Jn.setAttribute("aria-atomic","true");const r=Jn.style;r.position="absolute",r.width="1px",r.height="1px",r.margin="-1px",r.overflow="hidden",r.clipPath="rect(0 0 0 0)",r.whiteSpace="nowrap",t.appendChild(Jn)}Iu+=1}function Ij(){Iu!==0&&(Iu===1&&(Jn.remove(),Jn=null),Iu-=1)}let Eg=null;const ru=new WeakSet,Tg=new Map;function TM(t,e){var r,n,i=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Wi(s);let l,u,c,h,d,g,w=!0;const v={...e.initialState,...e};qV(o)&&YV(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=lo(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,lo(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Z(this.rootElement,["ht-wrapper","handsontable"]),Z(this.rootWrapperElement,"ht-root-wrapper"),Z(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),Z(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(r=v?.layoutDirection)!==null&&r!==void 0?r:"inherit",T=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(n=this.rootWrapperElement)===null||n===void 0||n.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new Cj({rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:f=>{lo(this)&&(Me(this.rootWrapperElement,/ht-theme-.*/g),Me(this.rootPortalElement,/ht-theme-.*/g),f&&(Z(this.rootWrapperElement,f),Z(this.rootPortalElement,f),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||$r(`The "${f}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=zW(v.language);const C=Object.fromEntries(Object.entries(v).filter(f=>{let[m]=f;return!(fe.getSingleton().isRegistered(m)||fe.getSingleton().isDeprecated(m))})),E=new pM(s,C,[ZB,i$]),y=E.getTableMeta(),M=E.getGlobalMeta(),H=Ic();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${x_()}`,Tg.set(this.guid,this),this.columnIndexMapper=new fm,this.rowIndexMapper=new fm,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{s.runHooks("beforeCompositionStart",f)}),u=new sW(s);const P=Lo(this.guid);P.register("cellRangeMapper",new Oj({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},F=f=>{const{row:m,col:p}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)},B=(f,m)=>{const p=m>f?1:-1,R=Math.min(f,m),_=Math.max(f,m),O=s.rowIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<R?null:O>=0?s.rowIndexMapper.getRenderableFromVisualIndex(O):O},K=(f,m)=>{const p=m>f?1:-1,R=Math.min(f,m),_=Math.max(f,m),O=s.columnIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>_||p===-1&&O<R?null:O>=0?s.columnIndexMapper.getRenderableFromVisualIndex(O):O};let L=new fM(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,p)=>s._createCellRange(f,m,p),visualToRenderableCoords:A,renderableToVisualCoords:F,findFirstNonHiddenRenderableRow:B,findFirstNonHiddenRenderableColumn:K,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=L;const oe=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",oe),this.rowIndexMapper.addLocalHook("cacheUpdated",oe),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const p=yr(!1),R=this.selection.getSelectedRange(),{from:_,to:O}=R.current(),x=R.size()-1;this.runHooks("afterSelection",_.row,_.col,O.row,O.col,p,x),this.runHooks("afterSelectionByProp",_.row,s.colToProp(_.col),O.row,s.colToProp(O.col),p,x),m&&(!p.isTouched()||p.isTouched()&&!p.value)&&g.scrollTo(f);const k=L.isSelectedByRowHeader(),U=L.isSelectedByColumnHeader();k&&U?Z(this.rootElement,["ht__selection--rows","ht__selection--columns"]):k?(Me(this.rootElement,"ht__selection--columns"),Z(this.rootElement,"ht__selection--rows")):U?(Me(this.rootElement,"ht__selection--rows"),Z(this.rootElement,"ht__selection--columns")):Me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(L.getSelectionSource())||h.closeEditor(null),L.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=yr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&g.scrollTo(f),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:p,to:R}=f[m];this.runHooks("afterSelectionEnd",p.row,p.col,R.row,R.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),R.row,s.colToProp(R.col),m),L.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),Me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectRows",...m)}).addLocalHook("beforeSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeSelectAll",...m)}).addLocalHook("afterSelectAll",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterSelectAll",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return i.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,R=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0;const O=x=>{if(x.length===0)return[];const k=[...x];return k.sort(($,I)=>{let[V]=$,[Y]=I;return V===Y?0:V>Y?1:-1}),No(k,($,I)=>{let[V,Y]=I;const re=$[$.length-1],[ke,Ae]=re,ue=ke+Ae;if(V<=ue){const pe=Math.max(Y-(ue-V),0);re[1]+=pe}else $.push([V,Y]);return $},[k[0]])};switch(f){case"insert_row_below":case"insert_row_above":const x=s.countSourceRows();if(y.maxRows===x)return;const k=f==="insert_row_below"?"below":"above";m=m??(k==="below"?x:0);const{delta:U,startPhysicalIndex:$}=l.createRow(m,p,{source:R,mode:k});L.shiftRows(s.toVisualRow($),U);break;case"insert_col_start":case"insert_col_end":const I=f==="insert_col_end"?"end":"start";m=m??(I==="end"?s.countSourceCols():0);const{delta:V,startPhysicalIndex:Y}=l.createCol(m,p,{source:R,mode:I});if(V){if(Array.isArray(y.colHeaders)){const Ae=[s.toVisualColumn(Y),0];Ae.length+=V,Array.prototype.splice.apply(y.colHeaders,Ae)}L.shiftColumns(s.toVisualColumn(Y),V)}break;case"remove_row":const re=Ae=>{let ue=0;j(Ae,pe=>{let[ce,_e]=pe;const qe=Co(ce)?s.countRows()-1:Math.max(ce-ue,0);if(Number.isInteger(ce)&&(ce=Math.max(ce-ue,0)),!l.removeRow(ce,_e,R))return;if(L.isSelected()){const{row:bt}=s.getSelectedRangeActive().highlight;bt>=ce&&bt<=ce+_e-1&&h.closeEditor(!0)}const cr=s.countRows(),Ln=y.fixedRowsTop;Ln>=qe+1&&(y.fixedRowsTop-=Math.min(_e,Ln-qe));const Dt=y.fixedRowsBottom;if(Dt&&qe>=cr-Dt&&(y.fixedRowsBottom-=Math.min(_e,Dt)),cr===0)L.deselect();else if(R==="ContextMenu.removeRow"){const bt=L.getSelectedRange(),hr=bt.pop();bt.clear().set(hr.from).current().setTo(hr.to),L.refresh()}else L.shiftRows(ce,-_e);ue+=_e})};Array.isArray(m)?re(O(m)):re([[m,p]]);break;case"remove_col":const ke=Ae=>{let ue=0;j(Ae,pe=>{let[ce,_e]=pe;const qe=Co(ce)?s.countCols()-1:Math.max(ce-ue,0);let At=s.toPhysicalColumn(qe);if(Number.isInteger(ce)&&(ce=Math.max(ce-ue,0)),!l.removeCol(ce,_e,R))return;if(L.isSelected()){const{col:bt}=s.getSelectedRangeActive().highlight;bt>=ce&&bt<=ce+_e-1&&h.closeEditor(!0)}if(s.countCols()===0)L.deselect();else if(R==="ContextMenu.removeColumn"){const bt=L.getSelectedRange(),hr=bt.pop();bt.clear().set(hr.from).current().setTo(hr.to),L.refresh()}else L.shiftColumns(ce,-_e);const Dt=y.fixedColumnsStart;Dt>=qe+1&&(y.fixedColumnsStart-=Math.min(_e,Dt-qe)),Array.isArray(y.colHeaders)&&(typeof At>"u"&&(At=-1),y.colHeaders.splice(At,_e)),ue+=_e})};Array.isArray(m)?ke(O(m)):ke([[m,p]]);break;default:throw new Error(`There is no such action "${f}"`)}_||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,p=y.minCols,R=y.minSpareCols;if(f){const _=s.countRows();_<f&&l.createRow(_,f-_,{source:"auto"})}if(m){const _=s.countEmptyRows(!0);if(_<m){const O=m-_,x=Math.min(O,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),x,{source:"auto"})}}{let _;(p||R)&&(_=s.countEmptyCols(!0));let O=s.countCols();if(p&&!y.columns&&O<p){const x=p-O;_+=x,l.createCol(O,x,{source:"auto"})}if(R&&!y.columns&&s.dataType==="array"&&_<R){O=s.countCols();const x=R-_,k=Math.min(x,y.maxCols-O);l.createCol(O,k,{source:"auto"})}}},populateFromArray(f,m,p,R,_){let O,x,k,U;const $=[],I={},V=[],Y=f.row,re=f.col;if(x=m.length,x===0)return!1;let ke=0,Ae=0;switch(ot(p)&&(ke=p.col-re+1,Ae=p.row-Y+1),_){case"shift_down":const pe=kf(m),ce=pe.length,_e=Math.max(ce,ke),qe=s.getData().slice(Y),At=kf(qe).slice(re,re+_e);for(k=0;k<_e;k+=1)if(k<ce){for(O=0,x=pe[k].length;O<Ae-x;O+=1)pe[k].push(pe[k][O%x]);k<At.length?V.push(pe[k].concat(At[k])):V.push(pe[k].concat(new Array(qe.length).fill(null)))}else V.push(pe[k%ce].concat(At[k]));s.populateFromArray(Y,re,kf(V));break;case"shift_right":const cr=m.length,Ln=Math.max(cr,Ae),Dt=s.getData().slice(Y).map(dr=>dr.slice(re));for(O=0;O<Ln;O+=1)if(O<cr){for(k=0,U=m[O].length;k<ke-U;k+=1)m[O].push(m[O][k%U]);if(O<Dt.length)for(let dr=0;dr<Dt[O].length;dr+=1)m[O].push(Dt[O][dr]);else m[O].push(...new Array(Dt[0].length).fill(null))}else m.push(m[O%x].slice(0,Ln).concat(Dt[O]));s.populateFromArray(Y,re,m);break;case"overwrite":default:I.row=f.row,I.col=f.col;let bt=0,hr=0,di=!0,Kr;const Yi=function(fi){let gi=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const mn=m[fi%m.length];return gi!==null?mn[gi%mn.length]:mn},Mr=m.length,gn=p?p.row-f.row+1:0;for(p?x=gn:x=Math.max(Mr,gn),O=0;O<x&&!(p&&I.row>p.row&&gn>Mr||!y.allowInsertRow&&I.row>s.countRows()-1||I.row>=y.maxRows);O++){const dr=O-bt,fi=Yi(dr).length,gi=p?p.col-f.col+1:0;if(p?U=gi:U=Math.max(fi,gi),I.col=f.col,Kr=s.getCellMeta(I.row,I.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Kr.skipRowOnPaste){bt+=1,I.row+=1,x+=1;continue}for(hr=0,k=0;k<U;k++){var ue;if(p&&I.col>p.col&&gi>fi||!y.allowInsertColumn&&I.col>s.countCols()-1||I.col>=y.maxCols)break;if(Kr=s.getCellMeta(I.row,I.col),(R==="CopyPaste.paste"||R==="Autofill.fill")&&Kr.skipColumnOnPaste){hr+=1,I.col+=1,U+=1;continue}if(Kr.readOnly&&R!=="UndoRedo.undo"){I.col+=1;continue}const mn=k-hr,mi=!!Kr.valueSetter;let Ir=Yi(dr,mn),Ct=(ue=s.getSourceDataAtCell(I.row,I.col))!==null&&ue!==void 0?ue:null;if(Ir!==null&&typeof Ir=="object"){if(Array.isArray(Ir)&&Ct===null&&(Ct=[]),!mi&&(typeof Ct!="object"||Ct===null))di=!1;else if(Ct!==null){const yl=Ga(Array.isArray(Ct)?Ct:Ct[0]||Ct),bl=Ga(Array.isArray(Ir)?Ir:Ir[0]||Ir);mi||W_(yl,bl)||Array.isArray(yl)&&Array.isArray(bl)?Ir=Rr(Ir):di=!1}}else!mi&&Ct!==null&&typeof Ct=="object"&&(di=!1);di&&$.push([I.row,I.col,Ir]),di=!0,I.col+=1}I.row+=1}s.setDataAtCell($,null,null,R||"populateFromArray");break}}};function X(f){const m=j0(f);mw(m)?(s.runHooks("beforeLanguageChange",m),M.language=m,s.runHooks("afterLanguageChange",m)):z0(f)}function te(f,m){const p=f==="className"?s.rootElement:s.table;if(w)Z(p,m);else{let R=[],_=[];M[f]&&(R=Array.isArray(M[f])?M[f]:BC(M[f])),m&&(_=Array.isArray(m)?m:BC(m));const O=WC(R,_),x=WC(_,R);O.length&&Me(p,O),x.length&&Z(p,x)}M[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(Hi()||$_())&&Z(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new ZV(this),h=um.getInstance(s,y,L),g=fj(s),d=new Ek(s),lo(this)&&(oj(s),Mj(s.rootPortalElement),tN(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),w&&s.rootElement.offsetParent===null&&$N(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof w=="object"&&(s.runHooks("afterChange",w[0],w[1]),w=!1),s.runHooks("afterInit")};function tt(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function Pe(f,m,p){if(!f.length){p();return}const R=s.getActiveEditor(),_=new tt;let O=!0;_.onQueueEmpty=()=>{R&&O&&R.cancelChanges(),p()};for(let x=f.length-1;x>=0;x--){const[k,U,,$]=f[x],I=l.propToCol(U);let V;Number.isInteger(I)?V=s.getCellMeta(k,I):V={...Object.getPrototypeOf(y),...y},s.getCellValidator(V)&&(_.addValidatorToQueue(),s.validateCell($,V,function(Y,re){return function(ke){if(typeof ke!="boolean")throw new Error("Validation error: result is not boolean");ke===!1&&re.allowInvalid===!1&&(O=!1,f.splice(Y,1),re.valid=!0),_.removeValidatorFormQueue()}}(x,V),m))}_.checkIfQueueIsEmpty()}function Se(f,m){for(let R=f.length-1;R>=0;R--){let _=!1;if(f[R]===null){f.splice(R,1);continue}if(!((f[R][2]===null||f[R][2]===void 0)&&(f[R][3]===null||f[R][3]===void 0))){if(y.allowInsertRow)for(;f[R][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[R][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:"auto"});if(O===0){_=!0;break}}_||l.set(f[R][0],f[R][1],f[R][3])}}if(f.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",f,m||"edit");const R=s.getActiveEditor();R&&de(R.refreshValue)&&R.refreshValue()}else s.render()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,p){return s.view._wt.createCellRange(f,m,p)},this.validateCell=function(f,m,p,R){let _=s.getCellValidator(m);function O(x){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(x);return}const U=m.visualCol,$=m.visualRow,I=s.getCell($,U,!0);if(I&&I.nodeName!=="TH"){const V=s.rowIndexMapper.getRenderableFromVisualIndex($),Y=s.columnIndexMapper.getRenderableFromVisualIndex(U);s.view._wt.getSetting("cellRenderer",V,Y,I)}p(x)}JD(_)&&(_=function(x){return function(k,U){U(x.test(k))}}(_)),Ee(_)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,R),s._registerImmediate(()=>{_.call(m,f,x=>{s&&(x=s.runHooks("afterValidate",x,f,m.visualRow,m.prop,R),m.valid=x,O(x),s.runHooks("postAfterValidate",x,f,m.visualRow,m.prop,R))})})):s._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function Be(f,m,p){return Array.isArray(f)?f:[[f,m,p]]}function $e(f,m){const p=s.runHooks("beforeChange",f,m||"edit"),R=f.filter(O=>O!==null);if(p===!1||R.length===0){var _;return(_=s.getActiveEditor())===null||_===void 0||_.cancelChanges(),[]}for(let O=R.length-1;O>=0;O--){const[x,k,,U]=R[O],$=l.propToCol(k);let I;Number.isInteger($)?I=s.getCellMeta(x,$):I={...Object.getPrototypeOf(y),...y},R[O][3]=bg(U,I)}return R}this.setDataAtCell=function(f,m,p,R){const _=Be(f,m,p),O=[];let x=R,k,U,$;for(k=0,U=_.length;k<U;k++){const[V,Y,re]=_[k];if(typeof _[k]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Y!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Y>=this.countCols()?$=Y:$=l.colToProp(Y),O.push([V,$,u.getAtCell(this.toPhysicalRow(V),Y),re])}!x&&typeof f=="object"&&(x=m);const I=$e(O,x);s.runHooks("afterSetDataAtCell",I,x),Pe(I,x,()=>{Se(I,x)})},this.setDataAtRowProp=function(f,m,p,R){const _=Be(f,m,p),O=[];let x=R,k,U;for(k=0,U=_.length;k<U;k++){const[I,V,Y]=_[k];O.push([I,V,u.getAtCell(this.toPhysicalRow(I),V),Y])}!x&&typeof f=="object"&&(x=m);const $=$e(O,R);s.runHooks("afterSetDataAtRowProp",$,x),Pe($,x,()=>{Se($,x)})},this.listen=function(){s&&!s.isListening()&&(Tg.forEach(f=>{s!==f&&f.unlisten()}),Eg=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Eg=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Eg===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(f),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this.populateFromArray=function(f,m,p,R,_,O,x){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const k=typeof R=="number"?s._createCellCoords(R,_):null;return c.populateFromArray(s._createCellCoords(f,m),p,k,O,x)},this.spliceCol=function(f,m,p){for(var R=arguments.length,_=new Array(R>3?R-3:0),O=3;O<R;O++)_[O-3]=arguments[O];return l.spliceCol(f,m,p,..._)},this.spliceRow=function(f,m,p){for(var R=arguments.length,_=new Array(R>3?R-3:0),O=3;O<R;O++)_[O-3]=arguments[O];return l.spliceRow(f,m,p,..._)},this.getSelected=function(){if(L.isSelected())return xn(L.getSelectedRange(),f=>{let{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedActive=function(){const f=this.getSelectedRangeActive();if(!f)return;const{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRangeActive=function(){return L.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return L.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(f){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];j(L.getSelectedRange(),p=>{if(p.isSingleHeader())return;const R=p.getTopStartCorner(),_=p.getBottomEndCorner();Xe(R.row,_.row,O=>{Xe(R.col,_.col,x=>{this.getCellMeta(O,x).readOnly||m.push([O,x,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=f();return this.resumeExecution(m),p},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const f=s.view,{width:m,height:p}=f.getLastSize(),{width:R,height:_}=s.rootElement.getBoundingClientRect(),O=R!==m||_!==p;s.runHooks("beforeRefreshDimensions",{width:m,height:p},{width:R,height:_},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===s.rootWindow)&&(f.setLastSize(R,_),f.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:m,height:p},{width:R,height:_},O))},this.updateData=function(f,m){LR(f,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),L.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:E,firstRun:w})},this.loadData=function(f,m){LR(f,p=>{l=p},()=>{E.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),L.refresh(),w&&(w=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:E,firstRun:w})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Ee(f))if(s.dataType==="array"){const p=this.countSourceCols();for(let R=0;R<p;R+=1)f(R)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(de(y.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:yp(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,p,R){return $t(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(p,R),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,p,R){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(p,R))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getCopyableSourceData=function(f,m){return u.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(w?s.loadData:s.updateData).bind(this);let R=!1,_,O;if(de(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(de(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(de(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(_ in f)if(!(_==="data"||_==="language"))if(_==="className")te("className",f.className);else if(_==="tableClassName"&&s.table)te("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(fe.getSingleton().isRegistered(_)||fe.getSingleton().isDeprecated(_)){const I=f[_];Ee(I)?(fe.getSingleton().addAsFixed(_,I,s),y[_]=I):Array.isArray(I)&&(fe.getSingleton().add(_,I,s),y[_]=I)}else!m&&Br(f,_)&&(M[_]=f[_]);if(m)s.useTheme(y.themeName||jR(s.rootContainer));else{const I=s.getCurrentThemeName();Br(f,"themeName")&&I!==f.themeName&&s.useTheme(f.themeName)}ru.has(s)&&s.stylesHandler.getThemeName()!==void 0&&ru.delete(s),lo(s)&&!ru.has(s)&&s.stylesHandler.isClassicTheme()&&(KN("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),ru.add(s)),f.data===void 0&&y.data===void 0?p(null,"updateSettings"):f.data!==void 0?p(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!w&&f.language&&X(f.language);const x=s.countCols(),k=y.columns;if(k&&Ee(k)&&(R=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&E.clearCache(),x>0)for(_=0,O=0;_<x;_++){if(k){const I=R?k(_):k[O];I&&E.updateColumnMeta(O,I)}O+=1}de(f.cell)&&Ie(f.cell,I=>{s.setCellMetaObject(I.row,I.col,I)}),s.runHooks("afterCellMetaReset");let U=s.rootElement.style.height;U!==""&&(U=parseInt(s.rootElement.style.height,10)),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let $=f.height;if(typeof f.height<"u")if(Ee($)&&($=$()),$=s.runHooks("beforeHeightChange",$),$===null){const I=s.rootElement.getAttribute("data-initialstyle");I&&(I.indexOf("height")>-1||I.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",I):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else $!==void 0&&(s.rootElement.style.height=isNaN($)?`${$}`:`${$}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let I=f.width;Ee(I)&&(I=I()),I=s.runHooks("beforeWidthChange",I),s.rootElement.style.width=isNaN(I)?`${I}`:`${I}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!w&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!m&&s.view&&(U===""||$===""||$===void 0)&&U!==$&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedRangeActive();if(y.getValue){if(Ee(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f.highlight.row][y.getValue]}else if(f)return s.getDataAtCell(f.highlight.row,f.highlight.col);return null},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,p,R,_){c.alter(f,m,p,R,_)},this.getCell=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,R=m,_=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;R=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return _===null||R===null||_===void 0||R===void 0?null:s.view.getCellAtCoords(s._createCellCoords(_,R),p)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:p,col:R}=m;let _=p,O=R;return p>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(p)),R>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(R)),s._createCellCoords(_,O)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],p=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let R=0;R<p.length;R+=1)for(let _=0;_<p[R].length;_+=1)m.push(p[R][_]);return m},this.getDataAtProp=function(f){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let R=0;R<p.length;R+=1)for(let _=0;_<p[R].length;_+=1)m.push(p[R][_]);return m},this.getSourceData=function(f,m,p,R){let _;return f===void 0?_=u.getData():_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,R)),_},this.getSourceDataArray=function(f,m,p,R){let _;return f===void 0?_=u.getData(!0):_=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(p,R),!0),_},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,p,R){const _=Be(f,m,p),O=this.hasHook("afterSetSourceDataAtCell"),x=[],k=($,I)=>{const V=this.toVisualRow($),Y=this.toVisualColumn(I);return Number.isInteger(Y)?this.getCellMeta(V,Y):{...Object.getPrototypeOf(y),...y}};O&&j(_,$=>{let[I,V,Y]=$;const re=bg(Y,k(I,V));x.push([I,V,u.getAtCell(I,V),re])}),j(_,$=>{let[I,V,Y]=$;const re=bg(Y,k(I,V));u.setAtCell(I,V,re)}),O&&this.runHooks("afterSetSourceDataAtCell",x,R),this.render();const U=s.getActiveEditor();U&&de(U.refreshValue)&&U.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,p,R){const _=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,p,R],[O,x]=_;let[,,k,U]=_,$=null,I=null;k===void 0&&(k=O),U===void 0&&(U=x);let V="mixed";return Xe(Math.max(Math.min(O,k),0),Math.max(O,k),Y=>{let re=!0;return Xe(Math.max(Math.min(x,U),0),Math.max(x,U),ke=>(I=this.getCellMeta(Y,ke).type,$?re=$===I:$=I,re)),V=re?I:"mixed",re}),V},this.removeCellMeta=function(f,m,p){const[R,_]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=E.getCellMetaKeyValue(R,_,p);s.runHooks("beforeRemoveCellMeta",f,m,p,O)!==!1&&(E.removeCellMeta(R,_,p),s.runHooks("afterRemoveCellMeta",f,m,p,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,R=new Array(p>2?p-2:0),_=2;_<p;_++)R[_-2]=arguments[_];if(R.length>0&&!Array.isArray(R[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(f),m),R.length>0&&j(R.reverse(),O=>{E.createRow(this.toPhysicalRow(f)),j(O,(x,k)=>this.setCellMetaObject(f,k,x))}),s.render()},this.setCellMetaObject=function(f,m,p){typeof p=="object"&&Ie(p,(R,_)=>{this.setCellMeta(f,m,_,R)})},this.setCellMeta=function(f,m,p,R){if(s.runHooks("beforeSetCellMeta",f,m,p,R)===!1)return;let O=f,x=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(x=this.toPhysicalColumn(m)),E.setCellMeta(O,x,p,R),s.runHooks("afterSetCellMeta",f,m,p,R)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},R=this.toPhysicalRow(f),_=this.toPhysicalColumn(m);return R===null&&(R=f),_===null&&(_=m),E.getCellMeta(R,_,{visualRow:f,visualColumn:m,...p})},this.getColumnMeta=function(f){return E.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return E.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof p=="string"?PS(p):$t(p)?PS("text"):p},this.getCellEditor=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof p=="string"?gS(p):$t(p)?gS("text"):p},this.getCellValidator=function(f,m){const p=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof p=="string"?eL(p):p},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,p){const R=new tt;f&&(R.onQueueEmpty=f);let _=s.countRows()-1;for(;_>=0;){if(m!==void 0&&m.indexOf(_)===-1){_-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}R.addValidatorToQueue(),s.validateCell(s.getDataAtCell(_,O),s.getCellMeta(_,O),x=>{if(typeof x!="boolean")throw new Error("Validation error: result is not boolean");x===!1&&(R.valid=!1),R.removeValidatorFormQueue()},"validateCells"),O-=1}_-=1}R.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,p=f;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],Xe(s.countRows()-1,R=>{m.push(s.getRowHeader(R))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:Ee(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",f);if(p===void 0){const k=[],U=s.countCols();for(let $=0;$<U;$++)k.push(s.getColHeader($));return k}let R=y.colHeaders;const _=function(k){const U=[],$=s.countCols();let I=0;for(;I<$;I++)Ee(y.columns)&&y.columns(I)&&U.push(I);return U[k]},O=s.toPhysicalColumn(p),x=_(O);return y.colHeaders===!1?R=null:y.columns&&Ee(y.columns)&&y.columns(x)&&y.columns(x).title?R=y.columns(x).title:y.columns&&y.columns[O]&&y.columns[O].title?R=y.columns[O].title:Array.isArray(y.colHeaders)&&y.colHeaders[O]!==void 0?R=y.colHeaders[O]:Ee(y.colHeaders)?R=y.colHeaders(O):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(R=nW(p)),R=s.runHooks("modifyColumnHeaderValue",R,f,m),R},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let p=s._getColWidthFromSettings(f);return p=s.runHooks("modifyColWidth",p,f,m),p===void 0&&(p=Mp),p},this._getRowHeightFromSettings=function(f){const m=s.stylesHandler.getDefaultRowHeight();let p=y.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<m?m:p},this.getRowHeight=function(f,m){let p=s._getRowHeightFromSettings(f);return p=s.runHooks("modifyRowHeight",p,f,m),p},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return MS(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return MS(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,p,R){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return $t(f)||$t(m)?!1:this.selectCells([[f,m,p,R]],_,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&g.suspend();const R=L.selectCells(f);return R&&p&&s.listen(),g.resume(),R},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectColumns(f,m,p)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return L.selectRows(f,m,p)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;g.skipNextScrollCycle(),L.selectAll(f,m,p)};const xe=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var p;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:R,col:_,considerHiddenIndexes:O}=f??{};let x=R,k=_;if(Ee(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const V=Number.isInteger(R)&&R>=0,Y=Number.isInteger(_)&&_>=0,re=V?xe(this.rowIndexMapper,R):void 0,ke=Y?xe(this.columnIndexMapper,_):void 0;if(re===null||ke===null)return!1;x=V?s.rowIndexMapper.getRenderableFromVisualIndex(re):R,k=Y?s.columnIndexMapper.getRenderableFromVisualIndex(ke):_}const U=Number.isInteger(x),$=Number.isInteger(k);let I=!1;return U&&x>=0&&$&&k>=0?I=s.view.scrollViewport(s._createCellCoords(x,k),f.horizontalSnap,f.verticalSnap):U&&x>=0&&($&&k<0||!$)?I=s.view.scrollViewportVertically(x,f.verticalSnap):$&&k>=0&&(U&&x<0||!U)&&(I=s.view.scrollViewportHorizontally(k,f.horizontalSnap)),Ee(m)&&(I?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),I},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Ee(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeActive(),p=this.scrollViewportTo(m.toObject());return p?this.view.render():Ee(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),p},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,lo(this)&&Ij(),this.getShortcutManager().destroy(),P.clear(),E.clearCache(),Tg.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&Os(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),H.getItems().forEach(f=>{let[,m]=f;m.destroy()}),H.clear(),s.runHooks("afterDestroy")},!0),fe.getSingleton().destroy(s),Ie(s,(f,m,p)=>{Ee(f)?p[m]=Or(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function Or(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return H.getItem(Tc(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:H.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m,p){fe.getSingleton().add(f,m,s,p)},this.hasHook=function(f){return fe.getSingleton().has(f,s)||fe.getSingleton().has(f)},this.addHookOnce=function(f,m,p){fe.getSingleton().once(f,m,s,p)},this.removeHook=function(f,m){fe.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,p,R,_,O,x){return fe.getSingleton().run(s,f,m,p,R,_,O,x)},this.getTranslatedPhrase=function(f,m){return uM(y.language,f,m)},this.toHTML=()=>TS(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",TS(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!w;this.stylesHandler.useTheme(f);const p=this.stylesHandler.getThemeName();m||(s.render(),s.scrollViewportTo(0,0),jR(this.rootContainer)&&(Me(this.rootContainer,/ht-theme-.*/g),p&&Z(this.rootContainer,p))),this.runHooks("afterSetTheme",p,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=f;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){j(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){j(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return h};const He=yj({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&He.releasePressedKeys()}),this.getShortcutManager=function(){return He},this.getFocusManager=function(){return d},h0().forEach(f=>{const m=Op(f);H.addItem(f,new m(this))}),rj(s),He.setActiveContextName("grid"),fe.getSingleton().run(s,"construct")}function XR(t,e,r){t.addEventListener(e,r,!1)}function ZR(t,e,r){t.removeEventListener(e,r,!1)}function nu(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Pj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=nu(s).fontSize,o.style.fontFamily=nu(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=nu(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),w=parseInt(((d=nu(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+g+w+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>v?b.width=`${r.minWidth}px`:v>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${v}px`;const T=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>T?b.height=`${r.minHeight}px`:r.maxHeight<T?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${T}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(XR(s,"input",a),XR(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){ZR(s,"input",a),ZR(s,"keydown",l)}}}function JR(t,e){const r=FN(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}Z_(e,i)}function no(t,e,r){return(e=xj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xj(t){var e=Hj(t,"string");return typeof e=="symbol"?e:e+""}function Hj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Aj="ht_editor_visible",iu="ht_editor_hidden",QR="textEditor",Dj="text";class Nj extends bw{static get EDITOR_TYPE(){return Dj}constructor(e){super(e),no(this,"eventManager",new Wi(this)),no(this,"autoResize",Pj(this.hot.rootDocument)),no(this,"TEXTAREA",void 0),no(this,"textareaStyle",void 0),no(this,"TEXTAREA_PARENT",void 0),no(this,"textareaParentStyle",void 0),no(this,"layerClass",void 0),this.eventManager=new Wi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Eu(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==ct.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===ct.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),Z_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Te(this.TEXTAREA,[["data-hot-input",""],ko(-1)]),Z(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Z(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&Me(this.TEXTAREA_PARENT,this.layerClass),Z(this.TEXTAREA_PARENT,iu),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){IN()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Me(this.TEXTAREA_PARENT,this.layerClass),Z(this.TEXTAREA_PARENT,iu)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Xe(e.length-1,n=>{const i=e[n];if(ye(i,"handsontableEditor"))return r=!0,!1}),ye(this.TEXTAREA_PARENT,iu)&&Me(this.TEXTAREA_PARENT,iu),r?(this.layerClass=Aj,Z(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Z(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==ct.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){B_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===ct.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===ct.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>de(this.hot.getSelected()),group:QR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;JR(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;JR(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(QR)}}const kj="base",Lj="htTextEllipsis";function _M(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Z(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(YC())):a&&c.push(YC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(qC())):(u.push(s.invalidCellClassName),a&&c.push(qC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(Lj),Me(e,u),Z(e,l),fl(e,c),Te(e,h)}_M.RENDERER_TYPE=kj;const Fj="text";function OM(t,e,r,n,i,o,s){_M.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=wp(a),s.trimWhitespace&&(a=a.trim()),gl(e,a)}OM.RENDERER_TYPE=Fj;const Vj="text",Wj={CELL_TYPE:Vj,editor:Nj,renderer:OM};IB(Wj);fn.editors={BaseEditor:bw};function fn(t,e){const r=new TM(t,e||{},jp);return r.init(),r}fn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new TM(t,e,jp)};fn.DefaultSettings=mM();fn.hooks=fe.getSingleton();fn.CellCoords=So;fn.CellRange=ml;fn.packageName="handsontable";fn.buildDate="23/09/2025 14:16:56";fn.version="16.1.1";fn.languages={dictionaryKeys:LW,getLanguageDictionary:lM,getLanguagesDictionaries:$W,registerLanguageDictionary:aM,getTranslatedPhrase:uM};function Bj(t,e){MM(t,e),e.add(t)}function Jo(t,e,r){return(e=$j(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $j(t){var e=jj(t,"string");return typeof e=="symbol"?e:e+""}function jj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eE(t,e,r){MM(t,e),e.set(t,r)}function MM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(t,e,r){return t.set(Sw(t,e),r),r}function Ze(t,e){return t.get(Sw(t,e))}function Sw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tE=new Map([["plugin",Yk],["cell-type",gM],["editor",o0],["renderer",d0],["validator",f0]]),zj=Symbol("mainSetting"),Uj="base",su=[];let io=null;var nt=new WeakMap,oo=new WeakMap,rE=new WeakSet;class Fc{static get PLUGIN_KEY(){return Uj}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Bj(this,rE),eE(this,nt,null),Jo(this,"eventManager",new Wi(this)),Jo(this,"pluginName",null),Jo(this,"pluginsInitializedCallbacks",[]),Jo(this,"isPluginsReady",!1),Jo(this,"enabled",!1),Jo(this,"initialized",!1),eE(this,oo,{}),ci(this,"hot",e,{writable:!1}),io=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!tE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);tE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");su.push(o)}}if(io||(io=h0()),io.indexOf(this.pluginName)>=0&&io.splice(io.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),io.length===0){if(su.length>0){const i=[`${su.join(`
`)}
`,"You have to import and register them manually."].join("");throw su.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return ot(Ze(nt,this))?Ru(Ze(nt,this),r):Ze(nt,this);if((Array.isArray(Ze(nt,this))||ot(Ze(nt,this)))&&r[zj]===e){var n;return Array.isArray(Ze(nt,this))?Ze(nt,this):(n=Ze(nt,this)[e])!==null&&n!==void 0?n:r[e]}if(e.includes(".")){const i=om(Ze(nt,this),e),o=om(r,e);return ot(i)?Ru(i,o):i!==void 0?i:o}return ot(Ze(nt,this))?Ru(Ze(nt,this),r)[e]:r[e]}updatePluginSettings(e){const r=this.constructor.SETTINGS_VALIDATORS;if(r&&typeof r=="function"&&typeof e!="object"){if(r(e)===!1){$r(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return ou(nt,this,e),Ze(nt,this)}return r&&typeof r=="object"&&typeof e=="object"?((Ze(nt,this)===null||typeof Ze(nt,this)!="object")&&ou(nt,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(r).forEach(n=>{if(!(n in e))return;const i=r[n];if((i?i(e[n]):!0)===!1){$r(`${this.pluginName} Plugin: "${n}" option is not valid and it will be ignored.`);return}Ze(nt,this)[n]=e[n]}),Ze(nt,this)):(ou(nt,this,e),e)}addHook(e,r,n){Ze(oo,this)[e]=Ze(oo,this)[e]||[];const i=Ze(oo,this)[e];this.hot.addHook(e,r,n),i.push(r),Ze(oo,this)[e]=i}removeHooks(e){j(Ze(oo,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Ze(oo,this);Ie(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){j(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=Sw(rE,this,Yj).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;ou(nt,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ie(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function Yj(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function so(t,e,r){return(e=qj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qj(t){var e=Gj(t,"string");return typeof e=="symbol"?e:e+""}function Gj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kj{constructor(e){so(this,"hot",null),so(this,"container",null),so(this,"injected",!1),so(this,"rows",[]),so(this,"columns",[]),so(this,"samples",null),so(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Z(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),j(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),j(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{j(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{j(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{j(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),j(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{j(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Z(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Z(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function pa(t,e,r){return(e=Xj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xj(t){var e=Zj(t,"string");return typeof e=="symbol"?e:e+""}function Zj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rw{static get SAMPLE_COUNT(){return 3}constructor(e){pa(this,"samples",null),pa(this,"dataFactory",null),pa(this,"customSampleCount",null),pa(this,"allowDuplicates",!1),pa(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Rw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Xe(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Xe(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a,this):this.dataFactory(a,n,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:ot(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${wp(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function Jj(t,e){IM(t,e),e.add(t)}function _g(t,e,r){IM(t,e),e.set(t,r)}function IM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(t,e,r){return(e=Qj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qj(t){var e=ez(t,"string");return typeof e=="symbol"?e:e+""}function ez(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ai(t,e){return t.get(nr(t,e))}function ec(t,e,r){return t.set(nr(t,e),r),r}function nr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}fe.getSingleton().register("modifyAutoColumnSizeSeed");const Og="autoColumnSize",tz=10,rz="autoColumnSize";var Ew=new WeakMap,us=new WeakMap,Is=new WeakMap,wr=new WeakSet;class Ba extends Fc{static get PLUGIN_KEY(){return Og}static get PLUGIN_PRIORITY(){return tz}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Jj(this,wr),wa(this,"ghostTable",new Kj(this.hot)),wa(this,"samplesGenerator",new Rw((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),wa(this,"inProgress",!1),wa(this,"measuredColumns",0),wa(this,"columnWidthsMap",new Hc),_g(this,Ew,!1),_g(this,us,[]),_g(this,Is,[]),this.hot.columnIndexMapper.registerMap(rz,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>nr(wr,this,nE).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[Og]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return nr(wr,e,oz).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return nr(wr,e,sz).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return nr(wr,e,lz).call(e,...i)}),this.addHook("beforeRender",()=>nr(wr,this,iz).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>nr(wr,this,az).call(this)),super.enablePlugin()}updatePlugin(){ec(Is,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>nr(wr,this,nE).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Xe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&nr(wr,this,PM).call(this,s,o)}),this.ghostTable.columns.length&&(nr(wr,this,xM).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){ZC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ba.CALCULATION_STEP,i)},e,r),n=n+Ba.CALCULATION_STEP+1,n<i?o=sm(s):(ZC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Og];let r=Ba.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return ot(e)&&(r=e.syncLimit,iN(r)?r=kk(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Mp))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=Ai(us,this).length;return(s-1<o||Ai(us,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?Ai(us,this).push(i):Ai(us,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function nz(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||nr(wr,this,PM).call(this,r,e))}),this.ghostTable.columns.length&&(nr(wr,this,xM).call(this),this.ghostTable.clean())}function PM(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function xM(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function iz(){this.calculateVisibleColumnsWidth(),this.inProgress||(nr(wr,this,nz).call(this,Ai(Is,this)),ec(Is,this,[]))}function oz(t,e){e||this.recalculateAllColumnsWidth()}function sz(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);Ai(Is,this).push(...e)}function nE(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function az(){ec(us,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),ec(Ew,this,!0)}function lz(t){if(!Ai(Ew,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);Ai(Is,this).push(...e)}function uz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function cz(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function ao(t,e){const r={};return j(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function _i(t,e,r,n,i){j(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&hz(s,a,e,r,n,i)})})}function hz(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=uz(s.className,n):a=cz(s.className,n)),o(t,e,"className",a)}function dz(t){return`<span class="selected">â</span>${t}`}function Mg(t,e){let r=!1;return Array.isArray(t)&&j(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function HM(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const Et="---------";function fz(){return{name:Et}}const nn="alignment";function gz(){return{key:nn,name(){return this.getTranslatedPhrase(sw)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${nn}:left`,name(){return this.getTranslatedPhrase(aw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${nn}:center`,name(){return this.getTranslatedPhrase(lw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${nn}:right`,name(){return this.getTranslatedPhrase(uw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${nn}:justify`,name(){return this.getTranslatedPhrase(cw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Et},{key:`${nn}:top`,name(){return this.getTranslatedPhrase(hw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${nn}:middle`,name(){return this.getTranslatedPhrase(dw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${nn}:bottom`,name(){return this.getTranslatedPhrase(fw)},callback(){const t=this.getSelectedRange(),e=ao(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),_i(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Tw="clear_column";function mz(){return{key:Tw,name(){return this.getTranslatedPhrase(ew)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const Vc="col_left";function pz(){return{key:Vc,name(){return this.getTranslatedPhrase(Gp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Wc="col_right";function wz(){return{key:Wc,name(){return this.getTranslatedPhrase(Kp)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Bc="make_read_only";function vz(){return{key:Bc,checkable:!0,ariaChecked(){return Mg(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Xu)},name(){let t=this.getTranslatedPhrase(Xu);return Mg(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=dz(t)),t},callback(){const t=this.getSelectedRange(),e=Mg(t,(r,n)=>this.getCellMeta(r,n).readOnly);j(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const $c="redo";function yz(){return{key:$c,name(){return this.getTranslatedPhrase(Qp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const jc="remove_col";function bz(){return{key:jc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Zp,e)},callback(){this.alter("remove_col",pB(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const zc="remove_row";function Cz(){return{key:zc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Xp,e)},callback(){this.alter("remove_row",wB(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Uc="row_above";function Sz(){return{key:Uc,name(){return this.getTranslatedPhrase(Yp)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const Yc="row_below";function Rz(){return{key:Yc,name(){return this.getTranslatedPhrase(qp)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Ja="no_items";function Ez(){return{key:Ja,name(){return this.getTranslatedPhrase(Up)},disabled:!0,isCommand:!1}}const qc="undo";function Tz(){return{key:qc,name(){return this.getTranslatedPhrase(Jp)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const _z=[Uc,Yc,Vc,Wc,Tw,zc,jc,qc,$c,Bc,nn,Et,Ja],Oz={[Et]:fz,[Ja]:Ez,[Uc]:Sz,[Yc]:Rz,[Vc]:pz,[Wc]:wz,[Tw]:mz,[zc]:Cz,[jc]:bz,[qc]:Tz,[$c]:yz,[Bc]:vz,[nn]:gz};function AM(){const t={};return Ie(Oz,(e,r)=>{t[r]=e()}),t}function Ig(t,e,r){return(e=Mz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mz(t){var e=Iz(t,"string");return typeof e=="symbol"?e:e+""}function Iz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pz{constructor(e){Ig(this,"hot",void 0),Ig(this,"commands",{}),Ig(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=xz(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Br(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),j(u,c=>c.apply(this.hot,n))}}function xz(t,e){let r;return j(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function Pg(t,e,r){return(e=Hz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hz(t){var e=Az(t,"string");return typeof e=="symbol"?e:e+""}function Az(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dz{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Pg(this,"hot",void 0),Pg(this,"predefinedItems",AM()),Pg(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Ie(e,(n,i)=>{let o="";n.name===Et?(r[Et]=n,o=Et):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Nz(e,this.defaultOrderPattern,this.predefinedItems)}}function Nz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),ot(i)?Ie(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),ot(o)?Vi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):j(i,(o,s)=>{let a=r[o];!a&&_z.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),ot(o)&&Vi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function Ci(t,e,r){return(e=kz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kz(t){var e=Lz(t,"string");return typeof e=="symbol"?e:e+""}function Lz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fz{constructor(e,r){Ci(this,"top",void 0),Ci(this,"topRelative",void 0),Ci(this,"left",void 0),Ci(this,"leftRelative",void 0),Ci(this,"scrollTop",void 0),Ci(this,"scrollLeft",void 0),Ci(this,"cellHeight",void 0),Ci(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function va(t,e,r){Vz(t,e),e.set(t,r)}function Vz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e){return t.get(DM(t,e))}function au(t,e,r){return t.set(DM(t,e),r),r}function DM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ft=new WeakMap,Jt=new WeakMap,Qt=new WeakMap,xg=new WeakMap,Qo=new WeakMap;class Wz{constructor(e){va(this,Ft,void 0),va(this,Jt,void 0),va(this,Qt,void 0),va(this,xg,!1),va(this,Qo,{above:0,below:0,left:0,right:0}),au(xg,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ie(Qo,this)[e]=r,this}setElement(e){return au(Ft,this,e),this}setParentElement(e){return au(Jt,this,e),this}updatePosition(e){au(Qt,this,new Fz(e,ie(Ft,this).ownerDocument.defaultView)),ie(xg,this)?(ie(Qt,this).fitsBelow(ie(Ft,this))?this.setPositionBelowCursor():ie(Qt,this).fitsAbove(ie(Ft,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ie(Ft,this).dir==="rtl"?ie(Qt,this).fitsOnLeft(ie(Ft,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ie(Qt,this).fitsOnRight(ie(Ft,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ie(Qo,this).above+ie(Qt,this).top-ie(Ft,this).offsetHeight;if(ie(Jt,this)){const n=ie(Jt,this).ownerDocument.defaultView.getComputedStyle(ie(Jt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Qt,this).top+ie(Qt,this).cellHeight-ie(Ft,this).scrollHeight+i+o}ie(Ft,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ie(Qo,this).below+ie(Qt,this).top+1;if(ie(Jt,this)){const n=ie(Jt,this).ownerDocument.defaultView.getComputedStyle(ie(Jt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Qt,this).top-i-o}ie(Ft,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ie(Qt,this).left;if(ie(Jt,this)){const r=ie(Jt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Jt,this).querySelector(".htCore")).borderRightWidth,10);e+=ie(Qt,this).cellWidth+n}else e+=ie(Qo,this).right;ie(Ft,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ie(Qo,this).left+ie(Qt,this).left-ie(Ft,this).offsetWidth;if(ie(Jt,this)){const r=ie(Jt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(Jt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ie(Ft,this).style.left=`${e}px`}}function Bz(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=De(e,-1,v()-1);function a(T,C){const E=v()-1;return T<0&&(T=E),T>E&&(T=0),o.has(T)?-1:(o.add(T),n(T,!1)===!1&&(T=a(C===1?++T:--T,C)),T)}function l(T){T>-1&&T<v()&&n(T,!0)!==!1&&(s=T)}function u(T){T>-1&&T<v()&&(s=T)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function g(){v()>0&&(o.clear(),s=a(++s,1))}function w(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(r(),0)}function b(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:w,getSize:v,clear:b}}function $z(t){return xn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function bm(t){return Br(t,"submenu")}function Cm(t){return new RegExp(Et,"i").test(t.name)}function Pu(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function iE(t){return Br(t,"disableSelection")}function jz(t){return ye(t,"htSeparator")}function zz(t){return ye(t,"htSubmenu")}function Uz(t){return ye(t,"htDisabled")}function Yz(t){return ye(t,"htSelectionDisabled")}function qz(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function NM(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function Gz(t,e){let r=t.slice(0);return r.reverse(),r=NM(r,e),r.reverse(),r}function Kz(t){const e=[];return j(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function Xz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Et,r=t.slice(0);return r=NM(r,e),r=Gz(r,e),r=Kz(r),r}function Zz(t){return t.checkable===!0}function Jz(t){return Bz({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||jz(n)||Uz(n)||Yz(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Qz(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedActive();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedActive();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedActive()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const kM="menu",oE=kM;function eU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Qz(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:kM})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(w=>h.removeShortcutsByKeys(w))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${oE}:${u}`:oE}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function tU(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(Os(r),Z(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Pu(a,t)&&!iE(a)&&!Cm(a);Te(r,[...Zz(a)?[dN(),ju(c),vN(h)]:[hN(),ju(u)],...d?[ko(-1)]:[],...Pu(a,t)?[pN()]:[],...bm(a)?[Su(!1)]:[]])}r.className="",r.appendChild(l),Cm(a)?Z(r,"htSeparator"):typeof a.renderer=="function"?(Z(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):q_(l,u),Pu(a,t)?Z(r,"htDisabled"):iE(a)?Z(r,"htSelectionDisabled"):bm(a)&&Z(r,"htSubmenu")}}function Hg(t,e,r){rU(t,e),e.set(t,r)}function rU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sn(t,e,r){return(e=nU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nU(t){var e=iU(t,"string");return typeof e=="symbol"?e:e+""}function iU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ag(t,e,r){return t.set(LM(t,e),r),r}function Si(t,e){return t.get(LM(t,e))}function LM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const sE=215;var es=new WeakMap,lu=new WeakMap,uu=new WeakMap;class Gc{get tableBorderWidth(){return Si(uu,this)===void 0&&this.hotMenu&&Ag(uu,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Si(uu,this)}constructor(e,r){var n=this;Sn(this,"hot",void 0),Sn(this,"options",void 0),Sn(this,"eventManager",new Wi(this)),Sn(this,"container",void 0),Sn(this,"positioner",void 0),Sn(this,"hotMenu",null),Sn(this,"hotSubMenus",{}),Sn(this,"parentMenu",void 0),Sn(this,"menuItems",null),Sn(this,"origOutsideClickDeselects",null),Hg(this,es,void 0),Hg(this,lu,void 0),Hg(this,uu,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:sE,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Wz(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(Me(this.options.container,/ht-theme-.*/g),Z(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Ka(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Si(es,this)}getKeyboardShortcutsCtrl(){return Si(lu,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=t0(a=>this.openSubMenu(a),300),r=this.options.minWidth||sE;let n=!1,i=pp(this.menuItems,a=>(a.key===Ja&&(n=!0),qz(a,this.hot)));if(i.length<1&&!n)i.push(AM()[Ja]);else if(i.length===0)return;i=Xz(i,Et);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return de(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:tU(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Si(es,this).setCurrentPage(l.row):Si(es,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),JC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!JC()||!Yu(a))&&o&&this.hasSelectedItem()&&(Hi()||$_()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Ag(es,this,Jz(this.hotMenu)),Ag(lu,this,eU(this)),Si(lu,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Si(es,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedActive();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);Te(n,[Su(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!zz(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Gc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&Te(r,[Su(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Te(i,[Su(!1)])}}closeAllSubMenus(){j(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?$z(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Cm(e)||Pu(e,this.hot)||bm(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=No(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?lr(this.hotMenu.getCell(u,0)):0;return a+(l.name===Et?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Ee(n)&&(n=n.call(this.hot),n===null||$t(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),Z(i,`htMenu handsontable ${this.options.className}`),n&&Z(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Te(this.hotMenu.rootElement,[cN(),ko(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ys(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ys(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&ys(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Qe(Gc,Nn);function oU(t,e){sU(t,e),e.add(t)}function sU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dg(t,e,r){return(e=aU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aU(t){var e=lU(t,"string");return typeof e=="symbol"?e:e+""}function lU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Pa="contextMenu",uU=70,aE=Pa;fe.getSingleton().register("afterContextMenuDefaultOptions");fe.getSingleton().register("beforeContextMenuShow");fe.getSingleton().register("afterContextMenuShow");fe.getSingleton().register("afterContextMenuHide");fe.getSingleton().register("afterContextMenuExecute");var ya=new WeakSet;class Kc extends Fc{constructor(){super(...arguments),oU(this,ya),Dg(this,"commandExecutor",new Pz(this.hot)),Dg(this,"itemsFactory",null),Dg(this,"menu",null)}static get PLUGIN_KEY(){return Pa}static get PLUGIN_PRIORITY(){return uU}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Uc,Yc,Et,Vc,Wc,Et,zc,jc,Et,qc,$c,Et,Bc,Et,nn]}isEnabled(){return!!this.hot.getSettings()[Pa]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Pa];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Gc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>cu(ya,this,hU).call(this)),this.menu.addLocalHook("afterOpen",()=>cu(ya,this,dU).call(this)),this.menu.addLocalHook("afterClose",()=>cu(ya,this,fU).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>cu(ya,this,cU).call(this,n)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=HM(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:aE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aE)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ie(n,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new Dz(this.hot,Kc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Pa],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),j(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function cU(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ye(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(ye(o,"current")&&ye(o,"wtBorder"))))return;const s=HM(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function hU(){this.hot.runHooks("beforeContextMenuShow",this)}function dU(){this.hot.runHooks("afterContextMenuShow",this)}function fU(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Kc.SEPARATOR={name:Et};function gU(t){return{key:"copy",name(){return this.getTranslatedPhrase(tw)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function mU(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(iw,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function pU(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nw,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function wU(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(rw,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function vU(t){return{key:"cut",name(){return this.getTranslatedPhrase(ow)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class yU{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class bU{constructor(){this.clipboardData=new yU}preventDefault(){}composedPath(){return[]}}function CU(t,e){FM(t,e),e.add(t)}function ts(t,e,r){FM(t,e),e.set(t,r)}function FM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(gs(t,e))}function rs(t,e,r){return t.set(gs(t,e),r),r}function gs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ri=new WeakMap,Ng=new WeakMap,ba=new WeakMap,Sm=new WeakMap,Rm=new WeakMap,Ca=new WeakMap,Sa=new WeakSet;class SU{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;CU(this,Sa),ts(this,Ri,void 0),ts(this,Ng,void 0),ts(this,ba,void 0),ts(this,Sm,void 0),ts(this,Rm,void 0),ts(this,Ca,void 0),rs(Ng,this,r),rs(ba,this,n),rs(Sm,this,i),rs(Rm,this,o),rs(Ca,this,s)}setSelectedRange(e){rs(Ri,this,e)}getCellsRange(){if(Vt(Ng,this).call(this)===0||Vt(ba,this).call(this)===0)return null;const{row:e,col:r}=Vt(Ri,this).getTopStartCorner(),{row:n,col:i}=Vt(Ri,this).getBottomEndCorner(),o=gs(Sa,this,RU).call(this,e,n),s=gs(Sa,this,kg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Vt(ba,this).call(this)===0||Vt(Ca,this).call(this)===0)return null;const{col:e}=Vt(Ri,this).getTopStartCorner(),{col:r}=Vt(Ri,this).getBottomEndCorner(),n=gs(Sa,this,kg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Vt(ba,this).call(this)===0||Vt(Ca,this).call(this)===0)return null;const{col:e}=Vt(Ri,this).getTopStartCorner(),{col:r}=Vt(Ri,this).getBottomEndCorner(),n=gs(Sa,this,kg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Vt(Ca,this).call(this),startCol:e,endRow:-1,endCol:n}}}function kg(t,e){return Math.min(e,Math.max(t+Vt(Rm,this).call(this)-1,t))}function RU(t,e){return Math.min(e,Math.max(t+Vt(Sm,this).call(this)-1,t))}function VM(t){const e=[],r=[];return j(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Xe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Xe(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function EU(t,e){WM(t,e),e.add(t)}function Ei(t,e,r){WM(t,e),e.set(t,r)}function WM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ra(t,e,r){return(e=TU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TU(t){var e=_U(t,"string");return typeof e=="symbol"?e:e+""}function _U(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rr(t,e){return t.get(Pt(t,e))}function tn(t,e,r){return t.set(Pt(t,e),r),r}function Pt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}fe.getSingleton().register("afterCopyLimit");fe.getSingleton().register("modifyCopyableRange");fe.getSingleton().register("beforeCut");fe.getSingleton().register("afterCut");fe.getSingleton().register("beforePaste");fe.getSingleton().register("afterPaste");fe.getSingleton().register("beforeCopy");fe.getSingleton().register("afterCopy");const Lg="copyPaste",OU=80,MU=["fragmentSelection"],BM="application/ht-source-data-json-html",lE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Em=new WeakMap,Tm=new WeakMap,_m=new WeakMap,ns=new WeakMap,hu=new WeakMap,du=new WeakMap,is=new WeakMap,tc=new WeakMap,Wt=new WeakSet;class IU extends Fc{constructor(){super(...arguments),EU(this,Wt),Ra(this,"columnsLimit",1/0),Ra(this,"rowsLimit",1/0),Ra(this,"pasteMode","overwrite"),Ra(this,"uiContainer",this.hot.rootDocument.body),Ei(this,Em,!1),Ei(this,Tm,!1),Ei(this,_m,!1),Ei(this,ns,"cells-only"),Ei(this,hu,!1),Ei(this,du,!1),Ei(this,is,new SU({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ei(this,tc,!1),Ra(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Lg}static get SETTING_KEYS(){return[Lg,...MU]}static get PLUGIN_PRIORITY(){return OU}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Lg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),tn(Em,this,this.getSetting("copyColumnHeaders")),tn(Tm,this,this.getSetting("copyColumnGroupHeaders")),tn(_m,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Pt(Wt,this,HU).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Wt,n,AU).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Pt(Wt,this,DU).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),bp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Wt,n,NU).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Pt(Wt,n,kU).call(n,...o)}),this.addHook("afterSelection",()=>Pt(Wt,this,LU).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";tn(ns,this,e),tn(hu,this,!0),Pt(Wt,this,uE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){tn(du,this,!0),Pt(Wt,this,uE).call(this,"cut")}getRangedCopyableData(e){return Zu(this.getRangedData(e))}getRangedData(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=[],{rows:i,columns:o}=VM(e);return j(i,s=>{const a=[];j(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=r?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);r&&ot(u)&&(u=JSON.stringify(u)),a.push(u)}}),n.push(a)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new bU;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}rr(is,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);rr(ns,this)==="column-headers-only"?r.set("headers",rr(is,this).getMostBottomColumnHeadersRange()):(rr(ns,this)==="with-column-headers"?r.set("headers",rr(is,this).getMostBottomColumnHeadersRange()):rr(ns,this)==="with-column-group-headers"&&r.set("headers",rr(is,this).getAllColumnHeadersRange()),r.set("cells",rr(is,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const i=e.length,o=e[0].length,s=[],{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner();let h=a,d=l,g=a,w=l;for(;s.length<i||h<=u;){const{skipRowOnPaste:b,visualRow:T}=this.hot.getCellMeta(h,l);if(h=T+1,b===!0)continue;g=T,d=l;const C=[],E=s.length%i;for(;C.length<o||d<=c;){var v;const{skipColumnOnPaste:y,visualCol:M}=this.hot.getCellMeta(T,d),H=this.hot.getSourceDataAtCell(T,d),P=C.length%o;if(d=M+1,y===!0)continue;w=M;const A=r==null||(v=r[E])===null||v===void 0?void 0:v[P];let F=e[E][P];if(r&&nN(A)){const B=JSON.parse(A);(ot(H)||H===null)&&(F=B)}C.push(F)}s.push(C)}return tn(tc,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,w]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!rr(hu,this)||this.isEditorOpened()||bo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Eu(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),tn(hu,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=Pt(Wt,this,PU).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(Pt(Wt,this,cE).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),tn(ns,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!rr(du,this)||this.isEditorOpened()||bo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Eu(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),tn(du,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(Pt(Wt,this,cE).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||bo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Eu(r,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(BM);h&&(s=OS(h,this.hot.rootDocument).data);const d=A_(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=OS(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=SB(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function uE(t){if(bp()){const e=this.hot.getSelectedRangeActive();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&jN(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function PU(t){const{rows:e}=VM(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function xU(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&Q_(n)}}}function $M(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&e0(n)}}}function cE(t,e,r){const n=Zu(e);if(t&&t.clipboardData){const i=_S(e),o=_S(r);t.clipboardData.setData("text/plain",n),t.clipboardData.setData("text/html",[lE,i].join("")),t.clipboardData.setData(BM,[lE,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",n)}function HU(t){t.items.push({name:"---------"},gU(this)),rr(Em,this)&&t.items.push(wU(this)),rr(Tm,this)&&t.items.push(pU(this)),rr(_m,this)&&t.items.push(mU(this)),t.items.push(vU(this))}function AU(t,e,r,n,i){rr(tc,this)&&(i.value=!0),tn(tc,this,!1)}function DU(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function NU(){Pt(Wt,this,$M).call(this)}function kU(){Pt(Wt,this,xU).call(this)}function LU(){Pt(Wt,this,$M).call(this)}function FU(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function VU(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function WU(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function jM(t,e,r){const n=VU(t,FU(t,e,r));return WU(n)}function BU(t,e,r){return(e=$U(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $U(t){var e=jU(t,"string");return typeof e=="symbol"?e:e+""}function jU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gr{constructor(e){BU(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function fu(t,e,r){return(e=zU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zU(t){var e=UU(t,"string");return typeof e=="symbol"?e:e+""}function UU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _w extends Gr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),fu(this,"stateBefore",void 0),fu(this,"range",void 0),fu(this,"type",void 0),fu(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new _w({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){j(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){_i(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function hE(t,e,r){return(e=YU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YU(t){var e=qU(t,"string");return typeof e=="symbol"?e:e+""}function qU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ow extends Gr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),hE(this,"columns",void 0),hE(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new Ow({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),jM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function dE(t,e,r){return(e=GU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GU(t){var e=KU(t,"string");return typeof e=="symbol"?e:e+""}function KU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mw extends Gr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),dE(this,"previousSortState",void 0),dE(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new Mw({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function fE(t,e,r){return(e=XU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XU(t){var e=ZU(t,"string");return typeof e=="symbol"?e:e+""}function ZU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iw extends Gr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),fE(this,"index",void 0),fE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new Iw({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function gE(t,e,r){return(e=JU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JU(t){var e=QU(t,"string");return typeof e=="symbol"?e:e+""}function QU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pw extends Gr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),gE(this,"index",void 0),gE(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new Pw({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function gu(t,e,r){return(e=e2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e2(t){var e=t2(t,"string");return typeof e=="symbol"?e:e+""}function t2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xw extends Gr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),gu(this,"changes",void 0),gu(this,"selected",void 0),gu(this,"countCols",void 0),gu(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new xw({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=Rr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(3,1);e.addHookOnce("afterChange",()=>{const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.undo")}redo(e,r){const n=Rr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),r()}),e.setDataAtCell(n,null,null,"UndoRedo.redo")}}function mE(t,e,r){return(e=r2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r2(t){var e=n2(t,"string");return typeof e=="symbol"?e:e+""}function n2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hw extends Gr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),mE(this,"conditionsStack",void 0),mE(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new Hw({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function i2(t,e,r){return(e=o2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o2(t){var e=s2(t,"string");return typeof e=="symbol"?e:e+""}function s2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aw extends Gr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),i2(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new Aw({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function zM(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Xe(n,i,l=>{Xe(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function qn(t,e,r){return(e=a2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a2(t){var e=l2(t,"string");return typeof e=="symbol"?e:e+""}function l2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dw extends Gr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),qn(this,"index",void 0),qn(this,"indexes",void 0),qn(this,"data",void 0),qn(this,"amount",void 0),qn(this,"headers",void 0),qn(this,"columnPositions",void 0),qn(this,"rowPositions",void 0),qn(this,"fixedColumnsStart",void 0),qn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return Xe(l.length-1,w=>{const v=[],b=l[w];Xe(u,c,T=>{v.push(b[e.toPhysicalColumn(T)])}),h.push(v)}),Xe(i-1,w=>{g.push(e.toPhysicalColumn(u+w))}),Array.isArray(e.getSettings().colHeaders)&&Xe(i-1,w=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+w)]||null)}),new Dw({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:zM(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(xn(this.data[c],o));const l=xn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),j(e.getSourceDataArray(),(c,h)=>{j(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&j(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function os(t,e,r){return(e=u2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u2(t){var e=c2(t,"string");return typeof e=="symbol"?e:e+""}function c2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nw extends Gr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),os(this,"index",void 0),os(this,"data",void 0),os(this,"fixedRowsBottom",void 0),os(this,"fixedRowsTop",void 0),os(this,"rowIndexesSequence",void 0),os(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=Rr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new Nw({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:zM(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function pE(t,e,r){return(e=h2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h2(t){var e=d2(t,"string");return typeof e=="symbol"?e:e+""}function d2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kw extends Gr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),pE(this,"rows",void 0),pE(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new kw({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),jM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function f2(t,e,r){return(e=g2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g2(t){var e=m2(t,"string");return typeof e=="symbol"?e:e+""}function m2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lw extends Gr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),f2(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new Lw({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function p2(t,e){[_w,Ow,Mw,Iw,Pw,xw,Hw,Aw,Dw,Nw,kw,Lw].forEach(r=>r.startRegisteringEvents(t,e))}function w2(t,e){v2(t,e),e.add(t)}function v2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fg(t,e,r){return(e=y2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y2(t){var e=b2(t,"string");return typeof e=="symbol"?e:e+""}function b2(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wE="undoRedo",C2="undoRedo",S2=1e3;fe.getSingleton().register("beforeUndo");fe.getSingleton().register("afterUndo");fe.getSingleton().register("beforeRedo");fe.getSingleton().register("afterRedo");const vE=new Set;var mu=new WeakSet;class R2 extends Fc{static get PLUGIN_KEY(){return C2}static get PLUGIN_PRIORITY(){return S2}static get SETTING_KEYS(){return!0}constructor(e){super(e),w2(this,mu),Fg(this,"doneActions",[]),Fg(this,"undoneActions",[]),Fg(this,"ignoreNewActions",!1),p2(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Vg(mu,e,E2).call(e,...n)}),this.registerShortcuts(),Vg(mu,this,T2).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Vg(mu,this,_2).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:wE};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wE)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=Rr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=Rr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function E2(t,e){e==="loadData"&&this.clear()}function T2(){const t=e=>{vE.has(e)||($r(ar`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),vE.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function _2(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class O2{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=C=>{if(C=this.postProcess(C,n),i){setTimeout(function(){i(C)},0);return}else return C},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let w=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&w+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let v=-1/0,b=1/0;const T=()=>{for(let C=Math.max(v,-u);C<=Math.min(b,u);C+=2){let E;const y=g[C-1],M=g[C+1];y&&(g[C-1]=void 0);let H=!1;if(M){const A=M.oldPos-C;H=M&&0<=A&&A<a}const P=y&&y.oldPos+1<l;if(!H&&!P){g[C]=void 0;continue}if(!P||H&&y.oldPos<M.oldPos?E=this.addToPath(M,!0,!1,0,n):E=this.addToPath(y,!1,!0,1,n),w=this.extractCommon(E,r,e,C,n),E.oldPos+1>=l&&w+1>=a)return s(this.buildValues(E.lastComponent,r,e))||!0;g[C]=E,E.oldPos+1>=l&&(b=Math.min(b,C-1)),w+1>=a&&(v=Math.max(v,C+1))}u++};if(i)(function C(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);T()||C()},0)})();else for(;u<=c&&Date.now()<=d;){const C=T();if(C)return C}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const w=n[u+g];return w.length>d.length?w:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class M2 extends O2{constructor(){super(...arguments),this.tokenize=P2}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const I2=new M2;function yE(t,e,r){return I2.diff(t,e,r)}function P2(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function x2(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;yE(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(yE(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(C){return C.map(function(E){return" "+E})}const d=[];let g=0,w=0,v=[],b=1,T=1;for(let C=0;C<c.length;C++){const E=c[C],y=E.lines||A2(E.value);if(E.lines=y,E.added||E.removed){if(!g){const M=c[C-1];g=b,w=T,M&&(v=l>0?h(M.lines.slice(-l)):[],g-=v.length,w-=v.length)}for(const M of y)v.push((E.added?"+":"-")+M);E.added?T+=y.length:b+=y.length}else{if(g)if(y.length<=l*2&&C<c.length-2)for(const M of h(y))v.push(M);else{const M=Math.min(y.length,l);for(const P of h(y.slice(0,M)))v.push(P);const H={oldStart:g,oldLines:b-g+M,newStart:w,newLines:T-w+M,lines:v};d.push(H),g=0,w=0,v=[]}b+=y.length,T+=y.length}}for(const C of d)for(let E=0;E<C.lines.length;E++)C.lines[E].endsWith(`
`)?C.lines[E]=C.lines[E].slice(0,-1):(C.lines.splice(E+1,0,"\\ No newline at end of file"),E++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function UM(t){if(Array.isArray(t))return t.map(UM).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function H2(t,e,r,n,i,o,s){{const a=x2(t,e,r,n,i,o);return a?UM(a):void 0}}function A2(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var Om;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(Om||(Om={}));const ss=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,Ps=Om;class bE{data;constructor(e){this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class CE{data;constructor(e){this.data=e}run(){return[...new Set(this.data)]}}class Mm{data1;data2;ignoreDuplicates;constructor(e,r,n=!0){n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)Ps.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return Ps.sort(e)}}class D2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)Ps.contains(this.data2,r[n])&&e.push(r[n]);return Ps.sort(e)}}class SE{data;constructor(e){this.data=Ps.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new Mm(Ps.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class N2{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){return H2("Data1","Data2",this.data1,this.data2)}}var k2=rP('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row svelte-1n46o8q"><div id="Table1" class="col-3 svelte-1n46o8q"></div> <div id="Table2" class="col-3 pl-0 svelte-1n46o8q"></div> <div class="col-2 p-0 pt-5 svelte-1n46o8q"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-1n46o8q"><label for="result">Result</label> <textarea class="form-control svelte-1n46o8q" id="result" readonly=""></textarea></div></div></div>',1);function L2(t,e){OE(e,!0);const r=[],n=[];Al(Ba),Al(Kc),Al(IU),Al(R2);const i=64;let o,s,a=ir(""),l=ir("Data1"),u=ir("comm"),c=ir(!0),h=ir(!0),d=ir(!1);const g=(V,Y,re)=>{let ke;try{ke=JSON.parse(localStorage.getItem(re)||"")}catch{ke=void 0}const Ae=new fn(document.getElementById(V),{data:ke,colHeaders:[Y],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return Ae.addHook("beforePaste",()=>Ae.updateSettings({readOnly:!0})),Ae.addHook("afterPaste",ue=>{Ae.updateSettings({readOnly:!1}),Ae.deselectCell();for(let pe=ue.length-1;pe>=0;pe--)if(ue[pe][0]!==""){Ae.loadData(ue.slice(0,pe+1));return}Ae.loadData([[""]])}),Ae};cP(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const w=V=>V.getDataAtCol(0).filter(Y=>Y!==null),v=V=>{const Y=w(o).filter(ce=>ce!=""),re=w(s).filter(ce=>ce!="");switch(V){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(se(l)=="Data1"&&!Y.length){Ue(a,`Data1 is empty.
Please enter something...`);return}else if(se(l)=="Data2"&&!re.length){Ue(a,`Data2 is empty.
Please enter something...`);return}break;default:if(Y.length){if(!re.length){Ue(a,`Data2 is empty.
Please enter something...`);return}}else{Ue(a,`Data1 is empty.
Please enter something...`);return}}Ue(d,!0);const ke=E(),Ae=new Date().getTime();let ue="",pe;switch(V){case"chkDuplicates":let ce;se(l)=="Data1"?ce=new bE(Y).run():ce=new bE(re).run(),Object.keys(ce).length?se(c)?ue=`Duplicate values found in ${se(l)}.
`+ss(Object.keys(ce).length,Object.keys(ce).map(_e=>`${_e} appears ${ce[_e]} times.`)):ue=Object.keys(ce).join(`
`):ue=`${se(l)} has no duplicate value.`;break;case"rmDuplicates":se(l)=="Data1"?pe=new CE(Y).run():pe=new CE(re).run(),ue=pe.join(`
`);break;case"chkConsecutive":se(l)=="Data1"?pe=new SE(Y).run():pe=new SE(re).run(),pe.length?pe.length==1&&pe[0]=="!Error!"?ue=`Error!
${se(l)} contains non-numeric value. Please check!`:ue=`${se(l)} is not consecutive.

The following numbers are missing:
${pe.join(`
`)}`:ue=`${se(l)} contains consecutive numbers.`;break;case"compare":if(se(u)=="comm")pe=new D2(Y,re).run(),pe.length?ue=`Common values found between two data.
${ss(pe.length,pe)}`:ue="Two data contain no common value.";else{const _e=new Mm(Y,re,se(h)).run(),qe=new Mm(re,Y,se(h)).run();_e.length+qe.length==0?ue="Data1 is same as Data2.":_e.length?qe.length?ue=`Two files have inconsistent content.

Data1 is more than Data2
${ss(_e.length,_e)}

Data2 is more than Data1
${ss(qe.length,qe)}`:ue=`Data1 completely contains Data2.

Data1 is more than Data2
${ss(_e.length,_e)}`:ue=`Data2 completely contains Data1.

Data2 is more than Data1
${ss(qe.length,qe)}`}break;case"diff":ue=new N2(Y.join(`
`)+`
`,re.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(ke),V=="rmDuplicates"||V=="chkDuplicates"&&!se(c)?Ue(a,ue,!0):Ue(a,ue+`

Duration for process: ${Date.now()-Ae}ms`),Ue(d,!1)},b=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),Ue(a,""))},T=()=>{const V=o.getData();o.loadData(s.getData()),s.loadData(V)},C=async()=>{se(a).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(se(a).trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))},E=()=>setInterval(()=>{const V=se(a).split("Processing");let Y=V.length>=2?V[1].length:0;Y<3?Y++:Y-=3,Ue(a,"Processing"+".".repeat(Y))},200);var y=k2();eP("beforeunload",Ug,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var M=St(DI(y),2),H=Nt(M),P=St(Nt(H),4),A=Nt(P);A.__click=()=>v("chkDuplicates");var F=St(A,2),B=Nt(F),K=Nt(B),L=St(F,2);L.__click=()=>v("rmDuplicates");var oe=St(L,2);oe.__click=()=>v("chkConsecutive");var X=St(oe,2),te=Nt(X),tt=Nt(te);tt.value=tt.__value="Data1";var Pe=St(te,2),Se=Nt(Pe);Se.value=Se.__value="Data2";var Be=St(X,4);Be.__click=()=>v("compare");var $e=St(Be,2),xe=Nt($e),Or=Nt(xe);Or.value=Or.__value="comm";var He=St(xe,2),f=Nt(He);f.value=f.__value="diff";var m=St($e,2),p=Nt(m),R=Nt(p),_=St(m,4);_.__click=()=>v("diff");var O=St(_,6);O.__click=C;var x=St(O,6);x.__click=T;var k=Nt(x);aP(k,()=>"Data1 <=> Data2");var U=St(x,6);U.__click=b;var $=St(P,2),I=St(Nt($),2);zE(()=>{A.disabled=se(d),L.disabled=se(d),oe.disabled=se(d),Be.disabled=se(d),R.disabled=se(u)=="comm",_.disabled=se(d),O.disabled=se(d),x.disabled=se(d),U.disabled=se(d)}),ov(K,()=>se(c),V=>Ue(c,V)),Sl(r,[],tt,()=>se(l),V=>Ue(l,V)),Sl(r,[],Se,()=>se(l),V=>Ue(l,V)),Sl(n,[],Or,()=>se(u),V=>Ue(u,V)),Sl(n,[],f,()=>se(u),V=>Ue(u,V)),ov(R,()=>se(h),V=>Ue(h,V)),lP(I,()=>se(a),V=>Ue(a,V)),nP(t,y),ME()}tP(["click"]);iP(L2,{target:document.body})});export default F2();
