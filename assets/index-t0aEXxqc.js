var hM=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var e2=hM((a2,uu)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();const qR=!1;var GR=Array.isArray,dM=Array.prototype.indexOf,fM=Array.from,pg=Object.defineProperty,ma=Object.getOwnPropertyDescriptor,gM=Object.prototype,mM=Array.prototype,pM=Object.getPrototypeOf,Tw=Object.isExtensible;function KR(t){for(var e=0;e<t.length;e++)t[e]()}function wM(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}const gr=2,XR=4,nm=8,La=16,Si=32,lo=64,ZR=128,Hr=256,cu=512,Ft=1024,Jr=2048,Ri=4096,ls=8192,gs=16384,im=32768,vM=65536,_w=1<<17,yM=1<<18,Fa=1<<19,bM=1<<20,wg=1<<21,om=1<<22,Zi=1<<23,pa=Symbol("$state"),sm=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function CM(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function SM(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function RM(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function EM(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function TM(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function _M(t){throw new Error("https://svelte.dev/e/effect_orphan")}function OM(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function MM(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function IM(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function PM(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const xM=2,_t=Symbol();function QR(t){return t===this.v}let HM=!1,Ar=null;function hu(t){Ar=t}function JR(t,e=!1,r){Ar={p:Ar,c:null,e:null,s:t,x:null,l:null}}function eE(t){var e=Ar,r=e.e;if(r!==null){e.e=null;for(var n of r)gE(n)}return Ar=e.p,{}}function tE(){return!0}const AM=new WeakMap;function DM(t){var e=Ce;if(e===null)return we.f|=Zi,t;if((e.f&im)===0){if((e.f&ZR)===0)throw!e.parent&&t instanceof Error&&rE(t),t;e.b.error(t)}else am(t,e)}function am(t,e){for(;e!==null;){if((e.f&ZR)!==0)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t instanceof Error&&rE(t),t}function rE(t){const e=AM.get(t);e&&(pg(t,"message",{value:e.message}),pg(t,"stack",{value:e.stack}))}let ui=[],du=[];function nE(){var t=ui;ui=[],KR(t)}function NM(){var t=du;du=[],KR(t)}function kM(){return ui.length>0||du.length>0}function fu(t){if(ui.length===0&&!wa){var e=ui;queueMicrotask(()=>{e===ui&&nE()})}ui.push(t)}function LM(){ui.length>0&&nE(),du.length>0&&NM()}function FM(){const t=Ce.b;return t===null&&CM(),t}function VM(t){var e=gr|Jr,r=we!==null&&(we.f&gr)!==0?we:null;return Ce===null||r!==null&&(r.f&Hr)!==0?e|=Hr:Ce.f|=Fa,{ctx:Ar,deps:null,effects:null,equals:QR,f:e,fn:t,reactions:null,rv:0,v:_t,wv:0,parent:r??Ce,ac:null}}function WM(t,e){let r=Ce;r===null&&RM();var n=r.b,i=void 0,o=lE(_t),s=null,a=!we;return tI(()=>{try{var l=t();s&&Promise.resolve(l).catch(()=>{})}catch(g){l=Promise.reject(g)}var u=()=>l;i=s?.then(u,u)??Promise.resolve(l),s=i;var c=Ke,h=n.is_pending();a&&(n.update_pending_count(1),h||c.increment());const d=(g,w=void 0)=>{s=null,h||c.activate(),w?w!==sm&&(o.f|=Zi,yg(o,w)):((o.f&Zi)!==0&&(o.f^=Zi),yg(o,g)),a&&(n.update_pending_count(-1),h||c.decrement()),sE()};if(i.then(d,g=>d(null,g||"unknown")),c)return()=>{queueMicrotask(()=>c.neuter())}}),new Promise(l=>{function u(c){function h(){c===i?l(o):u(i)}c.then(h,h)}u(i)})}function iE(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)ro(e[r])}}function $M(t){for(var e=t.parent;e!==null;){if((e.f&gr)===0)return e;e=e.parent}return null}function lm(t){var e,r=Ce;yi($M(t));try{iE(t),e=EE(t)}finally{yi(r)}return e}function oE(t){var e=lm(t);if(t.equals(e)||(t.v=e,t.wv=SE()),!ms){var r=(ci||(t.f&Hr)!==0)&&t.deps!==null?Ri:Ft;fr(t,r)}}function BM(t,e,r){const n=VM;if(e.length===0){r(t.map(n));return}var i=Ke,o=Ce,s=jM(),a=FM();Promise.all(e.map(l=>WM(l))).then(l=>{i?.activate(),s();try{r([...t.map(n),...l])}catch(u){(o.f&gs)===0&&am(u,o)}i?.deactivate(),sE()}).catch(l=>{a.error(l)})}function jM(){var t=Ce,e=we,r=Ar,n=Ke;return function(){yi(t),vn(e),hu(r),n?.activate()}}function sE(){yi(null),vn(null),hu(null)}const _c=new Set;let Ke=null,Ql=null,Ow=new Set,to=[],Au=null,vg=!1,wa=!1;class us{current=new Map;#l=new Map;#i=new Set;#e=0;#u=null;#c=!1;#r=[];#o=[];#n=[];#t=[];#s=[];#h=[];#d=[];skipped_effects=new Set;process(e){to=[],Ql=null;for(const i of e)this.#g(i);if(this.#r.length===0&&this.#e===0){this.#f();var r=this.#n,n=this.#t;this.#n=[],this.#t=[],this.#s=[],Ql=Ke,Ke=null,Mw(r),Mw(n),Ke===null?Ke=this:_c.delete(this),this.#u?.resolve()}else this.#a(this.#n),this.#a(this.#t),this.#a(this.#s);for(const i of this.#r)es(i);for(const i of this.#o)es(i);this.#r=[],this.#o=[]}#g(e){e.f^=Ft;for(var r=e.first;r!==null;){var n=r.f,i=(n&(Si|lo))!==0,o=i&&(n&Ft)!==0,s=o||(n&ls)!==0||this.skipped_effects.has(r);if(!s&&r.fn!==null){if(i)r.f^=Ft;else if((n&XR)!==0)this.#t.push(r);else if((n&Ft)===0)if((n&om)!==0){var a=r.b?.is_pending()?this.#o:this.#r;a.push(r)}else Nu(r)&&((r.f&La)!==0&&this.#s.push(r),es(r));var l=r.first;if(l!==null){r=l;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)r=u.next,u=u.parent}}#a(e){for(const r of e)((r.f&Jr)!==0?this.#h:this.#d).push(r),fr(r,Ft);e.length=0}capture(e,r){this.#l.has(e)||this.#l.set(e,r),this.current.set(e,e.v)}activate(){Ke=this}deactivate(){Ke=null,Ql=null;for(const e of Ow)if(Ow.delete(e),e(),Ke!==null)break}neuter(){this.#c=!0}flush(){to.length>0?aE():this.#f(),Ke===this&&(this.#e===0&&_c.delete(this),this.deactivate())}#f(){if(!this.#c)for(const e of this.#i)e();this.#i.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)fr(e,Jr),_a(e);for(const e of this.#d)fr(e,Ri),_a(e);this.#n=[],this.#t=[],this.flush()}else this.deactivate()}add_callback(e){this.#i.add(e)}settled(){return(this.#u??=wM()).promise}static ensure(){if(Ke===null){const e=Ke=new us;_c.add(Ke),wa||us.enqueue(()=>{Ke===e&&e.flush()})}return Ke}static enqueue(e){fu(e)}}function zM(t){var e=wa;wa=!0;try{for(var r;;){if(LM(),to.length===0&&!kM()&&(Ke?.flush(),to.length===0))return Au=null,r;aE()}}finally{wa=e}}function aE(){var t=Jo;vg=!0;try{var e=0;for(xw(!0);to.length>0;){var r=us.ensure();if(e++>1e3){var n,i;UM()}r.process(to),pi.clear()}}finally{vg=!1,xw(t),Au=null}}function UM(){try{OM()}catch(t){am(t,Au)}}let Ui=null;function Mw(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if((n.f&(gs|ls))===0&&Nu(n)&&(Ui=[],es(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?yE(n):n.fn=null),Ui?.length>0)){pi.clear();for(const i of Ui)es(i);Ui=[]}}Ui=null}}function _a(t){for(var e=Au=t;e.parent!==null;){e=e.parent;var r=e.f;if(vg&&e===Ce&&(r&La)!==0)return;if((r&(lo|Si))!==0){if((r&Ft)===0)return;e.f^=Ft}}to.push(e)}const pi=new Map;function lE(t,e){var r={f:0,v:t,reactions:null,equals:QR,rv:0,wv:0};return r}function er(t,e){const r=lE(t);return sI(r),r}function je(t,e,r=!1){we!==null&&(!mn||(we.f&_w)!==0)&&tE()&&(we.f&(gr|La|om|_w))!==0&&!zn?.includes(t)&&PM();let n=r?la(e):e;return yg(t,n)}function yg(t,e){if(!t.equals(e)){var r=t.v;ms?pi.set(t,e):pi.set(t,r),t.v=e;var n=us.ensure();n.capture(t,r),(t.f&gr)!==0&&((t.f&Jr)!==0&&lm(t),fr(t,(t.f&Hr)===0?Ft:Ri)),t.wv=SE(),uE(t,Jr),Ce!==null&&(Ce.f&Ft)!==0&&(Ce.f&(Si|lo))===0&&(Or===null?aI([t]):Or.push(t))}return e}function Oc(t){je(t,t.v+1)}function uE(t,e){var r=t.reactions;if(r!==null)for(var n=r.length,i=0;i<n;i++){var o=r[i],s=o.f,a=(s&Jr)===0;a&&fr(o,e),(s&gr)!==0?uE(o,Ri):a&&((s&La)!==0&&Ui!==null&&Ui.push(o),_a(o))}}function la(t){if(typeof t!="object"||t===null||pa in t)return t;const e=pM(t);if(e!==gM&&e!==mM)return t;var r=new Map,n=GR(t),i=er(0),o=Qi,s=a=>{if(Qi===o)return a();var l=we,u=Qi;vn(null),Aw(o);var c=a();return vn(l),Aw(u),c};return n&&r.set("length",er(t.length)),new Proxy(t,{defineProperty(a,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&MM();var c=r.get(l);return c===void 0?c=s(()=>{var h=er(u.value);return r.set(l,h),h}):je(c,u.value,!0),!0},deleteProperty(a,l){var u=r.get(l);if(u===void 0){if(l in a){const c=s(()=>er(_t));r.set(l,c),Oc(i)}}else je(u,_t),Oc(i);return!0},get(a,l,u){if(l===pa)return t;var c=r.get(l),h=l in a;if(c===void 0&&(!h||ma(a,l)?.writable)&&(c=s(()=>{var g=la(h?a[l]:_t),w=er(g);return w}),r.set(l,c)),c!==void 0){var d=ue(c);return d===_t?void 0:d}return Reflect.get(a,l,u)},getOwnPropertyDescriptor(a,l){var u=Reflect.getOwnPropertyDescriptor(a,l);if(u&&"value"in u){var c=r.get(l);c&&(u.value=ue(c))}else if(u===void 0){var h=r.get(l),d=h?.v;if(h!==void 0&&d!==_t)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return u},has(a,l){if(l===pa)return!0;var u=r.get(l),c=u!==void 0&&u.v!==_t||Reflect.has(a,l);if(u!==void 0||Ce!==null&&(!c||ma(a,l)?.writable)){u===void 0&&(u=s(()=>{var d=c?la(a[l]):_t,g=er(d);return g}),r.set(l,u));var h=ue(u);if(h===_t)return!1}return c},set(a,l,u,c){var h=r.get(l),d=l in a;if(n&&l==="length")for(var g=u;g<h.v;g+=1){var w=r.get(g+"");w!==void 0?je(w,_t):g in a&&(w=s(()=>er(_t)),r.set(g+"",w))}if(h===void 0)(!d||ma(a,l)?.writable)&&(h=s(()=>er(void 0)),je(h,la(u)),r.set(l,h));else{d=h.v!==_t;var y=s(()=>la(u));je(h,y)}var b=Reflect.getOwnPropertyDescriptor(a,l);if(b?.set&&b.set.call(c,u),!d){if(n&&typeof l=="string"){var E=r.get("length"),v=Number(l);Number.isInteger(v)&&v>=E.v&&je(E,v+1)}Oc(i)}return!0},ownKeys(a){ue(i);var l=Reflect.ownKeys(a).filter(h=>{var d=r.get(h);return d===void 0||d.v!==_t});for(var[u,c]of r)c.v!==_t&&!(u in a)&&l.push(u);return l},setPrototypeOf(){IM()}})}function Iw(t){try{if(t!==null&&typeof t=="object"&&pa in t)return t[pa]}catch{}return t}function YM(t,e){return Object.is(Iw(t),Iw(e))}var bg,cE,hE,dE;function qM(){if(bg===void 0){bg=window,cE=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;hE=ma(e,"firstChild").get,dE=ma(e,"nextSibling").get,Tw(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Tw(r)&&(r.__t=void 0)}}function GM(t=""){return document.createTextNode(t)}function Gi(t){return hE.call(t)}function um(t){return dE.call(t)}function Ht(t,e){return Gi(t)}function KM(t,e){{var r=Gi(t);return r instanceof Comment&&r.data===""?um(r):r}}function vt(t,e=1,r=!1){let n=t;for(;e--;)n=um(n);return n}let Pw=!1;function XM(){Pw||(Pw=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function Du(t){var e=we,r=Ce;vn(null),yi(null);try{return t()}finally{vn(e),yi(r)}}function cm(t,e,r,n=r){t.addEventListener(e,()=>Du(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),XM()}function ZM(t){Ce===null&&we===null&&_M(),we!==null&&(we.f&Hr)!==0&&Ce===null&&TM(),ms&&EM()}function QM(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function uo(t,e,r,n=!0){var i=Ce;i!==null&&(i.f&ls)!==0&&(t|=ls);var o={ctx:Ar,deps:null,nodes_start:null,nodes_end:null,f:t|Jr,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{es(o),o.f|=im}catch(l){throw ro(o),l}else e!==null&&_a(o);if(n){var s=o;if(r&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&(s.f&Fa)===0&&(s=s.first),s!==null&&(s.parent=i,i!==null&&QM(s,i),we!==null&&(we.f&gr)!==0&&(t&lo)===0)){var a=we;(a.effects??=[]).push(s)}}return o}function fE(t){const e=uo(nm,null,!1);return fr(e,Ft),e.teardown=t,e}function JM(t){ZM();var e=Ce.f,r=!we&&(e&Si)!==0&&(e&im)===0;if(r){var n=Ar;(n.e??=[]).push(t)}else return gE(t)}function gE(t){return uo(XR|bM,t,!1)}function eI(t){us.ensure();const e=uo(lo|Fa,t,!0);return(r={})=>new Promise(n=>{r.outro?iI(e,()=>{ro(e),n(void 0)}):(ro(e),n(void 0))})}function tI(t){return uo(om|Fa,t,!0)}function hm(t,e=0){return uo(nm|e,t,!0)}function mE(t,e=[],r=[]){BM(e,r,n=>{uo(nm,()=>t(...n.map(ue)),!0)})}function rI(t,e=!0){return uo(Si|Fa,t,!0,e)}function pE(t){var e=t.teardown;if(e!==null){const r=ms,n=we;Hw(!0),vn(null);try{e.call(null)}finally{Hw(r),vn(n)}}}function wE(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&Du(()=>{i.abort(sm)});var n=r.next;(r.f&lo)!==0?r.parent=null:ro(r,e),r=n}}function nI(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&Si)===0&&ro(e),e=r}}function ro(t,e=!0){var r=!1;(e||(t.f&yM)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(vE(t.nodes_start,t.nodes_end),r=!0),wE(t,e&&!r),gu(t,0),fr(t,gs);var n=t.transitions;if(n!==null)for(const o of n)o.stop();pE(t);var i=t.parent;i!==null&&i.first!==null&&yE(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function vE(t,e){for(;t!==null;){var r=t===e?null:um(t);t.remove(),t=r}}function yE(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function iI(t,e){var r=[];bE(t,r,!0),oI(r,()=>{ro(t),e&&e()})}function oI(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function bE(t,e,r){if((t.f&ls)===0){if(t.f^=ls,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,o=(n.f&vM)!==0||(n.f&Si)!==0;bE(n,e,o?r:!1),n=i}}}let Jo=!1;function xw(t){Jo=t}let ms=!1;function Hw(t){ms=t}let we=null,mn=!1;function vn(t){we=t}let Ce=null;function yi(t){Ce=t}let zn=null;function sI(t){we!==null&&(zn===null?zn=[t]:zn.push(t))}let Lt=null,ur=0,Or=null;function aI(t){Or=t}let CE=1,Oa=0,Qi=Oa;function Aw(t){Qi=t}let ci=!1;function SE(){return++CE}function Nu(t){var e=t.f;if((e&Jr)!==0)return!0;if((e&Ri)!==0){var r=t.deps,n=(e&Hr)!==0;if(r!==null){var i,o,s=(e&cu)!==0,a=n&&Ce!==null&&!ci,l=r.length;if((s||a)&&(Ce===null||(Ce.f&gs)===0)){var u=t,c=u.parent;for(i=0;i<l;i++)o=r[i],(s||!o?.reactions?.includes(u))&&(o.reactions??=[]).push(u);s&&(u.f^=cu),a&&c!==null&&(c.f&Hr)===0&&(u.f^=Hr)}for(i=0;i<l;i++)if(o=r[i],Nu(o)&&oE(o),o.wv>t.wv)return!0}(!n||Ce!==null&&!ci)&&fr(t,Ft)}return!1}function RE(t,e,r=!0){var n=t.reactions;if(n!==null&&!zn?.includes(t))for(var i=0;i<n.length;i++){var o=n[i];(o.f&gr)!==0?RE(o,e,!1):e===o&&(r?fr(o,Jr):(o.f&Ft)!==0&&fr(o,Ri),_a(o))}}function EE(t){var e=Lt,r=ur,n=Or,i=we,o=ci,s=zn,a=Ar,l=mn,u=Qi,c=t.f;Lt=null,ur=0,Or=null,ci=(c&Hr)!==0&&(mn||!Jo||we===null),we=(c&(Si|lo))===0?t:null,zn=null,hu(t.ctx),mn=!1,Qi=++Oa,t.ac!==null&&(Du(()=>{t.ac.abort(sm)}),t.ac=null);try{t.f|=wg;var h=t.fn,d=h(),g=t.deps;if(Lt!==null){var w;if(gu(t,ur),g!==null&&ur>0)for(g.length=ur+Lt.length,w=0;w<Lt.length;w++)g[ur+w]=Lt[w];else t.deps=g=Lt;if(!ci||(c&gr)!==0&&t.reactions!==null)for(w=ur;w<g.length;w++)(g[w].reactions??=[]).push(t)}else g!==null&&ur<g.length&&(gu(t,ur),g.length=ur);if(tE()&&Or!==null&&!mn&&g!==null&&(t.f&(gr|Ri|Jr))===0)for(w=0;w<Or.length;w++)RE(Or[w],t);return i!==null&&i!==t&&(Oa++,Or!==null&&(n===null?n=Or:n.push(...Or))),(t.f&Zi)!==0&&(t.f^=Zi),d}catch(y){return DM(y)}finally{t.f^=wg,Lt=e,ur=r,Or=n,we=i,ci=o,zn=s,hu(a),mn=l,Qi=u}}function lI(t,e){let r=e.reactions;if(r!==null){var n=dM.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&(e.f&gr)!==0&&(Lt===null||!Lt.includes(e))&&(fr(e,Ri),(e.f&(Hr|cu))===0&&(e.f^=cu),iE(e),gu(e,0))}function gu(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)lI(t,r[n])}function es(t){var e=t.f;if((e&gs)===0){fr(t,Ft);var r=Ce,n=Jo;Ce=t,Jo=!0;try{(e&La)!==0?nI(t):wE(t),pE(t);var i=EE(t);t.teardown=typeof i=="function"?i:null,t.wv=CE;var o;qR&&HM&&(t.f&Jr)!==0&&t.deps}finally{Jo=n,Ce=r}}}async function uI(){await Promise.resolve(),zM()}function ue(t){var e=t.f,r=(e&gr)!==0;if(we!==null&&!mn){var n=Ce!==null&&(Ce.f&gs)!==0;if(!n&&!zn?.includes(t)){var i=we.deps;if((we.f&wg)!==0)t.rv<Oa&&(t.rv=Oa,Lt===null&&i!==null&&i[ur]===t?ur++:Lt===null?Lt=[t]:(!ci||!Lt.includes(t))&&Lt.push(t));else{(we.deps??=[]).push(t);var o=t.reactions;o===null?t.reactions=[we]:o.includes(we)||o.push(we)}}}else if(r&&t.deps===null&&t.effects===null){var s=t,a=s.parent;a!==null&&(a.f&Hr)===0&&(s.f^=Hr)}if(ms){if(pi.has(t))return pi.get(t);if(r){s=t;var l=s.v;return((s.f&Ft)===0&&s.reactions!==null||TE(s))&&(l=lm(s)),pi.set(s,l),l}}else r&&(s=t,Nu(s)&&oE(s));if((t.f&Zi)!==0)throw t.v;return t.v}function TE(t){if(t.v===_t)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(pi.has(e)||(e.f&gr)!==0&&TE(e))return!0;return!1}function dm(t){var e=mn;try{return mn=!0,t()}finally{mn=e}}const cI=-7169;function fr(t,e){t.f=t.f&cI|e}const hI=["touchstart","touchmove"];function dI(t){return hI.includes(t)}const _E=new Set,Cg=new Set;function fI(t,e,r,n={}){function i(o){if(n.capture||ua.call(e,o),!o.cancelBubble)return Du(()=>r?.call(this,o))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?fu(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function gI(t,e,r,n,i){var o={capture:n,passive:i},s=fI(t,e,r,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&fE(()=>{e.removeEventListener(t,s,o)})}function mI(t){for(var e=0;e<t.length;e++)_E.add(t[e]);for(var r of Cg)r(t)}let Dw=null;function ua(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],o=i[0]||t.target;Dw=t;var s=0,a=Dw===t&&t.__root;if(a){var l=i.indexOf(a);if(l!==-1&&(e===document||e===window)){t.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(s=l)}if(o=i[s]||t.target,o!==e){pg(t,"currentTarget",{configurable:!0,get(){return o||r}});var c=we,h=Ce;vn(null),yi(null);try{for(var d,g=[];o!==null;){var w=o.assignedSlot||o.parentNode||o.host||null;try{var y=o["__"+n];if(y!=null&&(!o.disabled||t.target===o))if(GR(y)){var[b,...E]=y;b.apply(o,[t,...E])}else y.call(o,t)}catch(v){d?g.push(v):d=v}if(t.cancelBubble||w===e||w===null)break;o=w}if(d){for(let v of g)queueMicrotask(()=>{throw v});throw d}}finally{t.__root=e,delete t.currentTarget,vn(c),yi(h)}}}function OE(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function ME(t,e){var r=Ce;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function pI(t,e){var r=(e&xM)!==0,n,i=!t.startsWith("<!>");return()=>{n===void 0&&(n=OE(i?t:"<!>"+t));var o=r||cE?document.importNode(n,!0):n.cloneNode(!0);{var s=Gi(o),a=o.lastChild;ME(s,a)}return o}}function wI(t,e){t!==null&&t.before(e)}function vI(t,e){return yI(t,e)}const Eo=new Map;function yI(t,{target:e,anchor:r,props:n={},events:i,context:o,intro:s=!0}){qM();var a=new Set,l=h=>{for(var d=0;d<h.length;d++){var g=h[d];if(!a.has(g)){a.add(g);var w=dI(g);e.addEventListener(g,ua,{passive:w});var y=Eo.get(g);y===void 0?(document.addEventListener(g,ua,{passive:w}),Eo.set(g,1)):Eo.set(g,y+1)}}};l(fM(_E)),Cg.add(l);var u=void 0,c=eI(()=>{var h=r??e.appendChild(GM());return rI(()=>{if(o){JR({});var d=Ar;d.c=o}i&&(n.$$events=i),u=t(h,n)||{},o&&eE()}),()=>{for(var d of a){e.removeEventListener(d,ua);var g=Eo.get(d);--g===0?(document.removeEventListener(d,ua),Eo.delete(d)):Eo.set(d,g)}Cg.delete(l),h!==r&&h.parentNode?.removeChild(h)}});return bI.set(u,c),u}let bI=new WeakMap;function CI(t,e,r=!1,n=!1,i=!1){var o=t,s="";mE(()=>{var a=Ce;if(s!==(s=e()??"")&&(a.nodes_start!==null&&(vE(a.nodes_start,a.nodes_end),a.nodes_start=a.nodes_end=null),s!=="")){var l=s+"";r?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=OE(l);if((r||n)&&(u=Gi(u)),ME(Gi(u),u.lastChild),r||n)for(;Gi(u);)o.before(Gi(u));else o.before(u)}})}function SI(t,e,r=e){var n=new WeakSet;cm(t,"input",async i=>{var o=i?t.defaultValue:t.value;if(o=Ic(t)?Pc(o):o,r(o),Ke!==null&&n.add(Ke),await uI(),o!==(o=e())){var s=t.selectionStart,a=t.selectionEnd;t.value=o??"",a!==null&&(t.selectionStart=s,t.selectionEnd=Math.min(a,t.value.length))}}),dm(e)==null&&t.value&&(r(Ic(t)?Pc(t.value):t.value),Ke!==null&&n.add(Ke)),hm(()=>{var i=e();if(t===document.activeElement){var o=Ql??Ke;if(n.has(o))return}Ic(t)&&i===Pc(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}const Mc=new Set;function ol(t,e,r,n,i=n){var o=r.getAttribute("type")==="checkbox",s=t;if(e!==null)for(var a of e)s=s[a]??=[];s.push(r),cm(r,"change",()=>{var l=r.__value;o&&(l=RI(s,l,r.checked)),i(l)},()=>i(o?[]:null)),hm(()=>{var l=n();o?(l=l||[],r.checked=l.includes(r.__value)):r.checked=YM(r.__value,l)}),fE(()=>{var l=s.indexOf(r);l!==-1&&s.splice(l,1)}),Mc.has(s)||(Mc.add(s),fu(()=>{s.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),Mc.delete(s)})),fu(()=>{})}function Nw(t,e,r=e){cm(t,"change",n=>{var i=n?t.defaultChecked:t.checked;r(i)}),dm(e)==null&&r(t.checked),hm(()=>{var n=e();t.checked=!!n})}function RI(t,e,r){for(var n=new Set,i=0;i<t.length;i+=1)t[i].checked&&n.add(t[i].__value);return r||n.delete(e),Array.from(n)}function Ic(t){var e=t.type;return e==="number"||e==="range"}function Pc(t){return t===""?null:+t}function EI(t){Ar===null&&SM(),JM(()=>{const e=dm(t);if(typeof e=="function")return e})}const TI="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(TI);var kw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lw={},Is,Fw;function et(){if(Fw)return Is;Fw=1;var t=function(e){return e&&e.Math===Math&&e};return Is=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof kw=="object"&&kw)||t(typeof Is=="object"&&Is)||function(){return this}()||Function("return this")(),Is}var xc={},Hc,Vw;function st(){return Vw||(Vw=1,Hc=function(t){try{return!!t()}catch{return!0}}),Hc}var Ac,Ww;function Nr(){if(Ww)return Ac;Ww=1;var t=st();return Ac=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Ac}var Dc,$w;function ku(){if($w)return Dc;$w=1;var t=st();return Dc=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Dc}var Nc,Bw;function pt(){if(Bw)return Nc;Bw=1;var t=ku(),e=Function.prototype.call;return Nc=t?e.bind(e):function(){return e.apply(e,arguments)},Nc}var kc={},jw;function _I(){if(jw)return kc;jw=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return kc.f=r?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,kc}var Lc,zw;function Lu(){return zw||(zw=1,Lc=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),Lc}var Fc,Uw;function tt(){if(Uw)return Fc;Uw=1;var t=ku(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return Fc=t?n:function(i){return function(){return r.apply(i,arguments)}},Fc}var Vc,Yw;function co(){if(Yw)return Vc;Yw=1;var t=tt(),e=t({}.toString),r=t("".slice);return Vc=function(n){return r(e(n),8,-1)},Vc}var Wc,qw;function OI(){if(qw)return Wc;qw=1;var t=tt(),e=st(),r=co(),n=Object,i=t("".split);return Wc=e(function(){return!n("z").propertyIsEnumerable(0)})?function(o){return r(o)==="String"?i(o,""):n(o)}:n,Wc}var $c,Gw;function fm(){return Gw||(Gw=1,$c=function(t){return t==null}),$c}var Bc,Kw;function Va(){if(Kw)return Bc;Kw=1;var t=fm(),e=TypeError;return Bc=function(r){if(t(r))throw new e("Can't call method on "+r);return r},Bc}var jc,Xw;function Wa(){if(Xw)return jc;Xw=1;var t=OI(),e=Va();return jc=function(r){return t(e(r))},jc}var zc,Zw;function at(){if(Zw)return zc;Zw=1;var t=typeof document=="object"&&document.all;return zc=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},zc}var Uc,Qw;function kr(){if(Qw)return Uc;Qw=1;var t=at();return Uc=function(e){return typeof e=="object"?e!==null:t(e)},Uc}var Yc,Jw;function ps(){if(Jw)return Yc;Jw=1;var t=et(),e=at(),r=function(n){return e(n)?n:void 0};return Yc=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},Yc}var qc,ev;function $a(){if(ev)return qc;ev=1;var t=tt();return qc=t({}.isPrototypeOf),qc}var Gc,tv;function Fu(){if(tv)return Gc;tv=1;var t=et(),e=t.navigator,r=e&&e.userAgent;return Gc=r?String(r):"",Gc}var Kc,rv;function MI(){if(rv)return Kc;rv=1;var t=et(),e=Fu(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Kc=a,Kc}var Xc,nv;function gm(){if(nv)return Xc;nv=1;var t=MI(),e=st(),r=et(),n=r.String;return Xc=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Xc}var Zc,iv;function IE(){if(iv)return Zc;iv=1;var t=gm();return Zc=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Zc}var Qc,ov;function mm(){if(ov)return Qc;ov=1;var t=ps(),e=at(),r=$a(),n=IE(),i=Object;return Qc=n?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&r(s.prototype,i(o))},Qc}var Jc,sv;function Vu(){if(sv)return Jc;sv=1;var t=String;return Jc=function(e){try{return t(e)}catch{return"Object"}},Jc}var eh,av;function pr(){if(av)return eh;av=1;var t=at(),e=Vu(),r=TypeError;return eh=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},eh}var th,lv;function Ba(){if(lv)return th;lv=1;var t=pr(),e=fm();return th=function(r,n){var i=r[n];return e(i)?void 0:t(i)},th}var rh,uv;function II(){if(uv)return rh;uv=1;var t=pt(),e=at(),r=kr(),n=TypeError;return rh=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!r(a=t(s,i))||e(s=i.valueOf)&&!r(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!r(a=t(s,i)))return a;throw new n("Can't convert object to primitive value")},rh}var nh={exports:{}},ih,cv;function ho(){return cv||(cv=1,ih=!1),ih}var oh,hv;function pm(){if(hv)return oh;hv=1;var t=et(),e=Object.defineProperty;return oh=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},oh}var dv;function wm(){if(dv)return nh.exports;dv=1;var t=ho(),e=et(),r=pm(),n="__core-js_shared__",i=nh.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.43.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"}),nh.exports}var sh,fv;function PE(){if(fv)return sh;fv=1;var t=wm();return sh=function(e,r){return t[e]||(t[e]=r||{})},sh}var ah,gv;function ws(){if(gv)return ah;gv=1;var t=Va(),e=Object;return ah=function(r){return e(t(r))},ah}var lh,mv;function Lr(){if(mv)return lh;mv=1;var t=tt(),e=ws(),r=t({}.hasOwnProperty);return lh=Object.hasOwn||function(i,o){return r(e(i),o)},lh}var uh,pv;function xE(){if(pv)return uh;pv=1;var t=tt(),e=0,r=Math.random(),n=t(1.1.toString);return uh=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},uh}var ch,wv;function rn(){if(wv)return ch;wv=1;var t=et(),e=PE(),r=Lr(),n=xE(),i=gm(),o=IE(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||n;return ch=function(u){return r(a,u)||(a[u]=i&&r(s,u)?s[u]:l("Symbol."+u)),a[u]},ch}var hh,vv;function PI(){if(vv)return hh;vv=1;var t=pt(),e=kr(),r=mm(),n=Ba(),i=II(),o=rn(),s=TypeError,a=o("toPrimitive");return hh=function(l,u){if(!e(l)||r(l))return l;var c=n(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||r(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},hh}var dh,yv;function HE(){if(yv)return dh;yv=1;var t=PI(),e=mm();return dh=function(r){var n=t(r,"string");return e(n)?n:n+""},dh}var fh,bv;function vm(){if(bv)return fh;bv=1;var t=et(),e=kr(),r=t.document,n=e(r)&&e(r.createElement);return fh=function(i){return n?r.createElement(i):{}},fh}var gh,Cv;function AE(){if(Cv)return gh;Cv=1;var t=Nr(),e=st(),r=vm();return gh=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),gh}var Sv;function DE(){if(Sv)return xc;Sv=1;var t=Nr(),e=pt(),r=_I(),n=Lu(),i=Wa(),o=HE(),s=Lr(),a=AE(),l=Object.getOwnPropertyDescriptor;return xc.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return n(!e(r.f,c,h),c[h])},xc}var mh={},ph,Rv;function NE(){if(Rv)return ph;Rv=1;var t=Nr(),e=st();return ph=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),ph}var wh,Ev;function wt(){if(Ev)return wh;Ev=1;var t=kr(),e=String,r=TypeError;return wh=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},wh}var Tv;function Ei(){if(Tv)return mh;Tv=1;var t=Nr(),e=AE(),r=NE(),n=wt(),i=HE(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return mh.f=t?r?function(d,g,w){if(n(d),g=i(g),n(w),typeof d=="function"&&g==="prototype"&&"value"in w&&c in w&&!w[c]){var y=a(d,g);y&&y[c]&&(d[g]=w.value,w={configurable:u in w?w[u]:y[u],enumerable:l in w?w[l]:y[l],writable:!1})}return s(d,g,w)}:s:function(d,g,w){if(n(d),g=i(g),n(w),e)try{return s(d,g,w)}catch{}if("get"in w||"set"in w)throw new o("Accessors not supported");return"value"in w&&(d[g]=w.value),d},mh}var vh,_v;function vs(){if(_v)return vh;_v=1;var t=Nr(),e=Ei(),r=Lu();return vh=t?function(n,i,o){return e.f(n,i,r(1,o))}:function(n,i,o){return n[i]=o,n},vh}var yh={exports:{}},bh,Ov;function xI(){if(Ov)return bh;Ov=1;var t=Nr(),e=Lr(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&n(r,"name").configurable);return bh={EXISTS:i,PROPER:o,CONFIGURABLE:s},bh}var Ch,Mv;function HI(){if(Mv)return Ch;Mv=1;var t=tt(),e=at(),r=wm(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),Ch=r.inspectSource,Ch}var Sh,Iv;function AI(){if(Iv)return Sh;Iv=1;var t=et(),e=at(),r=t.WeakMap;return Sh=e(r)&&/native code/.test(String(r)),Sh}var Rh,Pv;function ym(){if(Pv)return Rh;Pv=1;var t=PE(),e=xE(),r=t("keys");return Rh=function(n){return r[n]||(r[n]=e(n))},Rh}var Eh,xv;function bm(){return xv||(xv=1,Eh={}),Eh}var Th,Hv;function kE(){if(Hv)return Th;Hv=1;var t=AI(),e=et(),r=kr(),n=vs(),i=Lr(),o=wm(),s=ym(),a=bm(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,g,w=function(v){return g(v)?d(v):h(v,{})},y=function(v){return function(T){var _;if(!r(T)||(_=d(T)).type!==v)throw new u("Incompatible receiver, "+v+" required");return _}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(v,T){if(b.has(v))throw new u(l);return T.facade=v,b.set(v,T),T},d=function(v){return b.get(v)||{}},g=function(v){return b.has(v)}}else{var E=s("state");a[E]=!0,h=function(v,T){if(i(v,E))throw new u(l);return T.facade=v,n(v,E,T),T},d=function(v){return i(v,E)?v[E]:{}},g=function(v){return i(v,E)}}return Th={set:h,get:d,has:g,enforce:w,getterFor:y},Th}var Av;function LE(){if(Av)return yh.exports;Av=1;var t=tt(),e=st(),r=at(),n=Lr(),i=Nr(),o=xI().CONFIGURABLE,s=HI(),a=kE(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),g=t("".replace),w=t([].join),y=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),E=yh.exports=function(v,T,_){d(c(T),0,7)==="Symbol("&&(T="["+g(c(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),_&&_.getter&&(T="get "+T),_&&_.setter&&(T="set "+T),(!n(v,"name")||o&&v.name!==T)&&(i?h(v,"name",{value:T,configurable:!0}):v.name=T),y&&_&&n(_,"arity")&&v.length!==_.arity&&h(v,"length",{value:_.arity});try{_&&n(_,"constructor")&&_.constructor?i&&h(v,"prototype",{writable:!1}):v.prototype&&(v.prototype=void 0)}catch{}var M=l(v);return n(M,"source")||(M.source=w(b,typeof T=="string"?T:"")),v};return Function.prototype.toString=E(function(){return r(this)&&u(this).source||s(this)},"toString"),yh.exports}var _h,Dv;function Cm(){if(Dv)return _h;Dv=1;var t=at(),e=Ei(),r=LE(),n=pm();return _h=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&r(s,u,a),a.global)l?i[o]=s:n(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},_h}var Oh={},Mh,Nv;function DI(){if(Nv)return Mh;Nv=1;var t=Math.ceil,e=Math.floor;return Mh=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},Mh}var Ih,kv;function ja(){if(kv)return Ih;kv=1;var t=DI();return Ih=function(e){var r=+e;return r!==r||r===0?0:t(r)},Ih}var Ph,Lv;function NI(){if(Lv)return Ph;Lv=1;var t=ja(),e=Math.max,r=Math.min;return Ph=function(n,i){var o=t(n);return o<0?e(o+i,0):r(o,i)},Ph}var xh,Fv;function kI(){if(Fv)return xh;Fv=1;var t=ja(),e=Math.min;return xh=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},xh}var Hh,Vv;function ys(){if(Vv)return Hh;Vv=1;var t=kI();return Hh=function(e){return t(e.length)},Hh}var Ah,Wv;function LI(){if(Wv)return Ah;Wv=1;var t=Wa(),e=NI(),r=ys(),n=function(i){return function(o,s,a){var l=t(o),u=r(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return Ah={includes:n(!0),indexOf:n(!1)},Ah}var Dh,$v;function FE(){if($v)return Dh;$v=1;var t=tt(),e=Lr(),r=Wa(),n=LI().indexOf,i=bm(),o=t([].push);return Dh=function(s,a){var l=r(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~n(c,h)||o(c,h));return c},Dh}var Nh,Bv;function Sm(){return Bv||(Bv=1,Nh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Nh}var jv;function FI(){if(jv)return Oh;jv=1;var t=FE(),e=Sm(),r=e.concat("length","prototype");return Oh.f=Object.getOwnPropertyNames||function(i){return t(i,r)},Oh}var kh={},zv;function VI(){return zv||(zv=1,kh.f=Object.getOwnPropertySymbols),kh}var Lh,Uv;function WI(){if(Uv)return Lh;Uv=1;var t=ps(),e=tt(),r=FI(),n=VI(),i=wt(),o=e([].concat);return Lh=t("Reflect","ownKeys")||function(a){var l=r.f(i(a)),u=n.f;return u?o(l,u(a)):l},Lh}var Fh,Yv;function VE(){if(Yv)return Fh;Yv=1;var t=Lr(),e=WI(),r=DE(),n=Ei();return Fh=function(i,o,s){for(var a=e(o),l=n.f,u=r.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},Fh}var Vh,qv;function $I(){if(qv)return Vh;qv=1;var t=st(),e=at(),r=/#|\.prototype\./,n=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=n.normalize=function(l){return String(l).replace(r,".").toLowerCase()},o=n.data={},s=n.NATIVE="N",a=n.POLYFILL="P";return Vh=n,Vh}var Wh,Gv;function Le(){if(Gv)return Wh;Gv=1;var t=et(),e=DE().f,r=vs(),n=Cm(),i=pm(),o=VE(),s=$I();return Wh=function(a,l){var u=a.target,c=a.global,h=a.stat,d,g,w,y,b,E;if(c?g=t:h?g=t[u]||i(u,{}):g=t[u]&&t[u].prototype,g)for(w in l){if(b=l[w],a.dontCallGetSet?(E=e(g,w),y=E&&E.value):y=g[w],d=s(c?w:u+(h?".":"#")+w,a.forced),!d&&y!==void 0){if(typeof b==typeof y)continue;o(b,y)}(a.sham||y&&y.sham)&&r(b,"sham",!0),n(g,w,b,a)}},Wh}var $h,Kv;function za(){if(Kv)return $h;Kv=1;var t=ku(),e=Function.prototype,r=e.apply,n=e.call;return $h=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),$h}var Bh,Xv;function WE(){if(Xv)return Bh;Xv=1;var t=tt(),e=pr();return Bh=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},Bh}var jh,Zv;function BI(){if(Zv)return jh;Zv=1;var t=kr();return jh=function(e){return t(e)||e===null},jh}var zh,Qv;function jI(){if(Qv)return zh;Qv=1;var t=BI(),e=String,r=TypeError;return zh=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},zh}var Uh,Jv;function $E(){if(Jv)return Uh;Jv=1;var t=WE(),e=kr(),r=Va(),n=jI();return Uh=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return r(l),n(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),Uh}var Yh,ey;function zI(){if(ey)return Yh;ey=1;var t=Ei().f;return Yh=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},Yh}var qh,ty;function UI(){if(ty)return qh;ty=1;var t=at(),e=kr(),r=$E();return qh=function(n,i,o){var s,a;return r&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&r(n,a),n},qh}var Gh,ry;function YI(){if(ry)return Gh;ry=1;var t=rn(),e=t("toStringTag"),r={};return r[e]="z",Gh=String(r)==="[object z]",Gh}var Kh,ny;function BE(){if(ny)return Kh;ny=1;var t=YI(),e=at(),r=co(),n=rn(),i=n("toStringTag"),o=Object,s=r(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return Kh=t?r:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?r(u):(h=r(u))==="Object"&&e(u.callee)?"Arguments":h},Kh}var Xh,iy;function Wu(){if(iy)return Xh;iy=1;var t=BE(),e=String;return Xh=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},Xh}var Zh,oy;function qI(){if(oy)return Zh;oy=1;var t=Wu();return Zh=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Zh}var Qh,sy;function GI(){if(sy)return Qh;sy=1;var t=kr(),e=vs();return Qh=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},Qh}var Jh,ay;function KI(){if(ay)return Jh;ay=1;var t=tt(),e=Error,r=t("".replace),n=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(n);return Jh=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=r(s,i,"");return s},Jh}var ed,ly;function XI(){if(ly)return ed;ly=1;var t=st(),e=Lu();return ed=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),ed}var td,uy;function ZI(){if(uy)return td;uy=1;var t=vs(),e=KI(),r=XI(),n=Error.captureStackTrace;return td=function(i,o,s,a){r&&(n?n(i,o):t(i,"stack",e(s,a)))},td}var rd,cy;function QI(){if(cy)return rd;cy=1;var t=ps(),e=Lr(),r=vs(),n=$a(),i=$E(),o=VE(),s=zI(),a=UI(),l=qI(),u=GI(),c=ZI(),h=Nr(),d=ho();return rd=function(g,w,y,b){var E="stackTraceLimit",v=b?2:1,T=g.split("."),_=T[T.length-1],M=t.apply(null,T);if(M){var P=M.prototype;if(!d&&e(P,"cause")&&delete P.cause,!y)return M;var x=t("Error"),F=w(function(U,H){var G=l(b?H:U,void 0),J=b?new M(U):new M;return G!==void 0&&r(J,"message",G),c(J,F,J.stack,2),this&&n(P,this)&&a(J,this,F),arguments.length>v&&u(J,arguments[v]),J});if(F.prototype=P,_!=="Error"?i?i(F,x):o(F,x,{name:!0}):h&&E in M&&(s(F,M,E),s(F,M,"prepareStackTrace")),o(F,M),!d)try{P.name!==_&&r(P,"name",_),P.constructor=F}catch{}return F}},rd}var hy;function JI(){if(hy)return Lw;hy=1;var t=Le(),e=et(),r=za(),n=QI(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=n(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=n(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return r(u,this,arguments)}}),a("EvalError",function(u){return function(h){return r(u,this,arguments)}}),a("RangeError",function(u){return function(h){return r(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return r(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return r(u,this,arguments)}}),a("TypeError",function(u){return function(h){return r(u,this,arguments)}}),a("URIError",function(u){return function(h){return r(u,this,arguments)}}),l("CompileError",function(u){return function(h){return r(u,this,arguments)}}),l("LinkError",function(u){return function(h){return r(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return r(u,this,arguments)}}),Lw}JI();var dy={},nd,fy;function jE(){if(fy)return nd;fy=1;var t=co();return nd=Array.isArray||function(r){return t(r)==="Array"},nd}var id,gy;function zE(){if(gy)return id;gy=1;var t=Nr(),e=jE(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return id=i?function(o,s){if(e(o)&&!n(o,"length").writable)throw new r("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},id}var od,my;function UE(){if(my)return od;my=1;var t=TypeError,e=9007199254740991;return od=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},od}var py;function eP(){if(py)return dy;py=1;var t=Le(),e=ws(),r=ys(),n=zE(),i=UE(),o=st(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=r(h),g=arguments.length;i(d+g);for(var w=0;w<g;w++)h[d]=arguments[w],d++;return n(h,d),d}}),dy}eP();var wy={},sd,vy;function tP(){if(vy)return sd;vy=1;var t=co(),e=tt();return sd=function(r){if(t(r)==="Function")return e(r)},sd}var ad,yy;function YE(){if(yy)return ad;yy=1;var t=tP(),e=pr(),r=ku(),n=t(t.bind);return ad=function(i,o){return e(i),o===void 0?i:r?n(i,o):function(){return i.apply(o,arguments)}},ad}var ld,by;function qE(){return by||(by=1,ld={}),ld}var ud,Cy;function rP(){if(Cy)return ud;Cy=1;var t=rn(),e=qE(),r=t("iterator"),n=Array.prototype;return ud=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},ud}var cd,Sy;function GE(){if(Sy)return cd;Sy=1;var t=BE(),e=Ba(),r=fm(),n=qE(),i=rn(),o=i("iterator");return cd=function(s){if(!r(s))return e(s,o)||e(s,"@@iterator")||n[t(s)]},cd}var hd,Ry;function nP(){if(Ry)return hd;Ry=1;var t=pt(),e=pr(),r=wt(),n=Vu(),i=GE(),o=TypeError;return hd=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return r(t(l,s));throw new o(n(s)+" is not iterable")},hd}var dd,Ey;function wr(){if(Ey)return dd;Ey=1;var t=pt(),e=wt(),r=Ba();return dd=function(n,i,o){var s,a;e(n);try{if(s=r(n,"return"),!s){if(i==="throw")throw o;return o}s=t(s,n)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},dd}var fd,Ty;function bs(){if(Ty)return fd;Ty=1;var t=YE(),e=pt(),r=wt(),n=Vu(),i=rP(),o=ys(),s=$a(),a=nP(),l=GE(),u=wr(),c=TypeError,h=function(g,w){this.stopped=g,this.result=w},d=h.prototype;return fd=function(g,w,y){var b=y&&y.that,E=!!(y&&y.AS_ENTRIES),v=!!(y&&y.IS_RECORD),T=!!(y&&y.IS_ITERATOR),_=!!(y&&y.INTERRUPTED),M=t(w,b),P,x,F,U,H,G,J,ae=function(ee){return P&&u(P,"normal"),new h(!0,ee)},q=function(ee){return E?(r(ee),_?M(ee[0],ee[1],ae):M(ee[0],ee[1])):_?M(ee,ae):M(ee)};if(v)P=g.iterator;else if(T)P=g;else{if(x=l(g),!x)throw new c(n(g)+" is not iterable");if(i(x)){for(F=0,U=o(g);U>F;F++)if(H=q(g[F]),H&&s(d,H))return H;return new h(!1)}P=a(g,x)}for(G=v?g.next:P.next;!(J=e(G,P)).done;){try{H=q(J.value)}catch(ee){u(P,"throw",ee)}if(typeof H=="object"&&H&&s(d,H))return H}return new h(!1)},fd}var gd,_y;function KE(){if(_y)return gd;_y=1;var t=Nr(),e=Ei(),r=Lu();return gd=function(n,i,o){t?e.f(n,i,r(0,o)):n[i]=o},gd}var Oy;function iP(){if(Oy)return wy;Oy=1;var t=Le(),e=bs(),r=KE();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){r(o,s,a)},{AS_ENTRIES:!0}),o}}),wy}iP();var My={},md,Iy;function Rn(){if(Iy)return md;Iy=1;var t=tt(),e=Set.prototype;return md={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},md}var pd,Py;function fo(){if(Py)return pd;Py=1;var t=Rn().has;return pd=function(e){return t(e),e},pd}var wd,xy;function go(){if(xy)return wd;xy=1;var t=pt();return wd=function(e,r,n){for(var i=n?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=r(s.value),a!==void 0)return a},wd}var vd,Hy;function Ua(){if(Hy)return vd;Hy=1;var t=tt(),e=go(),r=Rn(),n=r.Set,i=r.proto,o=t(i.forEach),s=t(i.keys),a=s(new n).next;return vd=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},vd}var yd,Ay;function Rm(){if(Ay)return yd;Ay=1;var t=Rn(),e=Ua(),r=t.Set,n=t.add;return yd=function(i){var o=new r;return e(i,function(s){n(o,s)}),o},yd}var bd,Dy;function Ya(){if(Dy)return bd;Dy=1;var t=WE(),e=Rn();return bd=t(e.proto,"size","get")||function(r){return r.size},bd}var Cd,Ny;function Ti(){return Ny||(Ny=1,Cd=function(t){return{iterator:t,next:t.next,done:!1}}),Cd}var Sd,ky;function mo(){if(ky)return Sd;ky=1;var t=pr(),e=wt(),r=pt(),n=ja(),i=Ti(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(c){return r(this.has,this.set,c)}},Sd=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=n(h);if(d<0)throw new s(o);return new u(c,d)},Sd}var Rd,Ly;function oP(){if(Ly)return Rd;Ly=1;var t=fo(),e=Rn(),r=Rm(),n=Ya(),i=mo(),o=Ua(),s=go(),a=e.has,l=e.remove;return Rd=function(c){var h=t(this),d=i(c),g=r(h);return n(h)<=d.size?o(h,function(w){d.includes(w)&&l(g,w)}):s(d.getIterator(),function(w){a(g,w)&&l(g,w)}),g},Rd}var Ed,Fy;function po(){if(Fy)return Ed;Fy=1;var t=ps(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Ed=function(n,i){var o=t("Set");try{new o()[n](e(0));try{return new o()[n](e(-1)),!1}catch{if(!i)return!0;try{return new o()[n](r(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[n](r(1/0)))}}}catch{return!1}},Ed}var Vy;function sP(){if(Vy)return My;Vy=1;var t=Le(),e=oP(),r=st(),n=po(),i=!n("difference",function(s){return s.size===0}),o=i||r(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),My}sP();var Wy={},Td,$y;function aP(){if($y)return Td;$y=1;var t=fo(),e=Rn(),r=Ya(),n=mo(),i=Ua(),o=go(),s=e.Set,a=e.add,l=e.has;return Td=function(c){var h=t(this),d=n(c),g=new s;return r(h)>d.size?o(d.getIterator(),function(w){l(h,w)&&a(g,w)}):i(h,function(w){d.includes(w)&&a(g,w)}),g},Td}var By;function lP(){if(By)return Wy;By=1;var t=Le(),e=st(),r=aP(),n=po(),i=!n("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),Wy}lP();var jy={},_d,zy;function uP(){if(zy)return _d;zy=1;var t=fo(),e=Rn().has,r=Ya(),n=mo(),i=Ua(),o=go(),s=wr();return _d=function(l){var u=t(this),c=n(l);if(r(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},_d}var Uy;function cP(){if(Uy)return jy;Uy=1;var t=Le(),e=uP(),r=po(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),jy}cP();var Yy={},Od,qy;function hP(){if(qy)return Od;qy=1;var t=fo(),e=Ya(),r=Ua(),n=mo();return Od=function(o){var s=t(this),a=n(o);return e(s)>a.size?!1:r(s,function(l){if(!a.includes(l))return!1},!0)!==!1},Od}var Gy;function dP(){if(Gy)return Yy;Gy=1;var t=Le(),e=hP(),r=po(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),Yy}dP();var Ky={},Md,Xy;function fP(){if(Xy)return Md;Xy=1;var t=fo(),e=Rn().has,r=Ya(),n=mo(),i=go(),o=wr();return Md=function(a){var l=t(this),u=n(a);if(r(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},Md}var Zy;function gP(){if(Zy)return Ky;Zy=1;var t=Le(),e=fP(),r=po(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),Ky}gP();var Qy={},Id,Jy;function mP(){if(Jy)return Id;Jy=1;var t=fo(),e=Rn(),r=Rm(),n=mo(),i=go(),o=e.add,s=e.has,a=e.remove;return Id=function(u){var c=t(this),h=n(u).getIterator(),d=r(c);return i(h,function(g){s(c,g)?a(d,g):o(d,g)}),d},Id}var Pd,eb;function XE(){return eb||(eb=1,Pd=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size!==1||n.values().next().value!==4}catch{return!1}}),Pd}var tb;function pP(){if(tb)return Qy;tb=1;var t=Le(),e=mP(),r=XE(),n=po(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),Qy}pP();var rb={},xd,nb;function wP(){if(nb)return xd;nb=1;var t=fo(),e=Rn().add,r=Rm(),n=mo(),i=go();return xd=function(s){var a=t(this),l=n(s).getIterator(),u=r(a);return i(l,function(c){e(u,c)}),u},xd}var ib;function vP(){if(ib)return rb;ib=1;var t=Le(),e=wP(),r=XE(),n=po(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),rb}vP();var ob={},sb={},Hd,ab;function yP(){if(ab)return Hd;ab=1;var t=$a(),e=TypeError;return Hd=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},Hd}var Ad,lb;function bP(){if(lb)return Ad;lb=1;var t=st();return Ad=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Ad}var Dd,ub;function ZE(){if(ub)return Dd;ub=1;var t=Lr(),e=at(),r=ws(),n=ym(),i=bP(),o=n("IE_PROTO"),s=Object,a=s.prototype;return Dd=i?s.getPrototypeOf:function(l){var u=r(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},Dd}var Nd,cb;function CP(){if(cb)return Nd;cb=1;var t=LE(),e=Ei();return Nd=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},Nd}var kd={},Ld,hb;function SP(){if(hb)return Ld;hb=1;var t=FE(),e=Sm();return Ld=Object.keys||function(n){return t(n,e)},Ld}var db;function RP(){if(db)return kd;db=1;var t=Nr(),e=NE(),r=Ei(),n=wt(),i=Wa(),o=SP();return kd.f=t&&!e?Object.defineProperties:function(a,l){n(a);for(var u=i(l),c=o(l),h=c.length,d=0,g;h>d;)r.f(a,g=c[d++],u[g]);return a},kd}var Fd,fb;function QE(){if(fb)return Fd;fb=1;var t=ps();return Fd=t("document","documentElement"),Fd}var Vd,gb;function Em(){if(gb)return Vd;gb=1;var t=wt(),e=RP(),r=Sm(),n=bm(),i=QE(),o=vm(),s=ym(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},g=function(v){return l+c+a+v+l+"/"+c+a},w=function(v){v.write(g("")),v.close();var T=v.parentWindow.Object;return v=null,T},y=function(){var v=o("iframe"),T="java"+c+":",_;return v.style.display="none",i.appendChild(v),v.src=String(T),_=v.contentWindow.document,_.open(),_.write(g("document.F=Object")),_.close(),_.F},b,E=function(){try{b=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&b?w(b):y():w(b);for(var v=r.length;v--;)delete E[u][r[v]];return E()};return n[h]=!0,Vd=Object.create||function(T,_){var M;return T!==null?(d[u]=t(T),M=new d,d[u]=null,M[h]=T):M=E(),_===void 0?M:e.f(M,_)},Vd}var Wd,mb;function JE(){if(mb)return Wd;mb=1;var t=st(),e=at(),r=kr(),n=Em(),i=ZE(),o=Cm(),s=rn(),a=ho(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var g=!r(c)||t(function(){var w={};return c[l].call(w)!==w});return g?c={}:a&&(c=n(c)),e(c[l])||o(c,l,function(){return this}),Wd={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},Wd}var pb;function EP(){if(pb)return sb;pb=1;var t=Le(),e=et(),r=yP(),n=wt(),i=at(),o=ZE(),s=CP(),a=KE(),l=st(),u=Lr(),c=rn(),h=JE().IteratorPrototype,d=Nr(),g=ho(),w="constructor",y="Iterator",b=c("toStringTag"),E=TypeError,v=e[y],T=g||!i(v)||v.prototype!==h||!l(function(){v({})}),_=function(){if(r(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},M=function(P,x){d?s(h,P,{configurable:!0,get:function(){return x},set:function(F){if(n(this),this===h)throw new E("You can't redefine this property");u(this,P)?this[P]=F:a(this,P,F)}}):h[P]=x};return u(h,b)||M(b,y),(T||!u(h,w)||h[w]===Object)&&M(w,_),_.prototype=h,t({global:!0,constructor:!0,forced:T},{Iterator:_}),sb}var wb;function TP(){return wb||(wb=1,EP()),ob}TP();var vb={},yb={},$d,bb;function _P(){if(bb)return $d;bb=1;var t=Cm();return $d=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},$d}var Bd,Cb;function OP(){return Cb||(Cb=1,Bd=function(t,e){return{value:t,done:e}}),Bd}var jd,Sb;function MP(){if(Sb)return jd;Sb=1;var t=wr();return jd=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(o){r="throw",n=o}if(r==="throw")throw n;return n},jd}var zd,Rb;function eT(){if(Rb)return zd;Rb=1;var t=pt(),e=Em(),r=vs(),n=_P(),i=rn(),o=kE(),s=Ba(),a=JE().IteratorPrototype,l=OP(),u=wr(),c=MP(),h=i("toStringTag"),d="IteratorHelper",g="WrapForValidIterator",w="normal",y="throw",b=o.set,E=function(_){var M=o.getterFor(_?g:d);return n(e(a),{next:function(){var x=M(this);if(_)return x.nextHandler();if(x.done)return l(void 0,!0);try{var F=x.nextHandler();return x.returnHandlerResult?F:l(F,x.done)}catch(U){throw x.done=!0,U}},return:function(){var P=M(this),x=P.iterator;if(P.done=!0,_){var F=s(x,"return");return F?t(F,x):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,w)}catch(U){return u(x,y,U)}if(P.openIters)try{c(P.openIters,w)}catch(U){return u(x,y,U)}return x&&u(x,w),l(void 0,!0)}})},v=E(!0),T=E(!1);return r(T,h,"Iterator Helper"),zd=function(_,M,P){var x=function(U,H){H?(H.iterator=U.iterator,H.next=U.next):H=U,H.type=M?g:d,H.returnHandlerResult=!!P,H.nextHandler=_,H.counter=0,H.done=!1,b(this,H)};return x.prototype=M?v:T,x},zd}var Ud,Eb;function tT(){if(Eb)return Ud;Eb=1;var t=wt(),e=wr();return Ud=function(r,n,i,o){try{return o?n(t(i)[0],i[1]):n(i)}catch(s){e(r,"throw",s)}},Ud}var Yd,Tb;function rT(){return Tb||(Tb=1,Yd=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),Yd}var qd,_b;function wo(){if(_b)return qd;_b=1;var t=et();return qd=function(e,r){var n=t.Iterator,i=n&&n.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof r||(s=!1)}if(!s)return o},qd}var Ob;function IP(){if(Ob)return yb;Ob=1;var t=Le(),e=pt(),r=pr(),n=wt(),i=Ti(),o=eT(),s=tT(),a=ho(),l=wr(),u=rT(),c=wo(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),g=a||h||d,w=o(function(){for(var y=this.iterator,b=this.predicate,E=this.next,v,T,_;;){if(v=n(e(E,y)),T=this.done=!!v.done,T)return;if(_=v.value,s(y,b,[_,this.counter++],!0))return _}});return t({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(b){n(this);try{r(b)}catch(E){l(this,"throw",E)}return d?e(d,this,b):new w(i(this),{predicate:b})}}),yb}var Mb;function PP(){return Mb||(Mb=1,IP()),vb}PP();var Ib={},Pb={},xb;function xP(){if(xb)return Pb;xb=1;var t=Le(),e=pt(),r=bs(),n=pr(),i=wt(),o=Ti(),s=wr(),a=wo(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;r(h,function(g){c(g,d++)},{IS_RECORD:!0})}}),Pb}var Hb;function HP(){return Hb||(Hb=1,xP()),Ib}HP();var Ab={},Db={},Nb;function AP(){if(Nb)return Db;Nb=1;var t=Le(),e=pt(),r=pr(),n=wt(),i=Ti(),o=eT(),s=tT(),a=wr(),l=rT(),u=wo(),c=ho(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),g=c||h||d,w=o(function(){var y=this.iterator,b=n(e(this.next,y)),E=this.done=!!b.done;if(!E)return s(y,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(b){n(this);try{r(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new w(i(this),{mapper:b})}}),Db}var kb;function DP(){return kb||(kb=1,AP()),Ab}DP();var Lb={},Fb={},Gd,Vb;function Tm(){if(Vb)return Gd;Vb=1;var t=tt();return Gd=t([].slice),Gd}var Kd,Wb;function nT(){if(Wb)return Kd;Wb=1;var t=TypeError;return Kd=function(e,r){if(e<r)throw new t("Not enough arguments");return e},Kd}var Xd,$b;function NP(){if($b)return Xd;$b=1;var t=Fu();return Xd=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),Xd}var Zd,Bb;function iT(){if(Bb)return Zd;Bb=1;var t=et(),e=Fu(),r=co(),n=function(i){return e.slice(0,i.length)===i};return Zd=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),Zd}var Qd,jb;function kP(){if(jb)return Qd;jb=1;var t=iT();return Qd=t==="NODE",Qd}var Jd,zb;function oT(){if(zb)return Jd;zb=1;var t=et(),e=za(),r=YE(),n=at(),i=Lr(),o=st(),s=QE(),a=Tm(),l=vm(),u=nT(),c=NP(),h=kP(),d=t.setImmediate,g=t.clearImmediate,w=t.process,y=t.Dispatch,b=t.Function,E=t.MessageChannel,v=t.String,T=0,_={},M="onreadystatechange",P,x,F,U;o(function(){P=t.location});var H=function(q){if(i(_,q)){var ee=_[q];delete _[q],ee()}},G=function(q){return function(){H(q)}},J=function(q){H(q.data)},ae=function(q){t.postMessage(v(q),P.protocol+"//"+P.host)};return(!d||!g)&&(d=function(ee){u(arguments.length,1);var lt=n(ee)?ee:b(ee),Ee=a(arguments,1);return _[++T]=function(){e(lt,void 0,Ee)},x(T),T},g=function(ee){delete _[ee]},h?x=function(q){w.nextTick(G(q))}:y&&y.now?x=function(q){y.now(G(q))}:E&&!c?(F=new E,U=F.port2,F.port1.onmessage=J,x=r(U.postMessage,U)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!o(ae)?(x=ae,t.addEventListener("message",J,!1)):M in l("script")?x=function(q){s.appendChild(l("script"))[M]=function(){s.removeChild(this),H(q)}}:x=function(q){setTimeout(G(q),0)}),Jd={set:d,clear:g},Jd}var Ub;function LP(){if(Ub)return Fb;Ub=1;var t=Le(),e=et(),r=oT().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),Fb}var Yb={},ef,qb;function FP(){if(qb)return ef;qb=1;var t=et(),e=za(),r=at(),n=iT(),i=Fu(),o=Tm(),s=nT(),a=t.Function,l=/MSIE .\./.test(i)||n==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return ef=function(u,c){var h=c?2:1;return l?function(d,g){var w=s(arguments.length,1)>h,y=r(d)?d:a(d),b=w?o(arguments,h):[],E=w?function(){e(y,this,b)}:y;return c?u(E,g):u(E)}:u},ef}var Gb;function VP(){if(Gb)return Yb;Gb=1;var t=Le(),e=et(),r=oT().set,n=FP(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),Yb}var Kb;function WP(){return Kb||(Kb=1,LP(),VP()),Lb}WP();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:sT,setPrototypeOf:Xb,isFrozen:$P,getPrototypeOf:BP,getOwnPropertyDescriptor:jP}=Object;let{freeze:Wt,seal:Dr,create:aT}=Object,{apply:Sg,construct:Rg}=typeof Reflect<"u"&&Reflect;Wt||(Wt=function(e){return e});Dr||(Dr=function(e){return e});Sg||(Sg=function(e,r,n){return e.apply(r,n)});Rg||(Rg=function(e,r){return new e(...r)});const sl=$t(Array.prototype.forEach),zP=$t(Array.prototype.lastIndexOf),Zb=$t(Array.prototype.pop),Ps=$t(Array.prototype.push),UP=$t(Array.prototype.splice),Jl=$t(String.prototype.toLowerCase),tf=$t(String.prototype.toString),Qb=$t(String.prototype.match),xs=$t(String.prototype.replace),YP=$t(String.prototype.indexOf),qP=$t(String.prototype.trim),Gr=$t(Object.prototype.hasOwnProperty),At=$t(RegExp.prototype.test),Hs=GP(TypeError);function $t(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return Sg(t,e,n)}}function GP(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Rg(t,r)}}function he(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jl;Xb&&Xb(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const o=r(i);o!==i&&($P(e)||(e[n]=o),i=o)}t[i]=!0}return t}function KP(t){for(let e=0;e<t.length;e++)Gr(t,e)||(t[e]=null);return t}function Vn(t){const e=aT(null);for(const[r,n]of sT(t))Gr(t,r)&&(Array.isArray(n)?e[r]=KP(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Vn(n):e[r]=n);return e}function As(t,e){for(;t!==null;){const n=jP(t,e);if(n){if(n.get)return $t(n.get);if(typeof n.value=="function")return $t(n.value)}t=BP(t)}function r(){return null}return r}const Jb=Wt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),rf=Wt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nf=Wt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),XP=Wt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),of=Wt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ZP=Wt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),eC=Wt(["#text"]),tC=Wt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),sf=Wt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rC=Wt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),al=Wt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),QP=Dr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),JP=Dr(/<%[\w\W]*|[\w\W]*%>/gm),ex=Dr(/\$\{[\w\W]*/gm),tx=Dr(/^data-[\-\w.\u00B7-\uFFFF]+$/),rx=Dr(/^aria-[\-\w]+$/),lT=Dr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),nx=Dr(/^(?:\w+script|data):/i),ix=Dr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),uT=Dr(/^html$/i),ox=Dr(/^[a-z][.\w]*(-[.\w]+)+$/i);var nC=Object.freeze({__proto__:null,ARIA_ATTR:rx,ATTR_WHITESPACE:ix,CUSTOM_ELEMENT:ox,DATA_ATTR:tx,DOCTYPE_NAME:uT,ERB_EXPR:JP,IS_ALLOWED_URI:lT,IS_SCRIPT_OR_DATA:nx,MUSTACHE_EXPR:QP,TMPLIT_EXPR:ex});const Ds={element:1,text:3,progressingInstruction:7,comment:8,document:9},sx=function(){return typeof window>"u"?null:window},ax=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},iC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function cT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sx();const e=K=>cT(K);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==Ds.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:g}=t,w=l.prototype,y=As(w,"cloneNode"),b=As(w,"remove"),E=As(w,"nextSibling"),v=As(w,"childNodes"),T=As(w,"parentNode");if(typeof s=="function"){const K=r.createElement("template");K.content&&K.content.ownerDocument&&(r=K.content.ownerDocument)}let _,M="";const{implementation:P,createNodeIterator:x,createDocumentFragment:F,getElementsByTagName:U}=r,{importNode:H}=n;let G=iC();e.isSupported=typeof sT=="function"&&typeof T=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:J,ERB_EXPR:ae,TMPLIT_EXPR:q,DATA_ATTR:ee,ARIA_ATTR:lt,IS_SCRIPT_OR_DATA:Ee,ATTR_WHITESPACE:ye,CUSTOM_ELEMENT:qe}=nC;let{IS_ALLOWED_URI:$e}=nC,Me=null;const yr=he({},[...Jb,...rf,...nf,...of,...eC]);let f=null;const m=he({},[...tC,...sf,...rC,...al]);let p=Object.seal(aT(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),C=null,R=null,O=!0,I=!0,D=!1,j=!0,V=!1,A=!0,W=!1,te=!1,oe=!1,Ie=!1,be=!1,re=!1,Te=!0,ce=!1;const xe="user-content-";let Ge=!0,sr=!1,ar={},St=null;const br=he({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ft=null;const Bt=he({},["audio","video","img","source","image","track"]);let On=null;const _s=he({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Oi="http://www.w3.org/1998/Math/MathML",Qn="http://www.w3.org/2000/svg",ut="http://www.w3.org/1999/xhtml";let $r=ut,sn=!1,Mn=null;const Cr=he({},[Oi,Qn,ut],tf);let xt=he({},["mi","mo","mn","ms","mtext"]),Mi=he({},["annotation-xml"]);const il=he({},["title","style","font","a","script"]);let Os=null;const sM=["application/xhtml+xml","text/html"],aM="text/html";let gt=null,So=null;const lM=r.createElement("form"),fw=function(S){return S instanceof RegExp||S instanceof Function},Rc=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(So&&So===S)){if((!S||typeof S!="object")&&(S={}),S=Vn(S),Os=sM.indexOf(S.PARSER_MEDIA_TYPE)===-1?aM:S.PARSER_MEDIA_TYPE,gt=Os==="application/xhtml+xml"?tf:Jl,Me=Gr(S,"ALLOWED_TAGS")?he({},S.ALLOWED_TAGS,gt):yr,f=Gr(S,"ALLOWED_ATTR")?he({},S.ALLOWED_ATTR,gt):m,Mn=Gr(S,"ALLOWED_NAMESPACES")?he({},S.ALLOWED_NAMESPACES,tf):Cr,On=Gr(S,"ADD_URI_SAFE_ATTR")?he(Vn(_s),S.ADD_URI_SAFE_ATTR,gt):_s,ft=Gr(S,"ADD_DATA_URI_TAGS")?he(Vn(Bt),S.ADD_DATA_URI_TAGS,gt):Bt,St=Gr(S,"FORBID_CONTENTS")?he({},S.FORBID_CONTENTS,gt):br,C=Gr(S,"FORBID_TAGS")?he({},S.FORBID_TAGS,gt):Vn({}),R=Gr(S,"FORBID_ATTR")?he({},S.FORBID_ATTR,gt):Vn({}),ar=Gr(S,"USE_PROFILES")?S.USE_PROFILES:!1,O=S.ALLOW_ARIA_ATTR!==!1,I=S.ALLOW_DATA_ATTR!==!1,D=S.ALLOW_UNKNOWN_PROTOCOLS||!1,j=S.ALLOW_SELF_CLOSE_IN_ATTR!==!1,V=S.SAFE_FOR_TEMPLATES||!1,A=S.SAFE_FOR_XML!==!1,W=S.WHOLE_DOCUMENT||!1,Ie=S.RETURN_DOM||!1,be=S.RETURN_DOM_FRAGMENT||!1,re=S.RETURN_TRUSTED_TYPE||!1,oe=S.FORCE_BODY||!1,Te=S.SANITIZE_DOM!==!1,ce=S.SANITIZE_NAMED_PROPS||!1,Ge=S.KEEP_CONTENT!==!1,sr=S.IN_PLACE||!1,$e=S.ALLOWED_URI_REGEXP||lT,$r=S.NAMESPACE||ut,xt=S.MATHML_TEXT_INTEGRATION_POINTS||xt,Mi=S.HTML_INTEGRATION_POINTS||Mi,p=S.CUSTOM_ELEMENT_HANDLING||{},S.CUSTOM_ELEMENT_HANDLING&&fw(S.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(p.tagNameCheck=S.CUSTOM_ELEMENT_HANDLING.tagNameCheck),S.CUSTOM_ELEMENT_HANDLING&&fw(S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(p.attributeNameCheck=S.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),S.CUSTOM_ELEMENT_HANDLING&&typeof S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(p.allowCustomizedBuiltInElements=S.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),V&&(I=!1),be&&(Ie=!0),ar&&(Me=he({},eC),f=[],ar.html===!0&&(he(Me,Jb),he(f,tC)),ar.svg===!0&&(he(Me,rf),he(f,sf),he(f,al)),ar.svgFilters===!0&&(he(Me,nf),he(f,sf),he(f,al)),ar.mathMl===!0&&(he(Me,of),he(f,rC),he(f,al))),S.ADD_TAGS&&(Me===yr&&(Me=Vn(Me)),he(Me,S.ADD_TAGS,gt)),S.ADD_ATTR&&(f===m&&(f=Vn(f)),he(f,S.ADD_ATTR,gt)),S.ADD_URI_SAFE_ATTR&&he(On,S.ADD_URI_SAFE_ATTR,gt),S.FORBID_CONTENTS&&(St===br&&(St=Vn(St)),he(St,S.FORBID_CONTENTS,gt)),Ge&&(Me["#text"]=!0),W&&he(Me,["html","head","body"]),Me.table&&(he(Me,["tbody"]),delete C.tbody),S.TRUSTED_TYPES_POLICY){if(typeof S.TRUSTED_TYPES_POLICY.createHTML!="function")throw Hs('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof S.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Hs('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=S.TRUSTED_TYPES_POLICY,M=_.createHTML("")}else _===void 0&&(_=ax(g,i)),_!==null&&typeof M=="string"&&(M=_.createHTML(""));Wt&&Wt(S),So=S}},gw=he({},[...rf,...nf,...XP]),mw=he({},[...of,...ZP]),uM=function(S){let k=T(S);(!k||!k.tagName)&&(k={namespaceURI:$r,tagName:"template"});const Y=Jl(S.tagName),Be=Jl(k.tagName);return Mn[S.namespaceURI]?S.namespaceURI===Qn?k.namespaceURI===ut?Y==="svg":k.namespaceURI===Oi?Y==="svg"&&(Be==="annotation-xml"||xt[Be]):!!gw[Y]:S.namespaceURI===Oi?k.namespaceURI===ut?Y==="math":k.namespaceURI===Qn?Y==="math"&&Mi[Be]:!!mw[Y]:S.namespaceURI===ut?k.namespaceURI===Qn&&!Mi[Be]||k.namespaceURI===Oi&&!xt[Be]?!1:!mw[Y]&&(il[Y]||!gw[Y]):!!(Os==="application/xhtml+xml"&&Mn[S.namespaceURI]):!1},an=function(S){Ps(e.removed,{element:S});try{T(S).removeChild(S)}catch{b(S)}},Ro=function(S,k){try{Ps(e.removed,{attribute:k.getAttributeNode(S),from:k})}catch{Ps(e.removed,{attribute:null,from:k})}if(k.removeAttribute(S),S==="is")if(Ie||be)try{an(k)}catch{}else try{k.setAttribute(S,"")}catch{}},pw=function(S){let k=null,Y=null;if(oe)S="<remove></remove>"+S;else{const ct=Qb(S,/^[\r\n\t ]+/);Y=ct&&ct[0]}Os==="application/xhtml+xml"&&$r===ut&&(S='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+S+"</body></html>");const Be=_?_.createHTML(S):S;if($r===ut)try{k=new d().parseFromString(Be,Os)}catch{}if(!k||!k.documentElement){k=P.createDocument($r,"template",null);try{k.documentElement.innerHTML=sn?M:Be}catch{}}const Rt=k.body||k.documentElement;return S&&Y&&Rt.insertBefore(r.createTextNode(Y),Rt.childNodes[0]||null),$r===ut?U.call(k,W?"html":"body")[0]:W?k.documentElement:Rt},ww=function(S){return x.call(S.ownerDocument||S,S,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ec=function(S){return S instanceof h&&(typeof S.nodeName!="string"||typeof S.textContent!="string"||typeof S.removeChild!="function"||!(S.attributes instanceof c)||typeof S.removeAttribute!="function"||typeof S.setAttribute!="function"||typeof S.namespaceURI!="string"||typeof S.insertBefore!="function"||typeof S.hasChildNodes!="function")},vw=function(S){return typeof a=="function"&&S instanceof a};function In(K,S,k){sl(K,Y=>{Y.call(e,S,k,So)})}const yw=function(S){let k=null;if(In(G.beforeSanitizeElements,S,null),Ec(S))return an(S),!0;const Y=gt(S.nodeName);if(In(G.uponSanitizeElement,S,{tagName:Y,allowedTags:Me}),A&&S.hasChildNodes()&&!vw(S.firstElementChild)&&At(/<[/\w!]/g,S.innerHTML)&&At(/<[/\w!]/g,S.textContent)||S.nodeType===Ds.progressingInstruction||A&&S.nodeType===Ds.comment&&At(/<[/\w]/g,S.data))return an(S),!0;if(!Me[Y]||C[Y]){if(!C[Y]&&Cw(Y)&&(p.tagNameCheck instanceof RegExp&&At(p.tagNameCheck,Y)||p.tagNameCheck instanceof Function&&p.tagNameCheck(Y)))return!1;if(Ge&&!St[Y]){const Be=T(S)||S.parentNode,Rt=v(S)||S.childNodes;if(Rt&&Be){const ct=Rt.length;for(let jt=ct-1;jt>=0;--jt){const Pn=y(Rt[jt],!0);Pn.__removalCount=(S.__removalCount||0)+1,Be.insertBefore(Pn,E(S))}}}return an(S),!0}return S instanceof l&&!uM(S)||(Y==="noscript"||Y==="noembed"||Y==="noframes")&&At(/<\/no(script|embed|frames)/i,S.innerHTML)?(an(S),!0):(V&&S.nodeType===Ds.text&&(k=S.textContent,sl([J,ae,q],Be=>{k=xs(k,Be," ")}),S.textContent!==k&&(Ps(e.removed,{element:S.cloneNode()}),S.textContent=k)),In(G.afterSanitizeElements,S,null),!1)},bw=function(S,k,Y){if(Te&&(k==="id"||k==="name")&&(Y in r||Y in lM))return!1;if(!(I&&!R[k]&&At(ee,k))){if(!(O&&At(lt,k))){if(!f[k]||R[k]){if(!(Cw(S)&&(p.tagNameCheck instanceof RegExp&&At(p.tagNameCheck,S)||p.tagNameCheck instanceof Function&&p.tagNameCheck(S))&&(p.attributeNameCheck instanceof RegExp&&At(p.attributeNameCheck,k)||p.attributeNameCheck instanceof Function&&p.attributeNameCheck(k))||k==="is"&&p.allowCustomizedBuiltInElements&&(p.tagNameCheck instanceof RegExp&&At(p.tagNameCheck,Y)||p.tagNameCheck instanceof Function&&p.tagNameCheck(Y))))return!1}else if(!On[k]){if(!At($e,xs(Y,ye,""))){if(!((k==="src"||k==="xlink:href"||k==="href")&&S!=="script"&&YP(Y,"data:")===0&&ft[S])){if(!(D&&!At(Ee,xs(Y,ye,"")))){if(Y)return!1}}}}}}return!0},Cw=function(S){return S!=="annotation-xml"&&Qb(S,qe)},Sw=function(S){In(G.beforeSanitizeAttributes,S,null);const{attributes:k}=S;if(!k||Ec(S))return;const Y={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:f,forceKeepAttr:void 0};let Be=k.length;for(;Be--;){const Rt=k[Be],{name:ct,namespaceURI:jt,value:Pn}=Rt,Ms=gt(ct),Tc=Pn;let Et=ct==="value"?Tc:qP(Tc);if(Y.attrName=Ms,Y.attrValue=Et,Y.keepAttr=!0,Y.forceKeepAttr=void 0,In(G.uponSanitizeAttribute,S,Y),Et=Y.attrValue,ce&&(Ms==="id"||Ms==="name")&&(Ro(ct,S),Et=xe+Et),A&&At(/((--!?|])>)|<\/(style|title)/i,Et)){Ro(ct,S);continue}if(Y.forceKeepAttr)continue;if(!Y.keepAttr){Ro(ct,S);continue}if(!j&&At(/\/>/i,Et)){Ro(ct,S);continue}V&&sl([J,ae,q],Ew=>{Et=xs(Et,Ew," ")});const Rw=gt(S.nodeName);if(!bw(Rw,Ms,Et)){Ro(ct,S);continue}if(_&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!jt)switch(g.getAttributeType(Rw,Ms)){case"TrustedHTML":{Et=_.createHTML(Et);break}case"TrustedScriptURL":{Et=_.createScriptURL(Et);break}}if(Et!==Tc)try{jt?S.setAttributeNS(jt,ct,Et):S.setAttribute(ct,Et),Ec(S)?an(S):Zb(e.removed)}catch{Ro(ct,S)}}In(G.afterSanitizeAttributes,S,null)},cM=function K(S){let k=null;const Y=ww(S);for(In(G.beforeSanitizeShadowDOM,S,null);k=Y.nextNode();)In(G.uponSanitizeShadowNode,k,null),yw(k),Sw(k),k.content instanceof o&&K(k.content);In(G.afterSanitizeShadowDOM,S,null)};return e.sanitize=function(K){let S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},k=null,Y=null,Be=null,Rt=null;if(sn=!K,sn&&(K="<!-->"),typeof K!="string"&&!vw(K))if(typeof K.toString=="function"){if(K=K.toString(),typeof K!="string")throw Hs("dirty is not a string, aborting")}else throw Hs("toString is not a function");if(!e.isSupported)return K;if(te||Rc(S),e.removed=[],typeof K=="string"&&(sr=!1),sr){if(K.nodeName){const Pn=gt(K.nodeName);if(!Me[Pn]||C[Pn])throw Hs("root node is forbidden and cannot be sanitized in-place")}}else if(K instanceof a)k=pw("<!---->"),Y=k.ownerDocument.importNode(K,!0),Y.nodeType===Ds.element&&Y.nodeName==="BODY"||Y.nodeName==="HTML"?k=Y:k.appendChild(Y);else{if(!Ie&&!V&&!W&&K.indexOf("<")===-1)return _&&re?_.createHTML(K):K;if(k=pw(K),!k)return Ie?null:re?M:""}k&&oe&&an(k.firstChild);const ct=ww(sr?K:k);for(;Be=ct.nextNode();)yw(Be),Sw(Be),Be.content instanceof o&&cM(Be.content);if(sr)return K;if(Ie){if(be)for(Rt=F.call(k.ownerDocument);k.firstChild;)Rt.appendChild(k.firstChild);else Rt=k;return(f.shadowroot||f.shadowrootmode)&&(Rt=H.call(n,Rt,!0)),Rt}let jt=W?k.outerHTML:k.innerHTML;return W&&Me["!doctype"]&&k.ownerDocument&&k.ownerDocument.doctype&&k.ownerDocument.doctype.name&&At(uT,k.ownerDocument.doctype.name)&&(jt="<!DOCTYPE "+k.ownerDocument.doctype.name+`>
`+jt),V&&sl([J,ae,q],Pn=>{jt=xs(jt,Pn," ")}),_&&re?_.createHTML(jt):jt},e.setConfig=function(){let K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rc(K),te=!0},e.clearConfig=function(){So=null,te=!1},e.isValidAttribute=function(K,S,k){So||Rc({});const Y=gt(K),Be=gt(S);return bw(Y,Be,k)},e.addHook=function(K,S){typeof S=="function"&&Ps(G[K],S)},e.removeHook=function(K,S){if(S!==void 0){const k=zP(G[K],S);return k===-1?void 0:UP(G[K],k,1)[0]}return Zb(G[K])},e.removeHooks=function(K){G[K]=[]},e.removeAllHooks=function(){G=iC()},e}var lx=cT();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var hT;function L(){return hT.apply(null,arguments)}function ux(t){hT=t}function en(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ji(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Se(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _m(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Se(t,e))return!1;return!0}function Kt(t){return t===void 0}function qn(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function qa(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function dT(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function hi(t,e){for(var r in e)Se(e,r)&&(t[r]=e[r]);return Se(e,"toString")&&(t.toString=e.toString),Se(e,"valueOf")&&(t.valueOf=e.valueOf),t}function En(t,e,r,n){return NT(t,e,r,n,!0).utc()}function cx(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function se(t){return t._pf==null&&(t._pf=cx()),t._pf}var Eg;Array.prototype.some?Eg=Array.prototype.some:Eg=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function Om(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=se(t),r=Eg.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function $u(t){var e=En(NaN);return t!=null?hi(se(e),t):se(e).userInvalidated=!0,e}var oC=L.momentProperties=[],af=!1;function Mm(t,e){var r,n,i,o=oC.length;if(Kt(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Kt(e._i)||(t._i=e._i),Kt(e._f)||(t._f=e._f),Kt(e._l)||(t._l=e._l),Kt(e._strict)||(t._strict=e._strict),Kt(e._tzm)||(t._tzm=e._tzm),Kt(e._isUTC)||(t._isUTC=e._isUTC),Kt(e._offset)||(t._offset=e._offset),Kt(e._pf)||(t._pf=se(e)),Kt(e._locale)||(t._locale=e._locale),o>0)for(r=0;r<o;r++)n=oC[r],i=e[n],Kt(i)||(t[n]=i);return t}function Ga(t){Mm(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),af===!1&&(af=!0,L.updateOffset(this),af=!1)}function tn(t){return t instanceof Ga||t!=null&&t._isAMomentObject!=null}function fT(t){L.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Fr(t,e){var r=!0;return hi(function(){if(L.deprecationHandler!=null&&L.deprecationHandler(null,t),r){var n=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Se(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];n.push(i)}fT(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var sC={};function gT(t,e){L.deprecationHandler!=null&&L.deprecationHandler(t,e),sC[t]||(fT(e),sC[t]=!0)}L.suppressDeprecationWarnings=!1;L.deprecationHandler=null;function Tn(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function hx(t){var e,r;for(r in t)Se(t,r)&&(e=t[r],Tn(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Tg(t,e){var r=hi({},t),n;for(n in e)Se(e,n)&&(Ji(t[n])&&Ji(e[n])?(r[n]={},hi(r[n],t[n]),hi(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Se(t,n)&&!Se(e,n)&&Ji(t[n])&&(r[n]=hi({},r[n]));return r}function Im(t){t!=null&&this.set(t)}var _g;Object.keys?_g=Object.keys:_g=function(t){var e,r=[];for(e in t)Se(t,e)&&r.push(e);return r};var dx={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function fx(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Tn(n)?n.call(e,r):n}function yn(t,e,r){var n=""+Math.abs(t),i=e-n.length,o=t>=0;return(o?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var Pm=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ll=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,lf={},ts={};function Z(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(ts[t]=i),e&&(ts[e[0]]=function(){return yn(i.apply(this,arguments),e[1],e[2])}),r&&(ts[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function gx(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function mx(t){var e=t.match(Pm),r,n;for(r=0,n=e.length;r<n;r++)ts[e[r]]?e[r]=ts[e[r]]:e[r]=gx(e[r]);return function(i){var o="",s;for(s=0;s<n;s++)o+=Tn(e[s])?e[s].call(i,t):e[s];return o}}function eu(t,e){return t.isValid()?(e=mT(e,t.localeData()),lf[e]=lf[e]||mx(e),lf[e](t)):t.localeData().invalidDate()}function mT(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(ll.lastIndex=0;r>=0&&ll.test(t);)t=t.replace(ll,n),ll.lastIndex=0,r-=1;return t}var px={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function wx(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(Pm).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var vx="Invalid date";function yx(){return this._invalidDate}var bx="%d",Cx=/\d{1,2}/;function Sx(t){return this._ordinal.replace("%d",t)}var Rx={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Ex(t,e,r,n){var i=this._relativeTime[r];return Tn(i)?i(t,e,r,n):i.replace(/%d/i,t)}function Tx(t,e){var r=this._relativeTime[t>0?"future":"past"];return Tn(r)?r(e):r.replace(/%s/i,e)}var aC={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Vr(t){return typeof t=="string"?aC[t]||aC[t.toLowerCase()]:void 0}function xm(t){var e={},r,n;for(n in t)Se(t,n)&&(r=Vr(n),r&&(e[r]=t[n]));return e}var _x={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Ox(t){var e=[],r;for(r in t)Se(t,r)&&e.push({unit:r,priority:_x[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var pT=/\d/,vr=/\d\d/,wT=/\d{3}/,Hm=/\d{4}/,Bu=/[+-]?\d{6}/,We=/\d\d?/,vT=/\d\d\d\d?/,yT=/\d\d\d\d\d\d?/,ju=/\d{1,3}/,Am=/\d{1,4}/,zu=/[+-]?\d{1,6}/,Cs=/\d+/,Uu=/[+-]?\d+/,Mx=/Z|[+-]\d\d:?\d\d/gi,Yu=/Z|[+-]\d\d(?::?\d\d)?/gi,Ix=/[+-]?\d+(\.\d{1,3})?/,Ka=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ss=/^[1-9]\d?/,Dm=/^([1-9]\d|\d)/,mu;mu={};function B(t,e,r){mu[t]=Tn(e)?e:function(n,i){return n&&r?r:e}}function Px(t,e){return Se(mu,t)?mu[t](e._strict,e._locale):new RegExp(xx(t))}function xx(t){return Un(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,o){return r||n||i||o}))}function Un(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Pr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ge(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Pr(e)),r}var Og={};function Ae(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),qn(e)&&(n=function(o,s){s[e]=ge(o)}),i=t.length,r=0;r<i;r++)Og[t[r]]=n}function Xa(t,e){Ae(t,function(r,n,i,o){i._w=i._w||{},e(r,i._w,i,o)})}function Hx(t,e,r){e!=null&&Se(Og,t)&&Og[t](e,r._a,r,t)}function qu(t){return t%4===0&&t%100!==0||t%400===0}var Pt=0,Bn=1,pn=2,dt=3,Zr=4,jn=5,Ki=6,Ax=7,Dx=8;Z("Y",0,0,function(){var t=this.year();return t<=9999?yn(t,4):"+"+t});Z(0,["YY",2],0,function(){return this.year()%100});Z(0,["YYYY",4],0,"year");Z(0,["YYYYY",5],0,"year");Z(0,["YYYYYY",6,!0],0,"year");B("Y",Uu);B("YY",We,vr);B("YYYY",Am,Hm);B("YYYYY",zu,Bu);B("YYYYYY",zu,Bu);Ae(["YYYYY","YYYYYY"],Pt);Ae("YYYY",function(t,e){e[Pt]=t.length===2?L.parseTwoDigitYear(t):ge(t)});Ae("YY",function(t,e){e[Pt]=L.parseTwoDigitYear(t)});Ae("Y",function(t,e){e[Pt]=parseInt(t,10)});function va(t){return qu(t)?366:365}L.parseTwoDigitYear=function(t){return ge(t)+(ge(t)>68?1900:2e3)};var bT=Rs("FullYear",!0);function Nx(){return qu(this.year())}function Rs(t,e){return function(r){return r!=null?(CT(this,t,r),L.updateOffset(this,e),this):Ma(this,t)}}function Ma(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function CT(t,e,r){var n,i,o,s,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,s=t.month(),a=t.date(),a=a===29&&s===1&&!qu(o)?28:a,i?n.setUTCFullYear(o,s,a):n.setFullYear(o,s,a)}}function kx(t){return t=Vr(t),Tn(this[t])?this[t]():this}function Lx(t,e){if(typeof t=="object"){t=xm(t);var r=Ox(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Vr(t),Tn(this[t]))return this[t](e);return this}function Fx(t,e){return(t%e+e)%e}var Je;Array.prototype.indexOf?Je=Array.prototype.indexOf:Je=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Nm(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Fx(e,12);return t+=(e-r)/12,r===1?qu(t)?29:28:31-r%7%2}Z("M",["MM",2],"Mo",function(){return this.month()+1});Z("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Z("MMMM",0,0,function(t){return this.localeData().months(this,t)});B("M",We,Ss);B("MM",We,vr);B("MMM",function(t,e){return e.monthsShortRegex(t)});B("MMMM",function(t,e){return e.monthsRegex(t)});Ae(["M","MM"],function(t,e){e[Bn]=ge(t)-1});Ae(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Bn]=i:se(r).invalidMonth=t});var Vx="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ST="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),RT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Wx=Ka,$x=Ka;function Bx(t,e){return t?en(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||RT).test(e)?"format":"standalone"][t.month()]:en(this._months)?this._months:this._months.standalone}function jx(t,e){return t?en(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[RT.test(e)?"format":"standalone"][t.month()]:en(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function zx(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=En([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?e==="MMM"?(i=Je.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Je.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Je.call(this._shortMonthsParse,s),i!==-1?i:(i=Je.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Je.call(this._longMonthsParse,s),i!==-1?i:(i=Je.call(this._shortMonthsParse,s),i!==-1?i:null))}function Ux(t,e,r){var n,i,o;if(this._monthsParseExact)return zx.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=En([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function ET(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ge(e);else if(e=t.localeData().monthsParse(e),!qn(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,Nm(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function TT(t){return t!=null?(ET(this,t),L.updateOffset(this,!0),this):Ma(this,"Month")}function Yx(){return Nm(this.year(),this.month())}function qx(t){return this._monthsParseExact?(Se(this,"_monthsRegex")||_T.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Se(this,"_monthsShortRegex")||(this._monthsShortRegex=Wx),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Gx(t){return this._monthsParseExact?(Se(this,"_monthsRegex")||_T.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Se(this,"_monthsRegex")||(this._monthsRegex=$x),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function _T(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,o,s,a;for(i=0;i<12;i++)o=En([2e3,i]),s=Un(this.monthsShort(o,"")),a=Un(this.months(o,"")),e.push(s),r.push(a),n.push(a),n.push(s);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Kx(t,e,r,n,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,o,s),a}function Ia(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function pu(t,e,r){var n=7+e-r,i=(7+Ia(t,0,n).getUTCDay()-e)%7;return-i+n-1}function OT(t,e,r,n,i){var o=(7+r-n)%7,s=pu(t,n,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=va(l)+a):a>va(t)?(l=t+1,u=a-va(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Pa(t,e,r){var n=pu(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Yn(s,e,r)):i>Yn(t.year(),e,r)?(o=i-Yn(t.year(),e,r),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Yn(t,e,r){var n=pu(t,e,r),i=pu(t+1,e,r);return(va(t)-n+i)/7}Z("w",["ww",2],"wo","week");Z("W",["WW",2],"Wo","isoWeek");B("w",We,Ss);B("ww",We,vr);B("W",We,Ss);B("WW",We,vr);Xa(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=ge(t)});function Xx(t){return Pa(t,this._week.dow,this._week.doy).week}var Zx={dow:0,doy:6};function Qx(){return this._week.dow}function Jx(){return this._week.doy}function eH(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function tH(t){var e=Pa(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Z("d",0,"do","day");Z("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Z("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Z("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Z("e",0,0,"weekday");Z("E",0,0,"isoWeekday");B("d",We);B("e",We);B("E",We);B("dd",function(t,e){return e.weekdaysMinRegex(t)});B("ddd",function(t,e){return e.weekdaysShortRegex(t)});B("dddd",function(t,e){return e.weekdaysRegex(t)});Xa(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:se(r).invalidWeekday=t});Xa(["d","e","E"],function(t,e,r,n){e[n]=ge(t)});function rH(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function nH(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function km(t,e){return t.slice(e,7).concat(t.slice(0,e))}var iH="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),MT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),oH="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),sH=Ka,aH=Ka,lH=Ka;function uH(t,e){var r=en(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?km(r,this._week.dow):t?r[t.day()]:r}function cH(t){return t===!0?km(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function hH(t){return t===!0?km(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function dH(t,e,r){var n,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=En([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?e==="dddd"?(i=Je.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Je.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Je.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Je.call(this._weekdaysParse,s),i!==-1||(i=Je.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Je.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Je.call(this._shortWeekdaysParse,s),i!==-1||(i=Je.call(this._weekdaysParse,s),i!==-1)?i:(i=Je.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Je.call(this._minWeekdaysParse,s),i!==-1||(i=Je.call(this._weekdaysParse,s),i!==-1)?i:(i=Je.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function fH(t,e,r){var n,i,o;if(this._weekdaysParseExact)return dH.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=En([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function gH(t){if(!this.isValid())return t!=null?this:NaN;var e=Ma(this,"Day");return t!=null?(t=rH(t,this.localeData()),this.add(t-e,"d")):e}function mH(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function pH(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=nH(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function wH(t){return this._weekdaysParseExact?(Se(this,"_weekdaysRegex")||Lm.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Se(this,"_weekdaysRegex")||(this._weekdaysRegex=sH),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function vH(t){return this._weekdaysParseExact?(Se(this,"_weekdaysRegex")||Lm.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Se(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=aH),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function yH(t){return this._weekdaysParseExact?(Se(this,"_weekdaysRegex")||Lm.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Se(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=lH),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Lm(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=En([2e3,1]).day(o),a=Un(this.weekdaysMin(s,"")),l=Un(this.weekdaysShort(s,"")),u=Un(this.weekdays(s,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Fm(){return this.hours()%12||12}function bH(){return this.hours()||24}Z("H",["HH",2],0,"hour");Z("h",["hh",2],0,Fm);Z("k",["kk",2],0,bH);Z("hmm",0,0,function(){return""+Fm.apply(this)+yn(this.minutes(),2)});Z("hmmss",0,0,function(){return""+Fm.apply(this)+yn(this.minutes(),2)+yn(this.seconds(),2)});Z("Hmm",0,0,function(){return""+this.hours()+yn(this.minutes(),2)});Z("Hmmss",0,0,function(){return""+this.hours()+yn(this.minutes(),2)+yn(this.seconds(),2)});function IT(t,e){Z(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}IT("a",!0);IT("A",!1);function PT(t,e){return e._meridiemParse}B("a",PT);B("A",PT);B("H",We,Dm);B("h",We,Ss);B("k",We,Ss);B("HH",We,vr);B("hh",We,vr);B("kk",We,vr);B("hmm",vT);B("hmmss",yT);B("Hmm",vT);B("Hmmss",yT);Ae(["H","HH"],dt);Ae(["k","kk"],function(t,e,r){var n=ge(t);e[dt]=n===24?0:n});Ae(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Ae(["h","hh"],function(t,e,r){e[dt]=ge(t),se(r).bigHour=!0});Ae("hmm",function(t,e,r){var n=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n)),se(r).bigHour=!0});Ae("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n,2)),e[jn]=ge(t.substr(i)),se(r).bigHour=!0});Ae("Hmm",function(t,e,r){var n=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n))});Ae("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[dt]=ge(t.substr(0,n)),e[Zr]=ge(t.substr(n,2)),e[jn]=ge(t.substr(i))});function CH(t){return(t+"").toLowerCase().charAt(0)==="p"}var SH=/[ap]\.?m?\.?/i,RH=Rs("Hours",!0);function EH(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var xT={calendar:dx,longDateFormat:px,invalidDate:vx,ordinal:bx,dayOfMonthOrdinalParse:Cx,relativeTime:Rx,months:Vx,monthsShort:ST,week:Zx,weekdays:iH,weekdaysMin:oH,weekdaysShort:MT,meridiemParse:SH},ze={},Ns={},xa;function TH(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function lC(t){return t&&t.toLowerCase().replace("_","-")}function _H(t){for(var e=0,r,n,i,o;e<t.length;){for(o=lC(t[e]).split("-"),r=o.length,n=lC(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Gu(o.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&TH(o,n)>=r-1)break;r--}e++}return xa}function OH(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Gu(t){var e=null,r;if(ze[t]===void 0&&typeof uu<"u"&&uu&&uu.exports&&OH(t))try{e=xa._abbr,r=require,r("./locale/"+t),wi(e)}catch{ze[t]=null}return ze[t]}function wi(t,e){var r;return t&&(Kt(e)?r=Gn(t):r=Vm(t,e),r?xa=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),xa._abbr}function Vm(t,e){if(e!==null){var r,n=xT;if(e.abbr=t,ze[t]!=null)gT("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ze[t]._config;else if(e.parentLocale!=null)if(ze[e.parentLocale]!=null)n=ze[e.parentLocale]._config;else if(r=Gu(e.parentLocale),r!=null)n=r._config;else return Ns[e.parentLocale]||(Ns[e.parentLocale]=[]),Ns[e.parentLocale].push({name:t,config:e}),null;return ze[t]=new Im(Tg(n,e)),Ns[t]&&Ns[t].forEach(function(i){Vm(i.name,i.config)}),wi(t),ze[t]}else return delete ze[t],null}function MH(t,e){if(e!=null){var r,n,i=xT;ze[t]!=null&&ze[t].parentLocale!=null?ze[t].set(Tg(ze[t]._config,e)):(n=Gu(t),n!=null&&(i=n._config),e=Tg(i,e),n==null&&(e.abbr=t),r=new Im(e),r.parentLocale=ze[t],ze[t]=r),wi(t)}else ze[t]!=null&&(ze[t].parentLocale!=null?(ze[t]=ze[t].parentLocale,t===wi()&&wi(t)):ze[t]!=null&&delete ze[t]);return ze[t]}function Gn(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return xa;if(!en(t)){if(e=Gu(t),e)return e;t=[t]}return _H(t)}function IH(){return _g(ze)}function Wm(t){var e,r=t._a;return r&&se(t).overflow===-2&&(e=r[Bn]<0||r[Bn]>11?Bn:r[pn]<1||r[pn]>Nm(r[Pt],r[Bn])?pn:r[dt]<0||r[dt]>24||r[dt]===24&&(r[Zr]!==0||r[jn]!==0||r[Ki]!==0)?dt:r[Zr]<0||r[Zr]>59?Zr:r[jn]<0||r[jn]>59?jn:r[Ki]<0||r[Ki]>999?Ki:-1,se(t)._overflowDayOfYear&&(e<Pt||e>pn)&&(e=pn),se(t)._overflowWeeks&&e===-1&&(e=Ax),se(t)._overflowWeekday&&e===-1&&(e=Dx),se(t).overflow=e),t}var PH=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xH=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,HH=/Z|[+-]\d\d(?::?\d\d)?/,ul=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],uf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],AH=/^\/?Date\((-?\d+)/i,DH=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,NH={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function HT(t){var e,r,n=t._i,i=PH.exec(n)||xH.exec(n),o,s,a,l,u=ul.length,c=uf.length;if(i){for(se(t).iso=!0,e=0,r=u;e<r;e++)if(ul[e][1].exec(i[1])){s=ul[e][0],o=ul[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(uf[e][1].exec(i[3])){a=(i[2]||" ")+uf[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(HH.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Bm(t)}else t._isValid=!1}function kH(t,e,r,n,i,o){var s=[LH(t),ST.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function LH(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function FH(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function VH(t,e,r){if(t){var n=MT.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return se(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function WH(t,e,r){if(t)return NH[t];if(e)return 0;var n=parseInt(r,10),i=n%100,o=(n-i)/100;return o*60+i}function AT(t){var e=DH.exec(FH(t._i)),r;if(e){if(r=kH(e[4],e[3],e[2],e[5],e[6],e[7]),!VH(e[1],r,t))return;t._a=r,t._tzm=WH(e[8],e[9],e[10]),t._d=Ia.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),se(t).rfc2822=!0}else t._isValid=!1}function $H(t){var e=AH.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(HT(t),t._isValid===!1)delete t._isValid;else return;if(AT(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:L.createFromInputFallback(t)}L.createFromInputFallback=Fr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Yo(t,e,r){return t??e??r}function BH(t){var e=new Date(L.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function $m(t){var e,r,n=[],i,o,s;if(!t._d){for(i=BH(t),t._w&&t._a[pn]==null&&t._a[Bn]==null&&jH(t),t._dayOfYear!=null&&(s=Yo(t._a[Pt],i[Pt]),(t._dayOfYear>va(s)||t._dayOfYear===0)&&(se(t)._overflowDayOfYear=!0),r=Ia(s,0,t._dayOfYear),t._a[Bn]=r.getUTCMonth(),t._a[pn]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[dt]===24&&t._a[Zr]===0&&t._a[jn]===0&&t._a[Ki]===0&&(t._nextDay=!0,t._a[dt]=0),t._d=(t._useUTC?Ia:Kx).apply(null,n),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[dt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(se(t).weekdayMismatch=!0)}}function jH(t){var e,r,n,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,r=Yo(e.GG,t._a[Pt],Pa(Ve(),1,4).year),n=Yo(e.W,1),i=Yo(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Pa(Ve(),o,s),r=Yo(e.gg,t._a[Pt],u.year),n=Yo(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),n<1||n>Yn(r,o,s)?se(t)._overflowWeeks=!0:l!=null?se(t)._overflowWeekday=!0:(a=OT(r,n,i,o,s),t._a[Pt]=a.year,t._dayOfYear=a.dayOfYear)}L.ISO_8601=function(){};L.RFC_2822=function(){};function Bm(t){if(t._f===L.ISO_8601){HT(t);return}if(t._f===L.RFC_2822){AT(t);return}t._a=[],se(t).empty=!0;var e=""+t._i,r,n,i,o,s,a=e.length,l=0,u,c;for(i=mT(t._f,t._locale).match(Pm)||[],c=i.length,r=0;r<c;r++)o=i[r],n=(e.match(Px(o,t))||[])[0],n&&(s=e.substr(0,e.indexOf(n)),s.length>0&&se(t).unusedInput.push(s),e=e.slice(e.indexOf(n)+n.length),l+=n.length),ts[o]?(n?se(t).empty=!1:se(t).unusedTokens.push(o),Hx(o,n,t)):t._strict&&!n&&se(t).unusedTokens.push(o);se(t).charsLeftOver=a-l,e.length>0&&se(t).unusedInput.push(e),t._a[dt]<=12&&se(t).bigHour===!0&&t._a[dt]>0&&(se(t).bigHour=void 0),se(t).parsedDateParts=t._a.slice(0),se(t).meridiem=t._meridiem,t._a[dt]=zH(t._locale,t._a[dt],t._meridiem),u=se(t).era,u!==null&&(t._a[Pt]=t._locale.erasConvertYear(u,t._a[Pt])),$m(t),Wm(t)}function zH(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function UH(t){var e,r,n,i,o,s,a=!1,l=t._f.length;if(l===0){se(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Mm({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Bm(e),Om(e)&&(s=!0),o+=se(e).charsLeftOver,o+=se(e).unusedTokens.length*10,se(e).score=o,a?o<n&&(n=o,r=e):(n==null||o<n||s)&&(n=o,r=e,s&&(a=!0));hi(t,r||e)}function YH(t){if(!t._d){var e=xm(t._i),r=e.day===void 0?e.date:e.day;t._a=dT([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),$m(t)}}function qH(t){var e=new Ga(Wm(DT(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function DT(t){var e=t._i,r=t._f;return t._locale=t._locale||Gn(t._l),e===null||r===void 0&&e===""?$u({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),tn(e)?new Ga(Wm(e)):(qa(e)?t._d=e:en(r)?UH(t):r?Bm(t):GH(t),Om(t)||(t._d=null),t))}function GH(t){var e=t._i;Kt(e)?t._d=new Date(L.now()):qa(e)?t._d=new Date(e.valueOf()):typeof e=="string"?$H(t):en(e)?(t._a=dT(e.slice(0),function(r){return parseInt(r,10)}),$m(t)):Ji(e)?YH(t):qn(e)?t._d=new Date(e):L.createFromInputFallback(t)}function NT(t,e,r,n,i){var o={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ji(t)&&_m(t)||en(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=t,o._f=e,o._strict=n,qH(o)}function Ve(t,e,r,n){return NT(t,e,r,n,!1)}var KH=Fr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:$u()}),XH=Fr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ve.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:$u()});function kT(t,e){var r,n;if(e.length===1&&en(e[0])&&(e=e[0]),!e.length)return Ve();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function ZH(){var t=[].slice.call(arguments,0);return kT("isBefore",t)}function QH(){var t=[].slice.call(arguments,0);return kT("isAfter",t)}var JH=function(){return Date.now?Date.now():+new Date},ks=["year","quarter","month","week","day","hour","minute","second","millisecond"];function e1(t){var e,r=!1,n,i=ks.length;for(e in t)if(Se(t,e)&&!(Je.call(ks,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[ks[n]]){if(r)return!1;parseFloat(t[ks[n]])!==ge(t[ks[n]])&&(r=!0)}return!0}function t1(){return this._isValid}function r1(){return nn(NaN)}function Ku(t){var e=xm(t),r=e.year||0,n=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=e1(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+n*3+r*12,this._data={},this._locale=Gn(),this._bubble()}function tu(t){return t instanceof Ku}function Mg(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function n1(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<n;s++)ge(t[s])!==ge(e[s])&&o++;return o+i}function LT(t,e){Z(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+yn(~~(r/60),2)+e+yn(~~r%60,2)})}LT("Z",":");LT("ZZ","");B("Z",Yu);B("ZZ",Yu);Ae(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=jm(Yu,t)});var i1=/([\+\-]|\d\d)/gi;function jm(t,e){var r=(e||"").match(t),n,i,o;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(i1)||["-",0,0],o=+(i[1]*60)+ge(i[2]),o===0?0:i[0]==="+"?o:-o)}function zm(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(tn(t)||qa(t)?t.valueOf():Ve(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),L.updateOffset(r,!1),r):Ve(t).local()}function Ig(t){return-Math.round(t._d.getTimezoneOffset())}L.updateOffset=function(){};function o1(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=jm(Yu,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=Ig(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?WT(this,nn(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,L.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Ig(this)}function s1(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function a1(t){return this.utcOffset(0,t)}function l1(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Ig(this),"m")),this}function u1(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=jm(Mx,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function c1(t){return this.isValid()?(t=t?Ve(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function h1(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function d1(){if(!Kt(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Mm(t,this),t=DT(t),t._a?(e=t._isUTC?En(t._a):Ve(t._a),this._isDSTShifted=this.isValid()&&n1(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function f1(){return this.isValid()?!this._isUTC:!1}function g1(){return this.isValid()?this._isUTC:!1}function FT(){return this.isValid()?this._isUTC&&this._offset===0:!1}var m1=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,p1=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function nn(t,e){var r=t,n=null,i,o,s;return tu(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:qn(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=m1.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:ge(n[pn])*i,h:ge(n[dt])*i,m:ge(n[Zr])*i,s:ge(n[jn])*i,ms:ge(Mg(n[Ki]*1e3))*i}):(n=p1.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ii(n[2],i),M:Ii(n[3],i),w:Ii(n[4],i),d:Ii(n[5],i),h:Ii(n[6],i),m:Ii(n[7],i),s:Ii(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(s=w1(Ve(r.from),Ve(r.to)),r={},r.ms=s.milliseconds,r.M=s.months),o=new Ku(r),tu(t)&&Se(t,"_locale")&&(o._locale=t._locale),tu(t)&&Se(t,"_isValid")&&(o._isValid=t._isValid),o}nn.fn=Ku.prototype;nn.invalid=r1;function Ii(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function uC(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function w1(t,e){var r;return t.isValid()&&e.isValid()?(e=zm(e,t),t.isBefore(e)?r=uC(t,e):(r=uC(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function VT(t,e){return function(r,n){var i,o;return n!==null&&!isNaN(+n)&&(gT(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=r,r=n,n=o),i=nn(r,n),WT(this,i,t),this}}function WT(t,e,r,n){var i=e._milliseconds,o=Mg(e._days),s=Mg(e._months);t.isValid()&&(n=n??!0,s&&ET(t,Ma(t,"Month")+s*r),o&&CT(t,"Date",Ma(t,"Date")+o*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&L.updateOffset(t,o||s))}var v1=VT(1,"add"),y1=VT(-1,"subtract");function $T(t){return typeof t=="string"||t instanceof String}function b1(t){return tn(t)||qa(t)||$T(t)||qn(t)||S1(t)||C1(t)||t===null||t===void 0}function C1(t){var e=Ji(t)&&!_m(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=n.length;for(i=0;i<s;i+=1)o=n[i],r=r||Se(t,o);return e&&r}function S1(t){var e=en(t),r=!1;return e&&(r=t.filter(function(n){return!qn(n)&&$T(t)}).length===0),e&&r}function R1(t){var e=Ji(t)&&!_m(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<n.length;i+=1)o=n[i],r=r||Se(t,o);return e&&r}function E1(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function T1(t,e){arguments.length===1&&(arguments[0]?b1(arguments[0])?(t=arguments[0],e=void 0):R1(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ve(),n=zm(r,this).startOf("day"),i=L.calendarFormat(this,n)||"sameElse",o=e&&(Tn(e[i])?e[i].call(this,r):e[i]);return this.format(o||this.localeData().calendar(i,this,Ve(r)))}function _1(){return new Ga(this)}function O1(t,e){var r=tn(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=Vr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function M1(t,e){var r=tn(t)?t:Ve(t);return this.isValid()&&r.isValid()?(e=Vr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function I1(t,e,r,n){var i=tn(t)?t:Ve(t),o=tn(e)?e:Ve(e);return this.isValid()&&i.isValid()&&o.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(o,r):!this.isAfter(o,r))):!1}function P1(t,e){var r=tn(t)?t:Ve(t),n;return this.isValid()&&r.isValid()?(e=Vr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function x1(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function H1(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function A1(t,e,r){var n,i,o;if(!this.isValid())return NaN;if(n=zm(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Vr(e),e){case"year":o=ru(this,n)/12;break;case"month":o=ru(this,n);break;case"quarter":o=ru(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Pr(o)}function ru(t,e){if(t.date()<e.date())return-ru(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,o;return e-n<0?(i=t.clone().add(r-1,"months"),o=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),o=(e-n)/(i-n)),-(r+o)||0}L.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";L.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function D1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function N1(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?eu(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Tn(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",eu(r,"Z")):eu(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function k1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(r+n+i+o)}function L1(t){t||(t=this.isUtc()?L.defaultFormatUtc:L.defaultFormat);var e=eu(this,t);return this.localeData().postformat(e)}function F1(t,e){return this.isValid()&&(tn(t)&&t.isValid()||Ve(t).isValid())?nn({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function V1(t){return this.from(Ve(),t)}function W1(t,e){return this.isValid()&&(tn(t)&&t.isValid()||Ve(t).isValid())?nn({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function $1(t){return this.to(Ve(),t)}function BT(t){var e;return t===void 0?this._locale._abbr:(e=Gn(t),e!=null&&(this._locale=e),this)}var jT=Fr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function zT(){return this._locale}var wu=1e3,rs=60*wu,vu=60*rs,UT=(365*400+97)*24*vu;function ns(t,e){return(t%e+e)%e}function YT(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-UT:new Date(t,e,r).valueOf()}function qT(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-UT:Date.UTC(t,e,r)}function B1(t){var e,r;if(t=Vr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?qT:YT,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ns(e+(this._isUTC?0:this.utcOffset()*rs),vu);break;case"minute":e=this._d.valueOf(),e-=ns(e,rs);break;case"second":e=this._d.valueOf(),e-=ns(e,wu);break}return this._d.setTime(e),L.updateOffset(this,!0),this}function j1(t){var e,r;if(t=Vr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?qT:YT,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=vu-ns(e+(this._isUTC?0:this.utcOffset()*rs),vu)-1;break;case"minute":e=this._d.valueOf(),e+=rs-ns(e,rs)-1;break;case"second":e=this._d.valueOf(),e+=wu-ns(e,wu)-1;break}return this._d.setTime(e),L.updateOffset(this,!0),this}function z1(){return this._d.valueOf()-(this._offset||0)*6e4}function U1(){return Math.floor(this.valueOf()/1e3)}function Y1(){return new Date(this.valueOf())}function q1(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function G1(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function K1(){return this.isValid()?this.toISOString():null}function X1(){return Om(this)}function Z1(){return hi({},se(this))}function Q1(){return se(this).overflow}function J1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Z("N",0,0,"eraAbbr");Z("NN",0,0,"eraAbbr");Z("NNN",0,0,"eraAbbr");Z("NNNN",0,0,"eraName");Z("NNNNN",0,0,"eraNarrow");Z("y",["y",1],"yo","eraYear");Z("y",["yy",2],0,"eraYear");Z("y",["yyy",3],0,"eraYear");Z("y",["yyyy",4],0,"eraYear");B("N",Um);B("NN",Um);B("NNN",Um);B("NNNN",cA);B("NNNNN",hA);Ae(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?se(r).era=i:se(r).invalidEra=t});B("y",Cs);B("yy",Cs);B("yyy",Cs);B("yyyy",Cs);B("yo",dA);Ae(["y","yy","yyy","yyyy"],Pt);Ae(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Pt]=r._locale.eraYearOrdinalParse(t,i):e[Pt]=parseInt(t,10)});function eA(t,e){var r,n,i,o=this._eras||Gn("en")._eras;for(r=0,n=o.length;r<n;++r){switch(typeof o[r].since){case"string":i=L(o[r].since).startOf("day"),o[r].since=i.valueOf();break}switch(typeof o[r].until){case"undefined":o[r].until=1/0;break;case"string":i=L(o[r].until).startOf("day").valueOf(),o[r].until=i.valueOf();break}}return o}function tA(t,e,r){var n,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),n=0,i=o.length;n<i;++n)if(s=o[n].name.toUpperCase(),a=o[n].abbr.toUpperCase(),l=o[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[n];break;case"NNNN":if(s===t)return o[n];break;case"NNNNN":if(l===t)return o[n];break}else if([s,a,l].indexOf(t)>=0)return o[n]}function rA(t,e){var r=t.since<=t.until?1:-1;return e===void 0?L(t.since).year():L(t.since).year()+(e-t.offset)*r}function nA(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function iA(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function oA(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function sA(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-L(i[t].since).year())*r+i[t].offset;return this.year()}function aA(t){return Se(this,"_erasNameRegex")||Ym.call(this),t?this._erasNameRegex:this._erasRegex}function lA(t){return Se(this,"_erasAbbrRegex")||Ym.call(this),t?this._erasAbbrRegex:this._erasRegex}function uA(t){return Se(this,"_erasNarrowRegex")||Ym.call(this),t?this._erasNarrowRegex:this._erasRegex}function Um(t,e){return e.erasAbbrRegex(t)}function cA(t,e){return e.erasNameRegex(t)}function hA(t,e){return e.erasNarrowRegex(t)}function dA(t,e){return e._eraYearOrdinalRegex||Cs}function Ym(){var t=[],e=[],r=[],n=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Un(u[i].name),a=Un(u[i].abbr),l=Un(u[i].narrow),e.push(s),t.push(a),r.push(l),n.push(s),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Z(0,["gg",2],0,function(){return this.weekYear()%100});Z(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Xu(t,e){Z(0,[t,t.length],0,e)}Xu("gggg","weekYear");Xu("ggggg","weekYear");Xu("GGGG","isoWeekYear");Xu("GGGGG","isoWeekYear");B("G",Uu);B("g",Uu);B("GG",We,vr);B("gg",We,vr);B("GGGG",Am,Hm);B("gggg",Am,Hm);B("GGGGG",zu,Bu);B("ggggg",zu,Bu);Xa(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=ge(t)});Xa(["gg","GG"],function(t,e,r,n){e[n]=L.parseTwoDigitYear(t)});function fA(t){return GT.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function gA(t){return GT.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function mA(){return Yn(this.year(),1,4)}function pA(){return Yn(this.isoWeekYear(),1,4)}function wA(){var t=this.localeData()._week;return Yn(this.year(),t.dow,t.doy)}function vA(){var t=this.localeData()._week;return Yn(this.weekYear(),t.dow,t.doy)}function GT(t,e,r,n,i){var o;return t==null?Pa(this,n,i).year:(o=Yn(t,n,i),e>o&&(e=o),yA.call(this,t,e,r,n,i))}function yA(t,e,r,n,i){var o=OT(t,e,r,n,i),s=Ia(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Z("Q",0,"Qo","quarter");B("Q",pT);Ae("Q",function(t,e){e[Bn]=(ge(t)-1)*3});function bA(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Z("D",["DD",2],"Do","date");B("D",We,Ss);B("DD",We,vr);B("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Ae(["D","DD"],pn);Ae("Do",function(t,e){e[pn]=ge(t.match(We)[0])});var KT=Rs("Date",!0);Z("DDD",["DDDD",3],"DDDo","dayOfYear");B("DDD",ju);B("DDDD",wT);Ae(["DDD","DDDD"],function(t,e,r){r._dayOfYear=ge(t)});function CA(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Z("m",["mm",2],0,"minute");B("m",We,Dm);B("mm",We,vr);Ae(["m","mm"],Zr);var SA=Rs("Minutes",!1);Z("s",["ss",2],0,"second");B("s",We,Dm);B("ss",We,vr);Ae(["s","ss"],jn);var RA=Rs("Seconds",!1);Z("S",0,0,function(){return~~(this.millisecond()/100)});Z(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Z(0,["SSS",3],0,"millisecond");Z(0,["SSSS",4],0,function(){return this.millisecond()*10});Z(0,["SSSSS",5],0,function(){return this.millisecond()*100});Z(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Z(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Z(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Z(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});B("S",ju,pT);B("SS",ju,vr);B("SSS",ju,wT);var di,XT;for(di="SSSS";di.length<=9;di+="S")B(di,Cs);function EA(t,e){e[Ki]=ge(("0."+t)*1e3)}for(di="S";di.length<=9;di+="S")Ae(di,EA);XT=Rs("Milliseconds",!1);Z("z",0,0,"zoneAbbr");Z("zz",0,0,"zoneName");function TA(){return this._isUTC?"UTC":""}function _A(){return this._isUTC?"Coordinated Universal Time":""}var N=Ga.prototype;N.add=v1;N.calendar=T1;N.clone=_1;N.diff=A1;N.endOf=j1;N.format=L1;N.from=F1;N.fromNow=V1;N.to=W1;N.toNow=$1;N.get=kx;N.invalidAt=Q1;N.isAfter=O1;N.isBefore=M1;N.isBetween=I1;N.isSame=P1;N.isSameOrAfter=x1;N.isSameOrBefore=H1;N.isValid=X1;N.lang=jT;N.locale=BT;N.localeData=zT;N.max=XH;N.min=KH;N.parsingFlags=Z1;N.set=Lx;N.startOf=B1;N.subtract=y1;N.toArray=q1;N.toObject=G1;N.toDate=Y1;N.toISOString=N1;N.inspect=k1;typeof Symbol<"u"&&Symbol.for!=null&&(N[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});N.toJSON=K1;N.toString=D1;N.unix=U1;N.valueOf=z1;N.creationData=J1;N.eraName=nA;N.eraNarrow=iA;N.eraAbbr=oA;N.eraYear=sA;N.year=bT;N.isLeapYear=Nx;N.weekYear=fA;N.isoWeekYear=gA;N.quarter=N.quarters=bA;N.month=TT;N.daysInMonth=Yx;N.week=N.weeks=eH;N.isoWeek=N.isoWeeks=tH;N.weeksInYear=wA;N.weeksInWeekYear=vA;N.isoWeeksInYear=mA;N.isoWeeksInISOWeekYear=pA;N.date=KT;N.day=N.days=gH;N.weekday=mH;N.isoWeekday=pH;N.dayOfYear=CA;N.hour=N.hours=RH;N.minute=N.minutes=SA;N.second=N.seconds=RA;N.millisecond=N.milliseconds=XT;N.utcOffset=o1;N.utc=a1;N.local=l1;N.parseZone=u1;N.hasAlignedHourOffset=c1;N.isDST=h1;N.isLocal=f1;N.isUtcOffset=g1;N.isUtc=FT;N.isUTC=FT;N.zoneAbbr=TA;N.zoneName=_A;N.dates=Fr("dates accessor is deprecated. Use date instead.",KT);N.months=Fr("months accessor is deprecated. Use month instead",TT);N.years=Fr("years accessor is deprecated. Use year instead",bT);N.zone=Fr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",s1);N.isDSTShifted=Fr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",d1);function OA(t){return Ve(t*1e3)}function MA(){return Ve.apply(null,arguments).parseZone()}function ZT(t){return t}var Re=Im.prototype;Re.calendar=fx;Re.longDateFormat=wx;Re.invalidDate=yx;Re.ordinal=Sx;Re.preparse=ZT;Re.postformat=ZT;Re.relativeTime=Ex;Re.pastFuture=Tx;Re.set=hx;Re.eras=eA;Re.erasParse=tA;Re.erasConvertYear=rA;Re.erasAbbrRegex=lA;Re.erasNameRegex=aA;Re.erasNarrowRegex=uA;Re.months=Bx;Re.monthsShort=jx;Re.monthsParse=Ux;Re.monthsRegex=Gx;Re.monthsShortRegex=qx;Re.week=Xx;Re.firstDayOfYear=Jx;Re.firstDayOfWeek=Qx;Re.weekdays=uH;Re.weekdaysMin=hH;Re.weekdaysShort=cH;Re.weekdaysParse=fH;Re.weekdaysRegex=wH;Re.weekdaysShortRegex=vH;Re.weekdaysMinRegex=yH;Re.isPM=CH;Re.meridiem=EH;function yu(t,e,r,n){var i=Gn(),o=En().set(n,e);return i[r](o,t)}function QT(t,e,r){if(qn(t)&&(e=t,t=void 0),t=t||"",e!=null)return yu(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=yu(t,n,r,"month");return i}function qm(t,e,r,n){typeof t=="boolean"?(qn(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,qn(e)&&(r=e,e=void 0),e=e||"");var i=Gn(),o=t?i._week.dow:0,s,a=[];if(r!=null)return yu(e,(r+o)%7,n,"day");for(s=0;s<7;s++)a[s]=yu(e,(s+o)%7,n,"day");return a}function IA(t,e){return QT(t,e,"months")}function PA(t,e){return QT(t,e,"monthsShort")}function xA(t,e,r){return qm(t,e,r,"weekdays")}function HA(t,e,r){return qm(t,e,r,"weekdaysShort")}function AA(t,e,r){return qm(t,e,r,"weekdaysMin")}wi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=ge(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});L.lang=Fr("moment.lang is deprecated. Use moment.locale instead.",wi);L.langData=Fr("moment.langData is deprecated. Use moment.localeData instead.",Gn);var xn=Math.abs;function DA(){var t=this._data;return this._milliseconds=xn(this._milliseconds),this._days=xn(this._days),this._months=xn(this._months),t.milliseconds=xn(t.milliseconds),t.seconds=xn(t.seconds),t.minutes=xn(t.minutes),t.hours=xn(t.hours),t.months=xn(t.months),t.years=xn(t.years),this}function JT(t,e,r,n){var i=nn(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function NA(t,e){return JT(this,t,e,1)}function kA(t,e){return JT(this,t,e,-1)}function cC(t){return t<0?Math.floor(t):Math.ceil(t)}function LA(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,o,s,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=cC(Pg(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Pr(t/1e3),n.seconds=i%60,o=Pr(i/60),n.minutes=o%60,s=Pr(o/60),n.hours=s%24,e+=Pr(s/24),l=Pr(e_(e)),r+=l,e-=cC(Pg(l)),a=Pr(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function e_(t){return t*4800/146097}function Pg(t){return t*146097/4800}function FA(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Vr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+e_(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(Pg(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function Kn(t){return function(){return this.as(t)}}var t_=Kn("ms"),VA=Kn("s"),WA=Kn("m"),$A=Kn("h"),BA=Kn("d"),jA=Kn("w"),zA=Kn("M"),UA=Kn("Q"),YA=Kn("y"),qA=t_;function GA(){return nn(this)}function KA(t){return t=Vr(t),this.isValid()?this[t+"s"]():NaN}function vo(t){return function(){return this.isValid()?this._data[t]:NaN}}var XA=vo("milliseconds"),ZA=vo("seconds"),QA=vo("minutes"),JA=vo("hours"),eD=vo("days"),tD=vo("months"),rD=vo("years");function nD(){return Pr(this.days()/7)}var Wn=Math.round,Xo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function iD(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function oD(t,e,r,n){var i=nn(t).abs(),o=Wn(i.as("s")),s=Wn(i.as("m")),a=Wn(i.as("h")),l=Wn(i.as("d")),u=Wn(i.as("M")),c=Wn(i.as("w")),h=Wn(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||s<=1&&["m"]||s<r.m&&["mm",s]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,iD.apply(null,d)}function sD(t){return t===void 0?Wn:typeof t=="function"?(Wn=t,!0):!1}function aD(t,e){return Xo[t]===void 0?!1:e===void 0?Xo[t]:(Xo[t]=e,t==="s"&&(Xo.ss=e-1),!0)}function lD(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Xo,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Xo,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),o=oD(this,!r,n,i),r&&(o=i.pastFuture(+this,o)),i.postformat(o)}var cf=Math.abs;function To(t){return(t>0)-(t<0)||+t}function Zu(){if(!this.isValid())return this.localeData().invalidDate();var t=cf(this._milliseconds)/1e3,e=cf(this._days),r=cf(this._months),n,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(n=Pr(t/60),i=Pr(n/60),t%=60,n%=60,o=Pr(r/12),r%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=To(this._months)!==To(a)?"-":"",c=To(this._days)!==To(a)?"-":"",h=To(this._milliseconds)!==To(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+s+"S":"")):"P0D"}var pe=Ku.prototype;pe.isValid=t1;pe.abs=DA;pe.add=NA;pe.subtract=kA;pe.as=FA;pe.asMilliseconds=t_;pe.asSeconds=VA;pe.asMinutes=WA;pe.asHours=$A;pe.asDays=BA;pe.asWeeks=jA;pe.asMonths=zA;pe.asQuarters=UA;pe.asYears=YA;pe.valueOf=qA;pe._bubble=LA;pe.clone=GA;pe.get=KA;pe.milliseconds=XA;pe.seconds=ZA;pe.minutes=QA;pe.hours=JA;pe.days=eD;pe.weeks=nD;pe.months=tD;pe.years=rD;pe.humanize=lD;pe.toISOString=Zu;pe.toString=Zu;pe.toJSON=Zu;pe.locale=BT;pe.localeData=zT;pe.toIsoString=Fr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Zu);pe.lang=jT;Z("X",0,0,"unix");Z("x",0,0,"valueOf");B("x",Uu);B("X",Ix);Ae("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Ae("x",function(t,e,r){r._d=new Date(ge(t))});//! moment.js
L.version="2.30.1";ux(Ve);L.fn=N;L.min=ZH;L.max=QH;L.now=JH;L.utc=En;L.unix=OA;L.months=IA;L.isDate=qa;L.locale=wi;L.invalid=$u;L.duration=nn;L.isMoment=tn;L.weekdays=xA;L.parseZone=MA;L.localeData=Gn;L.isDuration=tu;L.monthsShort=PA;L.weekdaysMin=AA;L.defineLocale=Vm;L.updateLocale=MH;L.locales=IH;L.weekdaysShort=HA;L.normalizeUnits=Vr;L.relativeTimeRounding=sD;L.relativeTimeThreshold=aD;L.calendarFormat=E1;L.prototype=N;L.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function uD(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function hC(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function hf(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let o=0;o<n;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function yo(t,e,r,n){let i=-1,o=t,s=r;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Gm(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(s+=1,o[s]=a),r+=1}return o}function bn(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,o=[];let s=-1;for(;r<i;){const a=n[r];s+=1,o[s]=e(a,r,n),r+=1}return o}function $(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function dC(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let o=n;return $(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function fC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function rr(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return yo(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return o+l+u},"").trim()}function is(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function fe(t){return typeof t<"u"}function Vt(t){return typeof t>"u"}function no(t){return t===null||t===""||Vt(t)}function cD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const ca="length",ya=t=>parseInt(t,16),gC=t=>parseInt(t,10),bu=(t,e,r)=>t.substr(e,r),ba=t=>t.codePointAt(0)-65,xg=t=>`${t}`.replace(/\-/g,""),hD=t=>ya(bu(xg(t),ya("12"),ba("F")))/(ya(bu(xg(t),ba("B"),~~![][ca]))||9),dD=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let mC=!1;const pC={invalid:()=>rr`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return rr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>rr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},wC={invalid:()=>rr`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return rr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>rr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function fD(t,e){const r=!no(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let o,s="invalid",a="invalid";t=xg(t||"");const l=gD(t);if(r||n||l)if(l){const u=L("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=hD(t);o=L((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else n?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(dD()&&(s="valid",a="valid"),!mC&&s!=="valid"&&(pC[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](pC[s]({keyValidityDate:o,hotVersion:i})),mC=!0),a!=="valid"&&e&&wC[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=wC[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function gD(t){let e=[][ca],r=e;if(t[ca]!==ba("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=ba(i.shift());o;o=ba(i.shift()||"A"))--o<""[ca]?r=r|(gC(`${gC(ya(n)+(ya(bu(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=bu(t,o,o?i[ca]===1?9:8:6);return r===e}function Qu(t){return t[0].toUpperCase()+t.substr(1)}function r_(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function mD(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function pD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function n_(t,e){return lx.sanitize(t,e)}const bo=t=>["tabindex",t],wD=()=>["role","treegrid"],fi=()=>["role","presentation"],vD=()=>["role","gridcell"],yD=()=>["role","gridcell button"],bD=()=>["role","rowheader"],i_=()=>["role","rowgroup"],CD=()=>["role","columnheader"],o_=()=>["role","row"],SD=()=>["role","menu"],RD=()=>["role","menuitem"],ED=()=>["role","menuitemcheckbox"],TD=()=>["scope","col"],_D=()=>["scope","row"],Cu=t=>["aria-label",t],OD=()=>["aria-hidden","true"],MD=()=>["aria-disabled","true"],ID=()=>["aria-multiselectable","true"],s_=t=>["aria-rowcount",t],Ju=t=>["aria-colcount",t],a_=t=>["aria-rowindex",t],Km=t=>["aria-colindex",t],nu=t=>["aria-expanded",t],vC=()=>["aria-readonly","true"],yC=()=>["aria-invalid","true"],PD=t=>["aria-checked",t],l_=()=>["aria-selected","true"];var bC={},df,CC;function xD(){if(CC)return df;CC=1;var t=tt(),e=jE(),r=at(),n=co(),i=Wu(),o=t([].push);return df=function(s){if(r(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||n(c)==="Number"||n(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(g,w){if(d)return d=!1,w;if(e(this))return w;for(var y=0;y<h;y++)if(l[y]===g)return w}}},df}var SC;function HD(){if(SC)return bC;SC=1;var t=Le(),e=ps(),r=za(),n=pt(),i=tt(),o=st(),s=at(),a=mm(),l=Tm(),u=xD(),c=gm(),h=String,d=e("JSON","stringify"),g=i(/./.exec),w=i("".charAt),y=i("".charCodeAt),b=i("".replace),E=i(1.1.toString),v=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,M=!c||o(function(){var U=e("Symbol")("stringify detection");return d([U])!=="[null]"||d({a:U})!=="{}"||d(Object(U))!=="{}"}),P=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),x=function(U,H){var G=l(arguments),J=u(H);if(!(!s(J)&&(U===void 0||a(U))))return G[1]=function(ae,q){if(s(J)&&(q=n(J,this,h(ae),q)),!a(q))return q},r(d,null,G)},F=function(U,H,G){var J=w(G,H-1),ae=w(G,H+1);return g(T,U)&&!g(_,ae)||g(_,U)&&!g(T,J)?"\\u"+E(y(U,0),16):U};return d&&t({target:"JSON",stat:!0,arity:3,forced:M||P},{stringify:function(H,G,J){var ae=l(arguments),q=r(M?x:d,null,ae);return P&&typeof q=="string"?b(q,v,F):q}}),bC}HD();function Ha(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Oe(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Ha(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Ha(r[0])]:e[n]=[]:e[n]=null)})),e}function AD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function bi(t,e,r){const n=Array.isArray(r);return Oe(e,(i,o)=>{(n===!1||r.includes(o))&&(t[o]=i)}),t}function u_(t,e){Oe(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),u_(t[n],e[n])):t[n]=e[n]})}function mr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Xe(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return $(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Oe(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=w=>{let y=w;return(Array.isArray(y)||Ct(y))&&(y=mr(y)),y};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function c_(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ct(t){return Object.prototype.toString.call(t)==="[object Object]"}function Xn(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Oe(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function DD(t,e){const r=e.split(".");let n=t;return Oe(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function ff(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==n.length-1?(Cn(i,o)||(i[o]={}),i=i[o]):i[o]=r)})}function Xm(t){if(!Ct(t))return 0;const e=function(r){let n=0;return Ct(r)?Oe(r,(i,o)=>{o!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function dr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function Cn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Hg(t){return window.requestAnimationFrame(t)}function RC(t){window.cancelAnimationFrame(t)}function ND(){return"ontouchstart"in window}function kD(){return typeof window<"u"}const Mr=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},_i={chrome:Mr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Mr(t=>/CriOS/.test(t)),edge:Mr(t=>/Edge/.test(t)),edgeWebKit:Mr(t=>/EdgiOS/.test(t)),firefox:Mr(t=>/Firefox/.test(t)),firefoxWebKit:Mr(t=>/FxiOS/.test(t)),mobile:Mr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Mr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Za={mac:Mr(t=>/^Mac/.test(t)),win:Mr(t=>/^Win/.test(t)),linux:Mr(t=>/^Linux/.test(t)),ios:Mr(t=>/iPhone|iPad|iPod/i.test(t))};function LD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oe(_i,r=>{let{test:n}=r;return void n(t,e)})}function FD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oe(Za,e=>{let{test:r}=e;return void r(t)})}kD()&&(LD(),FD());function VD(){return _i.chrome.value}function WD(){return _i.chromeWebKit.value}function gf(){return _i.firefox.value}function $D(){return _i.firefoxWebKit.value}function Zm(){return _i.safari.value}function BD(){return _i.edge.value}function gi(){return _i.mobile.value}function h_(){return Za.ios.value}function d_(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Za.mac.value}function Ag(){return Za.win.value}function EC(){return Za.mac.value}function jD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function iu(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function zD(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Aa(t){return zD(t)&&t.parent}function f_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==r;){const{nodeType:s,nodeName:a}=o;if(s===n&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function cl(t,e,r){const n=[];let i=t;for(;i&&(i=f_(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=n.length;return o?n[o-1]:null}function UD(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(o=>e.test(o));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function os(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function YD(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Pi(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function g_(t){return!t||!t.length?[]:t.filter(e=>!!e)}function m_(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&r.push(i),!o})),{regexFree:n,regexes:r}}function ve(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function X(t,e){typeof e=="string"&&(e=e.split(" ")),e=g_(e),e.length>0&&t.classList.add(...e)}function He(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=m_(e,!0);r=g_(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function _e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Qa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=m_(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function p_(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)p_(e[r])}}function cs(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const qD=/(<(.*)>|&(.*);)/;function w_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;qD.test(e)?t.innerHTML=r?n_(e):e:Ja(t,e)}function Ja(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(cs(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Da(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Da(n.host.impl);if(n.host)return Da(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function GD(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function xr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=r.pageXOffset||n.scrollLeft,s+=r.pageYOffset||n.scrollTop),{left:o,top:s}}function v_(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Qm(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Jm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?v_(e):t.scrollTop}function y_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Qm(e):t.scrollLeft}function Su(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=r.getComputedStyle(i),n.includes(o)||n.includes(s)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(o))||i.clientWidth<=i.scrollWidth+1&&(n.includes(s)||n.includes(o)))return i;i=i.parentNode}return r}function KD(t){return t.scrollHeight-t.clientHeight}function XD(t){return t.scrollWidth-t.clientWidth}function Ru(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return n;n=n.parentNode}return r}function TC(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function tr(t){return t.offsetWidth}function nr(t){return t.offsetHeight}function Ca(t){return t.clientHeight||t.innerHeight}function b_(t){return t.clientWidth||t.innerWidth}function ZD(t){return t.selectionStart?t.selectionStart:0}function _C(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function C_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=o}}}let mf;function QD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ag()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function JD(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");Zm()&&!gi()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i+QD(t)}function ir(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return mf===void 0&&(mf=JD(t)),mf}function eN(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function tN(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function ep(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function ec(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function ou(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function S_(t){return ou(t)&&t.hasAttribute("data-hot-input")===!1}function rN(t,e){new IntersectionObserver((n,i)=>{n.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function R_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();_e(t,"contenteditable",!0),r&&_e(t,...OD()),e&&X(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function E_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&He(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function nN(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R_(t,r),e(),E_(t,r)}function eo(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}function Pe(t){return typeof t=="function"}function T_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,s)},e),n}return i}function iN(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,r.concat(s))}}function Dg(t,e,r,n,i,o,s,a){return fe(a)?t.call(e,r,n,i,o,s,a):fe(s)?t.call(e,r,n,i,o,s):fe(o)?t.call(e,r,n,i,o):fe(i)?t.call(e,r,n,i):fe(n)?t.call(e,r,n):fe(r)?t.call(e,r):t.call(e)}const Q={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:gf()?182:174,AUDIO_MUTE:gf()?181:173,AUDIO_UP:gf()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},oN=[Q.ALT,Q.ARROW_DOWN,Q.ARROW_LEFT,Q.ARROW_RIGHT,Q.ARROW_UP,Q.AUDIO_DOWN,Q.AUDIO_MUTE,Q.AUDIO_UP,Q.BACKSPACE,Q.CAPS_LOCK,Q.DELETE,Q.END,Q.ENTER,Q.ESCAPE,Q.F1,Q.F2,Q.F3,Q.F4,Q.F5,Q.F6,Q.F7,Q.F8,Q.F9,Q.F10,Q.F11,Q.F12,Q.F13,Q.F14,Q.F15,Q.F16,Q.F17,Q.F18,Q.F19,Q.HOME,Q.INSERT,Q.MEDIA_NEXT,Q.MEDIA_PLAY_PAUSE,Q.MEDIA_PREV,Q.MEDIA_STOP,Q.NULL,Q.NUM_LOCK,Q.PAGE_DOWN,Q.PAGE_UP,Q.PAUSE,Q.SCROLL_LOCK,Q.SHIFT,Q.TAB];function sN(t){return oN.includes(t)}function aN(t){return[Q.CONTROL,Q.COMMAND_LEFT,Q.COMMAND_RIGHT,Q.COMMAND_FIREFOX].includes(t)}function lN(t,e){const r=e.split("|");let n=!1;return $(r,i=>{if(t===Q[i])return n=!0,!1}),n}function tc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Yi(t){return t.isImmediatePropagationEnabled===!1}function Eu(t){return t.button===2}function __(t){return t.button===0}function Sn(){fe(console)&&console.warn(...arguments)}function uN(){fe(console)&&console.error(...arguments)}const qi=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],pf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),wf=new Map([[]]);var OC={},vf,MC;function cN(){if(MC)return vf;MC=1;var t=ys();return vf=function(e,r,n){for(var i=0,o=arguments.length>2?n:t(r),s=new e(o);o>i;)s[i]=r[i++];return s},vf}var yf,IC;function hN(){if(IC)return yf;IC=1;var t=et();return yf=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},yf}var bf,PC;function tp(){if(PC)return bf;PC=1;var t=rn(),e=Em(),r=Ei().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),bf=function(o){i[n][o]=!0},bf}var xC;function dN(){if(xC)return OC;xC=1;var t=Le(),e=tt(),r=pr(),n=Wa(),i=cN(),o=hN(),s=tp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&r(c);var h=n(this),d=i(a,h);return l(d,c)}}),s("toSorted"),OC}dN();var HC={},AC={},DC;function fN(){if(DC)return AC;DC=1;var t=Le(),e=pt(),r=bs(),n=pr(),i=wt(),o=Ti(),s=wr(),a=wo(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w(g)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),AC}var NC;function gN(){return NC||(NC=1,fN()),HC}gN();function mN(t,e){O_(t,e),e.add(t)}function Cf(t,e,r){O_(t,e),e.set(t,r)}function O_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kC(t,e,r){return t.set(Tu(t,e),r),r}function yt(t,e){return t.get(Tu(t,e))}function Tu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pN=100;var lr=new WeakMap,qo=new WeakMap,Sf=new WeakMap,Rf=new WeakSet;class LC{constructor(){mN(this,Rf),Cf(this,lr,new Map),Cf(this,qo,new Map),Cf(this,Sf,new Set),qi.forEach(e=>Tu(Rf,this,FC).call(this,e))}getHooks(e){var r;return(r=yt(lr,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};yt(lr,this).has(e)||(Tu(Rf,this,FC).call(this,e),qi.push(e));const i=yt(lr,this).get(e);if(i.find(u=>u.callback===r))return;const o=Number.isInteger(n.orderIndex)?n.orderIndex:0,s=!!n.runOnce,a=!!n.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=r,l=!0)}if(!l){i.push({callback:r,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=yt(Sf,this).has(e);!u&&o!==0&&(u=!0,yt(Sf,this).add(e)),u&&i.length>1&&yt(lr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return yt(lr,this).has(e)&&yt(lr,this).get(e).length>0}remove(e,r){if(!yt(lr,this).has(e))return!1;const n=yt(lr,this).get(e),i=n.find(o=>o.callback===r);if(i){let o=yt(qo,this).get(e);return i.skip=!0,o+=1,o>pN&&(yt(lr,this).set(e,n.filter(s=>!s.skip)),o=0),yt(qo,this).set(e,o),!0}return!1}destroy(){yt(lr,this).clear(),yt(qo,this).clear(),kC(lr,this,null),kC(qo,this,null)}}function FC(t){yt(lr,this).set(t,[]),yt(qo,this).set(t,0)}function wN(t,e,r){return(e=vN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vN(t){var e=yN(t,"string");return typeof e=="symbol"?e:e+""}function yN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bN=rr`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class de{constructor(){wN(this,"globalBucket",new LC)}static getSingleton(){return SN()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new LC),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?$(r,o=>this.add(e,o,n)):(pf.has(e)&&Sn(pD(bN,{hookName:e,removedInVersion:pf.get(e)})),wf.has(e)&&Sn(wf.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?$(r,o=>this.once(e,o,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?$(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,o,s,a,l){{const u=this.getBucket().getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Dg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(r),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Dg(u[h].callback,e,n,i,o,s,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h].callback,e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||qi.push(e)}deregister(e){this.isRegistered(e)&&qi.splice(qi.indexOf(e),1)}isDeprecated(e){return wf.has(e)||pf.has(e)}isRegistered(e){return qi.indexOf(e)>=0}getRegistered(){return qi}}const CN=new de;function SN(){return CN}const Xi=new Map;function Co(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Xi.has(t)||Xi.set(t,new Map);const e=Xi.get(t);function r(l,u){e.set(l,u)}function n(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){Xi.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:o,getValues:s,clear:a}}function RN(t,e){var r;return Xi==null||(r=Xi.get(t.guid))===null||r===void 0?void 0:r.get(e)}const Ng=new WeakMap,{register:EN,getItem:M_,hasItem:I_}=Co("editors");function TN(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function _N(t,e){let r;if(typeof t=="function")Ng.get(t)||P_(null,t),r=Ng.get(t);else if(typeof t=="string")r=M_(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function VC(t){if(typeof t=="function")return t;if(!I_(t))throw Error(`No registered editor found under "${t}" name`);return M_(t).getConstructor()}function P_(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new TN(e);typeof t=="string"&&EN(t,r),Ng.set(e,r)}function ON(t,e,r){return(e=MN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MN(t){var e=IN(t,"string");return typeof e=="symbol"?e:e+""}function IN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ci{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ON(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){n.call(this,PN(s))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(r,o,i),()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===r&&s.element===e){if(n&&n!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const o={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;n.createEvent?(s=n.createEvent("MouseEvents"),s.initMouseEvent(r,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,n.body.parentNode)):s=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${r}`,s)}}function PN(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),tc(this)},t}function xN(t,e){HN(t,e),e.add(t)}function HN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e,r){return(e=AN(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AN(t){var e=DN(t,"string");return typeof e=="symbol"?e:e+""}function DN(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ef(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hl=new WeakSet;class kg{constructor(e,r,n){xN(this,hl),xi(this,"hot",void 0),xi(this,"tableMeta",void 0),xi(this,"selection",void 0),xi(this,"eventManager",void 0),xi(this,"destroyed",!1),xi(this,"activeEditor",void 0),xi(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Ci(e),this.hot.addHook("afterDocumentKeyDown",i=>Ef(hl,this,WC).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>Ef(hl,this,WC).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Ef(hl,this,NN).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let s=n,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=_N(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(n))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function WC(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Yi(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!sN(r)&&!aN(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function NN(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const $C=new WeakMap;kg.getInstance=function(t,e,r){let n=$C.get(t);return n||(n=new kg(t,e,r),$C.set(t,n)),n};function kN(t,e){x_(t,e),e.add(t)}function Ls(t,e,r){x_(t,e),e.set(t,r)}function x_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ne(t,e){return t.get($n(t,e))}function Fs(t,e,r){return t.set($n(t,e),r),r}function $n(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ss=Object.freeze({CELL:"cell",MIXED:"mixed"});var it=new WeakMap,dl=new WeakMap,fl=new WeakMap,gl=new WeakMap,ml=new WeakMap,li=new WeakSet;class LN{constructor(e){var r=this;kN(this,li),Ls(this,it,void 0),Ls(this,dl,void 0),Ls(this,fl,1),Ls(this,gl,null),Ls(this,ml,new Map);const n=e.getSettings();Fs(it,this,e),Fs(dl,this,n.imeFastEdit?ss.MIXED:ss.CELL),Ne(it,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,VN).call(r,...o)}),Ne(it,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,BC).call(r,...o)}),Ne(it,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,BC).call(r,...o)}),Ne(it,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return $n(li,r,FN).call(r,...o)})}getFocusMode(){return Ne(dl,this)}setFocusMode(e){Object.values(ss).includes(e)?Fs(dl,this,e):Sn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ne(fl,this)}setRefocusDelay(e){Fs(fl,this,e)}setRefocusElementGetter(e){Fs(gl,this,e)}getRefocusElement(){var e;return typeof Ne(gl,this)=="function"?Ne(gl,this).call(this):(e=Ne(it,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,o;const s=(i=Ne(it,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Ne(it,this).runHooks("modifyFocusedElement",s.row,s.col,n);eo(a)||(a=n),a&&!((o=Ne(it,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?r(e):$n(li,this,rp).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ne(fl,this);if(Ne(it,this).getSettings().imeFastEdit&&!((e=Ne(it,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=Ne(it,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),Ne(ml,this).has(r)||Ne(ml,this).set(r,T_(()=>{if(!Ne(it,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},r)),Ne(ml,this).get(r)()}}}function rp(t){var e;const r=(e=Ne(it,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!Ne(it,this).selection.isCellVisible(r)){t(null);return}const n=Ne(it,this).getCell(r.row,r.col,!0);n===null?Ne(it,this).addHookOnce("afterScroll",()=>{t(Ne(it,this).getCell(r.row,r.col,!0))}):t(n)}function BC(){$n(li,this,rp).call(this,t=>{const{activeElement:e}=Ne(it,this).rootDocument;e&&S_(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function FN(){$n(li,this,rp).call(this,t=>{this.getFocusMode()===ss.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function VN(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?ss.MIXED:ss.CELL)}var jC={},Tf,zC;function WN(){if(zC)return Tf;zC=1;var t=kr(),e=co(),r=rn(),n=r("match");return Tf=function(i){var o;return t(i)&&((o=i[n])!==void 0?!!o:e(i)==="RegExp")},Tf}var _f,UC;function $N(){if(UC)return _f;UC=1;var t=et(),e=st(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,g){Object.defineProperty(o,d,{get:function(){return s+=g,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(o);return h!==a||s!==a});return _f={correct:n},_f}var Of,YC;function BN(){if(YC)return Of;YC=1;var t=wt();return Of=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},Of}var Mf,qC;function jN(){if(qC)return Mf;qC=1;var t=pt(),e=Lr(),r=$a(),n=$N(),i=BN(),o=RegExp.prototype;return Mf=n.correct?function(s){return s.flags}:function(s){return!n.correct&&r(o,s)&&!e(s,"flags")?t(i,s):s.flags},Mf}var If,GC;function zN(){if(GC)return If;GC=1;var t=tt(),e=ws(),r=Math.floor,n=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return If=function(l,u,c,h,d,g){var w=c+l.length,y=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(g,b,function(E,v){var T;switch(n(v,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,w);case"<":T=d[o(v,1,-1)];break;default:var _=+v;if(_===0)return E;if(_>y){var M=r(_/10);return M===0?E:M<=y?h[M-1]===void 0?n(v,1):h[M-1]+n(v,1):E}T=h[_-1]}return T===void 0?"":T})},If}var KC;function UN(){if(KC)return jC;KC=1;var t=Le(),e=pt(),r=tt(),n=Va(),i=at(),o=kr(),s=WN(),a=Wu(),l=Ba(),u=jN(),c=zN(),h=rn(),d=ho(),g=h("replace"),w=TypeError,y=r("".indexOf),b=r("".replace),E=r("".slice),v=Math.max;return t({target:"String",proto:!0},{replaceAll:function(_,M){var P=n(this),x,F,U,H,G,J,ae,q,ee,lt,Ee=0,ye="";if(o(_)){if(x=s(_),x&&(F=a(n(u(_))),!~y(F,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(U=l(_,g),U)return e(U,_,P,M);if(d&&x)return b(a(P),_,M)}for(H=a(P),G=a(_),J=i(M),J||(M=a(M)),ae=G.length,q=v(1,ae),ee=y(H,G);ee!==-1;)lt=J?a(M(G,ee,H)):c(G,H,ee,[],void 0,M),ye+=E(H,Ee,ee)+lt,Ee=ee+ae,ee=ee+q>H.length?-1:y(H,G,ee+q);return Ee<H.length&&(ye+=E(H,Ee)),ye}}),jC}UN();var XC={},ZC={},QC;function YN(){if(QC)return ZC;QC=1;var t=Le(),e=bs(),r=pr(),n=wt(),i=Ti(),o=wr(),s=wo(),a=za(),l=st(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(g){n(this);try{r(g)}catch(v){o(this,"throw",v)}var w=arguments.length<2,y=w?void 0:arguments[1];if(h)return a(h,this,w?[g]:[g,y]);var b=i(this),E=0;if(e(b,function(v){w?(w=!1,y=v):y=g(y,v,E),E++},{IS_RECORD:!0}),w)throw new u("Reduce of empty iterator with no initial value");return y}}),ZC}var JC;function qN(){return JC||(JC=1,YN()),XC}qN();const H_={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},GN=new RegExp(Object.keys(H_).map(t=>`(${t})`).join("|"),"gi");function KN(t){return(t&&t.nodeName||"")==="TABLE"}function eS(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,w=[];for(let b=0;b<s;b+=1){const E=!g&&r&&b===0;let v="";if(g)v=`<th>${t.getColHeader(b-c)}</th>`;else if(E)v=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][b],{hidden:_,rowspan:M,colspan:P}=t.getCellMeta(d-h,b-c);if(!_){const x=[];if(M&&x.push(`rowspan="${M}"`),P&&x.push(`colspan="${P}"`),no(T))v=`<td ${x.join(" ")}></td>`;else{const F=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");v=`<td ${x.join(" ")}>${F}</td>`}}}w.push(v)}const y=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,y):u.splice(-1,0,y)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function tS(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],o=i.length,s=[];n===0&&r.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=no(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}r.push("<tr>",...s,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function XN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const M=_.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,x=_.substring(M.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${M}${x}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!KN(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,_)=>T+_.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,w=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(_=>{const M=_.querySelector("td")!==null;return M&&h.push(_),!M});g=T.length,d=g>0,g>1?r.nestedHeaders=Array.from(T).reduce((_,M)=>{const P=Array.from(M.cells).reduce((x,F,U)=>{if(a&&U===0)return x;const{colSpan:H,innerHTML:G}=F,J=H>1?{label:G,colspan:H}:G;return x.push(J),x},[]);return _.push(P),_},[]):d&&(r.colHeaders=Array.from(T[0].children).reduce((_,M,P)=>(a&&P===0||_.push(M.innerHTML),_),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const y=[...h,...Array.from(o.tBodies).reduce((T,_)=>(T.push(...Array.from(_.rows)),T),[]),...c];w=y.length;const b=new Array(w);for(let T=0;T<w;T++)b[T]=new Array(u);const E=[],v=[];for(let T=0;T<w;T++){const _=y[T],M=Array.from(_.cells),P=M.length;for(let x=0;x<P;x++){const F=M[x],{nodeName:U,innerHTML:H,rowSpan:G,colSpan:J}=F,ae=b[T].findIndex(q=>q===void 0);if(U==="TD"){if(G>1||J>1){for(let Ee=T;Ee<T+G;Ee++)if(Ee<w)for(let ye=ae;ye<ae+J;ye++)b[Ee][ye]=null;const ee=F.getAttribute("style");ee&&ee.includes("mso-ignore:colspan")||E.push({col:ae,row:T,rowspan:G,colspan:J})}let q="";s&&/excel/gi.test(s.content)?q=H.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):q=H.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[T][ae]=q.replace(GN,ee=>H_[ee])}else v.push(H)}}return E.length&&(r.mergeCells=E),v.length&&(r.rowHeaders=v),b.length&&(r.data=b),r}function A_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function ZN(t){return A_(t,[","])}function Ye(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function rS(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function QN(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function De(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const Lg="asc",JN="desc",nS=new Map([[Lg,[-1,1]],[JN,[1,-1]]]),ek=t=>`The priority '${t}' is already declared in a map.`,tk=t=>`The priority '${t}' is not a number.`;function rk(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Pe(t)?t:ek,e=Pe(e)?e:tk;function n(o,s){if(!A_(o))throw new Error(e(o));if(r.has(o))throw new Error(t(o));r.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lg;const[s,a]=nS.get(o)||nS.get(Lg);return[...r].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:n,getItems:i}}const nk=t=>`The id '${t}' is already declared in a map.`;function rc(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Pe(t)?t:nk;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:n}}const ik=t=>`'${t}' value is already declared in a unique set.`;function ok(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Pe(t)?t:ik;function r(o){if(e.has(o))throw new Error(t(o));e.add(o)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const np=t=>`There is already registered "${t}" plugin.`,sk=t=>`There is already registered plugin on priority "${t}".`,ak=t=>`The priority "${t}" is not a number.`,D_=rk({errorPriorityExists:sk,errorPriorityNaN:ak}),N_=ok({errorItemExists:np}),Fg=rc({errorIdExists:np});function k_(){return[...D_.getItems(),...N_.getItems()]}function ip(t){const e=Qu(t);return Fg.getItem(e)}function lk(t){return!!ip(t)}function pl(t,e,r){[t,e,r]=ck(t,e,r),ip(t)===void 0&&uk(t,e,r)}function uk(t,e,r){const n=Qu(t);if(Fg.hasItem(n))throw new Error(np(n));r===void 0?N_.addItem(n):D_.addItem(r,n),Fg.addItem(n,e)}function ck(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:hk,getItem:dk,hasItem:L_}=Co("renderers");function iS(t){if(typeof t=="function")return t;if(!L_(t))throw Error(`No registered renderer found under "${t}" name`);return dk(t)}function fk(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),hk(t,e)}const{register:gk,getItem:mk,hasItem:F_}=Co("validators");function pk(t){if(typeof t=="function")return t;if(!F_(t))throw Error(`No registered validator found under "${t}" name`);return mk(t)}function wk(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),gk(t,e)}var oS={},sS;function vk(){if(sS)return oS;sS=1;var t=Le(),e=ws(),r=ys(),n=ja(),i=tp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=r(a),u=n(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),oS}vk();var aS={},lS;function yk(){if(lS)return aS;lS=1;var t=Le(),e=tt(),r=Va(),n=ja(),i=Wu(),o=st(),s=e("".charAt),a=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(r(this)),h=c.length,d=n(u),g=d>=0?d:h+d;return g<0||g>=h?void 0:s(c,g)}}),aS}yk();function Vs(t,e,r){return(e=bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bk(t){var e=Ck(t,"string");return typeof e=="symbol"?e:e+""}function Ck(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sk{constructor(){Vs(this,"count",0),Vs(this,"startColumn",null),Vs(this,"endColumn",null),Vs(this,"startPosition",null),Vs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=r,a=i>0?o+1:o;n>=i&&n+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=u[this.endColumn]+c-u[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i,d=n+i-h,g=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||n>u.at(-1)||-1*n-i>-1*g?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ws(t,e,r){return(e=Rk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rk(t){var e=Ek(t,"string");return typeof e=="symbol"?e:e+""}function Ek(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tk{constructor(){Ws(this,"count",0),Ws(this,"startRow",null),Ws(this,"endRow",null),Ws(this,"startPosition",null),Ws(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=r;n>=i&&n+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function $s(t,e,r){return(e=_k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _k(t){var e=Ok(t,"string");return typeof e=="symbol"?e:e+""}function Ok(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_{constructor(){$s(this,"count",0),$s(this,"startColumn",null),$s(this,"endColumn",null),$s(this,"startPosition",null),$s(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:o}=r;n<=i&&(this.startColumn=e);const s=i>0?o+1:o;n>=i&&n<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,g>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=s>0?i+1:i;n+i-h<-1*o||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Bs(t,e,r){return(e=Mk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mk(t){var e=Ik(t,"string");return typeof e=="symbol"?e:e+""}function Ik(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W_{constructor(){Bs(this,"count",0),Bs(this,"startRow",null),Bs(this,"endRow",null),Bs(this,"startPosition",null),Bs(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:o}=r;n<=i&&(this.startRow=e),n>=i&&n<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-o<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function js(t,e,r){return(e=Pk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pk(t){var e=xk(t,"string");return typeof e=="symbol"?e:e+""}function xk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hk{constructor(){js(this,"count",0),js(this,"startColumn",0),js(this,"endColumn",0),js(this,"startPosition",0),js(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function zs(t,e,r){return(e=Ak(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ak(t){var e=Dk(t,"string");return typeof e=="symbol"?e:e+""}function Dk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nk{constructor(){zs(this,"count",0),zs(this,"startRow",0),zs(this,"endRow",0),zs(this,"startPosition",0),zs(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function uS(t,e,r){return(e=kk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kk(t){var e=Lk(t,"string");return typeof e=="symbol"?e:e+""}function Lk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fk extends V_{constructor(){super(...arguments),uS(this,"columnStartOffset",0),uS(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof n=="function"){const s=this.startColumn,a=this.endColumn;n(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=o[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function cS(t,e,r){return(e=Vk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vk(t){var e=Wk(t,"string");return typeof e=="symbol"?e:e+""}function Wk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $k extends W_{constructor(){super(...arguments),cS(this,"rowStartOffset",0),cS(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof n=="function"){const s=this.startRow,a=this.endRow;n(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(r=o[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function hS(t,e,r){return(e=Bk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bk(t){var e=jk(t,"string");return typeof e=="symbol"?e:e+""}function jk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $_{constructor(e){hS(this,"calculationTypes",[]),hS(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Br(t,e,r){return(e=zk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zk(t){var e=Uk(t,"string");return typeof e=="symbol"?e:e+""}function Uk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const op=50;class Yk extends $_{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(r),Br(this,"viewportWidth",0),Br(this,"scrollOffset",0),Br(this,"zeroBasedScrollOffset",0),Br(this,"totalColumns",0),Br(this,"columnWidthFn",null),Br(this,"columnWidth",0),Br(this,"overrideFn",null),Br(this,"inlineStartOffset",0),Br(this,"totalCalculatedWidth",0),Br(this,"startPositions",[]),Br(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?op:r}}function Sr(t,e,r){return(e=qk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qk(t){var e=Gk(t,"string");return typeof e=="symbol"?e:e+""}function Gk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kk extends $_{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(r),Sr(this,"viewportHeight",0),Sr(this,"scrollOffset",0),Sr(this,"zeroBasedScrollOffset",0),Sr(this,"totalRows",0),Sr(this,"rowHeightFn",null),Sr(this,"rowHeight",0),Sr(this,"overrideFn",null),Sr(this,"horizontalScrollbarHeight",0),Sr(this,"innerViewportHeight",0),Sr(this,"totalCalculatedHeight",0),Sr(this,"startPositions",[]),Sr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Xk(t,e,r){Zk(t,e),e.set(t,r)}function Zk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dS(t,e,r){return(e=Qk(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qk(t){var e=Jk(t,"string");return typeof e=="symbol"?e:e+""}function Jk(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _o(t,e){return t.get(B_(t,e))}function fS(t,e,r){return t.set(B_(t,e),r),r}function B_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hn=new WeakMap;class io{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;dS(this,"row",null),dS(this,"col",null),Xk(this,Hn,!1),fS(Hn,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _o(Hn,this)}isSouthEastOf(e){return this.row>=e.row&&(_o(Hn,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(_o(Hn,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(_o(Hn,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(_o(Hn,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof io&&fS(Hn,this,e.isRtl()),this}clone(){return new io(this.row,this.col,_o(Hn,this))}toObject(){return{row:this.row,col:this.col}}}function eL(t,e,r){tL(t,e),e.set(t,r)}function tL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pf(t,e,r){return(e=rL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rL(t){var e=nL(t,"string");return typeof e=="symbol"?e:e+""}function nL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rr(t,e){return t.get(j_(t,e))}function iL(t,e,r){return t.set(j_(t,e),r),r}function j_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zt=new WeakMap;class el{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Pf(this,"highlight",null),Pf(this,"from",null),Pf(this,"to",null),eL(this,zt,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),iL(zt,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=r&&o.row>=r&&i.col<=n&&o.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,s.row),u=Math.min(n.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),g=this._createCellCoords(c,h);return this.from=d,this.to=g,this.setDirection(o),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Rr(zt,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Rr(zt,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Rr(zt,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Rr(zt,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Rr(zt,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Rr(zt,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Rr(zt,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Rr(zt,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof io))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Rr(zt,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Rr(zt,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&n.push(this._createCellCoords(i,o));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let o=e.col;o<=r.col;o++)e.row===i&&e.col===o?n.push(e):r.row===i&&r.col===o?n.push(r):n.push(this._createCellCoords(i,o));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let o=r.col;o<=n.col;o++)if(e(i,o)===!1)return}clone(){return new el(this.highlight,this.from,this.to,Rr(zt,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new io(e,r,Rr(zt,this))}}function ln(t,e,r){oL(t,e),e.set(t,r)}function oL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z(t,e){return t.get(z_(t,e))}function Jn(t,e,r){return t.set(z_(t,e),r),r}function z_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Er=new WeakMap,xf=new WeakMap,mt=new WeakMap,Oo=new WeakMap,wl=new WeakMap,jr=new WeakMap,Hf=new WeakMap,Us=new WeakMap,Hi=new WeakMap,un=new WeakMap;let U_=class{constructor(e,r,n,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ln(this,Er,void 0),ln(this,xf,void 0),ln(this,mt,void 0),ln(this,Oo,void 0),ln(this,wl,void 0),ln(this,jr,void 0),ln(this,Hf,void 0),ln(this,Us,void 0),ln(this,Hi,[null,null]),ln(this,un,[null,null]),Jn(Er,this,n),Jn(xf,this,r),Jn(mt,this,o),Jn(Oo,this,s),Jn(wl,this,a),Jn(jr,this,i),Jn(Hf,this,e),this.registerEvents()}registerEvents(){z(jr,this).addEventListener(z(mt,this).holder,"contextmenu",n=>this.onContextMenu(n)),z(jr,this).addEventListener(z(mt,this).TABLE,"mouseover",n=>this.onMouseOver(n)),z(jr,this).addEventListener(z(mt,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{z(jr,this).addEventListener(z(mt,this).holder,"touchstart",n=>this.onTouchStart(n)),z(jr,this).addEventListener(z(mt,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),z(jr,this).addEventListener(z(mt,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||z(Er,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,z(Er,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{z(jr,this).addEventListener(z(mt,this).holder,"mouseup",n=>this.onMouseUp(n)),z(jr,this).addEventListener(z(mt,this).holder,"mousedown",n=>this.onMouseDown(n))};gi()?e():(ND()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(z(Us,this)&&n){const[i,o]=[n.row,z(Us,this).from.row],[s,a]=[n.col,z(Us,this).from.col];return i===o&&s===a}return!1}parentCell(e){const r={},n=z(mt,this).TABLE,i=cl(e,["TD","TH"],n);return i?(r.coords=z(mt,this).getCoords(i),r.TD=i):ve(e,"wtBorder")&&ve(e,"current")?(r.coords=z(Oo,this).getFocusSelection().cellRange.highlight,r.TD=z(mt,this).getCell(r.coords)):ve(e,"wtBorder")&&ve(e,"area")&&z(Oo,this).getAreaSelection().cellRange&&(r.coords=z(Oo,this).getAreaSelection().cellRange.to,r.TD=z(mt,this).getCell(r.coords)),r}onMouseDown(e){const r=z(xf,this).rootDocument.activeElement,n=iN(jD,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const o=this.parentCell(i);ve(i,"corner")?z(Er,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&z(Er,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(z(un,this)[0]=o.TD,clearTimeout(z(Hi,this)[0]),z(Hi,this)[0]=setTimeout(()=>{z(un,this)[0]=null},1e3))}onContextMenu(e){if(z(Er,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!z(Er,this).has("onCellMouseOver"))return;const r=z(mt,this).TABLE,n=cl(e.target,["TD","TH"],r),i=z(wl,this)||this;n&&n!==i.lastMouseOver&&os(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,z(mt,this).getCoords(n),n))}onMouseOut(e){if(!z(Er,this).has("onCellMouseOut"))return;const r=z(mt,this).TABLE,n=cl(e.target,["TD","TH"],r),i=cl(e.relatedTarget,["TD","TH"],r),o=z(wl,this)||this;n&&n!==i&&os(n,r)&&(this.callListener("onCellMouseOut",e,z(mt,this).getCoords(n),n),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&z(Er,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===z(un,this)[0]&&r.TD===z(un,this)[1]?(ve(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),z(un,this)[0]=null,z(un,this)[1]=null):r.TD===z(un,this)[0]&&(z(un,this)[1]=r.TD,clearTimeout(z(Hi,this)[1]),z(Hi,this)[1]=setTimeout(()=>{z(un,this)[1]=null},500)))}onTouchStart(e){Jn(Us,this,z(Oo,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,o=fe(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&z(Er,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];h_()&&(WD()||$D())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const o=z(Er,this).getSettingPure(e);o&&o(r,n,i,z(Hf,this).call(this))}destroy(){clearTimeout(z(Hi,this)[0]),clearTimeout(z(Hi,this)[1]),z(jr,this).destroy()}};function Af(t,e,r){return(e=sL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sL(t){var e=aL(t,"string");return typeof e=="symbol"?e:e+""}function aL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lL{constructor(e,r,n){Af(this,"offset",void 0),Af(this,"total",void 0),Af(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Df(t,e,r){return(e=uL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uL(t){var e=cL(t,"string");return typeof e=="symbol"?e:e+""}function cL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hL{constructor(e,r,n){Df(this,"offset",void 0),Df(this,"total",void 0),Df(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function vl(t,e,r){return(e=dL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dL(t){var e=fL(t,"string");return typeof e=="symbol"?e:e+""}function fL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gL{constructor(){vl(this,"currentSize",0),vl(this,"nextSize",0),vl(this,"currentOffset",0),vl(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const mL=0,gS=1,Vg=2;function Nf(t,e,r){return(e=pL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pL(t){var e=wL(t,"string");return typeof e=="symbol"?e:e+""}function wL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vL{constructor(){Nf(this,"size",new gL),Nf(this,"workingSpace",mL),Nf(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=gS,e.workingSpace=Vg,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Vg,e.workingSpace=gS,this.sharedSize=e.getViewSize()}}var mS={},kf,pS;function yL(){if(pS)return kf;pS=1;var t=Vu(),e=TypeError;return kf=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},kf}var wS;function bL(){if(wS)return mS;wS=1;var t=Le(),e=ws(),r=ys(),n=zE(),i=yL(),o=UE(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=r(h),g=arguments.length;if(g){o(d+g);for(var w=d;w--;){var y=w+g;w in h?h[y]=h[w]:i(h,y)}for(var b=0;b<g;b++)h[b]=arguments[b]}return n(h,d+g)}}),mS}bL();function CL(t,e,r){return(e=SL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SL(t){var e=RL(t,"string");return typeof e=="symbol"?e:e+""}function RL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vS{constructor(e,r){CL(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function EL(t,e,r){return(e=TL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TL(t){var e=_L(t,"string");return typeof e=="symbol"?e:e+""}function _L(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OL{constructor(e){EL(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new vS(o,r),l=new vS(s,n),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(Vg)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),n<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const g=a.prepend(d);u.push(["insert_before",d,h,g])}else u.push(["none",d])}return u}}function Mo(t,e,r){return(e=ML(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ML(t){var e=IL(t,"string");return typeof e=="symbol"?e:e+""}function IL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y_{constructor(e,r){Mo(this,"rootNode",void 0),Mo(this,"nodesPool",void 0),Mo(this,"sizeSet",new vL),Mo(this,"collectedNodes",[]),Mo(this,"viewDiffer",new OL(this.sizeSet)),Mo(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),n){case"prepend":r.insertBefore(a,r.firstChild);break;case"append":r.appendChild(a);break;case"insert_before":r.insertBefore(a,this.nodesPool(o)),r.removeChild(this.nodesPool(s));break;case"replace":r.replaceChild(a,this.nodesPool(o));break;case"remove":r.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class q_ extends Y_{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function yS(t,e,r){return(e=PL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PL(t){var e=xL(t,"string");return typeof e=="symbol"?e:e+""}function xL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HL{constructor(e){yS(this,"nodeType",void 0),yS(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Ys(t,e,r){return(e=AL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AL(t){var e=DL(t,"string");return typeof e=="symbol"?e:e+""}function DL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tl{constructor(e,r){Ys(this,"nodesPool",null),Ys(this,"nodeType",void 0),Ys(this,"rootNode",void 0),Ys(this,"table",null),Ys(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new HL(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function bS(t,e,r){return(e=NL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NL(t){var e=kL(t,"string");return typeof e=="symbol"?e:e+""}function kL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LL extends tl{constructor(){super("TH"),bS(this,"orderViews",new WeakMap),bS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new q_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(0).start();for(let h=n-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Qa(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&_e(d,[bD(),_D(),Km(h+1),bo(-1)]),r[h](a,d,h)}u.end()}}}class FL extends tl{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<o;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&cs(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&_e(this.rootNode,[i_()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&_e(s,[o_(),a_(r+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Qa(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&_e(u,[Km(a+1+this.table.rowHeadersCount),bo(-1),CD(),...a>=0?[TD()]:[yD(),Cu("Select whole grid")]]),n[r](l,u,r)}}}}let CS=!1;class VL extends tl{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!CS&&e>1e3&&(CS=!0,Sn(rr`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+r].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&X(n,"rowHeader")}}function WL(t,e,r){return(e=$L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $L(t){var e=BL(t,"string");return typeof e=="symbol"?e:e+""}function BL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Io={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let SS=!1;class jL extends tl{constructor(e){super("TR",e),WL(this,"orderView",void 0),this.orderView=new Y_(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!SS&&e>1e3&&(SS=!0,Sn(rr`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&_e(this.rootNode,[i_()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;_e(o,[o_(),a_(s+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(s+1)%2===0?ve(o,Io.rowEven)||(He(o,Io.rowOdd),X(o,Io.rowEven)):ve(o,Io.rowOdd)||(He(o,Io.rowEven),X(o,Io.rowOdd))}this.orderView.end()}}function RS(t,e,r){return(e=zL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zL(t){var e=UL(t,"string");return typeof e=="symbol"?e:e+""}function UL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YL extends tl{constructor(){super("TD"),RS(this,"orderViews",new WeakMap),RS(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new q_(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(0).start();for(let d=0;d<r;d++){c.render();const g=this.table.renderedColumnToSource(d),w=c.getCurrentNode();if(ve(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),Qa(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,g,w),this.table.isAriaEnabled()){var o,s;_e(w,[...w.hasAttribute("role")?[]:[vD()],bo(-1),Km(g+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function rt(t,e,r){return(e=qL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qL(t){var e=GL(t,"string");return typeof e=="symbol"?e:e+""}function GL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KL{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rt(this,"rootNode",void 0),rt(this,"rootDocument",void 0),rt(this,"rowHeaders",null),rt(this,"columnHeaders",null),rt(this,"colGroup",null),rt(this,"rows",null),rt(this,"cells",null),rt(this,"rowFilter",null),rt(this,"columnFilter",null),rt(this,"rowUtils",null),rt(this,"columnUtils",null),rt(this,"rowsToRender",0),rt(this,"columnsToRender",0),rt(this,"rowHeaderFunctions",[]),rt(this,"rowHeadersCount",0),rt(this,"columnHeaderFunctions",[]),rt(this,"columnHeadersCount",0),rt(this,"cellRenderer",void 0),rt(this,"activeOverlayName",void 0),rt(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(n),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class XL{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new KL(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new LL,columnHeaders:new FL(r),colGroup:new VL(n),rows:new jL(i),cells:new YL}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Lf(t,e,r){return(e=ZL(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZL(t){var e=QL(t,"string");return typeof e=="symbol"?e:e+""}function QL(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JL{constructor(e,r){Lf(this,"dataAccessObject",void 0),Lf(this,"wtSettings",void 0),Lf(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<n;o++){let s=Array.isArray(r)?r[o]:r;s=s??i,this.headerWidths.set(o,s)}}}}function ES(t,e,r){return(e=eF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eF(t){var e=tF(t,"string");return typeof e=="symbol"?e:e+""}function tF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rF{constructor(e,r){ES(this,"dataAccessObject",void 0),ES(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function cn(t,e,r){return(e=nF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nF(t){var e=iF(t,"string");return typeof e=="symbol"?e:e+""}function iF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Es{constructor(e,r,n,i,o){cn(this,"wtSettings",null),cn(this,"domBindings",void 0),cn(this,"TBODY",null),cn(this,"THEAD",null),cn(this,"COLGROUP",null),cn(this,"hasTableHeight",!0),cn(this,"hasTableWidth",!0),cn(this,"isTableVisible",!1),cn(this,"tableOffset",0),cn(this,"holderOffset",0),this.domBindings=n,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,p_(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new rF(this.dataAccessObject,this.wtSettings),this.columnUtils=new JL(this.dataAccessObject,this.wtSettings),this.tableRenderer=new XL({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&_e(n,[fi()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&_e(n,[fi()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!ve(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&_e(n,[bo(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&_e(n.parentNode,[fi()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&_e(n,[fi()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,o=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=xr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const g=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=g!==0,w!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=xr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const g=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new hL(g,o,c),this.columnFilter=new lL(w,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(wn)||this.is(vi))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(wn))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(wn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,o=this.getColumnHeaderHeight(n),s=this.getColumnHeader(r,n),s&&(a=Ca(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(n[o]){if(!r[o]||r[o].childNodes.length===0)return;r[o].childNodes[0].style.height=`${n[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(wn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const o=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[o]&&(r.oversizedRows[o]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const o=this.getRow(r);if(!o&&r>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[n];o&&r.push(o)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&r.push(s)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=f_(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let o=YD(n),s=r.cellIndex;Pi(ao,r,this.wtRootElement)||Pi(oo,r,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Pi(vi,r,this.wtRootElement)||Pi(wn,r,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Pi(ao,r,this.wtRootElement)||Pi(so,r,this.wtRootElement)||Pi(vi,r,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=Ca(this.TBODY)-1,o=r.areCellsBorderBox(),s=o?nr:Ca,a=o?0:1,l=o?1:0;let u,c,h,d,g;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),g=d.querySelector("th");const w=h===0?l:0;g?c=s(g):c=s(d)-a,(!u&&r.getDefaultRowHeight()<c-w||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return tr(this.TABLE)}getHeight(){return nr(this.TABLE)}getTotalWidth(){const e=tr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=nr(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Da(this.TABLE)}_modifyRowHeaderWidth(e){let r=Pe(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const oF="stickyRowsBottom",sp={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Xn(sp,"MIXIN_NAME",oF,{writable:!1,enumerable:!1});const sF="stickyColumnsStart",nc={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xn(nc,"MIXIN_NAME",sF,{writable:!1,enumerable:!1});class ap extends Es{constructor(e,r,n,i){super(e,r,n,i,vi)}}Xe(ap,sp);Xe(ap,nc);const oo="top",wn="bottom",so="inline_start",ao="top_inline_start_corner",vi="bottom_inline_start_corner",G_=[oo,wn,so,ao,vi],aF=new Map([[oo,`ht_clone_${oo}`],[wn,`ht_clone_${wn}`],[so,`ht_clone_${so} ht_clone_left`],[ao,`ht_clone_${ao} ht_clone_top_left_corner`],[vi,`ht_clone_${vi} ht_clone_bottom_left_corner`]]);function lF(t,e){uF(t,e),e.add(t)}function uF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cF(t,e,r){return(e=hF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hF(t){var e=dF(t,"string");return typeof e=="symbol"?e:e+""}function dF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qs=new WeakSet;class fF{constructor(e){lF(this,qs),cF(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),o=this.scrollViewportVertically(e.row,n);return i||o}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const o=dr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=r==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():r==="end")),h}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const o=dr(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;r=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=r==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():r==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return yl(qs,this,_S).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return yl(qs,this,_S).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return yl(qs,this,TS).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return yl(qs,this,TS).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function TS(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(r.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=xr(n.wtRootElement).left;const u=Math.abs(y_(s,s));if(l>u){const c=b_(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function _S(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=xr(r.wtRootElement),a=Jm(o,o);if(s.top>a){const l=Ca(o);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Tr(t,e,r){return(e=gF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gF(t){var e=mF(t,"string");return typeof e=="symbol"?e:e+""}function mF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lp{get eventManager(){return new Ci(this)}constructor(e,r){Tr(this,"wtTable",void 0),Tr(this,"wtScroll",void 0),Tr(this,"wtViewport",void 0),Tr(this,"wtOverlays",void 0),Tr(this,"selectionManager",void 0),Tr(this,"wtEvent",void 0),Tr(this,"guid",`wt_${r_()}`),Tr(this,"drawInterrupted",!1),Tr(this,"drawn",!1),Tr(this,"activeOverlayName","master"),Tr(this,"domBindings",void 0),Tr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new fF(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Ja(n,e[r])}])}}createCellCoords(e,r){return new io(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new el(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||GD(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function OS(t,e,r){return(e=pF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pF(t){var e=wF(t,"string");return typeof e=="symbol"?e:e+""}function wF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vF extends lp{constructor(e,r,n){super(e,r),OS(this,"cloneSource",void 0),OS(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new U_(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function yF(t,e,r){return(e=bF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bF(t){var e=CF(t,"string");return typeof e=="symbol"?e:e+""}function CF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rl{constructor(e,r,n,i,o){yF(this,"wtSettings",null),Xn(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=r,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Ru(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ru(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Su(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){Sn(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=n<this.wtSettings.getSetting("fixedColumnsStart"),s=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!r)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+ir())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=s.horizontal-o.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(G_.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,o=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${aF.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.getSetting("ariaTags")&&_e(o,[fi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===oo||u==="vertical"&&this.type===so?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Su(e.TABLE),new vF(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,o=e.parentNode.style;[n,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class SF extends rl{constructor(e,r,n,i,o,s){super(e,r,vi,n,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new ap(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${o}px`,r.style.bottom=`${s}px`}else ec(r),this.repositionOverlay();let n=nr(this.clone.wtTable.TABLE);const i=tr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=ir(n)),i.style.bottom=`${o}px`}}const RF="calculatedColumns",ic={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Xn(ic,"MIXIN_NAME",RF,{writable:!1,enumerable:!1});class up extends Es{constructor(e,r,n,i){super(e,r,n,i,wn)}}Xe(up,sp);Xe(up,ic);function EF(t,e,r){return(e=TF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TF(t){var e=_F(t,"string");return typeof e=="symbol"?e:e+""}function _F(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OF extends rl{constructor(e,r,n,i){super(e,r,wn,n,i),EF(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new up(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;r.hasVerticalScroll()||(o+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(o+=ir(n)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Qm(r),top),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<r;){const l=n.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=ir(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=nr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;r&&o.offsetHeight!==o.clientHeight&&(s=ir(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((n||r===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ve(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(X(s,"innerBorderBottom"),o=!a):(He(s,"innerBorderBottom"),o=a)}return o}}const MF="calculatedRows",cp={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xn(cp,"MIXIN_NAME",MF,{writable:!1,enumerable:!1});class hp extends Es{constructor(e,r,n,i){super(e,r,n,i,so)}}Xe(hp,cp);Xe(hp,nc);const IF="localHooks",_n={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Dg(this._localHooks[t][l],this,e,r,n,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Xn(_n,"MIXIN_NAME",IF,{writable:!1,enumerable:!1});let K_=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Xe(K_,_n);const PF="active-header",X_="header",dp="area",_u="focus",xF="fill",HF="row",AF="column",DF="custom-selection",fp=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var MS={},IS;function NF(){if(IS)return MS;IS=1;var t=tp();return t("flat"),MS}NF();function kF(t,e){Z_(t,e),e.add(t)}function PS(t,e,r){Z_(t,e),e.set(t,r)}function Z_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e){return t.get(Sa(t,e))}function xS(t,e,r){return t.set(Sa(t,e),r),r}function Sa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yr=new WeakMap,Ot=new WeakMap,bl=new WeakSet;class LF{constructor(){kF(this,bl),PS(this,Yr,void 0),PS(this,Ot,void 0)}setActiveOverlay(e){return xS(Ot,this,e),this}setActiveSelection(e){return xS(Yr,this,e),this}scan(){const e=Ue(Yr,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,o]=Ue(Yr,this).getCorners(),{wtTable:s}=Ue(Ot,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<n||h>o)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const g=d+l;let w=s.getColumnHeader(h,g);const y=Ue(Ot,this).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Ue(Yr,this).settings.selectionType,columnCursor:u,selectionWidth:o-n+1});y!==null&&(y!==h&&(w=s.getColumnHeader(y,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,o]=Ue(Yr,this).getCorners(),{wtTable:s}=Ue(Ot,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>o)continue;const g=d+l;let w=s.getRowHeader(h,g);const y=Ue(Ot,this).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Ue(Yr,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});y!==null&&(y!==h&&(w=s.getRowHeader(y,g)),e(w))}u+=1}}}scanCellsRange(e){const{wtTable:r}=Ue(Ot,this);Sa(bl,this,FF).call(this,(n,i)=>{const o=r.getCell(Ue(Ot,this).createCellCoords(n,i)),s=Ue(Ot,this).getSetting("onAfterDrawSelection",n,i,Ue(Yr,this).settings.layerLevel);typeof s=="string"&&X(o,s),e(o)})}scanRowsInCellsRange(e){const[r,,n]=Ue(Yr,this).getCorners(),{wtTable:i}=Ue(Ot,this);Sa(bl,this,HS).call(this,(o,s)=>{if(o>=r&&o<=n){const a=i.getCell(Ue(Ot,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ue(Yr,this).getCorners(),{wtTable:i}=Ue(Ot,this);Sa(bl,this,HS).call(this,(o,s)=>{if(s>=r&&s<=n){const a=i.getCell(Ue(Ot,this).createCellCoords(o,s));e(a)}})}}function FF(t){let[e,r,n,i]=Ue(Yr,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:o}=Ue(Ot,this),s=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),s){if(r=Math.max(r,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),n=Math.min(n,o.getLastRenderedRow()),i<r||n<e)return}else{const a=o.getCell(Ue(Ot,this).createCellCoords(e,r));if(!eo(a))return}for(let a=e;a<=n;a+=1)for(let l=r;l<=i;l+=1)t(a,l)}function HS(t){const{wtTable:e}=Ue(Ot,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<n;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class AS{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=fp(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),tc(e);const n=this,i=this.wot.rootDocument.body,o=r.getBoundingClientRect();r.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),gi()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=r.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),o=n.getCSSVariableValue("cell-mobile-handle-border-radius"),s=n.getCSSVariableValue("cell-mobile-handle-background-color"),a=n.getCSSVariableValue("cell-mobile-handle-border-width"),l=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Oe(h,(g,w)=>{this.selectionHandles.styles.bottomHitArea[w]=g,this.selectionHandles.styles.topHitArea[w]=g});const d=n.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Oe(d,(g,w)=>{this.selectionHandles.styles.bottom[w]=g,this.selectionHandles.styles.top[w]=g}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),y=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(n-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(n-y/4*3,10)}px`,c[l]=`${parseInt(i-y/4*3,10)}px`;const v=Math.min(parseInt(i+o,10),b-w-g*2),T=Math.min(parseInt(i+o-y/4,10),b-y-g*2);h[l]=`${v}px`,d[l]=`${T}px`;const _=Math.min(parseInt(n+s,10),E-w-g*2),M=Math.min(parseInt(n+s-y/4,10),E-y-g*2);h.top=`${_}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,o]=e;if(r<0&&i<0||n<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=r!==i||n!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),g=s.getFirstRenderedColumn(),w=s.getLastRenderedColumn();if(g<0&&w<0||h<0&&d<0){this.disappear();return}let y;if(u){if(n=Math.max(n,g),o=Math.min(o,w),r=Math.max(r,h),i=Math.min(i,d),o<n||i<r){this.disappear();return}y=s.getCell(this.wot.createCellCoords(r,n))}else if(y=s.getCell(this.wot.createCellCoords(r,n)),!eo(y)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(i,o)):y,E=xr(y),v=u?xr(b):E,T=xr(s.TABLE),_=E.top,M=E.left,P=this.wot.wtSettings.getSetting("rtlMode");let x=0,F=0;if(P){const ye=tr(s.TABLE),qe=tr(y),$e=l.innerWidth-T.left-ye;F=M+qe-v.left,x=l.innerWidth-M-qe-$e-1}else F=v.left+tr(b)-M,x=M-T.left-1;if(this.isEntireColumnSelected(r,i)){const ye=r,qe=this.getDimensionsFromHeader("columns",n,o,ye,T);let $e=null;qe&&([$e,x,F]=qe),$e&&(y=$e)}let U=_-T.top-1,H=v.top+nr(b)-_;if(this.isEntireRowSelected(n,o)){const ye=n,qe=this.getDimensionsFromHeader("rows",r,i,ye,T);let $e=null;qe&&([$e,U,H]=qe),$e&&(y=$e)}const G=l.getComputedStyle(y);parseInt(G.borderTopWidth,10)>0&&(U+=1,H=H>0?H-1:0),parseInt(G[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(x+=1,F=F>0?F-1:0);const J=P?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${U}px`,this.topStyle[J]=`${x}px`,this.topStyle.width=`${F+ae}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[J]=`${x}px`,this.startStyle.height=`${H+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${U+H-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[J]=`${x}px`,this.bottomStyle.width=`${F+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[J]=`${x+F-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${H+ae}px`,this.endStyle.display="block";let q=this.settings.border.cornerVisible;q=typeof q=="function"?q(this.settings.layerLevel):q;const ee=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[lt,Ee]=[i,o];if(ee&&Array.isArray(ee)&&([,,lt,Ee]=ee),gi()||!q||this.isPartRange(lt,Ee))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[J]=`${x+F+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ye=Ru(s.TABLE);const qe=ye===l;qe&&(ye=a.documentElement);const $e=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Me=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),yr=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const f=qe?b.getBoundingClientRect().left:b.offsetLeft;let m=!1,p=0;if(P?(p=f-parseInt(this.cornerDefaultStyle.width,10)/2,m=p<0):(p=f+tr(b)+parseInt(this.cornerDefaultStyle.width,10)/2,m=p>=b_(ye)),m){const C=Math.floor(x+F+this.cornerCenterPointOffset-Me-$e);c?(this.cornerStyle[J]=`${C}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[J]=`${C-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(qe?b.getBoundingClientRect().top:b.offsetTop)+nr(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=Ca(ye)){const C=Math.floor(U+H+this.cornerCenterPointOffset-yr-$e);c?(this.cornerStyle.top=`${C}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${C-1}px`}this.cornerStyle.display="block"}gi()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,U,x,F,H)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,w=null,y=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return nr(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return tr(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(w=l(r,b-i),y=l(n,b-i),!w||!y)return!1;const E=xr(w),v=xr(y);return w&&y&&(h=E[g]-o[g]-1,d=v[g]+u(y)-E[g]),[w,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?X(this[e],"hidden"):(ve(this[e],"hidden")&&He(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?X(this[e],"hidden"):He(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",gi()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function VF(t,e){Q_(t,e),e.add(t)}function Po(t,e,r){Q_(t,e),e.set(t,r)}function Q_(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(t,e){return t.get(gp(t,e))}function DS(t,e,r){return t.set(gp(t,e),r),r}function gp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mt=new WeakMap,Xt=new WeakMap,Ff=new WeakMap,ha=new WeakMap,Vf=new WeakMap,Ai=new WeakMap,NS=new WeakSet;class WF{constructor(e){VF(this,NS),Po(this,Mt,void 0),Po(this,Xt,void 0),Po(this,Ff,new LF),Po(this,ha,new WeakMap),Po(this,Vf,new WeakSet),Po(this,Ai,new Map),DS(Xt,this,e)}setActiveOverlay(e){return DS(Mt,this,e),le(Ff,this).setActiveOverlay(le(Mt,this)),le(ha,this).has(le(Mt,this))||le(ha,this).set(le(Mt,this),new Set),this}getFocusSelection(){return le(Xt,this)!==null?le(Xt,this).getFocus():null}getAreaSelection(){return le(Xt,this)!==null?le(Xt,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(le(Ai,this).has(e)){const n=le(Ai,this).get(e);if(n.has(le(Mt,this)))return n.get(le(Mt,this));const i=new AS(le(Mt,this),e.settings);return n.set(le(Mt,this),i),i}const r=new AS(le(Mt,this),e.settings);return le(Ai,this).set(e,new Map([[le(Mt,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=le(Ai,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){le(Ai,this).get(e).forEach(r=>r.destroy()),le(Ai,this).delete(e)}render(e){if(le(Xt,this)===null)return;e&&gp(NS,this,$F).call(this);const r=Array.from(le(Xt,this)),n=new Map,i=new Map;for(let o=0;o<r.length;o++){const s=r[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;le(Vf,this).has(s)||(le(Vf,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&le(Ff,this).setActiveSelection(s).scan().forEach(w=>{if(n.has(w)){const y=n.get(w);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else n.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const d=s.getCorners();le(Mt,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}n.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>le(ha,this).get(le(Mt,this)).add(u)),X(s,l),s.nodeName==="TD"&&Array.isArray((a=le(Xt,this).options)===null||a===void 0?void 0:a.cellAttributes)&&_e(s,le(Xt,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{_e(o,[...i.get(o)])})}}function $F(){const t=le(ha,this).get(le(Mt,this)),e=le(Mt,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const o=le(Mt,this).wtTable.TABLE.querySelectorAll(`.${r}`);let s=[];Array.isArray((n=le(Xt,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=le(Xt,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=le(Xt,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...le(Xt,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)He(o[a],r),Qa(o[a],s)}),t.clear()}class BF extends rl{constructor(e,r,n,i){super(e,r,so,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new hp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),ep(n,`${o}px`,"0px")):(o=this.getScrollPosition(),ec(n));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const o=r.scrollX;r.scrollTo(e,v_(r)),n=o!==r.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,n=o!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<r;)o+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(u-=ir(n)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=tr(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=fp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ve(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=ir(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,XD(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(y_(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),s=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";s?He(n,"emptyRows"):X(n,"emptyRows");let l=!1;if(!a){if(o&&!i.length)X(n,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ve(n,"innerBorderInlineStart");e?(X(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(He(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const jF="stickyRowsTop",mp={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Xn(mp,"MIXIN_NAME",jF,{writable:!1,enumerable:!1});class pp extends Es{constructor(e,r,n,i){super(e,r,n,i,ao)}}Xe(pp,mp);Xe(pp,nc);function kS(t,e,r){return(e=zF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zF(t){var e=UF(t,"string");return typeof e=="symbol"?e:e+""}function UF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YF extends rl{constructor(e,r,n,i,o,s){super(e,r,ao,n,i),kS(this,"topOverlay",void 0),kS(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new pp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();ep(e,`${i}px`,`${o}px`)}else ec(e);let r=nr(this.clone.wtTable.TABLE);const n=tr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class wp extends Es{constructor(e,r,n,i){super(e,r,n,i,oo)}}Xe(wp,mp);Xe(wp,ic);function qF(t,e,r){return(e=GF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GF(t){var e=KF(t,"string");return typeof e=="symbol"?e:e+""}function KF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XF extends rl{constructor(e,r,n,i){super(e,r,oo,n,i),qF(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new wp(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),ep(e,"0px",`${i}px`)}else i=this.getScrollPosition(),ec(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const o=r.scrollY;r.scrollTo(Qm(r),e),i=o!==r.scrollY}else if(e!==n.scrollTop){const o=n.scrollTop;n.scrollTop=e,i=o!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<r;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?n:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=r.getWorkspaceWidth();r.hasVerticalScroll()&&(u-=ir(n)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=nr(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=fp(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ve(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),g=this.wot.wtViewport.getViewportHeight();d>g&&(r=!1)}if(r&&s.offsetHeight!==s.clientHeight&&(h=ir(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),g=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(g-d,g),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,KD(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Jm(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,o=n.getSetting("totalColumns"),s=n.getSetting("preventOverflow")==="horizontal";o?He(i,"emptyColumns"):X(i,"emptyColumns");let a=!1;if(!r&&!s){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ve(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(X(i,"innerBorderTop"),a=!h):(He(i,"innerBorderTop"),a=h)}}return a}}function Cl(t,e,r){ZF(t,e),e.set(t,r)}function ZF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function An(t,e,r){return(e=QF(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QF(t){var e=JF(t,"string");return typeof e=="symbol"?e:e+""}function JF(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Di(t,e,r){return t.set(J_(t,e),r),r}function Dn(t,e){return t.get(J_(t,e))}function J_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xo=new WeakMap,Sl=new WeakMap,Ho=new WeakMap,Rl=new WeakMap;class eV{constructor(e,r,n,i,o,s){An(this,"wot",null),Cl(this,xo,[]),An(this,"topOverlay",null),An(this,"bottomOverlay",null),An(this,"inlineStartOverlay",null),An(this,"topInlineStartCornerOverlay",null),An(this,"bottomInlineStartCornerOverlay",null),An(this,"browserLineHeight",void 0),An(this,"wtSettings",null),Cl(this,Sl,!1),Cl(this,Ho,0),Cl(this,Rl,null),An(this,"resizeObserver",new ResizeObserver(c=>{Hg(()=>{!Array.isArray(c)||!c.length||(Di(Ho,this,Dn(Ho,this)+1),Dn(Ho,this)===100&&(Sn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Dn(Rl,this)!==null&&clearTimeout(Dn(Rl,this)),Di(Rl,this,setTimeout(()=>{Di(Ho,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=ir(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Su(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...Dn(xo,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),o=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new XF(...e),this.bottomOverlay=new OF(...e),this.inlineStartOverlay=new BF(...e),this.topInlineStartCornerOverlay=new YF(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new SF(...e,this.bottomOverlay,this.inlineStartOverlay),Di(xo,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Di(Sl,this,Dn(xo,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),Dn(xo,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Dn(xo,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=r.devicePixelRatio&&r.devicePixelRatio>1,s=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!VD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(r,"resize",()=>{Hg(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{Di(Ho,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==r&&o!==r&&!e.target.contains(i)||n!==r&&o!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==n&&s!==n&&!s.contains(o),l=i!==n&&s!==n&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=lN(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),o=this.scrollHorizontally(n);return i||o}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Dn(Sl,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Di(Sl,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Su(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=r.hider.style,g=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),w=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),y=g()?1:0,b=w()?1:0;d.width=`${c+b}px`,d.height=`${u+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return $(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];$(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function LS(t,e,r){return(e=tV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tV(t){var e=rV(t,"string");return typeof e=="symbol"?e:e+""}function rV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nV{constructor(e){LS(this,"settings",{}),LS(this,"defaults",Object.freeze(this.getDefaults())),Oe(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Ja(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Oe(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,o){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,o):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class vp extends Es{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Ru(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=TC(e,"height",r),o=TC(e,"overflow",r),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const g=parseInt(r.getComputedStyle(d).height,10);n.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Da(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",o=e.getSetting("columnHeaders").length;if(o&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Xe(vp,cp);Xe(vp,ic);class iV{constructor(e,r,n,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Nk:new $k],["fullyVisible",()=>new Tk],["partiallyVisible",()=>new W_]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Hk:new Fk],["fullyVisible",()=>new Sk],["partiallyVisible",()=>new V_]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=nr(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return xr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=nr(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=r.length;i<o;i++)n?(this.rowHeaderWidth+=tr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),n.holder.clientHeight===n.holder.offsetHeight?o=0:o=ir(this.domBindings.rootDocument),new Kk({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=r.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=ir(this.domBindings.rootDocument)),new Yk({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const o=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!r.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(r=Math.max(0,r-Math.min(s,u)),n=Math.min(l,n+Math.min(a,u))):u==="auto"&&(r=Math.max(0,r-Math.ceil(s/2)),n=Math.min(l,n+Math.ceil(a/2))),r<i||r===i&&r>0?!1:!(n>o||n===o&&n<l)}resetHasOversizedColumnHeadersMarked(){Oe(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class oV extends lp{constructor(e,r){super(e,new nV(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new vp(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new iV(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new WF(this.wtSettings.getSetting("selections")),this.wtEvent=new U_(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new eV(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Oe(e,(i,o)=>{this.wtSettings.getSetting(o).length&&n.push(i),r.push(i)}),He(this.wtTable.wtRootElement.parentNode,r),X(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!G_.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class yp{constructor(e){e instanceof lp?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new yp(r);return()=>n},this._wot=new oV(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,o){return this._wot.wtSettings.getSetting(e,r,n,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function FS(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function sV(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(o(u-1,r.col)):s&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function VS(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),o=i.clone().map(a=>n.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!r.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),r.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),r.refresh())}}const aV=new Map([["touchstart",FS],["touchend",VS],["mousedown",FS],["mouseover",sV],["mouseup",VS]]);function Wf(t,e){aV.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:__(t)||t.type==="touchstart",isRightClick:Eu(t),...e})}const e0=new WeakMap,bp=Symbol("rootInstance");function lV(t){e0.set(t,!0)}function uV(t){return t===bp}function Go(t){return e0.has(t)}function cV(t,e){t0(t,e),e.add(t)}function ei(t,e,r){t0(t,e),e.set(t,r)}function t0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ti(t,e,r){return(e=hV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hV(t){var e=dV(t,"string");return typeof e=="symbol"?e:e+""}function dV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qe(t,e){return t.get(as(t,e))}function Ut(t,e,r){return t.set(as(t,e),r),r}function as(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $f=new WeakMap,El=new WeakMap,Tl=new WeakMap,Nn=new WeakMap,zr=new WeakMap,Bf=new WeakMap,jf=new WeakMap,Ao=new WeakMap,da=new WeakSet;class fV{constructor(e){cV(this,da),ti(this,"hot",void 0),ti(this,"eventManager",void 0),ti(this,"settings",void 0),ti(this,"THEAD",void 0),ti(this,"TBODY",void 0),ti(this,"_wt",void 0),ti(this,"activeWt",void 0),ei(this,$f,0),ei(this,El,0),ti(this,"postponedAdjustElementsSize",!1),ei(this,Tl,!1),ei(this,Nn,void 0),ei(this,zr,void 0),ei(this,Bf,0),ei(this,jf,0),ei(this,Ao,null),this.hot=e,this.eventManager=new Ci(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),as(da,this,mV).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),X(e,"handsontable"),Ut(zr,this,r.createElement("TABLE")),X(Qe(zr,this),"htCore"),this.hot.getSettings().tableClassName&&X(Qe(zr,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(_e(Qe(zr,this),[fi()]),_e(e,[wD(),s_(-1),Ju(this.hot.countCols()),ID()])),this.THEAD=r.createElement("THEAD"),Qe(zr,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Qe(zr,this).appendChild(this.TBODY),this.hot.table=Qe(zr,this),this.hot.container.insertBefore(Qe(zr,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,o=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Ut(Tl,this,!0),this.isTextSelectionAllowed(a.target)||(_C(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Ut(Tl,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Qe(Tl,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&_C(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{n.isInProgress()&&__(a)&&n.finish(),Ut(Nn,this,!1);const l=S_(r.activeElement);ou(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!Eu(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{n.isInProgress()&&Eu(a)&&(n.finish(),Ut(Nn,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{n.isInProgress()&&n.finish(),Ut(Nn,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Qe(Nn,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const w=ir(r);if(r.elementFromPoint(u+w,c)!==d||r.elementFromPoint(u,c+w)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=Aa(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=Aa(s);this.eventManager.addEventListener(Qe(zr,this),"selectstart",a=>{this.settings.fragmentSelection||ou(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const o=n.getNearestNotHiddenIndex(e,r),s=n.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return r<0?a=s+1:r>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&X(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&He(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Qe(zr,this),isDataViewInstance:()=>Go(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Ut(El,this,o.length),this.hot.getSettings().ariaTags&&as(da,this,r0).call(this)===this.hot.countCols()&&as(da,this,gV).call(this,Qe(El,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Ut($f,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),w=this.hot.colToProp(d);let y=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,y,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,y,g),this.hot.runHooks("afterRenderer",a,l,u,w,y,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Da(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Ut(Nn,this,!0),Ut(Ao,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Yi(o)&&(Wf(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Ut(Nn,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Yi(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Yi(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Yi(o)&&(Qe(Nn,this)&&(!Qe(Ao,this)||Qe(Ao,this).x!==o.clientX||Qe(Ao,this).y!==o.clientY)&&Wf(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,Ut(Ao,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Yi(o)||this.hot.isDestroyed)&&(Wf(o,{coords:u,selection:this.hot.selection,cellRangeMapper:RN(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,g=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(g)){const[w,y,b,E]=g;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,1)):y,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,g]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new yp(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",o=>{o.target===r&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(ou(e))return!0;const r=os(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Qe(Nn,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!ve(n,"relative")){cs(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,o=n.createElement("div"),s=n.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),r.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(r.firstChild){const s=r.firstChild;ve(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,n,i),s.className="",X(s,["relative",...o()])):(cs(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(_e(a,...fi()),_e(l,...fi())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=r;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ve(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(r):ve(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(r))),o>-1?w_(e,n(r,i)):(Ja(e," "),X(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Ut(Bf,this,e),Ut(jf,this,r)}getLastSize(){return{width:Qe(Bf,this),height:Qe(jf,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Qe($f,this)}getRowHeadersCount(){return Qe(El,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function r0(){return parseInt(this.hot.rootElement.getAttribute(Ju()[0]),10)}function gV(t){const e=as(da,this,r0).call(this)+t;_e(this.hot.rootElement,...Ju(e))}function mV(){const t=this.hot.rootElement;this.hasVerticalScroll()?X(t,"htHasScrollY"):He(t,"htHasScrollY"),this.hasHorizontalScroll()?X(t,"htHasScrollX"):He(t,"htHasScrollX")}var WS={},$S={},BS;function pV(){if(BS)return $S;BS=1;var t=Le(),e=pt(),r=bs(),n=pr(),i=wt(),o=Ti(),s=wr(),a=wo(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return!r(h,function(g,w){if(!c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),$S}var jS;function wV(){return jS||(jS=1,pV()),WS}wV();const vV="ABCDEFGHIJKLMNOPQRSTUVWXYZ",zS=vV.length;function yV(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%zS,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/zS,10);return r}function n0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ct(t[0])&&(e=Xm(t[0]))),e}function Gs(t,e,r){return(e=bV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bV(t){var e=CV(t,"string");return typeof e=="symbol"?e:e+""}function CV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SV{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Gs(this,"hot",void 0),Gs(this,"data",void 0),Gs(this,"dataType","array"),Gs(this,"colToProp",()=>{}),Gs(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return $(this.data,(n,i)=>{const o=this.getAtCell(i,e);r.push(o)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=r===void 0&&n===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Ye(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(Ct(a)||Pe(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;Ye(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const g=this.getAtPhysicalCell(e,d,a);i?l.push(g):s?ff(l,d,g):l[d]=g}})}else Oe(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?ff(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=dr(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:ff(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?DD(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const o=dr(i);this.hot.runHooks("modifySourceData",e,r,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||r===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,r.row),s=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Ye(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,s,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return n0(this.data)}destroy(){this.data=null,this.hot=null}}var US={},YS={},qS;function RV(){if(qS)return YS;qS=1;var t=Le(),e=pt(),r=bs(),n=pr(),i=wt(),o=Ti(),s=wr(),a=wo(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{n(c)}catch(g){s(this,"throw",g)}if(l)return e(l,this,c);var h=o(this),d=0;return r(h,function(g,w){if(c(g,d++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),YS}var GS;function EV(){return GS||(GS=1,RV()),US}EV();function KS(t,e,r){return(e=TV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TV(t){var e=_V(t,"string");return typeof e=="symbol"?e:e+""}function _V(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;KS(this,"indexedValues",[]),KS(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Pe(this.initValueOrFn)?Ye(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ye(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Xe(nl,_n);function i0(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((o,s)=>Pe(n)?n(o,s):n),...i===void 0?[]:t.slice(i)]}function o0(t,e){return Gm(t,(r,n)=>e.includes(n)===!1)}class oc extends nl{insert(e,r){this.indexedValues=i0(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=o0(this.indexedValues,e),super.remove(e)}}class s0 extends oc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return yo(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function a0(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Ou(t,e){return Gm(t,r=>e.includes(r)===!1)}function l0(t,e){return bn(t,r=>r-e.filter(n=>n<r).length)}function u0(t,e){const r=e[0],n=e.length;return bn(t,i=>i>=r?i+n:i)}function OV(t,e,r){return(e=MV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MV(t){var e=IV(t,"string");return typeof e=="symbol"?e:e+""}function IV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PV extends nl{constructor(){super(...arguments),OV(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ou(this.orderOfIndexes,[e]),Pe(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=i0(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=u0(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=o0(this.indexedValues,e),this.orderOfIndexes=Ou(this.orderOfIndexes,e),this.orderOfIndexes=l0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class c0 extends oc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return yo(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}class xV extends nl{constructor(){super(e=>e)}insert(e,r){const n=u0(this.indexedValues,r);this.indexedValues=a0(n,e,r),super.insert(e,r)}remove(e){const r=Ou(this.indexedValues,e);this.indexedValues=l0(r,e),super.remove(e)}}const XS=new Map([["hiding",s0],["index",nl],["linkedPhysicalIndexToValue",PV],["physicalIndexToValue",oc],["trimming",c0]]);function HV(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!XS.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(XS.get(t))(e)}function AV(t,e,r){return(e=DV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DV(t){var e=NV(t,"string");return typeof e=="symbol"?e:e+""}function NV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cp{constructor(){AV(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);fe(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Vt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Xe(Cp,_n);function zf(t,e,r){return(e=kV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kV(t){var e=LV(t,"string");return typeof e=="symbol"?e:e+""}function LV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZS extends Cp{constructor(e,r){super(),zf(this,"mergedValuesCache",[]),zf(this,"aggregationFunction",void 0),zf(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=bn(this.get(),o=>o.getValues()),n=[],i=fe(r[0])&&r[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(r[a][o]);n.push(s)}return bn(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return fe(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function FV(t,e,r){VV(t,e),e.set(t,r)}function VV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WV(t,e,r){return t.set(h0(t,e),r),r}function $V(t,e){return t.get(h0(t,e))}function h0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Uf=new WeakMap;class d0{constructor(){FV(this,Uf,[])}subscribe(e){return this.addLocalHook("change",e),this._write($V(Uf,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){WV(Uf,this,e)}}Xe(d0,_n);function QS(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Ks(t,e,r){BV(t,e),e.set(t,r)}function BV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e){return t.get(f0(t,e))}function _l(t,e,r){return t.set(f0(t,e),r),r}function f0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ol=new WeakMap,Xs=new WeakMap,Ml=new WeakMap,Il=new WeakMap,Pl=new WeakMap;class jV{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ks(this,Ol,new Set),Ks(this,Xs,[]),Ks(this,Ml,[]),Ks(this,Il,!1),Ks(this,Pl,!1),_l(Pl,this,e??!1)}createObserver(){const e=new d0;return _r(Ol,this).add(e),e.addLocalHook("unsubscribe",()=>{_r(Ol,this).delete(e)}),e._writeInitialChanges(QS(_r(Xs,this),_r(Ml,this))),e}emit(e){let r=_r(Ml,this);(!_r(Il,this)||_r(Xs,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(_r(Pl,this)):_l(Xs,this,new Array(e.length).fill(_r(Pl,this))),_r(Il,this)||(_l(Il,this,!0),r=_r(Xs,this)));const n=QS(r,e);_r(Ol,this).forEach(i=>i._write(n)),_l(Ml,this,e)}}function Dt(t,e,r){return(e=zV(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zV(t){var e=UV(t,"string");return typeof e=="symbol"?e:e+""}function UV(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wg{constructor(){Dt(this,"indexesSequence",new xV),Dt(this,"trimmingMapsCollection",new ZS(e=>e.some(r=>r===!0),!1)),Dt(this,"hidingMapsCollection",new ZS(e=>e.some(r=>r===!0),!1)),Dt(this,"variousMapsCollection",new Cp),Dt(this,"hidingChangesObservable",new jV({initialIndexValue:!1})),Dt(this,"notTrimmedIndexesCache",[]),Dt(this,"notHiddenIndexesCache",[]),Dt(this,"isBatched",!1),Dt(this,"indexesSequenceChanged",!1),Dt(this,"indexesChangeSource",void 0),Dt(this,"trimmedIndexesChanged",!1),Dt(this,"hiddenIndexesChanged",!1),Dt(this,"renderablePhysicalIndexesCache",[]),Dt(this,"fromPhysicalToVisualIndexesCache",new Map),Dt(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,HV(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof c0?this.trimmingMapsCollection.register(e,r):r instanceof s0?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return fe(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return fe(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return fe(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return fe(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return r>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=bn(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ou(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(r+o<i){const u=a[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(a0(s,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=fe(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=bn(new Array(r).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=n==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Xe(Wg,_n);function YV(t,e){return Oe(e,(r,n)=>{Vt(t[n])&&(t[n]=r)}),t}function g0(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function m0(t){fe(t)&&uN(rr`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function qV(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:GV,getValues:KV}=Co("phraseFormatters");function XV(t,e){GV(t,e)}function ZV(){return KV()}XV("pluralize",qV);const p0="ContextMenu:items",ne=p0,Sp=`${ne}.noItems`,Rp=`${ne}.insertRowAbove`,Ep=`${ne}.insertRowBelow`,Tp=`${ne}.insertColumnOnTheLeft`,_p=`${ne}.insertColumnOnTheRight`,Op=`${ne}.removeRow`,Mp=`${ne}.removeColumn`,Ip=`${ne}.undo`,Pp=`${ne}.redo`,Mu=`${ne}.readOnly`,xp=`${ne}.clearColumn`,Hp=`${ne}.copy`,Ap=`${ne}.copyWithHeaders`,Dp=`${ne}.copyWithGroupHeaders`,Np=`${ne}.copyHeadersOnly`,kp=`${ne}.cut`,w0=`${ne}.freezeColumn`,v0=`${ne}.unfreezeColumn`,y0=`${ne}.mergeCells`,b0=`${ne}.unmergeCells`,C0=`${ne}.addComment`,S0=`${ne}.editComment`,R0=`${ne}.removeComment`,E0=`${ne}.readOnlyComment`,Lp=`${ne}.align`,Fp=`${ne}.align.left`,Vp=`${ne}.align.center`,Wp=`${ne}.align.right`,$p=`${ne}.align.justify`,Bp=`${ne}.align.top`,jp=`${ne}.align.middle`,zp=`${ne}.align.bottom`,T0=`${ne}.borders`,_0=`${ne}.borders.top`,O0=`${ne}.borders.right`,M0=`${ne}.borders.bottom`,I0=`${ne}.borders.left`,P0=`${ne}.borders.remove`,x0=`${ne}.nestedHeaders.insertChildRow`,H0=`${ne}.nestedHeaders.detachFromParent`,A0=`${ne}.hideColumn`,D0=`${ne}.showColumn`,N0=`${ne}.hideRow`,k0=`${ne}.showRow`,or="Filters:",Ze=`${or}conditions`,L0=`${Ze}.none`,F0=`${Ze}.isEmpty`,V0=`${Ze}.isNotEmpty`,W0=`${Ze}.isEqualTo`,$0=`${Ze}.isNotEqualTo`,B0=`${Ze}.beginsWith`,j0=`${Ze}.endsWith`,z0=`${Ze}.contains`,U0=`${Ze}.doesNotContain`,QV=`${Ze}.byValue`,Y0=`${Ze}.greaterThan`,q0=`${Ze}.greaterThanOrEqualTo`,G0=`${Ze}.lessThan`,K0=`${Ze}.lessThanOrEqualTo`,X0=`${Ze}.isBetween`,Z0=`${Ze}.isNotBetween`,Q0=`${Ze}.after`,J0=`${Ze}.before`,eO=`${Ze}.today`,tO=`${Ze}.tomorrow`,rO=`${Ze}.yesterday`,nO=`${or}labels.filterByCondition`,iO=`${or}labels.filterByValue`,oO=`${or}labels.conjunction`,sO=`${or}labels.disjunction`,aO=`${or}values.blankCells`,lO=`${or}buttons.selectAll`,uO=`${or}buttons.clear`,cO=`${or}buttons.ok`,hO=`${or}buttons.cancel`,dO=`${or}buttons.placeholder.search`,fO=`${or}buttons.placeholder.value`,gO=`${or}buttons.placeholder.secondValue`,Up="CheckboxRenderer:",mO=`${Up}checked`,pO=`${Up}unchecked`,JV=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:mO,CHECKBOX_RENDERER_NAMESPACE:Up,CHECKBOX_UNCHECKED:pO,CONTEXTMENU_ITEMS_ADD_COMMENT:C0,CONTEXTMENU_ITEMS_ALIGNMENT:Lp,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:zp,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Vp,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:$p,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Fp,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:jp,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Wp,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Bp,CONTEXTMENU_ITEMS_BORDERS:T0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:M0,CONTEXTMENU_ITEMS_BORDERS_LEFT:I0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:O0,CONTEXTMENU_ITEMS_BORDERS_TOP:_0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:xp,CONTEXTMENU_ITEMS_COPY:Hp,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Np,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Dp,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Ap,CONTEXTMENU_ITEMS_CUT:kp,CONTEXTMENU_ITEMS_EDIT_COMMENT:S0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:w0,CONTEXTMENU_ITEMS_HIDE_COLUMN:A0,CONTEXTMENU_ITEMS_HIDE_ROW:N0,CONTEXTMENU_ITEMS_INSERT_LEFT:Tp,CONTEXTMENU_ITEMS_INSERT_RIGHT:_p,CONTEXTMENU_ITEMS_MERGE_CELLS:y0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:H0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:x0,CONTEXTMENU_ITEMS_NO_ITEMS:Sp,CONTEXTMENU_ITEMS_READ_ONLY:Mu,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:E0,CONTEXTMENU_ITEMS_REDO:Pp,CONTEXTMENU_ITEMS_REMOVE_BORDERS:P0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Mp,CONTEXTMENU_ITEMS_REMOVE_COMMENT:R0,CONTEXTMENU_ITEMS_REMOVE_ROW:Op,CONTEXTMENU_ITEMS_ROW_ABOVE:Rp,CONTEXTMENU_ITEMS_ROW_BELOW:Ep,CONTEXTMENU_ITEMS_SHOW_COLUMN:D0,CONTEXTMENU_ITEMS_SHOW_ROW:k0,CONTEXTMENU_ITEMS_UNDO:Ip,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:v0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:b0,CONTEXT_MENU_ITEMS_NAMESPACE:p0,FILTERS_BUTTONS_CANCEL:hO,FILTERS_BUTTONS_CLEAR:uO,FILTERS_BUTTONS_OK:cO,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:dO,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:gO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:fO,FILTERS_BUTTONS_SELECT_ALL:lO,FILTERS_CONDITIONS_AFTER:Q0,FILTERS_CONDITIONS_BEFORE:J0,FILTERS_CONDITIONS_BEGINS_WITH:B0,FILTERS_CONDITIONS_BETWEEN:X0,FILTERS_CONDITIONS_BY_VALUE:QV,FILTERS_CONDITIONS_CONTAINS:z0,FILTERS_CONDITIONS_EMPTY:F0,FILTERS_CONDITIONS_ENDS_WITH:j0,FILTERS_CONDITIONS_EQUAL:W0,FILTERS_CONDITIONS_GREATER_THAN:Y0,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:q0,FILTERS_CONDITIONS_LESS_THAN:G0,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:K0,FILTERS_CONDITIONS_NAMESPACE:Ze,FILTERS_CONDITIONS_NONE:L0,FILTERS_CONDITIONS_NOT_BETWEEN:Z0,FILTERS_CONDITIONS_NOT_CONTAIN:U0,FILTERS_CONDITIONS_NOT_EMPTY:V0,FILTERS_CONDITIONS_NOT_EQUAL:$0,FILTERS_CONDITIONS_TODAY:eO,FILTERS_CONDITIONS_TOMORROW:tO,FILTERS_CONDITIONS_YESTERDAY:rO,FILTERS_DIVS_FILTER_BY_CONDITION:nO,FILTERS_DIVS_FILTER_BY_VALUE:iO,FILTERS_LABELS_CONJUNCTION:oO,FILTERS_LABELS_DISJUNCTION:sO,FILTERS_NAMESPACE:or,FILTERS_VALUES_BLANK_CELLS:aO},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const wO={languageCode:"en-US",[Sp]:"No available options",[Rp]:"Insert row above",[Ep]:"Insert row below",[Tp]:"Insert column left",[_p]:"Insert column right",[Op]:["Remove row","Remove rows"],[Mp]:["Remove column","Remove columns"],[Ip]:"Undo",[Pp]:"Redo",[Mu]:"Read only",[xp]:"Clear column",[Lp]:"Alignment",[Fp]:"Left",[Vp]:"Center",[Wp]:"Right",[$p]:"Justify",[Bp]:"Top",[jp]:"Middle",[zp]:"Bottom",[w0]:"Freeze column",[v0]:"Unfreeze column",[T0]:"Borders",[_0]:"Top",[O0]:"Right",[M0]:"Bottom",[I0]:"Left",[P0]:"Remove border(s)",[C0]:"Add comment",[S0]:"Edit comment",[R0]:"Delete comment",[E0]:"Read-only comment",[y0]:"Merge cells",[b0]:"Unmerge cells",[Hp]:"Copy",[Ap]:["Copy with header","Copy with headers"],[Dp]:["Copy with group header","Copy with group headers"],[Np]:["Copy header only","Copy headers only"],[kp]:"Cut",[x0]:"Insert child row",[H0]:"Detach from parent",[A0]:["Hide column","Hide columns"],[D0]:["Show column","Show columns"],[N0]:["Hide row","Hide rows"],[k0]:["Show row","Show rows"],[L0]:"None",[F0]:"Is empty",[V0]:"Is not empty",[W0]:"Is equal to",[$0]:"Is not equal to",[B0]:"Begins with",[j0]:"Ends with",[z0]:"Contains",[U0]:"Does not contain",[Y0]:"Greater than",[q0]:"Greater than or equal to",[G0]:"Less than",[K0]:"Less than or equal to",[X0]:"Is between",[Z0]:"Is not between",[Q0]:"After",[J0]:"Before",[eO]:"Today",[tO]:"Tomorrow",[rO]:"Yesterday",[aO]:"Blank cells",[nO]:"Filter by condition",[iO]:"Filter by value",[oO]:"And",[sO]:"Or",[lO]:"Select all",[uO]:"Clear",[cO]:"OK",[hO]:"Cancel",[dO]:"Search",[fO]:"Value",[gO]:"Second value",[mO]:"Checked",[pO]:"Unchecked"},eW=JV,$g=wO.languageCode,{register:tW,getItem:vO,hasItem:rW,getValues:nW}=Co("languagesDictionaries");yO(wO);function yO(t,e){let r=t,n=e;return Ct(t)&&(n=t,r=n.languageCode),iW(r,n),tW(r,mr(n)),mr(n)}function iW(t,e){t!==$g&&YV(e,vO($g))}function bO(t){return Yp(t)?mr(vO(t)):null}function Yp(t){return rW(t)}function oW(){return nW()}function CO(t,e,r){const n=bO(t);if(n===null)return null;const i=n[e];if(Vt(i))return null;const o=sW(i,r);return Array.isArray(o)?o[0]:o}function sW(t,e){let r=t;return $(ZV(),n=>{r=n(t,e)}),r}function aW(t){let e=g0(t);return Yp(e)||(e=$g,m0(t)),e}function lW(t,e,r){return(e=uW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uW(t){var e=cW(t,"string");return typeof e=="symbol"?e:e+""}function cW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zn extends K_{constructor(e,r){super(e,null),lW(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),o=this.getNearestNotHiddenCoords(n,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=r,o=n),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(r,n,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function Yf(t){let{activeHeaderClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:PF})}function hW(t){let{areaCornerVisible:e,...r}=t;return new Zn({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:dp})}function dW(t){let{...e}=t;return new Zn({className:"highlight",...e,selectionType:dp})}function fW(t){let{columnClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:AF})}function gW(t){let{cellCornerVisible:e,...r}=t;return new Zn({className:"current",headerAttributes:[l_()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:_u})}function mW(t){let{border:e,visualCellRange:r,...n}=t;return new Zn({...e,...n,selectionType:DF},r)}function pW(t){let{...e}=t;return new Zn({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:xF})}function JS(t){let{headerClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:X_})}function wW(t){let{rowClassName:e,...r}=t;return new Zn({className:e,...r,selectionType:HF})}function vW(t,e){yW(t,e),e.add(t)}function yW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e,r){return(e=bW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bW(t){var e=CW(t,"string");return typeof e=="symbol"?e:e+""}function CW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hn=new WeakSet;class SW{constructor(e){vW(this,hn),Yt(this,"options",void 0),Yt(this,"layerLevel",0),Yt(this,"focus",void 0),Yt(this,"fill",void 0),Yt(this,"layeredAreas",new Map),Yt(this,"areas",new Map),Yt(this,"rowHeaders",new Map),Yt(this,"columnHeaders",new Map),Yt(this,"activeRowHeaders",new Map),Yt(this,"activeColumnHeaders",new Map),Yt(this,"activeCornerHeaders",new Map),Yt(this,"rowHighlights",new Map),Yt(this,"columnHighlights",new Map),Yt(this,"customSelections",[]),this.options=e,this.focus=gW(e),this.fill=pW(e)}isEnabledFor(e,r){let n=e;e===_u&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return kn(hn,this,Ln).call(this,this.layeredAreas,hW)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return kn(hn,this,Ln).call(this,this.areas,dW)}getAreas(){return[...this.areas.values()]}createRowHeader(){return kn(hn,this,Ln).call(this,this.rowHeaders,JS)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return kn(hn,this,Ln).call(this,this.columnHeaders,JS)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return kn(hn,this,Ln).call(this,this.activeRowHeaders,Yf)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return kn(hn,this,Ln).call(this,this.activeColumnHeaders,Yf)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return kn(hn,this,Ln).call(this,this.activeCornerHeaders,Yf)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return kn(hn,this,Ln).call(this,this.rowHighlights,wW)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return kn(hn,this,Ln).call(this,this.columnHighlights,fW)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(mW({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),$(this.areas.values(),e=>void e.clear()),$(this.layeredAreas.values(),e=>void e.clear()),$(this.rowHeaders.values(),e=>void e.clear()),$(this.columnHeaders.values(),e=>void e.clear()),$(this.activeRowHeaders.values(),e=>void e.clear()),$(this.activeColumnHeaders.values(),e=>void e.clear()),$(this.activeCornerHeaders.values(),e=>void e.clear()),$(this.rowHighlights.values(),e=>void e.clear()),$(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ln(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function eR(t,e,r){return(e=RW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RW(t){var e=EW(t,"string");return typeof e=="symbol"?e:e+""}function EW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qp{constructor(e){eR(this,"ranges",[]),eR(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new qp(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function TW(t,e){SO(t,e),e.add(t)}function qf(t,e,r){SO(t,e),e.set(t,r)}function SO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function me(t,e){return t.get(nt(t,e))}function xl(t,e,r){return t.set(nt(t,e),r),r}function nt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hl=new WeakMap,ke=new WeakMap,Qr=new WeakMap,ht=new WeakSet;class Bg{constructor(e,r){TW(this,ht),qf(this,Hl,void 0),qf(this,ke,void 0),qf(this,Qr,{x:0,y:0}),xl(Hl,this,e),xl(ke,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=me(ke,this).createCellCoords(e,r);let o=me(Hl,this).current().highlight;const s=me(ke,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=nt(ht,this,RO).call(this),{row:h,col:d}=nt(ht,this,rR).call(this,o),g=me(ke,this).fixedRowsBottom(),w=me(ke,this).minSpareRows(),y=me(ke,this).minSpareCols(),b=me(ke,this).autoWrapRow(),E=me(ke,this).autoWrapCol(),v=me(ke,this).createCellCoords(h+i.row,d+i.col);if(v.row>=c){const M=dr(n&&w>0&&g===0),P=v.col+1,x=me(ke,this).createCellCoords(v.row-c,P>=u?P-u:P);this.runLocalHooks("beforeColumnWrap",M,nt(ht,this,Do).call(this,x),P>=u),M.value?this.runLocalHooks("insertRowRequire",me(ke,this).countRenderableRows()):E&&v.assign(x)}else if(v.row<0){const M=dr(E),P=v.col-1,x=me(ke,this).createCellCoords(c+v.row,P<0?u+P:P);this.runLocalHooks("beforeColumnWrap",M,nt(ht,this,Do).call(this,x),P<0),E&&v.assign(x)}if(v.col>=u){const M=dr(n&&y>0),P=v.row+1,x=me(ke,this).createCellCoords(P>=c?P-c:P,v.col-u);this.runLocalHooks("beforeRowWrap",M,nt(ht,this,Do).call(this,x),P>=c),M.value?this.runLocalHooks("insertColRequire",me(ke,this).countRenderableColumns()):b&&v.assign(x)}else if(v.col<0){const M=dr(b),P=v.row-1,x=me(ke,this).createCellCoords(P<0?c+P:P,u+v.col);this.runLocalHooks("beforeRowWrap",M,nt(ht,this,Do).call(this,x),P<0),b&&v.assign(x)}const{rowDir:T,colDir:_}=nt(ht,this,tR).call(this,v);a=T,l=_,o=nt(ht,this,Do).call(this,v)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,r){const n=me(ke,this).createCellCoords(e,r),i=me(Hl,this).current(),o=me(ke,this).visualToRenderableCoords(i.highlight),s=nt(ht,this,Gf).call(this,i.to.row,i.from.row),a=nt(ht,this,Kf).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=nt(ht,this,rR).call(this,i.highlight),g=me(ke,this).createCellCoords(s+n.row,a+n.col),w=i.getTopStartCorner(),y=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&a>=d&&g.col<d){const _=g.col-d;g.col=nt(ht,this,Kf).call(this,w.col,y.col)+_}else if(n.col>0&&a<=d&&g.col>d){const _=nt(ht,this,Kf).call(this,y.col,w.col),M=Math.max(g.col-_,1);g.col=_+M}if(n.row<0&&s>=h&&g.row<h){const _=g.row-h;g.row=nt(ht,this,Gf).call(this,w.row,b.row)+_}else if(n.row>0&&s<=h&&g.row>h){const _=nt(ht,this,Gf).call(this,b.row,w.row),M=Math.max(g.row-_,1);g.row=_+M}const{rowDir:E,colDir:v}=nt(ht,this,tR).call(this,g);u=E,c=v;const T=nt(ht,this,Do).call(this,g);n.row===0&&n.col!==0?l.col=T.col:n.row!==0&&n.col===0?l.row=T.row:(l.row=T.row,l.col=T.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;xl(Qr,this,{x:r,y:n})}resetOffsetSize(){xl(Qr,this,{x:0,y:0})}}function tR(t){const{width:e,height:r}=nt(ht,this,RO).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function RO(){return{width:me(Qr,this).x+me(ke,this).countRenderableColumns(),height:me(Qr,this).y+me(ke,this).countRenderableRows()}}function Gf(t,e){const r=me(ke,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:me(Qr,this).y+r}function Kf(t,e){const r=me(ke,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:me(Qr,this).x+r}function rR(t){const{row:e,col:r}=me(ke,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return me(ke,this).createCellCoords(me(Qr,this).y+e,me(Qr,this).x+r)}function Do(t){const e=t.clone();return e.col=t.col-me(Qr,this).x,e.row=t.row-me(Qr,this).y,me(ke,this).renderableToVisualCoords(e)}Xe(Bg,_n);const sc=0,ac=1,EO=2,Gp=3,_W=[Gp,EO],OW=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Xf=Symbol("root"),nR=Symbol("child");function lc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xf;if(e!==Xf&&e!==nR)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===Xf;let i=sc;if(r){const o=t[0];t.length===0?i=ac:n&&o instanceof el?i=Gp:n&&Array.isArray(o)?i=lc(o,nR):t.length>=2&&t.length<=4&&!t.some((a,l)=>!OW[l].includes(typeof a))&&(i=EO)}return i}function Kp(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!_W.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Gp;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Vt(u)&&(u=a),Vt(c)&&(c=l),!n){const g=a,w=l,y=u,b=c;a=Math.min(g,y),l=Math.min(w,b),u=Math.max(g,y),c=Math.max(w,b)}const h=e(a,l),d=e(u,c);return r(h,h,d)}}function MW(t){const e=lc(t.getSelected());if(e===sc||e===ac)return[];const r=Kp(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;$(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.col,0),c=l.col-u+1;$(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return yo(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function IW(t){const e=lc(t.getSelected());if(e===sc||e===ac)return[];const r=Kp(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;$(t.getSelected(),s=>{const{from:a,to:l}=r(s),u=Math.max(a.row,0),c=l.row-u+1;$(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((s,a)=>s-a);return yo(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function No(t,e,r){PW(t,e),e.set(t,r)}function PW(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ni(t,e,r){return(e=xW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xW(t){var e=HW(t,"string");return typeof e=="symbol"?e:e+""}function HW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fe(t,e){return t.get(TO(t,e))}function dn(t,e,r){return t.set(TO(t,e),r),r}function TO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tt=new WeakMap,ki=new WeakMap,Al=new WeakMap,Zs=new WeakMap,Dl=new WeakMap,Qs=new WeakMap;class _O{constructor(e,r){var n=this;Ni(this,"settings",void 0),Ni(this,"tableProps",void 0),Ni(this,"inProgress",!1),Ni(this,"selectedRange",new qp((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Ni(this,"highlight",void 0),No(this,Tt,void 0),No(this,ki,void 0),Ni(this,"selectedByRowHeader",new Set),Ni(this,"selectedByColumnHeader",new Set),No(this,Al,!1),No(this,Zs,!1),No(this,Dl,"unknown"),No(this,Qs,-1),this.settings=e,this.tableProps=r,this.highlight=new SW({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[l_()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),dn(Tt,this,new Bg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),dn(ki,this,new Bg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Fe(Tt,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...o)}),Fe(Tt,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...o)}),Fe(Tt,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...o)}),Fe(Tt,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...o)}),Fe(Tt,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...o)}),Fe(Tt,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("insertColRequire",...o)}),Fe(Tt,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...o)}),Fe(Tt,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...o)}),Fe(ki,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformFocus",...o)}),Fe(ki,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){dn(Dl,this,e)}markEndSource(){dn(Dl,this,"unknown")}getSelectionSource(){return Fe(Dl,this)}setExpectedLayers(e){dn(Qs,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,dn(Qs,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Vt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();dn(Al,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!o||o&&!s&&Vt(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!o||i===0&&r.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(r),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=Fe(Qs,this)===-1||this.selectedRange.size()===Fe(Qs,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&($(this.highlight.getAreas(),w=>void w.clear()),$(this.highlight.getLayeredAreas(),w=>void w.clear()),$(this.highlight.getRowHeaders(),w=>void w.clear()),$(this.highlight.getColumnHeaders(),w=>void w.clear()),$(this.highlight.getActiveRowHeaders(),w=>void w.clear()),$(this.highlight.getActiveColumnHeaders(),w=>void w.clear()),$(this.highlight.getActiveCornerHeaders(),w=>void w.clear()),$(this.highlight.getRowHighlights(),w=>void w.clear()),$(this.highlight.getColumnHighlights(),w=>void w.clear())),this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(dp,e.highlight)&&(this.isMultiple()||r>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(X_,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),v=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(v).commit(),d.add(b).commit(),g.add(v).commit()):(a.add(b).add(E).commit(),l.add(v).add(T).commit(),d.add(b).add(E).commit(),g.add(v).add(T).commit())}const w=!Fe(Zs,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!Fe(Zs,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&y&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(_u,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(dn(Al,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?Fe(Tt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Tt,this).resetOffsetSize(),this.setRangeStart(Fe(Tt,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?Fe(Tt,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Fe(Tt,this).resetOffsetSize(),this.setRangeEnd(Fe(Tt,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:o}=n.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?Fe(ki,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):Fe(ki,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=Fe(ki,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(De(i.row+h,c,a-1),i.col),g=this.tableProps.createCellCoords(De(o.row+r,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(De(s.row+r,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,De(i.col+h,c,a-1)),g=this.tableProps.createCellCoords(o.row,De(o.col+r,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,De(s.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const r=dr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&Fe(Al,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;dn(Zs,this,g),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(De(d.row,u,o-1),De(d.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),y=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),dn(Zs,this,!1)}selectCells(e){var r=this;const n=lc(e);if(n===ac)return!1;if(n===sc)throw new Error(rr`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Kp(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),$(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof r=="string"?this.tableProps.propToCol(r):r,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let g=0,w=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=De(n.row,u,s-1),w=De(n.col,Math.min(i,o),Math.max(i,o))):(g=De(n,u,s-1),w=i);const y=this.tableProps.createCellCoords(g,w),b=l===0?0:De(y.row,u,-1),E=s-1,v=this.tableProps.createCellCoords(b,i),T=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",v,T,y),v.row=b,T.row=E,this.setRangeStartOnly(v,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",v,T,y),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(h=De(n.row,Math.min(e,r),Math.max(e,r)),d=De(n.col,a,o-1)):(h=e,d=De(n,a,o-1));const g=this.tableProps.createCellCoords(h,d),w=s===0?0:De(g.col,a,-1),y=o-1,b=this.tableProps.createCellCoords(e,w),E=this.tableProps.createCellCoords(r,y);this.runLocalHooks("beforeSelectRows",b,E,g),b.col=w,E.col=y,this.setRangeStartOnly(b,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",b,E,g),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=r-1;u.assign({row:De(u.row,this.settings.navigableHeaders?-1/0:0,c),col:De(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:De(a.row,-1/0,c),col:De(a.col,-1/0,h)}),l.assign({row:De(l.row,-1/0,c),col:De(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(_u,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}Xe(_O,_n);const iR=/^(\r\n|\n\r|\r|\n)/,AW=/^[^\t\r\n]+/,oR=/^\t/;function DW(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(oR))t=t.replace(oR,""),r+=1,e[n][r]="";else if(t.match(iR))t=t.replace(iR,""),r=0,n+=1,e[n]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(AW);o=s?s[0]:"",t=t.slice(o.length)}e[n][r]=o}return e}function Ra(t){let e,r,n,i,o="",s;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(o+="	"),s=t[e][n],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==r-1&&(o+=`
`)}return o}function Li(t,e,r){return(e=NW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NW(t){var e=kW(t,"string");return typeof e=="symbol"?e:e+""}function kW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zo{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Li(this,"hot",void 0),Li(this,"metaManager",void 0),Li(this,"tableMeta",void 0),Li(this,"dataSource",void 0),Li(this,"duckSchema",void 0),Li(this,"colToPropCache",void 0),Li(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,o=0,s=!1;if(typeof r=="function"){const a=Xm(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=s?r(n):r[n];if(Ct(a)){if(typeof a.data<"u"){const l=s?o:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return n0(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,o=n,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Oe(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&fe(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(fe(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ha(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=mr(this.getSchema()):(w=[],Ye(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},u_(w,this.getSchema())),d.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,r)),this.hot.runHooks("afterCreateRow",g,a,n),{delta:a,startPhysicalIndex:s}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,r,n)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let g=0;for(let w=d;g<r&&l+g<s;w++){if(typeof c!="number"||c>=l+g)if(u>0)for(let y=0;y<u;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<u;y++)o[y].splice(w,0,null);g+=1}return g>0&&(e==null?this.metaManager.createColumn(null,g):n!=="auto"&&this.metaManager.createColumn(d,r)),this.hot.columnIndexMapper.insertIndexes(c,g,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),g,n),this.refreshDuckSchema(),{delta:g,startPhysicalIndex:d}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const o=this.visualRowsToPhysical(i,r),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,n)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=fe(this.tableMeta.columns)||fe(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,r),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,o,n)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],r),h===0&&this.metaManager.removeColumn(o[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,o,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];hC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return uD(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),o}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),o=i.slice(r,r+n),s=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];hC(l,s);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),o}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const o=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const o=this.hot.runHooks("modifyRowData",n);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&Cn(i,r))a=i[r];else if(s&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=dr(a);this.hot.runHooks("modifyData",e,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let o=n,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=dr(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&Cn(s,r))s[r]=o;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=s,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],o);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;s[r]=o}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let o=(n+e)%n,s=r,a;for(;o<n&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let o=(n+e)%n,s=r;for(;o<n&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Zo.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Zo.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(o=Math.min(e.row,r.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,r.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,r){return Ra(this.getRange(e,r,Zo.DESTINATION_RENDERER))}getCopyableText(e,r){return Ra(this.getRange(e,r,Zo.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:LW,getItem:FW,hasItem:OO}=Co("cellTypes");function VW(t){if(!OO(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return FW(t)}function WW(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&P_(t,r),n&&fk(t,n),i&&wk(t,i),LW(t,e)}function $W(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!Cn(e,t)}function uc(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?VW(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Oe(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ct(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Oe(n,(o,s)=>{if($W(s,r)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),bi(t,i)}function BW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}AD(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function su(t){return Number.isInteger(t)&&t>=0}function au(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Nl(t){return t==null}const MO=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),no(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),no(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),c_(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function sR(t,e,r){return(e=jW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jW(t){var e=zW(t,"string");return typeof e=="symbol"?e:e+""}function zW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UW(){return class{}}class YW{constructor(e){sR(this,"metaCtor",UW()),sR(this,"meta",void 0),this.meta=this.metaCtor.prototype,bi(this.meta,MO()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;bi(this.meta,e),uc(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function qW(t,e,r){return(e=GW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GW(t){var e=KW(t,"string");return typeof e=="symbol"?e:e+""}function KW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XW{constructor(e){qW(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){bi(this.meta,e),uc(this.meta,e,e)}}function kl(t,e,r){return(e=ZW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZW(t){var e=QW(t,"string");return typeof e=="symbol"?e:e+""}function QW(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iu{constructor(e){kl(this,"valueFactory",void 0),kl(this,"data",[]),kl(this,"index",[]),kl(this,"holes",new Set),this.valueFactory=e}obtain(e){au(()=>su(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;au(()=>su(e)||Nl(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let s=0;s<r;s++)n.push(i+s),this.data.push(void 0);const o=Nl(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...n,...this.index.slice(o)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;au(()=>su(e)||Nl(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Nl(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const o=n[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function aR(t,e,r){return(e=JW(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JW(t){var e=e$(t,"string");return typeof e=="symbol"?e:e+""}function e$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t$=["data","width"];class r${constructor(e){aR(this,"globalMeta",void 0),aR(this,"metas",new Iu(()=>this._createMeta())),this.globalMeta=e,this.metas=new Iu(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);bi(n,r),uc(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return BW(this.globalMeta.getMetaConstructor(),t$).prototype}}function lR(t,e,r){return(e=n$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n$(t){var e=i$(t,"string");return typeof e=="symbol"?e:e+""}function i$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o${constructor(e){lR(this,"columnMeta",void 0),lR(this,"metas",new Iu(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);bi(i,n),uc(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var o;const s=this.metas.obtain(e).obtain(r);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(n),s[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)fe(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){au(()=>su(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Iu(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class IO{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new YW(e),this.tableMeta=new XW(this.globalMeta),this.columnMeta=new r$(this.globalMeta),this.cellMeta=new o$(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Xe(IO,_n);function uR(t,e,r,n){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=Qu(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Pe(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Zo(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let y,b=0,E=0;for(b=0,E=d.startRows;b<E;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)y=mr(w),t.push(y);else if(i.dataType==="array")y=mr(w[0]),t.push(y);else{y=[];for(let v=0,T=d.startCols;v<T;v++)y.push(null);t.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),r(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&_e(i.rootElement,[s_(-1),Ju(i.countCols()+(i.view?i.countRowHeaders():0))])}function cR(t,e,r){return(e=s$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s$(t){var e=a$(t,"string");return typeof e=="symbol"?e:e+""}function a$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l${constructor(e){var r=this;cR(this,"metaManager",void 0),cR(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),de.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Cn(e,"type")?e.type:null;let c=Pe(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function u$(t,e,r){c$(t,e),e.set(t,r)}function c$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zf(t,e,r){return(e=h$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h$(t){var e=d$(t,"string");return typeof e=="symbol"?e:e+""}function d$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f$(t,e){return t.get(g$(t,e))}function g$(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hR=new WeakMap;class m${constructor(e){Zf(this,"metaManager",void 0),Zf(this,"usageTracker",new Set),Zf(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),u$(this,hR,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(r,l,o),s&&this.installPropWatcher(i,l,o)):n&&(this.installPropWatcher(r,l,f$(hR,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,o,s),this[r]=o},enumerable:!0,configurable:!0})}}const PO="gridDefault",xO="editorManager.handlingEditor",p$={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},w$="hooksRefRegisterer",HO={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){$(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Oe(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Xn(HO,"MIXIN_NAME",w$,{writable:!1,enumerable:!1});function Ur(t,e,r){return(e=v$(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v$(t){var e=y$(t,"string");return typeof e=="symbol"?e:e+""}function y$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const b$="base",ot=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Xp{static get EDITOR_TYPE(){return b$}constructor(e){Ur(this,"hot",void 0),Ur(this,"state",ot.VIRGIN),Ur(this,"_opened",!1),Ur(this,"_fullEditMode",!1),Ur(this,"_closeCallback",null),Ur(this,"TD",null),Ur(this,"row",null),Ur(this,"col",null),Ur(this,"prop",null),Ur(this,"originalValue",null),Ur(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,o,s){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:ot.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,o,s;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[n,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,o,s,"edit")}beginEditing(e,r){if(this.state!==ot.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=ot.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:is(this.originalValue);this.setValue(l)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),n.view.scrollViewport(n._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,r,n){let i;if(n){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),n(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===ot.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===ot.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=ot.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=ot.FINISHED,this.discardEditor(s)}):(this.state=ot.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=ot.FINISHED,this.discardEditor()}discardEditor(e){this.state===ot.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=ot.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ot.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===ot.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=xr(r),a=tr(r),l=xr(this.hot.rootElement),u=tr(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:y}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=y.name,E=["master","inline_start"].includes(b)?d:0,v=["master","top","bottom"].includes(b)?g:0,T=s.top===l.top?0:1;let _=s.top-l.top-T-E,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-w-1+v:M=s.left-l.left-1-v,["top","top_inline_start_corner"].includes(b)&&(_+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(M+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),x=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),F=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),H=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&x<=0||x===H)&&(_+=1),F<=0&&(M+=1);const G=i.rowsRenderCalculator.startPosition,J=i.columnsRenderCalculator.startPosition,ae=Math.abs(n.inlineStartOverlay.getScrollPosition()),q=n.topOverlay.getScrollPosition(),ee=ir(this.hot.rootDocument);let lt=r.offsetTop;if(["inline_start","master"].includes(b)&&(lt+=G-q),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:O,wtTable:I}=n.bottomOverlay.clone;lt+=O.getWorkspaceHeight()-I.getHeight()-ee}let Ee=r.offsetLeft;this.hot.isRtl()?(Ee>=0?Ee=y.getWidth()-r.offsetLeft:Ee=Math.abs(Ee),Ee+=J-ae-a):["top","master","bottom"].includes(b)&&(Ee+=J-ae);const ye=o.getComputedStyle(this.TD),qe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",$e=parseInt(ye[qe],10)>0?0:1,Me=parseInt(ye.borderTopWidth,10)>0?0:1,yr=tr(r)+$e,f=nr(r)+Me,m=eN(c)?ee:0,p=tN(h)?ee:0,C=this.hot.view.maximumVisibleElementWidth(Ee)-m+$e,R=Math.max(this.hot.view.maximumVisibleElementHeight(lt)-p+Me,this.hot.stylesHandler.getDefaultRowHeight());return{top:_,start:M,height:f,maxHeight:R,width:yr,maxWidth:C}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Xe(Xp,HO);const C$={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===ot.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},S$={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},R$={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},E$={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},T$={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),tc(e))}};function _$(){return[p$,C$,S$,R$,E$,T$]}const O$={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},M$={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),o=r.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},I$={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},P$={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},x$={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},H$={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},A$={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},D$={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},N$={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},k$={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},L$={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:o}=t.getSelectedRangeLast(),s=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||s){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},F$={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},V$={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},W$={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),o=r.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,n.col),a=n.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function $$(){return[O$,M$,I$,P$,x$,H$,A$,D$,N$,k$,L$,F$,V$,W$]}const B$={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},j$={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},z$={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-o.row,-o.col):r.transformStart(-o.row,-o.col),r.markEndSource()}},U$={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(o.row,o.col):r.transformStart(o.row,o.col),r.markEndSource()}},Y$={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},q$={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},G$={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},K$={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},X$={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Z$={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},Q$={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},J$={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},eB={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},tB={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},rB={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},nB={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+n;o=o===0?-1:-o,i===-n?o=-1:i+o<n&&(o=-(i+n)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function iB(){return[B$,j$,z$,U$,Y$,q$,G$,K$,X$,Z$,Q$,J$,eB,tB,rB,nB]}const oB={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},sB={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(r,n),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},aB={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},lB={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},uB={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},cB=[..._$(),...$$(),...iB(),oB,sB,aB,lB,uB];function AO(t){const e={};return cB.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function hB(t){const e=t.getShortcutManager().addContext("editor"),r=AO(t),n={group:xO};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>r.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>r.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>r.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function dB(t){const e=t.getShortcutManager().addContext("grid"),r=AO(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return fe(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:PO};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>r.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:xO,runOnlyIf:()=>fe(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function fB(t){[dB,hB].forEach(e=>e(t))}function gB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=dR(t),i=dR(t);return n.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),r.before(n),r.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function dR(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&_e(r,[Cu("Focus catcher")]),r}function mB(t){const e=pB(t);let r;const{activate:n,deactivate:i}=gB(t,{onFocusFromTop(){var h;const d=(h=e(r))!==null&&h!==void 0?h:jg(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(r))!==null&&h!==void 0?h:zg(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,d,g,w,y)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,y.value=!0),s){var b;r=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:PO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(r=h.shiftKey?jg(t):zg(t)),u(),!1;h.preventDefault()},position:"after"}])}function jg(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,o=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=r.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function zg(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function pB(t){return e=>{if(!e)return null;const r=jg(t),n=zg(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function Ts(t){eo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function cc(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=r.getFirstFullyVisibleColumn(),s=r.getLastFullyVisibleColumn(),a=n.getTopStartCorner().col,l=n.getBottomEndCorner().col,u=a<=o,c=l>=s,h=r.getFirstFullyVisibleRow(),d=r.getLastFullyVisibleRow(),g=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,y=g<=h,b=w>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?n.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:y&&b?n.highlight.row:y?g:b?w:E.row}}}function wB(t){return e=>{const r=cc(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;Ts(t.getCell(n?-1:0,r,!0))})}}function vB(){return()=>{}}function yB(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;Ts(t.getCell(r,n,!0))})}}function bB(t){return e=>{const r=cc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Ts(t.getCell(i,o,!0))})}}function CB(t){return e=>{const r=cc(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:o}=n;Ts(t.getCell(i,o,!0))})}}function SB(t){return e=>{const r=cc(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;Ts(t.getCell(r,n?-1:0,!0))})}}function RB(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,o=()=>{Ts(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&n>=0)t.scrollViewportTo({row:n},o);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},o)}}}function EB(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n){r=!1;return}let s;e.isFocusSelectionChanged()?s=yB(t):e.isSelectedByCorner()?s=vB():e.isSelectedByRowHeader()?s=SB(t):e.isSelectedByColumnHeader()?s=wB(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=bB(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=RB(t):e.getSelectedRange().size()>1&&(s=CB(t)),(o=s)===null||o===void 0||o(i)}}}const fR=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ll=t=>t.map(e=>{const r=e.toLowerCase();return fR.has(r)?fR.get(r):r}).sort().join("+"),TB=t=>t.split("+"),gR=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Qf=t=>{let{which:e,key:r}=t;if(gR.has(e))return gR.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},DO=Symbol("shortcut-context");function NO(t){return Ct(t)&&t.__kindOf===DO}const _B=t=>{const e=rc({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:w=!1,relativeToGroup:y,position:b,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Vt(c))throw new Error("You need to define the shortcut's group.");if(Pe(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(rr`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const v={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:w};fe(y)&&(v.relativeToGroup=y,v.position=b),NO(E)&&(v.forwardToContext=E),l.forEach(T=>{const _=Ll(T);if(e.hasItem(_)){const P=e.getItem(_);let x=P.findIndex(F=>F.group===y);x!==-1?b==="before"?x-=1:x+=1:x=P.length,P.splice(x,0,v)}else e.addItem(_,[v])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Oe(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),r(c)})},i=l=>{const u=Ll(l);e.removeItem(u)};return{__kindOf:DO,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=Ll(l),c=e.getItem(u);return fe(c)?c.slice():[]},hasShortcut:l=>{const u=Ll(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(w=>w.group!==l);g.length===0?i(TB(h)):(d.length=0,d.push(...g))})}}};function OB(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const MB=["meta","alt","shift","control"],Js=OB(),ea=[];let Fl=0;function IB(t,e,r,n,i){const o=g=>MB.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return g.altKey&&y.push("alt"),w&&(g.ctrlKey||g.metaKey)?y.push("control/meta"):(g.ctrlKey&&y.push("control"),g.metaKey&&y.push("meta")),g.shiftKey&&y.push("shift"),y},a=g=>{if(e(g)===!1||r(g)===!1||g.keyCode===229||typeof g.key!="string"||Yi(g))return;const y=Qf(g);let b=[];o(y)||(b=s(g));const E=[y].concat(b);!i(g,E)&&(EC()&&b.includes("meta")||!EC()&&b.includes("control"))&&i(g,[y].concat(s(g,!0))),n(g)},l=g=>{if(typeof g.key=="string"){const w=Qf(g);o(w)&&Js.press(w)}},u=g=>{if(typeof g.key=="string"){const w=Qf(g);o(w)&&Js.release(w)}},c=()=>{Js.releaseAll()};return{mount:()=>{let g=t;for(Fl+=1;g;)Fl===1&&(g.document.documentElement.addEventListener("keydown",l),ea.push({event:"keydown",listener:l}),g.document.documentElement.addEventListener("keyup",u),ea.push({event:"keyup",listener:u})),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Aa(g)},unmount:()=>{let g=t;for(Fl-=1;g;){if(Fl===0){for(let w=0;w<ea.length;w++){const{event:y,listener:b}=ea[w];g.document.documentElement.removeEventListener(y,b)}ea.length=0}g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Aa(g)}},isPressed:g=>Js.isPressed(g),releasePressedKeys:()=>Js.releaseAll()}}const PB=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const o=rc({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const y=_B(w);return o.addItem(w,y),y},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(rr`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let h=!1;const d=function(w,y){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=NO(b)?b:u(b);let v=!1;if(!E.hasShortcut(y))return v;const T=E.getShortcuts(y);for(let _=0;_<T.length;_++){const{callback:M,runOnlyIf:P,preventDefault:x,stopPropagation:F,captureCtrl:U,forwardToContext:H}=T[_];if(P(w)===!0){if(h=U,v=M(w,y)===!1,h=!1,x&&w.preventDefault(),F&&(tc(w),w.stopPropagation()),v)break;H&&d(w,y,H)}}return v},g=IB(e,r,n,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};function mR(t){const{classNames:e}=UD(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function xB(t,e){kO(t,e),e.add(t)}function Fi(t,e,r){kO(t,e),e.set(t,r)}function kO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(Xr(t,e))}function Ir(t,e,r){return t.set(Xr(t,e),r),r}function Xr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pR=23;var Vi=new WeakMap,Pu=new WeakMap,Zp=new WeakMap,Ug=new WeakMap,si=new WeakMap,fa=new WeakMap,Na=new WeakMap,gn=new WeakSet;class HB{constructor(e,r){xB(this,gn),Fi(this,Vi,void 0),Fi(this,Pu,void 0),Fi(this,Zp,void 0),Fi(this,Ug,void 0),Fi(this,si,!0),Fi(this,fa,{}),Fi(this,Na,{}),Ir(Pu,this,e),Ir(Ug,this,r)}isClassicTheme(){return It(si,this)}getCSSVariableValue(e){var r;if(It(si,this))return null;if(It(fa,this)[`--ht-${e}`])return It(fa,this)[`--ht-${e}`];const n=(r=Xr(gn,this,NB).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Xr(gn,this,LO).call(this,`--ht-${e}`);if(n!==null)return It(fa,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=It(Na,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(It(si,this))return pR;const e=Xr(gn,this,AB).call(this);return e||pR}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Ir(Vi,this,void 0),Ir(si,this,!0),Xr(gn,this,Jf).call(this);return}if(e&&e!==It(Vi,this)){if(!/ht-theme-.*/.test(e)){Sn(`Invalid theme name: ${e}. Please provide a valid theme name.`),Ir(Vi,this,void 0),Ir(si,this,!1),Xr(gn,this,Jf).call(this);return}It(Vi,this)&&Xr(gn,this,kB).call(this),Ir(Vi,this,e),Ir(si,this,!1),Xr(gn,this,Jf).call(this)}}getThemeName(){return It(Vi,this)}}function AB(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function Jf(){this.isClassicTheme()||Ir(Zp,this,getComputedStyle(It(Pu,this)));const t=Xr(gn,this,DB).call(this,["box-sizing","border-bottom-width"]);It(Na,this).td={...It(Na,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function DB(t){const e=It(Ug,this),r=It(Pu,this),n=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),n.appendChild(i),r.appendChild(n);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),r.removeChild(n),u}function NB(t){const e=Math.ceil(parseFloat(Xr(gn,this,LO).call(this,t)));return Number.isNaN(e)?null:e}function LO(t){const e=It(Zp,this).getPropertyValue(t);return e===""?null:e}function kB(){Ir(Na,this,{}),Ir(fa,this,{}),Ir(si,this,!0)}function LB(t,e){FO(t,e),e.add(t)}function wR(t,e,r){FO(t,e),e.set(t,r)}function FO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vR(t,e){return t.get(hs(t,e))}function yR(t,e,r){return t.set(hs(t,e),r),r}function hs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yg=new WeakMap,qg=new WeakMap,Ea=new WeakSet;class FB{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;LB(this,Ea),wR(this,Yg,void 0),wR(this,qg,void 0),yR(Yg,this,r),yR(qg,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=hs(Ea,this,bR).call(this,e.from,r,n);if(i===null)return null;const o=hs(Ea,this,bR).call(this,e.to,-r,-n);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function bR(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=hs(Ea,this,CR).call(this,vR(Yg,this),t.row,e);if(n===null)return null;const i=hs(Ea,this,CR).call(this,vR(qg,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function CR(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let eg=null;const tg=new Map;function VO(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Ci(o);let a,l,u,c,h,d,g=!0;uV(i)&&lV(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=Go(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Go(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),X(this.rootElement,"ht-wrapper"),X(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),X(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(r=e?.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new HB(o.rootElement,o.rootDocument),e.language=aW(e.language);const b=Object.fromEntries(Object.entries(e).filter(f=>{let[m]=f;return!(de.getSingleton().isRegistered(m)||de.getSingleton().isDeprecated(m))})),E=new IO(o,b,[l$,m$]),v=E.getTableMeta(),T=E.getGlobalMeta(),_=rc();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),Go(this)&&fD(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${r_()}`,tg.set(this.guid,this),this.columnIndexMapper=new Wg,this.rowIndexMapper=new Wg,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{o.runHooks("afterRowSequenceChange",f)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",f=>{o.runHooks("beforeCompositionStart",f)}),l=new SV(o);const M=Co(this.guid);M.register("cellRangeMapper",new FB({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=f=>{const{row:m,col:p}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?o.columnIndexMapper.getRenderableFromVisualIndex(p):p)},x=f=>{const{row:m,col:p}=f;return o._createCellCoords(m>=0?o.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?o.columnIndexMapper.getVisualFromRenderableIndex(p):p)},F=(f,m)=>{const p=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.rowIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>R||p===-1&&O<C?null:O>=0?o.rowIndexMapper.getRenderableFromVisualIndex(O):O},U=(f,m)=>{const p=m>f?1:-1,C=Math.min(f,m),R=Math.max(f,m),O=o.columnIndexMapper.getNearestNotHiddenIndex(f,p);return O===null||p===1&&O>R||p===-1&&O<C?null:O>=0?o.columnIndexMapper.getRenderableFromVisualIndex(O):O};let H=new _O(v,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:f=>a.propToCol(f),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(f,m)=>o._createCellCoords(f,m),createCellRange:(f,m,p)=>o._createCellRange(f,m,p),visualToRenderableCoords:P,renderableToVisualCoords:x,findFirstNonHiddenRenderableRow:F,findFirstNonHiddenRenderableColumn:U,isDisabledCellSelection:(f,m)=>f<0||m<0?o.getSettings().disableVisualSelection:o.getCellMeta(f,m).disableVisualSelection});this.selection=H;const G=f=>{let{hiddenIndexesChanged:m}=f;this.forceFullRender=!0,m&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",(f,m)=>{const p=dr(!1),C=this.selection.getSelectedRange(),{from:R,to:O}=C.current(),I=C.size()-1;this.runHooks("afterSelection",R.row,R.col,O.row,O.col,p,I),this.runHooks("afterSelectionByProp",R.row,o.colToProp(R.col),O.row,o.colToProp(O.col),p,I),m&&(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(f);const D=H.isSelectedByRowHeader(),j=H.isSelectedByColumnHeader();D&&j?X(this.rootElement,["ht__selection--rows","ht__selection--columns"]):D?(He(this.rootElement,"ht__selection--columns"),X(this.rootElement,"ht__selection--rows")):j?(He(this.rootElement,"ht__selection--rows"),X(this.rootElement,"ht__selection--columns")):He(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(H.getSelectionSource())||c.closeEditor(null),H.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",f=>{this.runHooks("beforeSelectionFocusSet",f.row,f.col)}),this.selection.addLocalHook("afterSetFocus",f=>{const m=dr(!1);this.runHooks("afterSelectionFocusSet",f.row,f.col,m),(!m.isTouched()||m.isTouched()&&!m.value)&&d.scrollTo(f),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:p,to:C}=f[m];this.runHooks("afterSelectionEnd",p.row,p.col,C.row,C.col,m),this.runHooks("afterSelectionEndByProp",p.row,o.colToProp(p.col),C.row,o.colToProp(C.col),m),H.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),He(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("modifyTransformFocus",...m)}).addLocalHook("afterModifyTransformFocus",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterModifyTransformFocus",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),p=0;p<f;p++)m[p]=arguments[p];return n.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),u={alter(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;const O=I=>{if(I.length===0)return[];const D=[...I];return D.sort((V,A)=>{let[W]=V,[te]=A;return W===te?0:W>te?1:-1}),yo(D,(V,A)=>{let[W,te]=A;const oe=V[V.length-1],[Ie,be]=oe,re=Ie+be;if(W<=re){const Te=Math.max(te-(re-W),0);oe[1]+=Te}else V.push([W,te]);return V},[D[0]])};switch(f){case"insert_row_below":case"insert_row_above":const I=o.countSourceRows();if(v.maxRows===I)return;const D=f==="insert_row_below"?"below":"above";m=m??(D==="below"?I:0);const{delta:j,startPhysicalIndex:V}=a.createRow(m,p,{source:C,mode:D});H.shiftRows(o.toVisualRow(V),j);break;case"insert_col_start":case"insert_col_end":const A=f==="insert_col_end"?"end":"start";m=m??(A==="end"?o.countSourceCols():0);const{delta:W,startPhysicalIndex:te}=a.createCol(m,p,{source:C,mode:A});if(W){if(Array.isArray(v.colHeaders)){const be=[o.toVisualColumn(te),0];be.length+=W,Array.prototype.splice.apply(v.colHeaders,be)}H.shiftColumns(o.toVisualColumn(te),W)}break;case"remove_row":const oe=be=>{let re=0;$(be,Te=>{let[ce,xe]=Te;const Ge=no(ce)?o.countRows()-1:Math.max(ce-re,0);if(Number.isInteger(ce)&&(ce=Math.max(ce-re,0)),!a.removeRow(ce,xe,C))return;if(H.isSelected()){const{row:ft}=o.getSelectedRangeLast().highlight;ft>=ce&&ft<=ce+xe-1&&c.closeEditor(!0)}const ar=o.countRows(),St=v.fixedRowsTop;St>=Ge+1&&(v.fixedRowsTop-=Math.min(xe,St-Ge));const br=v.fixedRowsBottom;if(br&&Ge>=ar-br&&(v.fixedRowsBottom-=Math.min(xe,br)),ar===0)H.deselect();else if(C==="ContextMenu.removeRow"){const ft=H.getSelectedRange(),Bt=ft.pop();ft.clear().set(Bt.from).current().setTo(Bt.to),H.refresh()}else H.shiftRows(ce,-xe);re+=xe})};Array.isArray(m)?oe(O(m)):oe([[m,p]]);break;case"remove_col":const Ie=be=>{let re=0;$(be,Te=>{let[ce,xe]=Te;const Ge=no(ce)?o.countCols()-1:Math.max(ce-re,0);let sr=o.toPhysicalColumn(Ge);if(Number.isInteger(ce)&&(ce=Math.max(ce-re,0)),!a.removeCol(ce,xe,C))return;if(H.isSelected()){const{col:ft}=o.getSelectedRangeLast().highlight;ft>=ce&&ft<=ce+xe-1&&c.closeEditor(!0)}if(o.countCols()===0)H.deselect();else if(C==="ContextMenu.removeColumn"){const ft=H.getSelectedRange(),Bt=ft.pop();ft.clear().set(Bt.from).current().setTo(Bt.to),H.refresh()}else H.shiftColumns(ce,-xe);const br=v.fixedColumnsStart;br>=Ge+1&&(v.fixedColumnsStart-=Math.min(xe,br-Ge)),Array.isArray(v.colHeaders)&&(typeof sr>"u"&&(sr=-1),v.colHeaders.splice(sr,xe)),re+=xe})};Array.isArray(m)?Ie(O(m)):Ie([[m,p]]);break;default:throw new Error(`There is no such action "${f}"`)}R||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const f=v.minRows,m=v.minSpareRows,p=v.minCols,C=v.minSpareCols;if(f){const R=o.countRows();R<f&&a.createRow(R,f-R,{source:"auto"})}if(m){const R=o.countEmptyRows(!0);if(R<m){const O=m-R,I=Math.min(O,v.maxRows-o.countSourceRows());a.createRow(o.countRows(),I,{source:"auto"})}}{let R;(p||C)&&(R=o.countEmptyCols(!0));let O=o.countCols();if(p&&!v.columns&&O<p){const I=p-O;R+=I,a.createCol(O,I,{source:"auto"})}if(C&&!v.columns&&o.dataType==="array"&&R<C){O=o.countCols();const I=C-R,D=Math.min(I,v.maxCols-O);a.createCol(O,D,{source:"auto"})}}},populateFromArray(f,m,p,C,R){let O,I,D,j;const V=[],A={},W=[],te=f.row,oe=f.col;if(I=m.length,I===0)return!1;let Ie=0,be=0;switch(Ct(p)&&(Ie=p.col-oe+1,be=p.row-te+1),R){case"shift_down":const re=hf(m),Te=re.length,ce=Math.max(Te,Ie),xe=o.getData().slice(te),Ge=hf(xe).slice(oe,oe+ce);for(D=0;D<ce;D+=1)if(D<Te){for(O=0,I=re[D].length;O<be-I;O+=1)re[D].push(re[D][O%I]);D<Ge.length?W.push(re[D].concat(Ge[D])):W.push(re[D].concat(new Array(xe.length).fill(null)))}else W.push(re[D%Te].concat(Ge[D]));o.populateFromArray(te,oe,hf(W));break;case"shift_right":const sr=m.length,ar=Math.max(sr,be),St=o.getData().slice(te).map(ut=>ut.slice(oe));for(O=0;O<ar;O+=1)if(O<sr){for(D=0,j=m[O].length;D<Ie-j;D+=1)m[O].push(m[O][D%j]);if(O<St.length)for(let ut=0;ut<St[O].length;ut+=1)m[O].push(St[O][ut]);else m[O].push(...new Array(St[0].length).fill(null))}else m.push(m[O%I].slice(0,ar).concat(St[O]));o.populateFromArray(te,oe,m);break;case"overwrite":default:A.row=f.row,A.col=f.col;let br=0,ft=0,Bt=!0,On;const _s=function($r){let sn=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Mn=m[$r%m.length];return sn!==null?Mn[sn%Mn.length]:Mn},Oi=m.length,Qn=p?p.row-f.row+1:0;for(p?I=Qn:I=Math.max(Oi,Qn),O=0;O<I&&!(p&&A.row>p.row&&Qn>Oi||!v.allowInsertRow&&A.row>o.countRows()-1||A.row>=v.maxRows);O++){const ut=O-br,$r=_s(ut).length,sn=p?p.col-f.col+1:0;if(p?j=sn:j=Math.max($r,sn),A.col=f.col,On=o.getCellMeta(A.row,A.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&On.skipRowOnPaste){br+=1,A.row+=1,I+=1;continue}for(ft=0,D=0;D<j&&!(p&&A.col>p.col&&sn>$r||!v.allowInsertColumn&&A.col>o.countCols()-1||A.col>=v.maxCols);D++){if(On=o.getCellMeta(A.row,A.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&On.skipColumnOnPaste){ft+=1,A.col+=1,j+=1;continue}if(On.readOnly&&C!=="UndoRedo.undo"){A.col+=1;continue}const Mn=D-ft;let Cr=_s(ut,Mn),xt=o.getDataAtCell(A.row,A.col);if(Cr!==null&&typeof Cr=="object")if(Array.isArray(Cr)&&xt===null&&(xt=[]),xt===null||typeof xt!="object")Bt=!1;else{const Mi=Ha(Array.isArray(xt)?xt:xt[0]||xt),il=Ha(Array.isArray(Cr)?Cr:Cr[0]||Cr);c_(Mi,il)||Array.isArray(Mi)&&Array.isArray(il)?Cr=mr(Cr):Bt=!1}else xt!==null&&typeof xt=="object"&&(Bt=!1);Bt&&V.push([A.row,A.col,Cr]),Bt=!0,A.col+=1}A.row+=1}o.setDataAtCell(V,null,null,C||"populateFromArray");break}}};function J(f){const m=g0(f);Yp(m)?(o.runHooks("beforeLanguageChange",m),T.language=m,o.runHooks("afterLanguageChange",m)):m0(f)}function ae(f,m){const p=f==="className"?o.rootElement:o.table;if(g)X(p,m);else{let C=[],R=[];T[f]&&(C=Array.isArray(T[f])?T[f]:fC(T[f])),m&&(R=Array.isArray(m)?m:fC(m));const O=dC(C,R),I=dC(R,C);O.length&&He(p,O),I.length&&X(p,I)}T[f]=m}this.init=function(){l.setData(v.data),o.runHooks("beforeInit"),(gi()||d_())&&X(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new fV(this);const f=v.themeName||mR(o.rootContainer);o.useTheme(f),c=kg.getInstance(o,v,H),d=EB(o),h=new LN(o),Go(this)&&mB(o),o.runHooks("init"),this.render(),g&&o.rootElement.offsetParent===null&&rN(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function q(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function ee(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function lt(f,m,p){if(!f.length){p();return}const C=o.getActiveEditor(),R=new q;let O=!0;R.onQueueEmpty=()=>{C&&O&&C.cancelChanges(),p()};for(let I=f.length-1;I>=0;I--){const[D,j]=f[I],V=a.propToCol(j);let A;Number.isInteger(V)?A=o.getCellMeta(D,V):A={...Object.getPrototypeOf(v),...v},o.getCellValidator(A)&&(R.addValidatorToQueue(),o.validateCell(f[I][3],A,function(W,te){return function(oe){if(typeof oe!="boolean")throw new Error("Validation error: result is not boolean");oe===!1&&te.allowInvalid===!1&&(O=!1,f.splice(W,1),te.valid=!0),R.removeValidatorFormQueue()}}(I,A),m))}R.checkIfQueueIsEmpty()}function Ee(f,m){for(let C=f.length-1;C>=0;C--){let R=!1;if(f[C]===null){f.splice(C,1);continue}if(!((f[C][2]===null||f[C][2]===void 0)&&(f[C][3]===null||f[C][3]===void 0))){if(v.allowInsertRow)for(;f[C][0]>o.countRows()-1;){const{delta:O}=a.createRow(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}if(o.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;a.propToCol(f[C][1])>o.countCols()-1;){const{delta:O}=a.createCol(void 0,void 0,{source:"auto"});if(O===0){R=!0;break}}R||a.set(f[C][0],f[C][1],f[C][3])}}if(f.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",f,m),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",f,m||"edit");const C=o.getActiveEditor();C&&fe(C.refreshValue)&&C.refreshValue()}else o.render()}this._createCellCoords=function(f,m){return o.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,p){return o.view._wt.createCellRange(f,m,p)},this.validateCell=function(f,m,p,C){let R=o.getCellValidator(m);function O(I){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(I);return}const j=m.visualCol,V=m.visualRow,A=o.getCell(V,j,!0);if(A&&A.nodeName!=="TH"){const W=o.rowIndexMapper.getRenderableFromVisualIndex(V),te=o.columnIndexMapper.getRenderableFromVisualIndex(j);o.view._wt.getSetting("cellRenderer",W,te,A)}p(I)}cD(R)&&(R=function(I){return function(D,j){j(I.test(D))}}(R)),Pe(R)?(f=o.runHooks("beforeValidate",f,m.visualRow,m.prop,C),o._registerImmediate(()=>{R.call(m,f,I=>{o&&(I=o.runHooks("afterValidate",I,f,m.visualRow,m.prop,C),m.valid=I,O(I),o.runHooks("postAfterValidate",I,f,m.visualRow,m.prop,C))})})):o._registerImmediate(()=>{m.valid=!0,O(m.valid,!1)})};function ye(f,m,p){return Array.isArray(f)?f:[[f,m,p]]}function qe(f,m){const p=o.runHooks("beforeChange",f,m||"edit"),C=f.filter(O=>O!==null);if(p===!1||C.length===0){var R;return(R=o.getActiveEditor())===null||R===void 0||R.cancelChanges(),[]}for(let O=C.length-1;O>=0;O--){const[I,D,,j]=C[O],V=a.propToCol(D);let A;Number.isInteger(V)?A=o.getCellMeta(I,V):A={...Object.getPrototypeOf(v),...v};const{type:W,checkedTemplate:te,uncheckedTemplate:oe}=A;if(W==="numeric"&&typeof j=="string"&&ZN(j)&&(C[O][3]=ee(j)),W==="checkbox"){const Ie=is(j),be=Ie===is(te),re=Ie===is(oe);(be||re)&&(C[O][3]=be?te:oe)}}return C}this.setDataAtCell=function(f,m,p,C){const R=ye(f,m,p),O=[];let I=C,D,j,V;for(D=0,j=R.length;D<j;D++){if(typeof R[D]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[D][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[D][1]>=this.countCols()?V=R[D][1]:V=a.colToProp(R[D][1]),O.push([R[D][0],V,l.getAtCell(this.toPhysicalRow(R[D][0]),R[D][1]),R[D][2]])}!I&&typeof f=="object"&&(I=m);const A=qe(O,I);o.runHooks("afterSetDataAtCell",A,I),lt(A,I,()=>{Ee(A,I)})},this.setDataAtRowProp=function(f,m,p,C){const R=ye(f,m,p),O=[];let I=C,D,j;for(D=0,j=R.length;D<j;D++)O.push([R[D][0],R[D][1],l.getAtCell(this.toPhysicalRow(R[D][0]),R[D][1]),R[D][2]]);!I&&typeof f=="object"&&(I=m);const V=qe(O,C);o.runHooks("afterSetDataAtRowProp",V,I),lt(V,I,()=>{Ee(V,I)})},this.listen=function(){o&&!o.isListening()&&(tg.forEach(f=>{o!==f&&f.unlisten()}),eg=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(eg=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return eg===o.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(f),o.view.render(),m&&H.isSelected()&&c.prepareEditor()},this.populateFromArray=function(f,m,p,C,R,O,I){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const D=typeof C=="number"?o._createCellCoords(C,R):null;return u.populateFromArray(o._createCellCoords(f,m),p,D,O,I)},this.spliceCol=function(f,m,p){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceCol(f,m,p,...R)},this.spliceRow=function(f,m,p){for(var C=arguments.length,R=new Array(C>3?C-3:0),O=3;O<C;O++)R[O-3]=arguments[O];return a.spliceRow(f,m,p,...R)},this.getSelected=function(){if(H.isSelected())return bn(H.getSelectedRange(),f=>{let{from:m,to:p}=f;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(H.isSelected())return Array.from(H.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!H.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];$(H.getSelectedRange(),p=>{if(p.isSingleHeader())return;const C=p.getTopStartCorner(),R=p.getBottomEndCorner();Ye(C.row,R.row,O=>{Ye(C.col,R.col,I=>{this.getCellMeta(O,I).readOnly||m.push([O,I,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=f();return this.resumeExecution(m),p},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!o.view)return;const f=o.view,{width:m,height:p}=f.getLastSize(),{width:C,height:R}=o.rootElement.getBoundingClientRect(),O=C!==m||R!==p;o.runHooks("beforeRefreshDimensions",{width:m,height:p},{width:C,height:R},O)!==!1&&((O||f._wt.wtOverlays.scrollableElement===o.rootWindow)&&(f.setLastSize(C,R),o.render(),f.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:m,height:p},{width:C,height:R},O))},this.updateData=function(f,m){uR(f,p=>{a=p},p=>{a=p,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),H.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:m,metaManager:E,firstRun:g})},this.loadData=function(f,m){uR(f,p=>{a=p},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),H.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:m,metaManager:E,firstRun:g})},this.getInitialColumnCount=function(){const f=v.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Pe(f))if(o.dataType==="array"){const p=this.countSourceCols();for(let C=0;C<p;C+=1)f(C)&&(m+=1)}else(o.dataType==="object"||o.dataType==="function")&&(m=a.colToPropCache.length);else if(fe(v.dataSchema)){const p=a.getSchema();m=Array.isArray(p)?p.length:Xm(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,p,C){return Vt(f)?a.getAll():a.getRange(o._createCellCoords(f,m),o._createCellCoords(p,C),a.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,p,C){return a.getCopyableText(o._createCellCoords(f,m),o._createCellCoords(p,C))},this.getCopyableData=function(f,m){return a.getCopyable(f,a.colToProp(m))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(g?o.loadData:o.updateData).bind(this);let C=!1,R,O;if(fe(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(fe(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(fe(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');f.language&&J(f.language);for(R in f)if(!(R==="data"||R==="language"))if(R==="className")ae("className",f.className);else if(R==="tableClassName"&&o.table)ae("tableClassName",f.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(de.getSingleton().isRegistered(R)||de.getSingleton().isDeprecated(R)){const A=f[R];Pe(A)?(de.getSingleton().addAsFixed(R,A,o),v[R]=A):Array.isArray(A)&&(de.getSingleton().add(R,A,o),v[R]=A)}else!m&&Cn(f,R)&&(T[R]=f[R]);f.data===void 0&&v.data===void 0?p(null,"updateSettings"):f.data!==void 0?p(f.data,"updateSettings"):f.columns!==void 0&&(a.createMap(),o.initIndexMappers());const I=o.countCols(),D=v.columns;if(D&&Pe(D)&&(C=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&E.clearCache(),I>0)for(R=0,O=0;R<I;R++){if(D){const A=C?D(R):D[O];A&&E.updateColumnMeta(O,A)}O+=1}fe(f.cell)&&Oe(f.cell,A=>{o.setCellMetaObject(A.row,A.col,A)}),o.runHooks("afterCellMetaReset");let j=o.rootElement.style.height;j!==""&&(j=parseInt(o.rootElement.style.height,10));let V=f.height;if(Pe(V)&&(V=V()),m&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),V===null){const A=o.rootElement.getAttribute("data-initialstyle");A&&(A.indexOf("height")>-1||A.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",A):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else V!==void 0&&(o.rootElement.style.height=isNaN(V)?`${V}`:`${V}px`,o.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let A=f.width;Pe(A)&&(A=A()),o.rootElement.style.width=isNaN(A)?`${A}`:`${A}px`}if(!m){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const A=o.getCurrentThemeName();Cn(f,"themeName")&&A!==f.themeName&&o.useTheme(f.themeName)}o.runHooks("afterUpdateSettings",f)}u.adjustRowsAndCols(),o.view&&!g&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!m&&o.view&&(j===""||V===""||V===void 0)&&j!==V&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=o.getSelectedLast();if(v.getValue){if(Pe(v.getValue))return v.getValue.call(o);if(f)return o.getData()[f[0][0]][v.getValue]}else if(f)return o.getDataAtCell(f[0],f[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,p,C,R){u.alter(f,m,p,C,R)},this.getCell=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=m,R=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return R===null||C===null||R===void 0||C===void 0?null:o.view.getCellAtCoords(o._createCellCoords(R,C),p)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:p,col:C}=m;let R=p,O=C;return p>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(p)),C>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(C)),o._createCellCoords(R,O)},this.colToProp=function(f){return a.colToProp(f)},this.propToCol=function(f){return a.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return a.get(f,a.colToProp(m))},this.getDataAtRowProp=function(f,m){return a.get(f,m)},this.getDataAtCol=function(f){const m=[],p=a.getRange(o._createCellCoords(0,f),o._createCellCoords(v.data.length-1,f),a.DESTINATION_RENDERER);for(let C=0;C<p.length;C+=1)for(let R=0;R<p[C].length;R+=1)m.push(p[C][R]);return m},this.getDataAtProp=function(f){const m=[],p=a.getRange(o._createCellCoords(0,a.propToCol(f)),o._createCellCoords(v.data.length-1,a.propToCol(f)),a.DESTINATION_RENDERER);for(let C=0;C<p.length;C+=1)for(let R=0;R<p[C].length;R+=1)m.push(p[C][R]);return m},this.getSourceData=function(f,m,p,C){let R;return f===void 0?R=l.getData():R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(p,C)),R},this.getSourceDataArray=function(f,m,p,C){let R;return f===void 0?R=l.getData(!0):R=l.getByRange(o._createCellCoords(f,m),o._createCellCoords(p,C),!0),R},this.getSourceDataAtCol=function(f){return l.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,p,C){const R=ye(f,m,p),O=this.hasHook("afterSetSourceDataAtCell"),I=[];O&&$(R,j=>{let[V,A,W]=j;I.push([V,A,l.getAtCell(V,A),W])}),$(R,j=>{let[V,A,W]=j;l.setAtCell(V,A,W)}),O&&this.runHooks("afterSetSourceDataAtCell",I,C),this.render();const D=o.getActiveEditor();D&&fe(D.refreshValue)&&D.refreshValue()},this.getSourceDataAtRow=function(f){return l.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return l.getAtCell(f,m)},this.getDataAtRow=function(f){return a.getRange(o._createCellCoords(f,0),o._createCellCoords(f,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,p,C){const R=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,p,C],[O,I]=R;let[,,D,j]=R,V=null,A=null;D===void 0&&(D=O),j===void 0&&(j=I);let W="mixed";return Ye(Math.max(Math.min(O,D),0),Math.max(O,D),te=>{let oe=!0;return Ye(Math.max(Math.min(I,j),0),Math.max(I,j),Ie=>(A=this.getCellMeta(te,Ie).type,V?oe=V===A:V=A,oe)),W=oe?A:"mixed",oe}),W},this.removeCellMeta=function(f,m,p){const[C,R]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let O=E.getCellMetaKeyValue(C,R,p);o.runHooks("beforeRemoveCellMeta",f,m,p,O)!==!1&&(E.removeCellMeta(C,R,p),o.runHooks("afterRemoveCellMeta",f,m,p,O)),O=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,C=new Array(p>2?p-2:0),R=2;R<p;R++)C[R-2]=arguments[R];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&E.removeRow(this.toPhysicalRow(f),m),C.length>0&&$(C.reverse(),O=>{E.createRow(this.toPhysicalRow(f)),$(O,(I,D)=>this.setCellMetaObject(f,D,I))}),o.render()},this.setCellMetaObject=function(f,m,p){typeof p=="object"&&Oe(p,(C,R)=>{this.setCellMeta(f,m,R,C)})},this.setCellMeta=function(f,m,p,C){if(o.runHooks("beforeSetCellMeta",f,m,p,C)===!1)return;let O=f,I=m;f<this.countRows()&&(O=this.toPhysicalRow(f)),m<this.countCols()&&(I=this.toPhysicalColumn(m)),E.setCellMeta(O,I,p,C),o.runHooks("afterSetCellMeta",f,m,p,C)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(f,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},C=this.toPhysicalRow(f),R=this.toPhysicalColumn(m);return C===null&&(C=f),R===null&&(R=m),E.getCellMeta(C,R,{visualRow:f,visualColumn:m,...p})},this.getColumnMeta=function(f){return E.getColumnMeta(this.toPhysicalColumn(f))},this.getCellMetaAtRow=function(f){return E.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||v.columns)},this.getCellRenderer=function(f,m){const p=typeof f=="number"?o.getCellMeta(f,m).renderer:f.renderer;return typeof p=="string"?iS(p):Vt(p)?iS("text"):p},this.getCellEditor=function(f,m){const p=typeof f=="number"?o.getCellMeta(f,m).editor:f.editor;return typeof p=="string"?VC(p):Vt(p)?VC("text"):p},this.getCellValidator=function(f,m){const p=typeof f=="number"?o.getCellMeta(f,m).validator:f.validator;return typeof p=="string"?pk(p):p},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,p){const C=new q;f&&(C.onQueueEmpty=f);let R=o.countRows()-1;for(;R>=0;){if(m!==void 0&&m.indexOf(R)===-1){R-=1;continue}let O=o.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}C.addValidatorToQueue(),o.validateCell(o.getDataAtCell(R,O),o.getCellMeta(R,O),I=>{if(typeof I!="boolean")throw new Error("Validation error: result is not boolean");I===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),O-=1}R-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=v.rowHeaders,p=f;return p!==void 0&&(p=o.runHooks("modifyRowHeader",p)),p===void 0?(m=[],Ye(o.countRows()-1,C=>{m.push(o.getRowHeader(C))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:Pe(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(let f=0,m=o.countCols();f<m;f++)if(o.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=o.runHooks("modifyColHeader",f);if(p===void 0){const D=[],j=o.countCols();for(let V=0;V<j;V++)D.push(o.getColHeader(V));return D}let C=v.colHeaders;const R=function(D){const j=[],V=o.countCols();let A=0;for(;A<V;A++)Pe(v.columns)&&v.columns(A)&&j.push(A);return j[D]},O=o.toPhysicalColumn(p),I=R(O);return v.colHeaders===!1?C=null:v.columns&&Pe(v.columns)&&v.columns(I)&&v.columns(I).title?C=v.columns(I).title:v.columns&&v.columns[O]&&v.columns[O].title?C=v.columns[O].title:Array.isArray(v.colHeaders)&&v.colHeaders[O]!==void 0?C=v.colHeaders[O]:Pe(v.colHeaders)?C=v.colHeaders(O):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(C=yV(p)),C=o.runHooks("modifyColumnHeaderValue",C,f,m),C},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=o.getCellMeta(0,f).width),(m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f,m){let p=o._getColWidthFromSettings(f);return p=o.runHooks("modifyColWidth",p,f,m),p===void 0&&(p=op),p},this._getRowHeightFromSettings=function(f){const m=o.stylesHandler.getDefaultRowHeight();let p=v.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[f];break;case"function":p=p(f);break}typeof p=="string"&&(p=parseInt(p,10))}return p!=null&&p<m?m:p},this.getRowHeight=function(f,m){let p=o._getRowHeightFromSettings(f);return p=o.runHooks("modifyRowHeight",p,f,m),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const f=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return rS(o.countRows()-1,p=>{if(o.isEmptyRow(p))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return rS(o.countCols()-1,p=>{if(o.isEmptyCol(p))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return v.isEmptyRow.call(o,f)},this.isEmptyCol=function(f){return v.isEmptyCol.call(o,f)},this.selectCell=function(f,m,p,C){let R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Vt(f)||Vt(m)?!1:this.selectCells([[f,m,p,C]],R,O)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&d.suspend();const C=H.selectCells(f);return C&&p&&o.listen(),d.resume(),C},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return H.selectColumns(f,m,p)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;return H.selectRows(f,m,p)},this.deselectCell=function(){H.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,p=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),H.selectAll(f,m,p)};const $e=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f,m){if(typeof f=="number"){var p;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:C,col:R,considerHiddenIndexes:O}=f??{};let I=C,D=R;if(Pe(m)&&this.addHookOnce("afterScroll",m),O===void 0||O){const W=Number.isInteger(C)&&C>=0,te=Number.isInteger(R)&&R>=0,oe=W?$e(this.rowIndexMapper,C):void 0,Ie=te?$e(this.columnIndexMapper,R):void 0;if(oe===null||Ie===null)return!1;I=W?o.rowIndexMapper.getRenderableFromVisualIndex(oe):C,D=te?o.columnIndexMapper.getRenderableFromVisualIndex(Ie):R}const j=Number.isInteger(I),V=Number.isInteger(D);let A=!1;return j&&I>=0&&V&&D>=0?A=o.view.scrollViewport(o._createCellCoords(I,D),f.horizontalSnap,f.verticalSnap):j&&I>=0&&(V&&D<0||!V)?A=o.view.scrollViewportVertically(I,f.verticalSnap):V&&D>=0&&(j&&I<0||!j)&&(A=o.view.scrollViewportHorizontally(D,f.horizontalSnap)),Pe(m)&&(A?this.view.render():(this.removeHook("afterScroll",m),this._registerMicrotask(()=>m()))),A},this.scrollToFocusedCell=function(f){if(!this.selection.isSelected())return!1;Pe(f)&&this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast(),p=this.scrollViewportTo(m.toObject());return p?this.view.render():Pe(f)&&(this.removeHook("afterScroll",f),this._registerMicrotask(()=>f())),p},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),M.clear(),E.clearCache(),tg.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&cs(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),_.getItems().forEach(f=>{let[,m]=f;m.destroy()}),_.clear(),o.runHooks("afterDestroy")},!0),de.getSingleton().destroy(o),Oe(o,(f,m,p)=>{Pe(f)?p[m]=Me(m):m!=="guid"&&(p[m]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,H=null,c=null,o=null};function Me(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(f){return _.getItem(Qu(f))},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:_.getId(f)},this.getInstance=function(){return o},this.addHook=function(f,m,p){de.getSingleton().add(f,m,o,p)},this.hasHook=function(f){return de.getSingleton().has(f,o)||de.getSingleton().has(f)},this.addHookOnce=function(f,m,p){de.getSingleton().once(f,m,o,p)},this.removeHook=function(f,m){de.getSingleton().remove(f,m,o)},this.runHooks=function(f,m,p,C,R,O,I){return de.getSingleton().run(o,f,m,p,C,R,O,I)},this.getTranslatedPhrase=function(f,m){return CO(v.language,f,m)},this.toHTML=()=>eS(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",eS(this)),f.firstElementChild},this.timeouts=[],this.useTheme=f=>{const m=!!g;this.stylesHandler.useTheme(f);const p=this.stylesHandler.getThemeName();Go(this)&&(He(this.rootWrapperElement,/ht-theme-.*/g),He(this.rootPortalElement,/ht-theme-.*/g),p&&(X(this.rootWrapperElement,p),X(this.rootPortalElement,p),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Sn(`The "${p}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),m||(o.render(),o.scrollViewportTo(0,0),mR(this.rootContainer)&&(He(this.rootContainer,/ht-theme-.*/g),p&&X(this.rootContainer,p))),this.runHooks("afterSetTheme",p,m)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=f;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){$(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){$(this.immediates,f=>{clearImmediate(f)})},this._registerMicrotask=function(f){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||f()})},this._getEditorManager=function(){return c};const yr=PB({handleEvent(){return o.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&yr.releasePressedKeys()}),this.getShortcutManager=function(){return yr},this.getFocusManager=function(){return h},k_().forEach(f=>{const m=ip(f);_.addItem(f,new m(this))}),fB(o),yr.setActiveContextName("grid"),de.getSingleton().run(o,"construct")}function SR(t,e,r){t.addEventListener(e,r,!1)}function RR(t,e,r){t.removeEventListener(e,r,!1)}function Vl(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function VB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},n=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=r.textContent(s),o.style.position="absolute",o.style.fontSize=Vl(s).fontSize,o.style.fontFamily=Vl(s).fontFamily,o.style.whiteSpace="pre",n.appendChild(o);const g=parseInt(((h=Vl(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),w=parseInt(((d=Vl(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),y=o.clientWidth+g+w+1;n.removeChild(o);const b=s.style;b.height=`${r.minHeight}px`,r.minWidth>y?b.width=`${r.minWidth}px`:y>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${y}px`;const E=s.scrollHeight?s.scrollHeight-1:0;r.minHeight>E?b.height=`${r.minHeight}px`:r.maxHeight<E?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")r.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(r.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")r.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(r.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")r.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(r.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")r.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(r.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${r.minHeight}px`,s.style.minWidth=`${r.minWidth}px`,s.style.maxWidth=`${r.maxWidth}px`,s.style.overflowY="hidden"),g&&(SR(s,"input",a),SR(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){RR(s,"input",a),RR(s,"keydown",l)}}}function ER(t,e){const r=ZD(e),n=e.value.split(`
`);let i=r,o=0;for(let s=0;s<n.length;s++){const a=n[s];s!==0&&(o+=n[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),r<=l)break}C_(e,i)}function Wi(t,e,r){return(e=WB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WB(t){var e=$B(t,"string");return typeof e=="symbol"?e:e+""}function $B(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BB="ht_editor_visible",Wl="ht_editor_hidden",TR="textEditor",jB="text";class zB extends Xp{static get EDITOR_TYPE(){return jB}constructor(e){super(e),Wi(this,"eventManager",new Ci(this)),Wi(this,"autoResize",VB(this.hot.rootDocument)),Wi(this,"TEXTAREA",void 0),Wi(this,"textareaStyle",void 0),Wi(this,"TEXTAREA_PARENT",void 0),Wi(this,"textareaParentStyle",void 0),Wi(this,"layerClass",void 0),this.eventManager=new Ci(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),iu(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,o,s){const a=this.state;if(super.prepare(e,r,n,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==ot.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===ot.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),C_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),_e(this.TEXTAREA,[["data-hot-input",""],bo(-1)]),X(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),X(this.TEXTAREA_PARENT,"handsontableInputHolder"),ve(this.TEXTAREA_PARENT,this.layerClass)&&He(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Wl),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){BD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",He(this.TEXTAREA_PARENT,this.layerClass),X(this.TEXTAREA_PARENT,Wl)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ye(e.length-1,n=>{const i=e[n];if(ve(i,"handsontableEditor"))return r=!0,!1}),ve(this.TEXTAREA_PARENT,Wl)&&He(this.TEXTAREA_PARENT,Wl),r?(this.layerClass=BB,X(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),X(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==ot.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){h_()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===ot.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===ot.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>fe(this.hot.getSelected()),group:TR},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;ER(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;ER(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TR)}}const UB="base",YB="htTextEllipsis";function WO(t,e,r,n,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&X(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(vC())):a&&c.push(vC()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(yC())):(u.push(s.invalidCellClassName),a&&c.push(yC()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(YB),He(e,u),X(e,l),Qa(e,c),_e(e,h)}WO.RENDERER_TYPE=UB;const qB="text";function $O(t,e,r,n,i,o,s){WO.apply(this,[t,e,r,n,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=is(a),s.trimWhitespace&&(a=a.trim()),Ja(e,a)}$O.RENDERER_TYPE=qB;const GB="text",KB={CELL_TYPE:GB,editor:zB,renderer:$O};WW(KB);on.editors={BaseEditor:Xp};function on(t,e){const r=new VO(t,e||{},bp);return r.init(),r}on.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new VO(t,e,bp)};on.DefaultSettings=MO();on.hooks=de.getSingleton();on.CellCoords=io;on.CellRange=el;on.packageName="handsontable";on.buildDate="10/07/2025 10:59:01";on.version="16.0.1";on.languages={dictionaryKeys:eW,getLanguageDictionary:bO,getLanguagesDictionaries:oW,registerLanguageDictionary:yO,getTranslatedPhrase:CO};function XB(t,e){BO(t,e),e.add(t)}function ZB(t,e,r){BO(t,e),e.set(t,r)}function BO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ko(t,e,r){return(e=QB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QB(t){var e=JB(t,"string");return typeof e=="symbol"?e:e+""}function JB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lo(t,e){return t.get(jO(t,e))}function jO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _R=new Map([["plugin",lk],["cell-type",OO],["editor",I_],["renderer",L_],["validator",F_]]),ej=Symbol("mainSetting"),tj="base",$l=[];let $i=null;var Bi=new WeakMap,OR=new WeakSet;class hc{static get PLUGIN_KEY(){return tj}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){XB(this,OR),ko(this,"eventManager",new Ci(this)),ko(this,"pluginName",null),ko(this,"pluginsInitializedCallbacks",[]),ko(this,"isPluginsReady",!1),ko(this,"enabled",!1),ko(this,"initialized",!1),ZB(this,Bi,{}),Xn(this,"hot",e,{writable:!1}),$i=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(o=>{const[s,a]=o.split(":");if(!_R.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);_R.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");$l.push(o)}}if($i||($i=k_()),$i.indexOf(this.pluginName)>=0&&$i.splice($i.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),$i.length===0){if($l.length>0){const i=[`${$l.join(`
`)}
`,"You have to import and register them manually."].join("");throw $l.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||Ct(r))&&n[ej]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(Ct(r)){var o;return(o=r[e])!==null&&o!==void 0?o:n[e]}return n[e]}addHook(e,r,n){Lo(Bi,this)[e]=Lo(Bi,this)[e]||[];const i=Lo(Bi,this)[e];this.hot.addHook(e,r,n),i.push(r),Lo(Bi,this)[e]=i}removeHooks(e){$(Lo(Bi,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Lo(Bi,this);Oe(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){$(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=jO(OR,this,rj).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Oe(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function rj(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function ji(t,e,r){return(e=nj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nj(t){var e=ij(t,"string");return typeof e=="symbol"?e:e+""}function ij(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oj{constructor(e){ji(this,"hot",null),ji(this,"container",null),ji(this,"injected",!1),ji(this,"rows",[]),ji(this,"columns",[]),ji(this,"samples",null),ji(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&X(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),$(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),$(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{$(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(o=>{$(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{$(i.strings,o=>{const s=o.col,a=e.createElement("th");n.push([s,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),$(n,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{$(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return n.style.width=`${o}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),o=r.createElement("thead"),s=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),X(i,e),n.appendChild(i),{fragment:n,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return X(i,o),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function Bl(t,e,r){return(e=sj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sj(t){var e=aj(t,"string");return typeof e=="symbol"?e:e+""}function aj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qp{static get SAMPLE_COUNT(){return 3}constructor(e){Bl(this,"samples",null),Bl(this,"dataFactory",null),Bl(this,"customSampleCount",null),Bl(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Qp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:o,to:s}=typeof n=="number"?{from:n,to:n}:n;return Ye(o,s,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ye(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ct(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${is(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}function lj(t,e){zO(t,e),e.add(t)}function rg(t,e,r){zO(t,e),e.set(t,r)}function zO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ta(t,e,r){return(e=uj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uj(t){var e=cj(t,"string");return typeof e=="symbol"?e:e+""}function cj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mi(t,e){return t.get(Qt(t,e))}function xu(t,e,r){return t.set(Qt(t,e),r),r}function Qt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("modifyAutoColumnSizeSeed");const ng="autoColumnSize",hj=10,dj="autoColumnSize";var Jp=new WeakMap,Ko=new WeakMap,ds=new WeakMap,cr=new WeakSet;class Ta extends hc{static get PLUGIN_KEY(){return ng}static get PLUGIN_PRIORITY(){return hj}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),lj(this,cr),ta(this,"ghostTable",new oj(this.hot)),ta(this,"samplesGenerator",new Qp((r,n)=>{const i=this.hot.toPhysicalRow(r),o=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(r,n);let a="";s.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ta(this,"inProgress",!1),ta(this,"measuredColumns",0),ta(this,"columnWidthsMap",new oc),rg(this,Jp,!1),rg(this,Ko,[]),rg(this,ds,[]),this.hot.columnIndexMapper.registerMap(dj,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>Qt(cr,this,MR).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[ng]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Qt(cr,e,mj).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Qt(cr,e,pj).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return Qt(cr,e,vj).call(e,...i)}),this.addHook("beforeRender",()=>Qt(cr,this,gj).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>Qt(cr,this,wj).call(this)),super.enablePlugin()}updatePlugin(){xu(ds,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>Qt(cr,this,MR).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof r=="number"?{from:r,to:r}:r;Ye(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Qt(cr,this,UO).call(this,s,o)}),this.ghostTable.columns.length&&(Qt(cr,this,YO).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){RC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ta.CALCULATION_STEP,i)},e,r),n=n+Ta.CALCULATION_STEP+1,n<i?o=Hg(s):(RC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ng];let r=Ta.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Ct(e)&&(r=e.syncLimit,mD(r)?r=QN(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,op))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,o)=>{const s=mi(Ko,this).length;return(s-1<o||mi(Ko,this)[o]!==i)&&n.push(this.hot.toVisualColumn(o)),s-1<o?mi(Ko,this).push(i):mi(Ko,this)[o]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fj(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||Qt(cr,this,UO).call(this,r,e))}),this.ghostTable.columns.length&&(Qt(cr,this,YO).call(this),this.ghostTable.clean())}function UO(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function YO(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function gj(){this.calculateVisibleColumnsWidth(),this.inProgress||(Qt(cr,this,fj).call(this,mi(ds,this)),xu(ds,this,[]))}function mj(t,e){e||this.recalculateAllColumnsWidth()}function pj(t){const e=t.reduce((r,n)=>{let[,i]=n;const o=this.hot.propToCol(i);return Number.isInteger(o)&&r.indexOf(o)===-1&&r.push(o),r},[]);mi(ds,this).push(...e)}function MR(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function wj(){xu(Ko,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),xu(Jp,this,!0)}function vj(t){if(!mi(Jp,this))return;const e=t.reduce((r,n)=>{var i;const o=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);r.indexOf(s)===-1&&r.push(s)}return r},[]);mi(ds,this).push(...e)}function yj(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function bj(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function zi(t,e){const r={};return $(t,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&(r[i]||(r[i]=[]),r[i][o]=e(i,o))})}),r}function ai(t,e,r,n,i){$(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Cj(s,a,e,r,n,i)})})}function Cj(t,e,r,n,i,o){const s=i(t,e);let a=n;s.className&&(r==="vertical"?a=yj(s.className,n):a=bj(s.className,n)),o(t,e,"className",a)}function Sj(t){return`<span class="selected">✓</span>${t}`}function ig(t,e){let r=!1;return Array.isArray(t)&&$(t,n=>(n.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return r=!0,!1}),r)),r}function qO(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:o}=n.getBoundingClientRect();r.top=i,r.left=o}return r}const bt="---------";function Rj(){return{name:bt}}const Kr="alignment";function Ej(){return{key:Kr,name(){return this.getTranslatedPhrase(Lp)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Kr}:left`,name(){return this.getTranslatedPhrase(Fp)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:center`,name(){return this.getTranslatedPhrase(Vp)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:right`,name(){return this.getTranslatedPhrase(Wp)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:justify`,name(){return this.getTranslatedPhrase($p)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:bt},{key:`${Kr}:top`,name(){return this.getTranslatedPhrase(Bp)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:middle`,name(){return this.getTranslatedPhrase(jp)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Kr}:bottom`,name(){return this.getTranslatedPhrase(zp)},callback(){const t=this.getSelectedRange(),e=zi(t,(i,o)=>this.getCellMeta(i,o).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),ai(t,r,n,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const ew="clear_column";function Tj(){return{key:ew,name(){return this.getTranslatedPhrase(xp)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const dc="col_left";function _j(){return{key:dc,name(){return this.getTranslatedPhrase(Tp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const fc="col_right";function Oj(){return{key:fc,name(){return this.getTranslatedPhrase(_p)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const gc="make_read_only";function Mj(){return{key:gc,checkable:!0,ariaChecked(){return ig(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(Mu)},name(){let t=this.getTranslatedPhrase(Mu);return ig(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Sj(t)),t},callback(){const t=this.getSelectedRange(),e=ig(t,(r,n)=>this.getCellMeta(r,n).readOnly);$(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const mc="redo";function Ij(){return{key:mc,name(){return this.getTranslatedPhrase(Pp)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const pc="remove_col";function Pj(){return{key:pc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Mp,e)},callback(){this.alter("remove_col",MW(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const wc="remove_row";function xj(){return{key:wc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Op,e)},callback(){this.alter("remove_row",IW(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const vc="row_above";function Hj(){return{key:vc,name(){return this.getTranslatedPhrase(Rp)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const yc="row_below";function Aj(){return{key:yc,name(){return this.getTranslatedPhrase(Ep)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const ka="no_items";function Dj(){return{key:ka,name(){return this.getTranslatedPhrase(Sp)},disabled:!0,isCommand:!1}}const bc="undo";function Nj(){return{key:bc,name(){return this.getTranslatedPhrase(Ip)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const kj=[vc,yc,dc,fc,ew,wc,pc,bc,mc,gc,Kr,bt,ka],Lj={[bt]:Rj,[ka]:Dj,[vc]:Hj,[yc]:Aj,[dc]:_j,[fc]:Oj,[ew]:Tj,[wc]:xj,[pc]:Pj,[bc]:Nj,[mc]:Ij,[gc]:Mj,[Kr]:Ej};function GO(){const t={};return Oe(Lj,(e,r)=>{t[r]=e()}),t}function og(t,e,r){return(e=Fj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fj(t){var e=Vj(t,"string");return typeof e=="symbol"?e:e+""}function Vj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wj{constructor(e){og(this,"hot",void 0),og(this,"commands",{}),og(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=$j(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Cn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(o.join(":")),$(u,c=>c.apply(this.hot,n))}}function $j(t,e){let r;return $(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function sg(t,e,r){return(e=Bj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bj(t){var e=jj(t,"string");return typeof e=="symbol"?e:e+""}function jj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zj{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;sg(this,"hot",void 0),sg(this,"predefinedItems",GO()),sg(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Oe(e,(n,i)=>{let o="";n.name===bt?(r[bt]=n,o=bt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,o=n.key):(r[n.key]=n,o=n.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Uj(e,this.defaultOrderPattern,this.predefinedItems)}}function Uj(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ct(i)?Oe(i,(o,s)=>{let a=r[typeof o=="string"?o:s];a||(a=o),Ct(o)?bi(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),n.push(a)}):$(i,(o,s)=>{let a=r[o];!a&&kj.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ct(o)&&bi(a,o),a.key===void 0&&(a.key=s),n.push(a))}),n}function ri(t,e,r){return(e=Yj(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yj(t){var e=qj(t,"string");return typeof e=="symbol"?e:e+""}function qj(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gj{constructor(e,r){ri(this,"top",void 0),ri(this,"topRelative",void 0),ri(this,"left",void 0),ri(this,"leftRelative",void 0),ri(this,"scrollTop",void 0),ri(this,"scrollLeft",void 0),ri(this,"cellHeight",void 0),ri(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let o,s,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=n,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-n,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ra(t,e,r){Kj(t,e),e.set(t,r)}function Kj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e){return t.get(KO(t,e))}function jl(t,e,r){return t.set(KO(t,e),r),r}function KO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nt=new WeakMap,qt=new WeakMap,Gt=new WeakMap,ag=new WeakMap,Fo=new WeakMap;class Xj{constructor(e){ra(this,Nt,void 0),ra(this,qt,void 0),ra(this,Gt,void 0),ra(this,ag,!1),ra(this,Fo,{above:0,below:0,left:0,right:0}),jl(ag,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ie(Fo,this)[e]=r,this}setElement(e){return jl(Nt,this,e),this}setParentElement(e){return jl(qt,this,e),this}updatePosition(e){jl(Gt,this,new Gj(e,ie(Nt,this).ownerDocument.defaultView)),ie(ag,this)?(ie(Gt,this).fitsBelow(ie(Nt,this))?this.setPositionBelowCursor():ie(Gt,this).fitsAbove(ie(Nt,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){ie(Nt,this).dir==="rtl"?ie(Gt,this).fitsOnLeft(ie(Nt,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():ie(Gt,this).fitsOnRight(ie(Nt,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=ie(Fo,this).above+ie(Gt,this).top-ie(Nt,this).offsetHeight;if(ie(qt,this)){const n=ie(qt,this).ownerDocument.defaultView.getComputedStyle(ie(qt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Gt,this).top+ie(Gt,this).cellHeight-ie(Nt,this).scrollHeight+i+o}ie(Nt,this).style.top=`${e}px`}setPositionBelowCursor(){let e=ie(Fo,this).below+ie(Gt,this).top+1;if(ie(qt,this)){const n=ie(qt,this).ownerDocument.defaultView.getComputedStyle(ie(qt,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),o=Number.parseInt(n.borderTop,10);e=ie(Gt,this).top-i-o-1}ie(Nt,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=ie(Gt,this).left;if(ie(qt,this)){const r=ie(qt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(qt,this).querySelector(".htCore")).borderRightWidth,10);e+=ie(Gt,this).cellWidth+n}else e+=ie(Fo,this).right;ie(Nt,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=ie(Fo,this).left+ie(Gt,this).left-ie(Nt,this).offsetWidth;if(ie(qt,this)){const r=ie(qt,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(ie(qt,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}ie(Nt,this).style.left=`${e}px`}}function Zj(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=De(e,-1,y()-1);function a(E,v){const T=y()-1;return E<0&&(E=T),E>T&&(E=0),o.has(E)?-1:(o.add(E),n(E,!1)===!1&&(E=a(v===1?++E:--E,v)),E)}function l(E){E>-1&&E<y()&&n(E,!0)!==!1&&(s=E)}function u(E){E>-1&&E<y()&&(s=E)}function c(){return s}function h(){y()>0&&(o.clear(),s=a(0,1))}function d(){y()>0&&(o.clear(),s=a(y()-1,-1))}function g(){y()>0&&(o.clear(),s=a(++s,1))}function w(){y()>0&&(o.clear(),s=a(--s,-1))}function y(){return Math.max(r(),0)}function b(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:g,toPreviousItem:w,getSize:y,clear:b}}function Qj(t){return bn(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Gg(t){return Cn(t,"submenu")}function Kg(t){return new RegExp(bt,"i").test(t.name)}function lu(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function IR(t){return Cn(t,"disableSelection")}function Jj(t){return ve(t,"htSeparator")}function ez(t){return ve(t,"htSubmenu")}function tz(t){return ve(t,"htDisabled")}function rz(t){return ve(t,"htSelectionDisabled")}function nz(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function XO(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function iz(t,e){let r=t.slice(0);return r.reverse(),r=XO(r,e),r.reverse(),r}function oz(t){const e=[];return $(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function sz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bt,r=t.slice(0);return r=XO(r,e),r=iz(r,e),r=oz(r),r}function az(t){return t.checkable===!0}function lz(t){return Zj({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||Jj(n)||tz(n)||rz(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function uz(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(n):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const ZO="menu",PR=ZO;function cz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(uz(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:ZO})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(w=>h.removeShortcutsByKeys(w))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function o(){return[...r]}function s(u){return u?`${PR}:${u}`:PR}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function hz(t){return(e,r,n,i,o,s)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(cs(r),X(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!lu(a,t)&&!IR(a)&&!Kg(a);_e(r,[...az(a)?[ED(),Cu(c),PD(h)]:[RD(),Cu(u)],...d?[bo(-1)]:[],...lu(a,t)?[MD()]:[],...Gg(a)?[nu(!1)]:[]])}r.className="",r.appendChild(l),Kg(a)?X(r,"htSeparator"):typeof a.renderer=="function"?(X(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,o,u))):w_(l,u),lu(a,t)?X(r,"htDisabled"):IR(a)?X(r,"htSelectionDisabled"):Gg(a)&&X(r,"htSubmenu")}}function lg(t,e,r){dz(t,e),e.set(t,r)}function dz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fn(t,e,r){return(e=fz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fz(t){var e=gz(t,"string");return typeof e=="symbol"?e:e+""}function gz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ug(t,e,r){return t.set(QO(t,e),r),r}function ni(t,e){return t.get(QO(t,e))}function QO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const xR=215;var Vo=new WeakMap,zl=new WeakMap,Ul=new WeakMap;class Cc{get tableBorderWidth(){return ni(Ul,this)===void 0&&this.hotMenu&&ug(Ul,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ni(Ul,this)}constructor(e,r){var n=this;fn(this,"hot",void 0),fn(this,"options",void 0),fn(this,"eventManager",new Ci(this)),fn(this,"container",void 0),fn(this,"positioner",void 0),fn(this,"hotMenu",null),fn(this,"hotSubMenus",{}),fn(this,"parentMenu",void 0),fn(this,"menuItems",null),fn(this,"origOutsideClickDeselects",null),lg(this,Vo,void 0),lg(this,zl,void 0),lg(this,Ul,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:xR,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Xj(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(He(this.options.container,/ht-theme-.*/g),X(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Aa(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ni(Vo,this)}getKeyboardShortcutsCtrl(){return ni(zl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=T_(a=>this.openSubMenu(a),300),r=this.options.minWidth||xR;let n=!1,i=Gm(this.menuItems,a=>(a.key===ka&&(n=!0),nz(a,this.hot)));if(i.length<1&&!n)i.push(GO()[ka]);else if(i.length===0)return;i=sz(i,bt);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return fe(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:hz(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ni(Vo,this).setCurrentPage(l.row):ni(Vo,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Ag()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Ag()||!Eu(a))&&o&&this.hasSelectedItem()&&(gi()||d_()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),ug(Vo,this,lz(this.hotMenu)),ug(zl,this,cz(this)),ni(zl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ni(Vo,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);_e(n,[nu(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!ez(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Cc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&_e(r,[nu(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&_e(i,[nu(!1)])}}closeAllSubMenus(){$(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?Qj(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Kg(e)||lu(e,this.hot)||Gg(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,o=parseInt(n.width,10),s=yo(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?nr(this.hotMenu.getCell(u,0)):0;return a+(l.name===bt?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Pe(n)&&(n=n.call(this.hot),n===null||Vt(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),X(i,`htMenu handsontable ${this.options.className}`),n&&X(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&_e(this.hotMenu.rootElement,[SD(),bo(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!os(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!os(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ve(e.target,"htCore")&&os(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Xe(Cc,_n);function mz(t,e){pz(t,e),e.add(t)}function pz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,r){return(e=wz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wz(t){var e=vz(t,"string");return typeof e=="symbol"?e:e+""}function vz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ga="contextMenu",yz=70,HR=ga;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");var na=new WeakSet;class Sc extends hc{constructor(){super(...arguments),mz(this,na),cg(this,"commandExecutor",new Wj(this.hot)),cg(this,"itemsFactory",null),cg(this,"menu",null)}static get PLUGIN_KEY(){return ga}static get PLUGIN_PRIORITY(){return yz}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[vc,yc,bt,dc,fc,bt,wc,pc,bt,bc,mc,bt,gc,bt,Kr]}isEnabled(){return!!this.hot.getSettings()[ga]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[ga];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Cc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Yl(na,this,Cz).call(this)),this.menu.addLocalHook("afterOpen",()=>Yl(na,this,Sz).call(this)),this.menu.addLocalHook("afterClose",()=>Yl(na,this,Rz).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Yl(na,this,bz).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=qO(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:HR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HR)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Oe(n,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new zj(this.hot,Sc.DEFAULT_ITEMS);const e=this.hot.getSettings()[ga],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),$(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function bz(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ve(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(o)&&!(ve(o,"current")&&ve(o,"wtBorder"))))return;const s=qO(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Cz(){this.hot.runHooks("beforeContextMenuShow",this)}function Sz(){this.hot.runHooks("afterContextMenuShow",this)}function Rz(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Sc.SEPARATOR={name:bt};function Ez(t){return{key:"copy",name(){return this.getTranslatedPhrase(Hp)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Tz(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Np,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function _z(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Dp,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Oz(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?De(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Ap,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Mz(t){return{key:"cut",name(){return this.getTranslatedPhrase(kp)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class Iz{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class Pz{constructor(){this.clipboardData=new Iz}preventDefault(){}composedPath(){return[]}}function xz(t,e){JO(t,e),e.add(t)}function Wo(t,e,r){JO(t,e),e.set(t,r)}function JO(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(Qo(t,e))}function $o(t,e,r){return t.set(Qo(t,e),r),r}function Qo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ii=new WeakMap,hg=new WeakMap,ia=new WeakMap,Xg=new WeakMap,Zg=new WeakMap,oa=new WeakMap,sa=new WeakSet;class Hz{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;xz(this,sa),Wo(this,ii,void 0),Wo(this,hg,void 0),Wo(this,ia,void 0),Wo(this,Xg,void 0),Wo(this,Zg,void 0),Wo(this,oa,void 0),$o(hg,this,r),$o(ia,this,n),$o(Xg,this,i),$o(Zg,this,o),$o(oa,this,s)}setSelectedRange(e){$o(ii,this,e)}getCellsRange(){if(kt(hg,this).call(this)===0||kt(ia,this).call(this)===0)return null;const{row:e,col:r}=kt(ii,this).getTopStartCorner(),{row:n,col:i}=kt(ii,this).getBottomEndCorner(),o=Qo(sa,this,Az).call(this,e,n),s=Qo(sa,this,dg).call(this,r,i);return{isRangeTrimmed:n!==o||i!==s,startRow:e,startCol:r,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(kt(ia,this).call(this)===0||kt(oa,this).call(this)===0)return null;const{col:e}=kt(ii,this).getTopStartCorner(),{col:r}=kt(ii,this).getBottomEndCorner(),n=Qo(sa,this,dg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(kt(ia,this).call(this)===0||kt(oa,this).call(this)===0)return null;const{col:e}=kt(ii,this).getTopStartCorner(),{col:r}=kt(ii,this).getBottomEndCorner(),n=Qo(sa,this,dg).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-kt(oa,this).call(this),startCol:e,endRow:-1,endCol:n}}}function dg(t,e){return Math.min(e,Math.max(t+kt(Zg,this).call(this)-1,t))}function Az(t,e){return Math.min(e,Math.max(t+kt(Xg,this).call(this)-1,t))}function eM(t){const e=[],r=[];return $(t,n=>{const i=Math.min(n.startRow,n.endRow),o=Math.max(n.startRow,n.endRow);Ye(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Ye(s,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function Dz(t,e){tM(t,e),e.add(t)}function oi(t,e,r){tM(t,e),e.set(t,r)}function tM(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aa(t,e,r){return(e=Nz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nz(t){var e=kz(t,"string");return typeof e=="symbol"?e:e+""}function kz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zt(t,e){return t.get(Jt(t,e))}function qr(t,e,r){return t.set(Jt(t,e),r),r}function Jt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const fg="copyPaste",Lz=80,Fz=["fragmentSelection"],AR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Qg=new WeakMap,Jg=new WeakMap,em=new WeakMap,Bo=new WeakMap,ql=new WeakMap,Gl=new WeakMap,jo=new WeakMap,Hu=new WeakMap,hr=new WeakSet;class Vz extends hc{constructor(){super(...arguments),Dz(this,hr),aa(this,"columnsLimit",1/0),aa(this,"rowsLimit",1/0),aa(this,"pasteMode","overwrite"),aa(this,"uiContainer",this.hot.rootDocument.body),oi(this,Qg,!1),oi(this,Jg,!1),oi(this,em,!1),oi(this,Bo,"cells-only"),oi(this,ql,!1),oi(this,Gl,!1),oi(this,jo,new Hz({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oi(this,Hu,!1),aa(this,"copyableRanges",[])}static get PLUGIN_KEY(){return fg}static get SETTING_KEYS(){return[fg,...Fz]}static get PLUGIN_PRIORITY(){return Lz}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[fg]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),qr(Qg,this,this.getSetting("copyColumnHeaders")),qr(Jg,this,this.getSetting("copyColumnGroupHeaders")),qr(em,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>Jt(hr,this,Bz).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jt(hr,n,jz).call(n,...o)}),this.addHook("afterSelectionEnd",()=>Jt(hr,this,zz).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Zm()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jt(hr,n,Uz).call(n,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Jt(hr,n,Yz).call(n,...o)}),this.addHook("afterSelection",()=>Jt(hr,this,qz).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";qr(Bo,this,e),qr(ql,this,!0),Jt(hr,this,DR).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){qr(Gl,this,!0),Jt(hr,this,DR).call(this,"cut")}getRangedCopyableData(e){return Ra(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=eM(e);return $(n,o=>{const s=[];$(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),r.push(s)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new Pz;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Zt(jo,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Zt(Bo,this)==="column-headers-only"?r.set("headers",Zt(jo,this).getMostBottomColumnHeadersRange()):(Zt(Bo,this)==="with-column-headers"?r.set("headers",Zt(jo,this).getMostBottomColumnHeadersRange()):Zt(Bo,this)==="with-column-group-headers"&&r.set("headers",Zt(jo,this).getAllColumnHeadersRange()),r.set("cells",Zt(jo,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=n;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,o=[],{row:s,col:a}=r.getTopStartCorner(),{row:l,col:u}=r.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<n||c<=l;){const{skipRowOnPaste:w,visualRow:y}=this.hot.getCellMeta(c,a);if(c=y+1,w===!0)continue;d=y,h=a;const b=[],E=o.length%n;for(;b.length<i||h<=u;){const{skipColumnOnPaste:v,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,v===!0)continue;g=T;const _=b.length%i;b.push(e[E][_])}o.push(b)}return qr(Hu,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Zt(ql,this)||this.isEditorOpened()||eo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!iu(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),qr(ql,this,!1);const o=this.getRangedData(this.copyableRanges),s=Jt(hr,this,Wz).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Ra(o);if(e&&e.clipboardData){const u=tS(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[AR,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}qr(Bo,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Zt(Gl,this)||this.isEditorOpened()||eo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!iu(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),qr(Gl,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Ra(o);if(e&&e.clipboardData){const l=tS(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[AR,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||eo(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!iu(r,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=n_(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=XN(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=DW(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function DR(t){if(Zm()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&nN(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Wz(t){const{rows:e}=eM(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function $z(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&R_(n)}}}function rM(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&E_(n)}}}function Bz(t){t.items.push({name:"---------"},Ez(this)),Zt(Qg,this)&&t.items.push(Oz(this)),Zt(Jg,this)&&t.items.push(_z(this)),Zt(em,this)&&t.items.push(Tz(this)),t.items.push(Mz(this))}function jz(t,e,r,n,i){Zt(Hu,this)&&(i.value=!0),qr(Hu,this,!1)}function zz(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Uz(){Jt(hr,this,rM).call(this)}function Yz(){Jt(hr,this,$z).call(this)}function qz(){Jt(hr,this,rM).call(this)}function Gz(t,e,r){const n=Array.from(Array(r).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function Kz(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function Xz(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function nM(t,e,r){const n=Kz(t,Gz(t,e,r));return Xz(n)}function Zz(t,e,r){return(e=Qz(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qz(t){var e=Jz(t,"string");return typeof e=="symbol"?e:e+""}function Jz(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wr{constructor(e){Zz(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Kl(t,e,r){return(e=eU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eU(t){var e=tU(t,"string");return typeof e=="symbol"?e:e+""}function tU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tw extends Wr{constructor(e){let{stateBefore:r,range:n,type:i,alignment:o}=e;super("cell_alignment"),Kl(this,"stateBefore",void 0),Kl(this,"range",void 0),Kl(this,"type",void 0),Kl(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=o}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,o,s)=>{r.done(()=>new tw({stateBefore:n,range:i,type:o,alignment:s}))})}undo(e,r){$(this.range,n=>{n.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){ai(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,o,s)=>e.setCellMeta(n,i,o,s)),e.addHookOnce("afterViewRender",r),e.render()}}function NR(t,e,r){return(e=rU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rU(t){var e=nU(t,"string");return typeof e=="symbol"?e:e+""}function nU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rw extends Wr{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),NR(this,"columns",void 0),NR(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new rw({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),nM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function kR(t,e,r){return(e=iU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iU(t){var e=oU(t,"string");return typeof e=="symbol"?e:e+""}function oU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nw extends Wr{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),kR(this,"previousSortState",void 0),kR(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,o)=>{o&&r.done(()=>new nw({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:n;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function LR(t,e,r){return(e=sU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sU(t){var e=aU(t,"string");return typeof e=="symbol"?e:e+""}function aU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iw extends Wr{constructor(e){let{index:r,amount:n}=e;super("insert_col"),LR(this,"index",void 0),LR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,o)=>{r.done(()=>new iw({index:n,amount:i}),o)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function FR(t,e,r){return(e=lU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lU(t){var e=uU(t,"string");return typeof e=="symbol"?e:e+""}function uU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ow extends Wr{constructor(e){let{index:r,amount:n}=e;super("insert_row"),FR(this,"index",void 0),FR(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,o)=>{r.done(()=>new ow({index:n,amount:i}),o)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Xl(t,e,r){return(e=cU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cU(t){var e=hU(t,"string");return typeof e=="symbol"?e:e+""}function hU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sw extends Wr{constructor(e){let{changes:r,selected:n,countCols:i,countRows:o}=e;super("change"),Xl(this,"changes",void 0),Xl(this,"selected",void 0),Xl(this,"countCols",void 0),Xl(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const o=n&&n.length;if(!o||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new sw({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};r.done(a,i)})}undo(e,r){const n=mr(this.changes);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=mr(this.changes);for(let i=0,o=n.length;i<o;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function VR(t,e,r){return(e=dU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dU(t){var e=fU(t,"string");return typeof e=="symbol"?e:e+""}function fU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aw extends Wr{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),VR(this,"conditionsStack",void 0),VR(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new aw({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function gU(t,e,r){return(e=mU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mU(t){var e=pU(t,"string");return typeof e=="symbol"?e:e+""}function pU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lw extends Wr{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),gU(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const o=n.getTopStartCorner(),s=n.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);r.done(()=>new lw({data:a,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function iM(t,e,r,n,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Ye(n,i,l=>{Ye(e,r,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[g]=d;return o.includes(g)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Fn(t,e,r){return(e=wU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wU(t){var e=vU(t,"string");return typeof e=="symbol"?e:e+""}function vU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uw extends Wr{constructor(e){let{index:r,indexes:n,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Fn(this,"index",void 0),Fn(this,"indexes",void 0),Fn(this,"data",void 0),Fn(this,"amount",void 0),Fn(this,"headers",void 0),Fn(this,"columnPositions",void 0),Fn(this,"rowPositions",void 0),Fn(this,"fixedColumnsStart",void 0),Fn(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+n)%e.countCols(),c=u+i-1,h=[],d=[],g=[];return Ye(l.length-1,w=>{const y=[],b=l[w];Ye(u,c,E=>{y.push(b[e.toPhysicalColumn(E)])}),h.push(y)}),Ye(i-1,w=>{g.push(e.toPhysicalColumn(u+w))}),Array.isArray(e.getSettings().colHeaders)&&Ye(i-1,w=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+w)]||null)}),new uw({index:u,indexes:g,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:iM(e,0,e.countRows(),u,c)})};r.done(a,s)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(bn(this.data[c],o));const l=bn(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),$(e.getSourceDataArray(),(c,h)=>{$(i,(d,g)=>{c[d]=a[h][g],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&$(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,g]=c;e.setCellMetaObject(h,d,g)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function zo(t,e,r){return(e=yU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yU(t){var e=bU(t,"string");return typeof e=="symbol"?e:e+""}function bU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cw extends Wr{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),zo(this,"index",void 0),zo(this,"data",void 0),zo(this,"fixedRowsBottom",void 0),zo(this,"fixedRowsTop",void 0),zo(this,"rowIndexesSequence",void 0),zo(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(n),u=l+i-1,c=mr(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new cw({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:iM(e,l,u,0,e.countCols()-1)})};r.done(a,s)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function WR(t,e,r){return(e=CU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CU(t){var e=SU(t,"string");return typeof e=="symbol"?e:e+""}function SU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hw extends Wr{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),WR(this,"rows",void 0),WR(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new hw({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),nM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),n.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function RU(t,e,r){return(e=EU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EU(t){var e=TU(t,"string");return typeof e=="symbol"?e:e+""}function TU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dw extends Wr{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),RU(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new dw({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function _U(t,e){[tw,rw,nw,iw,ow,sw,aw,lw,uw,cw,hw,dw].forEach(r=>r.startRegisteringEvents(t,e))}function OU(t,e){MU(t,e),e.add(t)}function MU(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gg(t,e,r){return(e=IU(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IU(t){var e=PU(t,"string");return typeof e=="symbol"?e:e+""}function PU(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $R="undoRedo",xU="undoRedo",HU=1e3;de.getSingleton().register("beforeUndo");de.getSingleton().register("afterUndo");de.getSingleton().register("beforeRedo");de.getSingleton().register("afterRedo");const BR=new Set;var Zl=new WeakSet;class AU extends hc{static get PLUGIN_KEY(){return xU}static get PLUGIN_PRIORITY(){return HU}static get SETTING_KEYS(){return!0}constructor(e){super(e),OU(this,Zl),gg(this,"doneActions",[]),gg(this,"undoneActions",[]),gg(this,"ignoreNewActions",!1),_U(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return mg(Zl,e,DU).call(e,...n)}),this.registerShortcuts(),mg(Zl,this,NU).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),mg(Zl,this,kU).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:$R};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($R)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=mr(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=mr(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function DU(t,e){e==="loadData"&&this.clear()}function NU(){const t=e=>{BR.has(e)||(Sn(rr`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),BR.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function kU(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}class LU{diff(e,r,n={}){let i;typeof n=="function"?(i=n,n={}):"callback"in n&&(i=n.callback);const o=this.castInput(e,n),s=this.castInput(r,n),a=this.removeEmpty(this.tokenize(o,n)),l=this.removeEmpty(this.tokenize(s,n));return this.diffWithOptionsObj(a,l,n,i)}diffWithOptionsObj(e,r,n,i){var o;const s=v=>{if(v=this.postProcess(v,n),i){setTimeout(function(){i(v)},0);return}else return v},a=r.length,l=e.length;let u=1,c=a+l;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const h=(o=n.timeout)!==null&&o!==void 0?o:1/0,d=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}];let w=this.extractCommon(g[0],r,e,0,n);if(g[0].oldPos+1>=l&&w+1>=a)return s(this.buildValues(g[0].lastComponent,r,e));let y=-1/0,b=1/0;const E=()=>{for(let v=Math.max(y,-u);v<=Math.min(b,u);v+=2){let T;const _=g[v-1],M=g[v+1];_&&(g[v-1]=void 0);let P=!1;if(M){const F=M.oldPos-v;P=M&&0<=F&&F<a}const x=_&&_.oldPos+1<l;if(!P&&!x){g[v]=void 0;continue}if(!x||P&&_.oldPos<M.oldPos?T=this.addToPath(M,!0,!1,0,n):T=this.addToPath(_,!1,!0,1,n),w=this.extractCommon(T,r,e,v,n),T.oldPos+1>=l&&w+1>=a)return s(this.buildValues(T.lastComponent,r,e))||!0;g[v]=T,T.oldPos+1>=l&&(b=Math.min(b,v-1)),w+1>=a&&(y=Math.max(y,v+1))}u++};if(i)(function v(){setTimeout(function(){if(u>c||Date.now()>d)return i(void 0);E()||v()},0)})();else for(;u<=c&&Date.now()<=d;){const v=E();if(v)return v}}addToPath(e,r,n,i,o){const s=e.lastComponent;return s&&!o.oneChangePerToken&&s.added===r&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:r,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:r,removed:n,previousComponent:s}}}extractCommon(e,r,n,i,o){const s=r.length,a=n.length;let l=e.oldPos,u=l-i,c=0;for(;u+1<s&&l+1<a&&this.equals(n[l+1],r[u+1],o);)u++,l++,c++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!o.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=l,u}equals(e,r,n){return n.comparator?n.comparator(e,r):e===r||!!n.ignoreCase&&e.toLowerCase()===r.toLowerCase()}removeEmpty(e){const r=[];for(let n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r}castInput(e,r){return e}tokenize(e,r){return Array.from(e)}join(e){return e.join("")}postProcess(e,r){return e}get useLongestToken(){return!1}buildValues(e,r,n){const i=[];let o;for(;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();const s=i.length;let a=0,l=0,u=0;for(;a<s;a++){const c=i[a];if(c.removed)c.value=this.join(n.slice(u,u+c.count)),u+=c.count;else{if(!c.added&&this.useLongestToken){let h=r.slice(l,l+c.count);h=h.map(function(d,g){const w=n[u+g];return w.length>d.length?w:d}),c.value=this.join(h)}else c.value=this.join(r.slice(l,l+c.count));l+=c.count,c.added||(u+=c.count)}}return i}}class FU extends LU{constructor(){super(...arguments),this.tokenize=WU}equals(e,r,n){return n.ignoreWhitespace?((!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!n.newlineIsToken||!r.includes(`
`))&&(r=r.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),r.endsWith(`
`)&&(r=r.slice(0,-1))),super.equals(e,r,n)}}const VU=new FU;function jR(t,e,r){return VU.diff(t,e,r)}function WU(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));const r=[],n=t.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(let i=0;i<n.length;i++){const o=n[i];i%2&&!e.newlineIsToken?r[r.length-1]+=o:r.push(o)}return r}function $U(t,e,r,n,i,o,s){let a;a={},typeof a.context>"u"&&(a.context=4);const l=a.context;if(a.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(a.callback){const{callback:c}=a;jR(r,n,Object.assign(Object.assign({},a),{callback:h=>{const d=u(h);c(d)}}))}else return u(jR(r,n,a));function u(c){if(!c)return;c.push({value:"",lines:[]});function h(v){return v.map(function(T){return" "+T})}const d=[];let g=0,w=0,y=[],b=1,E=1;for(let v=0;v<c.length;v++){const T=c[v],_=T.lines||jU(T.value);if(T.lines=_,T.added||T.removed){if(!g){const M=c[v-1];g=b,w=E,M&&(y=l>0?h(M.lines.slice(-l)):[],g-=y.length,w-=y.length)}for(const M of _)y.push((T.added?"+":"-")+M);T.added?E+=_.length:b+=_.length}else{if(g)if(_.length<=l*2&&v<c.length-2)for(const M of h(_))y.push(M);else{const M=Math.min(_.length,l);for(const x of h(_.slice(0,M)))y.push(x);const P={oldStart:g,oldLines:b-g+M,newStart:w,newLines:E-w+M,lines:y};d.push(P),g=0,w=0,y=[]}b+=_.length,E+=_.length}}for(const v of d)for(let T=0;T<v.lines.length;T++)v.lines[T].endsWith(`
`)?v.lines[T]=v.lines[T].slice(0,-1):(v.lines.splice(T+1,0,"\\ No newline at end of file"),T++);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:d}}}function oM(t){if(Array.isArray(t))return t.map(oM).join(`
`);const e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(let r=0;r<t.hunks.length;r++){const n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@");for(const i of n.lines)e.push(i)}return e.join(`
`)+`
`}function BU(t,e,r,n,i,o,s){{const a=$U(t,e,r,n,i,o);return a?oM(a):void 0}}function jU(t){const e=t.endsWith(`
`),r=t.split(`
`).map(n=>n+`
`);return e?r.pop():r.push(r.pop().slice(0,-1)),r}var tm;(t=>{t.contains=(e,r)=>{for(let n=0;n<e.length;n++)if(e[n]==r)return!0;return!1},t.range=(e,r)=>[...Array(Number(r)-Number(e)+1).keys()].map(n=>n+Number(e)).map(String),t.sort=e=>{let r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return e.sort(r.compare),e}})(tm||(tm={}));const Uo=(t,e)=>`
Total ${t} ${t==1?"record":"records"}

result:
${e.join(`
`)}`,fs=tm;class zR{data;constructor(e){this.data=e}run(){const e={};return this.data.map(r=>{e[r]?e[r]++:e[r]=1}),Object.keys(e).map(r=>{e[r]==1&&delete e[r]}),Object.fromEntries(Object.entries(e).sort(([,r],[,n])=>n-r))}}class UR{data;constructor(e){this.data=e}run(){return[...new Set(this.data)]}}class rm{data1;data2;ignoreDuplicates;constructor(e,r,n=!0){n?(this.data1=[...new Set(e)],this.data2=[...new Set(r)]):(this.data1=e,this.data2=r),this.ignoreDuplicates=n}run(){const e=[...this.data1];for(let r=0;r<this.data2.length;r++)fs.contains(e,this.data2[r])&&e.splice(e.indexOf(this.data2[r]),1);return fs.sort(e)}}class zU{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){let e=[],r;r=[...new Set(this.data1)];for(let n=0;n<r.length;n++)fs.contains(this.data2,r[n])&&e.push(r[n]);return fs.sort(e)}}class YR{data;constructor(e){this.data=fs.sort(e)}run(){for(let e=0;e<this.data.length;e++){const r=Number(this.data[e]);if(isNaN(r))return["!Error!"]}return new rm(fs.range(this.data[0],this.data[this.data.length-1]),this.data).run()}}class UU{data1;data2;constructor(e,r){this.data1=e,this.data2=r}run(){return BU("Data1","Data2",this.data1,this.data2)}}const YU=async(t,e)=>{ue(e).trim()!==""&&(navigator.clipboard?(await navigator.clipboard.writeText(ue(e).trimEnd()),alert("Text has been copied to clipboard.")):alert("This function requires a secure origin. (HTTPS or localhost)"))};var qU=(t,e)=>e("chkDuplicates"),GU=(t,e)=>e("rmDuplicates"),KU=(t,e)=>e("chkConsecutive"),XU=(t,e)=>e("compare"),ZU=(t,e)=>e("diff"),QU=pI('<header class="navbar navbar-expand navbar-light flex-column flex-md-row svelte-1n46o8q"><a class="navbar-brand text-primary m-0 mr-md-3" href="/" style="font-size:24px">Simple Data Analysis</a></header> <div class="container-fluid svelte-1n46o8q"><div class="row svelte-1n46o8q"><div id="Table1" class="col-3 svelte-1n46o8q"></div> <div id="Table2" class="col-3 pl-0 svelte-1n46o8q"></div> <div class="col-2 p-0 pt-5 svelte-1n46o8q"><button type="button" class="btn btn-primary w-100">Check Duplicates</button> <div class="d-flex justify-content-around"><div><input type="checkbox" id="detail"/> <label class="m-0" for="detail">Show Detail</label></div></div> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Remove Duplicates</button> <button type="button" class="btn btn-primary w-100 svelte-1n46o8q">Check Consecutive</button> <div class="d-flex justify-content-around"><div><input type="radio" id="Data1"/> <label class="m-0" for="Data1">Data1</label></div> <div><input type="radio" id="Data2"/> <label class="m-0" for="Data2">Data2</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Cross Compare</button> <div class="d-flex justify-content-around"><div><input type="radio" id="comm"/> <label class="m-0" for="comm">Comm</label></div> <div><input type="radio" id="diff"/> <label class="m-0" for="diff">Diff</label></div></div> <div class="d-flex justify-content-around"><div><input type="checkbox" id="ignore_duplicates"/> <label class="m-0" for="ignore_duplicates">Ignore Duplicates</label></div></div> <br/> <button type="button" class="btn btn-primary w-100">Diff</button> <br/> <br/> <button type="button" class="btn btn-primary w-100">Copy Result</button> <br/> <br/> <button type="button" class="btn btn-primary w-100"><!></button> <br/> <br/> <button type="button" class="btn btn-danger w-100">Clear</button></div> <div class="col-4 svelte-1n46o8q"><label for="result">Result</label> <textarea class="form-control svelte-1n46o8q" id="result" readonly=""></textarea></div></div></div>',1);function JU(t,e){JR(e,!0);const r=[],n=[];pl(Ta),pl(Sc),pl(Vz),pl(AU);const i=64;let o,s,a=er(""),l=er("Data1"),u=er("comm"),c=er(!0),h=er(!0),d=er(!1);const g=(W,te,oe)=>{let Ie;try{Ie=JSON.parse(localStorage.getItem(oe)||"")}catch{Ie=void 0}const be=new on(document.getElementById(W),{data:Ie,colHeaders:[te],colWidths(){return Math.floor(window.innerWidth*.25-i-24)},contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo","---------","copy","cut"],height(){return window.innerHeight-80-16},maxCols:1,minSpareRows:1,rowHeaders:!0,rowHeaderWidth:i,startRows:1,tabMoves:{row:1,col:0},themeName:"ht-theme-main",licenseKey:"non-commercial-and-evaluation"});return be.addHook("beforePaste",()=>be.updateSettings({readOnly:!0})),be.addHook("afterPaste",re=>{be.updateSettings({readOnly:!1}),be.deselectCell();for(let Te=re.length-1;Te>=0;Te--)if(re[Te][0]!==""){be.loadData(re.slice(0,Te+1));return}be.loadData([[""]])}),be};EI(()=>{o=g("Table1","Data1","data1"),s=g("Table2","Data2","data2")});const w=W=>W.getDataAtCol(0).filter(te=>te!==null),y=W=>{const te=w(o).filter(ce=>ce!=""),oe=w(s).filter(ce=>ce!="");switch(W){case"chkDuplicates":case"rmDuplicates":case"chkConsecutive":if(ue(l)=="Data1"&&!te.length){je(a,`Data1 is empty.
Please enter something...`);return}else if(ue(l)=="Data2"&&!oe.length){je(a,`Data2 is empty.
Please enter something...`);return}break;default:if(te.length){if(!oe.length){je(a,`Data2 is empty.
Please enter something...`);return}}else{je(a,`Data1 is empty.
Please enter something...`);return}}je(d,!0);const Ie=v(),be=new Date().getTime();let re="",Te;switch(W){case"chkDuplicates":let ce;ue(l)=="Data1"?ce=new zR(te).run():ce=new zR(oe).run(),Object.keys(ce).length?ue(c)?re=`Duplicate values found in ${ue(l)}.
`+Uo(Object.keys(ce).length,Object.keys(ce).map(xe=>`${xe} appears ${ce[xe]} times.`)):re=Object.keys(ce).join(`
`):re=`${ue(l)} has no duplicate value.`;break;case"rmDuplicates":ue(l)=="Data1"?Te=new UR(te).run():Te=new UR(oe).run(),re=Te.join(`
`);break;case"chkConsecutive":ue(l)=="Data1"?Te=new YR(te).run():Te=new YR(oe).run(),Te.length?Te.length==1&&Te[0]=="!Error!"?re=`Error!
${ue(l)} contains non-numeric value. Please check!`:re=`${ue(l)} is not consecutive.

The following numbers are missing:
${Te.join(`
`)}`:re=`${ue(l)} contains consecutive numbers.`;break;case"compare":if(ue(u)=="comm")Te=new zU(te,oe).run(),Te.length?re=`Common values found between two data.
${Uo(Te.length,Te)}`:re="Two data contain no common value.";else{const xe=new rm(te,oe,ue(h)).run(),Ge=new rm(oe,te,ue(h)).run();xe.length+Ge.length==0?re="Data1 is same as Data2.":xe.length?Ge.length?re=`Two files have inconsistent content.

Data1 is more than Data2
${Uo(xe.length,xe)}

Data2 is more than Data1
${Uo(Ge.length,Ge)}`:re=`Data1 completely contains Data2.

Data1 is more than Data2
${Uo(xe.length,xe)}`:re=`Data2 completely contains Data1.

Data2 is more than Data1
${Uo(Ge.length,Ge)}`}break;case"diff":re=new UU(te.join(`
`)+`
`,oe.join(`
`)+`
`).run().replace(`${"=".repeat(67)}
`,"")}clearInterval(Ie),W=="rmDuplicates"||W=="chkDuplicates"&&!ue(c)?je(a,re,!0):je(a,re+`

Duration for process: ${Date.now()-be}ms`),je(d,!1)},b=()=>{confirm("Clear all data?")&&(o.loadData([[""]]),s.loadData([[""]]),je(a,""))},E=()=>{const W=o.getData();o.loadData(s.getData()),s.loadData(W)},v=()=>setInterval(()=>{const W=ue(a).split("Processing");let te=W.length>=2?W[1].length:0;te<3?te++:te-=3,je(a,"Processing"+".".repeat(te))},200);var T=QU();gI("beforeunload",bg,()=>{localStorage.setItem("data1",JSON.stringify(o.getData())),localStorage.setItem("data2",JSON.stringify(s.getData()))});var _=vt(KM(T),2),M=Ht(_),P=vt(Ht(M),4),x=Ht(P);x.__click=[qU,y];var F=vt(x,2),U=Ht(F),H=Ht(U),G=vt(F,2);G.__click=[GU,y];var J=vt(G,2);J.__click=[KU,y];var ae=vt(J,2),q=Ht(ae),ee=Ht(q);ee.value=ee.__value="Data1";var lt=vt(q,2),Ee=Ht(lt);Ee.value=Ee.__value="Data2";var ye=vt(ae,4);ye.__click=[XU,y];var qe=vt(ye,2),$e=Ht(qe),Me=Ht($e);Me.value=Me.__value="comm";var yr=vt($e,2),f=Ht(yr);f.value=f.__value="diff";var m=vt(qe,2),p=Ht(m),C=Ht(p),R=vt(m,4);R.__click=[ZU,y];var O=vt(R,6);O.__click=[YU,a];var I=vt(O,6);I.__click=E;var D=Ht(I);CI(D,()=>"Data1 <=> Data2");var j=vt(I,6);j.__click=b;var V=vt(P,2),A=vt(Ht(V),2);mE(()=>{x.disabled=ue(d),G.disabled=ue(d),J.disabled=ue(d),ye.disabled=ue(d),C.disabled=ue(u)=="comm",R.disabled=ue(d),O.disabled=ue(d),I.disabled=ue(d),j.disabled=ue(d)}),Nw(H,()=>ue(c),W=>je(c,W)),ol(r,[],ee,()=>ue(l),W=>je(l,W)),ol(r,[],Ee,()=>ue(l),W=>je(l,W)),ol(n,[],Me,()=>ue(u),W=>je(u,W)),ol(n,[],f,()=>ue(u),W=>je(u,W)),Nw(C,()=>ue(h),W=>je(h,W)),SI(A,()=>ue(a),W=>je(a,W)),wI(t,T),eE()}mI(["click"]);vI(JU,{target:document.body})});export default e2();
